# 安装与调试 
## 软件安装（AIC）-SDN 
### 安装概述 


本文档介绍了通过中兴通讯自研的AIC工具来部署虚拟化核心网设备ZXUN uMAC的运行环境。


AIC工具，是一种自动安装的部署工具，用于NFVI层的自动化部署、VNF的集成部署以及交付测试。


AIC工具包含iDevise、iDeploy、iTest三个部分。



 
iDeviseiDevise实现数据规划。iDevise主要用于的数据规划设计，其基于ZTE
NFV相关组网规范，支持按照硬件、承载、虚拟层、VNF等层次进行数据设计，可直接输出最终部署所需的LLD，可以直接在iDeploy工具中导入并进行自动部署，不需额外的手工修改。 

 
iDeployiDeploy实现端到端的自动化部署。通过导入部署所需的LLD文件和版本文件，实现端到端自动化部署。 

 
iTestiTest完成自动化测试。支持VIM云平台的API测试、场景功能测试、性能并发测试、EPC基本功能测试、5GC基本功能测试。 

 


 说明： 
本文档中，暂时不涉及iTest的应用。 


AIC工具最核心的理念在于简化部署实施中各个环节的手动操作，将各个阶段的规划活动提前到LLD的设计中。操作员只需在iDevise中输入部署过程中的关键参数，即可自动生成部署所需的LLD，后续通过在iDeploy上导入LLD文件来实现全流程的安装。减少操作复杂度，提升部署效率，增强产品可维护性。


AIC工具可以完成从硬件资源到业务资源的全流程部署，本文档主要介绍如何使用AIC工具进行业务资源的部署，即VNF进行实例化的过程。


#### 安装场景 
本文档的安装适用的硬件服务器支持Intel和海光两种类型。 
两种服务器在安装过程中略有区别，详细描述参见[表1]。
安装区别|说明|参见
---|---|---
需要获取的软件基础包不同|Intel服务器需要获取的软件基础包名称示例：uMAC_vnfd_V7.22.30.B11.csar海光服务器需要获取的软件基础包名称示例：uMAC_vnfd_HG_V7.22.30.B11.csar|获取版本文件
VNF Version页签中的参数Package Type有区别|Intel服务器：VNF Version页签中的参数Package Type设置为Intel海光服务器：VNF Version页签中的参数Package Type设置为HG|VNF Version
VNF Scenario页签中的参数VNF Scenario Name有区别|两种服务器的部署场景有区别|VNF Scenario
 说明： 
本文档没有说明的配置步骤，表示两种服务器的安装过程完全相同。 
#### 安装导读 
在进行ZXUN uMAC软件安装前，确保已经完成硬件设备安装、VIM云平台管理软件（如中兴通讯的TECS
OpenStack）和MANO（如中兴通讯的CloudStudio）软件安装，本文只涉及ZXUN uMAC版本软件的安装过程。安装全流程参见[表1]。
安装步骤|安装内容|安装参考文档
---|---|---
1|VIM云平台|VIM云平台软件|TECS OpenStack云平台参考TECS OpenStack用户手册文档包中用户手册文档包中的《软件安装》内容进行安装。其他云平台，参见各云平台相应的手册。
2|MANO|安装CloudStudio|参考CloudStudio用户手册文档包中用户手册文档包中的《安装与调测》内容进行安装。
3|VNF|安装ZXUN uMAC|详细信息请参考本文档后续章节。
#### 安装前准备 
##### 获取版本文件 
在执行安装前，操作员需要已经从中兴通讯技术支持人员处获取了所有的软件安装信息，包括对应版本号等内容。 
 说明： 
各个软件的版本号以实际安装部署中获取的版本号为准，本文档仅为示例。 
操作员需要获取几种类型的软件安装包，根据获取方式的不同，分为两大类： 
从AIC工具处获取软件包。详细内容参见表1。表1  从AIC工具处获取的版本文件类型名称功能描述AIC工具中的iDeployAIC-iDeployV3.22.07通过导入部署所需的LLD文件和版本文件，实现端到端自动化部署ZXUN uMAC。此软件包从AIC工具处获取。 说明：在获取AIC工具之后，需要检查License是否过期，如果已过期或快过期，需要提前申请新的License。 
从ZXUN uMAC版本发布包中获取的软件包。详细内容参见表2。表2  从ZXUN uMAC版本发布包中获取的版本文件类型名称功能描述AIC工具中的ZXUN-uMAC-V7.22.30 AIC (iDevise).zip通过此工具来进行数据规划设计，直接输出最终部署ZXUN uMAC所需的LLD。此软件包从ZXUN uMAC版本发布包中获取。镜像包操作系统镜像包uMAC_image_cgsl_F16P10_20220222.zip是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。安全网关功能镜像包ZXUN_LIG_IMG_V4.15.10.P21.zip在ZXUN uMAC需要和安全网关功能同时部署时，需要此类镜像包。基础包uMAC_vnfd_V7.18.14.csar基础包也称插件包，包含了虚机部署info.xml文件、业务部署nfservice.json文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。业务包uMAC_version_V7.18.14.zip提供ZXUN uMAC的业务功能。AIC插件包aic-plugin-uMAC-V7.22.30.zipAIC工具适配ZXUN uMAC的插件。 
其他涉及到中兴通讯产品的软件的配套版本要求TECS OpenStack需要V3.17.15.P6及后续版本，CloudStudio需要V7.19.13.B6及后续版本，EM需要V16.19.11.B6及后续版本。 
##### 客户端准备 


###### 简介 
客户端准备包括客户端的硬件要求和客户端上需要安装的软件。 
客户端的功能参见[表1]。
类别|描述
---|---
与VIM通信|作为VIM客户端。在本文档中，作为客户端，访问中兴通讯自研的云平台管理软件TECS OpenStack。
与VNFM和NFVO通信|作为VNFM和NFVO和客户端。在本文档中，作为客户端，访问中兴通讯自研的NFVI资源编排和管理软件CloudStudio。
与NFVI通信|以SSH方式访问作为控制节点或计算节点的硬件服务器。
存放版本文件|将ZXUN uMAC的版本安装软件从客户端上传到NFVI。


###### 客户端的硬件要求 
客户端采用普通PC机，参考配置如下： 

 
CPU：双核，主频≥2 GHz。 

 
内存：≥4 GB。 

 
硬盘：≥80 GB。 

 


###### 客户端的软件配置要求 
客户端中需要安装的软件参见[表2]。
软件类型|软件名称|备注
---|---|---
操作系统|Windows|建议安装Windows 7或更高级的版本。
浏览器|浏览器|只支持Google Chrome，操作员需要通过浏览器登录到TECS OpenStack和CloudStudio的图形化操作页面。
FTP或SFTP工具|FTP或SFTP工具|将ZXUN uMAC的版本文件从客户端上传到NFVI上。
远程访问工具|远程访问工具|以SSH方式访问作为控制节点或计算节点的硬件服务器。


##### VIM侧的数据准备 
检查当前TECS OpenStack版本信息和规划版本是否相同。 
如果采用iDeploy工具部署，需要检查版本号是否满足工具使用要求。 
检查获取的用户名和密码能否正常登录TECS OpenStack的客户端和主机操作系统。 
检查TECS OpenStack系统运行状态正常，有无重要/紧急的异常告警。 
检查TECS OpenStack上剩余的CPU、内存、存储等虚拟资源是否充足。 
检查TECS OpenStack上预定义的租户配额是否充足。 
检查后端存储，如磁阵、CEPH是否已经正常接入环境，对应版本是否正确，存储资源是否充足。 
##### MANO侧的数据准备 
检查当前MANO版本和规划版本是否相同。 
检查获取的用户名和密码能否正常登录MANO。 
检查MANO系统运行状态正常，有无重要/紧急的异常告警。 
检查NFVO上接入的VNFM是否正常，确保其状态为正常。 
检查NFVO上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
检查VNFM上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
##### 查询VNFM用户的权限 
概述 :本节介绍如何查询VNFM用户的权限，在部署ZXUN uMAC之前，需要确认用户权限是否配置正确。
VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，在国内运营商的部署环境中，考虑到安全性，不建议操作员使用默认的admin用户，需要新建一个用户，此用户名之前已经由MANO维护人员创建成功，创建操作参见“[在VNFM上创建的API用户的方法]”
，在部署ZXUN uMAC之前，需要确认用户的权限是否正确，若已经有了符合要求的用户，可以直接使用即可，不需要每个网元都要单独创建一个用户。
###### 操作前提 
已经从MANO的维护人员处获取了VNFM用户的名称。 
操作步骤 :登录VNFM客户端，选择系统→安全→用户管理
，进入用户管理页面，如[图1]所示。
图1  用户管理页面

查看从MANO的维护人员处获取的VNFM用户（本文档示例为AMF111）的权限，单击VNFM用户列表中对应的修改按钮，如[图2]所示。
图2  修改

出现修改用户页面，如[图3]所示。
图3  修改用户页面

单击用户规则后的查看详情按钮，出现查看账户规则页面，如[图4]所示。
图4  查看账户规则页面

确认帐号登录方式，web和API必须为勾选状态。
数据规划 :#### 基础数据规划 
##### VM简介 
ZXUN uMAC、模块、VM之间的关系如下：
ZXUN uMAC部署为多种不同类型的VM。 
每个VM运行一个模块功能，例如一个VM只运行GSU模块功能。 
每种模块可部署为一个或多个VM，例如GSU模块在实例化时，可以部署为两个VM。 
VM规划数据参见[表1]。
VM名称|服务|功能
---|---|---
OMU|O&M|操作与维护单元，其中还包含一个用于辅助判断OMU主备状态的AMU单元。OMU通过管理类通信平面与EM和VNFM交互。
IPU|Interface|接口处理单元，处理IP接口业务。
（可选）CDU|Cloud DB|云数据库单元，用于存储用户会话上下文等信息。CDU为可选单元。当ZXUN uMAC自身集成了数据库功能时，CDU是必需的。当ZXUN uMAC使用外部数据库功能（例如UDSF）时，CDU不是必需的。
GSU|MME&SGSN_C|处理MME和SGSN的控制面数据。
SGSN_U|GSU|处理SGSN用户面数据。
AMF_Communication|GSU|提供3GPP协议中定义的AMF通信服务。
AMF_MT|GSU|提供3GPP协议中定义的AMF的MT服务。
AMF_EventExposure|GSU|3GPP协议中定义的AMF事件暴露服务。
ResourceManage|GSU|提供3GPP协议中定义的资源管理服务。
SIG LB|GSU|处理SCTP和SS7信令。
HTTP LB|GSU|处理HTTP信令。
CDU GW|GSU|CDU网关，用于ZXUN uMAC的CDU之间的数据转发。CDU GW为可选单元，当ZXUN uMAC自身集成了数据库功能（即ZXUN uMAC部署了CDU VM）时，在异地容灾场景，需要使用GSU（CDU GW），否则不需要。
各业务模块VM支持的工作模式参见[表2]。
VM类型|工作模式|推荐部署方式|描述
---|---|---|---
OMU|1+1+1主备|互斥|OMU虚机的备份方式为1+1+1主备方式，其中，两个VM作为OMU主备，另外一个VM作为AMU用于为这两个OMU提供主备仲裁服务。如果两个OMU虚机部署到同一个主机上，该主机宕机时，会导致ZXUN uMAC故障，无法接入新用户，因此OMU虚机必须设置为互斥部署。
GSU|N+M负荷分担|互斥|建议部署为互斥。
IPU|N+M负荷分担|互斥|建议部署为互斥。
CDU|N×（1+1）互备|互斥|CDU虚机的备份方式为N×(1+1)主备，即部署N组CDU虚拟机，每组中的两个CDU虚拟机为1+1互备。如果一组中的两个CDU虚机部署到同一个主机上，该主机宕机时，会导致CDU上的备份数据都丢失，因此CDU虚机必须设置为互斥部署。
#### SDN组网规划 
概述 :SDN组网架构，ZXUN uMAC的外部网络平面需要启用VLAN
TRUNK功能。
在VNF LLD设计中，涉及到SDN功能，需要配置的页签为“[VRouter Summary]”
、“[VRouter External Network]”
和“[VNF SDN Network Setting]”
。
##### 网络平面规划 
网络平面是指各个虚机通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN uMAC规划的网络平面分为三类，参见[表1]。
网络平面|描述|部署原则
---|---|---
网管平面|ZXUN uMAC的OMU虚机和VIM、NFVO进行通信的网络平面。|部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。
内部网络平面|内部网络平面是指ZXUN uMAC中的各个虚机之间进行数据通信的网络平面。|规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面。|SDN组网架构，在启用VLAN Trunk功能的情况下，规划一个parent（父）网络平面和N个child（子）网络平面，将所有child（子）网络平面都配置在parent（父）网络平面的VLANTrunk子接口中。
ZXUN uMAC规划的网络平面的详细描述参见[表2]。
 说明： 
在为各个网络平面规划IP地址时，所有的网络平面都不能使用172.17.0.0/16地址段中的IP地址。 
网络平面|描述
---|---
网管平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-OAM-EXT-NET|网管平面|ZXUN uMAC的OMU虚机和VIM、NFVO进行通信的网络平面。
内部网络平面|内部控制平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-MGT-INT-NET|ZXUN uMAC内部控制面数据通信。
内部媒体平面|内部网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-SERV-INT-NET|ZXUN uMAC内部媒体面数据通信。
外部网络平面|parent（父）网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-EXT-NET|ZXUN uMAC与外部接口进行通信的网络平面。
child（子）网络平面|外部网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-SBI-EXT-NET|规划为ZXUN uMAC与5G网络中其它的NF的SBI接口通信的网络平面名称。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-GTP-EXT-NET|child（子）网络平面|外部网络平面|规划为ZXUN uMAC与4G网络中的GTP节点通信的网络平面名称。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-RAN-EXT-NET|child（子）网络平面|外部网络平面|规划为ZXUN uMAC与无线侧通信的网络平面名称。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF1BZX-SIG-EXT-NET|child（子）网络平面|外部网络平面|用于ZXUN uMAC与不同业务域网元间信令互通的网络平面名称。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LI-EXT-NET|child（子）网络平面|外部网络平面|ZXUN uMAC和安全网关功能通信的网络平面。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-Gb-EXT-NET|child（子）网络平面|外部网络平面|外部网络平面。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-Ga-EXT-NET|child（子）网络平面|外部网络平面|外部网络平面。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-SOFTSWITCH-EXT-NET|child（子）网络平面|外部网络平面|外部网络平面。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-COM-EXT-NET|child（子）网络平面|外部网络平面|外部网络平面。
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-SPARE-EXT-NET|child（子）网络平面|外部网络平面|外部网络平面。
本文档中的网络平面名称仅以中国移动部署场景为示例进行说明，详细内容参见[表3]，实际部署时，每个项目要求需要根据各个运营商定义的规范来进行命名。
项目|设置说明
---|---
示例：NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-SERV-INT-NET|示例：NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-SERV-INT-NET
编码类型|固定为NFV-R，必选。
地理位置|表示ZXUN uMAC所在的地理位置，方便识别，由4-5位数字或字母组成，必选。示例：HDNJIH。
硬件资源池编号|由2位数字+1位字母组成，必选。其中两位数字表示硬件资源池编号，1位字母表示硬件资源池等级，取值范围有三种。A：全国集中B：省内集中C：边缘示例：01A。
VIM厂商标识|由2-3位英文字母组成，必选。示例：ZX。
资源池系统编码|由VIM+2位数字组成，可选。示例：01。
资源类型码|资源类型码由2-4位英文字母组成，必选，选项说明如下：SRV：X86物理服务器资源VM：虚拟机资源FLA：FlavorMIR：镜像VOL：卷VOLS：卷快照VOLT：卷类型SQOS：存储QoS策略VNET：虚拟网络VSNT：虚拟子网VPRT：虚拟端口VRT：虚拟路由器VFW：虚拟防火墙NQOS：网络QoSHSTK：heat stack本文档中，网络平面的名称需要设置为VNET。
资源实例编号|ZXUN uMAC的编号。
其他补充信息|由操作员自行定义的一些补充说明，比如SERV-INT-NET，表示此网络平面为内部媒体面。
ZXUN uMAC和安全网关功能同时部署时，安全网关功能规划的网络平面的详细描述参见[表4]。
 说明： 
国内运营商场景：安全网关功能使用单独的网管平面，不和其他网元共用。 
网络平面类型|名称
---|---
网管平面|网管平面（parent）|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIEMS-NET
网管平面（child）|网管平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIEMS-NET1
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIEMS-NET2|网管平面（child）|网管平面
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIEMS-NET3|网管平面（child）|网管平面
内部网络平面|内部管理通信|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LICTRL-NET
外部网络平面|外部网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIXI-NET
外部网络平面（parent）|外部网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIHI-EXT-NET
外部网络平面（child）|外部网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIHI-EXT-NET1
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIHI-EXT-NET2|外部网络平面（child）|外部网络平面
NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIHI-EXT-NET3|外部网络平面（child）|外部网络平面
预留外部网络平面|外部网络平面|NFV-R-HDBNJ-03A-ZX-01-VNET-ahAMF001BZX-LIRES-NET
### SDN侧的数据配置 
SDN场景下，需要先完成SDN相关的数据配置，本节操作需要维护SDN的操作员进行配置，内容仅供参考。 
#### 配置SDN侧的数据 
概述 :操作员在SDN侧，需要为每个VPN创建一个共享vRouter和子接口，并为每个子接口分配好IP地址段。 
##### 配置设备组和外部网络之间的映射关系 
操作员需要在SDN侧上配置设备组和外部网络之间的映射关系，确保后续使用AIC自动部署工具配置VNF LLD Template XX.xlsm表中的VRouter External
Network页签中的IP地址段均已经在SDN侧配置了映射关系，参见“[VRouter External Network]”
。
图1  配置设备组和外部网络之间的映射关系

##### 控制器上配置共享外部网络 
在SDN侧配置共享的外部网络。 
图2  共享的外部网络

图3  共享的外部网络

图4  共享的外部网络

参数名称|参数说明
---|---
共享外部网络Vrf名称|外部网络的VRF名称，此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中ExternalNet Name的数据一致，参见“VRouter External Network”。
共享外部网络vlanid|需要和VIM云平台上外部网络的段ID一致，此处的数据需要和AIC自动部署工具配置VNF LLD TemplateXX.xlsm中“VRouter External Network页签中VLAN ID的数据一致，参见“VRouter External Network”。
子网Cidr|互联网段，每个端口需要配置一个，和预先规划的网段对应，同时，和云平台上的外部网络的子网配置一致。在各个租户都有通过这个子网外出的需求时，则各个租户的分布式路由器的北向接口都会在这个子网中分配一个地址，因此要注意这个CIDR的有效IP地址数量，要大于这个外部网络可接入的租户的分布式路由器数量，当这CIDR网段的地址被云平台分配耗尽时，再次在云平台配置分布式路由器接入这个共享网络将出现异常。此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中SubnetCIDR的数据一致，参见“VRouter External Network”。
子网掩码长度|此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中SubnetCIDR的数据一致，参见“VRouter External Network”。
网关设备id：|网关的设备ID
网关端口id|出端口ID
本地ip|此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中GatewayIP的数据一致，参见“VRouter External Network”。
本地子网掩码长度|此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中SubnetCIDR的数据一致，参见“VRouter External Network”。
默认网关端口|是
对端IP(默认网关端口选择为是时显示）|此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中NextHop的数据一致，参见“VRouter External Network”。
对端子网掩码长度(默认网关端口选择为是时显示）|此处的数据需要和AIC自动部署工具配置VNF LLD Template XX.xlsm中“VRouter External Network页签中SubnetCIDR的数据一致，参见“VRouter External Network”。
#### 配置到VNF的出向路由 


请联系现场SDN维护人员进行配置。 


#### 配置SDN直连设备的数据 
概述 :SDN-GW是SDN域和传统设备之间的边界，传统设备通常包括EOR、CE、或者Firewall。 
SDN-GW和传统设置之间的物理网络的连线包括口字型连接或者交叉连线两种方式。 
对于传统设备而言，SDN-GW也是一个传统设备，因此此部分操作需要联系EOR、CE或者Firewall的维护人员完成相关数据的配置。 
##### 接口配置 
根据“[配置SDN侧的数据]”
的VLAN数据配置，如果是三层接口，则启用子接口；如果是LAN接口，则允许对应的VLAN通过。
##### 地址配置 
根据“[配置SDN侧的数据]”
的IP地址，将IP地址分别配置在上述三层接口或者VLAN接口上。
##### 到SDN-GW的路由配置 
根据工程LLD文档“接口地址”，配置到DC数据中心内的网管类主机的路由，指向SDN侧用于网管对接的接口地址。 
根据工程LLD文档“业务地址”，配置到DC数据中心内的路由型业务地址的路由，指向SDN侧相应的VLAN的接口地址。 
上述路由可以是静态路由，也可以是动态路由。 
对于ZXUN uMAC，需要制作的设备和数据参见下表。
业务类型|SDN-GW对端设备|制作数据|制作依据|备注
---|---|---|---|---
网管|EOR|VLAN或者三层子接口配置VLAN接口地址或者子接口地址配置到DC数据中心的路由配置|LLD上的共享网络VLAN和地址LLD上的接口地址中章节|OMU虚机，对接EMS、VNFM等
业务信令|防火墙|IPU虚机|VLAN或者三层子接口配置VLAN接口地址或者子接口地址配置到DC数据中心的路由配置|LLD上的共享网络VLAN和地址LLD上的接口地址中章节
##### 到外部的路由配置 
将默认路由指向外部的CE、PE设备。 
#### 配置非直连邻接设备的数据 


ZXUN uMAC的报文出去的第一跳是“[配置SDN直连设备的数据]”
中配置的直连设备，直连设备可能还需要经过其他多个网络设备才能到达目的地。


因此需要检查到其他和新建ZXUN uMAC有通信需求的设备线路上的设备的路由信息是否存在，如果不存在需要检查增加静态路由或者发布动态路由信息。


### VNF的部署 


概述 :VNF指虚拟化后的核心网NF（如：SMF、UPF、AMF等），执行3GPP定义的NF功能。
本文档规划VNF在是AIC自动部署工具中部署的。


#### 配置内容 
AIC自动部署工具制作的LLD，包括5个部分： 

 
Networking用来配置2台业务交换机和1台带外管理交换机的数据。 

 
Hardware用于配置R5300 G4服务器的BIOS和RAID数据。 

 
VIM用于配置VIM云平台（本文档指中兴通讯的TECS OpenStack） 

 
MANO用于配置MANO（本文档指中兴通讯的CloudStudio） 

 
VNF 用于配置中兴通讯的ZXUN uMAC 

 
 说明： 
在本文档中，AIC自动部署工具只涉及到VNF LLD的制作过程。 


#### 设置规范 
AIC自动部署工具的设置规范参见[表1]。
字体样式|说明|是否可以修改
---|---|---
无底色，黑色字体|单元格的值是固定的。|其内容不得修改。
橙色底，红色字体|需要操作员进行配置的参数或者确认默认值是否正确。|可以修改。
橙色底，蓝色字体|单元格的值是由其他参数设置后，在本处自动引用生成的，需要操作员确认是否正确。|如果需要修改，可以直接修改。
无底色，蓝色字体|单元格的值是由其它的参数设置后，在本处自动引用生成的。|如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。


#### 创建工程 
摘要 :本节介绍通过AIC自动部署工具如何创建一个工程。
前提 :已经获取AIC自动部署工具ZXUN-uMAC-V7.**.** AIC (iDevise).zip。 
已经获取AIC插件包aic-plugin-amf-V7.**.** .zip。 
 说明： 
AIC自动部署工具版本号仅为示例，请以实际情况中的为准。 
步骤 :在客户端，选择ZXUN-uMAC-V7.**.**  AIC (iDevise).zip中的ZXUN-uMAC AIC (iDevise) Plugin Edition.xlsm文件，如[图1]所示。
图1  打开ZXUN AIC (iDevise)(WPS版).xlsm

双击打开ZXUN AIC (iDevise) Plugin Edition(WPS版).xlsm，系统会提示选择禁用宏或者启用宏。
选择启用宏，之后会出现如[图2]所示的页面。
图2  ZXNFV-INT AIC(iDevise)页面

单击New Project，系统弹出提示信息，如[图3]所示。
图3  提示信息

单击确定按钮，回到ZXUN AIC(iDevise)页面，单击Edit Project按钮，系统出现Plugin页面，如[图4]所示。
图4  Plugin页面

单击OpenTemplates File to Design按钮，系统弹出提示框，如[图5]所示。
图5  提示框

在弹出的提示框中选择不更新，系统会自动在ZXUN-uMAC
AIC (iDevise) Plugin Edition.xlsm的同级目录下，创建一个名称为VNF LLD Template AMF.xlsm的表格，如[图6]所示。
图6  VNF LLD Template AMF.xlsm

VNF LLD Template AMF.xlsm会默认生成在ZXUN AIC (iDevise) Plugin Edition(WPS版).xlsm的同级目录下，如[图7]所示。
图7  VNF LLD Template AMF.xlsm路径

在VNF LLD Template AMF.xlsm的表格中，进行LLD的配置。
#### LLD配置 
##### Global Setting 
配置原则 :Global Setting页签用于配置VNF的一些全局变量信息，必须配置。
 说明： 
Global Setting页签中的某些参数的配置结果将影响后续其他设计页签的呈现，包括Network Type、Storage Type和Application scenarios。
配置说明 :Global Setting页签如[图1]所示。
 说明： 
请根据MANO的实际协议模式配置Mano Protocol Mode参数的值（隐藏的第21行参数），配置原则参见[表1]，本参数配置错误会影响后续部署。
图1  Global Setting

Global Setting页签参数参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Application scenarios|本参数用于配置ZXUN uMAC的应用场景。0-Common：通用场景（MANO为ETSI模式）1-5GS：通用5G切片场景（MANO为CMCC模式）11-CMCC Phase1：中国移动一期资源池场景（MANO为CMCC模式）当选择为本场景时，某些表格中部分单元格底色变为绿色的，表示该处已根据中国移动的规范要求设置好对应的数值，非特殊情况下不需要修改。中国移动非SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VNF Network Setting或者VNF Network Setting IPv6。12-CMCC Phase2：中国移动二期资源池场景（MANO为CMCC模式，SDN组网）中国移动SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VRouter Summary、VRouter External Network和VNF SDNNetwork Setting。21-CTCC：中国电信资源池（MANO为CMCC协议模式）31-CUCC：中国联通资源池（MANO为CMCC协议模式）41-CBNC：中国广电资源池51-OverSea：海外国际局点|中国移动三期资源池场景：配置为12-CMCC Phase2
Room Name|本参数用于设置机房名称。|请根据运营商的规划进行设置。如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTENFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。
DC Name|本参数用于设置DC名称。|该参数的值来源于创建工程时，配置的参数DC Name，参见“创建工程”，此处使用默认值，不需要设置。
DC Description|本参数用于设置DC的信息描述。一般根据运营商的工程规划方案设置，表示DC的物理位置，例如具体的大楼、机房位置等。|请根据运营商的规划进行设置。如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTENFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。
Network Type|本参数用于设置ZXUN uMAC需要部署的VIM云平台的网络类型。SDN组网场景时，该参数需要设置为VxLAN。非SDN组网场景时，该参数需要设置为VLAN。|中国移动二期资源池场景和三期资源池场景：配置为VxLAN中国联通和中国电信场景：配置为VLAN
VIM ID|本参数用于设置ZXUN uMAC需要部署的VIM云平台的编号，用于VIM接入MANO时使用。|如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。中国移动命名规则：NFV-RP-HBBAD-01A-ZX-01中国电信命名规则：GD-GZ-ZSC-RP0001B-V-ZE-01中国联通命名规则：az1.xa1.chinaunicom.cn（MANO的V5.20.11版本支持域名方式，其他版本不支持域名方式）除上述运营商之外的其他运营商，不必遵循上述格式，可自定义合法字符串，例如VIM01。
VIM Name|本参数用于设置ZXUN uMAC需要部署的VIM云平台的名称。|从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。
VIM Type|本参数用于设置ZXUN uMAC需要部署的VIM云平台类型。配置为TECS，表示ZXUN uMAC需要部署的VIM云平台为中兴通讯自研的的ZTE TECSOpenStack。配置为OSP，表示ZXUN uMAC需要部署的VIM云平台为OpenStack Platform ，OSP是OpenStack Platform开源项目的服务。配置为OIaaS，表示ZXUN uMAC需要部署的VIM云平台为IaaS，基础设施服务，就是多个基础设施组成的服务。|该参数只能设置为TECS，表示ZXUN uMAC部署的VIM云平台只能是中兴通讯的TECSOpenStack。
VIM Version|本参数用于设置ZXUN uMAC需要部署的VIM云平台的版本号。从下拉列表中选择，目前只支持中兴通讯的TECSOpenStack V03.17.14、V03.17.15和V06.10.10，请配置为现场实际安装的TECS OpenStack的版本号。|如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中VIM Controller Info页签中获取的。
Quorum Service Num|本参数用于配置仲裁节点的个数。如果是OMU单机场景，不需要配置仲裁节点，此参数配置为固定值0。如果是OMU双机场景（即OMU采用1+1+1主备模式。其中，两个OMU虚机之间采用1+1主备，另外一个OMU用于这两个OMU虚机的主备仲裁），则此参数配置为3。如果OMU双机场景下，某些运营商希望除了不仅在OMU上，同时在IPU虚机上也支持仲裁功能，则此参数需要配置为5。|当Application scenarios配置为12-CMCC Phase3，表示适用中国移动二期和三期资源池场景时，本参数必须配置为5。
Storage Type|本参数用于设置ZXUN uMAC需要部署VIM云平台的存储类型，包括如下类型：CEPHVIM云平台使用TECS CloveStorage存储数据。Local DiskVIM云平台使用本地盘存储数据，由服务器自身携带的存储硬盘提供整个系统的存储能力。Disk ArrayVIM云平台由单独的磁盘阵列设备提供存储能力。当Storage Type配置为CEPH或Disk Array时（表示ZXUN uMAC使用后端存储设备），后续需要额外配置的页签如下：Volume Types页签，表示在这两种情况下，需要设置ZXUN uMAC规划的云硬盘类型名称，参见“Volume Types（可选）”。Storage QoS页签，表示在这两种情况下，需要设置ZXUN uMAC规划的存储QoS策略，参见“Storage QoS”。|中国电信和中国移动部署场景：本参数需要设置为CEPH。中国联通部署场景：本参数需要设置为Disk Array。
Use Huge Pages / CPU Dedication|本参数用于设置VIM云平台是否启用（Huge Page）巨页/（NUMA）绑核功能。|国内运营商部署场景：本参数需要设置为YES。
Use Security Group|本参数用于设置VIM云平台是否开启安全组。安全组是在VIM云平台上（如中兴通讯自研的TECS OpenStack）上创建的一个地址段范围，在VIM云平台和VNF同时开启安全组的情况下，VNF可以和处于该地址段范围内的外部网元进行通信。|国内运营商部署场景：本参数需要设置为NO。
Use Port Security Group|本参数用于设置ZXUN uMAC是否开启端口安全组。|当Application scenarios设置为12-CMCC Phase2时，本参数需要设置为YES，除此之外的其他场景，本参数需要设置为NO。
VIM IP Type|本参数用于设置ZXUN uMAC需要部署的VIM云平台使用的网络地址类型。IPv6：IPv6类型地址IPv4：IPv4类型地址|如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中VIM Controller Info页签中获取的。
VNF IP Type|本参数用于设置ZXUN uMAC使用的网络地址类型。IPv6：IPv6类型地址IPv4：IPv4类型地址如果ZXUN uMAC使用的网络地址类型需要部署为双栈，此参数还是设置为单栈方式（即设置为IPv6或者IPv4都可以），在ZXUN uMAC实例化成功后，通过后续的业务配置来实现ZXUN uMAC的双栈功能。|本参数需要根据现场的实际组网情况进行配置。
Timezone|本参数用于设置ZXUN uMAC所在地的时区。根据实际情况从下拉列表中选择，比如中国的时区为东8区，设置为GMT+08:00Asia/Shanghai。|国内运营商场景：固定设置为GMT+08:00 Asia/Shanghai。
Physical Network Name|本参数用于设置VIM云平台的租户网络所映射的物理网卡名称。|国内运营商场景：固定配置为default。
Language|本参数用于设置部署ZXUN uMAC时，ZXUN uMAC的网管系统的语言类型。en_US.UTF-8：英文zh_CN.UTF-8：中文|国内运营商场景：固定配置为zh_CN.UTF-8。
Mano Protocol Mode|本参数用于设置MANO（NFVO和VNFM）的协议模式，包括ETSI间接模式和CMCC直接模式。在VNF的实例化中流程中，实例化是从NFVO发起，然后由VNFM进行资源计算和申请，当资源计算完毕后再由NFVO或者VNFM去向VIM云平台交互进行资源的创建。NFVO、VNFM均具备向VIM云平台进行资源创建查询的能力，最终由谁跟VIM云平台进行交互创建资源，则由MANO配置的模式来决定。配置为CMCC，表示采用CMCC直接模式当采用CMCC（中国移动）直接模式配置时，由VNFM向VIM云平台申请创建资源。配置为ETSI，表示采用ETSI间接模式当采用ETSI间接模式配置时，由NFVO向VIM云平台申请创建资源。CMCC、ETSI是代表的不同协议规范，CMCC协议下，NFVO和VNFM之间的接口是有专门规范的，涉及的接口以及接口中的参数都是根据CMCC的要求进行实现处理，而ETSI则是另外一套规范的要求。直接、间接代表的是NFVO和VNFM，两者谁向VIM进行资源创建操作，直接就是VNFM直接跟VIM云平台进行交互操作，间接就是NFVO跟VIM云平台进行交互操作。CMCC、ETSI、直接、间接，两两组合就存在四种不同的场景，目前只涉及到ETSI间接模式CMCC直接模式两种。|请根据MANO的实际协议模式进行配置。
VNFM ID|本参数用于设置ZXUN uMAC所在的VNFM ID。此处需要配置为VNFM接入NFVO时的编号，当多个VNFM接入同一个NFVO时，需要配置此参数。|本参数继承MANO侧的配置数据，需要和MANO侧的配置数据保持一致，在配置前请从MANO侧获取相关数据。如果VNF的LLD是与MANO的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(MANO) XX.xlsx表中Global Setting页签中获取的。
Resource Prefix|本参数用于设置VIM平台（本文档指TECS OpenStack）上的虚机资源前缀名称，用于定义租户、云盘、网络等资源时，系统在原有的名称前，自动添加的前缀。|此参数需要根据各个运营商的规范进行配置。如果VNF的LLD是与MANO的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(MANO) XX.xlsx表中Global Setting页签中获取的。中国移动命名规则：HBBAD-01A-ZX-01。地理位置-硬件资源池编号-厂家-池编号中国电信命名规则：GD-GZ-ZSC-RP0001BE。省份标签-地市标签-局点标签-云属性+序号中国联通命名规则：XA1-SN-SN-XA。站点名称-大区-省份-城市除上述运营商之外的其他运营商，不必遵循上述格式，可自定义合法字符串。
Enable Transport Network QinQ|本参数用于设置是否启用透传网络QinQ功能。True：当TECS OpenStack及承载网络启用了透传网络QinQ功能时，本参数需要设置为True。启用QinQ功能后，VNF的外部网络平面（除网管平面外）必须设置为VLAN透传网络，并设置一个VLAN ID用于QinQ外层VLAN标签，而内层VLAN标签可规划一个起止段，且必须在承载交换机上进行对应QinQ配置。False：不启用QinQ功能。|本参数和Application scenarios参数的配置结果相关，当Application scenarios设置为11-CMCC Phase1时，本参数需要设置为True，其他情况下，都需要配置为False。
Allow Cross AZ Deployment|本参数用于设置，当使用非本地盘部署时（即参数Storage Type设置为CEPH或者Disk Array时），是否允许虚机所使用的可用域与存储后端所使用的可用域，为不相同的两个域。在TECS OpenStack上，也有一个相同的参数跨AZ挂载云盘，如图2所示，本参数的取值，需要与TECS OpenStack上这个参数设置的数值相同。|中国移动资源池规范中，要求虚机可用域与存储可用域必须一致，该参数应设置为NO。其他运营商场景下，需要根据运营商规范及虚机可用域与存储可用域实际规划情况设置。
Support Duplicate Resource Name|本参数用于设置，操作员在TECS OpenStack上创建资源（如vRrouter等）时，是否允许不同租户下有重名的资源。 YES：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，允许在本租户下继续创建该名称的资源。NO：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，则不允许在本租户下继续创建该名称的资源。|中国移动场景，该参数需要设置为NO。
Support Heat Script|本参数用于配置，操作员是否通过HeatScript工具来创建实例化ZXUN uMAC时，所需要的网络资源和虚机规格（flavor）等虚拟资源。如果本参数配置为Yes，后续还需要通过Heat Script页签来配置，参见Heat Scripts（可选）。|国内运营商场景，本参数需要配置为No。
图2  TECS OpenStack上的参数页面

##### VIM Controller Info 
配置原则 :VIM Controller Info页签用于配置ZXUN uMAC所在VIM云平台的相关信息，必须配置。
 说明： 
VIM Controller Info页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
配置说明 :VIM Controller Info页签如[图1]所示。
图1  VIM Controller Info

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VIM Controller IP|该参数用于配置ZXUN uMAC的VIM云平台（本文档指中兴通讯的TECS OpenStack）控制节点的TECSClient网络平面的浮动IP地址。操作员通过TECSClient网络平面，可以在客户端使用Chrome浏览器访问TECS OpenStack提供的图形化网管界面。|如果VNF的LLD是与VIM的LLD同时规划的，本参数的值是从ZTE NFV LLD(VIM) XX.xlsx表中Floating IP页签中获取的。
##### Host Aggregate 
配置原则 :Host Aggregate页签用于配置HA（主机集合）和AZ（可用域），必须配置。
 说明： 
VIM Controller
Info页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
背景知识 :主机集合（Host Aggregates）HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。 
可用域（Availability Zones）AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。可以理解为只是一些主机在工程上的独立，例如可以把一个机架上的主机划分在 一个可用域中。 
一个AZ可以包含多个HA，一个HA只能属于一个AZ，根据实际规划来配置。 
一般为了达到容灾的效果，一个DC会按照硬件位置划分为两个AZ，相同元数据属性的HA要在两个AZ里都存在，但同时一个HA只能属于一个AZ，因此在规划时对同一元数据属性的HA，可以定义两个HA名称，分别属于不同的AZ。 
配置说明 :Host Aggregate页签如[图1]所示。
图1  Host Aggregate

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Usage|对于ZXUN uMAC，该参数需要配置为Control-Plane。Management表示管理域Control-Plane表示控制域。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
Available Zone Name|本参数用于配置可用域（Availability Zones）的名称。AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域（AZ）是一个面向终端客户的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
Host Aggregate Name|本参数用于配置主机集合（Host Aggregates）的名称。HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是指定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
Host Aggregate Metadata|本参数用于配置主机集合（Host Aggregates）的元数据，也就是设置各种调度过滤器的类型及其取值。主机集合（Host Aggregates）主要用来为过滤调度器nova-scheduler通过某一属性进行实例（instance）的调度。比如：将数据库服务的实例（instances）都调度到具有SSD属性的主机集合（HostAggregates）中，又或者让某个镜像（image）的实例（instances）调度到同一个主机集合（Host Aggregates）中。调度是指从现有的可用的计算节点中，选择其中一个作为目的节点进行虚机部署、迁移以及规格调整等操作。过滤调度器是常用的调度器之一，过滤调度器使用多个功能不同的过滤器对主机进行筛选。本参数用于设置各种调度过滤器的类型及其取值，比如Aggregate_Instance_Extra_SpecsFilter是主机集合flavor的扩展字段调试器。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
##### MANO Info 
配置原则 :MANO Info页签用于配置部署ZXUN uMAC所使用到的MANO相关信息，必须配置。
 说明： 
MANO Info页签中的参数，全部继承MANO（本文档指中兴通讯的CloudStudio）侧的配置数据，需要和MANO侧的配置数据保持一致，在配置前请从MANO侧获取相关数据。如果VNF的LLD是与MANO的LLD同时规划的，则需要从ZTE NFV LLD(MANO) XX.xlsx表中获取。
配置说明 :MANO Info页签如[图1]所示。
图1  MANO Info

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
NFVO/VNFM Version|本参数用于设置MANO的版本号。|本参数保持默认，无需修改。
NFVO ID|本参数用于设置NFVO的局号。|从MANO.xlsx表中Global Setting页签中获取的。
NFVO Tenant Username|本参数用于设置NFVO的用户名称，是NFVO与VIM对接使用的用户名。|从MANO.xlsx表中Tenant & Users页签中获取的。
NFVO User Group|本参数用于设置NFVO的用户组名称，是NFVO与VIM对接使用的用户组。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。|从MANO.xlsx表中Tenant & Users页签中获取的。
VNFM Tenant Username|本参数用于设置VNFM的租户名称，是VNFM与VIM对接使用的用户名。|从MANO.xlsx表中Tenant & Users页签中获取的。
VNFM User Group|本参数用于设置VNFM的用户组，是VNFM与VIM对接使用的用户组 。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。|从MANO.xlsx表中Tenant & Users页签中获取的。
VNFM VM Username|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的用户名。|本参数保持默认，无需修改。
VNFM VM Password|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的密码。|本参数保持默认，无需修改。
NFVO OMM Username|本参数用于设置NFVO网管系统的用户名。|本参数保持默认，无需修改。
NFVO OMM Password|本参数用于设置NFVO网管系统的密码。|本参数保持默认，无需修改。
VNFM OMM Username|本参数用于设置VNFM网管系统的用户名。|本参数保持默认，无需修改。
VNFM OMM Password|本参数用于设置VNFM网管系统的密码。|本参数保持默认，无需修改。
NFVO OAM Net Name|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet Name|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）子网名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Floating IP|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）浮动地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet IP Prefix|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）子网地址前缀（不带掩码）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet Mask|NFVO的网管网络平面（如ZTE_EMS_NET）的子网掩码。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet Gateway IP|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）子网网关地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Net Name|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Name|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Floating IP|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）的浮动IP地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet IP Prefix|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网地址前缀（不带掩码）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Mask|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网掩码。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Gateway IP|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网网关地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Name DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网名称（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Floating IP DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）浮动地址（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet IP Prefix DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网地址前缀（不带掩码）（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Mask DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网掩码（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Gateway IP DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网网关地址（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
NFVO/VNFM & VIM Interface Protocol|本参数用于设置MANO与VIM对接协议类型。|国内运营商场景：固定使用https。
NFVO/VNFM & VIM Authentication Type|本参数用于设置MANO与VIM对接鉴权方式。|国内运营商场景：固定使用Two-way Authentication
NFVO/VNFM Login Protocol|本参数用于设置登录MANO使用的协议类型。|国内运营商场景：固定使用https。
##### VNF ID 
配置原则 :VNF ID页签用于配置需要通过AIC工具进行实例化部署的NF的ID，必须配置。
配置说明 :VNF ID页签如[图1]所示。
图1  VNF ID

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VNF Type|该参数用于设置ZXUN uMAC的类型，包括如下选项：运营商的部署网络为4G网络商用场景，配置为MME。运营商的部署网络为4G和5G融合组网的商用场景，配置为AMF。|根据运营商的使用场景进行配置。
ID|该参数用于设置ZXUN uMAC的网元编号。|用于标识网元名称及各种相关资源名称。需要根据运营商的规划来设置。在网元局号和VxLAN划分.xlsx中对应大区页可找到此参数。
VNF Brief Name|此单元格的值是由VNF Type和ID两个参数设置后， 在本单元格自动引用生成的，需要操作员确认是否正确即可，如果需要修改，可以直接修改。|本参数保持默认，无需修改。
VNF Resource Name Prefix|该参数用于设置资源名称前缀，该前缀将作为虚机、云盘、端口等资源名称的一部分。运营商可以通过设置VNF Resource Name Prefix对ZXUN uMAC使用的虚拟资源进行严格规范的命名，以便资源的统一管理。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。定义了命名规则后，对于在VNF实例化过程中创建的各种虚拟资源，系统都会按照规定进行命名。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|本参数的取值来源于Global Setting页签中的Resource Prefix参数值 ,参见“Global Setting”，此处自动引用，无需修改。
VNF APP ID|该参数为网元业务系统标识的关键部分，必须根据实际规划数据修改。|中国移动配置原则：“所属省份标识+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahAMF001BZX。后续VNF Advanced Settings页签中配置的参数虚机名称前缀的数值直接引用此处。中国电信配置原则：“[网元标识+序号]-[网元属性]”，如：AMF03-B。后续VNF AdvancedSettings页面的参数虚机名称前缀自动置空，不填写。中国联通配置原则：“[网元类型+序号]-[BC/B/C/专网名称]-[厂家缩写]”，如：AMF003-B-ZX。后续VNF Advanced Settings页面的参数虚机名称前缀自动置空，不填写。
Bureau ID|该参数用于设置ZXUN uMAC的局号。取值范围：1~255之间的整数，需要根据运营商的规划来设置。规划原则：在同一个NFVO之内的各个NF的局号不能相同。在一个大区内及其容灾大区内同一类型的NF的局号不能相同，在特殊情况下，如果同一类型的NF的个数超过255，只需要保证有容灾关系的NF的局号不相同即可。|在网元局号和VxLAN划分.xlsx表中对应大区页可找到此参数。
是否实例化|该参数用于配置需要通过AIC自动部署工具进行实例化的NF。|本参数需要将是否实例化设置为YES。
实例化时使用网络预留功能|该参数在SDN组网环境时，才需要配置。本参数的配置结果会影响到VNF SDN Network Setting页签的Network Deployment为规划预留的网络平面。目前只涉及到ZXUN uMAC与安全网关之间的网络平面。该参数设置为YES，表示后续在实例化ZXUN uMAC的过程，不会创建VNF SDN Network Setting页签的Network Deployment项目中设置为规划预留的网络，这些网络需要在实例化成功后，操作员在MANO上通过NS方式纳管VNF，根据需要进行创建。该参数设置为NO，表示后续在实例化ZXUN uMAC的过程，不会创建VNF SDN Network Setting页签的Network Deployment项目中设置为规划预留的网络，后续操作员在MANO上也无法进行创建。|中国移动场景：本参数需要配置为YES。
##### VNF Resource Prefix 
配置原则 :VNF Resource Prefix页签仅用于操作员检查各类资源名称前缀是否正确，不需要操作员配置。
 说明： 
在VNF Resource
Prefix页签中禁止操作员手工执行解锁表格，增加/删除行、列或随意修改内容等操作。
配置说明 :VNF Resource Prefix页签如[图1]所示。
图1  VNF Resource Prefix

VNF Resource Prefix页签中的参数Resource Type Prefix取值来源于其它页签中参数，不需要操作员配置：
Global Setting页签中的参数Resource Prefix 
VNF ID页签中的参数VNF APP ID 
##### VNF Version 
配置原则 :VNF Version页签用于配置ZXUN uMAC的版本号，请根据实际情况配置。
配置说明 :VNF Version页签如[图1]所示。
图1  VNF Version

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Package Type|本参数用于设置ZXUN uMAC的虚机部署的计算节点的CPU的型号。HG：海光Intel：英特尔|操作员需要通过VIM平台（本文档示例为中兴通讯的TECS OpenStack）获取计算节点的CPU的型号。本参数的配置结果会影响到VNF Scenario页签的使用场景。
version|本参数用于ZXUN uMAC的版本号。|此处的版本为中兴通讯内部使用的版本号，并非对运营商交付时的外刷版本号。
##### VNF Scenario 
配置原则 :VNF Scenario页签用于配置本次部署的VNF所使用的场景，必须配置。
配置说明 :VNF Scenario页签如[图1]所示。
图1  VNF Scenario

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VNF Scenario Name|该参数用于根据实际业务量设置ZXUN uMAC的使用场景，受到VNF Version中的参数Package Type的限制。如果VNF Version中的参数Package Type设置为Intel，则ZXUN uMAC的使用场景包括如下：运营商的部署网络为4G和5G融合场景uMAC商用局 24GB AMF/MME/SGSNuMAC商用局 32GB AMF/MME/SGSNuMAC商用局 36GB AMF/MME/SGSNuMAC商用局 融合 36GB AMF/MME/SGSN运营商的部署网络为5G场景uMAC商用局 24GB AMFuMAC商用局 32GB AMFuMAC商用局 36GB AMF运营商的部署网络为4G场景uMAC商用局 24GB MME/SGSNuMAC商用局 32GB MME/SGSNuMAC商用局 36GB MME/SGSN运营商的部署网络为测试场景uMAC测试局AMF运营商的部署网络为5G测试场景uMAC测试局MME/SGSN运营商的部署网络为4G测试场景uMAC测试局AMF/MME/SGSN运营商的部署网络为4G和5G融合测试场景如果VNF Version中的参数Package Type设置为HG，则ZXUN uMAC的使用场景包括如下：uMAC HG 商用局 30GB AMFuMAC HG 商用局 融合 30GB AMF/MME/SGSNuMAC HG 商用局 融合 58GB AMF/MME/SGSN该参数决定了ZXUN uMAC所要部署的NFS、虚机的个数和规格等参数，在商用局中，该参数的值由商务合同规定。|根据实际场景进行配置。
Built-in LIG|该参数用于配置是否需要在ZXUN uMAC中同时部署安全网关功能。|国内运营商场景： 该参数固定设置为YES。
Share|该参数用于设置是否以共享方式部署ZXUN uMAC。TRUE共享方式部署，需要支持5G切片功能，ZXUN uMAC可以被多个切片共享时，该参数必须设置为TRUE。FALSE不共享方式部署，ZXUN uMAC不需要被多个切片共享，或者仅属于某个专用切片中的NF（如SMF/UPF），该参数设置为FALSE。|国内运营商场景： 该参数固定设置为FALSE。
Item|本参数用于配置ZXUN uMAC是否开启全量备份功能。当VNF Scenario Name配置为融合场景时，才需要配置。全量备份功能是一种备份方式，适用于容灾策略。ZXUN uMAC支持三种容灾策略。有UDSF表示5GC网络中部署了单独UDSF且备份方式为备份全量用户信息。此种情况下，一个AMF Set内的所有AMF共享一个UDSF，此UDSF包括所有AMF的租户信息和所有AMF的用户数据。无UDSF全量备份表示5GC网络中没有部署单独UDSF且备份方式为备份全量用户信息。此种情况下，UDSF会跟AMF一起部署（和UDSF一起部署的AMF称为UDSF的主用AMF），UDSF内置在AMF中，一个AMF  Set内的所有AMF按照GUAMI粒度相互备份，单个UDSF会保存包含其主用AMF及可接管GUAMI对应AMF的租户信息和用户数据。无UDSF部分备份表示5GC网络中没有部署单独UDSF且备份方式为备份部分用户信息。此种情况下，UDSF会跟AMF一起部署（和UDSF一起部署的AMF称为UDSF的主用AMF），UDSF内置在AMF中，一个AMF  Set内的所有AMF按照GUAMI粒度相互备份，单个UDSF包含其主用AMF的租户信息和用户数据及可接管GUAMI对应AMF的在线用户数据（包括SUPI、GUTI和TA  List信息）。|本参数的配置结果会影响到VM Parameters页签的数据，具体情况如下：如果该参数设置为YES，VM Parameters页签中，会增加GSU-CGW这种类型的虚机。如果该参数设置为YES，VM Parameters页签中，CDU-C这种类型的虚机的初始个数需要修改为3。
Master Tenant ID|本参数用于配置主用租户的ID。当VNF Scenario Name配置为融合场景时，才需要配置。在开启全量备份的情况下，需要配置两个租户，租户的名称和ID是通过VNF UDSFCfg Setting配置的，本参数只是配置哪一个租户为主用租户。租户（Tenant）是指使用系统或计算资源的用户。UDSF支持多租户，不同租户的数据访问和数据存储都是隔离的，从而保证数据的安全。|配置原则如下：本参数设置为1，表示租户1为主用。本参数设置为2，表示租户2为主用。
##### Tenant和User 
配置原则 :Tenant & Users页签用于配置ZXUN uMAC所使用的Tenant（租户）和User（用户）信息，必须配置。
本页签配置的功能适用于以下两种场景： 
场景一ZXUN uMAC所使用的Tenant（租户）是在VIM配置的，配置说明参见配置说明（场景一）。此种场景下，如果LLD中配置的ZXUN uMAC所使用的Tenant（租户）没有事先在VIM上配置，则在实例化的过程中，会自动在VIM（中兴通讯的TECS
OpenStack）上创建。 
场景二ZXUN uMAC所使用的Tenant（租户）是在MANO上配置的，配置说明参见配置说明（场景二）。某些运营商规划的使用场景：MANO可以支持创建ZXUN uMAC创建对应的项目，在MANO创建项目（即租户）的同时，需要为项目分配资源，包括虚拟内核个数、内存大小、磁盘空间大小等虚拟资源。此种场景下，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。 
###### 配置说明（场景一） 
 说明： 
此种场景下，Enable VNF quota application必须配置为NO。
通常情况下，ZXUN uMAC对应的项目是在VIM上（本文档示例为中兴通讯的TECS
OpenStack）创建的，配置之前需要先了解相关概念。
租户Tenant（租户）又称为Project（项目）。ZTE TECS OpenStack以项目的方式实现各个虚拟网元之间虚拟资源的隔离，同一个VNF内的主机、网络等资源归属到同一项目。通常情况下，操作员需要为每个VNF创建一个项目。 
用户ZTE TECS OpenStack支持多用户接入，不同的用户，在ZTE TECS OpenStack上可以拥有不同的操作权限和资源访问范围，可以为每一个项目创建一个用户。当一个VIM云平台同时管理运营商的多个VNF时，为隔离不同运营商的VNF，需要使用不同的用户来接入。通常情况下，除了ZTE TECS OpenStack默认的admin用户之外，操作员还需要为每个项目都创建一个用户。 
Tenant & Users页签如[图1]所示，配置的Tenant（租户）和User（用户）信息涉及到三种类型：
VIM云平台（本文档指中兴通讯的TECS OpenStack） 
ZXUN uMAC需要根据运营商的要求进行配置。 
SDN仅SDN组网架构时，才需要配置。 
图1  Tenant和Users

参数说明参见[表1]和[表2]。
参数名称|参数说明|配置指引
---|---|---
TECS Provider|Tenant Name|该参数用于配置TECS OpenStack的租户名称，默认值为admin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Username|TECS Provider|该参数用于配置TECS OpenStack的用户名称，默认值为admin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Password|TECS Provider|该参数用于配置TECS OpenStack的用户密码。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Role|TECS Provider|该参数用于配置TECS OpenStack用户的角色。admin用户的角色固定为admin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
AMF|Tenant Name|该参数用于配置ZXUN uMAC的租户名称。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
User Group Name|AMF|该参数用于配置ZXUN uMAC所要创建的用户组的名称。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Username|AMF|该参数用于配置ZXUN uMAC的用户名称。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Password|AMF|该参数用于配置ZXUN uMAC的用户密码。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Role|AMF|该参数用于配置用户的角色。国内运营商场景，ZXUN uMAC使用的角色，固定为ProjectAdmin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Shared External Network for vRouters|Tenant Name|该参数用于配置SDN的租户名称。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Username|Shared External Network for vRouters|该参数用于配置SDN的用户名称。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Password|Shared External Network for vRouters|该参数用于配置SDN的用户密码。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Role|Shared External Network for vRouters|该参数用于配置SDN用户的角色。admin用户的角色固定为admin。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
参数名称|参数说明
---|---
Enable VNF quota application|在此种场景下，本参数需要配置为NO。
VNF vCPU qouta (core)|此种场景下，不需要配置这些参数。
VNF vRAM qouta (GB)|此种场景下，不需要配置这些参数。
VNF vStorage qouta (GB)|此种场景下，不需要配置这些参数。
###### 配置说明（场景二） 
 说明： 
此种场景下，Enable VNF quota application必须配置为YES。
Tenant & Users页签如[图2]所示。
图2  Tenant和Users

参数说明参见[表3]和[表4]。
参数名称|参数说明
---|---
TECS Provider|Tenant Name|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
User Group Name|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
Username|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
Password|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
Role|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
AMF|Tenant Name|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
User Group Name|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Username|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Password|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Role|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Shared External Network for vRouters|Tenant Name|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
User Group Name|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Username|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Password|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Role|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
参数名称|参数说明|配置指引
---|---|---
Enable VNF quota application|本参数的使用场景为：某些运营商要求，需要在MANO可以支持创建ZXUN uMAC创建对应的项目，在创建项目（即租户）的同时，需要为项目分配资源，包括虚拟内核个数、内存大小、磁盘空间大小等虚拟资源。如果需要使用此功能，则此参数需要配置为YES|当Global Setting页签中的参数Applicationscenarios配置为CMCC Phase3时，表示部署场景为中移三期资源池场景，本参数必须配置为YES。
VNF vCPU qouta (core)|表示为ZXUN uMAC对应的租户（项目）分配的虚拟内核数量，该项目中启动的虚机的内核数总和不得超过该参数值。|本参数的取值，已经在MANO上配置成功，需要和MANO上的配置值一致，如果MANO上并不存在对应的数据，则实例化会失败。
VNF vRAM qouta (GB)|表示为ZXUN uMAC对应的租户（项目）分配的虚拟内存数量。|本参数的取值，已经在MANO上配置成功，需要和MANO上的配置值一致，如果MANO上并不存在对应的数据，则实例化会失败。
VNF vStorage qouta (GB)|表示为ZXUN uMAC对应的租户（项目）分配存储空间。|本参数的取值，已经在MANO上配置成功，需要和MANO上的配置值一致，如果MANO上并不存在对应的数据，则实例化会失败。
##### NTP Server 
配置原则 :NTP Server页签用于配置ZXUN uMAC对应的NTP服务器，必须配置。
配置说明 :NTP Server页签如[图1]所示。
图1  NTP Server

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
NTP Server IP|通常情况下，使用EM作为ZXUN uMAC的NTP服务器。|本页参数无需修改。
##### Volume Types（可选） 
配置原则 :Volume Types页签用于配置ZXUN uMAC规划的云硬盘类型名称，以及所使用的后端类型，配置原则如下：
当Global Setting页签中的Storage
Type配置为CEPH时（表示ZXUN uMAC使用后端存储设备），才会出现该页签，需要操作员进行配置。 
当Global Setting页签中的Storage
Type配置为Local Disk时（表示ZXUN uMAC使用本地存储，即使用服务器的硬盘进行存储），不会出现此页签，操作员不需要配置。 
 说明： 
当修改了本页签中的Volume Type Count（云硬盘类型数量）、Volume Type Name（云硬盘名称）等参数后，需要同步修改Storage Qos页签（参见[Storage QoS]）、VM Parameters页签（参见[VM Parameters]）中各个存储Qos、虚机对应的云硬盘类型的数量和名称。
配置说明 :Volume Types页签如[图1]所示。
图1  Volume Types

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Volume Type Count|本参数用于设置ZXUN uMAC的云硬盘类型个数，在下拉列表中选择需要配置的个数。当ZXUN uMAC需要启用存储Qos策略时，通常需要配置多个云硬盘类型，不同的云硬盘类型关联对应的存储Qos策略，并将不同的云硬盘类型关联到不同的虚机。存储Qos策略需要在Storage Qos页签中进行配置，参见“Storage QoS”。当ZXUN uMAC不需要启用存储Qos策略时，ZXUN uMAC只需要1个云硬盘类型，ZXUN uMAC的所有虚机共用这个云硬盘类型。|本参数保持默认，无需修改。
Volume Type Name|该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的TECS OpenStack）上创建的云硬盘对应的名称，用于给虚拟机分配数据存储空间。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：Volume Type Name参数是规范命名，需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。
Volume Backend|该参数是指操作员预先在VIM云平台（本文档指中兴通讯的TECS OpenStack）上创建云盘类型时，指定的存储后端。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。配置时，需要注意：该参数为VIM云平台中（本文档指中兴通讯的TECS OpenStack）配置的存储池对应的存储后端的名称，而不是存储池的名称。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：从ZTE NFV LLD(VIM) XX.xlsx表的Cinder Backend页签中获取的Cinder backend Name，如果实际场景中，配置了多个存储后端，需要根据实际情况选择。
##### Storage QoS 
配置原则 :Storage QoS页签用于配置ZXUN uMAC规划的存储QoS策略，配置原则如下：
当Global Setting页签中的Storage
Type配置为CEPH时（表示ZXUN uMAC使用后端存储设备），才会出现该页签，需要操作员进行配置。 
当Global Setting页签中的Storage
Type配置为Local Disk时（表示ZXUN uMAC使用本地存储，即使用服务器的硬盘进行存储），不会出现此页签，操作员不需要配置。 
背景知识 :存储QoS策略是指在VIM云管理平台上创建的云硬盘的读写策略，运营商可以定义多个存储QoS策略，每个存储QoS策略都设置一个对应的名称，每个虚机都可以关联一个对应的存储QoS策略，该存储QoS策略可以对虚机对应的在VIM云管理平台上创建的云硬盘的读写策略进行限制。 
Storage QoS策略的实现原理为：本页签中定义的存储QoS策略会被Volume Types中定义的云硬盘类型关联、云硬盘类型被VM Parameters页签中定义的VNF虚机使用的云硬盘关联，最终体现为VNF虚机关联了存储QoS策略，相应的QoS策略生效。
配置说明 :Storage QoS页签如[图1]所示。
图1  Storage QoS

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
QoS Policy Count|本参数用于设置ZXUN uMAC的存储QoS策略的个数。规划了几个存储QoS策略供虚机使用，则此处就需要配置几个存储QoS策略。设置为0：表示ZXUN uMAC不使用存储QoS策略。设置为非0的数字：表示ZXUN uMAC使用存储QoS策略。这种情况下，通常需要配置三个存储QoS策略，ZXUN uMAC使用的存储QoS策略、OMU虚机使用的QoS策略、LIG的虚机使用的存储QoS策略（在ZXUN uMAC支持LIG功能时，才需要配置）。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Storage QoS Policy Name|本参数用于设置ZXUN uMAC的存储QoS策略的名称。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Volume Type Name|本参数用于设置当前QoS策略关联的云硬盘类型名称。该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的TECS OpenStack）上创建的云硬盘对应的名称。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。云硬盘类型与存储QoS策略是一对一的关系，即：每个云硬盘类型只能关联1个存储QoS，每个存储QoS只能关联到1个云硬盘类型。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Total Input/Output Bytes Per Second (bytes/s)|总读写速度(字节/秒)，该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写速度。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Total Input/Output Bytes Per Second (bytes/s)|总读写IOPS（次/秒），该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写IOPS。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
##### VNF Network Qos 
配置原则 :VNF Network Qos页签用于配置ZXUN uMAC的网络QoS控制策略，必须配置。
 说明： 
网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略，通过此页签设置是否启用网络Qos功能，启用后，需要在VNF Network Setting或VNF Network Setting IPv6页签中修改网络Qos策略最大带宽值。
配置说明 :VNF Network Qos页签如[图1]所示。
图1  VNF Network Qos

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Qos Policy Count|本参数用于设置ZXUN uMAC的网络Qos策略的个数。规划了几个网络QoS策略供虚机使用，则此处就需要配置几个网络QoS策略。设置为0：表示ZXUN uMAC不使用网络QoS策略。设置为非0的数值：表示ZXUN uMAC使用网络QoS策略，数值为几，表示配置几个网络QoS策略。设置为此选项后，需要在VNF Network Setting或VNF Network Setting IPv6页签中修改网络Qos策略最大带宽值。|该参数根据实际项目要求设定，中国移动5GC二期项目场景：网元QoS个数为8。
Network Qos Policy Name|该参数用于设置ZXUN uMAC的网络QoS策略的名称。运营商可以定义多个网络QoS策略，每个网络QoS策略都设置一个对应的名称，每个虚机都可以配置一个对应的网络QoS策略，该网络QoS策略可以对虚机中的各个网卡进行限制。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|根据中国移动命令规范修改大区标识、硬件资源池编号、省份标识、网元标识以及网元编号，其他字段保持默认。
Max Egress Bandwidth (kbps)|（出口）双向最大带宽，该参数用于配置硬件服务器网卡出口的双向最大带宽。|本参数保持默认，无需修改。
Max Egress Bandwidth (kbps)|（出口）双向最大突发带宽，该参数用于配置硬件服务器网卡出口的双向最大突发带宽。|本参数保持默认，无需修改。
Max Ingress Bandwidth (kbps)|（入口）双向最大带宽，该参数用于配置硬件服务器网卡入口的双向最大带宽。|本参数保持默认，无需修改。
Max Ingress Burst Bandwidth (kbps)|（入口）双向最大突发带宽，该参数用于配置硬件服务器网卡入口的双向最大突发带宽。|本参数保持默认，无需修改。
##### VM Parameters 
配置原则 :VM Parameters页签用于配置ZXUN uMAC相关虚机的规格、最大个数、虚机归属的AZ域及HA、使用的云盘类型等信息，必须配置。
规划网络地址数据时，需要满足如下原则： 
规划内部网络平面的CIDR地址段中可用地址数量不小于所有虚机最大数的总和。 
规划IPU的外部网络平面的CIDR地址段中可用地址数量不小于所有IPU虚机最大数。 
配置说明 :VM Parameters页签如[图1]所示。
图1  VM Parameters

在配置本页签前，需要先了解ZXUN uMAC的VM规划数据，参见[表1]。
VM|描述
---|---
OMU|操作与维护单元，其中还包含一个用于辅助判断OMU主备状态的AMU单元。
GSU|通用业务单元（General Service Unit），负责处理ZXUN uMAC的控制面、信令面和媒体面业务。
IPU|接口处理单元（Interface Process Unit），提供各种类型的接口，用于ZXUN uMAC与除EM之外的其他网元进行通信。
CDU|云数据库单元，用于存储用户会话上下文等信息。
OMUE|OMUE虚机用于分担OMU的负荷。
IAU|这两种虚机是安全网关功能的虚机，在ZXUN uMAC启用安全网关功能功能时，才需要配置。
IMU|这两种虚机是安全网关功能的虚机，在ZXUN uMAC启用安全网关功能功能时，才需要配置。
参数说明参见[表2]。
参数名称|参数说明|配置指引
---|---|---
VM Flavor|本参数用于设置ZXUN uMAC虚机的规格，虚机的规格（flavor）于规定虚机占用的资源，包括虚拟内核个数、内存大小、磁盘空间大小、元数据等，包括：vCPU：CPU核数Memory (GB)：内存数Local Storage(GB)：本地存储Remote Storage(GB)：远端存储Redundancy Scheme：备份方式VM Count：虚机初始个数VM MAX Count：虚机最大个数|ZXUN uMAC虚机的规格（flavor）是由ZXUN uMAC部署的场景来决定的，即操作员先需要确认部署场景，每种场景都对应固定的虚机规格，确认了部署的场景，也就确认了需要配置的所有虚机的规格。在配置本参数前，操作员需要先通过配置VNF Scenario页签来配置场景，VNF Scenario页签中的参数VNF Scenario Name决定了VM Parameters页签中VM Flavor的数据。对于CDU虚机的VM Count参数，默认情况下，配置为2，当开启全量备份功能 ，即当VNF Scenario页面中的参数Item配置为开启全量备份，且VNF UDSFCfg Setting页面中的参数Tenant Count配置为2时，CDU虚机的VM Count参数需要配置为3。
Availability Zone|本参数用于设置ZXUN uMAC虚机所属的可用域（Availability Zones）的名称。|本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪个可用域（Availability Zones），就配置为哪个可用域（Availability Zones）的名称。
Host Aggregate Metadata|本参数用于设置HA元数据属性。|本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪种HA元数据属性的主机上，就配置为对应的HA元数据属性。
Anti-affinity Policy /Anti-affinity Factor|该参数用于设置Anti-affinity Policy（反亲和策略）或者Anti-affinity Factor（反亲和因子）。ZXUN uMAC只涉及到配置Anti-affinity Policy（反亲和策略）。该参数用于控制是否将一个虚拟机组（Server-group）中的多个同种类型的虚机（例如OMU虚机）分别部署在不同的主机上。包括如下选项：不限制表示系统不对虚机部署进行限制，即同种类型的虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。反亲和设置为此选项，表示系统需要对虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个同种类型的虚机必须分散部署在ZXUN uMAC所在可用域（Availability Zones）的不同主机上。设置为该参数后，操作员还可以通过反亲和组名来设置互斥组的名称。软反亲和设置为此选项，表示系统需要对同种类型的虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。|中国移动场景：均设置为Anti-affinity（反亲和）。
N Value for N+1 Redundancy Per VM Group|本参数用于设置虚机组支持N+1冗余中的N值。|N+1等于antiAffinityVMNumber，虚机最大数除以 N+1等于互斥组数量，建议保持默认值。
Anti-affinity Group Count|反亲和组个数即为互斥组个数，当虚机的部署策略设置为反亲和时，才会涉及到该参数的配置。简单来说，本参数决定了单个主机上所能部署的虚机的最大个数，即如果该参数设置为1，则单个主机上只能部署一个虚机，如果该参数设置为2，则单个主机上最多只能部署两个虚机。该参数设置为1，表示所有的虚机都在一个互斥组中，即这个互斥组中的每个虚机都必须分散部署在不同的主机上。在这种情况下，实际环境中的主机个数必须大于等于虚机的个数，否则就会部署失败，实例化不成功。该参数设置为2，表示所有的虚机平均分布在两个互斥组中，即每个互斥组中的虚机都必须分散部署在不同的主机上，但是组间的IPU虚机无需互斥部署。示例：如果部署了10个虚机，则1~5在一个互斥组中，6~10在一个互斥组中，其中1~5必须部署在不同的主机上，6~10必须部署在不同的主机上，但是5和7、3和8...，分别属于两个互斥组的虚机可以部署在同一个主机上。这种情况下，实际环境中的主机个数必须大于等于5个，否则就会部署失败，实例化不成功。|IPU和GSU-CGW虚机，Anti-affinity Group Count参数固定配置为1。其他类型的虚机，需要根据各个虚机的最大个数和实际环境中的计算节点个数来进行配置，计算原则如下：ZXUN uMAC的虚机支持7+1备份方式（即7个主用，1个备用），即部署ZXUN uMAC时，VIM需要至少提供8个计算节点。示例：如GSU-C-K1虚机的最大个数为100个，需要分别部署在8个计算节点上，Anti-affinity Group Count参数的值为100/8=10，即对于GSU-C-K1虚机，Anti-affinity Group Count参数需要配置为10。
VM Volume Type|本参数用于设置ZXUN uMAC的虚机使用的云硬盘类型。本参数的取值是通过Volume Types页签配置的。当在Volume Types页签中为ZXUN uMAC设定了多个云硬盘类型时，在本表格的下拉框中可以进行选择，参见“Volume Types（可选）”。|中国移动场景：根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001BZX”这一段。CDB对应的一行需要修改改成CDU。IAU和IMU虚机选择LDISK。
Priority of VM creation|该参数用于设置在实例化过程中，创建虚机资源的优先级，数字越小表示优先级越高。建议所有的虚机都使用默认值1，即所有的虚机的优先级都为最高，表示在实例化ZXUN uMAC的过程中，会并行创建所有虚机及相关资源。|使用默认值1。
Priority of VM restart|本参数用于设置虚拟机启动上电的优先级。取值范围为1~10，数值1表示优先级最高，数值10表示优先级最低。虚拟机启动上电时，虚拟机所在的服务器根据虚拟机对应的优先级进行处理，将优先级高的虚拟机先上电，将优先级低的虚拟机后上电。|一般情况下，建议将ZXUN uMAC的OMU的优先级设置为1。在部署了安全网关功能的情况下，需要将安全网关的虚机IAU的优先级设置为1。
VM Extern Size|本参数用于设置虚机规格别名。|建议保持默认值。
Backup Instance Number|本参数用于设置同组单批次允许下电的虚机数/比例。|主要作用是考虑OMU、AMU、OMUE在一个互斥组里，这三种类型的虚机，其Backup Instance Number需设置为1，建议保持默认值。
min_free_kbytes|本参数用于设置虚机内存水线。|建议保持默认值。
max_server_per_host|本参数用于设置硬互斥的互斥组可以在单个服务器上部署最大虚机数量。|针对亲和类型为反亲和（即硬反亲和）的虚机反亲和组有效。如果超过1个，硬互斥的互斥组也可以在单个服务器上部署最大为 max_server_per_host个虚机。如果配置为0，则表示无效，等同于1。建议保持默认值。
##### VRF Summary 
配置原则 :VRF Summary页签用于配置VRF，本页签已经预先配置了所有类型的NF可能涉及到的VRF，操作员不能删除原有默认的VRF，如果系统默认的VRF不适用运营商的组网规划，操作员可以根据实际情况在用户自定义VRF1中进行新增即可。
配置说明 :VRF Summary页签如[图1]所示。
VRF包括两部分内容： 
业务交换机侧的VRF数据 
ZXUN uMAC侧的VRF数据 
图1  VRF Summary

默认的VRF参数说明参见[表1]。
类别|VRF名称（示例）|说明|配置指引
---|---|---|---
业务交换机侧需要配置的VRF|mng|交换机管理口内置VRF。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
BOSS|业务交换机侧需要配置的VRF|可选，ZXUN uMAC部署为USPP/AAA/SSS/AGCF，与运营商的BOSS系统通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
CHARGING|业务交换机侧需要配置的VRF|用于ZXUN uMAC与Ga接口、Rf接口通信|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
EMS|业务交换机侧需要配置的VRF|用于ZXUN uMAC与EMS通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GI|业务交换机侧需要配置的VRF|用于ZXUN uMAC的Gi接口、SGi接口，Radius接口。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GTP|业务交换机侧需要配置的VRF|用于ZXUN uMAC的GTP接口（如S11/S5/S8接口）。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
RAN|业务交换机侧需要配置的VRF|用于ZXUN uMAC与2/3/4G网络的无线侧通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
SIG|业务交换机侧需要配置的VRF|用于ZXUN uMAC与不同业务域网元间信令互通。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
NF侧需要配置的VRF|SBI|用于ZXUN uMAC与5G网络中的SBI接口。在5G标准规范的系统架构中引入了服务化接口（即SBI）的概念，来表述一个NF提供其所具有的服务（或服务集合）给其它的NF使用的方式，在5G标准中一般采用Nxxx（如Namf，Nudm等）的方式表达。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
BOSS|NF侧需要配置的VRF|可选，ZXUN uMAC部署为USPP/AAA/SSS/AGCF，与运营商的BOSS系统通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
CHARGING|NF侧需要配置的VRF|用于ZXUN uMAC的Ga接口、Rf接口。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
EMS|NF侧需要配置的VRF|用于ZXUN uMAC与EMS通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GI|NF侧需要配置的VRF|用于ZXUN uMAC的Gi接口、SGi接口，Radius接口。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GTP|NF侧需要配置的VRF|用于ZXUN uMAC的GTP接口（如S11/S5/S8接口）。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
RAN|NF侧需要配置的VRF|用于ZXUN uMAC与2/3/4G网络的无线侧通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
SIG|NF侧需要配置的VRF|用于ZXUN uMAC与不同业务域网元间信令互通。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
##### VRouter Summary 
配置原则 :VRouter Summary页签用于配置ZXUN uMAC的虚拟路由。
 说明： 
当Global
Setting页签中的Network Type配置为VxLAN时（表示ZXUN uMAC使用SDN组网架构），操作员才需要配置此页签。
配置说明 :VRouter Summary页签如[图1]所示。
当ZXUN uMAC采用SDN+VxLAN组网时，需要在SDN中配置虚拟路由，这些数据会由TECS
OpenStack传递给SDN控制器。
图1  VRouter Summary

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VRouter Name|该参数用于配置VRouter的名称。|根据大区情况修改“HDBNJ03AZX-ah”这一段。
VRouter Usage|该参数用于描述VRouter的用途。|本参数保持默认，无需修改。
VRouter Deployment|本次实例化如果是第一个通过AIC自动工具部署的NF，选择本次实例化。当前已经存在如果此NF之前已经通过AIC自动工具部署完成，因为VRouter已经创建过，则选择当前已经存在。|中国移动5GC二期场景：会先部署AMF，再部署其他类型的NF，AMF需要设置为本次实例化，其他后续部署的NF，配置为当前已经存在。
##### VRouter External Network 
配置原则 :VRouter External Network页签用于配置ZXUN uMAC规划的网络平面相关信息。
本页签中的数据（比如VRouter、VRouter Deployment等）取值来源于VRouter Summary页签。
 说明： 
当Global Setting页签中的Network Type配置为VxLAN时（表示ZXUN uMAC使用SDN组网架构），操作员才需要配置页签。
配置说明 :VRouter External Network页签如[图1]所示。
当ZXUN uMAC采用SDN+VxLAN组网时，需要在SDN中配置虚拟路由，这些数据会由TECS
OpenStack传递给SDN控制器。
图1  VRouter External Network

本页需要修改的列是VLAN ID、Subnet CIDR、Gateway IP，其他保持默认。 
External Net Name列的参数需要根据省份实际情况进行修改。 
##### VNF SDN Network Setting 
配置原则 :VNF SDN Network Setting页签用于配置ZXUN uMAC规划的网络平面相关信息。
 说明： 
当Global
Setting页签中的Network Type配置为VxLAN时（表示ZXUN uMAC使用SDN组网架构），操作员才需要配置此页签。
配置说明 :VNF SDN Network Setting页签如[图1]所示。
 说明： 
在为各个网络平面规划IP地址时，所有的网络平面都不能使用172.17.0.0/16地址段中的IP地址。 
图1  VNF SDN Network Setting

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VNF Brief Name|本参数为网元简称。|本参数保持默认，无需修改。
Network Usage|ZXUN uMAC的各个网络平面的网络用途规定如下：内部控制面需要设置为INTERNAL MGT（内部管理通信）内部媒体面需要设置为INTERNAL SERVICE（内部服务通信）所有的外部网络平面需要设置为EXTERNAL（外部业务通信）ZXUN uMAC的网管平面的设置原则如下：OAM (Used OAM network of VNFM)ZXUN uMAC的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行二层互通。OAM (Used Shared IPv4 OAM Subnet)ZXUN uMAC的OAM平面（即网管平面）使用已存在的多网元共享的OAM网络平面（非VNFM的OAM平面）与VNFM进行三层互通。OAM (Create individual OAM network)ZXUN uMAC的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行三层互通。ZXUN uMAC的网管平面需要区别IPv4和IPv6分别设置。|本参数保持默认，无需修改。
Share Type|本参数用于配置网络透传模式。True：透传False：不透传参见以下原则进行配置：当NFVI启用QinQ功能时，需设置为True。对于网元内部网络平面，默认采用非透传模式，不可修改。对于业务外部网络平面需要使用透传模式时选择True，需要使用非透传模式时选择False。|本参数保持默认，无需修改。
vNIC Type|本参数用于配置业务虚机的网卡类型。normal：表示虚机的网卡启用OVS/DVS。SR-IOV：表示虚机的网卡启用SR-IOV。|本参数保持默认，无需修改。
Network Deployment|本参数用于配置ZXUN uMAC的网络平面是事先通过TECS OpenStack创建的，还是由操作员直接在LLD中配置的。对于所有的NF共用的网管平面，在部署ZXUN uMAC之前，如果已经创建成功，则网管平面需要配置为当前已存在。本次实例化如果操作员直接通过LLD创建ZXUN uMAC的网络平面，则需要配置为本次实例化。当前已经存在表示LLD中配置的网络平面，操作员已经预先通过TECSOpenStack创建成功，操作参见“创建网络平面”，LLD表格中填写的网络平面名称需要从TECS OpenStack处查询获取。|国内运营商场景：需要设置为本次实例化。
Brief Net Name|ZXUN uMAC的网络平面的简称。需要新增网络平面时，在红色底纹的空行处，在此列填写一个简要名称，就会自动增加一行网络平面，再选择对应的vNICType填写相应的网段、VLAN信息。|本参数保持默认，无需修改。
Net Name|该参数用于设置网络平面的名称。根据规划的数据进行创建。|中国移动场景：根据大区情况修改“HDBNJ-03A-ZX-01-VNET-ahAMF001BZ”这一段。其它运营商，根据实际情况进行修改。
VxLAN ID|该参数用于设置网络平面的VxLANID。|根据《主备网元局号和VxLAN划分》表中的规划填写。包括网管、业务起范围、TT网管、TT业务范围。业务号按顺序往下排。
Subport Count|本参数用于配置子接口个数。在网络透传模式下才需要填写此参数，表明对应网络平面生成的接口下规划多少个子接口。|本参数保持默认，无需修改。
SubNet IP Type|本参数为子网IP类型。|本参数保持默认，无需修改。
Subnet Name|本参数为子网名称。|根据大区情况修改“HDBNJ-03A-ZX-01-VNET-ahAMF001BZ”这一段。
Subport VLAN ID|本参数是VLAN子接口的ID。|本参数保持默认，无需修改。
VRouter|本参数为虚拟路由。|根据VRouter Summary页来选择。
VNF Side VRF|本参数为虚拟网元侧的虚拟路由ID。|本参数保持默认，无需修改。
Subnet CIDR|本参数为子网的网段范围。|为前几列集合，无需填写，自动生成。其中，9、10两行的地址查询IPv6、IPv4地址规划中的ChinaMobile_huawuNMS表各网元的地址填写，需注意掩码段的划分。 对于IPv6：A、B列不需要修改。C列的规则是【大区编号+数据中心编号+硬件资源池编号】，大区的十六进制编号，可以在中国移动网络云资源池二期组网、资源部署和数据配置原则文档里找到。D列是由VxLAN数值自动生成的，不需要修改。E、F、G、H列不需要修改。掩码无需修改。IPv4根据VLAN&VxLAN及IPv4私网地址评估表.xlsx中给网元分配的地址来填写。在为各个网络平面规划IP地址时，所有的网络平面都不能使用172.17.0.0/16地址段中的IP地址。
Gateway IP|本参数为网关IP地址。|根据Subnet CIDR地址修改Gateway IP地址。
MTU|该参数表示VNF的MTU数值，在运营商没有特殊要求的情况下，内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。 如果运营商对MTU有特殊要求，需要根据运营商的规范进行设置。|本参数保持默认，无需修改。
Network Qos Policy Name / Value|参数用于设置是否启用网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。|中国移动场景：根据网络平面选择。注意根据大区情况修改“HDBNJ-03A-ZX-01-NQOS-ahAMF001BZX”段相关信息。
Physical Network|该参数用于设置此网络平面对应的物理网络名称，根据规划数据，VNF的项目所有网络平面对应的物理网络名称都规划为physnet1。|本参数保持默认，无需修改。
Security Group|安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（SecurityGroup Rule）。需要预先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组的情况下，该参数的值才会生效。|本参数保持默认，无需修改。
###### 创建网络平面 
介绍如何创建预先在TECS OpenStack上创建ZXUN uMAC的网络平面及其子网。
登录TECS OpenStack
在PC客户端，打开Google Chrome浏览器，在地址栏输入https://x.x.x.x/ngportal/login
。
地址填写说明参见[表2]。
项目|说明
---|---
x.x.x.x|设置一个IP地址，需要设置为TECS OpenStack的主用控制节点的TECSClient网络平面的IP地址，操作员通过此地址可以使用浏览器登录TECSOpenStack的客户端。
按Enter键，页面自动转到登录页面，如[图2]所示。
初始登录TECS OpenStack客户端的默认用户名及密码如下： 
TECS OpenStack V3.17.14版本以上用户名：admin密码：Keystone 
TECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123 
图2  TECS OpenStack登录页面

输入用户名和密码，单击登录按钮，进入TECS OpenStack，默认显示为总览页面，如[图3]所示。
图3  TECS OpenStack总览页面

创建网络平面
在TECS OpenStack的客户端上，切换到云管理页面，在左侧导航栏中选择资源管理→网络
，右侧出现网络区域框，如[图4]所示。
图4  网络区域框

单击添加网络按钮，弹出添加网络对话框，如[图5]所示。
图5  创建网络对话框

创建网络对话框中的参数说明参见[表3]。
参数名称|参数说明
---|---
基本信息|项目|该参数用于设置该网络平面属于的项目。根据规划的数据进行创建。
名称|基本信息|该参数用于设置网络平面的名称。根据规划的数据进行创建。
网络类型|基本信息|该参数用于设置网络平面的网络类型，需要根据运营商的实际网络环境进行设置，包括以下选项。flatflat网络是指扁平网络，即VIM云平台本身不对业务网络进行VLAN隔离，只能依赖外部交换机过滤VLAN报文。从安全的角度考虑，在商用环境中，一般不建议使用flat网络类型。vlan如果运营商的组网环境为非SDN，建议设置为vlan。设置为此选项时，还需要设置物理网络和透传VLAN两个参数。vxlan如果运营商的组网环境为SDN，建议设置为vxlan。VXLAN是一种网络虚似化技术，是对VLAN技术的进一步优化，VXLAN提供和VLAN相同的二层网络服务，但相比VLAN有更大的扩展性和灵活性，用于解决在部署大型云计算设备时的数量扩展问题。
物理网络|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面对应的物理网络名称，根据规划数据，ZTE_uMAC_PROJ项目所有网络平面对应的物理网络名称都规划为physnet1。
VLAN透传|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面是否支持VLAN透传功能。根据的规划数据，ZTE_uMAC_PROJ项目的外部网络平面，建议勾选此参数。
段ID|基本信息|该参数用于设置设置VLAN ID。如果该网络平面支持VLAN透传功能，必须设置VLAN子接口范围。即段ID的格式需要设置为××:××:××，三个值分别表示为起始VLAN、终止VLAN和Native VLAN（PVID）。
高级属性|MTU|该参数表示系统的MTU数值。对于admin项目，所有网络平面的MTU数值都为1600。对于ZTE_uMAC_PROJ项目，用于内部控制面和内部媒体面通信的网络平面的MTU配置为1800，其它网络平面都固定为1500。
网络Qos|高级属性|该参数用于设置是否启用网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。
管理状态|高级属性|该参数建议保持默认值。
共享|高级属性|表示此网络平面属性是否为共享网络。在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。
外部网络|高级属性|默认情况下，建议不需要勾选。
参数设置完成后，单击创建按钮，完成网络平面的设置。
重复执行步骤，创建所有的网络平面。 
创建子网
在TECS OpenStack的客户端，切换到虚拟资源页面，在左侧的导航栏中选择网络
→网络
，出现网络页面，可以看到已经创建成功的网络平面。
在网络平面对应的操作下拉列表中，单击选择创建子网，弹出创建子网对话框，如[图6]所示。
图6  创建子网对话框

创建子网对话框的参数说明参见[表4]。
参数名称|描述
---|---
基本信息|名称|表示网络平面对应的子网名称，根据规划的数据进行设置。
CIDR|基本信息|表示子网的地址，根据规划的数据进行设置。
项目|基本信息|从下拉列表中选择网络平面对应的项目。
激活DHCP|基本信息|勾选此选项，开启DHCP功能后，在TECS OpenStack创建虚机时，会自动为虚机分配此网络平面的IP地址。需要根据实际情况决定是否开启此功能。
禁用网关|基本信息|该参数表示子网是否需要设置网关地址。对于网元内部通讯的网络平面，勾选本参数，不需要设置网关地址。对于网元外部通讯的网络平面，如果采用非SDN VLAN组网，勾选本参数，不需要设置网关地址。对于网元外部通讯的网络平面，如果采用SDN+VxLAN组网，不勾选本参数，需要设置网关地址。采用SDN+VxLAN组网时，需要在SDN中配置路由，因此必须配置网关IP地址，该网关地址会通过TECSOpenStack传递给SDN控制器。
网关IP|基本信息|该参数表示网关地址，勾选禁用网关后，无需设置该参数。
高级属性|地址池|暂不涉及此参数，无需配置。
域名服务器|高级属性|暂不涉及此参数，无需配置。
主机路由|高级属性|暂不涉及此参数，无需配置。
设置完参数后，单击创建按钮，完成网络平面对应子网的创建。
重复执行步骤，创建所有的子网。 
##### VNF Operation and Maintenance 
配置原则 :VNF O&M IPv6页签用于修改ZXUN uMAC的操作维护网段的公网及浮动IP地址，必须配置。
 说明： 
在本页签中，仅需要修改H列的内容，H列根据C列地址段范围内前三个地址按顺序填写，对于VNF O&M IPv6页签中其他参数，取值为固定值，操作员不需要修改。
配置说明 :VNF O&M IPv6页签如[图1]所示。
图1  VNF操作维护网段地址

##### VNF Vlan Trunk IP 


配置原则 :VNF Vlan Trunk IP页签用于配置IPU虚机的IP地址范围。
本页签的配置场景如下： 

 
在运营商的组网规划中，如果将多个NF的IP地址规划到同一个网段中，本页签必须配置，为了避免各个NF之间的IP地址冲突，通过配置本页签，为IPU虚机分配固定范围内的IP地址，防止发生IP地址抢占，导致实例化失败。 

 
如果运营商的组网规划，为每个NF都单独规划了一个网段，则操作员不需要配置本页签。 

 


配置说明 :VNF Vlan Trunk IP页签如[图1]所示。
本页签配置的IP地址是为实例化成功后，系统为IPU虚机分配的IPv4或IPv6地址。
图1  VNF Vlan Trunk IP




参数说明参见[表1]。
参数名称|参数说明
---|---
Extern Network PortIpList|该参数在运营商的某种特殊的组网规划下才需要配置，运营商的组网规划中，如果将多个NF的地址规划到同一个网段中，为了避免各个NF之间的IP地址冲突，可以通过配置本参数，为IPU虚机分配固定范围内的IP地址，防止发生IP地址抢占，导致实例化失败。因为IPU虚机的最大弹性伸缩的个数为20，此处需要配置20个IP地址，初始实例化成功后，IPU虚机默认为两个，系统从此参数配置的IP地址列表中按顺序分配给IPU，后续对IPU进行弹扩操作时，系统会从此参数配置的IP地址列表中，按顺序分配IP地址给新弹扩的虚机。
Subnet PortIpList|该参数用于配置SDN组网场景下，配置外部网络平面的child（子）网络平面的IP地址范围。当Global Setting页签中的Network Type配置为VxLAN时（表示使用SDN组网架构），操作员才需要配置此参数。


##### VNF Advanced Settings 
配置原则 :VNF Advanced Settings页签用于设置ZXUN uMAC的属性，必须配置。
配置说明 :VNF Advanced Settings页签如[图1]所示。
图1  VNF Advanced Settings

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
业务系统名称|本参数用于设置ZXUN uMAC实例化成功后，在MANO上看到的ZXUN uMAC的名称。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|业务系统名称|根据运营商的规范修改大区标识、网元编号、硬件资源池编号、AZ编号。
蓝图包名称|本参数用于设置在MANO上快速创建ZXUN uMAC的版本包时，配置的ZXUN uMAC名称。|蓝图包名称|根据运营商的规范修改省份标识、网元编号。
蓝图包版本号|本参数用于设置在MANO上快速创建ZXUN uMAC的版本包时，配置的ZXUN uMAC版本包的版本号。|蓝图包版本号|此处配置的是交付运营商的软件包的对外版本号。不是中兴通讯内部的版本号。
蓝图包厂商|本参数用于设置在MANO上快速创建ZXUN uMAC的版本包时，配置的厂商名称。|蓝图包厂商|中国联通场景，本参数需要设置为ZX。中国移动场景，本参数需要设置为ZT。中国电信场景，本参数需要设置为ZE。其他场景，本参数需要设置为ZTE。
镜像包名称|本参数用于设置在MANO上快速创建版本包时，设置的厂商名称。|镜像包名称|根据运营商的规范修改大区标识、硬件资源池编号、省份标识、网元编号。
LIG镜像包名称|本参数用于设置在MANO上快速创建安全网关版本包时，设置的厂商名称。|LIG镜像包名称|
接入的EMS地址|本参数用于配置VNF部署后，需要接入的EMS地址。实例化VNF时，会将该地址传给VNFM，在实例化VNF完成后由VNFM将VNF自动接入指定的EMS。该功能需VNFM上提前打开功能开关。|接入的EMS地址|-
所属地域|本参数用于设置ZXUN uMAC归属的地域，在某些特殊运营商的要求下，才需要配置。|所属地域|配置原则：归属省份，如果ZXUN uMAC归属的地区是广州市，那么该参数配置为广东省。
分权网元类型|本参数用于设置ZXUN uMAC的网元类型，在某些特殊运营商的要求下，才需要配置。|分权网元类型|本参数的配置原则：4、5G融合部署场景：MME/SGSN/AMF4G部署场景：MME/SGSN5G部署场景：AMF
虚机名称前缀|在某些特殊运营商的要求下，才需要设置此参数。需要根据规范配置：所属省份标识+网元标识+网元序号+网元属性+厂家标识。命名规范格式如下所示，分为多个部分，每个部分之间用短横线-连接：网元归属省/大区：由2-3位英文字母组成，示例：js网元标识：由1-8位英文字母组成，示例：MME网元序号：由1-3位数字组成，示例：12网元属性：两个取值，A表示骨干，B表示省内。厂家标识：由2-3位英文字母组成，示例：ZX|虚机名称前缀|命名规范格式如下所示，分为多个部分，每个部分之间用短横线-连接：网元归属省/大区：由2-3位英文字母组成，示例：js网元标识：由1-8位英文字母组成，示例：MME网元序号：由1-3位数字组成，示例：12网元属性：两个取值，A表示骨干，B表示省内。厂家标识：由2-3位英文字母组成，示例：ZX
云主机类型命名规则|本参数用于配置云主机类型的命名规则，即实例化ZXUN uMAC成功后，在VIM云平台上显示的ZXUN uMAC虚机名称。本参数有两个配置值：none和auto_flavor_name。本参数配置为none，表示ZXUN uMAC虚机名称的命名规则为：ram_x_vcpus_x_disk_x_uuid在运营商没有特殊要求的情况下，默认使用此种规则。本参数配置为auto_flavor_name，表示ZXUN uMAC虚机名称的命名规则为：资源前缀-FLA-自定义ID在以下几种场景下，必须配置为此种规则：当Global Setting页签中Application scenarios设置为12-CMCC Phase2、11-CMCC Phase1和1-5GS三种场景之一时当Global Setting页签中的参数Mano Protocol Mode配置为CMCC时。|云主机类型命名规则|中国移动场景：本参数配置为auto_flavor_name，表示ZXUN uMAC虚机名称的命名规则为配置为资源前缀-FLA-自定义ID。
镜像可视性|该参数用于设置ZXUN uMAC的虚机操作系统镜像的属性，一般配置为private（私有），在特殊情况下，才需要配置为public（共享），建议使用默认值。publicprivate|镜像可视性|国内运营商场景：固定配置为private。
启用密文传输敏感数据|本参数通常情况下，建议设置为启用，启用此功能后，VNFD版本包插件的内容中不会有明文密码等敏感信息，系统会进行加密处理。|启用密文传输敏感数据|国内运营商场景：固定配置为启用。
对接VNFM的IP地址版本|本参数用于配置ZXUN uMAC对接VNFM的IP地址类型，根据实际组网规划配置。|对接VNFM的IP地址版本|-
vnf和vnfm间会话协议类型|该参数用于配置VNF和VNFM之间的会话协议类型，VNF和VNFM之间支持双向认证，配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为http。如果运营商的部署环境，开启了安全加固功能，则此参数配置为https。|vnf和vnfm间会话协议类型|国内运营商场景：固定配置为https。
vnf向vnfm获取token|该参数用于设置VNF是否可以向VNFM获取token。token是计算机术语，表示令牌的意思，令牌是一种能够控制站点占有媒体的特殊帧，以区别数据帧及其他控制帧。通俗的说法，token可以称为暗号，在一些数据传输之前，服务端和客户端之间要先进行暗号的核对，不同的暗号会被授权不同的数据操作权限。Token是在服务端产生的。如果客户端使用用户名/密码向服务端请求认证，服务端认证成功，那么服务端会给客户端返回一个Token。客户端可以在每次发起请求消息时，携带Token证明自己的合法地位。该参数的配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为不启用。如果运营商的部署环境，开启了安全加固功能，则此参数配置为启用。|vnf向vnfm获取token|国内运营商场景：固定配置为启用。
vnf向vnfm获取token的用户名|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。|vnf向vnfm获取token的用户名|VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其它的用户，操作方式参见“在VNFM上创建的API用户的方法”需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。
vnf向vnfm获取token的密码|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。|vnf向vnfm获取token的密码|VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其它的用户，操作方式参见“在VNFM上创建的API用户的方法”需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。
部署配置脚本文件名称|本参数用于在实例化部署中，是否同时配置一些基础的业务数据，这些业务数据是通过脚本文件来进行自动化配置的。|部署配置脚本文件名称|国内运营商场景：此参数不涉及配置。
是否以root用户启动容器|该参数用于配置是否可以使用root用户。|是否以root用户启动容器|国内运营商场景：固定设置为启用。
启用虚机规格别名|此参数的配置结果 ，涉及到在ZXUN uMAC部署成功后，MANO和EM上显示的虚机名称。如果配置为启用，使用配置的虚机规格别名（vmexternsize）如果配置为不启用，或者虽然配置为启用，但并没有配置数据，则从template中获取vm_size，当vm_size中包含的原始虚机类型名有别名时，则使用别名替换vm_size中的原始虚机类型名。|启用虚机规格别名|此参数的值不需要操作员配置，是由ZXUN uMAC部署的场景来决定的。在配置本参数前，操作员需要先通过配置VNF Scenario页签来配置场景（参见VNF Scenario），VNF Scenario页签中的参数VNF Scenario Name决定了此参数的值，操作员不需要修改。
开启容器selinux功能|本参数用于配置，是否开启容器selinux功能。|开启容器selinux功能|国内运营商场景：固定设置为不启用。
虚机规格调整时的重建方式|本参数用于配置调整虚机规格时，虚机的重建方式。rebuild指VNFM内部执行虚机的先删再建操作。set指VNFM对虚机执行nova resize操作。|虚机规格调整时的重建方式|国内运营商场景：固定设置为set。
镜像看门狗超时措施|本参数用于设置启用镜像watchdog功能后，自动触发的动作（watchdog_action）。ZXUN uMAC定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。|镜像看门狗超时措施|国内运营商场景：固定配置为reset。
虚机看门狗超时措施|本参数用于设置启用虚机watchdog功能后，自动触发的动作。（watchdog_action）。ZXUN uMAC定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。|虚机看门狗超时措施|国内运营商场景：固定配置为none。
虚机看门狗监控时长(分钟)|该功能用于设置虚机看门狗超时（watchdog_enabledelay）时长。该时长是VM启动后，到首次喂狗动作之间的时间间隔，如果超过这个间隔没有进行喂狗操作，则会触发watchdog_action的动作。如果虚机看门狗触发动作（watchdog_action）配置为reset，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM会主动复位虚机。如果虚机看门狗触发动作（watchdog_action）配置为none，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM不会执行复位虚机的操作。|虚机看门狗监控时长(分钟)|默认值为600000毫秒，即10分钟。通常情况下建议使用默认值。
启用虚机别名|这两个参数的配置结果 ，涉及到在ZXUN uMAC部署成功后，MANO和EM上显示的虚机名称。|启用虚机别名|此参数的值不需要操作员配置，是由ZXUN uMAC部署的场景来决定的。在配置本参数前，操作员需要先通过配置VNF Scenario页签来配置场景（参见VNF Scenario），VNF Scenario页签中的参数VNF Scenario Name决定了此参数的值，操作员不需要修改。
OMU虚机|MGT平面端口的网络QoS|本参数用于配置MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面中所有的端口级别的网络Qos策略。如果此处不配置数据，则ZXUN uMAC默认使用端口所在的网络平面上配置的的网络Qos策略（参见“VNF Network Qos”）。如果此处配置了数据，则MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面的端口优先使用本参数配置的网络Qos策略。这些网络Qos策略后续需要在VNF SDN Network Setting（SDN组网架构）和VNF Network Setting（非SDN组网架构）页签中被使用。|本参数配置的网络Qos策略的优先级最高。
SERVICE平面端口的网络QoS|OMU虚机|本参数用于配置MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面中所有的端口级别的网络Qos策略。如果此处不配置数据，则ZXUN uMAC默认使用端口所在的网络平面上配置的的网络Qos策略（参见“VNF Network Qos”）。如果此处配置了数据，则MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面的端口优先使用本参数配置的网络Qos策略。这些网络Qos策略后续需要在VNF SDN Network Setting（SDN组网架构）和VNF Network Setting（非SDN组网架构）页签中被使用。|本参数配置的网络Qos策略的优先级最高。
EMS平面端口的网络Qos|OMU虚机|本参数用于配置MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面中所有的端口级别的网络Qos策略。如果此处不配置数据，则ZXUN uMAC默认使用端口所在的网络平面上配置的的网络Qos策略（参见“VNF Network Qos”）。如果此处配置了数据，则MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面的端口优先使用本参数配置的网络Qos策略。这些网络Qos策略后续需要在VNF SDN Network Setting（SDN组网架构）和VNF Network Setting（非SDN组网架构）页签中被使用。|本参数配置的网络Qos策略的优先级最高。
cpu_model参数|OMU虚机|对应flavor中的hw:cpu_model参数。不同种类的虚机可以根据实际部署时使用的计算节点CPU类型进行配置。|中国移动场景：配置该参数之前，需要在TECS OpenStack控制节点上，通过命令查询虚机部署使用的计算节点的cpu信息，示例：sourcekeystonerc_admin nova hypervisor-show Computer0102 |grep  cpu_info_modelHaswell如果非中国移动的其他运营商没有特殊要求，本参数默认为空。
mem_page_size参数|OMU虚机|该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。取值范围为large、any、small/4/4KB、2048/2048KB/2MB、1048576/1GB中的任何一个。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：只使用巨页，目前主机支持的巨页只有1G和2M两种，即只从这两种页面选择。small/4/4KB：三者含义一致，配置为其中任何一个值时都只使用小页，即只选择4KB大小的页面。2048/2048KB/2MB：三者含义一致，配置为其中任何一个值时都是只选择2MB的页面。1048576/1GB：二者含义一致，配置为其中任何一个值时都是只选择1GB的页面。|国内运营商场景：固定配置为large。
numa_nodes参数|OMU虚机|该参数建议采用默认值。在使用SR-IOV网卡部署虚机的场景才涉及到该参数的配置。hw:numa_nodes是用于指定虚机使用的NUMA节点数。hw:numa_nodes的取值表示不大于计算节点的NUMA节点个数的整数，通常取值为1和2。hw:numa_nodes取值为1：表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。|-
是否启用TECS私有参数|OMU虚机|本参数的适用场景：使用中兴通讯自研的VIM平台TECS OpenStack。disable：虚机只部署在某个numa上enable：虚机可部署在任意numa上|国内运营商场景：固定配置为disable。
capabilities:flows参数|OMU虚机|本参数用于配置虚机对流表资源的要求。本参数的适用场景：采用SDN组网架构，需要将流表资源需求较高的虚机，部署到合适的服务器上。使用中兴通讯自研的VIM平台TECS OpenStack，且TECS OpenStack对应的版本号为3.17.15.P10及以上版本，如果低于此版本，配置此参数会导致实例化失败。|如果不启用此功能，则此参数配置为空。如果需要启用此功能，则需要联系中兴通讯技术支持工程师获取配置值。
其他虚机的配置数据参见OMU虚机|其他虚机的配置数据参见OMU虚机|其他虚机的配置数据参见OMU虚机|其他虚机的配置数据参见OMU虚机
OAM接入EMS的NAT IP地址|根据ZXUN uMAC的管理接口与EMS对接时的实际情况进行配置：如果两者之间需要通过防火墙，则此参数配置为管理接口的IP地址经过NAT转换后的地址。如果两者之间不需要通过防火墙，则此参数无需配置。|OAM接入EMS的NAT IP地址|-
##### VNF UDSFCfg Setting 
配置原则 :VNF UDSFCfg Setting页签用于配置ZXUN uMAC的数据备份参数，必须配置。
配置说明 :当ZXUN uMAC没有开启全量备份功能时，VNF UDSFCfg Setting页签如[图1]所示。
图1  VNF UDSFCfg Setting（没有开启全量备份）

主要参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Tenant Count|本参数用于配置租户的个数。|配置原则如下：使用默认值1，表示ZXUN uMAC没有开启全量备份功能。ZXUN uMAC的数据备份方式采用全量备份时，该参数需要设置为2，表示需要两个租户。当VNF UDSFCfg Setting页面中的参数Tenant Count配置为2时，VM Parameters页面中的CDU虚机的VM Count参数需要配置为3，参见”VM Parameters“
Tenant Name|本参数用于配置租户的名称。|配置原则如下：ZXUN uMAC部署为AMF时，必须和SET AMFLOCALOFFICECFG命令中配置的参数AMF名称一致。ZXUN uMAC部署MME/SGSN，没有特殊要求，可以使用默认名称。
MasterNfId|本参数用于配置主用租户的局号。|两个ID不能相同，取值范围：1~255。
SlaveNfId|本参数用于配置备用租户的局号。|两个ID不能相同，取值范围：1~255。
其他参数使用默认值。|其他参数使用默认值。|其他参数使用默认值。
在ZXUN uMAC在开启全量备份的情况下，网络中需要配置两个租户，即本AMF和接管AMF，本AMF和接管AMF互为备份：
租户的名称和ID是通过VNF UDSFCfg Setting页签配置的。 
这两个租户，哪一个租户为主用租户，哪一个租户为备用租户，是通过VNF Scenario页签的参数Master Tenant ID配置的。Master Tenant ID配置为2，表示租户2为主用。Master Tenant ID配置为1，表示租户1为主用。 
本AMF（本文档示例名称为AMF-145）的VNF UDSFCfg Setting页签如[图2]所示。
图2  本AMF


接管AMF（本文档示例名称为AMF-146）的VNF UDSFCfg Setting页签如[图3]所示。
图3  接管AMF

##### VNF Resourse Naming Rules 
配置原则 :VNF Resourse Naming Rules用于配置ZXUN uMAC使用的虚拟资源的规范，需要根据各个运营商的实际情况进行配置。
配置说明 :VNF Resourse Naming Rules页签如[图1]所示。
图1  VNF Resourse Naming Rules

##### Heat Scripts（可选） 
配置原则 :Heat Scripts配置为ZXUN uMAC规划的网络平面相关信息。此处配置的数据，后续通过AIC(iDeploy)工具中的Heat Script脚本来自动创建实例化ZXUN uMAC时所需要的虚拟资源。
 说明： 
当Global Setting页签中的Support Heat Script配置为Yes时，操作员才需要配置此页签。
配置说明 :Heat Scripts页签如[图1]所示。
图1  Heat Scripts

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
-|OSP_Version|本参数配置为OSP版本的名称，osp13是queens，osp16是train。表示ZXUN uMAC需要部署的VIM云平台为OpenStack Platform ，OSP是OpenStack Platform开源项目的服务。|根据规划进行配置。
Tenant_Name|-|本参数配置为VNF对应的租户。|此单元格的值是由Tenant & Users页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
flavor|Flavor_Script_description|本参数用于描述flavor脚本的信息，如版本和用途。|-
Tenant_Owner|flavor|-|-
sriov_host_aggr_default|flavor|本参数用于配置主机集合名称。|此单元格的值是由Host Aggregate页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
VM_Name_Prefix|flavor|本参数用于配置flavor名称前缀。|本参数的取值来源于Global Setting页签中的Resource Prefix参数值 ，参见“Global Setting”，需要操作员确认是否正确即可，此处自动引用，无需修改。
VNF_name|flavor|本参数用于配置VNF名称。|此单元格的值是由VNF ID页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
Ephemeral|flavor|本参数用于配置数据盘大小。如果是本地盘，根据规格填写。如果使用云存储，该值为0。|-
Disk|flavor|本参数用于配置系统盘大小。如果是本地盘，根据规格填写。如果使用云存储，该值为0。|-
Flavor_resource_is_public|flavor|本参数用于标识flavor是公有或私有。对于非admin，私有意味着只有特定租户可以看到并使用该flavor。|-
Numa_nodes|flavor|本参数是用于指定虚机使用的NUMA节点数。本参数取值表示不大于计算节点的NUMA节点个数的整数，通常取值为1和2。取值为1：虚机不可跨NUMA部署，表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：虚机可跨NUMA部署，表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。|根据本文档规划的场景，该参数需要配置为1。
CPU_Policy|flavor|本参数用于配置，CPU是否要求绑核。|-
Mmem_page_size|flavor|该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。取值范围为large、any、small/4/4KB、2048/2048KB/2MB、1048576/1GB中的任何一个。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：只使用巨页，目前主机支持的巨页只有1G和2M两种，即只从这两种页面选择。small/4/4KB：三者含义一致，配置为其中任何一个值时都只使用小页，即只选择4KB大小的页面。2048/2048KB/2MB：三者含义一致，配置为其中任何一个值时都是只选择2MB的页面。1048576/1GB：二者含义一致，配置为其中任何一个值时都是只选择1GB的页面。|当VIM使用RedHat平台时，根据本文档规划的场景，该参数需要配置为large。
networks|Networks_Script_description|本参数用于描述networks脚本的信息，如版本和用途。|-
Tenant_Uid|networks|租户ID。|-
Availability Zone|networks|本参数用于配置可用域名称。|此单元格的值是由Host Aggregate页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
Standard_Physnet|networks|basic physical network name，用于除flat平面外的网络平面|-
Sriov_Physnet_Oiaasnet1|networks|sriov physical name oiaas-net1 (left domain)，用于左域的flat平面|-
Sriov_Physnet_Oiaasnet2|networks|sriov physical name oiaas-net2 (right domain)，用于右域的flat平面|-
Network|NetworkName|该参数用于设置网络平面的名称。|根据规划进行配置。
admin_stateup|Network|-|配置为True。
PortSecurityEnable|Network|本参数用于配置是否启用端口安全组。|配置为false。
Shared|Network|本参数用于表示此网络平面属性是否为共享网络。本参数的配置原则如下：在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。|本文档规划的部署场景为非SDN组网，本参数配置为shared（共享）类型。
NetworkType|Network|本参数用于设置ZXUN uMAC需要部署的VIM云平台的网络类型。SDN组网场景时，该参数需要设置为VxLAN。非SDN组网场景时，该参数需要设置为VLAN。|根据本文档规划的场景，本参数配置为VLAN。
MTU|Network|该参数表示VNF的MTU数值。|在运营商没有特殊要求的情况下，内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。如果运营商对MTU有特殊要求，需要根据运营商的规范进行设置。
SegmentationId|Network|-|根据规划进行配置。
Subnet_Name|Network|该参数用于设置网络平面的子网名称。|根据规划进行配置。
IPVersion|Network|-|根据规划进行配置。
EnableDHCP|Network|该参数用于设置是否启用DHCP功能。开启DHCP功能后，在VIM云平台创建虚机时，会自动为虚机分配此网络平面的IP地址。|需要根据实际情况决定是否开启此功能。
CIDR|Network|本参数用于配置子网的网关IP地址。|根据规划进行配置。
Gateway IP|Network|本参数用于配置子网的掩码。|根据规划进行配置。
##### Version File 
配置原则 :Version File页签用于配置ZXUN uMAC的版本文件名称。
 说明： 
操作员需要根据实际环境中获取的软件版本名称，和表格中FileName核对，确认版本号正确即可。
配置说明 :Version File页签如[图1]所示。
图1  Version File

参数说明参见[表1]。
参数名称|参数解释|配置指引
---|---|---
FileName|版本包的名称。|需要与实际文件名保持一致。
##### Image Setting 
配置原则 :Image Setting页签用于配置在实例化ZXUN uMAC过程中，是否使用镜像包名称自动修改功能。
 说明： 
此处的镜像包是指创建虚机时使用的CGSL操作系统镜像文件包（通常以cgsl.vXXX.zip的形式命名，包含操作系统和双机软件）。 
本参数需要根据运营商的情况进行配置。 
国内运营商场景（如中国移动），需要根据运营商的命名规范来修改镜像包的名称，本页签需要配置为YES，后续是通过“修改镜像文件名称”操作进行配置的。 说明：“修改镜像文件名称”操作必须在实例化操作前执行。 
如果运营商对镜像包名称没有特殊要求，操作员可以使用默认值 ，则本页签需要配置为NO。 
配置说明 :Image Setting页签如[图1]所示。
图1  Image Setting

##### VNF SFTP Server 
配置原则 :VNF SFTP Server页签用于在实例化ZXUN uMAC的过程中，需要通过FTP方式将需要的各类软件包上传至NFVO服务器指定路径下。
 说明： 
本页参数无需修改。 
配置说明 :VNF SFTP Server页签如[图1]所示。
图1  VNF SFTP Server

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
SFTP server IPv4/IPv6 address|本参数用于设置上传、导入版本包时使用的SFTP服务器IP地址。此处需要配置可以和NFVO的网管平面互通的IP地址。存放在SFTP服务器的软件，需要通过FTP方式上传至NFVO服务器的指定路径下，所以SFTP服务器的地址，是需要与NFVO的网管网络平面互通的地址。|本页参数无需修改。
SFTP username|本参数用于设置访问SFTP服务器的用户名。默认用户名为root。|本页参数无需修改。
SFTP password|本参数用于设置访问SFTP服务器的密码。默认的密码为CloudStudio__123，其中__为两个下划线。|本页参数无需修改。
Path|本参数用于设置FTP服务器上存放ZXUN uMAC的基础包路径，此处需要设置为绝对路径。可设置为基础包的具体文件所在路径或上一级目录。设置为目录时，可上传该目录下的所有软件包。此路径需要开通可写权限，此路径在部署ZXUN uMAC前需要已经存在。|本页参数无需修改。
Delete version packages after successful deployment|本参数用于配置ZXUN uMAC部署成功后，是否自动删除SFTP服务器上的版本包。YES：删除如果临时使用VNFM为SFTP服务器，建议删除。NO：不删除如果后续还会部署相同版本的ZXUN uMAC时，建议不需要删除，后续操作可以继续使用当前已经上传的版本包。|本页参数无需修改。
##### NS Info 
配置原则 :NS Info页签用于配置在ZXUN uMAC部署成功后，是否还继续创建NS实例来纳管本ZXUN uMAC。
配置说明 :NS Info页签如[图1]所示。
图1  NS Info

参数说明参见[表1]。
参数名称|参数解释|配置指引
---|---|---
是否执行NS纳管VNF|本参数用于配置在ZXUN uMAC部署成功后，是否还需要创建NS实例来纳管本ZXUN uMAC。|根据运营商的规划进行配置。
NS蓝图包名称|本参数用于配置NS蓝图包名称。|根据运营商规范命名，无规范时自定义。建议与网元实例名称对应，例如：NSD-HDBNJahSMF001BZX-03AZX011
NS蓝图包厂商|本参数不需要操作员配置。|本参数的取值来源于VNF Advanced Settings页签中的蓝图包厂商参数值 ,参见VNF Advanced Settings，此处自动引用，无需修改。
NS蓝图包版本号|本参数用于配置版本号。|根据运营商的规范填写，在运营商没有规范的情况下，需要配置为默认值：1.0。
NS实例名称|本参数用于配置NS实例名称。|根据运营商规范命名，运营商没有规范时，操作员可以自定义。建议参考VNF命名规范的定义，前缀改成"NS-"。例如： NS-HDBNJahSMF001BZX-03AZX011
NS实例类型|本参数用于配置NS类型。|本参数配置为固定值5GC。
NS实例规格|本参数用于配置NS规格。|本参数配置为固定值Default。
NS实例操作场景|本参数用于配置NS场景。|本参数配置为固定值access。
NS实例中纳管的VNF实例名称|本参数不需要操作员配置。|本参数的取值来源于VNF Advanced Settings页签中的业务系统名称参数值 ,参见VNF Advanced Settings，此处自动引用，无需修改。
纳管的VNF实例所在的VIM名称|本参数的取值来源于Global Setting页签中的VIM Name参数值 ,参见VNF Advanced Settings，此处自动引用，无需修改。|本参数不需要操作员配置。
需纳管的vRouter列表|本参数不需要操作员配置。|本参数的取值来源于VRouter Summary页签中的VRouter Name参数值 ,参见VRouter Summary，此处自动引用，无需修改。
##### VNF Static Route 
配置原则 :VNF Static Route页签用于配置SDN到ZXUN uMAC的业务地址的静态路由数据。
 说明： 
通常情况下，这些数据可以在ZXUN uMAC实例化成功后，由操作员手动进行配置，不需要在本页签中进行配置。
配置说明 :VNF Static Route页签如[图1]所示。
图1  VNF Static Route

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Service IP|目的地址列表。|填写为空值，表示无需配置该网络平面的静态路由。
Source IP|即源地址列表。|填写为空值，表示无需配置该网络平面的静态路由。
VRouter Usage(VPN)|该列可以不填写，不影响静态路由配置。|默认数据取自VRouter Summary页签中的B列。
##### VPC（可选） 
配置原则 :VPC页签用于配置VPC相关的数据，即两个Vrouter之间的互通数据，在运营商开启了VPC功能的场景下，才需要配置。
 说明： 
通常情况下，VPC数据可以在ZXUN uMAC实例化成功后，由操作员手动进行配置，不需要在本页签中进行配置。
配置说明 :VPC（Virtual Private Cloud )：用户基于云服务商创建的自定义的私有网络，实现二层的逻辑隔离。 
VPC页签如[图1]所示。
图1  VPC

##### TAP Service和TAP Flow（可选） 
配置原则 :TAP Service和TAP Flow页签用于配置流镜像相关的数据。
在运营商开启了流镜像功能的场景下，才需要配置，如果运营商没有开启流镜像功能，则操作员需要将这两个页签中默认的数据全部删除。 
 说明： 
TAP Service和TAP Flow页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
配置说明 :流镜像是VIM云平台（本文档指中兴通讯的TECS OpenStack）中的neutron组件实现的一种网络端口镜像的功能，可以对网络流量进行监控，在网络出现问题时，维护人员通过流镜像可以快速发现和定位故障。 
配置流镜像，是指把某个虚机（源虚机）的报文复制到其他虚机（目的虚机）的网卡或者物理交换机端口。 
TAP Service页签如[图1]所示。
图1  TAP Service

TAP Flow页签如[图2]所示。
图2  TAP Flow

参数说明参见[表1]。
参数名称|参数说明
---|---
TAP Service Name|本参数用于配置目的虚机网卡和物理交换机端口，即抓包端口。
TAP Flow Name|本参数用于配置源虚机的端口，即需要镜像报文的端口。可以指定镜像的报文方向和使用的流镜像过滤器。
#### 导出LLD 
VNF LLD Template AMF.xlsm中的所有的页签配置完成后，切换到Run页签，如[图1]所示。
图1  Run页签

单击生成VNF规则数据，弹出提示框，如[图2]所示。
图2  提示框

单击是，开始自动生成VNF规划数据，如[图3]所示。
图3  提示框

单击确定按钮，回到ZXUN-uMAC AIC (iDevise)
Plugin Edition.xlsm页面，如[图4]所示。
图4  ZXUN-uMAC AIC (iDevise) Plugin Edition.xlsm页面

单击右上方的Next按钮旁边Output LLD，如[图5]所示。
图5  Output LLD页签

单击下方的Output按钮，系统输出最终的LLD文件，在ZXUN-uMAC AIC (iDevise) Plugin Edition.xlsm文件同级目录下会生成最终的LLD，名字为ZTE
NFV LLD(AMF) New Project.xlsx，此文件即为iDeploy部署时所要使用的最终LLD文件，如[图6]所示。
图6  ZTE NFV LLD(AMF) New Project.xlsx

#### 部署VNF 
概述 :本节介绍通过AIC自动部署工具AIC(iDeploy)V3.21.10.10部署ZXUN uMAC的过程，iDeploy自动完成ZXUN uMAC所需虚拟资源的创建和业务程序的自动部署。
前提 :在执行安装前，操作员需要已经从中兴通讯技术支持人员处获取了所有的软件安装信息，包括对应版本号等内容。 
操作员需要获取几种类型的软件安装包，根据获取方式的不同，分为两大类： 
从AIC工具处获取软件包。详细内容参见表1。表1  从AIC工具处获取的版本文件类型名称功能描述AIC工具中的iDeployAIC(iDeploy)V3.22.07通过导入部署所需的LLD文件和版本文件，实现端到端自动化部署ZXUN uMAC。此软件包从AIC工具处获取。 说明：采用AIC工具部署，需要检查工具的License是否过期，如果已过期或快过期，需要提前申请新的License。 
从ZXUN uMAC版本发布包中获取的软件包。详细内容参见表2。表2  从ZXUN uMAC版本发布包中获取的版本文件类型名称功能描述AIC工具中的ZXUN-uMAC-V7.21.31 AIC (iDevise).zip通过此工具来进行数据规划设计，直接输出最终部署ZXUN uMAC所需的LLD。此软件包从ZXUN uMAC版本发布包中获取。镜像包操作系统镜像包uMAC_image_cgsl_F16P6_20210701.zip是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。安全网关功能镜像包ZXUN_LIG_IMG_V4.15.10.P21.zip在ZXUN uMAC需要和安全网关功能同时部署时，需要此类镜像包。基础包ZXUN-uMAC V7.18.14_vnfd.csar基础包也称插件包，包含了虚机部署info.xml文件、业务部署nfservice.json文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。业务包ZXUN-uMAC V7.18.14_version.zip提供ZXUN uMAC的业务功能。AIC插件包aic-plugin-uMAC-V7.21.31.zipAIC工具适配ZXUN uMAC的插件。 
 说明： 
各个软件的版本号以实际安装部署中获取的版本号为准，本文档仅为示例。 
步骤 :在AIC(iDeploy)V3.21.10.09的iDeploy目录下，选择iDeploy应用程序，如[图1]所示。
图1  iDeploy应用程序

首次打开iDeploy时，由于没有导入LLD，所以会出现如[图2]所示的页面。
图2  iDeploy页面

单击选择文件，选择“[导出LLD]”
操作中导出的LLD（ZTE NFV LLD(AMF) New Project.xlsx），如[图3]所示。
图3  选择LLD文件

导入LLD后，如[图4]所示。
图4  导入LLD

自动跳转至DC概览页面，如[图5]，该页面会显示LLD中设计的相关组件的概览信息，此处无需操作，仅用于浏览概要信息。
图5  DC概览页面

切换到版本导入页面，iDeploy工具下没有对应的版本文件，状态列显示红叉表示iDeploy工具下对应的版本文件缺失，需要操作员手工导入。
 说明： 
操作员手工导入的各个版本文件名称和后缀，都需要和版本导入页面中的文件名称相同，否则iDeploy工具会识别不到文件。
可以选中一个领域下的所有版本文件对应的选项框，单击批量导入按钮，选择对应的版本文件目录，工具会自动扫描所选目录下的所有文件自动匹配导入。
图6  本地存放的所有版本文件

在右侧的选择导入列，单击文件对应行的按钮，进行单个文件导入，导入成功后，对应文件的状态会变成绿勾状，导入成功后，检查每个文件的状态是否正常。
导入ZXUN uMAC所有的版本文件，结果如[图7]所示。
图7  所有版本文件导入成功页面

（可选）修改镜像包名称，镜像包是指创建虚机时使用的CGSL操作系统镜像文件包（通常以cgsl.vXXX.zip的形式命名，包含操作系统和双机软件）。 
如果...|那么...
---|---
运营商对镜像包名称有固定的规范（通常为国内运营商）|由于运营商对镜像包名称有固定的规范，在部署之前，需要通过“修改镜像文件名称”操作根据运营商的命名规范来修改镜像包的名称。“修改镜像文件名称”操作必须在步骤10前执行。
如果运营商对镜像包名称没有特殊要求|此步骤可以跳过，不执行，直接执行步骤10。
所有版本文件导入成功后，切换到部署页面，勾选需要部署的对象，单击开始，iDeploy工具开始自动部署ZXUN uMAC，正常情况下部署过程无需人工干预，如[图8]所示。
图8  
开始自动部署

 说明： 
请耐心等待大约40分钟，自动部署完成。 
默认情况下，系统没有勾选了AMF静态路由配置和AMF相关VPC配置这两个选项。
如果操作员勾选AMF静态路由配置，表示系统会根据VNF
Static Route页签中的配置数据（参见“VNF Static Route”）进行自动部署。 
如果操作员勾选AMF相关VPC配置，表示系统会根据VPC页签中的配置数据（参见“VPC（可选）”）进行自动部署。 
 说明： 
通常情况下，静态路由和VPC数据可以在ZXUN uMAC实例化成功后，由操作员手动进行配置，此处不需要勾选。
#### 查询虚机的子接口地址和VLAN 
摘要 :ZXUN uMAC实例化成功后，VIM云平台（本文档示例为TECS OpenStack）会为各个虚机分配子接口的IP地址和VLAN。
在配置业务数据之前，需要在ROSNG平台上，配置IPU虚机的子接口地址和VLAN。 
在SDN组网场景中，ROSNG平台上配置IPU虚机的子接口地址和VLAN从是MANO上查询获取的，本节介绍如何在MANO中查询相关数据。 
步骤 :在MANO客户端，进入MANO的VNF列表页面，找到ZXUN uMAC，单击Trunk管理。
查看IPU虚机的信息，包括子接口和VLAN信息。 
根据查询获取的子端口列表，配置ROSNG信息。 
 说明： 
MANO上查询的顺序不一定是按照VLAN的顺序显示，配置ROSNG时，VLAN子接口的顺序建议按照规划的网络平面顺序进行配置，便于后续排查问题。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开SMF节点。
选择菜单微服务治理→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip-address network-segment conflict-check] disable命令，关闭同网段冲突检测功能，即开启共子网配置全局开关。
执行[interface] xgei-命令，进入接口配置模式。
执行no [shutdown]命令，开启物理端口。
 说明： 
初始状态下，端口都处于关闭状态，必须开启后才能通信。 
执行[exit]命令，退出当前配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[ip vrf forwarding]命令，将物理接口与对应的VRF绑定。
执行[ip address]命令，配置接口的IPv4地址。
执行[ipv6 enable]命令，配置支持IPv6。
执行[ipv6 address]命令，配置接口的IPv6地址。
执行no [shutdown]命令，开启物理端口。
执行[logging link-status] enable命令，配置在子接口异常时会生成告警。
执行[exit]命令，退出当前配置模式。
执行[arp]命令，进入ARP配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[source-filtered] disable命令，关闭ARP源过滤。
执行[exit]命令，退出子接口配置模式。
执行[exit]命令，退出ARP配置模式。
执行[vlan-configuration]命令，进入VLAN配置模式。
执行[interface] xgei-命令，进入VLAN子接口配置模式。
执行[encapsulation-dot1q]命令，配置子接口支持的VLAN ID。该VLAN ID需与交换机上规划配置的VLAN ID一致。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
配置完成后，可以使用[show ip interface  brief]，查看配置结果是否正确，结果如下所示。
`ZXROSNGshow ip interface  brief 
Interface                       IP-Address      Mask            Admin Phy  Prot 
xgei-1/0/1/1                    unassigned      unassigned      up    up   up
xgei-1/0/1/1.1                  179.21.2.2      255.255.255.248 up    up   up
xgei-1/0/1/1.2                  179.21.3.2      255.255.255.248 up    up   up
xgei-1/0/1/1.3                  179.21.4.2      255.255.255.248 up    up   up
xgei-1/0/1/1.4                  179.21.5.2      255.255.255.248 up    up   up
xgei-1/0/1/1.5                  179.21.12.2     255.255.255.248 up    up   up
xgei-1/0/1/1.6                  179.21.6.2      255.255.255.248 up    up   up
xgei-1/0/1/1.7                  179.21.7.2      255.255.255.248 up    up   up
xgei-1/0/1/1.8                  179.21.8.2      255.255.255.248 up    up   up
xgei-1/0/1/1.9                  179.21.9.2      255.255.255.248 up    up   up
xgei-1/0/2/1                    unassigned      unassigned      up    up   up
xgei-1/0/2/1.1                  179.21.2.3      255.255.255.248 up    up   up
xgei-1/0/2/1.2                  179.21.3.3      255.255.255.248 up    up   up
xgei-1/0/2/1.3                  179.21.4.3      255.255.255.248 up    up   up
xgei-1/0/2/1.4                  179.21.5.3      255.255.255.248 up    up   up
xgei-1/0/2/1.5                  179.21.12.3     255.255.255.248 up    up   up
xgei-1/0/2/1.6                  179.21.6.3      255.255.255.248 up    up   up
xgei-1/0/2/1.7                  179.21.7.3      255.255.255.248 up    up   up
xgei-1/0/2/1.8                  179.21.8.3      255.255.255.248 up    up   up
xgei-1/0/2/1.9                  179.21.9.3      255.255.255.248 up    up   up
loopback1                       182.21.21.60    255.255.255.255 up    up   up
loopback2                       182.21.21.61    255.255.255.255 up    up   up
loopback3                       180.21.21.3     255.255.255.255 up    up   up
loopback4                       180.21.21.2     255.255.255.255 up    up   up
loopback5                       180.21.21.3     255.255.255.255 up    up   up
loopback6                       180.21.21.2     255.255.255.255 up    up   up
loopback7                       180.21.21.22    255.255.255.255 up    up   up

ZXROSNGshow running-config

!<mim>
!configuration has not been saved since system starting
!configuration was loaded by txt that saved at 09:35:07 Fri Apr 24 2020
commit-mode default automatic
!</mim>

!<vrf>
ip vrf GN_VRF vpnid 1
  rd 1:1
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf SX_VRF vpnid 2
  rd 2:2
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf OM_VRF vpnid 3
  rd 3:3
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf CN_VRF vpnid 4
  rd 4:4
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf GI_SCG_VRF vpnid 5
  rd 5:5
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf GITB_SCG_VRF vpnid 6
  rd 6:6
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf TLGI_VRF vpnid 10
  rd 10:10
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf TLGITB_VRF vpnid 7
  rd 7:7
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf LIG_VRF vpnid 8
  rd 8:8
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf EAGY_VRF vpnid 9
  rd 9:9
  address-family ipv4
  $
  address-family ipv6
  $
$
!</vrf>
!<if-intf>
ip-address network-segment conflict-check disable
interface xgei-1/0/1/1
  no shutdown
  interface mac-address fa16.3e14.a5dc
$
interface xgei-1/0/1/1.1
  ip vrf forwarding GN_VRF
  ip address 179.21.2.2 255.255.255.248
$
interface xgei-1/0/1/1.2
  ip vrf forwarding CN_VRF
  ip address 179.21.3.2 255.255.255.248
$
interface xgei-1/0/1/1.3
  ip vrf forwarding OM_VRF
  ip address 179.21.4.2 255.255.255.248
$
interface xgei-1/0/1/1.4
  ip vrf forwarding LIG_VRF
  ip address 179.21.5.2 255.255.255.248
$
interface xgei-1/0/1/1.5
  ip vrf forwarding SX_VRF
  ip address 179.21.12.2 255.255.255.248
$
interface xgei-1/0/1/1.6
  ip vrf forwarding GI_SCG_VRF
  ip address 179.21.6.2 255.255.255.248
$
interface xgei-1/0/1/1.7
  ip vrf forwarding GITB_SCG_VRF
  ip address 179.21.7.2 255.255.255.248
$
interface xgei-1/0/1/1.8
  ip vrf forwarding TLGI_VRF
  ip address 179.21.8.2 255.255.255.248
$
interface xgei-1/0/1/1.9
  ip vrf forwarding TLGITB_VRF
  ip address 179.21.9.2 255.255.255.248
$
interface xgei-1/0/2/1
  no shutdown
  interface mac-address fa16.3e41.c2d7
$
interface xgei-1/0/2/1.1
  ip vrf forwarding GN_VRF
  ip address 179.21.2.3 255.255.255.248
$
interface xgei-1/0/2/1.2
  ip vrf forwarding CN_VRF
  ip address 179.21.3.3 255.255.255.248
$
interface xgei-1/0/2/1.3
  ip vrf forwarding OM_VRF
  ip address 179.21.4.3 255.255.255.248
$
interface xgei-1/0/2/1.4
  ip vrf forwarding LIG_VRF
  ip address 179.21.5.3 255.255.255.248
$
interface xgei-1/0/2/1.5
  ip vrf forwarding SX_VRF
  ip address 179.21.12.3 255.255.255.248
$
interface xgei-1/0/2/1.6
  ip vrf forwarding GI_SCG_VRF
  ip address 179.21.6.3 255.255.255.248
$
interface xgei-1/0/2/1.7
  ip vrf forwarding GITB_SCG_VRF
  ip address 179.21.7.3 255.255.255.248
$
interface xgei-1/0/2/1.8
  ip vrf forwarding TLGI_VRF
  ip address 179.21.8.3 255.255.255.248
$
interface xgei-1/0/2/1.9
  ip vrf forwarding TLGITB_VRF
  ip address 179.21.9.3 255.255.255.248
$
interface xgei-1/0/3/1
  off-line
  no shutdown
  interface mac-address fa16.3ea5.2f21
$
interface loopback1
  ip vrf forwarding GN_VRF
  ip address 182.21.21.60 255.255.255.255
$
interface loopback2
  ip vrf forwarding SX_VRF
  ip address 182.21.21.61 255.255.255.255
$
interface loopback3
  ip vrf forwarding OM_VRF
  ip address 180.21.21.3 255.255.255.255
  ip address 180.21.21.4 255.255.255.255 secondary
  ip address 180.21.21.5 255.255.255.255 secondary
  ip address 180.21.21.20 255.255.255.255 secondary
  ip address 180.21.21.21 255.255.255.255 secondary
  ip address 180.21.21.14 255.255.255.255 secondary
  ip address 180.21.21.15 255.255.255.255 secondary
$
interface loopback4
  description wyg-test
  ip vrf forwarding GN_VRF
  ip address 180.21.21.2 255.255.255.255
$
interface loopback5
  ip vrf forwarding GN_VRF
  ip address 180.21.21.3 255.255.255.255
  ip address 180.21.21.4 255.255.255.255 secondary
  ip address 180.21.21.5 255.255.255.255 secondary
  ip address 180.21.21.20 255.255.255.255 secondary
  ip address 180.21.21.21 255.255.255.255 secondary
$
interface loopback6
  ip vrf forwarding SX_VRF
  ip address 180.21.21.2 255.255.255.255
$
interface loopback7
  ip vrf forwarding GI_SCG_VRF
  ip address 180.21.21.22 255.255.255.255
$
interface null1
$
!</if-intf>
!<vlan>
vlan-configuration
  interface xgei-1/0/1/1.1
    encapsulation-dot1q 3010
  $
  interface xgei-1/0/1/1.2
    encapsulation-dot1q 3011
  $
  interface xgei-1/0/1/1.3
    encapsulation-dot1q 3012
  $
  interface xgei-1/0/1/1.4
    encapsulation-dot1q 3013
  $
  interface xgei-1/0/1/1.5
    encapsulation-dot1q 3014
  $
  interface xgei-1/0/1/1.6
    encapsulation-dot1q 3015
  $
  interface xgei-1/0/1/1.7
    encapsulation-dot1q 3016
  $
  interface xgei-1/0/1/1.8
    encapsulation-dot1q 3017
  $
  interface xgei-1/0/1/1.9
    encapsulation-dot1q 3018
  $
  interface xgei-1/0/2/1.1
    encapsulation-dot1q 3010
  $
  interface xgei-1/0/2/1.2
    encapsulation-dot1q 3011
  $
  interface xgei-1/0/2/1.3
    encapsulation-dot1q 3012
  $
  interface xgei-1/0/2/1.4
    encapsulation-dot1q 3013
  $
  interface xgei-1/0/2/1.5
    encapsulation-dot1q 3014
  $
  interface xgei-1/0/2/1.6
    encapsulation-dot1q 3015
  $
  interface xgei-1/0/2/1.7
    encapsulation-dot1q 3016
  $
  interface xgei-1/0/2/1.8
    encapsulation-dot1q 3017
  $
  interface xgei-1/0/2/1.9
    encapsulation-dot1q 3018
  $
$
!</vlan>
!<arp>
arp
  interface xgei-1/0/1/1.1
    source-filtered disable
  $
  interface xgei-1/0/1/1.2
    source-filtered disable
  $
  interface xgei-1/0/1/1.3
    source-filtered disable
  $
  interface xgei-1/0/1/1.4
    source-filtered disable
  $
  interface xgei-1/0/1/1.5
    source-filtered disable
  $
  interface xgei-1/0/1/1.6
    source-filtered disable
  $
  interface xgei-1/0/1/1.7
    source-filtered disable
  $
  interface xgei-1/0/1/1.8
    source-filtered disable
  $
  interface xgei-1/0/1/1.9
    source-filtered disable
  $
  interface xgei-1/0/2/1.1
    source-filtered disable
  $
  interface xgei-1/0/2/1.2
    source-filtered disable
  $
  interface xgei-1/0/2/1.3
    source-filtered disable
  $
  interface xgei-1/0/2/1.4
    source-filtered disable
  $
  interface xgei-1/0/2/1.5
    source-filtered disable
  $
  interface xgei-1/0/2/1.6
    source-filtered disable
  $
  interface xgei-1/0/2/1.7
    source-filtered disable
  $
  interface xgei-1/0/2/1.8
    source-filtered disable
  $
  interface xgei-1/0/2/1.9
    source-filtered disable
  $
$
!</arp>` 
### FAQ 
#### 修改镜像文件名称 
概述 :操作员在执行实例化ZXUN uMAC前，需要事先获取ZXUN uMAC的版本包，版本包分为三类。
镜像包 
基础包 
业务软件包 
其中镜像包有两种类型。 
操作系统镜像包是创建ZXUN uMAC的虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。 
LIG镜像包ZXUN uMAC和LIG功能同时部署时，需要此类镜像包。 
操作员从中兴通讯获取的镜像包的默认的名称格式参见[表1]。
类型|包名
---|---
所有NF|cgsl.vXXX.zip
LIG|ZXUN LIG_VXXX
XXX代表对应VIM云平台管理系统（如ZTE TECS OpenStack）和ZXUN LIG的版本号，以实际版本为准。 
##### 适用场景 
在实际部署的如下两种场景中，涉及到修改镜像包名称的操作。 
修改ZXUN CloudStudio上显示的镜像包名称。上传到ZXUN CloudStudio上的镜像包，用于操作员在ZXUN CloudStudio上快速实例化ZXUN uMAC时使用，如果需要在一个ZXUN CloudStudio上部署多个ZXUN uMAC，则需要上传多个镜像包，由于每次上传的ZXUN uMAC镜像包的名称是相同的，如果不修改之前上传的镜像包名称，会导致每次上传镜像包时，都会覆盖原来上传的相同名称的镜像包。 
修改VIM（本文档指中兴通讯的TECS OpenStack）上显示的镜像包名称。某些运营商对镜像包名称有严格的规定，操作员必须在实例化之前，根据运营商的要求修改镜像包的名称。 
##### 国内运营商对镜像包的命令规范 
ZXUN uMAC应用于商用局点时，国内运营商对镜像包的命令规范参见[表2]和[表3]。
参数|取值说明
---|---
VIM云平台（如中兴通讯的TECS OpenStack）镜像包注册名称|格式：{resNamePrefix前缀}-MIR-{自定义部分}自定义部分包括如下两类ZXUN uMAC的操作系统镜像包格式：{neResPrefix网元前缀}-CGSL-{CGSL版本号}.img示例：NFV-R-HDBNJ-03A-ZX-01-MIR-ahAMF1BZX-CGSL.V5.04.F16P4.imgLIG镜像包格式：{neResPrefix网元前缀}-ZXUN-LIG-{CGSL版本号}.img示例：NFV-R-HDBNJ-03A-ZX-01-MIR-ahAMF1BZX-ZXUN-LIG-V4.15.10.P16.imgresNamePrefix前缀参见工程LLD文档VNF信息页签的VIM资源前缀/VIM Resource Prefix。
参数|取值说明
---|---
云平台镜像注册名称|格式：{resNamePrefix前缀}-MIR-{自定义部分}自定义部分包括两类。业务镜像：CGSL-{CGSL版本号}.imgLIG镜像：ZXUN-LIG-{CGSL版本号}.img中国联通规定的镜像包名称示例：GD_GX_NN_AMF800_C_ZX-MIR-CGSL-V5.04.F16P2.imgNGD_GX_NN_AMF800_C_ZX-MIR-ZXUN-LIG-P15.img中国电信规定的镜像包名称示例：GD-GZ-ZSC-RP0001B-A-5GC-ZE-AMF01-B-MIR-CGSL-V5.04.F16P4.imgGD-GZ-ZSC-RP0001B-A-5GC-ZE-AMF01-B-MIR-ZXUN-LIG-P16.imgresNamePrefix前缀参见工程LLD文档VNF信息页签的VIM资源前缀/VIM Resource Prefix。
运营商（如中国移动、中国电信、中国联通）要求实现镜像看门狗功能，需要修改resourceList.json文件，增加看门狗属性。 
##### 修改方式 
某些运营商对镜像包名称有严格的规定，操作员必须在实例化之前，根据运营商的要求修改镜像包的名称。 
本节介绍两种修改镜像包名称的方式。 
操作员在ZXUN CloudStudio上修改，参见操作员在ZXUN CloudStudio上修改。 
操作员通过命令的方式修改，参见操作员通过命令方式修改。 
 说明： 
建议使用第一种修改方式，即操作员在ZXUN CloudStudio上修改。 
##### 操作员在ZXUN CloudStudio上修改 
###### 操作前提 
操作员已经登录ZXUN CloudStudio的NFVO客户端。 
操作员已经将镜像文件包cgsl.vXXX.zip成功导入到ZXUN CloudStudio中。 
###### 适用场景 
在实际部署的如下两种场景中，涉及到修改镜像包名称的操作。 
修改ZXUN CloudStudio上显示的镜像包名称。上传到ZXUN CloudStudio上的镜像包，用于操作员在ZXUN CloudStudio上快速实例化ZXUN uMAC时使用，如果需要在一个ZXUN CloudStudio上部署多个ZXUN uMAC，则需要上传多个镜像包，由于每次上传的ZXUN uMAC镜像包的名称是相同的，如果不修改之前上传的镜像包名称，会导致每次上传镜像包时，都会覆盖原来上传的相同名称的镜像包。 
修改VIM（本文档指中兴通讯的TECS OpenStack）上显示的镜像包名称。某些运营商对镜像包名称有严格的规定，操作员必须在实例化之前，根据运营商的要求修改镜像包的名称。 
###### 修改ZXUN CloudStudio上显示的镜像包名称 
在ZXUN CloudStudio客户端中，打开软件仓库，切换到虚机镜像页面，镜像包显示在虚机镜像页面中，对应的状态为未注册，是否注册显示为否，如[图1]所示。
图1  虚机镜像页面

单击操作栏中的更多按钮，在下拉列表中，选择设置，如[图2]所示。
图2  设置

出现镜像包信息对话框，如[图3]所示。
图3  镜像包信息对话框

 说明： 
镜像包信息对话框中的镜像包版本号和镜像包名称是在ZXUN CloudStudio上显示的镜像包名称，用于操作员在ZXUN CloudStudio上快速实例化ZXUN uMAC时使用。
###### 修改VIM上显示的镜像包名称 
在ZXUN CloudStudio客户端中，打开软件仓库，切换到虚机镜像页面，镜像包显示在虚机镜像页面中，对应的状态为未注册，是否注册显示为否，如[图4]所示。
图4  虚机镜像页面

单击操作栏中的更多按钮，在下拉列表中，选择设置，出现镜像包信息对话框，如[图5]所示。
图5  镜像文件信息区域框

在镜像包信息对话框下方的镜像文件信息区域框中，单击操作栏中的设置按钮，弹出设置镜像文件参数对话框，如[图6]所示。
图6  设置镜像文件参数对话框

 说明： 
设置镜像文件参数对话框中的镜像名称和File_url镜像文件名（两个参数需要修改为一致）是用于修改VIM（本文档指中兴通讯的TECS OpenStack）上显示的镜像包名称，即根据运营商的命名规范修改的名称。
某些运营商（如中国移动、中国电信、中国联通）要求实现镜像看门狗功能，还需要修改resourceList.json文件，增加看门狗属性，如[图7]所示。
图7  修改镜像扩展属性

##### 操作员通过命令方式修改 
获取ZXUN uMAC镜像改名脚本及相关上操作说明文档《ZXUN-CGSL-V7-脚本修改镜像名的使用方法.zip》，修改后结果参照如下。
图1  修改结果

修改LIG镜像名称 
有的运营商要求LIG同AMF/UPF一起部署，且也要求LIG镜像修改名称。 LIG镜像命名请参考运营商的命名规范。LIG镜像名修改方法参见《LIG融合镜像名修改工具2020032115》。LIG镜像名修改工具由LIG项目维护，有疑问请咨询LIG项目。 
#### 在MANO上启用通过本地方式上传版本包的方法 
概述 :只有网络质量良好的场景下才能使用本地上传，否则当版本包文件较大时（超过50M）有可能出现版本上传中断或者失败。 
操作步骤 :在NFVO客户端，进入系统配置。
选择编排配置，将文件上传方式配置”配置为本地上传，如[图1]所示。
图1  本地上传

无需重启，进入软件仓库，选择导入，在导入方式中出现了本地文件选项，如[图2]所示。
图2  本地文件

#### 在VNFM上创建的API用户的方法 
概述 :本节介绍采用Https+Token方式部署时，如何在VNFM上创建API用户。 
在部署时新增https认证功能，VNF需要向VNFM获取token，对于测试场景可以使用VNFM的默认用户名密码admin/Zenap_123，但是对于部分有安全考虑的场景，admin默认密码被修改等场景，需要新建用户，不能使用默认的admin用户。 
该操作建议请现场MANO维护人员进行操作，ZXUN uMAC开通人员向MANO维护人员获取到新增用户的用户名/密码即可。
操作步骤 :登录VNFM客户端，在VNFM上新建用户，进入账户规则页面，单击新建账户规则，如[图1]所示。
图1  新建账户规则

配置规则名称，去掉勾选首次登录时必须修改密码，密码最大有效期配置为0，如[图2]所示。
图2  新建帐户规则

帐号登录方式勾选WEB和API，如[图3]所示。
图3  帐号登录方式

单击新建按钮，如[图4]所示。
图4  新建

选择用户管理，单击新建用户，如[图5]所示。
图5  新建用户

在基本信息中，配置用户名、密码，将用户规则配置为之前创建好的API，设置为同时登录数限制为不限制，如[图6]所示。
图6  配置基本信息

单击下一步，进入权限分配页面，勾选全部角色，如[图7]所示。
图7  权限分配

单击新建，在VNFM上新建用户完成。
操作员使用新增的账户，登录VNFM，验证是否正常。 
#### VNFM tocken认证失败的问题处理 


##### 现象描述 
网元部署，在MANO上任务状态显示在55%：插件后扩展失败。 


##### 处理方法 
很可能是ZXUN uMAC向VNFM tocken认证失败，请检查配置的vnf向vnfm获取token的用户名是否正确，使用此用户名密码要能正常登录VNFM，参见“[在VNFM上创建的API用户的方法]”
。


#### 内部控制面地址规划错误导致实例化失败的问题处理 
##### 现象描述 
福建电信实例化失败，两个OMU的内部控制面互通不正常，OMU虚机只启动了2个平台容器。 
OMU1的内部控制面地址是172.17.0.1 
OMU2的内部控制面地址172.17.0.2 
从OMU2上ping OMU1的地址172.17.0.1能ping通，但是从OMU1上ping OMU2的地址172.17.0.2
ping不通。 
##### 解决办法 
OMU1的内部控制面地址是172.17.0.1是网桥docker0的默认地址，所有启动容器的虚机都有docker0这个默认网桥存在，并且默认地址是172.17.0.1，内部控制面子网段规划应该避免使用172.17.0.0/16这个地址段。 
`ifconfig
        docker0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 0.0.0.0
        ether 02:42:ec:b7:48:15  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0` 
## 软件安装（AIC）-非SDN 
### 安装概述 


本文档介绍了通过中兴通讯自研的AIC工具来部署虚拟化核心网设备ZXUN uMAC的运行环境。


AIC工具，是一种自动安装的部署工具，用于NFVI层的自动化部署、VNF的集成部署以及交付测试。


AIC工具包含iDevise、iDeploy、iTest三个部分。



 
iDeviseiDevise实现数据规划。iDevise主要用于的数据规划设计，其基于ZTE
NFV相关组网规范，支持按照硬件、承载、虚拟层、VNF等层次进行数据设计，可直接输出最终部署所需的LLD，可以直接在iDeploy工具中导入并进行自动部署，不需额外的手工修改。 

 
iDeployiDeploy实现端到端的自动化部署。通过导入部署所需的LLD文件和版本文件，实现端到端自动化部署。 

 
iTestiTest完成自动化测试。支持VIM云平台的API测试、场景功能测试、性能并发测试、EPC基本功能测试、5GC基本功能测试。 

 


 说明： 
本文档中，暂时不涉及iTest的应用。 


AIC工具最核心的理念在于简化部署实施中各个环节的手动操作，将各个阶段的规划活动提前到LLD的设计中。操作员只需在iDevise中输入部署过程中的关键参数，即可自动生成部署所需的LLD，后续通过在iDeploy上导入LLD文件来实现全流程的安装。减少操作复杂度，提升部署效率，增强产品可维护性。


AIC工具可以完成从硬件资源到业务资源的全流程部署，本文档主要介绍如何使用AIC工具进行业务资源的部署，即VNF进行实例化的过程。


#### 安装场景 
本文档的安装适用的硬件服务器支持Intel和海光两种类型。 
两种服务器在安装过程中略有区别，详细描述参见[表1]。
安装区别|说明|参见
---|---|---
需要获取的软件基础包不同|Intel服务器需要获取的软件基础包名称示例：uMAC_vnfd_V7.22.30.B11.csar海光服务器需要获取的软件基础包名称示例：uMAC_vnfd_HG_V7.22.30.B11.csar|获取版本文件
VNF Version页签中的参数Package Type有区别|Intel服务器：VNF Version页签中的参数Package Type设置为Intel海光服务器：VNF Version页签中的参数Package Type设置为HG|VNF Version
VNF Scenario页签中的参数VNF Scenario Name有区别|两种服务器的部署场景有区别|VNF Scenario
 说明： 
本文档没有说明的配置步骤，表示两种服务器的安装过程完全相同。 
#### 安装导读 
在进行ZXUN uMAC软件安装前，确保已经完成硬件设备安装、VIM云平台管理软件（如中兴通讯的TECS
OpenStack）和MANO（如中兴通讯的CloudStudio）软件安装，本文只涉及ZXUN uMAC版本软件的安装过程。安装全流程参见[表1]。
安装步骤|安装内容|安装参考文档
---|---|---
1|VIM云平台|VIM云平台软件|TECS OpenStack云平台参考TECS OpenStack用户手册文档包中用户手册文档包中的《软件安装》内容进行安装。其他云平台，参见各云平台相应的手册。
2|MANO|安装CloudStudio|参考CloudStudio用户手册文档包中用户手册文档包中的《安装与调测》内容进行安装。
3|VNF|安装ZXUN uMAC|详细信息请参考本文档后续章节。
#### 安装前准备 
##### 获取版本文件 
在执行安装前，操作员需要已经从中兴通讯技术支持人员处获取了所有的软件安装信息，包括对应版本号等内容。 
 说明： 
各个软件的版本号以实际安装部署中获取的版本号为准，本文档仅为示例。 
操作员需要获取几种类型的软件安装包，根据获取方式的不同，分为两大类： 
从AIC工具处获取软件包。详细内容参见表1。表1  从AIC工具处获取的版本文件类型名称功能描述AIC工具中的iDeployAIC-iDeployV3.22.07通过导入部署所需的LLD文件和版本文件，实现端到端自动化部署ZXUN uMAC。此软件包从AIC工具处获取。 说明：在获取AIC工具之后，需要检查License是否过期，如果已过期或快过期，需要提前申请新的License。 
从ZXUN uMAC版本发布包中获取的软件包。详细内容参见表2。表2  从ZXUN uMAC版本发布包中获取的版本文件类型名称功能描述AIC工具中的ZXUN-uMAC-V7.22.30 AIC (iDevise).zip通过此工具来进行数据规划设计，直接输出最终部署ZXUN uMAC所需的LLD。此软件包从ZXUN uMAC版本发布包中获取。镜像包操作系统镜像包uMAC_image_cgsl_F16P10_20220222.zip是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。安全网关功能镜像包ZXUN_LIG_IMG_V4.15.10.P21.zip在ZXUN uMAC需要和安全网关功能同时部署时，需要此类镜像包。基础包uMAC_vnfd_V7.18.14.csar基础包也称插件包，包含了虚机部署info.xml文件、业务部署nfservice.json文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。业务包uMAC_version_V7.18.14.zip提供ZXUN uMAC的业务功能。AIC插件包aic-plugin-uMAC-V7.22.30.zipAIC工具适配ZXUN uMAC的插件。 
其他涉及到中兴通讯产品的软件的配套版本要求TECS OpenStack需要V3.17.15.P6及后续版本，CloudStudio需要V7.19.13.B6及后续版本，EM需要V16.19.11.B6及后续版本。 
##### 客户端准备 


###### 简介 
客户端准备包括客户端的硬件要求和客户端上需要安装的软件。 
客户端的功能参见[表1]。
类别|描述
---|---
与VIM通信|作为VIM客户端。在本文档中，作为客户端，访问中兴通讯自研的云平台管理软件TECS OpenStack。
与VNFM和NFVO通信|作为VNFM和NFVO和客户端。在本文档中，作为客户端，访问中兴通讯自研的NFVI资源编排和管理软件CloudStudio。
与NFVI通信|以SSH方式访问作为控制节点或计算节点的硬件服务器。
存放版本文件|将ZXUN uMAC的版本安装软件从客户端上传到NFVI。


###### 客户端的硬件要求 
客户端采用普通PC机，参考配置如下： 

 
CPU：双核，主频≥2 GHz。 

 
内存：≥4 GB。 

 
硬盘：≥80 GB。 

 


###### 客户端的软件配置要求 
客户端中需要安装的软件参见[表2]。
软件类型|软件名称|备注
---|---|---
操作系统|Windows|建议安装Windows 7或更高级的版本。
浏览器|浏览器|只支持Google Chrome，操作员需要通过浏览器登录到TECS OpenStack和CloudStudio的图形化操作页面。
FTP或SFTP工具|FTP或SFTP工具|将ZXUN uMAC的版本文件从客户端上传到NFVI上。
远程访问工具|远程访问工具|以SSH方式访问作为控制节点或计算节点的硬件服务器。


##### VIM侧的数据准备 
检查当前TECS OpenStack版本信息和规划版本是否相同。 
如果采用iDeploy工具部署，需要检查版本号是否满足工具使用要求。 
检查获取的用户名和密码能否正常登录TECS OpenStack的客户端和主机操作系统。 
检查TECS OpenStack系统运行状态正常，有无重要/紧急的异常告警。 
检查TECS OpenStack上剩余的CPU、内存、存储等虚拟资源是否充足。 
检查TECS OpenStack上预定义的租户配额是否充足。 
检查后端存储，如磁阵、CEPH是否已经正常接入环境，对应版本是否正确，存储资源是否充足。 
##### MANO侧的数据准备 
检查当前MANO版本和规划版本是否相同。 
检查获取的用户名和密码能否正常登录MANO。 
检查MANO系统运行状态正常，有无重要/紧急的异常告警。 
检查NFVO上接入的VNFM是否正常，确保其状态为正常。 
检查NFVO上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
检查VNFM上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
##### 查询VNFM用户的权限 
概述 :本节介绍如何查询VNFM用户的权限，在部署ZXUN uMAC之前，需要确认用户权限是否配置正确。
VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，在国内运营商的部署环境中，考虑到安全性，不建议操作员使用默认的admin用户，需要新建一个用户，此用户名之前已经由MANO维护人员创建成功，创建操作参见“[在VNFM上创建的API用户的方法]”
，在部署ZXUN uMAC之前，需要确认用户的权限是否正确，若已经有了符合要求的用户，可以直接使用即可，不需要每个网元都要单独创建一个用户。
###### 操作前提 
已经从MANO的维护人员处获取了VNFM用户的名称。 
操作步骤 :登录VNFM客户端，选择系统→安全→用户管理
，进入用户管理页面，如[图1]所示。
图1  用户管理页面

查看从MANO的维护人员处获取的VNFM用户（本文档示例为AMF111）的权限，单击VNFM用户列表中对应的修改按钮，如[图2]所示。
图2  修改

出现修改用户页面，如[图3]所示。
图3  修改用户页面

单击用户规则后的查看详情按钮，出现查看账户规则页面，如[图4]所示。
图4  查看账户规则页面

确认帐号登录方式，web和API必须为勾选状态。
数据规划 :#### 基础数据规划 
##### VM简介 
ZXUN uMAC、模块、VM之间的关系如下：
ZXUN uMAC部署为多种不同类型的VM。 
每个VM运行一个模块功能，例如一个VM只运行GSU模块功能。 
每种模块可部署为一个或多个VM，例如GSU模块在实例化时，可以部署为两个VM。 
VM规划数据参见[表1]。
VM名称|服务|功能
---|---|---
OMU|O&M|操作与维护单元，其中还包含一个用于辅助判断OMU主备状态的AMU单元。OMU通过管理类通信平面与EM和VNFM交互。
IPU|Interface|接口处理单元，处理IP接口业务。
（可选）CDU|Cloud DB|云数据库单元，用于存储用户会话上下文等信息。CDU为可选单元。当ZXUN uMAC自身集成了数据库功能时，CDU是必需的。当ZXUN uMAC使用外部数据库功能（例如UDSF）时，CDU不是必需的。
GSU|MME&SGSN_C|处理MME和SGSN的控制面数据。
SGSN_U|GSU|处理SGSN用户面数据。
AMF_Communication|GSU|提供3GPP协议中定义的AMF通信服务。
AMF_MT|GSU|提供3GPP协议中定义的AMF的MT服务。
AMF_EventExposure|GSU|3GPP协议中定义的AMF事件暴露服务。
ResourceManage|GSU|提供3GPP协议中定义的资源管理服务。
SIG LB|GSU|处理SCTP和SS7信令。
HTTP LB|GSU|处理HTTP信令。
CDU GW|GSU|CDU网关，用于ZXUN uMAC的CDU之间的数据转发。CDU GW为可选单元，当ZXUN uMAC自身集成了数据库功能（即ZXUN uMAC部署了CDU VM）时，在异地容灾场景，需要使用GSU（CDU GW），否则不需要。
各业务模块VM支持的工作模式参见[表2]。
VM类型|工作模式|推荐部署方式|描述
---|---|---|---
OMU|1+1+1主备|互斥|OMU虚机的备份方式为1+1+1主备方式，其中，两个VM作为OMU主备，另外一个VM作为AMU用于为这两个OMU提供主备仲裁服务。如果两个OMU虚机部署到同一个主机上，该主机宕机时，会导致ZXUN uMAC故障，无法接入新用户，因此OMU虚机必须设置为互斥部署。
GSU|N+M负荷分担|互斥|建议部署为互斥。
IPU|N+M负荷分担|互斥|建议部署为互斥。
CDU|N×（1+1）互备|互斥|CDU虚机的备份方式为N×(1+1)主备，即部署N组CDU虚拟机，每组中的两个CDU虚拟机为1+1互备。如果一组中的两个CDU虚机部署到同一个主机上，该主机宕机时，会导致CDU上的备份数据都丢失，因此CDU虚机必须设置为互斥部署。
#### 非SDN组网规划 
概述 :非SDN组网架构，ZXUN uMAC的外部网络平面不需要启用VLAN
TRUNK功能，启用VLAN透传。
##### 网络平面规划 
网络平面是指各个虚机通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN uMAC规划的网络平面分为三类，参见[表1]。
网络平面|描述|部署原则
---|---|---
网管平面|ZXUN uMAC的OMU虚机和VIM、NFVO进行通信的网络平面。|部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。
内部网络平面|内部网络平面是指ZXUN uMAC中的各个虚机之间进行数据通信的网络平面。|规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面。|在运营商的实际组网环境中，对外通信网络平面可以只规划一个，也可以根据ZXUN uMAC对外通信接口的类型细分为N个。国内运营商场景：对外通信网络平面只需要规划一个。
ZXUN uMAC规划的网络平面的详细描述参见[表2]。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，所有的网络平面都不能使用172.17.0.0/16地址段中的IP地址。 
网络平面|描述
---|---
网管平面|FJ_FZ_SNL_RP0001B_A_5GC_ZE_AMF11_B_VNET_OAM_EXT_NET|ZXUN uMAC的OMU虚机和VIM、NFVO进行通信的网络平面。
内部网络平面|FJ_FZ_SNL_RP0001B_A_5GC_ZE_AMF11_B_VNET_MGT_INT_NET|ZXUN uMAC内部控制面数据通信。
FJ_FZ_SNL_RP0001B_A_5GC_ZE_AMF11_B_VNET_SERV_INT_NET|内部网络平面|ZXUN uMAC内部媒体面数据通信。
外部网络平面|FJ_FZ_SNL_RP0001B_A_5GC_ZE_AMF11_B_VNET_SIG_EXT_NET|外部网络平面是指ZXUN uMAC与外部设备进行通信的网络平面。国内运营商场景：对外通信网络平面只需要规划一个。
### VNF的部署 


概述 :VNF指虚拟化后的核心网NF（如：SMF、UPF、AMF等），执行3GPP定义的NF功能。
本文档规划VNF在是AIC自动部署工具中部署的。


#### 配置内容 
AIC自动部署工具制作的LLD，包括5个部分： 

 
Networking用来配置2台业务交换机和1台带外管理交换机的数据。 

 
Hardware用于配置R5300 G4服务器的BIOS和RAID数据。 

 
VIM用于配置VIM云平台（本文档指中兴通讯的TECS OpenStack） 

 
MANO用于配置MANO（本文档指中兴通讯的CloudStudio） 

 
VNF 用于配置中兴通讯的ZXUN uMAC 

 
 说明： 
在本文档中，AIC自动部署工具只涉及到VNF LLD的制作过程。 


#### 设置规范 
AIC自动部署工具的设置规范参见[表1]。
字体样式|说明|是否可以修改
---|---|---
无底色，黑色字体|单元格的值是固定的。|其内容不得修改。
橙色底，红色字体|需要操作员进行配置的参数或者确认默认值是否正确。|可以修改。
橙色底，蓝色字体|单元格的值是由其他参数设置后，在本处自动引用生成的，需要操作员确认是否正确。|如果需要修改，可以直接修改。
无底色，蓝色字体|单元格的值是由其它的参数设置后，在本处自动引用生成的。|如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。


#### 创建工程 
摘要 :本节介绍通过AIC自动部署工具如何创建一个工程。
前提 :已经获取AIC自动部署工具ZXUN-uMAC-V7.**.** AIC (iDevise).zip。 
已经获取AIC插件包aic-plugin-amf-V7.**.** .zip。 
 说明： 
AIC自动部署工具版本号仅为示例，请以实际情况中的为准。 
步骤 :在客户端，选择ZXUN-uMAC-V7.**.**  AIC (iDevise).zip中的ZXUN-uMAC AIC (iDevise) Plugin Edition.xlsm文件，如[图1]所示。
图1  打开ZXUN AIC (iDevise)(WPS版).xlsm

双击打开ZXUN AIC (iDevise) Plugin Edition(WPS版).xlsm，系统会提示选择禁用宏或者启用宏。
选择启用宏，之后会出现如[图2]所示的页面。
图2  ZXNFV-INT AIC(iDevise)页面

单击New Project，系统弹出提示信息，如[图3]所示。
图3  提示信息

单击确定按钮，回到ZXUN AIC(iDevise)页面，单击Edit Project按钮，系统出现Plugin页面，如[图4]所示。
图4  Plugin页面

单击OpenTemplates File to Design按钮，系统弹出提示框，如[图5]所示。
图5  提示框

在弹出的提示框中选择不更新，系统会自动在ZXUN-uMAC
AIC (iDevise) Plugin Edition.xlsm的同级目录下，创建一个名称为VNF LLD Template AMF.xlsm的表格，如[图6]所示。
图6  VNF LLD Template AMF.xlsm

VNF LLD Template AMF.xlsm会默认生成在ZXUN AIC (iDevise) Plugin Edition(WPS版).xlsm的同级目录下，如[图7]所示。
图7  VNF LLD Template AMF.xlsm路径

在VNF LLD Template AMF.xlsm的表格中，进行LLD的配置。
#### LLD配置 
##### Global Setting 
配置原则 :Global Setting页签用于配置VNF的一些全局变量信息，必须配置。
 说明： 
Global Setting页签中的某些参数的配置结果将影响后续其他设计页签的呈现，包括Network Type、Storage Type和Application scenarios。
配置说明 :Global Setting页签如[图1]所示。
 说明： 
请根据MANO的实际协议模式配置Mano Protocol Mode参数的值（隐藏的第21行参数），配置原则参见[表1]，本参数配置错误会影响后续部署。
图1  Global Setting

Global Setting页签参数参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Application scenarios|本参数用于配置ZXUN uMAC的应用场景。0-Common：通用场景（MANO为ETSI模式）1-5GS：通用5G切片场景（MANO为CMCC模式）11-CMCC Phase1：中国移动一期资源池场景（MANO为CMCC模式）当选择为本场景时，某些表格中部分单元格底色变为绿色的，表示该处已根据中国移动的规范要求设置好对应的数值，非特殊情况下不需要修改。中国移动非SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VNF Network Setting或者VNF Network Setting IPv6。12-CMCC Phase2：中国移动二期资源池场景（MANO为CMCC模式，SDN组网）中国移动SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VRouter Summary、VRouter External Network和VNF SDNNetwork Setting。21-CTCC：中国电信资源池（MANO为CMCC协议模式）31-CUCC：中国联通资源池（MANO为CMCC协议模式）41-CBNC：中国广电资源池51-OverSea：海外国际局点|中国移动三期资源池场景：配置为12-CMCC Phase2
Room Name|本参数用于设置机房名称。|请根据运营商的规划进行设置。如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTENFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。
DC Name|本参数用于设置DC名称。|该参数的值来源于创建工程时，配置的参数DC Name，参见“创建工程”，此处使用默认值，不需要设置。
DC Description|本参数用于设置DC的信息描述。一般根据运营商的工程规划方案设置，表示DC的物理位置，例如具体的大楼、机房位置等。|请根据运营商的规划进行设置。如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTENFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。
Network Type|本参数用于设置ZXUN uMAC需要部署的VIM云平台的网络类型。SDN组网场景时，该参数需要设置为VxLAN。非SDN组网场景时，该参数需要设置为VLAN。|中国移动二期资源池场景和三期资源池场景：配置为VxLAN中国联通和中国电信场景：配置为VLAN
VIM ID|本参数用于设置ZXUN uMAC需要部署的VIM云平台的编号，用于VIM接入MANO时使用。|如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。中国移动命名规则：NFV-RP-HBBAD-01A-ZX-01中国电信命名规则：GD-GZ-ZSC-RP0001B-V-ZE-01中国联通命名规则：az1.xa1.chinaunicom.cn（MANO的V5.20.11版本支持域名方式，其他版本不支持域名方式）除上述运营商之外的其他运营商，不必遵循上述格式，可自定义合法字符串，例如VIM01。
VIM Name|本参数用于设置ZXUN uMAC需要部署的VIM云平台的名称。|从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。
VIM Type|本参数用于设置ZXUN uMAC需要部署的VIM云平台类型。配置为TECS，表示ZXUN uMAC需要部署的VIM云平台为中兴通讯自研的的ZTE TECSOpenStack。配置为OSP，表示ZXUN uMAC需要部署的VIM云平台为OpenStack Platform ，OSP是OpenStack Platform开源项目的服务。配置为OIaaS，表示ZXUN uMAC需要部署的VIM云平台为IaaS，基础设施服务，就是多个基础设施组成的服务。|该参数只能设置为TECS，表示ZXUN uMAC部署的VIM云平台只能是中兴通讯的TECSOpenStack。
VIM Version|本参数用于设置ZXUN uMAC需要部署的VIM云平台的版本号。从下拉列表中选择，目前只支持中兴通讯的TECSOpenStack V03.17.14、V03.17.15和V06.10.10，请配置为现场实际安装的TECS OpenStack的版本号。|如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中VIM Controller Info页签中获取的。
Quorum Service Num|本参数用于配置仲裁节点的个数。如果是OMU单机场景，不需要配置仲裁节点，此参数配置为固定值0。如果是OMU双机场景（即OMU采用1+1+1主备模式。其中，两个OMU虚机之间采用1+1主备，另外一个OMU用于这两个OMU虚机的主备仲裁），则此参数配置为3。如果OMU双机场景下，某些运营商希望除了不仅在OMU上，同时在IPU虚机上也支持仲裁功能，则此参数需要配置为5。|当Application scenarios配置为12-CMCC Phase3，表示适用中国移动二期和三期资源池场景时，本参数必须配置为5。
Storage Type|本参数用于设置ZXUN uMAC需要部署VIM云平台的存储类型，包括如下类型：CEPHVIM云平台使用TECS CloveStorage存储数据。Local DiskVIM云平台使用本地盘存储数据，由服务器自身携带的存储硬盘提供整个系统的存储能力。Disk ArrayVIM云平台由单独的磁盘阵列设备提供存储能力。当Storage Type配置为CEPH或Disk Array时（表示ZXUN uMAC使用后端存储设备），后续需要额外配置的页签如下：Volume Types页签，表示在这两种情况下，需要设置ZXUN uMAC规划的云硬盘类型名称，参见“Volume Types（可选）”。Storage QoS页签，表示在这两种情况下，需要设置ZXUN uMAC规划的存储QoS策略，参见“Storage QoS”。|中国电信和中国移动部署场景：本参数需要设置为CEPH。中国联通部署场景：本参数需要设置为Disk Array。
Use Huge Pages / CPU Dedication|本参数用于设置VIM云平台是否启用（Huge Page）巨页/（NUMA）绑核功能。|国内运营商部署场景：本参数需要设置为YES。
Use Security Group|本参数用于设置VIM云平台是否开启安全组。安全组是在VIM云平台上（如中兴通讯自研的TECS OpenStack）上创建的一个地址段范围，在VIM云平台和VNF同时开启安全组的情况下，VNF可以和处于该地址段范围内的外部网元进行通信。|国内运营商部署场景：本参数需要设置为NO。
Use Port Security Group|本参数用于设置ZXUN uMAC是否开启端口安全组。|当Application scenarios设置为12-CMCC Phase2时，本参数需要设置为YES，除此之外的其他场景，本参数需要设置为NO。
VIM IP Type|本参数用于设置ZXUN uMAC需要部署的VIM云平台使用的网络地址类型。IPv6：IPv6类型地址IPv4：IPv4类型地址|如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中VIM Controller Info页签中获取的。
VNF IP Type|本参数用于设置ZXUN uMAC使用的网络地址类型。IPv6：IPv6类型地址IPv4：IPv4类型地址如果ZXUN uMAC使用的网络地址类型需要部署为双栈，此参数还是设置为单栈方式（即设置为IPv6或者IPv4都可以），在ZXUN uMAC实例化成功后，通过后续的业务配置来实现ZXUN uMAC的双栈功能。|本参数需要根据现场的实际组网情况进行配置。
Timezone|本参数用于设置ZXUN uMAC所在地的时区。根据实际情况从下拉列表中选择，比如中国的时区为东8区，设置为GMT+08:00Asia/Shanghai。|国内运营商场景：固定设置为GMT+08:00 Asia/Shanghai。
Physical Network Name|本参数用于设置VIM云平台的租户网络所映射的物理网卡名称。|国内运营商场景：固定配置为default。
Language|本参数用于设置部署ZXUN uMAC时，ZXUN uMAC的网管系统的语言类型。en_US.UTF-8：英文zh_CN.UTF-8：中文|国内运营商场景：固定配置为zh_CN.UTF-8。
Mano Protocol Mode|本参数用于设置MANO（NFVO和VNFM）的协议模式，包括ETSI间接模式和CMCC直接模式。在VNF的实例化中流程中，实例化是从NFVO发起，然后由VNFM进行资源计算和申请，当资源计算完毕后再由NFVO或者VNFM去向VIM云平台交互进行资源的创建。NFVO、VNFM均具备向VIM云平台进行资源创建查询的能力，最终由谁跟VIM云平台进行交互创建资源，则由MANO配置的模式来决定。配置为CMCC，表示采用CMCC直接模式当采用CMCC（中国移动）直接模式配置时，由VNFM向VIM云平台申请创建资源。配置为ETSI，表示采用ETSI间接模式当采用ETSI间接模式配置时，由NFVO向VIM云平台申请创建资源。CMCC、ETSI是代表的不同协议规范，CMCC协议下，NFVO和VNFM之间的接口是有专门规范的，涉及的接口以及接口中的参数都是根据CMCC的要求进行实现处理，而ETSI则是另外一套规范的要求。直接、间接代表的是NFVO和VNFM，两者谁向VIM进行资源创建操作，直接就是VNFM直接跟VIM云平台进行交互操作，间接就是NFVO跟VIM云平台进行交互操作。CMCC、ETSI、直接、间接，两两组合就存在四种不同的场景，目前只涉及到ETSI间接模式CMCC直接模式两种。|请根据MANO的实际协议模式进行配置。
VNFM ID|本参数用于设置ZXUN uMAC所在的VNFM ID。此处需要配置为VNFM接入NFVO时的编号，当多个VNFM接入同一个NFVO时，需要配置此参数。|本参数继承MANO侧的配置数据，需要和MANO侧的配置数据保持一致，在配置前请从MANO侧获取相关数据。如果VNF的LLD是与MANO的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(MANO) XX.xlsx表中Global Setting页签中获取的。
Resource Prefix|本参数用于设置VIM平台（本文档指TECS OpenStack）上的虚机资源前缀名称，用于定义租户、云盘、网络等资源时，系统在原有的名称前，自动添加的前缀。|此参数需要根据各个运营商的规范进行配置。如果VNF的LLD是与MANO的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(MANO) XX.xlsx表中Global Setting页签中获取的。中国移动命名规则：HBBAD-01A-ZX-01。地理位置-硬件资源池编号-厂家-池编号中国电信命名规则：GD-GZ-ZSC-RP0001BE。省份标签-地市标签-局点标签-云属性+序号中国联通命名规则：XA1-SN-SN-XA。站点名称-大区-省份-城市除上述运营商之外的其他运营商，不必遵循上述格式，可自定义合法字符串。
Enable Transport Network QinQ|本参数用于设置是否启用透传网络QinQ功能。True：当TECS OpenStack及承载网络启用了透传网络QinQ功能时，本参数需要设置为True。启用QinQ功能后，VNF的外部网络平面（除网管平面外）必须设置为VLAN透传网络，并设置一个VLAN ID用于QinQ外层VLAN标签，而内层VLAN标签可规划一个起止段，且必须在承载交换机上进行对应QinQ配置。False：不启用QinQ功能。|本参数和Application scenarios参数的配置结果相关，当Application scenarios设置为11-CMCC Phase1时，本参数需要设置为True，其他情况下，都需要配置为False。
Allow Cross AZ Deployment|本参数用于设置，当使用非本地盘部署时（即参数Storage Type设置为CEPH或者Disk Array时），是否允许虚机所使用的可用域与存储后端所使用的可用域，为不相同的两个域。在TECS OpenStack上，也有一个相同的参数跨AZ挂载云盘，如图2所示，本参数的取值，需要与TECS OpenStack上这个参数设置的数值相同。|中国移动资源池规范中，要求虚机可用域与存储可用域必须一致，该参数应设置为NO。其他运营商场景下，需要根据运营商规范及虚机可用域与存储可用域实际规划情况设置。
Support Duplicate Resource Name|本参数用于设置，操作员在TECS OpenStack上创建资源（如vRrouter等）时，是否允许不同租户下有重名的资源。 YES：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，允许在本租户下继续创建该名称的资源。NO：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，则不允许在本租户下继续创建该名称的资源。|中国移动场景，该参数需要设置为NO。
Support Heat Script|本参数用于配置，操作员是否通过HeatScript工具来创建实例化ZXUN uMAC时，所需要的网络资源和虚机规格（flavor）等虚拟资源。如果本参数配置为Yes，后续还需要通过Heat Script页签来配置，参见Heat Scripts（可选）。|国内运营商场景，本参数需要配置为No。
图2  TECS OpenStack上的参数页面

##### VIM Controller Info 
配置原则 :VIM Controller Info页签用于配置ZXUN uMAC所在VIM云平台的相关信息，必须配置。
 说明： 
VIM Controller Info页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
配置说明 :VIM Controller Info页签如[图1]所示。
图1  VIM Controller Info

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VIM Controller IP|该参数用于配置ZXUN uMAC的VIM云平台（本文档指中兴通讯的TECS OpenStack）控制节点的TECSClient网络平面的浮动IP地址。操作员通过TECSClient网络平面，可以在客户端使用Chrome浏览器访问TECS OpenStack提供的图形化网管界面。|如果VNF的LLD是与VIM的LLD同时规划的，本参数的值是从ZTE NFV LLD(VIM) XX.xlsx表中Floating IP页签中获取的。
##### Host Aggregate 
配置原则 :Host Aggregate页签用于配置HA（主机集合）和AZ（可用域），必须配置。
 说明： 
VIM Controller
Info页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
背景知识 :主机集合（Host Aggregates）HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。 
可用域（Availability Zones）AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。可以理解为只是一些主机在工程上的独立，例如可以把一个机架上的主机划分在 一个可用域中。 
一个AZ可以包含多个HA，一个HA只能属于一个AZ，根据实际规划来配置。 
一般为了达到容灾的效果，一个DC会按照硬件位置划分为两个AZ，相同元数据属性的HA要在两个AZ里都存在，但同时一个HA只能属于一个AZ，因此在规划时对同一元数据属性的HA，可以定义两个HA名称，分别属于不同的AZ。 
配置说明 :Host Aggregate页签如[图1]所示。
图1  Host Aggregate

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Usage|对于ZXUN uMAC，该参数需要配置为Control-Plane。Management表示管理域Control-Plane表示控制域。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
Available Zone Name|本参数用于配置可用域（Availability Zones）的名称。AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域（AZ）是一个面向终端客户的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
Host Aggregate Name|本参数用于配置主机集合（Host Aggregates）的名称。HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是指定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
Host Aggregate Metadata|本参数用于配置主机集合（Host Aggregates）的元数据，也就是设置各种调度过滤器的类型及其取值。主机集合（Host Aggregates）主要用来为过滤调度器nova-scheduler通过某一属性进行实例（instance）的调度。比如：将数据库服务的实例（instances）都调度到具有SSD属性的主机集合（HostAggregates）中，又或者让某个镜像（image）的实例（instances）调度到同一个主机集合（Host Aggregates）中。调度是指从现有的可用的计算节点中，选择其中一个作为目的节点进行虚机部署、迁移以及规格调整等操作。过滤调度器是常用的调度器之一，过滤调度器使用多个功能不同的过滤器对主机进行筛选。本参数用于设置各种调度过滤器的类型及其取值，比如Aggregate_Instance_Extra_SpecsFilter是主机集合flavor的扩展字段调试器。|通过以下两步操作获取：在本工程XX节点资源池资源规划表.xlsx的“表3-VNF在资源池部署规划表”页中找到该网元所规划的可用域（AvailabilityZones）和主机集合（Host Aggregates）。在ZTE NFV LLD(VIM) XX.xlsx表的Host Aggregate页签里根据上述操作中附表4中的信息找到可用域（Availability Zones）和主机集合（Host Aggregates）的名称。中国联通场景配置原则：只需要配置一个AZ，此AZ中包括3个HA：管理域、5GC域和计费域。
##### MANO Info 
配置原则 :MANO Info页签用于配置部署ZXUN uMAC所使用到的MANO相关信息，必须配置。
 说明： 
MANO Info页签中的参数，全部继承MANO（本文档指中兴通讯的CloudStudio）侧的配置数据，需要和MANO侧的配置数据保持一致，在配置前请从MANO侧获取相关数据。如果VNF的LLD是与MANO的LLD同时规划的，则需要从ZTE NFV LLD(MANO) XX.xlsx表中获取。
配置说明 :MANO Info页签如[图1]所示。
图1  MANO Info

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
NFVO/VNFM Version|本参数用于设置MANO的版本号。|本参数保持默认，无需修改。
NFVO ID|本参数用于设置NFVO的局号。|从MANO.xlsx表中Global Setting页签中获取的。
NFVO Tenant Username|本参数用于设置NFVO的用户名称，是NFVO与VIM对接使用的用户名。|从MANO.xlsx表中Tenant & Users页签中获取的。
NFVO User Group|本参数用于设置NFVO的用户组名称，是NFVO与VIM对接使用的用户组。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。|从MANO.xlsx表中Tenant & Users页签中获取的。
VNFM Tenant Username|本参数用于设置VNFM的租户名称，是VNFM与VIM对接使用的用户名。|从MANO.xlsx表中Tenant & Users页签中获取的。
VNFM User Group|本参数用于设置VNFM的用户组，是VNFM与VIM对接使用的用户组 。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。|从MANO.xlsx表中Tenant & Users页签中获取的。
VNFM VM Username|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的用户名。|本参数保持默认，无需修改。
VNFM VM Password|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的密码。|本参数保持默认，无需修改。
NFVO OMM Username|本参数用于设置NFVO网管系统的用户名。|本参数保持默认，无需修改。
NFVO OMM Password|本参数用于设置NFVO网管系统的密码。|本参数保持默认，无需修改。
VNFM OMM Username|本参数用于设置VNFM网管系统的用户名。|本参数保持默认，无需修改。
VNFM OMM Password|本参数用于设置VNFM网管系统的密码。|本参数保持默认，无需修改。
NFVO OAM Net Name|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet Name|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）子网名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Floating IP|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）浮动地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet IP Prefix|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）子网地址前缀（不带掩码）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet Mask|NFVO的网管网络平面（如ZTE_EMS_NET）的子网掩码。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
NFVO OAM Subnet Gateway IP|本参数用于设置NFVO的网管网络平面（如ZTE_EMS_NET）子网网关地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Net Name|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Name|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网名称。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Floating IP|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）的浮动IP地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet IP Prefix|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网地址前缀（不带掩码）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Mask|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网掩码。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Gateway IP|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网网关地址。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。
VNFM OAM Subnet Name DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网名称（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Floating IP DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）浮动地址（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet IP Prefix DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网地址前缀（不带掩码）（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Mask DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网掩码（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Gateway IP DualStack|本参数用于设置VNFM的网管网络平面（如ZTE_EMS_NET）子网网关地址（双栈）。|在MANO.xlsx表中VNF Interface IP页签根据网管平面找到此参数。如果不使用双栈，该参数不需要配置。
NFVO/VNFM & VIM Interface Protocol|本参数用于设置MANO与VIM对接协议类型。|国内运营商场景：固定使用https。
NFVO/VNFM & VIM Authentication Type|本参数用于设置MANO与VIM对接鉴权方式。|国内运营商场景：固定使用Two-way Authentication
NFVO/VNFM Login Protocol|本参数用于设置登录MANO使用的协议类型。|国内运营商场景：固定使用https。
##### VNF ID 
配置原则 :VNF ID页签用于配置需要通过AIC工具进行实例化部署的NF的ID，必须配置。
配置说明 :VNF ID页签如[图1]所示。
图1  VNF ID

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VNF Type|该参数用于设置ZXUN uMAC的类型，包括如下选项：运营商的部署网络为4G网络商用场景，配置为MME。运营商的部署网络为4G和5G融合组网的商用场景，配置为AMF。|根据运营商的使用场景进行配置。
ID|该参数用于设置ZXUN uMAC的网元编号。|用于标识网元名称及各种相关资源名称。需要根据运营商的规划来设置。在网元局号和VxLAN划分.xlsx中对应大区页可找到此参数。
VNF Brief Name|此单元格的值是由VNF Type和ID两个参数设置后， 在本单元格自动引用生成的，需要操作员确认是否正确即可，如果需要修改，可以直接修改。|本参数保持默认，无需修改。
VNF Resource Name Prefix|该参数用于设置资源名称前缀，该前缀将作为虚机、云盘、端口等资源名称的一部分。运营商可以通过设置VNF Resource Name Prefix对ZXUN uMAC使用的虚拟资源进行严格规范的命名，以便资源的统一管理。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。定义了命名规则后，对于在VNF实例化过程中创建的各种虚拟资源，系统都会按照规定进行命名。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|本参数的取值来源于Global Setting页签中的Resource Prefix参数值 ,参见“Global Setting”，此处自动引用，无需修改。
VNF APP ID|该参数为网元业务系统标识的关键部分，必须根据实际规划数据修改。|中国移动配置原则：“所属省份标识+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahAMF001BZX。后续VNF Advanced Settings页签中配置的参数虚机名称前缀的数值直接引用此处。中国电信配置原则：“[网元标识+序号]-[网元属性]”，如：AMF03-B。后续VNF AdvancedSettings页面的参数虚机名称前缀自动置空，不填写。中国联通配置原则：“[网元类型+序号]-[BC/B/C/专网名称]-[厂家缩写]”，如：AMF003-B-ZX。后续VNF Advanced Settings页面的参数虚机名称前缀自动置空，不填写。
Bureau ID|该参数用于设置ZXUN uMAC的局号。取值范围：1~255之间的整数，需要根据运营商的规划来设置。规划原则：在同一个NFVO之内的各个NF的局号不能相同。在一个大区内及其容灾大区内同一类型的NF的局号不能相同，在特殊情况下，如果同一类型的NF的个数超过255，只需要保证有容灾关系的NF的局号不相同即可。|在网元局号和VxLAN划分.xlsx表中对应大区页可找到此参数。
是否实例化|该参数用于配置需要通过AIC自动部署工具进行实例化的NF。|本参数需要将是否实例化设置为YES。
实例化时使用网络预留功能|该参数在SDN组网环境时，才需要配置。本参数的配置结果会影响到VNF SDN Network Setting页签的Network Deployment为规划预留的网络平面。目前只涉及到ZXUN uMAC与安全网关之间的网络平面。该参数设置为YES，表示后续在实例化ZXUN uMAC的过程，不会创建VNF SDN Network Setting页签的Network Deployment项目中设置为规划预留的网络，这些网络需要在实例化成功后，操作员在MANO上通过NS方式纳管VNF，根据需要进行创建。该参数设置为NO，表示后续在实例化ZXUN uMAC的过程，不会创建VNF SDN Network Setting页签的Network Deployment项目中设置为规划预留的网络，后续操作员在MANO上也无法进行创建。|中国移动场景：本参数需要配置为YES。
##### VNF Resource Prefix 
配置原则 :VNF Resource Prefix页签仅用于操作员检查各类资源名称前缀是否正确，不需要操作员配置。
 说明： 
在VNF Resource
Prefix页签中禁止操作员手工执行解锁表格，增加/删除行、列或随意修改内容等操作。
配置说明 :VNF Resource Prefix页签如[图1]所示。
图1  VNF Resource Prefix

VNF Resource Prefix页签中的参数Resource Type Prefix取值来源于其它页签中参数，不需要操作员配置：
Global Setting页签中的参数Resource Prefix 
VNF ID页签中的参数VNF APP ID 
##### VNF Version 
配置原则 :VNF Version页签用于配置ZXUN uMAC的版本号，请根据实际情况配置。
配置说明 :VNF Version页签如[图1]所示。
图1  VNF Version

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Package Type|本参数用于设置ZXUN uMAC的虚机部署的计算节点的CPU的型号。HG：海光Intel：英特尔|操作员需要通过VIM平台（本文档示例为中兴通讯的TECS OpenStack）获取计算节点的CPU的型号。本参数的配置结果会影响到VNF Scenario页签的使用场景。
version|本参数用于ZXUN uMAC的版本号。|此处的版本为中兴通讯内部使用的版本号，并非对运营商交付时的外刷版本号。
##### VNF Scenario 
配置原则 :VNF Scenario页签用于配置本次部署的VNF所使用的场景，必须配置。
配置说明 :VNF Scenario页签如[图1]所示。
图1  VNF Scenario

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VNF Scenario Name|该参数用于根据实际业务量设置ZXUN uMAC的使用场景，受到VNF Version中的参数Package Type的限制。如果VNF Version中的参数Package Type设置为Intel，则ZXUN uMAC的使用场景包括如下：运营商的部署网络为4G和5G融合场景uMAC商用局 24GB AMF/MME/SGSNuMAC商用局 32GB AMF/MME/SGSNuMAC商用局 36GB AMF/MME/SGSNuMAC商用局 融合 36GB AMF/MME/SGSN运营商的部署网络为5G场景uMAC商用局 24GB AMFuMAC商用局 32GB AMFuMAC商用局 36GB AMF运营商的部署网络为4G场景uMAC商用局 24GB MME/SGSNuMAC商用局 32GB MME/SGSNuMAC商用局 36GB MME/SGSN运营商的部署网络为测试场景uMAC测试局AMF运营商的部署网络为5G测试场景uMAC测试局MME/SGSN运营商的部署网络为4G测试场景uMAC测试局AMF/MME/SGSN运营商的部署网络为4G和5G融合测试场景如果VNF Version中的参数Package Type设置为HG，则ZXUN uMAC的使用场景包括如下：uMAC HG 商用局 30GB AMFuMAC HG 商用局 融合 30GB AMF/MME/SGSNuMAC HG 商用局 融合 58GB AMF/MME/SGSN该参数决定了ZXUN uMAC所要部署的NFS、虚机的个数和规格等参数，在商用局中，该参数的值由商务合同规定。|根据实际场景进行配置。
Built-in LIG|该参数用于配置是否需要在ZXUN uMAC中同时部署安全网关功能。|国内运营商场景： 该参数固定设置为YES。
Share|该参数用于设置是否以共享方式部署ZXUN uMAC。TRUE共享方式部署，需要支持5G切片功能，ZXUN uMAC可以被多个切片共享时，该参数必须设置为TRUE。FALSE不共享方式部署，ZXUN uMAC不需要被多个切片共享，或者仅属于某个专用切片中的NF（如SMF/UPF），该参数设置为FALSE。|国内运营商场景： 该参数固定设置为FALSE。
Item|本参数用于配置ZXUN uMAC是否开启全量备份功能。当VNF Scenario Name配置为融合场景时，才需要配置。全量备份功能是一种备份方式，适用于容灾策略。ZXUN uMAC支持三种容灾策略。有UDSF表示5GC网络中部署了单独UDSF且备份方式为备份全量用户信息。此种情况下，一个AMF Set内的所有AMF共享一个UDSF，此UDSF包括所有AMF的租户信息和所有AMF的用户数据。无UDSF全量备份表示5GC网络中没有部署单独UDSF且备份方式为备份全量用户信息。此种情况下，UDSF会跟AMF一起部署（和UDSF一起部署的AMF称为UDSF的主用AMF），UDSF内置在AMF中，一个AMF  Set内的所有AMF按照GUAMI粒度相互备份，单个UDSF会保存包含其主用AMF及可接管GUAMI对应AMF的租户信息和用户数据。无UDSF部分备份表示5GC网络中没有部署单独UDSF且备份方式为备份部分用户信息。此种情况下，UDSF会跟AMF一起部署（和UDSF一起部署的AMF称为UDSF的主用AMF），UDSF内置在AMF中，一个AMF  Set内的所有AMF按照GUAMI粒度相互备份，单个UDSF包含其主用AMF的租户信息和用户数据及可接管GUAMI对应AMF的在线用户数据（包括SUPI、GUTI和TA  List信息）。|本参数的配置结果会影响到VM Parameters页签的数据，具体情况如下：如果该参数设置为YES，VM Parameters页签中，会增加GSU-CGW这种类型的虚机。如果该参数设置为YES，VM Parameters页签中，CDU-C这种类型的虚机的初始个数需要修改为3。
Master Tenant ID|本参数用于配置主用租户的ID。当VNF Scenario Name配置为融合场景时，才需要配置。在开启全量备份的情况下，需要配置两个租户，租户的名称和ID是通过VNF UDSFCfg Setting配置的，本参数只是配置哪一个租户为主用租户。租户（Tenant）是指使用系统或计算资源的用户。UDSF支持多租户，不同租户的数据访问和数据存储都是隔离的，从而保证数据的安全。|配置原则如下：本参数设置为1，表示租户1为主用。本参数设置为2，表示租户2为主用。
##### Tenant和User 
配置原则 :Tenant & Users页签用于配置ZXUN uMAC所使用的Tenant（租户）和User（用户）信息，必须配置。
本页签配置的功能适用于以下两种场景： 
场景一ZXUN uMAC所使用的Tenant（租户）是在VIM配置的，配置说明参见配置说明（场景一）。此种场景下，如果LLD中配置的ZXUN uMAC所使用的Tenant（租户）没有事先在VIM上配置，则在实例化的过程中，会自动在VIM（中兴通讯的TECS
OpenStack）上创建。 
场景二ZXUN uMAC所使用的Tenant（租户）是在MANO上配置的，配置说明参见配置说明（场景二）。某些运营商规划的使用场景：MANO可以支持创建ZXUN uMAC创建对应的项目，在MANO创建项目（即租户）的同时，需要为项目分配资源，包括虚拟内核个数、内存大小、磁盘空间大小等虚拟资源。此种场景下，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。 
###### 配置说明（场景一） 
 说明： 
此种场景下，Enable VNF quota application必须配置为NO。
通常情况下，ZXUN uMAC对应的项目是在VIM上（本文档示例为中兴通讯的TECS
OpenStack）创建的，配置之前需要先了解相关概念。
租户Tenant（租户）又称为Project（项目）。ZTE TECS OpenStack以项目的方式实现各个虚拟网元之间虚拟资源的隔离，同一个VNF内的主机、网络等资源归属到同一项目。通常情况下，操作员需要为每个VNF创建一个项目。 
用户ZTE TECS OpenStack支持多用户接入，不同的用户，在ZTE TECS OpenStack上可以拥有不同的操作权限和资源访问范围，可以为每一个项目创建一个用户。当一个VIM云平台同时管理运营商的多个VNF时，为隔离不同运营商的VNF，需要使用不同的用户来接入。通常情况下，除了ZTE TECS OpenStack默认的admin用户之外，操作员还需要为每个项目都创建一个用户。 
Tenant & Users页签如[图1]所示，配置的Tenant（租户）和User（用户）信息涉及到三种类型：
VIM云平台（本文档指中兴通讯的TECS OpenStack） 
ZXUN uMAC需要根据运营商的要求进行配置。 
SDN仅SDN组网架构时，才需要配置。 
图1  Tenant和Users

参数说明参见[表1]和[表2]。
参数名称|参数说明|配置指引
---|---|---
TECS Provider|Tenant Name|该参数用于配置TECS OpenStack的租户名称，默认值为admin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Username|TECS Provider|该参数用于配置TECS OpenStack的用户名称，默认值为admin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Password|TECS Provider|该参数用于配置TECS OpenStack的用户密码。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Role|TECS Provider|该参数用于配置TECS OpenStack用户的角色。admin用户的角色固定为admin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
AMF|Tenant Name|该参数用于配置ZXUN uMAC的租户名称。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
User Group Name|AMF|该参数用于配置ZXUN uMAC所要创建的用户组的名称。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Username|AMF|该参数用于配置ZXUN uMAC的用户名称。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Password|AMF|该参数用于配置ZXUN uMAC的用户密码。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Role|AMF|该参数用于配置用户的角色。国内运营商场景，ZXUN uMAC使用的角色，固定为ProjectAdmin。|Tenant& Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTENFV LLD(VIM) XX.xlsx表中获取。国内运营商场景：TECS Provider和SDN的用户名与密码应一致，即SDN使用TECSOpenStack的用户名和密码，从ZTE NFV LLD(VIM) XX.xlsx表的Tenant &Users页签获取。
Shared External Network for vRouters|Tenant Name|该参数用于配置SDN的租户名称。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Username|Shared External Network for vRouters|该参数用于配置SDN的用户名称。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Password|Shared External Network for vRouters|该参数用于配置SDN的用户密码。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Role|Shared External Network for vRouters|该参数用于配置SDN用户的角色。admin用户的角色固定为admin。|本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。需要配置用于创建vRouter的共享外部网络平面、静态路由和VPC的租户信息。该租户的用户必须已经创建好，并且具有admin权限。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
参数名称|参数说明
---|---
Enable VNF quota application|在此种场景下，本参数需要配置为NO。
VNF vCPU qouta (core)|此种场景下，不需要配置这些参数。
VNF vRAM qouta (GB)|此种场景下，不需要配置这些参数。
VNF vStorage qouta (GB)|此种场景下，不需要配置这些参数。
###### 配置说明（场景二） 
 说明： 
此种场景下，Enable VNF quota application必须配置为YES。
Tenant & Users页签如[图2]所示。
图2  Tenant和Users

参数说明参见[表3]和[表4]。
参数名称|参数说明
---|---
TECS Provider|Tenant Name|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
User Group Name|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
Username|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
Password|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
Role|TECS Provider|TECS Provider对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。
AMF|Tenant Name|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
User Group Name|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Username|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Password|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Role|AMF|对于ZXUN uMAC对应的所有参数，都是从MANO上获取的，操作员需要确认ZXUN uMAC所使用的Tenant（租户）已经在MANO上配置成功，LLD中配置的租户名称需要与MANO上配置的数值一致，如果MANO上并不存在此租户，则实例化会失败。
Shared External Network for vRouters|Tenant Name|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
User Group Name|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Username|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Password|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
Role|Shared External Network for vRouters|Shared External Network for vRouters对应的所有参数的配置原则，与第一个场景时的配置原则相同，参见表1中的配置说明即可。SDN组网架构下，操作员才需要配置此列数据。非SDN组网架构下，操作员不需要配置此列数据
参数名称|参数说明|配置指引
---|---|---
Enable VNF quota application|本参数的使用场景为：某些运营商要求，需要在MANO可以支持创建ZXUN uMAC创建对应的项目，在创建项目（即租户）的同时，需要为项目分配资源，包括虚拟内核个数、内存大小、磁盘空间大小等虚拟资源。如果需要使用此功能，则此参数需要配置为YES|当Global Setting页签中的参数Applicationscenarios配置为CMCC Phase3时，表示部署场景为中移三期资源池场景，本参数必须配置为YES。
VNF vCPU qouta (core)|表示为ZXUN uMAC对应的租户（项目）分配的虚拟内核数量，该项目中启动的虚机的内核数总和不得超过该参数值。|本参数的取值，已经在MANO上配置成功，需要和MANO上的配置值一致，如果MANO上并不存在对应的数据，则实例化会失败。
VNF vRAM qouta (GB)|表示为ZXUN uMAC对应的租户（项目）分配的虚拟内存数量。|本参数的取值，已经在MANO上配置成功，需要和MANO上的配置值一致，如果MANO上并不存在对应的数据，则实例化会失败。
VNF vStorage qouta (GB)|表示为ZXUN uMAC对应的租户（项目）分配存储空间。|本参数的取值，已经在MANO上配置成功，需要和MANO上的配置值一致，如果MANO上并不存在对应的数据，则实例化会失败。
##### NTP Server 
配置原则 :NTP Server页签用于配置ZXUN uMAC对应的NTP服务器，必须配置。
配置说明 :NTP Server页签如[图1]所示。
图1  NTP Server

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
NTP Server IP|通常情况下，使用EM作为ZXUN uMAC的NTP服务器。|本页参数无需修改。
##### Volume Types（可选） 
配置原则 :Volume Types页签用于配置ZXUN uMAC规划的云硬盘类型名称，以及所使用的后端类型，配置原则如下：
当Global Setting页签中的Storage
Type配置为CEPH时（表示ZXUN uMAC使用后端存储设备），才会出现该页签，需要操作员进行配置。 
当Global Setting页签中的Storage
Type配置为Local Disk时（表示ZXUN uMAC使用本地存储，即使用服务器的硬盘进行存储），不会出现此页签，操作员不需要配置。 
 说明： 
当修改了本页签中的Volume Type Count（云硬盘类型数量）、Volume Type Name（云硬盘名称）等参数后，需要同步修改Storage Qos页签（参见[Storage QoS]）、VM Parameters页签（参见[VM Parameters]）中各个存储Qos、虚机对应的云硬盘类型的数量和名称。
配置说明 :Volume Types页签如[图1]所示。
图1  Volume Types

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Volume Type Count|本参数用于设置ZXUN uMAC的云硬盘类型个数，在下拉列表中选择需要配置的个数。当ZXUN uMAC需要启用存储Qos策略时，通常需要配置多个云硬盘类型，不同的云硬盘类型关联对应的存储Qos策略，并将不同的云硬盘类型关联到不同的虚机。存储Qos策略需要在Storage Qos页签中进行配置，参见“Storage QoS”。当ZXUN uMAC不需要启用存储Qos策略时，ZXUN uMAC只需要1个云硬盘类型，ZXUN uMAC的所有虚机共用这个云硬盘类型。|本参数保持默认，无需修改。
Volume Type Name|该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的TECS OpenStack）上创建的云硬盘对应的名称，用于给虚拟机分配数据存储空间。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：Volume Type Name参数是规范命名，需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。
Volume Backend|该参数是指操作员预先在VIM云平台（本文档指中兴通讯的TECS OpenStack）上创建云盘类型时，指定的存储后端。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。配置时，需要注意：该参数为VIM云平台中（本文档指中兴通讯的TECS OpenStack）配置的存储池对应的存储后端的名称，而不是存储池的名称。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：从ZTE NFV LLD(VIM) XX.xlsx表的Cinder Backend页签中获取的Cinder backend Name，如果实际场景中，配置了多个存储后端，需要根据实际情况选择。
##### Storage QoS 
配置原则 :Storage QoS页签用于配置ZXUN uMAC规划的存储QoS策略，配置原则如下：
当Global Setting页签中的Storage
Type配置为CEPH时（表示ZXUN uMAC使用后端存储设备），才会出现该页签，需要操作员进行配置。 
当Global Setting页签中的Storage
Type配置为Local Disk时（表示ZXUN uMAC使用本地存储，即使用服务器的硬盘进行存储），不会出现此页签，操作员不需要配置。 
背景知识 :存储QoS策略是指在VIM云管理平台上创建的云硬盘的读写策略，运营商可以定义多个存储QoS策略，每个存储QoS策略都设置一个对应的名称，每个虚机都可以关联一个对应的存储QoS策略，该存储QoS策略可以对虚机对应的在VIM云管理平台上创建的云硬盘的读写策略进行限制。 
Storage QoS策略的实现原理为：本页签中定义的存储QoS策略会被Volume Types中定义的云硬盘类型关联、云硬盘类型被VM Parameters页签中定义的VNF虚机使用的云硬盘关联，最终体现为VNF虚机关联了存储QoS策略，相应的QoS策略生效。
配置说明 :Storage QoS页签如[图1]所示。
图1  Storage QoS

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
QoS Policy Count|本参数用于设置ZXUN uMAC的存储QoS策略的个数。规划了几个存储QoS策略供虚机使用，则此处就需要配置几个存储QoS策略。设置为0：表示ZXUN uMAC不使用存储QoS策略。设置为非0的数字：表示ZXUN uMAC使用存储QoS策略。这种情况下，通常需要配置三个存储QoS策略，ZXUN uMAC使用的存储QoS策略、OMU虚机使用的QoS策略、LIG的虚机使用的存储QoS策略（在ZXUN uMAC支持LIG功能时，才需要配置）。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Storage QoS Policy Name|本参数用于设置ZXUN uMAC的存储QoS策略的名称。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Volume Type Name|本参数用于设置当前QoS策略关联的云硬盘类型名称。该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的TECS OpenStack）上创建的云硬盘对应的名称。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。云硬盘类型与存储QoS策略是一对一的关系，即：每个云硬盘类型只能关联1个存储QoS，每个存储QoS只能关联到1个云硬盘类型。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Total Input/Output Bytes Per Second (bytes/s)|总读写速度(字节/秒)，该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写速度。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
Total Input/Output Bytes Per Second (bytes/s)|总读写IOPS（次/秒），该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写IOPS。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。|中国移动配置场景：如果VNF的LLD是与VIM的LLD同时规划的，则该参数对应的值是从ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签中获取的。需要根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001”这一段。可参考ZTE NFV LLD(VIM) XX.xlsx表中Global Setting页签进行大区标识、硬件资源池标识、虚拟资源池编号、接入省份标识、网元编号填写。
##### VNF Network Qos 
配置原则 :VNF Network Qos页签用于配置ZXUN uMAC的网络QoS控制策略，必须配置。
 说明： 
网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略，通过此页签设置是否启用网络Qos功能，启用后，需要在VNF Network Setting或VNF Network Setting IPv6页签中修改网络Qos策略最大带宽值。
配置说明 :VNF Network Qos页签如[图1]所示。
图1  VNF Network Qos

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Qos Policy Count|本参数用于设置ZXUN uMAC的网络Qos策略的个数。规划了几个网络QoS策略供虚机使用，则此处就需要配置几个网络QoS策略。设置为0：表示ZXUN uMAC不使用网络QoS策略。设置为非0的数值：表示ZXUN uMAC使用网络QoS策略，数值为几，表示配置几个网络QoS策略。设置为此选项后，需要在VNF Network Setting或VNF Network Setting IPv6页签中修改网络Qos策略最大带宽值。|该参数根据实际项目要求设定，中国移动5GC二期项目场景：网元QoS个数为8。
Network Qos Policy Name|该参数用于设置ZXUN uMAC的网络QoS策略的名称。运营商可以定义多个网络QoS策略，每个网络QoS策略都设置一个对应的名称，每个虚机都可以配置一个对应的网络QoS策略，该网络QoS策略可以对虚机中的各个网卡进行限制。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|根据中国移动命令规范修改大区标识、硬件资源池编号、省份标识、网元标识以及网元编号，其他字段保持默认。
Max Egress Bandwidth (kbps)|（出口）双向最大带宽，该参数用于配置硬件服务器网卡出口的双向最大带宽。|本参数保持默认，无需修改。
Max Egress Bandwidth (kbps)|（出口）双向最大突发带宽，该参数用于配置硬件服务器网卡出口的双向最大突发带宽。|本参数保持默认，无需修改。
Max Ingress Bandwidth (kbps)|（入口）双向最大带宽，该参数用于配置硬件服务器网卡入口的双向最大带宽。|本参数保持默认，无需修改。
Max Ingress Burst Bandwidth (kbps)|（入口）双向最大突发带宽，该参数用于配置硬件服务器网卡入口的双向最大突发带宽。|本参数保持默认，无需修改。
##### VM Parameters 
配置原则 :VM Parameters页签用于配置ZXUN uMAC相关虚机的规格、最大个数、虚机归属的AZ域及HA、使用的云盘类型等信息，必须配置。
规划网络地址数据时，需要满足如下原则： 
规划内部网络平面的CIDR地址段中可用地址数量不小于所有虚机最大数的总和。 
规划IPU的外部网络平面的CIDR地址段中可用地址数量不小于所有IPU虚机最大数。 
配置说明 :VM Parameters页签如[图1]所示。
图1  VM Parameters

在配置本页签前，需要先了解ZXUN uMAC的VM规划数据，参见[表1]。
VM|描述
---|---
OMU|操作与维护单元，其中还包含一个用于辅助判断OMU主备状态的AMU单元。
GSU|通用业务单元（General Service Unit），负责处理ZXUN uMAC的控制面、信令面和媒体面业务。
IPU|接口处理单元（Interface Process Unit），提供各种类型的接口，用于ZXUN uMAC与除EM之外的其他网元进行通信。
CDU|云数据库单元，用于存储用户会话上下文等信息。
OMUE|OMUE虚机用于分担OMU的负荷。
IAU|这两种虚机是安全网关功能的虚机，在ZXUN uMAC启用安全网关功能功能时，才需要配置。
IMU|这两种虚机是安全网关功能的虚机，在ZXUN uMAC启用安全网关功能功能时，才需要配置。
参数说明参见[表2]。
参数名称|参数说明|配置指引
---|---|---
VM Flavor|本参数用于设置ZXUN uMAC虚机的规格，虚机的规格（flavor）于规定虚机占用的资源，包括虚拟内核个数、内存大小、磁盘空间大小、元数据等，包括：vCPU：CPU核数Memory (GB)：内存数Local Storage(GB)：本地存储Remote Storage(GB)：远端存储Redundancy Scheme：备份方式VM Count：虚机初始个数VM MAX Count：虚机最大个数|ZXUN uMAC虚机的规格（flavor）是由ZXUN uMAC部署的场景来决定的，即操作员先需要确认部署场景，每种场景都对应固定的虚机规格，确认了部署的场景，也就确认了需要配置的所有虚机的规格。在配置本参数前，操作员需要先通过配置VNF Scenario页签来配置场景，VNF Scenario页签中的参数VNF Scenario Name决定了VM Parameters页签中VM Flavor的数据。对于CDU虚机的VM Count参数，默认情况下，配置为2，当开启全量备份功能 ，即当VNF Scenario页面中的参数Item配置为开启全量备份，且VNF UDSFCfg Setting页面中的参数Tenant Count配置为2时，CDU虚机的VM Count参数需要配置为3。
Availability Zone|本参数用于设置ZXUN uMAC虚机所属的可用域（Availability Zones）的名称。|本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪个可用域（Availability Zones），就配置为哪个可用域（Availability Zones）的名称。
Host Aggregate Metadata|本参数用于设置HA元数据属性。|本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪种HA元数据属性的主机上，就配置为对应的HA元数据属性。
Anti-affinity Policy /Anti-affinity Factor|该参数用于设置Anti-affinity Policy（反亲和策略）或者Anti-affinity Factor（反亲和因子）。ZXUN uMAC只涉及到配置Anti-affinity Policy（反亲和策略）。该参数用于控制是否将一个虚拟机组（Server-group）中的多个同种类型的虚机（例如OMU虚机）分别部署在不同的主机上。包括如下选项：不限制表示系统不对虚机部署进行限制，即同种类型的虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。反亲和设置为此选项，表示系统需要对虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个同种类型的虚机必须分散部署在ZXUN uMAC所在可用域（Availability Zones）的不同主机上。设置为该参数后，操作员还可以通过反亲和组名来设置互斥组的名称。软反亲和设置为此选项，表示系统需要对同种类型的虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。|中国移动场景：均设置为Anti-affinity（反亲和）。
N Value for N+1 Redundancy Per VM Group|本参数用于设置虚机组支持N+1冗余中的N值。|N+1等于antiAffinityVMNumber，虚机最大数除以 N+1等于互斥组数量，建议保持默认值。
Anti-affinity Group Count|反亲和组个数即为互斥组个数，当虚机的部署策略设置为反亲和时，才会涉及到该参数的配置。简单来说，本参数决定了单个主机上所能部署的虚机的最大个数，即如果该参数设置为1，则单个主机上只能部署一个虚机，如果该参数设置为2，则单个主机上最多只能部署两个虚机。该参数设置为1，表示所有的虚机都在一个互斥组中，即这个互斥组中的每个虚机都必须分散部署在不同的主机上。在这种情况下，实际环境中的主机个数必须大于等于虚机的个数，否则就会部署失败，实例化不成功。该参数设置为2，表示所有的虚机平均分布在两个互斥组中，即每个互斥组中的虚机都必须分散部署在不同的主机上，但是组间的IPU虚机无需互斥部署。示例：如果部署了10个虚机，则1~5在一个互斥组中，6~10在一个互斥组中，其中1~5必须部署在不同的主机上，6~10必须部署在不同的主机上，但是5和7、3和8...，分别属于两个互斥组的虚机可以部署在同一个主机上。这种情况下，实际环境中的主机个数必须大于等于5个，否则就会部署失败，实例化不成功。|IPU和GSU-CGW虚机，Anti-affinity Group Count参数固定配置为1。其他类型的虚机，需要根据各个虚机的最大个数和实际环境中的计算节点个数来进行配置，计算原则如下：ZXUN uMAC的虚机支持7+1备份方式（即7个主用，1个备用），即部署ZXUN uMAC时，VIM需要至少提供8个计算节点。示例：如GSU-C-K1虚机的最大个数为100个，需要分别部署在8个计算节点上，Anti-affinity Group Count参数的值为100/8=10，即对于GSU-C-K1虚机，Anti-affinity Group Count参数需要配置为10。
VM Volume Type|本参数用于设置ZXUN uMAC的虚机使用的云硬盘类型。本参数的取值是通过Volume Types页签配置的。当在Volume Types页签中为ZXUN uMAC设定了多个云硬盘类型时，在本表格的下拉框中可以进行选择，参见“Volume Types（可选）”。|中国移动场景：根据大区情况修改“HDBNJ-03A-ZX-01-VOLT-ahSMF001BZX”这一段。CDB对应的一行需要修改改成CDU。IAU和IMU虚机选择LDISK。
Priority of VM creation|该参数用于设置在实例化过程中，创建虚机资源的优先级，数字越小表示优先级越高。建议所有的虚机都使用默认值1，即所有的虚机的优先级都为最高，表示在实例化ZXUN uMAC的过程中，会并行创建所有虚机及相关资源。|使用默认值1。
Priority of VM restart|本参数用于设置虚拟机启动上电的优先级。取值范围为1~10，数值1表示优先级最高，数值10表示优先级最低。虚拟机启动上电时，虚拟机所在的服务器根据虚拟机对应的优先级进行处理，将优先级高的虚拟机先上电，将优先级低的虚拟机后上电。|一般情况下，建议将ZXUN uMAC的OMU的优先级设置为1。在部署了安全网关功能的情况下，需要将安全网关的虚机IAU的优先级设置为1。
VM Extern Size|本参数用于设置虚机规格别名。|建议保持默认值。
Backup Instance Number|本参数用于设置同组单批次允许下电的虚机数/比例。|主要作用是考虑OMU、AMU、OMUE在一个互斥组里，这三种类型的虚机，其Backup Instance Number需设置为1，建议保持默认值。
min_free_kbytes|本参数用于设置虚机内存水线。|建议保持默认值。
max_server_per_host|本参数用于设置硬互斥的互斥组可以在单个服务器上部署最大虚机数量。|针对亲和类型为反亲和（即硬反亲和）的虚机反亲和组有效。如果超过1个，硬互斥的互斥组也可以在单个服务器上部署最大为 max_server_per_host个虚机。如果配置为0，则表示无效，等同于1。建议保持默认值。
##### VRF Summary 
配置原则 :VRF Summary页签用于配置VRF，本页签已经预先配置了所有类型的NF可能涉及到的VRF，操作员不能删除原有默认的VRF，如果系统默认的VRF不适用运营商的组网规划，操作员可以根据实际情况在用户自定义VRF1中进行新增即可。
配置说明 :VRF Summary页签如[图1]所示。
VRF包括两部分内容： 
业务交换机侧的VRF数据 
ZXUN uMAC侧的VRF数据 
图1  VRF Summary

默认的VRF参数说明参见[表1]。
类别|VRF名称（示例）|说明|配置指引
---|---|---|---
业务交换机侧需要配置的VRF|mng|交换机管理口内置VRF。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
BOSS|业务交换机侧需要配置的VRF|可选，ZXUN uMAC部署为USPP/AAA/SSS/AGCF，与运营商的BOSS系统通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
CHARGING|业务交换机侧需要配置的VRF|用于ZXUN uMAC与Ga接口、Rf接口通信|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
EMS|业务交换机侧需要配置的VRF|用于ZXUN uMAC与EMS通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GI|业务交换机侧需要配置的VRF|用于ZXUN uMAC的Gi接口、SGi接口，Radius接口。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GTP|业务交换机侧需要配置的VRF|用于ZXUN uMAC的GTP接口（如S11/S5/S8接口）。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
RAN|业务交换机侧需要配置的VRF|用于ZXUN uMAC与2/3/4G网络的无线侧通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
SIG|业务交换机侧需要配置的VRF|用于ZXUN uMAC与不同业务域网元间信令互通。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
NF侧需要配置的VRF|SBI|用于ZXUN uMAC与5G网络中的SBI接口。在5G标准规范的系统架构中引入了服务化接口（即SBI）的概念，来表述一个NF提供其所具有的服务（或服务集合）给其它的NF使用的方式，在5G标准中一般采用Nxxx（如Namf，Nudm等）的方式表达。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
BOSS|NF侧需要配置的VRF|可选，ZXUN uMAC部署为USPP/AAA/SSS/AGCF，与运营商的BOSS系统通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
CHARGING|NF侧需要配置的VRF|用于ZXUN uMAC的Ga接口、Rf接口。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
EMS|NF侧需要配置的VRF|用于ZXUN uMAC与EMS通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GI|NF侧需要配置的VRF|用于ZXUN uMAC的Gi接口、SGi接口，Radius接口。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
GTP|NF侧需要配置的VRF|用于ZXUN uMAC的GTP接口（如S11/S5/S8接口）。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
RAN|NF侧需要配置的VRF|用于ZXUN uMAC与2/3/4G网络的无线侧通信。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
SIG|NF侧需要配置的VRF|用于ZXUN uMAC与不同业务域网元间信令互通。|本页签默认包括了所有类型的NF可能涉及到的所有的VRF，一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可，比如部署了LIG功能时，需要增加ZXUN uMAC与LIG的外部接口通信时使用的VRF（示例为LIG_EXT）。
##### VNF Network Setting 
配置原则 :VNF Network Setting页签用于配置ZXUN uMAC规划的网络平面相关信息。
如果在Global Setting页签中，将VNF IP Type设置为IPv4，此处的页签名称为VNF Network Setting。 
如果在Global Setting页签中，将VNF IP Type设置为IPv6，此处的页签名称为VNF Network Setting IPv6。 
 说明： 
当Global
Setting页签中的Network Type配置为VLAN时（表示ZXUN uMAC使用非SDN组网架构），操作员才需要配置此页签。
配置说明 :VNF Network Setting页签如[图1]所示。
 说明： 
在为各个网络平面规划IP地址时，所有的网络平面都不能使用172.17.0.0/16地址段中的IP地址。 
图1  VNF Network Setting

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
VNF Brief Name|本参数为NF的简称。|此单元格的值是由VNF ID页签中的VNF Type和ID两个参数设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，如果需要修改，可以直接修改VNF Type和ID这两个参数。
Tenant|本参数为NF对应的租户|此单元格的值是由Tenant & Users页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，如果需要修改，可以直接修改Tenant & Users页签中的参数。
Network Usage|ZXUN uMAC的各个网络平面的网络用途规定如下：内部控制面需要设置为INTERNAL MGT（内部管理通信）内部媒体面需要设置为INTERNAL SERVICE（内部服务通信）所有的外部网络平面需要设置为EXTERNAL（外部业务通信）ZXUN uMAC的网管平面的设置原则如下：OAM (Used OAM network of VNFM)ZXUN uMAC的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行二层互通。OAM (Used Shared IPv4 OAM Subnet)ZXUN uMAC的OAM平面（即网管平面）使用已存在的多网元共享的OAM网络平面（非VNFM的OAM平面）与VNFM进行三层互通。OAM (Create individual OAM network)ZXUN uMAC的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行三层互通。ZXUN uMAC的网管平面需要区别IPv4和IPv6分别设置。|根据运营商的规划进行设置。
Share Type|表示此网络平面属性是否为共享网络。本参数的配置原则如下：在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。|根据运营商的规划进行设置。
Transparent|本参数用于配置网络透传模式。True：透传False：不透传参见以下原则进行配置：当NFVI启用QinQ功能时，需要设置为透传模式（True）。对于网元内部网络平面，默认采用非透传模式（False），不可修改。对于业务外部网络平面，需要使用透传模式时选择True，需要使用非透传模式时选择False。|根据运营商的规划进行设置。
vNIC Type|本参数用于配置业务虚机的网卡类型。normal：表示虚机的网卡启用OVS/DVS。SR-IOV：表示虚机的网卡启用SR-IOV。|根据运营商的规划进行设置。
Network Deployment|本参数用于配置ZXUN uMAC的网络平面是事先通过VIM云平台（本文档指RedHat）创建的，还是由操作员直接在LLD中配置的。对于所有的NF共用的网管平面，在实例化ZXUN uMAC之前，如果此平面已经创建成功，则网管平面需要配置为当前已存在。本次实例化如果操作员直接通过LLD创建ZXUN uMAC的网络平面，则需要配置为本次实例化。当前已经存在表示LLD中配置的网络平面，操作员已经预先通过VIM云平台（本文档指TECS OpenStack）创建成功，LLD表格中填写的网络平面名称需要从TECS OpenStack处查询获取， 在TECS OpenStack上创建网络平面的操作参见创建网络平面。|根据运营商的规划进行设置。
Brief Net Name|本参数用于配置ZXUN uMAC的网络平面的简称。需要新增网络平面时，在红色底纹的空行处，在此列填写一个简要名称，就会自动增加一行网络平面，再选择对应的vNIC Type填写相应的网段、VLAN信息。|根据运营商的规划进行设置。
Network Qos Policy Name / Value|本参数用于设置该网络平面对的网络QoS控制策略。网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。此处配置的网络QoS控制策略，是预告通过VNF Network Qos页签配置好的，本参数值需要与VNF Network Qos页签中配置的参数Network Qos Policy Name值一致。|本参数配置的是某个网络平面的网络QoS控制策略。配置成功后，此QoS控制策略会应用到此网络平面的所有端口上。
Neutron Net Name|该参数用于设置网络平面的名称。|根据运营商的规划进行设置。
VLAN ID|该参数用于设置网络平面的VLAN ID。|本参数保持默认，无需修改。
Subnet Deployment|本参数用于配置ZXUN uMAC的网络平面的子网是事先通过VIM云平台（本文档指TECS OpenStack）创建的，还是由操作员直接在LLD中配置的。本次实例化如果操作员直接通过LLD创建ZXUN uMAC的子网，则需要配置为本次实例化。当前已经存在表示LLD中配置的网络平面，操作员已经预先通过VIM云平台（本文档指TECS OpenStack）创建成功，LLD表格中填写的网络平面名称需要从TECS OpenStack处查询获取。|根据运营商的规划进行设置。
Neutron Subnet Name|该参数用于设置网络平面的子网名称。|根据规划的数据进行创建。
Subinterface Count|本参数用于配置子接口个数。|在网络透传模式下（Transparent设置为透传）才需要填写此参数，表明对应网络平面生成的接口下规划多少个子接口。
VNF Side VRF|本参数用于配置ZXUN uMAC侧的VRF数据。|此单元格的值是由VRF Summary页签中的参数设置后，在本单元格自动引用生成的。
Switch Side VRF|本参数用于配置业务交换机侧的VRF数据。|此单元格的值是由VRF Summary页签中的参数设置后，在本单元格自动引用生成的。
Subnet CIDR|本参数为子网的网段范围。|为前几列集合，无需填写，自动生成。在为各个网络平面规划IP地址时，所有的网络平面都不能使用172.17.0.0/16地址段中的IP地址。
Gateway IP|本参数为网关IP地址。|根据Subnet CIDR地址修改Gateway IP地址。
MTU|该参数表示VNF的MTU数值。|在运营商没有特殊要求的情况下，内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。如果运营商对MTU有特殊要求，需要根据运营商的规范进行设置。
Physical Network|该参数用于设置此网络平面对应的物理网络名称。|此单元格的值是由Global Setting页签中的参数Physical Network Name设置后，在本单元格自动引用生成的，操作员不需要配置。
Security Group|安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（Security Group Rule）。本参数只适用于VIM平台采用中兴通讯的TECS OpenStack的场景。需要预先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组的情况下，该参数的值才会生效。|本参数保持默认，无需修改。
###### 创建网络平面 
介绍如何创建预先在TECS OpenStack上创建ZXUN uMAC的网络平面及其子网。
登录TECS OpenStack
在PC客户端，打开Google Chrome浏览器，在地址栏输入https://x.x.x.x/ngportal/login
。
地址填写说明参见[表2]。
项目|说明
---|---
x.x.x.x|设置一个IP地址，需要设置为TECS OpenStack的主用控制节点的TECSClient网络平面的IP地址，操作员通过此地址可以使用浏览器登录TECSOpenStack的客户端。
按Enter键，页面自动转到登录页面，如[图2]所示。
初始登录TECS OpenStack客户端的默认用户名及密码如下： 
TECS OpenStack V3.17.14版本以上用户名：admin密码：Keystoneli 
TECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123 
图2  TECS OpenStack登录页面

输入用户名和密码，单击登录按钮，进入TECS OpenStack，默认显示为总览页面，如[图3]所示。
图3  TECS OpenStack总览页面

创建网络平面
在TECS OpenStack的客户端上，切换到云管理页面，在左侧导航栏中选择资源管理→网络
，右侧出现网络区域框，如[图4]所示。
图4  网络区域框

单击添加网络按钮，弹出添加网络对话框，如[图5]所示。
图5  创建网络对话框

创建网络对话框中的参数说明参见[表3]。
参数名称|参数说明
---|---
基本信息|项目|该参数用于设置该网络平面属于的项目。根据规划的数据进行创建。
名称|基本信息|该参数用于设置网络平面的名称。根据规划的数据进行创建。
网络类型|基本信息|该参数用于设置网络平面的网络类型，需要根据运营商的实际网络环境进行设置，包括以下选项。flatflat网络是指扁平网络，即VIM云平台本身不对业务网络进行VLAN隔离，只能依赖外部交换机过滤VLAN报文。从安全的角度考虑，在商用环境中，一般不建议使用flat网络类型。vlan如果运营商的组网环境为非SDN，建议设置为vlan。设置为此选项时，还需要设置物理网络和透传VLAN两个参数。vxlan如果运营商的组网环境为SDN，建议设置为vxlan。VXLAN是一种网络虚似化技术，是对VLAN技术的进一步优化，VXLAN提供和VLAN相同的二层网络服务，但相比VLAN有更大的扩展性和灵活性，用于解决在部署大型云计算设备时的数量扩展问题。
物理网络|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面对应的物理网络名称，根据规划数据，ZTE_uMAC_PROJ项目所有网络平面对应的物理网络名称都规划为physnet1。
VLAN透传|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面是否支持VLAN透传功能。根据的规划数据，ZTE_uMAC_PROJ项目的外部网络平面，建议勾选此参数。
段ID|基本信息|该参数用于设置设置VLAN ID。如果该网络平面支持VLAN透传功能，必须设置VLAN子接口范围。即段ID的格式需要设置为××:××:××，三个值分别表示为起始VLAN、终止VLAN和Native VLAN（PVID）。
高级属性|MTU|该参数表示系统的MTU数值。对于admin项目，所有网络平面的MTU数值都为1600。对于ZTE_uMAC_PROJ项目，用于内部控制面和内部媒体面通信的网络平面的MTU配置为1800，其它网络平面都固定为1500。
网络Qos|高级属性|该参数用于设置是否启用网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。
管理状态|高级属性|该参数建议保持默认值。
共享|高级属性|表示此网络平面属性是否为共享网络。在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。
外部网络|高级属性|默认情况下，建议不需要勾选。
参数设置完成后，单击创建按钮，完成网络平面的设置。
重复执行步骤，创建所有的网络平面。 
创建子网
在TECS OpenStack的客户端，切换到虚拟资源页面，在左侧的导航栏中选择网络
→网络
，出现网络页面，可以看到已经创建成功的网络平面。
在网络平面对应的操作下拉列表中，单击选择创建子网，弹出创建子网对话框，如[图6]所示。
图6  创建子网对话框

创建子网对话框的参数说明参见[表4]。
参数名称|描述
---|---
基本信息|名称|表示网络平面对应的子网名称，根据规划的数据进行设置。
CIDR|基本信息|表示子网的地址，根据规划的数据进行设置。
项目|基本信息|从下拉列表中选择网络平面对应的项目。
激活DHCP|基本信息|勾选此选项，开启DHCP功能后，在TECS OpenStack创建虚机时，会自动为虚机分配此网络平面的IP地址。需要根据实际情况决定是否开启此功能。
禁用网关|基本信息|该参数表示子网是否需要设置网关地址。对于网元内部通讯的网络平面，勾选本参数，不需要设置网关地址。对于网元外部通讯的网络平面，如果采用非SDN VLAN组网，勾选本参数，不需要设置网关地址。对于网元外部通讯的网络平面，如果采用SDN+VxLAN组网，不勾选本参数，需要设置网关地址。采用SDN+VxLAN组网时，需要在SDN中配置路由，因此必须配置网关IP地址，该网关地址会通过TECSOpenStack传递给SDN控制器。
网关IP|基本信息|该参数表示网关地址，勾选禁用网关后，无需设置该参数。
高级属性|地址池|暂不涉及此参数，无需配置。
域名服务器|高级属性|暂不涉及此参数，无需配置。
主机路由|高级属性|暂不涉及此参数，无需配置。
设置完参数后，单击创建按钮，完成网络平面对应子网的创建。
重复执行步骤，创建所有的子网。 
##### VNF Operation and Maintenance 
配置原则 :VNF O&M IPv6页签用于修改ZXUN uMAC的操作维护网段的公网及浮动IP地址，必须配置。
 说明： 
在本页签中，仅需要修改H列的内容，H列根据C列地址段范围内前三个地址按顺序填写，对于VNF O&M IPv6页签中其他参数，取值为固定值，操作员不需要修改。
配置说明 :VNF O&M IPv6页签如[图1]所示。
图1  VNF操作维护网段地址

##### VNF Vlan Trunk IP 


配置原则 :VNF Vlan Trunk IP页签用于配置IPU虚机的IP地址范围。
本页签的配置场景如下： 

 
在运营商的组网规划中，如果将多个NF的IP地址规划到同一个网段中，本页签必须配置，为了避免各个NF之间的IP地址冲突，通过配置本页签，为IPU虚机分配固定范围内的IP地址，防止发生IP地址抢占，导致实例化失败。 

 
如果运营商的组网规划，为每个NF都单独规划了一个网段，则操作员不需要配置本页签。 

 


配置说明 :VNF Vlan Trunk IP页签如[图1]所示。
本页签配置的IP地址是为实例化成功后，系统为IPU虚机分配的IPv4或IPv6地址。
图1  VNF Vlan Trunk IP




参数说明参见[表1]。
参数名称|参数说明
---|---
Extern Network PortIpList|该参数在运营商的某种特殊的组网规划下才需要配置，运营商的组网规划中，如果将多个NF的地址规划到同一个网段中，为了避免各个NF之间的IP地址冲突，可以通过配置本参数，为IPU虚机分配固定范围内的IP地址，防止发生IP地址抢占，导致实例化失败。因为IPU虚机的最大弹性伸缩的个数为20，此处需要配置20个IP地址，初始实例化成功后，IPU虚机默认为两个，系统从此参数配置的IP地址列表中按顺序分配给IPU，后续对IPU进行弹扩操作时，系统会从此参数配置的IP地址列表中，按顺序分配IP地址给新弹扩的虚机。
Subnet PortIpList|该参数用于配置SDN组网场景下，配置外部网络平面的child（子）网络平面的IP地址范围。当Global Setting页签中的Network Type配置为VxLAN时（表示使用SDN组网架构），操作员才需要配置此参数。


##### VNF Advanced Settings 
配置原则 :VNF Advanced Settings页签用于设置ZXUN uMAC的属性，必须配置。
配置说明 :VNF Advanced Settings页签如[图1]所示。
图1  VNF Advanced Settings

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
业务系统名称|本参数用于设置ZXUN uMAC实例化成功后，在MANO上看到的ZXUN uMAC的名称。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。|业务系统名称|根据运营商的规范修改大区标识、网元编号、硬件资源池编号、AZ编号。
蓝图包名称|本参数用于设置在MANO上快速创建ZXUN uMAC的版本包时，配置的ZXUN uMAC名称。|蓝图包名称|根据运营商的规范修改省份标识、网元编号。
蓝图包版本号|本参数用于设置在MANO上快速创建ZXUN uMAC的版本包时，配置的ZXUN uMAC版本包的版本号。|蓝图包版本号|此处配置的是交付运营商的软件包的对外版本号。不是中兴通讯内部的版本号。
蓝图包厂商|本参数用于设置在MANO上快速创建ZXUN uMAC的版本包时，配置的厂商名称。|蓝图包厂商|中国联通场景，本参数需要设置为ZX。中国移动场景，本参数需要设置为ZT。中国电信场景，本参数需要设置为ZE。其他场景，本参数需要设置为ZTE。
镜像包名称|本参数用于设置在MANO上快速创建版本包时，设置的厂商名称。|镜像包名称|根据运营商的规范修改大区标识、硬件资源池编号、省份标识、网元编号。
LIG镜像包名称|本参数用于设置在MANO上快速创建安全网关版本包时，设置的厂商名称。|LIG镜像包名称|
接入的EMS地址|本参数用于配置VNF部署后，需要接入的EMS地址。实例化VNF时，会将该地址传给VNFM，在实例化VNF完成后由VNFM将VNF自动接入指定的EMS。该功能需VNFM上提前打开功能开关。|接入的EMS地址|-
所属地域|本参数用于设置ZXUN uMAC归属的地域，在某些特殊运营商的要求下，才需要配置。|所属地域|配置原则：归属省份，如果ZXUN uMAC归属的地区是广州市，那么该参数配置为广东省。
分权网元类型|本参数用于设置ZXUN uMAC的网元类型，在某些特殊运营商的要求下，才需要配置。|分权网元类型|本参数的配置原则：4、5G融合部署场景：MME/SGSN/AMF4G部署场景：MME/SGSN5G部署场景：AMF
虚机名称前缀|在某些特殊运营商的要求下，才需要设置此参数。需要根据规范配置：所属省份标识+网元标识+网元序号+网元属性+厂家标识。命名规范格式如下所示，分为多个部分，每个部分之间用短横线-连接：网元归属省/大区：由2-3位英文字母组成，示例：js网元标识：由1-8位英文字母组成，示例：MME网元序号：由1-3位数字组成，示例：12网元属性：两个取值，A表示骨干，B表示省内。厂家标识：由2-3位英文字母组成，示例：ZX|虚机名称前缀|命名规范格式如下所示，分为多个部分，每个部分之间用短横线-连接：网元归属省/大区：由2-3位英文字母组成，示例：js网元标识：由1-8位英文字母组成，示例：MME网元序号：由1-3位数字组成，示例：12网元属性：两个取值，A表示骨干，B表示省内。厂家标识：由2-3位英文字母组成，示例：ZX
云主机类型命名规则|本参数用于配置云主机类型的命名规则，即实例化ZXUN uMAC成功后，在VIM云平台上显示的ZXUN uMAC虚机名称。本参数有两个配置值：none和auto_flavor_name。本参数配置为none，表示ZXUN uMAC虚机名称的命名规则为：ram_x_vcpus_x_disk_x_uuid在运营商没有特殊要求的情况下，默认使用此种规则。本参数配置为auto_flavor_name，表示ZXUN uMAC虚机名称的命名规则为：资源前缀-FLA-自定义ID在以下几种场景下，必须配置为此种规则：当Global Setting页签中Application scenarios设置为12-CMCC Phase2、11-CMCC Phase1和1-5GS三种场景之一时当Global Setting页签中的参数Mano Protocol Mode配置为CMCC时。|云主机类型命名规则|中国移动场景：本参数配置为auto_flavor_name，表示ZXUN uMAC虚机名称的命名规则为配置为资源前缀-FLA-自定义ID。
镜像可视性|该参数用于设置ZXUN uMAC的虚机操作系统镜像的属性，一般配置为private（私有），在特殊情况下，才需要配置为public（共享），建议使用默认值。publicprivate|镜像可视性|国内运营商场景：固定配置为private。
启用密文传输敏感数据|本参数通常情况下，建议设置为启用，启用此功能后，VNFD版本包插件的内容中不会有明文密码等敏感信息，系统会进行加密处理。|启用密文传输敏感数据|国内运营商场景：固定配置为启用。
对接VNFM的IP地址版本|本参数用于配置ZXUN uMAC对接VNFM的IP地址类型，根据实际组网规划配置。|对接VNFM的IP地址版本|-
vnf和vnfm间会话协议类型|该参数用于配置VNF和VNFM之间的会话协议类型，VNF和VNFM之间支持双向认证，配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为http。如果运营商的部署环境，开启了安全加固功能，则此参数配置为https。|vnf和vnfm间会话协议类型|国内运营商场景：固定配置为https。
vnf向vnfm获取token|该参数用于设置VNF是否可以向VNFM获取token。token是计算机术语，表示令牌的意思，令牌是一种能够控制站点占有媒体的特殊帧，以区别数据帧及其他控制帧。通俗的说法，token可以称为暗号，在一些数据传输之前，服务端和客户端之间要先进行暗号的核对，不同的暗号会被授权不同的数据操作权限。Token是在服务端产生的。如果客户端使用用户名/密码向服务端请求认证，服务端认证成功，那么服务端会给客户端返回一个Token。客户端可以在每次发起请求消息时，携带Token证明自己的合法地位。该参数的配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为不启用。如果运营商的部署环境，开启了安全加固功能，则此参数配置为启用。|vnf向vnfm获取token|国内运营商场景：固定配置为启用。
vnf向vnfm获取token的用户名|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。|vnf向vnfm获取token的用户名|VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其它的用户，操作方式参见“在VNFM上创建的API用户的方法”需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。
vnf向vnfm获取token的密码|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。|vnf向vnfm获取token的密码|VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其它的用户，操作方式参见“在VNFM上创建的API用户的方法”需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。
部署配置脚本文件名称|本参数用于在实例化部署中，是否同时配置一些基础的业务数据，这些业务数据是通过脚本文件来进行自动化配置的。|部署配置脚本文件名称|国内运营商场景：此参数不涉及配置。
是否以root用户启动容器|该参数用于配置是否可以使用root用户。|是否以root用户启动容器|国内运营商场景：固定设置为启用。
启用虚机规格别名|此参数的配置结果 ，涉及到在ZXUN uMAC部署成功后，MANO和EM上显示的虚机名称。如果配置为启用，使用配置的虚机规格别名（vmexternsize）如果配置为不启用，或者虽然配置为启用，但并没有配置数据，则从template中获取vm_size，当vm_size中包含的原始虚机类型名有别名时，则使用别名替换vm_size中的原始虚机类型名。|启用虚机规格别名|此参数的值不需要操作员配置，是由ZXUN uMAC部署的场景来决定的。在配置本参数前，操作员需要先通过配置VNF Scenario页签来配置场景（参见VNF Scenario），VNF Scenario页签中的参数VNF Scenario Name决定了此参数的值，操作员不需要修改。
开启容器selinux功能|本参数用于配置，是否开启容器selinux功能。|开启容器selinux功能|国内运营商场景：固定设置为不启用。
虚机规格调整时的重建方式|本参数用于配置调整虚机规格时，虚机的重建方式。rebuild指VNFM内部执行虚机的先删再建操作。set指VNFM对虚机执行nova resize操作。|虚机规格调整时的重建方式|国内运营商场景：固定设置为set。
镜像看门狗超时措施|本参数用于设置启用镜像watchdog功能后，自动触发的动作（watchdog_action）。ZXUN uMAC定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。|镜像看门狗超时措施|国内运营商场景：固定配置为reset。
虚机看门狗超时措施|本参数用于设置启用虚机watchdog功能后，自动触发的动作。（watchdog_action）。ZXUN uMAC定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。|虚机看门狗超时措施|国内运营商场景：固定配置为none。
虚机看门狗监控时长(分钟)|该功能用于设置虚机看门狗超时（watchdog_enabledelay）时长。该时长是VM启动后，到首次喂狗动作之间的时间间隔，如果超过这个间隔没有进行喂狗操作，则会触发watchdog_action的动作。如果虚机看门狗触发动作（watchdog_action）配置为reset，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM会主动复位虚机。如果虚机看门狗触发动作（watchdog_action）配置为none，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM不会执行复位虚机的操作。|虚机看门狗监控时长(分钟)|默认值为600000毫秒，即10分钟。通常情况下建议使用默认值。
启用虚机别名|这两个参数的配置结果 ，涉及到在ZXUN uMAC部署成功后，MANO和EM上显示的虚机名称。|启用虚机别名|此参数的值不需要操作员配置，是由ZXUN uMAC部署的场景来决定的。在配置本参数前，操作员需要先通过配置VNF Scenario页签来配置场景（参见VNF Scenario），VNF Scenario页签中的参数VNF Scenario Name决定了此参数的值，操作员不需要修改。
OMU虚机|MGT平面端口的网络QoS|本参数用于配置MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面中所有的端口级别的网络Qos策略。如果此处不配置数据，则ZXUN uMAC默认使用端口所在的网络平面上配置的的网络Qos策略（参见“VNF Network Qos”）。如果此处配置了数据，则MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面的端口优先使用本参数配置的网络Qos策略。这些网络Qos策略后续需要在VNF SDN Network Setting（SDN组网架构）和VNF Network Setting（非SDN组网架构）页签中被使用。|本参数配置的网络Qos策略的优先级最高。
SERVICE平面端口的网络QoS|OMU虚机|本参数用于配置MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面中所有的端口级别的网络Qos策略。如果此处不配置数据，则ZXUN uMAC默认使用端口所在的网络平面上配置的的网络Qos策略（参见“VNF Network Qos”）。如果此处配置了数据，则MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面的端口优先使用本参数配置的网络Qos策略。这些网络Qos策略后续需要在VNF SDN Network Setting（SDN组网架构）和VNF Network Setting（非SDN组网架构）页签中被使用。|本参数配置的网络Qos策略的优先级最高。
EMS平面端口的网络Qos|OMU虚机|本参数用于配置MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面中所有的端口级别的网络Qos策略。如果此处不配置数据，则ZXUN uMAC默认使用端口所在的网络平面上配置的的网络Qos策略（参见“VNF Network Qos”）。如果此处配置了数据，则MGT网络平面（内部控制平面）、SERVICE（内部媒体平面）、EMS（网管平面）这几个网络平面的端口优先使用本参数配置的网络Qos策略。这些网络Qos策略后续需要在VNF SDN Network Setting（SDN组网架构）和VNF Network Setting（非SDN组网架构）页签中被使用。|本参数配置的网络Qos策略的优先级最高。
cpu_model参数|OMU虚机|对应flavor中的hw:cpu_model参数。不同种类的虚机可以根据实际部署时使用的计算节点CPU类型进行配置。|中国移动场景：配置该参数之前，需要在TECS OpenStack控制节点上，通过命令查询虚机部署使用的计算节点的cpu信息，示例：sourcekeystonerc_admin nova hypervisor-show Computer0102 |grep  cpu_info_modelHaswell如果非中国移动的其他运营商没有特殊要求，本参数默认为空。
mem_page_size参数|OMU虚机|该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。取值范围为large、any、small/4/4KB、2048/2048KB/2MB、1048576/1GB中的任何一个。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：只使用巨页，目前主机支持的巨页只有1G和2M两种，即只从这两种页面选择。small/4/4KB：三者含义一致，配置为其中任何一个值时都只使用小页，即只选择4KB大小的页面。2048/2048KB/2MB：三者含义一致，配置为其中任何一个值时都是只选择2MB的页面。1048576/1GB：二者含义一致，配置为其中任何一个值时都是只选择1GB的页面。|国内运营商场景：固定配置为large。
numa_nodes参数|OMU虚机|该参数建议采用默认值。在使用SR-IOV网卡部署虚机的场景才涉及到该参数的配置。hw:numa_nodes是用于指定虚机使用的NUMA节点数。hw:numa_nodes的取值表示不大于计算节点的NUMA节点个数的整数，通常取值为1和2。hw:numa_nodes取值为1：表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。|-
是否启用TECS私有参数|OMU虚机|本参数的适用场景：使用中兴通讯自研的VIM平台TECS OpenStack。disable：虚机只部署在某个numa上enable：虚机可部署在任意numa上|国内运营商场景：固定配置为disable。
capabilities:flows参数|OMU虚机|本参数用于配置虚机对流表资源的要求。本参数的适用场景：采用SDN组网架构，需要将流表资源需求较高的虚机，部署到合适的服务器上。使用中兴通讯自研的VIM平台TECS OpenStack，且TECS OpenStack对应的版本号为3.17.15.P10及以上版本，如果低于此版本，配置此参数会导致实例化失败。|如果不启用此功能，则此参数配置为空。如果需要启用此功能，则需要联系中兴通讯技术支持工程师获取配置值。
其他虚机的配置数据参见OMU虚机|其他虚机的配置数据参见OMU虚机|其他虚机的配置数据参见OMU虚机|其他虚机的配置数据参见OMU虚机
OAM接入EMS的NAT IP地址|根据ZXUN uMAC的管理接口与EMS对接时的实际情况进行配置：如果两者之间需要通过防火墙，则此参数配置为管理接口的IP地址经过NAT转换后的地址。如果两者之间不需要通过防火墙，则此参数无需配置。|OAM接入EMS的NAT IP地址|-
##### VNF UDSFCfg Setting 
配置原则 :VNF UDSFCfg Setting页签用于配置ZXUN uMAC的数据备份参数，必须配置。
配置说明 :当ZXUN uMAC没有开启全量备份功能时，VNF UDSFCfg Setting页签如[图1]所示。
图1  VNF UDSFCfg Setting（没有开启全量备份）

主要参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
Tenant Count|本参数用于配置租户的个数。|配置原则如下：使用默认值1，表示ZXUN uMAC没有开启全量备份功能。ZXUN uMAC的数据备份方式采用全量备份时，该参数需要设置为2，表示需要两个租户。当VNF UDSFCfg Setting页面中的参数Tenant Count配置为2时，VM Parameters页面中的CDU虚机的VM Count参数需要配置为3，参见”VM Parameters“
Tenant Name|本参数用于配置租户的名称。|配置原则如下：ZXUN uMAC部署为AMF时，必须和SET AMFLOCALOFFICECFG命令中配置的参数AMF名称一致。ZXUN uMAC部署MME/SGSN，没有特殊要求，可以使用默认名称。
MasterNfId|本参数用于配置主用租户的局号。|两个ID不能相同，取值范围：1~255。
SlaveNfId|本参数用于配置备用租户的局号。|两个ID不能相同，取值范围：1~255。
其他参数使用默认值。|其他参数使用默认值。|其他参数使用默认值。
在ZXUN uMAC在开启全量备份的情况下，网络中需要配置两个租户，即本AMF和接管AMF，本AMF和接管AMF互为备份：
租户的名称和ID是通过VNF UDSFCfg Setting页签配置的。 
这两个租户，哪一个租户为主用租户，哪一个租户为备用租户，是通过VNF Scenario页签的参数Master Tenant ID配置的。Master Tenant ID配置为2，表示租户2为主用。Master Tenant ID配置为1，表示租户1为主用。 
本AMF（本文档示例名称为AMF-145）的VNF UDSFCfg Setting页签如[图2]所示。
图2  本AMF


接管AMF（本文档示例名称为AMF-146）的VNF UDSFCfg Setting页签如[图3]所示。
图3  接管AMF

##### VNF Resourse Naming Rules 
配置原则 :VNF Resourse Naming Rules用于配置ZXUN uMAC使用的虚拟资源的规范，需要根据各个运营商的实际情况进行配置。
配置说明 :VNF Resourse Naming Rules页签如[图1]所示。
图1  VNF Resourse Naming Rules

##### Heat Scripts（可选） 
配置原则 :Heat Scripts配置为ZXUN uMAC规划的网络平面相关信息。此处配置的数据，后续通过AIC(iDeploy)工具中的Heat Script脚本来自动创建实例化ZXUN uMAC时所需要的虚拟资源。
 说明： 
当Global Setting页签中的Support Heat Script配置为Yes时，操作员才需要配置此页签。
配置说明 :Heat Scripts页签如[图1]所示。
图1  Heat Scripts

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
-|OSP_Version|本参数配置为OSP版本的名称，osp13是queens，osp16是train。表示ZXUN uMAC需要部署的VIM云平台为OpenStack Platform ，OSP是OpenStack Platform开源项目的服务。|根据规划进行配置。
Tenant_Name|-|本参数配置为VNF对应的租户。|此单元格的值是由Tenant & Users页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
flavor|Flavor_Script_description|本参数用于描述flavor脚本的信息，如版本和用途。|-
Tenant_Owner|flavor|-|-
sriov_host_aggr_default|flavor|本参数用于配置主机集合名称。|此单元格的值是由Host Aggregate页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
VM_Name_Prefix|flavor|本参数用于配置flavor名称前缀。|本参数的取值来源于Global Setting页签中的Resource Prefix参数值 ，参见“Global Setting”，需要操作员确认是否正确即可，此处自动引用，无需修改。
VNF_name|flavor|本参数用于配置VNF名称。|此单元格的值是由VNF ID页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
Ephemeral|flavor|本参数用于配置数据盘大小。如果是本地盘，根据规格填写。如果使用云存储，该值为0。|-
Disk|flavor|本参数用于配置系统盘大小。如果是本地盘，根据规格填写。如果使用云存储，该值为0。|-
Flavor_resource_is_public|flavor|本参数用于标识flavor是公有或私有。对于非admin，私有意味着只有特定租户可以看到并使用该flavor。|-
Numa_nodes|flavor|本参数是用于指定虚机使用的NUMA节点数。本参数取值表示不大于计算节点的NUMA节点个数的整数，通常取值为1和2。取值为1：虚机不可跨NUMA部署，表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：虚机可跨NUMA部署，表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。|根据本文档规划的场景，该参数需要配置为1。
CPU_Policy|flavor|本参数用于配置，CPU是否要求绑核。|-
Mmem_page_size|flavor|该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。取值范围为large、any、small/4/4KB、2048/2048KB/2MB、1048576/1GB中的任何一个。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：只使用巨页，目前主机支持的巨页只有1G和2M两种，即只从这两种页面选择。small/4/4KB：三者含义一致，配置为其中任何一个值时都只使用小页，即只选择4KB大小的页面。2048/2048KB/2MB：三者含义一致，配置为其中任何一个值时都是只选择2MB的页面。1048576/1GB：二者含义一致，配置为其中任何一个值时都是只选择1GB的页面。|当VIM使用RedHat平台时，根据本文档规划的场景，该参数需要配置为large。
networks|Networks_Script_description|本参数用于描述networks脚本的信息，如版本和用途。|-
Tenant_Uid|networks|租户ID。|-
Availability Zone|networks|本参数用于配置可用域名称。|此单元格的值是由Host Aggregate页签设置后，在本单元格自动引用生成的，需要操作员确认是否正确即可，此处自动引用，无需修改。
Standard_Physnet|networks|basic physical network name，用于除flat平面外的网络平面|-
Sriov_Physnet_Oiaasnet1|networks|sriov physical name oiaas-net1 (left domain)，用于左域的flat平面|-
Sriov_Physnet_Oiaasnet2|networks|sriov physical name oiaas-net2 (right domain)，用于右域的flat平面|-
Network|NetworkName|该参数用于设置网络平面的名称。|根据规划进行配置。
admin_stateup|Network|-|配置为True。
PortSecurityEnable|Network|本参数用于配置是否启用端口安全组。|配置为false。
Shared|Network|本参数用于表示此网络平面属性是否为共享网络。本参数的配置原则如下：在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。|本文档规划的部署场景为非SDN组网，本参数配置为shared（共享）类型。
NetworkType|Network|本参数用于设置ZXUN uMAC需要部署的VIM云平台的网络类型。SDN组网场景时，该参数需要设置为VxLAN。非SDN组网场景时，该参数需要设置为VLAN。|根据本文档规划的场景，本参数配置为VLAN。
MTU|Network|该参数表示VNF的MTU数值。|在运营商没有特殊要求的情况下，内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。如果运营商对MTU有特殊要求，需要根据运营商的规范进行设置。
SegmentationId|Network|-|根据规划进行配置。
Subnet_Name|Network|该参数用于设置网络平面的子网名称。|根据规划进行配置。
IPVersion|Network|-|根据规划进行配置。
EnableDHCP|Network|该参数用于设置是否启用DHCP功能。开启DHCP功能后，在VIM云平台创建虚机时，会自动为虚机分配此网络平面的IP地址。|需要根据实际情况决定是否开启此功能。
CIDR|Network|本参数用于配置子网的网关IP地址。|根据规划进行配置。
Gateway IP|Network|本参数用于配置子网的掩码。|根据规划进行配置。
##### Version File 
配置原则 :Version File页签用于配置ZXUN uMAC的版本文件名称。
 说明： 
操作员需要根据实际环境中获取的软件版本名称，和表格中FileName核对，确认版本号正确即可。
配置说明 :Version File页签如[图1]所示。
图1  Version File

参数说明参见[表1]。
参数名称|参数解释|配置指引
---|---|---
FileName|版本包的名称。|需要与实际文件名保持一致。
##### Image Setting 
配置原则 :Image Setting页签用于配置在实例化ZXUN uMAC过程中，是否使用镜像包名称自动修改功能。
 说明： 
此处的镜像包是指创建虚机时使用的CGSL操作系统镜像文件包（通常以cgsl.vXXX.zip的形式命名，包含操作系统和双机软件）。 
本参数需要根据运营商的情况进行配置。 
国内运营商场景（如中国移动），需要根据运营商的命名规范来修改镜像包的名称，本页签需要配置为YES，后续是通过“修改镜像文件名称”操作进行配置的。 说明：“修改镜像文件名称”操作必须在实例化操作前执行。 
如果运营商对镜像包名称没有特殊要求，操作员可以使用默认值 ，则本页签需要配置为NO。 
配置说明 :Image Setting页签如[图1]所示。
图1  Image Setting

##### VNF SFTP Server 
配置原则 :VNF SFTP Server页签用于在实例化ZXUN uMAC的过程中，需要通过FTP方式将需要的各类软件包上传至NFVO服务器指定路径下。
 说明： 
本页参数无需修改。 
配置说明 :VNF SFTP Server页签如[图1]所示。
图1  VNF SFTP Server

参数说明参见[表1]。
参数名称|参数说明|配置指引
---|---|---
SFTP server IPv4/IPv6 address|本参数用于设置上传、导入版本包时使用的SFTP服务器IP地址。此处需要配置可以和NFVO的网管平面互通的IP地址。存放在SFTP服务器的软件，需要通过FTP方式上传至NFVO服务器的指定路径下，所以SFTP服务器的地址，是需要与NFVO的网管网络平面互通的地址。|本页参数无需修改。
SFTP username|本参数用于设置访问SFTP服务器的用户名。默认用户名为root。|本页参数无需修改。
SFTP password|本参数用于设置访问SFTP服务器的密码。默认的密码为CloudStudio__123，其中__为两个下划线。|本页参数无需修改。
Path|本参数用于设置FTP服务器上存放ZXUN uMAC的基础包路径，此处需要设置为绝对路径。可设置为基础包的具体文件所在路径或上一级目录。设置为目录时，可上传该目录下的所有软件包。此路径需要开通可写权限，此路径在部署ZXUN uMAC前需要已经存在。|本页参数无需修改。
Delete version packages after successful deployment|本参数用于配置ZXUN uMAC部署成功后，是否自动删除SFTP服务器上的版本包。YES：删除如果临时使用VNFM为SFTP服务器，建议删除。NO：不删除如果后续还会部署相同版本的ZXUN uMAC时，建议不需要删除，后续操作可以继续使用当前已经上传的版本包。|本页参数无需修改。
##### TAP Service和TAP Flow（可选） 
配置原则 :TAP Service和TAP Flow页签用于配置流镜像相关的数据。
在运营商开启了流镜像功能的场景下，才需要配置，如果运营商没有开启流镜像功能，则操作员需要将这两个页签中默认的数据全部删除。 
 说明： 
TAP Service和TAP Flow页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
配置说明 :流镜像是VIM云平台（本文档指中兴通讯的TECS OpenStack）中的neutron组件实现的一种网络端口镜像的功能，可以对网络流量进行监控，在网络出现问题时，维护人员通过流镜像可以快速发现和定位故障。 
配置流镜像，是指把某个虚机（源虚机）的报文复制到其他虚机（目的虚机）的网卡或者物理交换机端口。 
TAP Service页签如[图1]所示。
图1  TAP Service

TAP Flow页签如[图2]所示。
图2  TAP Flow

参数说明参见[表1]。
参数名称|参数说明
---|---
TAP Service Name|本参数用于配置目的虚机网卡和物理交换机端口，即抓包端口。
TAP Flow Name|本参数用于配置源虚机的端口，即需要镜像报文的端口。可以指定镜像的报文方向和使用的流镜像过滤器。
#### 导出LLD 
VNF LLD Template AMF.xlsm中的所有的页签配置完成后，切换到Run页签，如[图1]所示。
图1  Run页签

单击生成VNF规则数据，弹出提示框，如[图2]所示。
图2  提示框

单击是，开始自动生成VNF规划数据，如[图3]所示。
图3  提示框

单击确定按钮，回到ZXUN-uMAC AIC (iDevise)
Plugin Edition.xlsm页面，如[图4]所示。
图4  ZXUN-uMAC AIC (iDevise) Plugin Edition.xlsm页面

单击右上方的Next按钮旁边Output LLD，如[图5]所示。
图5  Output LLD页签

单击下方的Output按钮，系统输出最终的LLD文件，在ZXUN-uMAC AIC (iDevise) Plugin Edition.xlsm文件同级目录下会生成最终的LLD，名字为ZTE
NFV LLD(AMF) New Project.xlsx，此文件即为iDeploy部署时所要使用的最终LLD文件，如[图6]所示。
图6  ZTE NFV LLD(AMF) New Project.xlsx

#### 部署VNF 
概述 :本节介绍通过AIC自动部署工具AIC(iDeploy)V3.21.10.10部署ZXUN uMAC的过程，iDeploy自动完成ZXUN uMAC所需虚拟资源的创建和业务程序的自动部署。
前提 :在执行安装前，操作员需要已经从中兴通讯技术支持人员处获取了所有的软件安装信息，包括对应版本号等内容。 
操作员需要获取几种类型的软件安装包，根据获取方式的不同，分为两大类： 
从AIC工具处获取软件包。详细内容参见表1。表1  从AIC工具处获取的版本文件类型名称功能描述AIC工具中的iDeployAIC(iDeploy)V3.22.07通过导入部署所需的LLD文件和版本文件，实现端到端自动化部署ZXUN uMAC。此软件包从AIC工具处获取。 说明：采用AIC工具部署，需要检查工具的License是否过期，如果已过期或快过期，需要提前申请新的License。 
从ZXUN uMAC版本发布包中获取的软件包。详细内容参见表2。表2  从ZXUN uMAC版本发布包中获取的版本文件类型名称功能描述AIC工具中的ZXUN-uMAC-V7.21.31 AIC (iDevise).zip通过此工具来进行数据规划设计，直接输出最终部署ZXUN uMAC所需的LLD。此软件包从ZXUN uMAC版本发布包中获取。镜像包操作系统镜像包uMAC_image_cgsl_F16P6_20210701.zip是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。安全网关功能镜像包ZXUN_LIG_IMG_V4.15.10.P21.zip在ZXUN uMAC需要和安全网关功能同时部署时，需要此类镜像包。基础包ZXUN-uMAC V7.18.14_vnfd.csar基础包也称插件包，包含了虚机部署info.xml文件、业务部署nfservice.json文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。业务包ZXUN-uMAC V7.18.14_version.zip提供ZXUN uMAC的业务功能。AIC插件包aic-plugin-uMAC-V7.21.31.zipAIC工具适配ZXUN uMAC的插件。 
 说明： 
各个软件的版本号以实际安装部署中获取的版本号为准，本文档仅为示例。 
步骤 :在AIC(iDeploy)V3.21.10.09的iDeploy目录下，选择iDeploy应用程序，如[图1]所示。
图1  iDeploy应用程序

首次打开iDeploy时，由于没有导入LLD，所以会出现如[图2]所示的页面。
图2  iDeploy页面

单击选择文件，选择“[导出LLD]”
操作中导出的LLD（ZTE NFV LLD(AMF) New Project.xlsx），如[图3]所示。
图3  选择LLD文件

导入LLD后，如[图4]所示。
图4  导入LLD

自动跳转至DC概览页面，如[图5]，该页面会显示LLD中设计的相关组件的概览信息，此处无需操作，仅用于浏览概要信息。
图5  DC概览页面

切换到版本导入页面，iDeploy工具下没有对应的版本文件，状态列显示红叉表示iDeploy工具下对应的版本文件缺失，需要操作员手工导入。
 说明： 
操作员手工导入的各个版本文件名称和后缀，都需要和版本导入页面中的文件名称相同，否则iDeploy工具会识别不到文件。
可以选中一个领域下的所有版本文件对应的选项框，单击批量导入按钮，选择对应的版本文件目录，工具会自动扫描所选目录下的所有文件自动匹配导入。
图6  本地存放的所有版本文件

在右侧的选择导入列，单击文件对应行的按钮，进行单个文件导入，导入成功后，对应文件的状态会变成绿勾状，导入成功后，检查每个文件的状态是否正常。
导入ZXUN uMAC所有的版本文件，结果如[图7]所示。
图7  所有版本文件导入成功页面

（可选）修改镜像包名称，镜像包是指创建虚机时使用的CGSL操作系统镜像文件包（通常以cgsl.vXXX.zip的形式命名，包含操作系统和双机软件）。 
如果...|那么...
---|---
运营商对镜像包名称有固定的规范（通常为国内运营商）|由于运营商对镜像包名称有固定的规范，在部署之前，需要通过“修改镜像文件名称”操作根据运营商的命名规范来修改镜像包的名称。“修改镜像文件名称”操作必须在步骤10前执行。
如果运营商对镜像包名称没有特殊要求|此步骤可以跳过，不执行，直接执行步骤10。
所有版本文件导入成功后，切换到部署页面，勾选需要部署的对象，单击开始，iDeploy工具开始自动部署ZXUN uMAC，正常情况下部署过程无需人工干预，如[图8]所示。
图8  
开始自动部署

 说明： 
请耐心等待大约40分钟，自动部署完成。 
默认情况下，系统没有勾选了AMF静态路由配置和AMF相关VPC配置这两个选项。
如果操作员勾选AMF静态路由配置，表示系统会根据VNF
Static Route页签中的配置数据（参见“VNF Static Route”）进行自动部署。 
如果操作员勾选AMF相关VPC配置，表示系统会根据VPC页签中的配置数据（参见“VPC（可选）”）进行自动部署。 
 说明： 
通常情况下，静态路由和VPC数据可以在ZXUN uMAC实例化成功后，由操作员手动进行配置，此处不需要勾选。
#### 查询虚机的子接口地址和VLAN 
摘要 :ZXUN uMAC实例化成功后，VIM云平台（本文档示例为TECS OpenStack）会为各个虚机分配子接口的IP地址和VLAN。
在配置业务数据之前，需要在ROSNG平台上，配置IPU虚机的子接口地址和VLAN。 
在SDN组网场景中，ROSNG平台上配置IPU虚机的子接口地址和VLAN从是MANO上查询获取的，本节介绍如何在MANO中查询相关数据。 
步骤 :在MANO客户端，进入MANO的VNF列表页面，找到ZXUN uMAC，单击Trunk管理。
查看IPU虚机的信息，包括子接口和VLAN信息。 
根据查询获取的子端口列表，配置ROSNG信息。 
 说明： 
MANO上查询的顺序不一定是按照VLAN的顺序显示，配置ROSNG时，VLAN子接口的顺序建议按照规划的网络平面顺序进行配置，便于后续排查问题。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开SMF节点。
选择菜单微服务治理→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip-address network-segment conflict-check] disable命令，关闭同网段冲突检测功能，即开启共子网配置全局开关。
执行[interface] xgei-命令，进入接口配置模式。
执行no [shutdown]命令，开启物理端口。
 说明： 
初始状态下，端口都处于关闭状态，必须开启后才能通信。 
执行[exit]命令，退出当前配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[ip vrf forwarding]命令，将物理接口与对应的VRF绑定。
执行[ip address]命令，配置接口的IPv4地址。
执行[ipv6 enable]命令，配置支持IPv6。
执行[ipv6 address]命令，配置接口的IPv6地址。
执行no [shutdown]命令，开启物理端口。
执行[logging link-status] enable命令，配置在子接口异常时会生成告警。
执行[exit]命令，退出当前配置模式。
执行[arp]命令，进入ARP配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[source-filtered] disable命令，关闭ARP源过滤。
执行[exit]命令，退出子接口配置模式。
执行[exit]命令，退出ARP配置模式。
执行[vlan-configuration]命令，进入VLAN配置模式。
执行[interface] xgei-命令，进入VLAN子接口配置模式。
执行[encapsulation-dot1q]命令，配置子接口支持的VLAN ID。该VLAN ID需与交换机上规划配置的VLAN ID一致。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
配置完成后，可以使用[show ip interface  brief]，查看配置结果是否正确，结果如下所示。
`ZXROSNGshow ip interface  brief 
Interface                       IP-Address      Mask            Admin Phy  Prot 
xgei-1/0/1/1                    unassigned      unassigned      up    up   up
xgei-1/0/1/1.1                  179.21.2.2      255.255.255.248 up    up   up
xgei-1/0/1/1.2                  179.21.3.2      255.255.255.248 up    up   up
xgei-1/0/1/1.3                  179.21.4.2      255.255.255.248 up    up   up
xgei-1/0/1/1.4                  179.21.5.2      255.255.255.248 up    up   up
xgei-1/0/1/1.5                  179.21.12.2     255.255.255.248 up    up   up
xgei-1/0/1/1.6                  179.21.6.2      255.255.255.248 up    up   up
xgei-1/0/1/1.7                  179.21.7.2      255.255.255.248 up    up   up
xgei-1/0/1/1.8                  179.21.8.2      255.255.255.248 up    up   up
xgei-1/0/1/1.9                  179.21.9.2      255.255.255.248 up    up   up
xgei-1/0/2/1                    unassigned      unassigned      up    up   up
xgei-1/0/2/1.1                  179.21.2.3      255.255.255.248 up    up   up
xgei-1/0/2/1.2                  179.21.3.3      255.255.255.248 up    up   up
xgei-1/0/2/1.3                  179.21.4.3      255.255.255.248 up    up   up
xgei-1/0/2/1.4                  179.21.5.3      255.255.255.248 up    up   up
xgei-1/0/2/1.5                  179.21.12.3     255.255.255.248 up    up   up
xgei-1/0/2/1.6                  179.21.6.3      255.255.255.248 up    up   up
xgei-1/0/2/1.7                  179.21.7.3      255.255.255.248 up    up   up
xgei-1/0/2/1.8                  179.21.8.3      255.255.255.248 up    up   up
xgei-1/0/2/1.9                  179.21.9.3      255.255.255.248 up    up   up
loopback1                       182.21.21.60    255.255.255.255 up    up   up
loopback2                       182.21.21.61    255.255.255.255 up    up   up
loopback3                       180.21.21.3     255.255.255.255 up    up   up
loopback4                       180.21.21.2     255.255.255.255 up    up   up
loopback5                       180.21.21.3     255.255.255.255 up    up   up
loopback6                       180.21.21.2     255.255.255.255 up    up   up
loopback7                       180.21.21.22    255.255.255.255 up    up   up

ZXROSNGshow running-config

!<mim>
!configuration has not been saved since system starting
!configuration was loaded by txt that saved at 09:35:07 Fri Apr 24 2020
commit-mode default automatic
!</mim>

!<vrf>
ip vrf GN_VRF vpnid 1
  rd 1:1
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf SX_VRF vpnid 2
  rd 2:2
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf OM_VRF vpnid 3
  rd 3:3
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf CN_VRF vpnid 4
  rd 4:4
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf GI_SCG_VRF vpnid 5
  rd 5:5
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf GITB_SCG_VRF vpnid 6
  rd 6:6
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf TLGI_VRF vpnid 10
  rd 10:10
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf TLGITB_VRF vpnid 7
  rd 7:7
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf LIG_VRF vpnid 8
  rd 8:8
  address-family ipv4
  $
  address-family ipv6
  $
$
ip vrf EAGY_VRF vpnid 9
  rd 9:9
  address-family ipv4
  $
  address-family ipv6
  $
$
!</vrf>
!<if-intf>
ip-address network-segment conflict-check disable
interface xgei-1/0/1/1
  no shutdown
  interface mac-address fa16.3e14.a5dc
$
interface xgei-1/0/1/1.1
  ip vrf forwarding GN_VRF
  ip address 179.21.2.2 255.255.255.248
$
interface xgei-1/0/1/1.2
  ip vrf forwarding CN_VRF
  ip address 179.21.3.2 255.255.255.248
$
interface xgei-1/0/1/1.3
  ip vrf forwarding OM_VRF
  ip address 179.21.4.2 255.255.255.248
$
interface xgei-1/0/1/1.4
  ip vrf forwarding LIG_VRF
  ip address 179.21.5.2 255.255.255.248
$
interface xgei-1/0/1/1.5
  ip vrf forwarding SX_VRF
  ip address 179.21.12.2 255.255.255.248
$
interface xgei-1/0/1/1.6
  ip vrf forwarding GI_SCG_VRF
  ip address 179.21.6.2 255.255.255.248
$
interface xgei-1/0/1/1.7
  ip vrf forwarding GITB_SCG_VRF
  ip address 179.21.7.2 255.255.255.248
$
interface xgei-1/0/1/1.8
  ip vrf forwarding TLGI_VRF
  ip address 179.21.8.2 255.255.255.248
$
interface xgei-1/0/1/1.9
  ip vrf forwarding TLGITB_VRF
  ip address 179.21.9.2 255.255.255.248
$
interface xgei-1/0/2/1
  no shutdown
  interface mac-address fa16.3e41.c2d7
$
interface xgei-1/0/2/1.1
  ip vrf forwarding GN_VRF
  ip address 179.21.2.3 255.255.255.248
$
interface xgei-1/0/2/1.2
  ip vrf forwarding CN_VRF
  ip address 179.21.3.3 255.255.255.248
$
interface xgei-1/0/2/1.3
  ip vrf forwarding OM_VRF
  ip address 179.21.4.3 255.255.255.248
$
interface xgei-1/0/2/1.4
  ip vrf forwarding LIG_VRF
  ip address 179.21.5.3 255.255.255.248
$
interface xgei-1/0/2/1.5
  ip vrf forwarding SX_VRF
  ip address 179.21.12.3 255.255.255.248
$
interface xgei-1/0/2/1.6
  ip vrf forwarding GI_SCG_VRF
  ip address 179.21.6.3 255.255.255.248
$
interface xgei-1/0/2/1.7
  ip vrf forwarding GITB_SCG_VRF
  ip address 179.21.7.3 255.255.255.248
$
interface xgei-1/0/2/1.8
  ip vrf forwarding TLGI_VRF
  ip address 179.21.8.3 255.255.255.248
$
interface xgei-1/0/2/1.9
  ip vrf forwarding TLGITB_VRF
  ip address 179.21.9.3 255.255.255.248
$
interface xgei-1/0/3/1
  off-line
  no shutdown
  interface mac-address fa16.3ea5.2f21
$
interface loopback1
  ip vrf forwarding GN_VRF
  ip address 182.21.21.60 255.255.255.255
$
interface loopback2
  ip vrf forwarding SX_VRF
  ip address 182.21.21.61 255.255.255.255
$
interface loopback3
  ip vrf forwarding OM_VRF
  ip address 180.21.21.3 255.255.255.255
  ip address 180.21.21.4 255.255.255.255 secondary
  ip address 180.21.21.5 255.255.255.255 secondary
  ip address 180.21.21.20 255.255.255.255 secondary
  ip address 180.21.21.21 255.255.255.255 secondary
  ip address 180.21.21.14 255.255.255.255 secondary
  ip address 180.21.21.15 255.255.255.255 secondary
$
interface loopback4
  description wyg-test
  ip vrf forwarding GN_VRF
  ip address 180.21.21.2 255.255.255.255
$
interface loopback5
  ip vrf forwarding GN_VRF
  ip address 180.21.21.3 255.255.255.255
  ip address 180.21.21.4 255.255.255.255 secondary
  ip address 180.21.21.5 255.255.255.255 secondary
  ip address 180.21.21.20 255.255.255.255 secondary
  ip address 180.21.21.21 255.255.255.255 secondary
$
interface loopback6
  ip vrf forwarding SX_VRF
  ip address 180.21.21.2 255.255.255.255
$
interface loopback7
  ip vrf forwarding GI_SCG_VRF
  ip address 180.21.21.22 255.255.255.255
$
interface null1
$
!</if-intf>
!<vlan>
vlan-configuration
  interface xgei-1/0/1/1.1
    encapsulation-dot1q 3010
  $
  interface xgei-1/0/1/1.2
    encapsulation-dot1q 3011
  $
  interface xgei-1/0/1/1.3
    encapsulation-dot1q 3012
  $
  interface xgei-1/0/1/1.4
    encapsulation-dot1q 3013
  $
  interface xgei-1/0/1/1.5
    encapsulation-dot1q 3014
  $
  interface xgei-1/0/1/1.6
    encapsulation-dot1q 3015
  $
  interface xgei-1/0/1/1.7
    encapsulation-dot1q 3016
  $
  interface xgei-1/0/1/1.8
    encapsulation-dot1q 3017
  $
  interface xgei-1/0/1/1.9
    encapsulation-dot1q 3018
  $
  interface xgei-1/0/2/1.1
    encapsulation-dot1q 3010
  $
  interface xgei-1/0/2/1.2
    encapsulation-dot1q 3011
  $
  interface xgei-1/0/2/1.3
    encapsulation-dot1q 3012
  $
  interface xgei-1/0/2/1.4
    encapsulation-dot1q 3013
  $
  interface xgei-1/0/2/1.5
    encapsulation-dot1q 3014
  $
  interface xgei-1/0/2/1.6
    encapsulation-dot1q 3015
  $
  interface xgei-1/0/2/1.7
    encapsulation-dot1q 3016
  $
  interface xgei-1/0/2/1.8
    encapsulation-dot1q 3017
  $
  interface xgei-1/0/2/1.9
    encapsulation-dot1q 3018
  $
$
!</vlan>
!<arp>
arp
  interface xgei-1/0/1/1.1
    source-filtered disable
  $
  interface xgei-1/0/1/1.2
    source-filtered disable
  $
  interface xgei-1/0/1/1.3
    source-filtered disable
  $
  interface xgei-1/0/1/1.4
    source-filtered disable
  $
  interface xgei-1/0/1/1.5
    source-filtered disable
  $
  interface xgei-1/0/1/1.6
    source-filtered disable
  $
  interface xgei-1/0/1/1.7
    source-filtered disable
  $
  interface xgei-1/0/1/1.8
    source-filtered disable
  $
  interface xgei-1/0/1/1.9
    source-filtered disable
  $
  interface xgei-1/0/2/1.1
    source-filtered disable
  $
  interface xgei-1/0/2/1.2
    source-filtered disable
  $
  interface xgei-1/0/2/1.3
    source-filtered disable
  $
  interface xgei-1/0/2/1.4
    source-filtered disable
  $
  interface xgei-1/0/2/1.5
    source-filtered disable
  $
  interface xgei-1/0/2/1.6
    source-filtered disable
  $
  interface xgei-1/0/2/1.7
    source-filtered disable
  $
  interface xgei-1/0/2/1.8
    source-filtered disable
  $
  interface xgei-1/0/2/1.9
    source-filtered disable
  $
$
!</arp>` 
### FAQ 
#### 修改镜像文件名称 
概述 :操作员在执行实例化ZXUN uMAC前，需要事先获取ZXUN uMAC的版本包，版本包分为三类。
镜像包 
基础包 
业务软件包 
其中镜像包有两种类型。 
操作系统镜像包是创建ZXUN uMAC的虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。 
LIG镜像包ZXUN uMAC和LIG功能同时部署时，需要此类镜像包。 
操作员从中兴通讯获取的镜像包的默认的名称格式参见[表1]。
类型|包名
---|---
所有NF|cgsl.vXXX.zip
LIG|ZXUN LIG_VXXX
XXX代表对应VIM云平台管理系统（如ZTE TECS OpenStack）和ZXUN LIG的版本号，以实际版本为准。 
##### 适用场景 
在实际部署的如下两种场景中，涉及到修改镜像包名称的操作。 
修改ZXUN CloudStudio上显示的镜像包名称。上传到ZXUN CloudStudio上的镜像包，用于操作员在ZXUN CloudStudio上快速实例化ZXUN uMAC时使用，如果需要在一个ZXUN CloudStudio上部署多个ZXUN uMAC，则需要上传多个镜像包，由于每次上传的ZXUN uMAC镜像包的名称是相同的，如果不修改之前上传的镜像包名称，会导致每次上传镜像包时，都会覆盖原来上传的相同名称的镜像包。 
修改VIM（本文档指中兴通讯的TECS OpenStack）上显示的镜像包名称。某些运营商对镜像包名称有严格的规定，操作员必须在实例化之前，根据运营商的要求修改镜像包的名称。 
##### 国内运营商对镜像包的命令规范 
ZXUN uMAC应用于商用局点时，国内运营商对镜像包的命令规范参见[表2]和[表3]。
参数|取值说明
---|---
VIM云平台（如中兴通讯的TECS OpenStack）镜像包注册名称|格式：{resNamePrefix前缀}-MIR-{自定义部分}自定义部分包括如下两类ZXUN uMAC的操作系统镜像包格式：{neResPrefix网元前缀}-CGSL-{CGSL版本号}.img示例：NFV-R-HDBNJ-03A-ZX-01-MIR-ahAMF1BZX-CGSL.V5.04.F16P4.imgLIG镜像包格式：{neResPrefix网元前缀}-ZXUN-LIG-{CGSL版本号}.img示例：NFV-R-HDBNJ-03A-ZX-01-MIR-ahAMF1BZX-ZXUN-LIG-V4.15.10.P16.imgresNamePrefix前缀参见工程LLD文档VNF信息页签的VIM资源前缀/VIM Resource Prefix。
参数|取值说明
---|---
云平台镜像注册名称|格式：{resNamePrefix前缀}-MIR-{自定义部分}自定义部分包括两类。业务镜像：CGSL-{CGSL版本号}.imgLIG镜像：ZXUN-LIG-{CGSL版本号}.img中国联通规定的镜像包名称示例：GD_GX_NN_AMF800_C_ZX-MIR-CGSL-V5.04.F16P2.imgNGD_GX_NN_AMF800_C_ZX-MIR-ZXUN-LIG-P15.img中国电信规定的镜像包名称示例：GD-GZ-ZSC-RP0001B-A-5GC-ZE-AMF01-B-MIR-CGSL-V5.04.F16P4.imgGD-GZ-ZSC-RP0001B-A-5GC-ZE-AMF01-B-MIR-ZXUN-LIG-P16.imgresNamePrefix前缀参见工程LLD文档VNF信息页签的VIM资源前缀/VIM Resource Prefix。
运营商（如中国移动、中国电信、中国联通）要求实现镜像看门狗功能，需要修改resourceList.json文件，增加看门狗属性。 
##### 修改方式 
某些运营商对镜像包名称有严格的规定，操作员必须在实例化之前，根据运营商的要求修改镜像包的名称。 
本节介绍两种修改镜像包名称的方式。 
操作员在ZXUN CloudStudio上修改，参见操作员在ZXUN CloudStudio上修改。 
操作员通过命令的方式修改，参见操作员通过命令方式修改。 
 说明： 
建议使用第一种修改方式，即操作员在ZXUN CloudStudio上修改。 
##### 操作员在ZXUN CloudStudio上修改 
###### 操作前提 
操作员已经登录ZXUN CloudStudio的NFVO客户端。 
操作员已经将镜像文件包cgsl.vXXX.zip成功导入到ZXUN CloudStudio中。 
###### 适用场景 
在实际部署的如下两种场景中，涉及到修改镜像包名称的操作。 
修改ZXUN CloudStudio上显示的镜像包名称。上传到ZXUN CloudStudio上的镜像包，用于操作员在ZXUN CloudStudio上快速实例化ZXUN uMAC时使用，如果需要在一个ZXUN CloudStudio上部署多个ZXUN uMAC，则需要上传多个镜像包，由于每次上传的ZXUN uMAC镜像包的名称是相同的，如果不修改之前上传的镜像包名称，会导致每次上传镜像包时，都会覆盖原来上传的相同名称的镜像包。 
修改VIM（本文档指中兴通讯的TECS OpenStack）上显示的镜像包名称。某些运营商对镜像包名称有严格的规定，操作员必须在实例化之前，根据运营商的要求修改镜像包的名称。 
###### 修改ZXUN CloudStudio上显示的镜像包名称 
在ZXUN CloudStudio客户端中，打开软件仓库，切换到虚机镜像页面，镜像包显示在虚机镜像页面中，对应的状态为未注册，是否注册显示为否，如[图1]所示。
图1  虚机镜像页面

单击操作栏中的更多按钮，在下拉列表中，选择设置，如[图2]所示。
图2  设置

出现镜像包信息对话框，如[图3]所示。
图3  镜像包信息对话框

 说明： 
镜像包信息对话框中的镜像包版本号和镜像包名称是在ZXUN CloudStudio上显示的镜像包名称，用于操作员在ZXUN CloudStudio上快速实例化ZXUN uMAC时使用。
###### 修改VIM上显示的镜像包名称 
在ZXUN CloudStudio客户端中，打开软件仓库，切换到虚机镜像页面，镜像包显示在虚机镜像页面中，对应的状态为未注册，是否注册显示为否，如[图4]所示。
图4  虚机镜像页面

单击操作栏中的更多按钮，在下拉列表中，选择设置，出现镜像包信息对话框，如[图5]所示。
图5  镜像文件信息区域框

在镜像包信息对话框下方的镜像文件信息区域框中，单击操作栏中的设置按钮，弹出设置镜像文件参数对话框，如[图6]所示。
图6  设置镜像文件参数对话框

 说明： 
设置镜像文件参数对话框中的镜像名称和File_url镜像文件名（两个参数需要修改为一致）是用于修改VIM（本文档指中兴通讯的TECS OpenStack）上显示的镜像包名称，即根据运营商的命名规范修改的名称。
某些运营商（如中国移动、中国电信、中国联通）要求实现镜像看门狗功能，还需要修改resourceList.json文件，增加看门狗属性，如[图7]所示。
图7  修改镜像扩展属性

##### 操作员通过命令方式修改 
获取ZXUN uMAC镜像改名脚本及相关上操作说明文档《ZXUN-CGSL-V7-脚本修改镜像名的使用方法.zip》，修改后结果参照如下。
图1  修改结果

修改LIG镜像名称 
有的运营商要求LIG同AMF/UPF一起部署，且也要求LIG镜像修改名称。 LIG镜像命名请参考运营商的命名规范。LIG镜像名修改方法参见《LIG融合镜像名修改工具2020032115》。LIG镜像名修改工具由LIG项目维护，有疑问请咨询LIG项目。 
#### 在MANO上启用通过本地方式上传版本包的方法 
概述 :只有网络质量良好的场景下才能使用本地上传，否则当版本包文件较大时（超过50M）有可能出现版本上传中断或者失败。 
操作步骤 :在NFVO客户端，进入系统配置。
选择编排配置，将文件上传方式配置”配置为本地上传，如[图1]所示。
图1  本地上传

无需重启，进入软件仓库，选择导入，在导入方式中出现了本地文件选项，如[图2]所示。
图2  本地文件

#### 在VNFM上创建的API用户的方法 
概述 :本节介绍采用Https+Token方式部署时，如何在VNFM上创建API用户。 
在部署时新增https认证功能，VNF需要向VNFM获取token，对于测试场景可以使用VNFM的默认用户名密码admin/Zenap_123，但是对于部分有安全考虑的场景，admin默认密码被修改等场景，需要新建用户，不能使用默认的admin用户。 
该操作建议请现场MANO维护人员进行操作，ZXUN uMAC开通人员向MANO维护人员获取到新增用户的用户名/密码即可。
操作步骤 :登录VNFM客户端，在VNFM上新建用户，进入账户规则页面，单击新建账户规则，如[图1]所示。
图1  新建账户规则

配置规则名称，去掉勾选首次登录时必须修改密码，密码最大有效期配置为0，如[图2]所示。
图2  新建帐户规则

帐号登录方式勾选WEB和API，如[图3]所示。
图3  帐号登录方式

单击新建按钮，如[图4]所示。
图4  新建

选择用户管理，单击新建用户，如[图5]所示。
图5  新建用户

在基本信息中，配置用户名、密码，将用户规则配置为之前创建好的API，设置为同时登录数限制为不限制，如[图6]所示。
图6  配置基本信息

单击下一步，进入权限分配页面，勾选全部角色，如[图7]所示。
图7  权限分配

单击新建，在VNFM上新建用户完成。
操作员使用新增的账户，登录VNFM，验证是否正常。 
#### VNFM tocken认证失败的问题处理 


##### 现象描述 
网元部署，在MANO上任务状态显示在55%：插件后扩展失败。 


##### 处理方法 
很可能是ZXUN uMAC向VNFM tocken认证失败，请检查配置的vnf向vnfm获取token的用户名是否正确，使用此用户名密码要能正常登录VNFM，参见“[在VNFM上创建的API用户的方法]”
。


#### 内部控制面地址规划错误导致实例化失败的问题处理 
##### 现象描述 
福建电信实例化失败，两个OMU的内部控制面互通不正常，OMU虚机只启动了2个平台容器。 
OMU1的内部控制面地址是172.17.0.1 
OMU2的内部控制面地址172.17.0.2 
从OMU2上ping OMU1的地址172.17.0.1能ping通，但是从OMU1上ping OMU2的地址172.17.0.2
ping不通。 
##### 解决办法 
OMU1的内部控制面地址是172.17.0.1是网桥docker0的默认地址，所有启动容器的虚机都有docker0这个默认网桥存在，并且默认地址是172.17.0.1，内部控制面子网段规划应该避免使用172.17.0.0/16这个地址段。 
`ifconfig
        docker0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 0.0.0.0
        ether 02:42:ec:b7:48:15  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0` 
## 软件安装（MANO） 
### 安装概述 
#### 安装导读 
在进行ZXUN uMAC软件安装前，确保已经完成硬件设备安装和CloudStudio软件安装，本文只涉及ZXUN uMAC的版本软件的安装过程。安装全流程参见[表1]。
安装步骤|安装内容|安装参考文档
---|---|---
1|VIM云平台|VIM安装云平台软件|TECS OpenStack云平台参考TECS OpenStack用户手册文档包中用户手册文档包中的《软件安装》内容进行安装。其他云平台，参见各云平台相应的手册。
2|MANO|安装MANO|参考CloudStudio用户手册文档包中用户手册文档包中的《安装与调测》内容进行安装。
3|VNF|安装ZXUN uMAC|详细信息请参考本文档后续章节。
#### 安装流程 
ZXUN uMAC虚拟化的软件安装流程参见[表1]。
步骤|操作|说明|参考
---|---|---|---
1|安装前准备|安装前的准备工作。|安装前准备
2|创建虚机资源|创建项目以及创建项目对应的网络平面、子网。|创建虚拟资源
3|部署VNF|注册VNF版本包以及实例化VNF，完成VNF所需虚拟资源的创建和业务程序的自动部署。|VNF的部署
### 安装前准备 
#### 软件准备 
##### 简介 
软件准备包括ZXUN uMAC的版本安装软件和客户端上需要安装的软件。
##### 客户端的软件配置要求 
客户端采用普通PC机，参考配置如下： 
CPU：双核，主频≥2 GHz。 
内存：≥4 GB。 
硬盘：≥80 GB。 
客户端的功能参见[表1]。
类别|描述
---|---
与VIM通信|作为VIM客户端。在本文档中，作为客户端，访问中兴通讯自研的云平台管理软件TECS OpenStack。
与VNFM和NFVO通信|作为VNFM和NFVO和客户端。在本文档中，作为客户端，访问中兴通讯自研的NFVI资源编排和管理软件MANO。
与NFVI通信|以SSH方式访问作为控制节点或计算节点的硬件服务器。
存放版本文件|将ZXUN uMAC的版本安装软件从客户端上传到NFVI。
客户端中需要安装的软件参见[表2]。
软件类型|软件名称|备注
---|---|---
操作系统|Windows|建议安装Windows 7或更高级的版本。
浏览器|只支持Google Chrome，操作员需要通过浏览器登录到TECS OpenStack和MANO图形化操作页面。|浏览器
FTP或SFTP工具|将ZXUN uMAC的版本文件从客户端上传到NFVI上。|FTP或SFTP工具
远程访问工具|以SSH方式访问作为控制节点或计算节点的硬件服务器。|远程访问工具
#### 获取用户名和密码 
在安装过程中涉及到的用户名及密码参见[表1]。
系统|用户名及密码
---|---
NFVO|登录NFVO客户端的默认用户名及密码如下：用户名：admin密码：Zenap_123（此处为单下划线）
登录NFVO操作系统的默认用户名及密码如下：用户名：root密码：CloudStudio__123（此处为双下划线）|NFVO
TECS OpenStack|登录TECS OpenStack客户端的默认用户名及密码如下：TECS OpenStack V3.17.14版本以上用户名：admin密码：KeystoneTECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123
登录主机的操作系统的默认用户名及密码如下：用户名：通过tecs用户登录，使用sudo -i命令切换到root用户密码：ossdbg1|TECS OpenStack
EM客户端|用户名：admin密码：Zenap_123
#### 在VNFM上创建API用户 
概述 :本节介绍当VNF采用Https+Token方式部署时，如何在VNFM上创建API用户。 
随着版本更新在部署时新增https认证功能，VNF需要向VNFM获取token。 
 说明： 
该操作建议请现场MANO维护人员进行操作，ZXUN uMAC开通人员向MANO维护人员获取到新增用户的用户名/密码即可。
操作步骤 :登录VNFM客户端，在VNFM上新建用户，选择系统→安全→账户规则
，进入账户规则页面，单击新建账户规则。
配置规则名称，去掉勾选首次登录时必须修改密码，密码最大有效期配置为0，如[图1]所示。
图1  新建帐户规则

帐号登录方式需要手动勾选WEB和API并单击新建按钮完成账户规则创建，如[图2]所示。
图2  帐号登录方式

选择系统→安全→用户管理
，单击新建用户。
在基本信息中，配置自定义好的用户名、密码需要和AIC工具中填写一致。将用户规则配置为之前创建好的API，设置为同时登录数限制为不限制，如[图3]所示。
图3  配置基本信息

单击下一步，进入权限分配页面，勾选全部角色。
单击新建，在VNFM上新建用户完成。
### 网络数据规划 
#### 基础数据规划 
##### VM简介 
支持部署为三种逻辑网元：MME 、SGSN和AMF。 
4G网络中，ZXUN uMAC部署为MME和SGSN。 
4G和5G融合网络中，ZXUN uMAC同时承担MME、SGSN和AMF的功能。 
5G网络中，ZXUN uMAC部署为AMF。 
ZXUN uMAC、模块、VM之间的关系如下：
ZXUN uMAC部署为多种不同类型的VM。 
每个VM运行一个模块功能，例如一个VM只运行GSU模块功能。 
每种模块可部署为一个或多个VM，例如GSU模块在实例化时，可以部署为两个VM。 
VM规划数据参见[表1]。
VM名称|服务|功能
---|---|---
OMU|O&M|操作与维护单元，其中还包含一个用于辅助判断OMU主备状态的AMU单元。OMU通过管理类通信平面与EM和VNFM交互。
IPU|Interface|接口处理单元，处理IP接口业务。
（可选）CDU|Cloud DB|云数据库单元，用于存储用户会话上下文等信息。CDU为可选单元。当ZXUN uMAC自身集成了数据库功能时，CDU是必需的。当ZXUN uMAC使用外部数据库功能（例如UDSF）时，CDU不是必需的。
GSU|MME&SGSN_C|处理MME和SGSN的控制面数据。
SGSN_U|GSU|处理SGSN用户面数据。
AMF_Communication|GSU|提供3GPP协议中定义的AMF通信服务。
AMF_MT|GSU|提供3GPP协议中定义的AMF的MT服务。
AMF_EventExposure|GSU|3GPP协议中定义的AMF事件暴露服务。
ResourceManage|GSU|提供3GPP协议中定义的资源管理服务。
SIG LB|GSU|处理SCTP和SS7信令。
HTTP LB|GSU|处理HTTP信令。
（可选）CDU GW|GSU|CDU网关，用于ZXUN uMAC的CDU之间的数据转发。CDU GW为可选单元，当ZXUN uMAC自身集成了数据库功能（即ZXUN uMAC部署了CDU VM）时，在异地容灾场景，需要使用GSU（CDU GW），否则不需要。
各业务模块VM支持的工作模式参见[表2]。
VM类型|工作模式|推荐部署方式|描述
---|---|---|---
OMU|1+1+1主备|互斥|OMU虚机的备份方式为1+1+1主备方式，其中，两个VM作为OMU主备，另外一个VM作为AMU用于为这两个OMU提供主备仲裁服务。如果两个OMU虚机部署到同一个主机上，该主机宕机时，会导致ZXUN uMAC故障，无法接入新用户，因此OMU虚机必须设置为互斥部署。
GSU|N+M负荷分担|互斥|建议部署为互斥。
IPU|N+M负荷分担|互斥|建议部署为互斥。
（可选）CDU|N×（1+1）互备|互斥|CDU虚机的备份方式为N×(1+1)主备，即部署N组CDU虚拟机，每组中的两个CDU虚拟机为1+1互备。如果一组中的两个CDU虚机部署到同一个主机上，该主机宕机时，会导致CDU上的备份数据都丢失，因此CDU虚机必须设置为互斥部署。
#### 组网数据规划 
##### SDN组网数据规划 
概述 :SDN组网架构，需要配置如下数据： 
操作员需要事先在VIM云平台（本文档指中兴通讯的TECS OpenStack）创建所有的网络平面，且每个网络平面的属性需要设置为VXLAN，参见“创建网络平面”。 
ZXUN uMAC的外部网络平面需要启用VLAN TRUNK功能。 
###### 网络平面规划 
网络平面是指各个虚机通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN uMAC规划的网络平面分为三类，参见[表1]。
网络平面|描述|部署原则
---|---|---
网管平面|ZXUN uMAC的MPU虚机和VIM、NFVO进行通信的网络平面。|部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。国内运营商场景：部署在同一个VIM上的所有的NF都共用一个网管平面。
内部网络平面|内部网络平面是指ZXUN uMAC中的各个虚机之间进行数据通信的网络平面。|规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面。|SDN组网架构，在启用VLAN Trunk功能的情况下，规划一个parent（父）网络平面和N个child（子）网络平面，将所有child（子）网络平面都配置在parent（父）网络平面的VLANTrunk子接口中，具体操作参见“VLAN Trunk功能配置示例”。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，所有网络平面都不能使用172.17.0.0/16地址段中的IP地址。 
网络平面|描述
---|---
网管平面|ZTE_EMS_NET|网管平面|ZXUN uMAC的MPU虚机和VIM、NFVO进行通信的网络平面。
内部网络平面|内部媒体平面|ZTE_AMF_x_SERV_INT_NET|对于属于本VNF的网络平面，ZXUN uMAC定义了两种类型，内部网络平面和外部网络平面。内部网络平面是指PROJ-uMAC-1项目（即ZXUN uMAC）中的各个虚机之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制平面和内部媒体平面。
内部控制平面|内部网络平面|ZTE_AMF_x_MGT_INT_NET|对于属于本VNF的网络平面，ZXUN uMAC定义了两种类型，内部网络平面和外部网络平面。内部网络平面是指PROJ-uMAC-1项目（即ZXUN uMAC）中的各个虚机之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|parent（父）网络平面|ZTE_AMF_x_EXT_NET|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面，在运营商的实际组网环境中，对外通信网络平面可以只设置为一个ZTE_AMF_x_EXT_NET，也可以根据ZXUN uMAC对外通信接口的类型细分为N个。
child（子）网络平面|外部网络平面|ZTE_AMF_x_EXT_NET2_Subport1|每个子接口网络平面的具体作用可以自定义。
ZTE_AMF_x_EXT_NET2_Subport2|child（子）网络平面|外部网络平面|每个子接口网络平面的具体作用可以自定义。
ZTE_AMF_x_EXT_NET2_Subport3|child（子）网络平面|外部网络平面|每个子接口网络平面的具体作用可以自定义。
ZTE_AMF_x_EXT_NET2_Subport4|child（子）网络平面|外部网络平面|每个子接口网络平面的具体作用可以自定义。
ZXUN uMAC和安全网关同时部署时，安全网关规划的网络平面的详细描述参见[表3]。
 说明： 
国内运营商场景：安全网关使用单独的网管平面，不和其他网元共用。 
网络平面类型|名称
---|---
网管平面|网管平面（parent）|ZTE_uMAC_x_ITC_EMS_NET
网管平面（child）|网管平面|ZTE_uMAC_x_ITC_EMS_NET_SubPort1
ZTE_uMAC_x_ITC_EMS_NET_SubPort2|网管平面（child）|网管平面
ZTE_uMAC_x_ITC_EMS_NET_SubPort3|网管平面（child）|网管平面
内部网络平面|内部管理通信|ZTE_uMAC_x_ITC_INNER_NET
外部网络平面|外部网络平面|ZTE_uMAC_x_ITC_XI_NET
外部网络平面（parent）|外部网络平面|ZTE_uMAC_x_ITC_HI_NET
外部网络平面（child）|外部网络平面|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|外部网络平面（child）|外部网络平面
ZTE_uMAC_x_ITC_HI_NET_SubPort3|外部网络平面（child）|外部网络平面
预留外部网络平面|外部网络平面|ZTE_uMAC_x_ITC_RES_NET
在启用VLAN Trunk功能的情况下，通常将ZTE_uMAC_x_ITC_HI_NET定义为parent（父）网络平面，下面规划三个child（子）网络平面，将所有child（子）网络平面都配置在parent（父）网络平面的VLAN
Trunk子接口中。 
###### 虚机对应的网络平面 
ZXUN uMAC的各个虚机关联的网络平面参见[表4]。
NF类型|VM|需要关联的网络平面
---|---|---
ZXUN uMAC|OMU|ZTE_EMS_NET|ZTE_EMS_NET
ZTE_AMF_x_MGT_INT_NET|ZXUN uMAC|ZTE_AMF_x_MGT_INT_NET|OMU
ZTE_AMF_x_SERV_INT_NET|ZXUN uMAC|ZTE_AMF_x_SERV_INT_NET|OMU
GSUIPUCDU|ZXUN uMAC|ZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NET|ZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NET
IPU|ZXUN uMAC|ZTE_AMF_x_MGT_INT_NET|ZTE_AMF_x_MGT_INT_NET
ZTE_AMF_x_SERV_INT_NET|IPU|ZTE_AMF_x_SERV_INT_NET|ZXUN uMAC
ZTE_AMF_x_EXT_NET|IPU|ZXUN uMAC|ZTE_uMAC_x_EXT_NET_SubPort1
ZTE_uMAC_x_EXT_NET_SubPort2|ZTE_AMF_x_EXT_NET|IPU|ZXUN uMAC
ZTE_uMAC_x_EXT_NET_SubPort3|ZTE_AMF_x_EXT_NET|IPU|ZXUN uMAC
ZTE_uMAC_x_EXT_NET_SubPort4|ZTE_AMF_x_EXT_NET|IPU|ZXUN uMAC
安全网关|IAU|ZTE_AMF_x_ITC_EMS_NET|ZTE_uMAC_x_ITC_EMS_NET_SubPort1
ZTE_uMAC_x_ITC_EMS_NET_SubPort2|安全网关|IAU|ZTE_AMF_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_EMS_NET_SubPort3|安全网关|IAU|ZTE_AMF_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_INNER_NET|安全网关|ZTE_uMAC_x_ITC_INNER_NET|IAU
ZTE_uMAC_x_ITC_RES_NET|安全网关|ZTE_uMAC_x_ITC_RES_NET|IAU
ZTE_uMAC_x_ITC_XI_NET|安全网关|ZTE_uMAC_x_ITC_XI_NET|IAU
ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
ZTE_uMAC_x_ITC_HI_NET_SubPort3|ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
IMU|安全网关|ZTE_uMAC_x_ITC_INNER_NET|ZTE_uMAC_x_ITC_INNER_NET
ZTE_uMAC_x_ITC_XI_NET|IMU|ZTE_uMAC_x_ITC_XI_NET|安全网关
ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
ZTE_uMAC_x_ITC_HI_NET_SubPort3|ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
##### 非SDN组网数据规划 
概述 :非SDN组网架构，需要配置如下数据： 
操作员需要事先在VIM云平台（本文档指中兴通讯的TECS OpenStack）创建所有的网络平面，且每个网络平面的属性需要设置为VLAN，参见“创建网络平面”。 
ZXUN uMAC的外部网络平面不需要启用VLAN TRUNK功能，启用VLAN透传。 
###### 网络平面规划 
网络平面是指各个虚机通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN uMAC规划的网络平面分为三类，参见[表1]。
网络平面|描述|部署原则
---|---|---
网管平面|ZXUN uMAC的MPU虚机和VIM、NFVO进行通信的网络平面。|部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。国内运营商场景：部署在同一个VIM上的所有的NF都共用一个网管平面。
内部网络平面|内部网络平面是指ZXUN uMAC中的各个虚机之间进行数据通信的网络平面。|规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面。|在运营商的实际组网环境中，对外通信网络平面可以只规划一个，也可以根据ZXUN uMAC对外通信接口的类型细分为N个。国内运营商场景：对外通信网络平面只需要规划一个。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，所有网络平面都不能使用172.17.0.0/16地址段中的IP地址。 
项目|网络平面|描述
---|---|---
网管平面|ZTE_EMS_NET|网管平面|NFVO服务器、NFVO客户端、ZXUN uMAC的OMU虚机和VIM进行通信的网络平面。
内部网络平面|内部控制平面|ZTE_AMF_x_MGT_INT_NET|对于属于本VNF的网络平面，ZXUN uMAC定义了两种类型，内部网络平面和外部网络平面。内部网络平面是指ZTE_uMAC_PROJ项目（即ZXUN uMAC）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面，本文档规划内部控制面名称为ZTE_uMAC_x_MGT_INT_NET，内部媒体面名称为ZTE_uMAC_x_SERV_INT_NET。
内部媒体平面|内部网络平面|ZTE_AMF_x_SERV_INT_NET|对于属于本VNF的网络平面，ZXUN uMAC定义了两种类型，内部网络平面和外部网络平面。内部网络平面是指ZTE_uMAC_PROJ项目（即ZXUN uMAC）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面，本文档规划内部控制面名称为ZTE_uMAC_x_MGT_INT_NET，内部媒体面名称为ZTE_uMAC_x_SERV_INT_NET。
外部网络平面|ZTE_AMF_x_SIG_EXT_NET|外部网络平面|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面，在运营商的实际组网环境中，对外通信网络平面可以只设置为一个，也可以根据ZXUN uMAC对外通信接口的类型细分为N个，本文档规划为两个外部网络平面。
ZTE_AMF_x_MEDIA_EXT_NET|外部网络平面|外部网络平面|外部网络平面是指ZXUN uMAC与外部接口进行通信的网络平面，在运营商的实际组网环境中，对外通信网络平面可以只设置为一个，也可以根据ZXUN uMAC对外通信接口的类型细分为N个，本文档规划为两个外部网络平面。
ZTE_AMF_x_LIG_EXT_NET|外部网络平面|外部网络平面|ZXUN uMAC和安全网关通信的网络平面。
ZXUN uMAC和安全网关同时部署时，安全网关规划的网络平面的详细描述参见[表3]。
 说明： 
国内运营商场景：安全网关使用单独的网管平面，不和其他网元共用。 
网络平面类型|名称
---|---
网管平面|ZTE_uMAC_x_ITC_EMS_NET|网管平面
内部网络平面|内部服务通信|ZTE_uMAC_x_ITC_RES_NET
内部管理通信|内部网络平面|ZTE_uMAC_x_ITC_INNER_NET
外部网络平面|ZTE_uMAC_x_ITC_XI_NET|外部网络平面
ZTE_uMAC_x_ITC_HI_NET|外部网络平面|外部网络平面
###### 虚机对应的网络平面 
ZXUN uMAC的各个VM关联的网络平面参见[表4]。
NF类型|VM|网络平面
---|---|---
ZXUN uMAC|OMU|ZTE_EMS_NET
ZTE_AMF_x_MGT_INT_NET|ZXUN uMAC|OMU
ZTE_AMF_x_SERV_INT_NET|ZXUN uMAC|OMU
GSUCDU|ZXUN uMAC|ZTE_AMF_x_MGT_INT_NET
ZTE_AMF_x_SERV_INT_NET|GSUCDU|ZXUN uMAC
IPU|ZXUN uMAC|ZTE_AMF_x_MGT_INT_NET
ZTE_AMF_x_SERV_INT_NET|IPU|ZXUN uMAC
ZTE_AMF_x_SIG_EXT_NET|IPU|ZXUN uMAC
ZTE_AMF_x_MEDIA_EXT_NET|IPU|ZXUN uMAC
ZTE_AMF_x_LIG_EXT_NET|IPU|ZXUN uMAC
安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_INNER_NET|安全网关|IAU
ZTE_uMAC_x_ITC_RES_NET|安全网关|IAU
ZTE_uMAC_x_ITC_XI_NET|安全网关|IAU
ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
IMU|安全网关|ZTE_uMAC_x_ITC_INNER_NET
ZTE_uMAC_x_ITC_XI_NET|IMU|安全网关
ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
### 创建虚拟资源 


ZXUN uMAC的软件是运行在云平台管理系统TECS OpenStack的虚拟机环境中。虚拟机指通过软件模拟的具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统。


ZXUN uMAC所运行的虚拟环境包括了各种虚拟资源，如：主机、内存、CPU、网口。管理员可通过WEB方式登录TECS
OpenStack，创建并启动虚拟资源。


#### 登录TECS OpenStack 
摘要本节介绍如何使用Google Chrome浏览器登录TECS
OpenStack管理系统，以便配置相关数据，进行实例化VNF的操作。 
相关信息 :ZXUN uMAC的软件可以运行在中兴通讯的VIM中，也可以在第三方厂商提供的VIM中运行。
本节以TECS
OpenStack为例介绍ZXUN uMAC虚拟资源的创建过程。
管理员可通过WEB方式登录TECS OpenStack管理系统，创建并启动虚拟资源。
TECS OpenStack提供的基于WEB方式的图形化操作界面，原理与OpenStack的Dashboard组件类似。OpenStack是一种开源标准接口，包括了很多标准组件，Dashboard是其中的一种组件，功能主要是提供WEB方式与外界进行交互。操作员能够使用WEB页面与OpenStack提供的各种服务进行交互。
步骤 :在PC客户端，打开Google Chrome浏览器，在地址栏输入https://x.x.x.x/ngportal/login
。
地址填写说明参见[表1]。
项目|说明
---|---
x.x.x.x|设置一个IP地址，需要设置为TECS OpenStack的主用控制节点的TECSClient网络平面的IP地址，操作员通过此地址可以使用浏览器登录TECSOpenStack的客户端。
按Enter键，页面自动转到登录页面。
初始登录TECS OpenStack客户端的默认用户名及密码如下： 
TECS OpenStack V3.17.14版本以上用户名：admin密码：Keystone 
TECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123 
输入用户名和密码，单击登录按钮，进入TECS OpenStack，默认显示为总览页面。
#### 创建用户 
摘要 :本节介绍如何创建TECS OpenStack的用户。在一个TECS OpenStack中可以管理不同运营商的多个VNF。为了区别各个运营商的VNF，TECS OpenStack以项目的方式实现各个VNF之间虚拟资源的隔离，将同一个NFVO或同一个VNF内的主机、网络等资源归属到同一项目。
当一个VIM云平台同时管理运营商的多个VNF时，为隔离不同运营商的VNF，需要使用不同的用户来接入。
TECS OpenStack支持多用户接入，不同的用户，在TECS OpenStack上可以拥有不同的操作权限和资源访问范围，可以为每一个项目创建一个用户。 
本文档规划创建一个名称为ZXUN uMAC的用户，供ZTE_uMAC_PROJ项目使用。 
TECS OpenStack默认的用户，无需创建（本节以SysAdmin用户为例进行说明）。 
TECS OpenStack V3.17.14版本以上用户名：admin密码：Keystone 
TECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123 
 说明： 
ZTE_uMAC_PROJ仅为示例，实际环境中的名称请以运营商规划为准。 
步骤 :在TECS OpenStack的客户端，切换到系统管理页面，在左侧的导航栏中选择用户
，出现用户页面。
 说明： 
SysAdmin用户是TECS OpenStack默认的用户，无须创建。 
单击创建用户按钮。
基本信息区域框中的参数说明参见[表1]。
参数名称|参数说明
---|---
用户名|该参数用于设置接入TECS OpenStack的用户名称，根据规划的数据进行设置，本文档规划创建一个名称为ZXUN uMAC的用户，供ZTE_uMAC_PROJ项目使用。
第三方认证用户|该参数在默认情况下，不需要勾选。
密码|该参数用于设置接入TECS OpenStack的用户密码，根据“获取用户名和密码”中规划的数据进行设置。
确认密码|再次输入用户的密码，确认密码必须与密码一致。
角色|该参数用于设置用户的角色。maintenance如果此用户对应的操作权限和资源访问范围包括VNF，也包括VIM，则需要勾选maintenance。cloudManager如果此用户对应的操作权限和资源访问范围为VIM（中兴通讯对应的产品名称为CloudStudio和TECSOpenStack），则需要勾选cloudManager。projectManager如果此用户对应的操作权限和资源访问范围为各个项目，则需要勾选projectManager。Performance ObserverSystem ObserverAlarm Observermaintenance、cloudManager和projectManager，三者只能选择其一。建议项目的用户权限设置为勾选maintenance或根据需要选择Performance Observer、System Observer及Alarm Observer。
允许登录时间|设置起始时间和结束时间。
邮箱|非必选参数，操作员可根据实际情况设置。
描述|对用户的补充说明，非必选参数，操作员可根据实际情况设置。
单击确定按钮，用户创建成功。
#### 创建项目 
摘要项目又称为租户，TECS OpenStack以项目的方式来隔离各个VNF所占用虚拟资源，同一个VNF内的主机、端口等虚拟资源归属到同一项目。TECS OpenStack安装成功后，TECS OpenStack自动生成的默认项目，名称为admin和service，这两个项目无须操作员创建。根据规划数据，操作员还需要创建一个属于ZXUN uMAC的项目，为ZTE_uMAC_PROJ。 说明：ZTE_uMAC_PROJ仅为示例，实际环境中的名称请以运营商规划为准。 
相关信息 :TECS OpenStack从运维的角度出发，为了更合理的管理虚拟资源，定义了项目和用户的概念，在进行本节的操作前，需要了解以下相关信息。 
项目一个TECS OpenStack可以管理不同运营商的多个NFVO或VNF。为了运维的安全性，TECS OpenStack以项目的方式实现各个NFVO或VNF所占有的虚拟资源的隔离，通常情况下，规划将同一个NFVO或同一个VNF内的主机、网络等资源归属到同一项目。 
用户在实际操作环境中，操作员通过各个用户接入TECS OpenStack。不同的用户，在TECS OpenStack上可以拥有不同的操作权限和资源访问范围。这些用户预先已定义好分别属于各个项目，拥有各个项目对应的操作权限和资源访问范围。TECS OpenStack定义了两大类用户权限：云管理用户权限和项目管理用户权限。云管理用户权限可以管理底层物理资源，项目管理用户权限可以管理各个VNF的资源。TECS OpenStack默认的用户，无需创建（本节以SysAdmin用户为例进行说明），该用户同时拥有云管理和项目管理两大类权限。 
项目和用户的关系在TECS OpenStack创建一个用户，设置此用户对应的权限。在后续创建项目时，可以根据实际情况，将某个用户加入到项目中（将用户加入到项目的过程即为将此用户对应的权限赋予项目，表示使用此用户登录后，可以管理此项目的资源）。 
 说明： 
通常情况下可以为每一个项目创建项目本身所属的用户。TECS OpenStack默认的系统默认的用户SysAdmin，可以供所有的项目使用。 
步骤 :创建ZXUN uMAC的项目ZTE_uMAC_PROJ
在TECS OpenStack的主页面单击系统管理选项，在页面左侧的导航栏中选择身份管理→项目
，如[图1]所示。
图1  项目页面

名称为admin的项目是TECS OpenStack自动生成的默认项目，此项目无须操作员创建。 
单击添加项目按钮，弹出添加项目对话框。
配额参数说明参见[表1]。
 说明： 
本节设置的配额是ZXUN uMAC对应的项目ZTE_uMAC_PROJ使用的配额。
参数|配置说明
---|---
名称|项目的名称，取值范围：0~245个字符，根据示例设置为ZTE_uMAC_PROJ。
域|该项目所属的可用域。可用域（Availability Zones）可以简单理解为一组主机的集合，这组主机具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域是通过VIM云平台管理系统（如中兴通讯的TECS OpenStack）设置的。域是一个用户可见的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。
描述|对项目名称的补充说明，非必选参数，操作员可根据实际情况设置。
实例|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的虚拟主机数量。该项目中启动的虚拟主机的个数总和不得超过该参数值。需要根据实际情况来配置，默认值为10，建议设置的数量=ZXUN uMAC虚机的总数×2。
VCPU|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的虚拟内核数量。该项目中启动的虚拟主机的内核数总和不得超过该参数值。需要根据实际情况来配置，默认值为20，建议设置的数量=40×ZXUN uMAC物理刀片个数（计算节点）×2。
内存(GB)|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的虚拟内存数量。需要根据实际情况来配置，默认值为50，ZXUN uMAC的建议设置值为5120。
云硬盘|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的虚拟硬盘数量。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
云硬盘快照|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的云硬盘快照数量。硬盘快照保存硬盘的状态，不保存硬盘内容。创建快照后，可以把硬盘回复到创建快照时的状态。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
存储|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的卷和快照的总大小。将虚拟硬盘划分不同的存储区域，这些存储区域就是卷。卷快照保存卷的状态，不保存卷内容。创建快照后，可以把卷回复到创建快照时的状态。卷与其快照空间大小的总和，单位：GB。需要根据实际情况来配置，默认值为1000，建议设置的数量=600×ZXUN uMAC物理刀片个数（计算节点）×2。
元数据条目|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的元数据条目数。需要根据实际情况来配置，默认值为128，建议放大10倍，设置为1280。
密钥对|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的密钥对。
可注入的文件|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ可注入的文件的数量。需要根据实际情况来配置，默认值为5，建议放大10倍，设置为50。
注入文件路径最大长度|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ可注入的注入文件路径最大长度。
可注入文件大小（Bytes）|为ZXUN uMAC对应的项目ZTE_uMAC_PROJ可注入文件的大小。单位：字节。需要根据实际情况来配置，默认值为10240，建议放大10倍，设置为102400。
浮动IP|ZXUN uMAC对应的项目ZTE_uMAC_PROJ可配置的浮动IP个数。需要根据实际情况来配置，默认值为50，建议放大10倍，设置为500。
网络|ZXUN uMAC对应的项目ZTE_uMAC_PROJ可配置的逻辑网络个数。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
端口|为该项目分配的虚拟端口个数。需要根据实际情况来配置，默认值为50，建议放大10倍，设置为500。
路由|ZXUN uMAC对应的项目ZTE_uMAC_PROJ可配置的路由个数。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
子网|ZXUN uMAC对应的项目ZTE_uMAC_PROJ分配的子网个数。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
防火墙|为该项目分配的防火墙个数。默认值：10。建议放大10倍，设置为100。
防火墙策略|为该项目分配的防火墙策略个数。默认值：10。建议放大10倍，设置为100。ZXUN uMAC对应的项目ZTE_uMAC_PROJ可分配的防火墙策略个数。防火墙策略是多个iptables规则的集合，这些规则用来限制对虚拟机的访问流量，其目的是为了让TCP、UDP和ICMP三种协议报文可以正常通信。
防火墙规则|ZXUN uMAC对应的项目ZTE_uMAC_PROJ可分配防火墙规则个数。防火墙规则就是iptables规则。可以定义n个防火墙策略，每个防火墙策略可以有m个防火墙规则，可以给每个项目绑定n个防火墙策略。默认值：100。建议放大10倍，设置为1000。
负载均衡|为该项目分配的负载均衡个数。默认值：10。建议放大10倍，设置为100。
虚机组|为该项目分配的虚机互斥组个数。该参数通常情况下使用10倍于默认值的数值即可。默认值为10，ZXUN uMAC的建议设置值为100。
虚机组成员|为该项目分配的虚机互斥组成员个数。该参数通常情况下使用10倍于默认值的数值即可。默认值为10，ZXUN uMAC的建议设置值为100。
单击创建按钮，项目ZTE_uMAC_PROJ创建成功，如[图2]所示。
图2  项目ZTE_uMAC_PROJ创建成功

将SysAdmin、ZXUN uMAC和MANO这几个用户的权限赋予ZTE_uMAC_PROJ项目
在项目列表中，单击ZTE_uMAC_PROJ项目后面的编辑成员按钮，弹出编辑成员对话框，如[图3]所示。
图3  编辑项目成员对话框

项目创建成功，需要将SysAdmin用户、此项目对应的用户，及管理VFVO和VNFM的项目（本文档示例为MANO）加入到此项目中，作为此项目的成员。将用户加入成为某个项目的成员后，操作员使用该用户登录TECS
OpenStack后，可对该项目进行管理。 
 说明： 
SysAdmin用户是TECS OpenStack云平台管理系统默认的用户，无须创建。 
在编辑项目成员对话框左侧对应的可选用户列表框中，选择SysAdmin和ZXUN uMAC，将其加入到编辑项目成员对话框右侧的项目成员列表中，结果如[图4]所示。
图4  为项目增加成员

单击修改按钮，为项目增加成员成功。
#### 创建网络平面 
摘要 :本节介绍如何创建ZTE_uMAC_PROJ项目的网络平面及其子网。 
步骤 :创建网络平面
在TECS OpenStack的客户端上单击云管理选项，在页面左侧导航栏中选择网络，如[图1]所示。
图1  网络区域框

单击添加网络按钮，弹出添加网络对话框。
创建网络对话框中的参数说明参见[表1]。
参数名称|参数说明
---|---
基本信息|项目|该参数用于设置该网络平面属于的项目。根据规划的数据进行创建。从下拉列表中选择，其中ZTE_uMAC_PROJ项目是通过“创建项目”操作创建的。
名称|基本信息|该参数用于设置网络平面的名称。根据规划的数据进行创建。
网络类型|基本信息|该参数用于设置网络平面的网络类型，需要根据运营商的实际网络环境进行设置，包括以下选项。flatflat网络是指扁平网络，即VIM云平台本身不对业务网络进行VLAN隔离，只能依赖外部交换机过滤VLAN报文。从安全的角度考虑，在商用环境中，一般不建议使用flat网络类型。vlan如果运营商的组网环境为非SDN，建议设置为vlan。设置为此选项时，还需要设置物理网络和透传VLAN两个参数。vxlan如果运营商的组网环境为SDN，建议设置为vxlan。VXLAN是一种网络虚似化技术，是对VLAN技术的进一步优化，VXLAN提供和VLAN相同的二层网络服务，但相比VLAN有更大的扩展性和灵活性，用于解决在部署大型云计算设备时的数量扩展问题。
物理网络|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面对应的物理网络名称，根据规划数据，ZTE_uMAC_PROJ项目所有网络平面对应的物理网络名称都规划为physnet1。
VLAN透传|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面是否支持VLAN透传功能。根据的规划数据，ZTE_uMAC_PROJ项目的外部网络平面，建议勾选此参数。
段ID|基本信息|该参数用于设置设置VLAN ID。如果该网络平面支持VLAN透传功能，必须设置VLAN子接口范围。即段ID的格式需要设置为××:××:××，三个值分别表示为起始VLAN、终止VLAN和Native VLAN（PVID）。
高级属性|MTU|该参数表示系统的MTU数值。对于admin项目，所有网络平面的MTU数值都为1600。对于ZTE_uMAC_PROJ项目，用于内部控制面通信的网络平面的MTU配置为1800，用于内部媒体面通信的网络平面的MTU配置为1800，其它网络平面都固定为1500。
网络Qos|高级属性|该参数用于设置是否启用网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。
管理状态|高级属性|该参数建议保持默认值。
共享|高级属性|表示此网络平面属性是否为共享网络。在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。
外部网络|高级属性|默认情况下，建议不需要勾选。
参数设置完成后，单击创建按钮，完成网络平面的设置。
重复执行[步骤2]~[步骤3]，创建所有的网络平面。
创建子网
在TECS OpenStack的客户端，切换到虚拟资源页面，在左侧的导航栏中选择网络
→网络
，出现网络页面，可以看到已经创建成功的网络平面。
在网络平面对应的操作下拉列表中，单击选择创建子网，弹出创建子网对话框。
创建子网对话框的参数说明参见[表2]。
参数名称|描述
---|---
基本信息|名称|表示网络平面对应的子网名称，根据规划的数据进行设置。
CIDR|基本信息|表示子网的地址，根据规划的数据进行设置。
项目|基本信息|从下拉列表中选择网络平面对应的项目。
激活DHCP|基本信息|勾选此选项，开启DHCP功能后，在TECS OpenStack创建虚机时，会自动为虚机分配此网络平面的IP地址。需要根据实际情况决定是否开启此功能。
禁用网关|基本信息|该参数表示子网是否需要设置网关地址。对于网元内部通讯的网络平面，勾选本参数，不需要设置网关地址。对于网元外部通讯的网络平面，如果采用非SDN VLAN组网，勾选本参数，不需要设置网关地址。对于网元外部通讯的网络平面，如果采用SDN+VxLAN组网，不勾选本参数，需要设置网关地址。采用SDN+VxLAN组网时，需要在SDN中配置路由，因此必须配置网关IP地址，该网关地址会通过TECSOpenStack传递给SDN控制器。
网关IP|基本信息|该参数表示网关地址，勾选禁用网关后，无需设置该参数。
高级属性|地址池|暂不涉及此参数，无需配置。
域名服务器|高级属性|暂不涉及此参数，无需配置。
主机路由|高级属性|暂不涉及此参数，无需配置。
设置完参数后，单击创建按钮，完成网络平面对应子网的创建。
重复执行[步骤6]~[步骤7]，创建所有的子网。
### VNF的部署 


VNF指虚拟化后的核心网网元（如：UPF、SMF、AMF等），执行3GPP定义的网元功能。


VNF部署过程参见[表1]。


步骤|描述|备注
---|---|---
1|登录NFVO客户端|部署VNF是通过CloudStudio进行操作的。
2|准备VNF版本包|上传VNF产品的版本包，并指定VNF接入VIM的用户。
3|实例化VNF|实例化VNF完成后，便可启动和运行VNF。


#### 登录NFVO客户端 
摘要ZXUN CloudStudio系统包括NFVO和VNFM。本节以NFVO客户端的登录为例进行说明。登录NFVO客户端后，可以在NFVO服务器上完成ZXUN uMAC的VNF部署操作。 
步骤 :打开浏览器，在地址栏输入https://x.x.x.x:28808/，登录NFVO客户端。
 说明： 
以Google Chrome浏览器登录为例，如果首次登录，则弹出您的连接不是私密连接提示，单击高级，在弹出的界面中单击继续连接。
地址填写说明参见[表1]。
项目|说明
---|---
x.x.x.x|NFVO客户端与NFVO服务器通讯的IP地址，为NFVO的网管网络平面的地址。
28808|HTTPS的端口号，例中为28808。此参数与IP地址之间需要用冒号隔开。
按Enter键，出现登录对话框。
登录对话框的参数说明参见[表2]。
参数名称|参数说明
---|---
用户名|默认初始用户名为admin。
密码|admin用户的初始密码为Zenap_123。使用admin用户登录后，可通过单击CloudStudio主页面右上角admin→修改密码，对密码进行修改。
输入用户名和密码。单击登录按钮，进入NFVO主页面。
#### 准备版本包 
摘要 :本节介绍VNF版本包的准备过程，主要过程如下：  TOC
上传基础包 
上传并注册镜像包 
上传业务软件包 
 说明： 
三种版本包的上传操作顺序没有固定要求，操作员可以任意选择上传的顺序。 
相关信息 :实例化ZXUN uMAC前，需要事先获取ZXUN uMAC的版本包，版本包分为三类。
基础包 
镜像包 
业务软件包 
基础包
基础包也称插件包，包含了虚机部署info.xml文件、业务部署nfservice.json文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。
ZXUN uMAC对应的基础包参见[表1]。
包名|备注
---|---
uMAC_vnfd.vXXX.csar|XXX代表具体的版本号，以实际版本为准，如uMAC_vnfd.v7.21.40.csar。
镜像包
镜像包是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件），镜像包参见[表2]。
包名|备注
---|---
cgsl.vXXX.zip|XXX代表具体的版本号，以实际版本为准，如cgsl_F16P9_20210630。
业务软件包
各NF均需加载各自的软件包，参见[表3]。
包名|备注
---|---
uMAC_Vxxx.zip|XXX代表具体的版本号，以实际版本为准，如uMAC_V7.21.40.zip。
步骤 :上传基础包
通过FTP工具将ZXUN uMAC的基础包文件以二进制方式上传至NFVO服务器指定路径下，默认将文件上传到NFVO服务器的/home/mano下。
 说明： 
通过FTP工具上传文件时，登录的用户名请使用root，默认的密码为CloudStudio__123，其中__为两个下划线。
在NFVO客户端中，切换到编排→设计
页面，在左侧的导航栏中选择软件仓库，默认显示为VNF页面。
单击导入按钮，弹出导入对话框。
导入基础包的参数说明参见[表4]。
参数名称|参数说明
---|---
导入方式|该参数表示导入版本文件包的方式，支持三种方式：FTP表示需要预先将软件包存放在FTP服务器，通过FTP方式上传到VIM云平台。SFTP表示需要预先将软件包存放在FTP服务器，通过SFTP方式上传到VIM云平台。本地文件是指软件包存放在当前客户端（通过此客户端访问NFVO）上，单击本地文件后，可以选择选择存放在本地目录的软件包，将版本文件上传至NFVO。
IP和端口|ZXUN uMAC的版本基础包所存放的设备（作为FTP服务器，提供FTP服务）的IP地址，一般为NFVO服务器的IP地址。使用ftp时，端口号固定为21。使用sftp时，端口号固定为22。
用户名|访问FTP服务器的用户名。默认用户名为root。
密码|访问FTP服务器的密码。默认的密码为CloudStudio__123，其中__为两个下划线。
文件路径|FTP服务器上存放ZXUN uMAC的基础包路径，此处需要设置为绝对路径。可设置为基础包的具体文件所在路径或上一级目录。设置为目录时，可上传该目录下的所有包。需要注意，此路径下不能包含存在点号的目录名，例如：/1.1。
选中sftp，输入相关参数。
单击提交按钮，NFVO开始从指定FTP/SFTP路径中下载基础包，下载进度显示在对话框的下方，当导入进度为100%时表示导入完成。
基础包导入完成后，单击关闭按钮，回到软件仓库页面。
成功上到NFVO的基础包显示在VNF页面中，状态显示为未注册，是否被使用显示为否，如[图1]所示。
 说明： 
后续在蓝图中心创建ZXUN uMAC的部署包时，需要引用此基础包。
图1  基础包状态

基础包导入成功后，在NFVO客户端中，切换到设计页面，单击左侧导航树中蓝图中心，在页面右侧切换至VNF页面，可以看到已导入的基础包，如[图2]所示。
图2  VNF列表

上传镜像包
通过FTP工具将cgsl.vXXX.zip
文件以二进制方式上传至NFVO服务器指定路径下，默认将文件上传到NFVO服务器的/home/mano
下。
 说明： 
通过FTP工具上传文件时，登录的用户名请使用root，默认的密码为CloudStudio__123，其中__为两个下划线。
在NFVO客户端中，切换到设计页面，单击左侧导航树中软件仓库，切换到虚机镜像页面。
参照导入基础包的操作步骤，在虚机镜像页面中导入镜像文件cgsl.vXXX.zip
。
镜像包导入完成后，单击关闭按钮。
镜像包显示在虚机镜像页面中，对应的状态为未注册，是否注册显示为否，如[图3]所示。
图3  镜像上传成功

选择要注册的镜像包，在镜像包对应的操作栏中，单击注册按钮，弹出注册对话框。
 说明： 
如果操作员需要获取当前所有的VIM信息，可以在NFVO客户端的菜单栏中选择系统→NFVO→接入管理
，单击左侧导航树中的接入管理→VIM
节点，查看所有的VIM信息。
将镜像类型设置为私有，并勾选需要注册的VIM，如[图4]所示。
图4  勾选需要注册的VIM包

单击注册按钮，NFVO系统解压镜像包，并将镜像文件上载到VIM云平台。当进度为100%时表示镜像包注册成功。
镜像包注册成功后，单击返回按钮，回到虚机镜像页面，镜像包CGSL的状态由未注册变为正常，如[图5]所示。
图5  镜像包注册成功

上传业务软件包
通过FTP工具将ZXUN uMAC的业务软件包以二进制方式上传至NFVO服务器指定路径下，默认将文件上传到NFVO服务器的/home/mano
下。
 说明： 
通过FTP工具上传文件时，登录的用户名请使用root，默认的密码为CloudStudio__123，其中__为两个下划线。
在NFVO客户端中，切换到设计页面，单击左侧导航树中软件仓库，切换到软件页面。
参照导入基础包的操作步骤，在软件页面导入基础包。
业务软件包导入完成后，单击关闭按钮。
业务软件包显示在软件页面中，对应的状态为正常，如[图6]所示。
图6  业务软件包示例

#### VNF的实例化 


本节介绍VNF的实例化，实例化过程中，系统完成VNF所需虚拟资源的创建和业务程序的自动部署。


##### 快速创建部署包 
摘要 :本节介绍基于已经导入成功后基础包、业务软件包和镜像包，在NFVO上创建满足运营商需求的ZXUN uMAC部署包的过程。
###### 相关说明 
操作员需要通过基础包、业务软件包和镜像包，来定制ZXUN uMAC的部署包，后续对部署包进行实例化操作，才能在VIM中创建ZXUN uMAC。
前提 :基础包、业务软件包、镜像包已导入。 
步骤 :在NFVO客户端中，切换到设计页面。单击左侧导航树中蓝图中心，在页面右侧的VNF页面，会显示已导入的ZXUN uMAC的基础包。
单击快速创建按钮，打开快速创建VNF页面。
快速创建部署包的参数说明参见[表1]。
参数名称|参数说明
---|---
创建方式|选择核心网方式。
参数设置|设置为默认值是。
是否基于VNF实例|设置为默认值否。
新包名称|设置部署包的名称，根据实际情况，由操作员进行设置。
新包版本号|本部署包的版本号，根据实际情况，由操作员进行设置。
新包提供商|提供部署包的厂商的名称，根据实际情况设置，通常情况下设置为ZTE
基础包|从下拉列表中选择已经上传的版本基础包。
场景|该参数用于根据实际业务量设置ZXUN uMAC的使用类型，包括如下选项：运营商的部署网络为4G和5G融合场景uMAC商用局 24GB AMF/MME/SGSNuMAC HG 商用局 28GB AMF/MME/SGSNuMAC商用局 32GB AMF/MME/SGSNuMAC商用局 36GB AMF/MME/SGSN运营商的部署网络为5G场景uMAC商用局 24GB AMFuMAC HG 商用局 28GB AMFuMAC商用局 32GB AMFuMAC商用局 36GB AMF运营商的部署网络为测试场景uMAC测试局AMF运营商的部署网络为测试5G场景uMAC测试局MME/SGSN运营商的部署网络为测试4G场景该参数决定了ZXUN uMAC所要部署的NFS、虚机的个数和规格等参数，在商用局中，该参数的值由商务合同规定。
引用镜像包|从下拉列表中选择已经注册的镜像包。
引用业务软件包|从下拉列表中选择已经注册的业务软件包。
配置示例参见[图1]。
图1  快速创建VNF

单击下一步，出现参数设置页面，在参数设置区域框中，会出现对应的参数页面列表。
通过以下两种方式修改参数。 
单击导入按钮，在弹出的对话框中导入已按规划修改后的info文件的zip包。 说明：此种方式必须在中兴通讯技术人员的指导下才能使用，操作员不能单独执行。 
双击各参数右侧的取值，根据实际规划编辑参数值，参数说明参见“部署参数配置说明”。 
确认所有的参数都修改完成后，单击提交按钮，NFVO系统开始快速创建ZXUN uMAC的部署包，进度为100%表示创建成功。
单击完成按钮，部署包创建成功。
单击返回按钮。
此时创建的部署包对应的状态为草稿，操作栏中的部署按钮为灰化状态，如[图2]所示。
图2  草稿状态

##### 注册VNF部署包 
摘要 :本节介绍如何在NFVO上注册创建好ZXUN uMAC部署包。
注册部署包分为两步操作： 
发布部署包。 
注册已经成功发布的部署包。 
步骤 :发布部署包
在CloudStudio管理系统的菜单栏中，切换到设计页面。单击左侧导航树中蓝图中心节点，切换到VNF页面，显示已经快速创建的部署包uMAC22，蓝图状态显示为草稿状态，如[图1]所示。
图1  部署包的状态为草稿状态

单击部署包对应的图标，进入部署包对应的蓝图页面，查看部署包的编排信息。
单击发布按钮，等待部署包发布结束后，发布按钮变成灰色，如[图2]所示。
图2  发布成功

单击返回按钮，回到VNF页面，部署包的蓝图状态显示为已发布状态，如[图3]所示。
图3  部署包发布成功

注册已经成功发布的部署包
在左侧导航树中，单击软件仓库节点，切换到VNF页面，可以看到已经发布成功的部署包，状态显示为未注册，如[图4]所示。
图4  软件仓库

选择未注册的快速部署包对应的操作栏中的注册按钮，弹出提示框。
在弹出的提示框中单击确定按钮后，系统开始注册VNF，当进度为100%时表示注册成功。
单击返回按钮。
此时[图4]所示的VNF部署包的状态栏的状态变为正常，如[图5]所示。
图5  VNF版本包注册成功

###### 后续步骤 
操作员对VNF部署包执行发布和注册操作结束后，需要登录到VNFM客户端，切换到设计
页面，在页面左侧导航栏中选择包管理→包下载管理
，确认部署包已经成功下载到VNFM，即按钮状态按钮显示为success，如[图6]所示。才能执行后续的实例化，否则实例化操作会失败
图6  确认版本已经上传成功

##### 实例化VNF 
摘要 :在版本部署包注册成功后，就可以部署ZXUN uMAC了。本节介绍如何实例化ZXUN uMAC。
步骤 :在NFVO客户端的左侧导航树中，切换到设计页面，单击蓝图中心节点，切换到VNF页，页面显示所有VNF版本包列表（包含已注册的部署包）。
单击部署包后的部署按钮，出现部署页面。
部署页面参数说明参见[表1]。
参数名称|参数说明
---|---
实例名称|实例化后生成的VFN的名称，根据实际情况，由操作员进行设置。
VNFDID|该参数不可设置，由系统自动读取数据设定。
VIM|从下拉列表中选择ZXUN uMAC部署的VIM云平台。
VNF包标识|该参数不可设置，由系统自动读取数据设定。
租户|选择VIM上已经对应的租户，即通过VIM云平台已经创建的租户。此处配置的租户，需要与注册镜像包时选择的租户相同。
VNFM|从下拉列表中选择ZXUN uMAC部署的VNFM。
配置示例参见[图1]。
图1  配置示例

在页面下方的参数框中，确认所有的参数都设置正确后，单击下一步按钮，进入沙箱测试页面。
（可选）沙箱测试操作的目的是为了检测资源是否满足部署要求。单击开始测试按钮，如果系统资源不足，请联系VIM云平台管理人员解决，等待测试通过后，再进行部署。
沙箱测试通过后，单击直接部署按钮，NFVO系统开始实例化VNF，并显示VNF的进度。
VNF实例化完成后，单击返回按钮，在菜单栏中选择编排→应用
页面，在左侧的导航栏中选择VNF，可以看到ZXUN uMAC的状态已经显示为active，表示虚机实例化成功，如[图2]所示。
图2  虚机实例化成功

实例化成功后，VIM云平台（本文档示例为TECS OpenStack）会为各个虚机分配子接口的IP地址和VLAN。在SDN组网场景中，在ROSNG平台上配置IPU虚机的子接口地址和VLAN从是MANO上查询获取的，查询操作参见[查询虚机的子接口地址和VLAN]。
###### 相关操作 
VNF实例化失败后，需要回退的操作步骤参见[实例化VNF失败后回退]。
### 部署参数配置说明 
#### 通用配置 
##### 全局配置 
全局配置如[图1]所示。
图1  全局配置

全局配置参数说明参见[表1]。
参数名称|参数含义
---|---
云平台类型|VNF所适用的VIM平台，包括三个选项。TECS该选项表示中兴通讯自研的VIM云平台TECS OpenStackOpenStack该选项基于OpenStack的VIM云平台VMware该选项表示基于VMware的VIM云平台
资源池名称前缀|该参数在某些运营商的要求场景下才需要按规定的原则进行配置。在运营商没有特殊要求的场景下，可以自己定义。某些运营商的虚拟化环境可能涉及到多个厂商的产品，各个厂商对于虚拟资源的命名都采用各自的规则，导致呈现的各种虚拟资源的相关信息参差不齐，不利于运营商对各种虚拟资源进行监控和管理。运营商可以通过设置本参数对VNF使用的虚拟资源进行严格规范的命名，以便资源的统一管理。定义了命名规则后，对于需要在VNF实例化过程中创建的各种虚拟资源，系统都会按照规定进行命名。
网元资源名称前缀|该参数在某些运营商的要求场景下才需要按规定的原则进行配置。在运营商没有特殊要求的场景下，不需要设置。如果需要设置，通常情况下，配置为VNF的名称+局号。
局号|该参数用于配置ZXUN uMAC的局号。取值范围：1~255之间的整数，需要根据运营商的规划来设置。配置原则：在同一个NFVO管理范围内的VNF的局号不能相同。
实例化模式|该参数包括两个选项：快速：只需要MPU虚机的管理容器和VNFM，两者之间建立TCP链路成功，即表示ZXUN uMAC实例化完成。标准：需要ZXUN uMAC所有虚机的容器都完成部署，才表示ZXUN uMAC实例化完成。该参数建议选择标准。
VNF网管语言环境|该参数用于设置ZXUN uMAC的OMM网管的语言环境，包括英文和中文，根据实际情况选择。
OAM Telnet功能|该参数用于设置是否支持使用TELNET方式登录ZXUN uMAC的OAM模块，进行数据配置操作。默认情况下，该参数需要设置为不启用，目前基于安全加固的需求，不支持通过TELNET方式登录ZXUN uMAC，只支持通过SSH方式登录ZXUN uMAC。
镜像可视性|该参数用于设置ZXUN uMAC的虚机操作系统镜像的属性，一般配置为private（私有），在特殊情况下，才需要配置为public（共享），建议使用默认值private（私有）。
启用网络QoS|该参数用于设置是否启用网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。在运营商没有特殊要求的情况下，一般设置为不启用，如果设置为启用，还需要设置网络QoS配置的相关数据。
启用存储QoS|该参数用于设置是否启用存储QoS控制策略，存储QoS策略是用于在VIM云平台上创建的云硬盘的读写策略。在运营商没有特殊要求的情况下，一般设置为不启用，如果设置为启用，还需要设置存储QoS配置的相关数据。
是否启用云盘保护|该参数在如下场景才涉及配置：ZXUN uMAC的虚机使用VIM云管理平台上创建的云硬盘（例如部署的磁阵设备）来存储数据。该参数用于设置当ZXUN uMAC与云硬盘的通信链路中断，重新恢复正常后的数据读写情况。启用该选项表示，当ZXUN uMAC与云硬盘的通信链路中断，重新恢复正常后，ZXUN uMAC的虚机与云硬盘之间恢复正常的数据读写操作。不启用该选项表示，当ZXUN uMAC与云平台的通信链路中断，重新恢复正常后，虚机所分配的云硬盘处于只读状态，只能进行查询操作，需要重启虚机才能恢复正常。该参数建议设置为启用。
启用密文传输敏感数据|本参数通常情况下，建议设置为启用，启用此功能后，VNFD版本包插件的内容中不会有明文密码等敏感信息，系统会进行加密处理。
自定义flavor|本参数用于配置云主机类型的命名规则，即实例化ZXUN uMAC成功后，在VIM云平台上显示的ZXUN uMAC的虚机名称。该参数在某些运营商的要求场景下才需要按规定的原则进行配置。在运营商没有特殊要求的场景下，不需要设置，保持默认值。本参数有两个配置值，none和auto_flavor_name。本参数配置为none，表示ZXUN uMAC虚机名称的命名规则为：ram_x_vcpus_x_disk_x_uuid本参数配置为auto_flavor_name，表示ZXUN uMAC虚机名称的命名规则为：资源前缀-FLA-自定义ID
对接VNFM的IP地址版本|根据实际情况配置为IPv4或者IPv6。
分权网元类型|本参数用于设置ZXUN uMAC的网元类型，在某些特殊运营商的要求下，才需要配置。本参数的配置原则：4/5G融合部署场景：本参数配置为MME/SGSN/AMF4G部署场景：本参数配置为MME/SGSN5G部署场景：本参数配置为AMF
启用虚机别名|ZXUN uMAC固定配置为不启用。如果本参数配置为启用，在部署成功后，NFVO/VNFM和EM上涉及到虚机名称的操作页面，某些虚机的名称会发生变化。
是否支持k8s部署方式|k8s全称kubernetes，k8s是一个docker容器管理工具，k8s是为容器提供服务的，是一个可移植容器的编排管理工具。在运营商的云计算服务为Caas时，该参数需要配置为启用，其他情况都需要配置为不启用。运营商可以提供的云计算服务如下。IaaS：基础设施即服务Infrastructure（基础设施）-as-a-ServicePaaS：平台即服务Platform（平台）-as-a-ServiceSaaS：软件即服务Software（软件）-as-a-ServiceCaas：通讯即服务Communications（通讯）-as-a-Service基础设施在最下端，平台在中间层，软件和通讯在顶层。CaaS是将传统电信的能力如消息、语音、视频、会议、通信协同等封装成API(Application Programming Interface，应用软件编程接口)或者SDK(Software Development Kit，软件开发工具包)通过互联网对外开放，提供给第三方（企业、SME、垂直行业、CP/SP以及个人开发者等等）使用，将电信能力真正作为服务对外提供。
OAM接入EMS的NAT IP地址|根据ZXUN uMAC的管理接口与EMS对接时的实际情况进行配置：如果两者之间需要通过防火墙，则此参数配置为管理接口的IP地址经过NAT转换后的地址。如果两者之间不需要通过防火墙，则此参数无需配置。
启用子接口VLAN Trunk|本参数仅适用于VIM云平台采用中兴通讯自研的TECS Openstack的场景。VLAN trunk是OpenStack社区发布的功能，标准叫法是VLAN-aware-VMs。VLAN Trunk是OpenStack社区提供的一种用于解决虚拟机接收/发送携带VLAN Tag的报文问题的技术方案。中兴通讯的VIM平台（TECS OpenStack）支持VLAN Trunk后，可以实现如下功能。减少虚拟机内部的虚拟机网卡数量为虚拟机提供接收/发送携带VLAN Tag报文的功能。主要应用场景是在NFVI层面上采用中兴通讯的VIM平台（TECS OpenStack）+SDN组网时，通过该功能实现动态增加外部网络平面的子接口的能力。比如某实际应用场景，某运营商原来已经部署了4G网络，后续需要升级成为4G和5G融合组网，对应需要增加5G网络的业务接口。就可以通过增加子接口的方式来实现。而不需要通过重新实例化部署来增加接口。本参数设置为启用后，表示会启用STU虚机的外部网络平面的VLAN Trunk功能。
命名空间|本参数通常情况下配置为默认值。
容器镜像仓库的项目名称|本参数通常情况下配置为默认值。
是否以root用户启动容器|本参数通常情况下配置为默认值。
仲裁服务节点数|本参数用于配置仲裁节点的个数。如果是OMU单机场景，不需要配置仲裁节点，此参数配置为固定值0。如果是OMU双机场景（即OMU采用1+1+1主备模式。其中，两个OMU虚机之间采用1+1主备，另外一个OMU用于这两个OMU虚机的主备仲裁），则此参数配置为3。如果在OMU双机场景下，某些运营商希望除了不仅在OMU上，同时在IPU虚机上也支持仲裁功能，则此参数需要配置为5，此种情况为某些运营商的特殊场景，通常情况下不涉及。
开启selinux容器功能|本参数通常情况下配置为默认值。
启用虚机规格别名|本参数通常情况下配置为默认值。
虚机规格调整时的重建方式|本参数通常情况下配置为默认值。
##### 资源命名规则 
资源命名规则如[图2]所示，用于配置ZXUN uMAC使用的虚拟资源的规范，需要根据各个运营商的实际情况进行配置。
图2  资源命名规则

##### vnf和vnfm的会话认证信息配置 
vnf和vnfm的会话认证信息配置如[图3]所示，建议使用默认值。
图3  vnf和vnfm的会话认证信息配置

vnf和vnfm的会话认证信息配置参数说明参见[表2]。
参数名称|参数含义
---|---
vnf和vmfm间会话协议类型|该参数用于配置VNF和VNFM之间的会话协议类型，VNF和VNFM之间支持双向认证，配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为http。如果运营商的部署环境，开启了安全加固功能，则此参数配置为https。
vnf向vmfm获取token|该参数用于设置VNF是否可以向VNFM获取token。token是计算机术语，表示令牌的意思，令牌是一种能够控制站点占有媒体的特殊帧，以区别数据帧及其他控制帧。通俗的说法，token可以称为暗号，在一些数据传输之前，服务端和客户端之间要先进行暗号的核对，不同的暗号会被授权不同的数据操作权限。Token是在服务端产生的。如果客户端使用用户名/密码向服务端请求认证，服务端认证成功，那么服务端会给客户端返回一个Token。客户端可以在每次发起请求消息时，携带Token证明自己的合法地位。该参数的配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为不启用。如果运营商的部署环境，开启了安全加固功能，则此参数配置为启用。
vnf向vmfm获取token的密码|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。该参数用于配置VNF向VNFM获取token时，使用的VNFM的用户名和密码。VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其他用户，参见“在VNFM上创建API用户”。需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。
vnf向vmfm获取token的用户名|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。该参数用于配置VNF向VNFM获取token时，使用的VNFM的用户名和密码。VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其他用户，参见“在VNFM上创建API用户”。需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。
##### 看门狗配置 
看门狗配置如[图4]所示，建议使用默认值。
图4  看门狗配置

看门狗配置参数说明参见[表3]。
参数名称|参数含义
---|---
镜像看门狗超时措施|本参数用于设置启用镜像watchdog功能后，自动触发的动作（watchdog_action）。ZXUN uMAC定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。
虚机看门狗超时措施|本参数用于设置启用虚机watchdog功能后，自动触发的动作（watchdog_action）。ZXUN uMAC定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。
虚机看门狗监控时长(分钟)|该功能用于设置虚机看门狗超时（watchdog_enabledelay）时长，默认值为600000毫秒，即10分钟。通常情况下建议使用默认值。该时长是VM启动后，到首次喂狗动作之间的时间间隔，如果超过这个间隔没有进行喂狗操作，则会触发watchdog_action的动作。如果虚机看门狗触发动作（watchdog_action）配置为reset，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM会主动复位虚机。如果虚机看门狗触发动作（watchdog_action）配置为none，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM不会执行复位虚机的操作。
##### 网络QoS配置 
网络QoS配置如[图5]所示。
图5  网络QoS配置

网络QoS配置参数说明参见[表4]。
参数名称|参数含义
---|---
网络QoS策略名|该参数用于设置网络QoS策略的名称，网络QoS策略用于配置对硬件服务器的网卡进行限速的策略。运营商可以定义多个网络QoS策略模板，每个网络QoS策略模板都设置一个对应的名称，每个虚机都可以配置一个对应的网络QoS策略模板，该网络QoS策略可以对虚机中的各个网卡进行限制。|网络QoS策略名
出口|双向最大带宽|该参数用于配置硬件服务器网卡出口的双向最大带宽。
双向最大突发带宽|出口|该参数用于配置硬件服务器网卡出口的双向最大突发带宽。
入口|双向最大带宽|该参数用于配置硬件服务器网卡入口的双向最大带宽。
双向最大突发带宽|入口|该参数用于配置硬件服务器网卡入口的双向最大突发带宽。
##### 存储QoS配置 
存储QoS配置参数如[图6]所示。
图6  存储QoS配置

存储QoS配置参数说明参见[表5]。
参数名称|参数含义
---|---
存储QoS策略名|该参数用于设置存储QoS策略的名称，存储QoS策略用于配置VIM云管理平台上创建的云硬盘的读写策略。运营商可以定义多个存储QoS策略模板，每个存储QoS策略模板都设置一个对应的名称，每个虚机都可以配置一个对应的存储QoS策略模板，该存储QoS策略可以对虚机对应的在VIM云管理平台上创建的云硬盘的读写策略进行限制。只有当每种类型的虚机的参数磁盘类型设置为云硬盘时，即为在运营商的实际组网环境使用云硬盘（即部署了后端存储设备）进行数据存储的情况下，才涉及到该参数的配置，如果运营商不使用后端存储设备，使用服务器主机的硬盘作为数据存储的设备的情况下，请忽略此配置。
云盘类型|该参数是指运营商操作员预先在VIM云管理平台（例如中兴通讯公司的TECS OpenStack 或其他厂商的云平台软件，例如Vmware等）上创建的云硬盘对应的名称，用于给虚拟机分配数据存储空间。该参数的值必须与VIM云管理平台上创建的云硬盘类型的名称相同。
总读写速度(字节/秒)|该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写速度。
总读写IOPS（次/秒）|该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写IOPS。
##### 网络组配置 
如果运营商规则的组网环境需要启用SR-IOV Bond，则需要配置网络组。 
当ZXUN uMAC部署为AMF时，不需要启用SR-IOV功能，因为AMF是管理控制面数据的NF，只负责处理信令消息，并不需要很高的带宽，通常情况下，AMF只使用DVS网卡就可以满足性能要求了。
网络组配置如[图7]所示。
图7  网络组配置

网络组配置参数说明参见[表6]。
参数名称|参数含义
---|---
网络组名称|网络组是指两个逻辑网络平面的集合，一个网络组中包括有两个逻辑网络平面，这两个网络平面可以相同也可以不同，可以归属相同的物理网络，也可以归属于不同的物理网络。此处创建的网络组，用于被虚机的vNIC（虚拟网卡）关联使用。当某个虚机的虚拟网卡关联了一个网络组后，在此虚机实例化成功，并创建vNIC（虚拟网卡）时，VIM平台则会按照网络组中的两个逻辑网络平面，分别创建对应的虚拟网卡，即一个虚机会创建两个vNIC（虚拟网卡）。
网卡亲和/反亲和策略|该参数用于设置虚机实例化后成后生成的vNIC具体关联哪个物理网卡。策略不开启设置为此选项，表示ZXUN uMAC对此没有特定的限制，虚机实例化后成后生成的vNIC具体关联哪个物理网卡由VIM云平台的配置策略决定。网卡亲和设置为此选项，表示某个虚机实例化后成后生成的两个vNIC，ZXUN uMAC会将两者关联到同一个物理网卡。网卡反亲和设置为此选项，表示某个虚机实例化后成后生成的两个vNIC，ZXUN uMAC会将两者分别关联到不同的物理网卡。
网络名称1~2|该参数用于配置一个网络组里包括的网络平面，该参数是在VIM云平台预先定义好的逻辑网络平面名称，此处配置的两个网络名称可以相同，也可以不同。如果启用了VIM层面的虚拟网卡SR-IOV bond功能，则要求此处配置的两个网络平面必须相同。
##### 网络配置 
本页面需要配置ZXUN uMAC规划的所有网络平面及其对应的子网，此处配置的网络平面和子网，需要事先在在VIM云平台管理系统（本文档示例为中兴通讯的TECS
OpenStack）中已经创建成功，参见“[创建网络平面]”
。
本页面需要配置的网络平面的详细描述参见[表7]。
项目|网络平面名称|子网名称
---|---|---
admin|ZTE_EMS_NET|ZTE_EMS_NET_SUBNET|ZTE_EMS_NET
PROJ-uMAC-1|内部网络平面|ZTE_AMF_x_MGT_INT_NET|ZTE_AMF_x_MGT_INT_SUBNET
ZTE_AMF_x_SERV_INT_NET|PROJ-uMAC-1|内部网络平面|ZTE_AMF_x_SERV_INT_SUBNET
外部网络平面|PROJ-uMAC-1|ZTE_AMF_x_SIG_EXT_NET|ZTE_AMF_x_SIG_EXT_SUBNET
ZTE_AMF_x_MEDIA_EXT_NET|外部网络平面|PROJ-uMAC-1|ZTE_AMF_x_MEDIA_EXT_SUBNET
网络配置参数说明参见[表8]。
参数名称|参数含义
---|---
网络名称|该参数用于设置此网络平面对应的名称，根据表7中的规划数据，ZXUN uMAC使用了5个网络平面。ZTE_EMS_NETZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NETZTE_AMF_x_SIG_EXT_NETZTE_AMF_x_MEDIA_EXT_NET|该参数用于设置此网络平面对应的名称，根据表7中的规划数据，ZXUN uMAC使用了5个网络平面。ZTE_EMS_NETZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NETZTE_AMF_x_SIG_EXT_NETZTE_AMF_x_MEDIA_EXT_NET
网络用途|各个网络平面的网络用途规定如下：ZTE_EMS_NET需要设置为OAM通信。ZTE_AMF_x_MGT_INT_NET需要设置为内部管理通信ZTE_AMF_x_SERVICE_INT_NET需要设置为内部服务通信所有的外部网络平面需要设置为外部业务通信|各个网络平面的网络用途规定如下：ZTE_EMS_NET需要设置为OAM通信。ZTE_AMF_x_MGT_INT_NET需要设置为内部管理通信ZTE_AMF_x_SERVICE_INT_NET需要设置为内部服务通信所有的外部网络平面需要设置为外部业务通信
是否预定义网络|如果此网络平面是通过“创建网络平面”操作创建的，则该网络平面为预定义网络平面，需要设置为启用。如果此网络平面规划是在实例化ZXUN uMAC的过程中，由系统自动创建的，则该网络平面不是预定义网络平面，需要设置为不启用。本文档规划所有的网络平面都是预先在VIM云平台中创建的，该参数建议设置为默认值启用。|如果此网络平面是通过“创建网络平面”操作创建的，则该网络平面为预定义网络平面，需要设置为启用。如果此网络平面规划是在实例化ZXUN uMAC的过程中，由系统自动创建的，则该网络平面不是预定义网络平面，需要设置为不启用。本文档规划所有的网络平面都是预先在VIM云平台中创建的，该参数建议设置为默认值启用。
最大传输单元(MTU)|该参数表示各个网络平面的MTU数值。在运营商没有特殊要求的情况下，建议使用默认值1500。如果运营商有特殊要求，建议根据运营商的要求设置。|该参数表示各个网络平面的MTU数值。在运营商没有特殊要求的情况下，建议使用默认值1500。如果运营商有特殊要求，建议根据运营商的要求设置。
安全组名称|安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（SecurityGroup Rule）。需要预先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组的情况下，该参数的值才会生效。|安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（SecurityGroup Rule）。需要预先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组的情况下，该参数的值才会生效。
网络类型|当是否预定义网络设置为不启用时，这些参数才需要配置。在本文档规划场景中，ZXUN uMAC所有的网络平面都需要预先在VIM云平台中创建，不涉及这些参数的配置|该参数用于设置网络平面的网络类型，需要根据运营商的实际网络环境进行设置，包括以下两个选项。vlan如果运营商的组网环境为非SDN，建议设置为vlan。设置为此选项时，还需要设置物理网络名称和是否启用VLAN透传两个参数。vxlan如果运营商的组网环境为SDN，建议设置为vxlan。VXLAN是一种网络虚似化技术，是对VLAN技术的进一步优化，VXLAN 提供和VLAN相同的二层网络服务，但相比VLAN有更大的扩展性和灵活性，用于解决在部署大型云计算设备时的数量扩展问题。通常情况下，外部网络平面需要启用VLAN透传（比如本文档规划的ZTE_AMF_x_SIG_EXT_NET）。
物理网络名称|当网络类型设置为vlan时，必须设置该参数。建议使用默认值。|当是否预定义网络设置为不启用时，这些参数才需要配置。在本文档规划场景中，ZXUN uMAC所有的网络平面都需要预先在VIM云平台中创建，不涉及这些参数的配置
是否启用VLAN透传|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面是否支持VLAN透传功能。通常情况下，外部网络平面都需要启用VLAN透传。|当是否预定义网络设置为不启用时，这些参数才需要配置。在本文档规划场景中，ZXUN uMAC所有的网络平面都需要预先在VIM云平台中创建，不涉及这些参数的配置
网络可用域|缺省值为空。当配置多个网络可用域时，使用逗号隔开，非特殊场景不配置。|缺省值为空。当配置多个网络可用域时，使用逗号隔开，非特殊场景不配置。
 说明： 
如果info文件中创建的网络平面个数少于规划的个数（比如，页面只显示了网络1~4，但需要配置5个网络平面），需要操作员使用可编辑.xml格式的软件（如Notepad++）打开info文件，在文件中手工增加网络平面的个数。 
各个网络平面对应的子网配置参数说明参见[表9]。
参数名称|参数含义
---|---
子网名称|该参数用于设置此网络平面的子网名称。
子网描述|对子网的补充说明，非必选参数，操作员可根据实际情况设置。
网络地址|表示网络平面的子网地址，在为各个网络平面规划IP地址时，所有网络平面都不能使用172.17.0.0/16地址段中的IP地址。
IP地址类型|根据运营商的实际场景，选择为IPv4或者IPv6。
网关地址|根据实际情况配置。
双栈子网名称|当IP地址类型设置为IPv6时，需要设置这些参数，目前，只有外部网络平面的子网支持双栈。
双栈网络地址|当IP地址类型设置为IPv6时，需要设置这些参数，目前，只有外部网络平面的子网支持双栈。
双栈网关地址|当IP地址类型设置为IPv6时，需要设置这些参数，目前，只有外部网络平面的子网支持双栈。
根据本文档规划的多个网络平面及其子网，配置示例如下。 
ZTE_AMF_x_MGT_INT_NET网络配置示例参见[图8]。
图8  ZTE_AMF_x_MGT_INT_NET网络配置示例

ZTE_AMF_x_SERV_INT_NET网络配置示例参见[图9]。
图9  ZTE_AMF_x_SERV_INT_NET网络配置示例

ZTE_EMS_NET网络配置示例参见[图10]。
图10  ZTE_EMS_NET网络配置示例

ZTE_AMF_x_SIG_EXT_SUBNET网络配置示例参见[图11]。
图11  ZTE_AMF_x_SIG_EXT_SUBNET网络配置示例

ZTE_AMF_x_MEDIA_EXT_SUBNET网络配置示例参见[图12]。
图12  ZTE_AMF_x_MEDIA_EXT_SUBNET网络配置示例

#### 网元配置 
##### 网元配置 
网元配置参数如[图1]所示。
图1  网元配置

网元配置参数说明参见[表1]。
参数名称|参数含义
---|---
产品类型|5G组网时配置为AMF，4G和5G融合组网时，配置为Common AMF/MME/GnGp SGSN。
协议规定的网元类型|表示ZXUN uMAC的网元子类型，无需配置。
VNF业务场景|该参数无需配置，取值是配置的参数场景决定的。
部署配置脚本文件名称|特殊运营商的定制需求，一般情况下不需要设置。
key_xx|该值暂不涉及。
##### UDSF配置 
UDSF配置参数如[图2]所示。
图2  UDSF配置

网元配置参数说明参见[表1]。
参数名称|参数含义
---|---
租户ID|本参数建议配置为固定值1。
租户名称|本参数建议根据实际情况配置。
虚机规格|本参数用于配置CDB虚机规格。CDB虚机规格：测试局：100# CDB-C-C2M8 (2 vCPU/8G RAM/30G HD)商用局：101# CDB-C-C4M32 (4 vCPU/32G RAM/30G HD)大容量商用局使用：102# CDB-C-C4M48 (4 vCPU/48G RAM/30G HD)
初始数量|本参数用于配置CDB虚机初始数量。
最大数量|本参数用于配置CDB虚机最大数量。
主用NF|该参数用于设置ZXUN uMAC的局号。取值范围：1~255之间的整数，需要根据运营商的规划来设置。规划原则：在同一个NFVO之内的各个NF的局号不能相同。在一个大区内及其容灾大区内同一类型的NF的局号不能相同，在特殊情况下，如果同一类型的NF的个数超过255，只需要保证有容灾关系的NF的局号不相同即可。
容灾NF|该参数用于设置容灾ZXUN uMAC的局号。根据相关容灾规划填写，无容灾NF时，本参数配置为0。
分片算法|本参数建议根据实际情况配置。
##### Interception配置 
在不开启安全网关功能的情况下，该部分内容不涉及配置，保持默认值即可。 
图3  Interception配置

#### AMF的虚机 
##### OMU虚机配置 
###### OMU虚机配置 
OMU虚机配置如[图1]所示。
图1  OMU虚机配置

OMU虚机配置参数说明参见[表1]。
参数名称|参数含义
---|---
虚机逻辑类型|OMU虚机的逻辑类型固定设置为OMU。
虚机优先级|该参数用于设置在实例化过程中，该种类型的虚机创建资源的优先级，数字越小表示优先级越高。建议所有的虚机都使用默认值1，表示实例化ZXUN uMAC时，所有的虚机的优先级都为最高，并行创建所有虚机及相关资源。
虚拟机启动优先级|本参数用于设置虚拟机启动上电的优先级。取值范围为1~10，数值1表示优先级最高，数值10表示优先级最低，虚拟机启用时，每个主机根据虚拟机对应的优先级进行处理，优先级高的虚拟机先上电，优先级低的虚拟机后上电，一般情况下，建议将OMU和AMU的优先级设置为1。
虚机可用域|该参数用于配置OMU虚机所属的可用域（Availability Zones），可用域是通过VIM云平台管理系统（如中兴通讯的TECSOpenStack）设置的。在VIM云平台没有设置可用域的场景下，不需要配置该参数。可用域（AvailabilityZones）可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域是一个面向终端客户的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。如果VIM云平台管理系统（如中兴通讯的ZTE TECS OpenStack）没有启用可用域（Availability Zones）功能，该参数暂时不涉及，无需配置。在配置此项参数前，需要先通过ZTE TECS OpenStack云平台管理系统查询已经配置成功的域名。操作员使用SSH方式登录到控制节点的操作系统。在keystonerc_admin配置模式下，使用nova aggregate-list，查看ZTE TECS OpenStack上已经配置的域名。通常情况下，ZTE TECS OpenStack上配置的域有如下四类：控制域：云平台（例如ZTE TECS OpenStack）使用MANO域：MANO（例如CloudStudio）使用转发域（媒体面）：提供转发消息功能的虚机使用计算域：其它所有网元的虚机共用
###### 虚机规格数量配置 
虚机规格数量配置如[图2]所示。
图2  虚机规格数量配置

虚机规格数量配置参数说明参见[表2]。
参数名称|参数含义
---|---
虚机外部类型|此参数在特殊运营商的场景下才需要设置，通常情况下不涉及。
内存回收水线(KB)|该参数用于设置虚拟机的内存可用门限，当虚机当前可用内存低于本参数设定的门限值时，系统会自动回收cache内存，释放一定的内存，以缓解系统可用内存紧张的情况。该参数建议设置为默认值。
虚机最大虚拟内存空间|该参数用于设置虚机的最大虚拟内存空间。
虚机规格|表示单个OMU虚机的规格，OMU虚机有多种规格，以OMU-C4 (4 vCPU/12G RAM/110GHD)为例进行说明，设置为该选项，表示在实例化ZXUN uMAC的过程中，单个OMU虚机占用的vCPU个数为4，占用的内存为12GB，占用的硬盘容量为110 GB。OMU的工作模式固定为1+1主备模式，系统默认生成2个OMU虚机。
虚机初始个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始OMU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统最大可弹性扩展（ScaleOut）的OMU虚机个数。OMU的工作模式固定为1+1主备，系统默认生成2个OMU虚机。OMU不支持弹性伸缩（Scale In和Scale Out），如果是商用局，这两个参数固定设置为2，如果是测试局，建议将这两个参数固定设置为1。这里的OMU最大个数是每种规格对应的虚机最大个数的总和。
虚机最大个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始OMU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统最大可弹性扩展（ScaleOut）的OMU虚机个数。OMU的工作模式固定为1+1主备，系统默认生成2个OMU虚机。OMU不支持弹性伸缩（Scale In和Scale Out），如果是商用局，这两个参数固定设置为2，如果是测试局，建议将这两个参数固定设置为1。这里的OMU最大个数是每种规格对应的虚机最大个数的总和。
主机列表|该参数用于配置将虚机部署在指定的主机（即物理刀片）上，需要设置为VIM平云台所配置的计算节点的名称。该参数通常情况下，不需要设置，使用默认值即可。
虚拟规格别名|此参数在特殊运营商的场景下才需要设置，通常情况下不涉及。
###### 硬盘分区配置 
在配置此部分内容之前，需要了解相关概念。 
运营商可以提供的云计算服务如下。 
IaaS：基础设施即服务Infrastructure（基础设施）-as-a-ServiceIaaS会提供场外服务器，存储和网络硬件，可供租用。 
PaaS：平台即服务Platform（平台）-as-a-ServicePaaS可以在网络上提供各种开发和分发应用的解决方案，比如虚拟服务器和操作系统，网页应用管理，应用设计，应用虚拟主机，存储，安全以及应用开发协作工具等。 
SaaS：软件即服务Software（软件）-as-a-ServiceSaaS，大多是通过网页浏览器来接入。任何一个远程服务器上的应用都可以通过网络来运行。 
Caas：通讯即服务Communications（通讯）-as-a-ServiceCaaS是将传统电信的能力如消息、语音、视频、会议、通信协同等封装成API(Application
Programming Interface，应用软件编程接口)或者SDK(Software Development Kit，软件开发工具包)通过互联网对外开放，提供给第三方（企业、SME、垂直行业、CP/SP以及个人开发者等等）使用，将电信能力真正作为服务对外提供。  
基础设施在最下端，平台在中间层，软件和通讯在顶层。 
硬盘分区配置如[图3]所示。
图3  硬盘分区配置

硬盘分区配置参数说明参见[表3]。
参数名称|参数含义
---|---
PAAS数据分区大小|建议采用默认值 。
PAAS Docker分区大小|建议采用默认值 。
###### 亲和/反亲和策略配置 
背景知识
在虚拟化环境中，将硬件物理服务器（刀片）称为主机（HOST），运行在主机上的虚拟机称为VM。 
虚拟机部署策略是指是否支持将一个虚拟机组（Server-group）中的多个虚机分别部署在ZXUN uMAC所在可用域（Availability Zones）AZ的同一个主机（此处指计算节点）上还是不同的主机上，部署的主机必须属于同一个主机集合（Host
Aggregates）。
ZXUN uMAC通过将虚拟机配置到不同的Server-group来实现虚拟部署功能的。
虚拟机组（Server-group）是指按相同策略（如亲和策略、互斥策略）进行部署的虚拟机集合。亲和组、互斥组、软亲和组、软互斥组是操作员根据虚拟机的不同特性创建的组类别。按亲和策略部署的虚拟机的集合称为亲和组，按互斥策略部署的虚拟机的集合称为互斥组（反亲和组）。 
属于同一个虚拟机组（Server-group）的虚机满足相同的策略限制（包括亲和组、互斥组、软亲和组、软互斥组），以互斥组示例说明，归属于同一个互斥组之内的虚机不能部署在同一个主机（即硬件物理服务器）上，不同互斥组之间的虚机没有互斥关系，不受限制，各种策略的详细描述参见[表4]。
部署策略|定义|适用场景
---|---|---
亲和（affinity）|将一个虚拟机组（Server-group）中的多个虚拟机部署在同一个主机（计算节点）上|运营商需要最大限度利用硬件资源，或者虚拟机间需要共享使用同一个物理主机上的某种资源时，需将虚拟机集中部署在同一台计算节点上。ZXUN uMAC的虚拟机目前不涉及到此种使用场景。
互斥（anti-affinity）|互斥也称为反亲和，指将一个虚拟机组（Server-group）中的多个虚拟机分散部署在不同的主机（计算节点）上|运营商为了达到备份容灾的目的，往往需要将同一种类型（比如互为备份、互为负荷分担的）多个虚拟机分别部署在ZXUN uMAC网元所在域中的不同的主机（此处指计算节点）上，以实现虚拟机的高可用性。比如部署了两个虚拟机，一个作为主用虚拟机，一个作为备用虚拟机。当主用虚拟机异常时，可以在备用虚拟机上继续业务功能。如果这两个虚拟机都部署在同一台主机（计算节点）上，由于硬件问题导致整个主机出现故障，此时主备虚拟机都将陷入异常，业务也将无法正常工作。所以需要将虚拟机分散部署在不同的主机上。
软互斥（Soft anti-affinity）|在实际情况中，如果计算资源不够（即主机个数小于一个Server-group中的虚机个数），在这种情况下，如果定义为互斥部署策略，因为主机个数不能满足将一个Server-group中的多个虚机分散部署，会导致实例化失败。例如：实际环境中主机的个数为5，IPU虚机的个数为8，如果采用互斥部署策略，PFU虚机需要平均部署在8台主机上，由于主机个数达不到8，会导致实例化失败。在这种情况下，为了避免实例化失败，可以采用软互斥部署策略，即按如下原则进行部署。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。软互斥可以理解为：在硬件条件不满足的情况下，尽量将虚拟机进行分散部署的一种策略。软互斥是一种虚机分散部署策略。|运营商的主机资源不够，在这种情况下，如果需要部署为互斥策略，但同时不能因为主机资源不够，导致部署失败，尽可能将这些虚拟机部署在不同的计算节点上。软互斥通常用于在主机集合Host Aggregates（即物理环境中的机框）这个范围内，尽量分散部署虚拟机。此种情况适用于将虚机部署在多个机框的主机上的场景。
软亲和（Soft affinity）|软亲和部署策略与软互斥部署策略相反。软亲和是一种虚机集中部署策略，即按如下原则进行部署。在计算资源充足（主机个数足够）的情况下，多个虚拟机部署在同一个计算节点上。在计算资源不足情况下，允许将多个虚拟机部署在不同计算节点上。|ZXUN uMAC的虚拟机目前不涉及到此种使用场景。
 说明： 
亲和又称为不互斥。 
互斥又称为反亲和。 
配置说明
亲和策略配置如[图4]所示。
图4  亲和策略配置

亲和策略配置参数说明参见[表5]。
参数名称|参数含义
---|---
亲和策略|亲和类型|该参数用于控制是否将一个虚拟机组（Server-group）中的多个OMU虚机分别部署在不同的主机上。包括如下选项：不限制表示系统不对OMU虚机部署进行限制，即OMU虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。对于OMU虚机，不建议配置为该选项。反亲和设置为此选项，表示系统需要对OMU虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个OMU必须分散部署在ZXUN uMAC所在可用域（Availability Zones）的不同主机上。OMU虚机的备份方式为1+1主备方式，如果两个OMU虚机部署到同一个主机上，该主机宕机时，会导致ZXUN uMAC故障，因此OMU虚机必须设置为反亲和。设置为该参数后，操作员还可以通过反亲和组名来设置互斥组的名称。软反亲和设置为此选项，表示系统需要对OMU虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。
反亲和组个数|亲和策略|反亲和组个数即为互斥组个数，当虚机的部署策略设置为反亲和时，才会涉及到该参数的配置。简单来说，本参数决定了单个主机上所能部署的虚机的最大个数，即如果该参数设置为1，则单个主机上只能部署一个虚机，如果该参数设置为2，则单个主机上最多只能部署两个虚机。该参数设置为1，表示所有的虚机都在一个互斥组中，即这个互斥组中的每个虚机都必须分散部署在不同的主机上。在这种情况下，实际环境中的主机个数必须大于等于虚机的个数，否则就会部署失败，实例化不成功。该参数设置为2，表示所有的虚机平均分布在两个互斥组中，即每个互斥组中的虚机都必须分散部署在不同的主机上，但是组间的IPU虚机无需互斥部署。示例：如果部署了10个虚机，则1~5在一个互斥组中，6~10在一个互斥组中，其中1~5必须部署在不同的主机上，6~10必须部署在不同的主机上，但是5和7、3和8...，分别属于两个互斥组的虚机可以部署在同一个主机上。这种情况下，实际环境中的主机个数必须大于等于5个，否则就会部署失败，实例化不成功。
反亲和组名|亲和策略|该字段已弃用。
亲和组规则|同组每主机部署虚机上限|本参数用于设置同在一个亲和组内的虚拟机可以部署在同一台主机上的最大个数。
###### 硬盘配置 
硬盘配置如[图5]所示。
图5  硬盘配置

硬盘配置参数说明参见[表6]。
参数名称|参数含义
---|---
磁盘类型|该参数用于设置ZXUN uMAC是否使用后端类型（如磁阵或Ceph）作为数据存储的设备，包括两个选项：本地硬盘。不使用磁阵，使用服务器主机的硬盘作为数据存储的设备的情况下，需要设置为该选项。云硬盘在运营商的实际组网环境使用云硬盘（即部署了磁阵设备）进行数据存储的情况下，需要设置为该选项，通常情况下，该参数需要设置为云硬盘。设置为该选项时，还需要设置云硬盘类型和云盘可用域。系统盘本地盘，数据盘云硬盘系统盘的数据使用使用服务器主机的硬盘进行存储，数据盘的数据使用云硬盘（即部署了磁阵设备）进行存储。
云硬盘类型|云硬盘类型是在VIM云管理平台（例如中兴通讯的TECS OpenStack）中设置的磁阵资源名称。
云盘可用域|该参数暂不涉及，无需配置。
vim上cinder.conf中设定的后端存储名称|该参数用于配置在VIM云管理平台（例如中兴通讯的TECS OpenStack）中设置的后端存储中分配云硬盘，这个后端存储是由cinder管理的。该参数建议使用默认值。
是否启用删除虚拟机不删除数据盘|该参数用于设置在删除虚拟机的情况下，是否同步需要删除虚拟机对应的数据盘（数据盘一般是存储在VIM中）。
###### 虚机网卡配置 
AMF的各种类型的虚机需要关联的网络平面不同，详细内容参见[表7]。
VM|网络平面
---|---
OMU|ZTE_EMS_NET
ZTE_AMF_x_MGT_INT_NET|OMU
ZTE_AMF_x_SERV_INT_NET|OMU
GSUCDUAMU|ZTE_AMF_x_MGT_INT_NET
ZTE_AMF_x_SERV_INT_NET|GSUCDUAMU
IPU|ZTE_AMF_x_MGT_INT_NET
ZTE_AMF_x_SERV_INT_NET|IPU
ZTE_AMF_x_SIG_EXT_NET|IPU
ZTE_AMF_x_MEDIA_EXT_NET|IPU
OMU虚机网卡配置如[图6]所示。
图6  OMU虚机网卡配置

OMU虚机网卡配置参数说明参见[表8]。
参数名称|参数含义
---|---
关联网络名称|该参数的取值有两种情况：设置为通用页面中，配置的网络平面。此种情况下此参数表示OMU虚机关联的网络平面，不同类型的虚机关联的逻辑网络平面不相同，当OMU虚机关联单个平面时，本文档规划需要关联的网络平面如下。ZTE_EMS_NETZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NET设置为通用页面中，配置的网络组。因为一个网络组实际上对应了两个网络平面，若某个虚机网卡关联了一个网络组，则实例化后，会在两个网络平面分别部署出一个虚拟网卡，这两个虚机网卡之间的关系，可以通过双端口工作模式来设置。
双端口工作模式|当某个虚机关联了一个网络组后，在此虚机实例化成功，并创建vNIC（虚拟网卡）时，则会按照网络组中的两个逻辑网络平面，分别创建对应的vNIC（虚拟网卡）。即一个虚机会创建两个vNIC。这两个vNIC可以通过本参数设置两者之间的关系，包括以下类型：单网口表示这两个vNIC不启用SR-IOV bond。TECS双端口绑定表示这两个vNIC可以在VIM层面（仅限于中兴通讯的TECS OpenStack）启用SR-IOVbond。此选项只适用于内部媒体面（ZTE_AMF_x_SERV_INT_NET）和所有的外部业务网络平面。APP层绑定表示这两个vNIC可以在VNF层面（即ZXUN uMAC）启用SR-IOVbond。此选项只适用于除了外部业务网络平面之外的其他网络平面。VIM层绑定（3rd VIM）此选项只适用于在第三方厂商的VIM云平台产品（如RedHat OSP）部署ZXUN uMAC时场景。路由负荷分担表示两个vNIC之间的关系为负荷分担。路由负荷分担可以理解为两个独立的通信链路，互相之间没有影响。此选项只适用于内部媒体面（ZTE_AMF_x_SERV_INT_NET）和外部业务网络平面。
网卡类型|表示此逻辑网络平面对应的网卡类型：virtio：表示虚拟网卡启用OVS/DVS。SR-IOV：表示虚拟网卡启用SR-IOV。当设置为此参数时，还需要设置双端口工作模式和SRIOV网卡备份模式两个参数。
SRIOV网卡备份模式|该参数用于设置SR-IOV网卡的备份模式。该参数包括四个选项，分为两种类型：单网口和双网口。单网口即为不启用SR-IOV bond，双网口即启用SR-IOVbond。单网口双网口主备双网口无协商模式负荷分担双网口LACP协商模式负荷分担双网口又分为三种情况：包括双网口主备、双网口无协商模式负荷分担和双网口LACP协商模式负荷分担。该参数的配置原则如下：当双端口工作模式配置为TECS双端口绑定时（只适用中兴通讯的TECS OpenStack），该参数只能设置为双网口主备、双网口无协商模式负荷分担和双网口LACP协商模式负荷分担三个选项中的一种，具体选择哪一种，需要与TECSOpenStack的配置数据一致，TECS OpenStack上配置的是哪一种，此处就需要设置为哪一种。当双端口工作模式配置为APP层绑定时，该参数只能设置为双网口主备。当双端口工作模式配置为路由负荷分担时，该参数只能设置为单网口。
网卡带宽|建议使用默认值。
主机IP地址列表|该参数用于配置部署在ZTE_EMS_NET网络平面的OMU虚机的IP地址。配置原则：默认实例化成功后的2个OMU需要部署在2个主机上，该参数用于设置两个主机的IP地址。ZTE_EMS_NET网络平面需要与运营商的维护网络通信，需要设置为与运营商的维护网络同网段的地址，两个地址之间使用逗号隔开。此处配置的IP地址个数不能小于OMU的最大个数，否则会导致实例化不成功。如果规划为2个虚机，则地址配置为A,B。示例：两个OMU虚机，此处设置为170.101.22.129,170.101.22.130。
浮动IP地址|该参数用于配置IPv4格式的ZTE_EMS_NET网络平面的OMU虚机的浮动IP地址。OMU虚机为1+1主备模式，通常情况下，需要在ZTE_EMS_NET网络平面（即对外的网管平面）配置一个浮动IP地址。OMU虚机的ZTE_EMS_NET网络平面的浮动IP地址需要和主机IP地址列表的中配置的IP地址在同一网段，注意：IP地址需要配置掩码，如170.101.22.130/24，否则会导致实例化不成功。通常情况下，只需要为OMU虚机的ZTE_EMS_NET网络平面配置浮动IP地址，其他虚机的网络平面都不需要配置此参数。
双栈浮动IP地址|该参数用于配置IPv4v6格式的ZTE_EMS_NET网络平面的OMU虚机的浮动IP地址。该参数的配置原则与浮动IP地址相同。当OMU虚机ZTE_EMS_NET网络平面支持IPv4v6双栈时，使用本参数配置的浮动地址。
是否启用端口安全组|该参数的配置原则如下：在VIM云管理平台（如中兴通讯的TECS OpenStack）没有开启安全组配置数据的情况下，ZXUN uMAC暂时不涉及此部分参数，无需配置，保持默认值。在VIM云管理平台（如中兴通讯的TECS OpenStack）开启安全组配置数据的情况下，该参数需要设置为否。
###### 虚机参数配置 
虚机参数配置如[图7]所示。
图7  虚机参数配置

虚机参数配置参数说明参见[表9]。
参数名称|参数含义
---|---
虚机扩展参数|HA参数列表|该参数建议采用默认值。该参数用于设置是否启用与主机集合（Host Aggregates）相关的功能。主机集合（Host Aggregates）是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是制定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。
vCPU规格|虚机扩展参数|该参数建议采用默认值。该参数用于指定要创建的虚拟机所使用的具体的CPU型号。通常应用于异地迁移虚拟机的场景，比如把虚拟机从新型号CPU的服务器往旧型号CPU的服务器上迁移时，需要通过本参数来指定虚拟机所使用的CPU类型。
启用扩展参数|虚机扩展参数|该参数建议设置为是。
hw:numa_nodes|虚机扩展参数|该参数建议采用默认值。部署在同一NUMA上是为了提高性能，避免跨NUMA调度。hw:numa_nodes是用于指定虚机使用的NUMA节点数。hw:numa_nodes的取值表示不大于计算节点的NUMA节点个数的整数，通常取值为1和2。hw:numa_nodes取值为1：表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。
hw:mem_page_size|虚机扩展参数|该参数建议采用默认值。该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。取值范围为large、any、small/4/4KB、2048/2048KB/2MB、1048576/1GB中的任何一个。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：只使用巨页，目前主机支持的巨页只有1G和2M两种，即只从这两种页面选择。small/4/4KB：三者含义一致，配置为其中任何一个值时都只使用小页，即只选择4KB大小的页面。2048/2048KB/2MB：三者含义一致，配置为其中任何一个值时都是只选择2MB的页面。1048576/1GB：二者含义一致，配置为其中任何一个值时都是只选择1GB的页面。
hw:cpu_policy|虚机扩展参数|该参数建议采用默认值。该参数用于在虚拟机部署时指定其绑核策略，从而使虚拟机进行NUMA亲和绑定。取值为shared或dedicated，配置原则如下：shared：表示虚拟机分配在同一NUMA节点上的多个虚拟CPU共享该NUMA节点上主机的所有可用物理CPU。dedicated：精确绑核，表示虚拟机的虚拟CPU与主机的物理CPU进行一对一绑定。虚拟CPU使用本节点上的内存仅仅提升了虚拟CPU访问内存的速度，而虚拟机的虚拟CPU在主机的各个物理CPU上运行，要达到更好的性能，需要将虚拟机的虚拟CPU与主机的物理CPU进行绑定。
hw:cpu_max_sockets|虚机扩展参数|该参数建议采用默认值。该参数用于设置虚拟机最大可使用的socket数。某个虚机需要的核数过多时，会同时占用多个socket上的虚拟CPU资源，该参数可以限制虚机最大可使用的socket数量。
TECS私有参数|启用TECS私有参数|该参数用于是否启用中兴通讯的TECS OpenStack相关的一些配置参数。如果VIM云管理平台使用中兴通讯的TECS OpenStack，则该参数建议设置为是。如果VIM云管理平台使用第三方厂家的系统，则该参数建议设置为否。
hw:numa_pci|TECS私有参数|当启用启用TECS私有参数设置为是，本参数的配置值才会生效。使用SR-IOV网卡的虚机会默认使用物理服务器的PCI设备，且在这个虚机中配置NUMA亲和功能时，默认要求使用的PCI设备需要和CPU及内存在同一NUMA节点上。此时可以根据实际需求，通过hw:numa_pci的值决定PCI设备是否与CPU及内存分配在同一NUMA节点，包括如下选项。取值为TRUE：表示虚机使用跟CPU及内存在同一NUMA节点上的PCI设备，不使用各个NUMA节点共有的PCI设备。计算节点的PCI设备，一般都有明确的NUMA位置，即属于某个具体的NUMA节点。一些较老的计算节点服务器，可能会出现PCI资源不属于某个NUMA节点，此时认为这些PCI设备为各个NUMA节点共有。取值为FALSE：表示虚机优先使用跟CPU及内存在同一NUMA节点上的PCI设备和各个NUMA节点公共的PCI设备，当这些PCI设备不足时，使用其他NUMA节点上的PCI设备。取值为未配置：表示虚机使用跟CPU及内存在同一NUMA节点上，或各个NUMA节点公共的PCI设备。该参数的配置原则如下：如果是STU虚机，该参数必须设置为TRUE。如果是其他类型的虚机，该参数必须设置为FALSE。
hw:high_performance|TECS私有参数|当启用启用TECS私有参数设置为是，本参数的配置值才会生效。该参数用于设置虚拟机需要的DVS高性能属性，详细描述如下：dvs_high：只选择DVS高性能网卡所在的NUMA节点。dvs_low：只选择不存在DVS高性能网卡的NUMA节点。dvs_high_prefer：优先选择DVS高性能网卡所在的节点，无相应资源时选择其它NUMA节点。dvs_low_prefer：优先选择不存在DVS高性能网卡的节点，无相应资源时选择DVS高性能网卡所在的NUMA节点。该参数的配置原则如下：如果是IPU虚机，该参数必须设置为dvs_high_prefer。如果是其他类型的虚机，该参数必须设置为dvs_low_prefer。
capabilities：flows|TECS私有参数|支持在flavor中定义所需弹性资源需求。
##### CDU虚机配置 


概述 :本节只介绍与CDU虚机相关的主要参数，其他没有说明的参数参见“[OMU虚机配置]”
。


###### CDU虚机配置 
CDU虚机配置主要参数说明参见[表1]。
参数名称|参数含义
---|---
虚机配置|虚机逻辑类型|CDU虚机的逻辑类型固定设置为CDU。
虚机规格数量信息|虚机规格|表示单个CDU虚机的规格，CDU虚机有多种规格。
虚机规格数量信息|虚机初始个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始CDU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统最大可弹性扩展（ScaleOut）的CDU虚机个数。CDU的工作模式固定为N+M互备模式，CDU虚机初始个数建议至少设置为2。
虚机规格数量信息|虚机最大个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始CDU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统最大可弹性扩展（ScaleOut）的CDU虚机个数。CDU的工作模式固定为N+M互备模式，CDU虚机初始个数建议至少设置为2。
亲和策略|亲和类型|该参数用于控制是否将一个虚拟机组（Server-group）中的多个CDU虚机分别部署在不同的主机上。包括如下选项：不限制表示系统不对CDU虚机部署进行限制，即CDU虚机可以随意部署在任意的主机上（即可以全部部署在一台主机上）。对于CDU虚机，不建议配置此种方式。反亲和反亲和就是互斥部署，CDU虚机的备份方式为N×(1+1)主备，即部署N组CDU虚拟机，每组中的两个CDU虚拟机为1+1互备。如果一组中的两个CDU虚机部署到同一个主机上，该主机宕机时，会导致CDU上的备份数据都丢失，因此CDU虚机必须设置为互斥部署。软反亲和设置为此选项，表示系统需要对虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。


###### CDU虚机网卡配置 
CDU虚机网卡配置如[图1]所示。
图1  CDU虚机网卡配置




CDU虚机网卡配置主要参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示CDU虚机关联的网络平面名称，CDU需要关联的网络平面如下。ZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NET


##### GSU虚机配置 


概述 :本节只介绍与GSU虚机相关的主要参数，其他没有说明的参数参见“[OMU虚机配置]”
。


###### GSU虚机配置 
GSU虚机配置主要参数说明参见[表1]。
参数名称|参数含义
---|---
虚机配置|虚机逻辑类型|GSU虚机的逻辑类型固定设置为GSU。
虚机规格数量信息|虚机规格|表示单个GSU虚机的规格，GSU虚机只有一种规格：GSU-Common-M4C2 (2 vCPU/4GRAM/30G HD)，表示在实例化ZXUN uMAC的过程中，单个GSU虚机占用的vCPU个数为2，占用的内存为4GB，占用的硬盘容量为30 GB。
虚机规格数量信息|虚机初始个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始GSU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统生成的最大可弹性伸缩的GSU虚机个数。GSU的工作模式固定为1+1主备，GSU虚机初始个数建议至少设置为2。
虚机规格数量信息|虚机最大个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始GSU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统生成的最大可弹性伸缩的GSU虚机个数。GSU的工作模式固定为1+1主备，GSU虚机初始个数建议至少设置为2。
亲和策略|亲和类型|该参数用于控制是否将一个虚拟机组（Server-group）中的多个GSU虚机分别部署在不同的主机上。包括如下选项：不限制表示系统不对GSU虚机部署进行限制，即GSU虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。由于GSU虚机的备份方式为N+M互备模式。即使一台主机上有两个或以上的SLB虚机，若该主机宕机，其他主机上的GSU仍然能及时接管用户的数据，用户业务不会受到影响（条件是其他主机上还部署有GSU虚机，以及剩下的这些GSU虚机容量足够接管所有的用户数据）。所以建议GSU采用不限制的部署策略，同样可以达到容灾的目的。反亲和设置为此选项，表示系统需要对GSU虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个GSU必须分散部署在ZXUN uMAC所在可用域（Availability Zones）的不同主机上。设置为该参数后，操作员还可以通过反亲和组名来设置互斥组的名称。对于GSU虚机，不建议配置为该选项。软反亲和设置为此选项，表示系统需要对GSU虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。


###### GSU虚机网卡配置 
GSU虚机网卡配置如[图1]所示。
图1  GSU虚机网卡配置




GSU虚机网卡配置主要参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示GSU虚机关联的网络平面名称，GSU需要关联的网络平面如下。ZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NET


##### IPU虚机配置 


概述 :本节只介绍与IPU虚机相关的主要参数，其他没有说明的参数参见“[OMU虚机配置]”
。


###### IPU虚机配置 
IPU虚机配置主要参数说明参见[表1]。
参数名称|参数含义
---|---
虚机配置|虚机逻辑类型|IPU虚机的逻辑类型固定设置为IPU。
虚机规格数量信息|虚机规格|表示单个IPU虚机的规格，IPU虚机有多种规格。
虚机规格数量信息|虚机初始个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始IPU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统生成的最大可弹性伸缩的IPU虚机个数。IPU虚机的备份方式是N+M（M为1）互备方式，IPU虚机初始个数建议至少设置为2。
虚机规格数量信息|虚机最大个数|虚机初始个数决定实例化ZXUN uMAC时，系统生成的初始IPU虚机个数。虚机最大个数决定实例化ZXUN uMAC时，系统生成的最大可弹性伸缩的IPU虚机个数。IPU虚机的备份方式是N+M（M为1）互备方式，IPU虚机初始个数建议至少设置为2。
亲和策略|亲和类型|该参数用于控制是否将一个虚拟机组（Server-group）中的多个IPU虚机分别部署在不同的主机上。包括如下选项：不限制表示系统不对IPU虚机部署进行限制，即IPU虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。由于IPU虚机的备份方式为N+M互备模式。即使一台主机上有两个或以上的SLB虚机，若该主机宕机，其他主机上的IPU仍然能及时接管用户的数据，用户业务不会受到影响（条件是其他主机上还部署有IPU虚机，以及剩下的这些IPU虚机容量足够接管所有的用户数据）。所以建议IPU采用不限制的部署策略，同样可以达到容灾的目的。反亲和设置为此选项，表示系统需要对IPU虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个IPU必须分散部署在ZXUN uMAC所在可用域（Availability Zones）的不同主机上。设置为该参数后，操作员还可以通过反亲和组名来设置互斥组的名称。对于IPU虚机，不建议配置为该选项。软反亲和设置为此选项，表示系统需要对IPU虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。


###### IPU虚机网卡配置 
IPU虚机网卡配置如[图1]所示。
图1  IPU虚机网卡配置




IPU虚机网卡配置主要参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示IPU虚机关联的网络平面名称，IPU需要关联的网络平面如下。ZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NETZTE_AMF_x_SIG_EXT_NETZTE_AMF_x_MEDIA_EXT_NET


##### AMU虚机配置 


概述 :本节只介绍与AMU虚机相关的主要参数，其他没有说明的参数参见“[OMU虚机配置]”
。


###### AMU虚机配置 
AMU虚机配置主要参数说明参见[表1]。
参数名称|参数含义
---|---
虚机配置|虚机逻辑类型|AMU虚机的逻辑类型固定设置为AMU。
虚机规格数量信息|虚机规格|表示单个AMU虚机的规格，AMU虚机有多种规格。
虚机规格数量信息|虚机初始个数|AMU虚机的备份方式为无备份，一个ZXUN uMAC只需要部署一个AMU。
虚机规格数量信息|虚机最大个数|AMU虚机的备份方式为无备份，一个ZXUN uMAC只需要部署一个AMU。
亲和策略|亲和类型|由于一个ZXUN uMAC只需要部署一个AMU，AMU不涉及亲和策略的配置。


###### AMU虚机网卡配置 
AMU虚机网卡配置如[图1]所示。
图1  AMU虚机网卡配置




AMU虚机网卡配置主要参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示AMU虚机关联的网络平面名称，AMU需要关联的网络平面如下。ZTE_AMF_x_MGT_INT_NETZTE_AMF_x_SERV_INT_NET


#### 安全网关的虚机 
##### IAU虚机配置 
概述 :在部署了安全网关功能的情况下，才需要配置此种类型的虚机。 
本节只介绍与IAU虚机相关的主要参数，其它的没有说明的参数参见“[OMU虚机配置]”
。
###### 虚机网卡配置 
各种类型的虚机需要关联的网络平面不同，详细内容参见[表1]。
NF类型|VM|需要关联的网络平面
---|---|---
安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET|ZTE_uMAC_x_ITC_EMS_NET_SubPort1
ZTE_uMAC_x_ITC_EMS_NET_SubPort2|安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_EMS_NET_SubPort3|安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_INNER_NET|安全网关|ZTE_uMAC_x_ITC_INNER_NET|IAU
ZTE_uMAC_x_ITC_RES_NET|安全网关|ZTE_uMAC_x_ITC_RES_NET|IAU
ZTE_uMAC_x_ITC_XI_NET|安全网关|ZTE_uMAC_x_ITC_XI_NET|IAU
ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
ZTE_uMAC_x_ITC_HI_NET_SubPort3|ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
IMU|安全网关|ZTE_uMAC_x_ITC_INNER_NET|ZTE_uMAC_x_ITC_INNER_NET
ZTE_uMAC_x_ITC_XI_NET|IMU|ZTE_uMAC_x_ITC_XI_NET|安全网关
ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
ZTE_uMAC_x_ITC_HI_NET_SubPort3|ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
IAU虚机网卡配置如[图1]所示。
图1  IAU虚机网卡配置

##### IMU虚机配置 
概述 :在部署了安全网关功能的情况下，才需要配置此种类型的虚机。 
本节只介绍与IMU虚机相关的主要参数，其它的没有说明的参数参见“[OMU虚机配置]”
。
###### 虚机网卡配置 
各种类型的虚机需要关联的网络平面不同，详细内容参见[表1]。
NF类型|VM|需要关联的网络平面
---|---|---
安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET|ZTE_uMAC_x_ITC_EMS_NET_SubPort1
ZTE_uMAC_x_ITC_EMS_NET_SubPort2|安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_EMS_NET_SubPort3|安全网关|IAU|ZTE_uMAC_x_ITC_EMS_NET
ZTE_uMAC_x_ITC_INNER_NET|安全网关|ZTE_uMAC_x_ITC_INNER_NET|IAU
ZTE_uMAC_x_ITC_RES_NET|安全网关|ZTE_uMAC_x_ITC_RES_NET|IAU
ZTE_uMAC_x_ITC_XI_NET|安全网关|ZTE_uMAC_x_ITC_XI_NET|IAU
ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
ZTE_uMAC_x_ITC_HI_NET_SubPort3|ZTE_uMAC_x_ITC_HI_NET|安全网关|IAU
IMU|安全网关|ZTE_uMAC_x_ITC_INNER_NET|ZTE_uMAC_x_ITC_INNER_NET
ZTE_uMAC_x_ITC_XI_NET|IMU|ZTE_uMAC_x_ITC_XI_NET|安全网关
ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关|ZTE_uMAC_x_ITC_HI_NET_SubPort1
ZTE_uMAC_x_ITC_HI_NET_SubPort2|ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
ZTE_uMAC_x_ITC_HI_NET_SubPort3|ZTE_uMAC_x_ITC_HI_NET|IMU|安全网关
IMU虚机网卡配置如[图1]所示。
图1  IMU虚机网卡配置

### 配置示例 
#### VLAN Trunk功能配置示例 
背景知识 :VLAN trunk是OpenStack社区发布的功能，标准叫法是VLAN-aware-VMs。 
VLAN Trunk是OpenStack社区提供的一种用于解决虚拟机接收/发送携带VLAN Tag的报文问题的技术方案。 
中兴通讯的VIM平台（TECS OpenStack）支持VLAN Trunk后，可以实现如下功能。 
减少虚拟机内部的虚拟机网卡数量 
为虚拟机提供接收/发送携带VLAN Tag报文的功能。 
应用场景 :对于ZXUN uMAC来说，主要应用场景是在NFVI层面上采用中兴通讯的VIM平台（TECS
OpenStack）+SDN组网时，ZXUN uMAC通过该功能实现动态增加外部网络平面的子接口的能力。
比如某实际应用场景，某运营商原来已经部署了4G网络，后续需要升级成为4G和5G融合组网，对应需要增加5G网络的业务接口。就可以通过增加子接口的方式来实现。而不需要通过重新实例化部署ZXUN uMAC的方式来增加接口，简化了操作步骤。
##### 规划数据 
本节示例ZXUN uMAC的网络平面规划数据如[图1]所示。
图1  网络平面规划

VLAN Trunk功能只涉及到外部网络平面，其他网络平面不涉及，由于ZXUN uMAC的外部网络平面只会与IPU虚机关联，所以VLAN
Trunk功能只针对IPU虚机的外部网络平面。
所有的外部网络平面分为两类： 
parent（父）网络平面ZXUN uMAC只需要创建一个parent网络平面，将ZTE_uMAC_x_EXT_NET划为外部网络平面的parent网络平面。 说明：parent（父）网络平面对应的子网网段，一般不需要配置网关地址。 
child（子）网络平面ZXUN uMAC需要创建多个child网络平面，除ZTE_uMAC_x_EXT_NET外的其他外部网络平面都是child网络平面。 说明：child（子）网络平面对应的子网网段，一般需要配置网关地址。 
两种类型的网络平面，包括parent网络平面和child网络平面，建议每个网络平面只配置一个对应的子网，VLAN Trunk功能，只支持一个网络平面引用一个子网平面。 
配置步骤 :概述
VLAN Trunk功能在配置操作上，体现为将所有child（子）网络平面对应的子网平面都加入到parent（父）网络平面中，并将parent（父）网络平面关联到IPU虚机。 
TECS OpenStack中的操作
在VIM云平台管理系统（本文档示例为中兴通讯的TECS OpenStack）中创建[图1]中所有规划的外部网络平面及其子网。
 说明： 
在创建网络平面的操作中，根据运营商的实际需要将这些外部网络平面网络类型设置为vxlan或者vlan。
MANO中的操作
在MANO客户端，执行实例化ZXUN uMAC操作时，在通用配置页面的全局配置区域框中，将启用子接口VLAN Trunk配置为启用，如[图2]所示。
图2  启用VLAN Trunk功能

在通用配置页面的网络配置区域框中，创建parent网络平面ZTE_uMAC_21_EXT_NET2，如[图3]所示。
图3  创建parent网络平面ZTE_uMAC_21_EXT_NET2

在通用配置页面的网络配置区域框中，创建所有的child网络平面，本文档仅以ZTE_uMAC_21_EXT_NET2_SubPort1示例说明，如[图4]所示。其他网络平面的数据参见[图1]进行创建。
图4  创建所有的child网络平面

 说明： 
每一个child网络平面都需要配置网关地址。 
在IPU虚机配置页面中，将parent网络平面ZTE_uMAC_21_EXT_NET2关联IPU虚机，并在parent网络平面ZTE_uMAC_21_EXT_NET2中，将所有的child网络平面配置到VLAN
Trunk子接口中，如[图5]所示。
图5  创建所有的child网络平面

 说明： 
每个VLAN Trunk子接口都需要配置VLAN ID。 
EM中的操作
登录到EM客户端，进行分层接入操作，将ZXUN uMAC接入EM。
在EM客户端，切换到配置页面，在配置页面的左侧命令树中，展开需要进行操作的ZXUN uMAC节点。
在ZXUN uMAC节点的CommonS_TMSP_0下，选择Rosng配置管理
→Rosng配置管理
，进入ROSNG配置模式，如[图6]所示。
图6  进入ROSNG配置模式

在ROSNG配置模式下，配置各个接口的子接口、VLAN、IP地址，这些数据都需要和TECS OpenStack分配的数据一致。 
实例化后，IPU虚机的实接口（物理接口）对应父网络，实接口（物理接口）上一般不需要配置IP地址，IP地址都配置在子接口上。 
### 参考 
#### 实例化VNF失败后回退 
摘要 :本节介绍在VNF实例化失败后如何回退的操作步骤。 
步骤 :在NFVO客户端的上方导航栏中，单击编排按钮，在下拉菜单中选择应用→VNF
按钮，如[图1]所示。
图1  进入VNF

勾选实例化失败的VNF，单击终止按钮，进行自动回退，如[图2]所示。
图2  终止实例化失败的VNF

耐心等待，回退完成。 
#### 查询虚机的子接口地址和VLAN 
摘要 :ZXUN uMAC实例化成功后，VIM云平台（本文档示例为TECS OpenStack）会为各个虚机分配子接口的IP地址和VLAN。
在配置业务数据之前，需要在ROSNG平台上，配置IPU虚机的子接口地址和VLAN。 
在SDN组网场景中，ROSNG平台上配置IPU虚机的子接口地址和VLAN从是MANO上查询获取的，本节介绍如何在MANO中查询相关数据。 
步骤 :在MANO客户端，进入MANO的VNF列表页面，找到ZXUN uMAC，单击Trunk管理。
查看IPU虚机的信息，包括子接口和VLAN信息。 
##### 相关操作 
根据查询获取的子端口列表，后续配置ROSNG信息，详细操作步骤参见配置地址
中的配置接口。
 说明： 
MANO上查询的顺序不一定是按照VLAN的顺序显示，配置ROSNG时，VLAN子接口的顺序建议按照规划的网络平面顺序进行配置，便于后续排查问题。 
配置完成后，可以使用[show ip interface brief]，查看配置结果是否正确。
## 缩略语 
## 缩略语 
3GPP :3rd Generation Partnership Project第三代合作伙伴计划
### AZ 
Availability Zone可用性区域
### CDU 
Cooling Distribution Unit冷量分配单元
### CUDR 
Cloud Unified Data Repository云化统一数据仓库
### DVS 
Distributed Virtual Switch分布式虚拟交换机
FTP :File Transfer Protocol文件传输协议
GSU :General Service Unit通用业务单元
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
### ICMP 
Internet Control Message ProtocolInternet控制报文协议
### MPU 
Management Process Unit主控卡功能子单元
### MTU 
Maximum Transfer Unit最大传输单元
### NFVI 
Network Functions Virtualization Infrastructure网络功能虚拟化基础设施
NFVO :Network Functions Virtualization Orchestrator网络功能虚拟化编排器
OMU :Operation & Management Unit操作管理单元
### OVS 
Open VSwitch虚拟交换机
### PVID 
Port VLAN ID端口虚拟局域网标识
### SDN 
Software Defined Network软件所界定网络
SFTP :Secure File Transfer Protocol安全文件传输协议
### SR-IOV 
Single-Root I/O Virtualization单根I/O虚拟化
### SSH 
Secure Shell安全外壳
TCP :Transmission Control Protocol传输控制协议
### TECS 
Tulip Elastic Cloud System郁金香弹性云系统
### UDP 
User Datagram Protocol用户数据报协议
UDSF :Unstructured Data Storage Function非结构化数据存储功能
VIM :Virtualized Infrastructure Manager虚拟化基础设施管理系统
### VLAN 
Virtual Local Area Network虚拟局域网
VM :Virtual Machine虚拟机
VNF :Virtualized Network Function虚拟化网络功能
VNFM :Virtualized Network Function Manager虚拟化网络功能管理器
### VXLAN 
Virtual Extensible Local Area Network虚拟可扩展局域网
### WEB 
Web环球网
## 安全加固 
### 数据备份 
#### 备份Rosng数据 
摘要 :Rosng配置必须执行write操作并等待存盘完成。如果没有执行write操作，设备重启后，配置数据会丢失。 
如果数据备份后对配置数据又进行了修改，则必须重新进行配置数据备份。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开uMAC节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[write]命令，保存当前配置数据。
执行[show running-config]命令，将返回结果拷贝出来保存备份。
#### 备份配置数据 
摘要 :如果数据备份后对配置数据又进行了修改，则必须重新进行配置数据备份。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中选择待升级的网元节点。
执行备份命令：[BACKUP]:ID=1,NAME="default"。
在“操作记录”中确认，数据备份成功。 
如果备份数据命令执行失败，参考“[CCMF的NFS进程检查和修复]”，进行进一步检查。
将备份的文件下载到本地保存。 
### 各账户初始密码加固 
 小心！ 
所有密码修改后务必保存，定期更换，如果遗忘无法恢复。 
#### 操作系统账户密码修改 
默认账户|默认密码|修改方法|备注
---|---|---|---
root|ZTE_ossdbg1|通过EM中的SET PASSWD命令设置|操作系统root账户密码支持字符：大写字母、小写字母、数字、下划线
admin|Admin_123|通过EM中的SET PASSWD命令设置|操作系统admin账户密码支持字符：大写字母、小写字母、数字、下划线
zte_v6pf_inner|ZTE_v6pwd|通过EM中的SET PASSWD命令设置|虚拟机内部经控制面下载版本的sftp账户密码支持字符：大写字母、小写字母、数字、下划线
 说明： 
如果密码修改后需要恢复到原来的密码，使用[SET PASSWD]命令可以修改回原密码。
从V7.20.24及之前版本直接升级到此版本，无论在升级前版本是否修改过admin用户密码，升级到此版本后首次执行admin用户密码修改时，输入的原密码必须是默认密码Admin_123。 
#### OAM超级账户密码修改 
默认账户|默认密码|修改方法|备注
---|---|---|---
admin|Z_tywg_2019|通过7788端口/OAM-WEB使用SET PASSWORD修改，或第一次登录时修改。登录7788端口的方法：ssh -p 7788 admin@OAM浮动地址。|OAM超级账户密码支持字符：大写字母、小写字母、数字、下划线
 说明： 
如果密码修改后需要恢复到原来的密码，则需在OMU虚机上执行如下步骤： 
执行命令[SET ACCT RULE]:PWDREPEATPERIOD=0,PWDREUSES=1，改变密码策略。
执行命令[SET PASSWORD]，将密码修改为原密码。
执行命令[SET ACCT RULE]:PWDREPEATPERIOD=90,PWDREUSES=3，恢复密码策略。
#### OAM内控账户和SFTP账户密码修改 
默认账户|默认密码|修改方法|备注
---|---|---|---
postgres|oam_PG_7e3_0c_1c|通过7788端口/EM使用SET ACCOUNTPASSWD命令，将账号类型设置为ACCOUNT_DB，即数据文件账户。|Postgre数据库的默认用户密码支持字符：大写字母、小写字母、数字、下划线
ems|ZTE_oamdbg_1|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
ndf|ZTE_oamdbg_2|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
inner-ndf|U_tywg_2018|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
cn-5g-inner-oper|U_tywg_2018|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
rule_import|ZTE_1234_rule|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|中盈网管专用的（中国电信物联），对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
 说明： 
如果密码修改后需要恢复到原来的密码，使用[表3]中“修改方法”列的对应命令就可以修改回原密码。
### 合规扫描加固 
#### 安全加固需求 
根据CORE-v5.04的合规配置规范加固OMU操作系统。 
#### 安全加固实施方法 
针对不同运营商，执行对应的加固脚本。
移动：security_enhance_OMM_20220408_CM 
电信：security_enhance_OMM_20220408_CT 
联通：security_enhance_OMM_20220408_CU 
联系中兴通讯技术支持
，获取对应脚本。
以执行加固脚本security_enhance_OMM_20220408_CM为例，操作步骤如下。
拷贝文件到/home/admin目录下，并获取root权限。 
`[admin@localhost ~]$ su
Password: 
[root@localhost admin] ` 
给脚本添加可执行权限。 
`[root@localhost admin]chmod +x security_enhance_OMM_20220408_CM` 
执行脚本初始化。 
`[root@localhost admin] ./security_enhance_OMM_20220408_CM -i
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准
init security_enhance_config begin
init security_enhance_config end

//注意：若打印以下[WARN]回显，则说明之前已经初始化过，根据情况输入正确交互信息（建议输入no）：
[root@localhost admin] ./security_enhance_OMM_20220408_CM -i
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4
init security_enhance_config begin
[WARN]If you reinitialize the tool,the rollback function will not be available (yes/no)  
//yes：执行此次初始化，且此次初始化之前的加固操作无法回退，只能实现此次之后的加固操作回退。
//no（推荐）：不执行此次初始化，之前加固操作仍能回退。继续后续加固操作即可。
init security_enhance_config end` 
执行加固前检查是否有待加固项。 
`[root@localhost admin] ./security_enhance_OMM_20220408_CM -c
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准` 
…… 
如果以下项目全部满足，则不需要再执行加固。 
检查结果全部为ok。 
No.12项：hosts.allow已包含OMU自身所有网络平面（见回显的ifconfig打印）。 
No.13项：OpenSSH版本号已隐藏。 
若以上项目未全部满足，则继续执行后续加固。 
执行加固。 
执行默认加固项。 
`[root@localhost admin] ./security_enhance_OMM_20220408_CM -s
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准
security_enhance ENTIRE  begin
security_enhance_sshd begin
security_enhance_sshd end
security_enhance_vsftpd begin
mkdir: cannot create directory ‘/etc/vsftpd/’: File exists
sed: cannot stat /etc/vsftpd/user_list: No such file or directory
sed: cannot stat /etc/vsftpd/ftpusers: No such file or directory
security_enhance_vsftpd end
……（过程略）
Note: This output shows SysV services only and does not include native
      systemd services. SysV configuration data might be overridden by native
      systemd configuration.

      If you want to list systemd services use 'systemctl list-unit-files'.
      To see services enabled on particular target use
      'systemctl list-dependencies [target]'.
……（过程略）
security_enhance_whitelist begin
security_enhance_whitelist end
security_enhance_sshversion begin
length:11
ssh version length is normal!
security_enhance_sshversion end
security_enhance ENTIRE  end
//注：加固过程会出现“No such file or directory”、“File exists”、“Note:”等提示，无需处理。` 
执行手工加固项。 
`[root@localhost admin] ./security_enhance_OMM_20220408_CM -s manual
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准` 
执行加固后检查。 
`[root@localhost admin] ./security_enhance_OMM_20220408_CM -c
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准` 
…… 
如果以下项目全部满足，则当前虚机加固结束。 
检查结果全部为ok。 
No.12项：hosts.allow已包含OMU自身所有网络平面（参见回显的ifconfig打印）。 
No.13项：OpenSSH版本号已隐藏（如上图所示）。 
若以上项目未全部满足，保存/home/admin/log目录下的文件，并联系中兴通讯技术支持
。
 说明： 
如果存在主备OMU虚机，则主备OMU虚机都需要执行上述加固操作。 
加固后若虚机重建，需要再次执行加固。 
合规加固回退办法。
回退方法以security_enhance_OMM_20220408_CM为例。
脚本提供两种回退方式，根据实际情况选择其中一种方式进行回退。 
方式一：回退到最近一次加固前的状态。[root@localhost admin]# ./security_enhance_OMM_20220408_CM -r
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4
security_enhance_rollback_ENTIRE begin
security_enhance_rollback_ENTIRE end 
方式二：回退到指定时间戳前的状态。[root@localhost admin]# ./security_enhance_OMM_20220408_CM -r list
Now your CGSL version is TAG_CGS_CORE_V5_04_F25B5
security_enhance_rollback_ENTIRE begin
1.20220222144948  //加固时间戳，脚本每次执行-s加固时会记录一个时间戳
2.20220222145301
3.20220222145327
Please select[1-3]?1   //根据实际情况，输入时间戳编号，回退到指定时间戳前的状态
security_enhance_rollback_ENTIRE end 
回退后检查。 
`[root@localhost admin] ./security_enhance_OMM_20220408_CM -c
//回退后检查，配置应回退到加固前状态` 
#### 其他命令参考 
以security_enhance_OMM_20220408_CM脚本为例： 
命令帮助./security_enhance_OMM_20220408_CM -h  
单项检查（以whitelist项举例，其他单项可通过-h帮助查询）./security_enhance_OMM_20220408_CM -c whitelist 
单项加固（以whitelist项举例）./security_enhance_OMM_20220408_CM -s whitelist  
单项回退到最近一次加固前的状态（以whitelist项举例）./security_enhance_OMM_20220408_CM -r whitelist  
单项回退到指定时间戳前的状态（以whitelist项举例）./security_enhance_OMM_20220408_CM -r whitelist list 
打包加固时的备份文件（TrouShoot.tar.gz）./security_enhance_OMM_20220408_CM -ts  
查看加固标签（含版本、最近一次时间戳信息）cat /home/admin/security_enhance.conf 
### 操作系统加固 
操作系统补丁升级需按现网规划执行，联系中兴通讯技术支持
获取最新镜像补丁升级指导文档。
### 特殊场景加固 
本节中的加固内容为特殊场景使用，若没有明确要求，则不执行本节的加固内容。 
#### 开启非root用户启动VRUs功能 
概述 : 说明： 
该功能会影响性能，若用户无明确需求，不建议开启。 
如果需要开启本功能，联系中兴通讯技术支持
。
##### 检查是否开启非root用户启动VRUs功能 
执行命令[SHOW RUNASROOT]，查询是否以root用户启动VRUs。
命令执行结果示例如下： 
`(No.1) : SHOW RUNASROOT:


操作维护       是否启用 
------------------------
修改           是       
------------------------
记录数：1` 
命令执行结果中的参数取值说明如下： 
是：以root用户启动VRUs。 
否：以非root用户启动VRUs。 
##### 开启非root用户启动VRUs功能 
执行命令[SET RUNASROOT]:ENABLE="NO"，弹出危险提示对话框，如下图所示。
图1  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图2  危险提示对话框

单击确定按钮。
##### 回退方法 
执行命令[SET RUNASROOT]:ENABLE="YES"，弹出危险提示对话框，如下图所示。
图3  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图4  危险提示对话框

单击确定按钮。
#### 开启SELinux功能 
概述 : 说明： 
该功能会影响性能，若用户无明确需求，不建议开启。 
如果需要开启本功能，联系中兴通讯技术支持
。
环境当前镜像（或已打补丁）版本为CGS-Linux-CORE.V5.04.F16P9或P9以上。 
##### 检查SELinux功能是否开启 
执行命令[SHOW SELINUX]，查询是否开启SELinux功能。
命令执行结果示例如下： 
`(No.1) : SHOW SELINUX:


操作维护       是否启用 
------------------------
修改           是       
------------------------
记录数：1` 
命令执行结果中的参数取值说明如下： 
是：容器在SELinux系统下运行。表示SELinux功能已开启。 
否：容器不在SELinux系统下运行。表示SELinux功能未开启。 
##### 开启SELinux功能 
执行命令[SET SELINUX]:ENABLE="YES"，弹出危险提示对话框，如下图所示。
图1  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图2  危险提示对话框

单击确定按钮。
##### 回退方法 
执行命令[SET SELINUX]:ENABLE="NO"，弹出危险提示对话框，如下图所示。
图3  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图4  危险提示对话框

单击确定按钮。
#### 设置远程访问白名单-hosts文件方式 
概述 :/etc/hosts.allow和/etc/hosts.deny两个文件用于控制远程访问，可以允许或者拒绝某个IP或者IP段访问Linux的某项服务。
 说明： 
必须先配置hosts.allow，且hosts.allow已包含所有白名单IP后，才能配置hosts.deny。
必要网段白名单列表，参见下表。 
类别|说明
---|---
OMU所有网络平面|OMU上ifconfig -a | grep inet命令查询到的的所有平面。包括OMU上管理面、业务面和OAM网络平面的IPv4和IPv6地址段。配置示例参考“hosts.allow配置示例（未包含外部IP）”。此项配置也可通过合规扫描加固中的脚本自动添加。
OMU回环地址和localhost|localhost IPv4的回环地址：127.0.0.1。IPv6的回环地址：[::1]。此项配置也可通过合规扫描加固中的脚本自动添加。
外部IP或网段|外部4A/NFVO/VNFM/EM/客户端的IP或网段：需现场维护人员自行查询，务必和用户确认，保证其准确性。
操作步骤 :通过ssh登录主备OMU，切换为root用户。 
备份文件。 
`cp -a /etc/hosts.allow /etc/hosts.allow.bak
cp -a /etc/hosts.deny /etc/hosts.deny.bak` 
执行命令[vi /etc/hosts.allow]，修改/etc/hosts.allow。
将所有的白名单IP增加到文件/etc/hosts.allow中，格式如下： 
IPv4格式： 
`all:192.168.4.44:allow  放通单个IP
all:192.168.1.:allow  放通192.168.1整个网段，注意地址段后有一个英文字符“.”` 
IPv6格式： 
`all:[3ffe:505:2:1::44]:allow  放通单个IP
all:[3ffe:505:2:1::]/64:allow  放通3ffe:505:2:1::整个网段` 
修改后，执行命令[cat /etc/hosts.allow]，检查是否已包含上面的白名单IP网段。
现网需要根据实际白名单地址进行配置。 
执行命令[vi /etc/hosts.deny]，修改/etc/hosts.deny文件。
`文件最后添加一行
all:all` 
 说明： 
此项设置后立刻生效，务必在完成hosts.allow的白名单配置后再进行此项配置。此项生效后，将只允许hosts.allow配置的白名单IP网段访问。
修改后，执行命令[cat /etc/hosts.deny]，检查文件最后一行是否为：all:all。
##### 回退步骤 
 说明： 
必须先回退hosts.deny，再回退hosts.allow。
执行命令[cp -a /etc/hosts.deny.bak /etc/hosts.deny]，回退hosts.deny。
回退后，务必再执行命令[cat /etc/hosts.deny]检查一下，确保没有all:all字段。
执行命令[cp -a /etc/hosts.allow.bak /etc/hosts.allow]，回退hosts.allow。
#### 配置远程日志功能 
配置步骤 :执行命令[cp -a /etc/rsyslog.conf /etc/rsyslog.conf.bak]，备份文件。
通过命令[vi /etc/rsyslog.conf]，修改配置文件rsyslog.conf。
对于IPv4，增加如下一行。 
`*.*                    @@192.168.0.1:514` 
对于IPv6，增加如下一行。 
`*.*                    @@[2409:8086:8413:2c5e::80:10]:514` 
根据日志转存要求，可以将“*.*”替换为实际需要的日志信息。比如：kern.* ; mail.* 等等。*.*为全部转存。 
这里的192.168.0.1以及2409:8086:8413:2c5e::80:10均为样例，需要填写实际的日志服务器地址。 
 说明： 
@@表示TCP传输，@表示UDP传输，根据服务端开启的传输方式决定。 
514为服务端开启的端口号，需要与服务端确认。 
执行命令[systemctl restart rsyslog.service]，重启rsyslog服务，使服务生效。
##### 回退步骤 
执行命令[cp -a /etc/rsyslog.conf.bak /etc/rsyslog.conf]，恢复文件。
执行命令[systemctl restart rsyslog.service]，重启rsyslog服务，使服务生效。
#### 手动处理绿盟等保合规问题 
概述 :如果外场不是使用绿盟等保进行合规或未报对应问题，则无需操作此步骤。 
如果外场使用绿盟等保进行合规扫描，反馈在“[合规扫描加固]”操作后遗留不合规项，则按照下文方法进行处理。
##### 检查系统内核参数配置 
检查配置项|描述
---|---
50|检查系统内核参数配置
加固脚本是包含此加固项的，但在CGSL P6和P8系统上，通过脚本加固后该配置项没有生效，需要再手工执行[sysctl -p]命令使加固生效。
在OMU虚机执行命令[cat /V6-cgsl-release]，可以确认CGSL系统的版本。
##### 检查是否使用PAM认证模块禁止wheel组之外的用户su为root 
图1  检查是否使用PAM认证模块禁止wheel组之外的用户su为root

加固后即可实现“使用PAM认证模块禁止wheel组之外的用户su为root”，但绿盟的检查没有包含所做的配置，导致误报。 

##### 检查重要目录或文件权限配置 
图2  检查重要目录或文件权限配置

CGSL建议不加固，因为加固该配置项会导致系统出现异常。 
检查重要目录或文件权限设置
/tmp文件权限是否符合规范检查标准750。现在默认为777但tmp目录不能改为750，因为改为750会导致系统出现异常。 
/etc/xinetd.conf文件权限是否符合规范，CGSL P6系统中没有这个文件属于误报。 
##### 检查重要文件属性设置 
图3  检查重要文件属性设置

检查/etc/gshadow文件属性 
检查/etc/passwd文件属性 
检查/etc/group文件属性 
检查/etc/shadow文件属性 
修改上述这几个文件添加i参数，后面会导致无法创建用户，也无法修改密码的情况，出现密码到期，也无法修改密码。因此不建议修改上述几个文件的属性。 
##### 检查是否设置口令过期前警告天数 
图4  检查是否设置口令过期前警告天数

该项在加固脚本里已经加固，但天数不一致，可以直接修改为目标天数30，执行如下命令： 
[sed -i 's/PASS_WARN_AGE.*/PASS_WARN_AGE 30/g' /etc/login.defs]
再执行命令[cat /etc/login.defs |grep PASS_WARN_AGE]，检查配置是否正确。
### 加固后验证 
根据实际加固情况进行验证。 
加固验证项目|加固验证步骤|验证结果
---|---|---
直连接口|检查使用ssh方式接入是否成功（22、7722、7788）。|通过
sftp|检查使用sftp方式上传下载是否成功。|通过
EM接入检查|检查EM分层接入是否成功。在EM的分层接入界面进行同步操作，同步成功则通过。|通过
配置|检查配置功能是否正常，比如执行一个MML命令，命令正常执行。|通过
告警|检查告警上报功能是否正常，检查加固前后有无新的告警出现，如果出现新告警需要确认是否由加固导致。|通过
信令跟踪|检查信令跟踪功能是否正常。|通过
性能统计|检查性能统计数据上报是否正常。|通过
基本业务检查|加固后，执行基本业务检查，基本业务是否接入正常，数据业务是否正常。|通过
### 参考 
#### CCMF的NFS进程检查和修复 
登录MPU虚机1，切换到root用户。 
执行命令：[docker exec -it vru-oam-ccmf-0 sh]，进入主用CCMF容器。
执行命令：[hexdump /dev/shm/vru-oam-ccmf_VNFP_PLAT_STATE]，确认当前CCMF容器是否为主用。
上图中红色框中的0001即代表主用。如果当前容器不是主用，则登录到另外一个MPU虚机。
检查CCMF上NFS的注册信息。 
执行命令：[ps -ef|grep cmservice]
命令返回结果如下图所示，每个nfs_X对应一个服务，仔细核对nfs个数，应该和EM上配置命令树挂载的服务个数相同。如果存在缺失，则需要执行后续的步骤进行修复。 

修复CCMF的NFS进程。修改脚本为restoreCCMF.sh。
将脚本restoreCCMF.sh通过sftp分别上传到MPU虚机1和MPU虚机2的/home/admin目录下。
登录MPU虚机1，执行如下操作。 
执行命令[su]切到root用户下。
执行命令[cd /home/admin]。
执行命令[chmod 777 restoreCCMF.sh]，给脚本restoreCCMF.sh赋予权限。
执行命令[./restoreCCMF.sh]，执行修复脚本restoreCCMF.sh。
登录MPU虚机2，执行如下操作。 
执行命令[su]切到root用户下。
执行命令[cd /home/admin]。
执行命令[chmod 777 restoreCCMF.sh]，给脚本restoreCCMF.sh赋予权限。
执行命令[./restoreCCMF.sh]，执行修复脚本restoreCCMF.sh。
等待2~5分钟，脚本执行完毕后，再参考步骤2检查NFS进程是否启动完整。 
执行备份命令，例如： 
[BACKUP]:ID=1,NAME="default",FILEPATH="sftp://10.43.169.77/backup",USERNAME="root",PASSWORD="**********",FILENAME="cm_backup_1108"
如果数据备份成功，则表示CCMF的NFS进程启动完整，即修复成功。 
#### hosts.allow配置示例（未包含外部IP） 
OMU上 ifconfig -a | grep inet查到的IP网段|/etc/hosts.allow对应配置|说明
---|---|---
inet 172.17.0.1  netmask 255.255.0.0  broadcast 0.0.0.0|all:172.17.:allow|该地址掩码为255.255.0.0，增加的配置要与该掩码相匹配。
inet6 fe80::f816:3eff:fe72:8e2b  prefixlen 64  scopeid 0x20<link>inet6 fe80::f816:3eff:fe9c:9928  prefixlen 64  scopeid 0x20<link>inet6 fe80::f816:3eff:fe4c:68b9  prefixlen 64  scopeid 0x20<link>|all:[fe80::]/64:allow|该组地址网段相同，掩码都为64位，因此可只增加一条配置。
inet6 2409:8086:8618:2af9::1  prefixlen 64  scopeid 0x0<global>|all:[2409:8086:8618:2af9::]/64:allow|该地址掩码为64位，增加的配置要与该掩码相匹配。
inet6 2409:8086:8618:2afa::1  prefixlen 64  scopeid 0x0<global>|all:[2409:8086:8618:2afa::]/64:allow|该地址掩码为64位，增加的配置要与该掩码相匹配。
inet6 2409:805b:5a06:1608::111:101  prefixlen 124  scopeid 0x0<global>inet6 2409:805b:5a06:1608::111:102  prefixlen 124  scopeid 0x0<global>|all:[2409:805b:5a06:1608::]/64:allow|该组地址网段划分的比较细，掩码为124位，地址段比较小，增加的配置可适当放大一些到64位，避免后续再增加地址时的麻烦。
inet 10.242.225.26  netmask 255.255.255.248  broadcast 10.242.225.31inet 10.242.225.25  netmask 255.255.255.248  broadcast 10.242.225.31|all:10.242.225.:allow|该组地址网段划分的比较细，掩码为 255.255.255.248，地址段比较小，增加的配置可适当放大一些到255.255.255.0，避免后续再增加地址时的麻烦。
inet 127.0.0.1  netmask 255.0.0.0|all:127.0.0.1|增加IPv4回环地址的配置。
inet6 ::1  prefixlen 128  scopeid 0x10<host>|all:[::1]|增加IPv6回环地址的配置。
-|all:localhost|增加localhost配置。
## 初始配置 
### 配置流程 
在ZXUN uMAC的实例化完成后， 需要按照配置流程及组网规划进行数据配置，使ZXUN uMAC正常运行并提供相应的业务功能。
ZXUN uMAC数据配置的基本流程参见[表1]。
操作|操作说明
---|---
配置准备|将ZXUN uMAC接入EM，并了解EM中的配置模式。具体参见配置准备。
名称检查|运营商名称规范，检查虚拟机和网元名称是否符合要求，虚机个数是否与合同要求一致。具体参见检查名称。
协议栈配置|按照组网规划，配置各VRF、物理地址、静态路由及GR功能等。具体参见协议栈配置。
CDB配置|配置CDB相关信息。具体参见配置CDB。
公共基础数据配置|进行时间配置、自愈配置等。具体参见公共基础数据配置。
MME/SGSN业务配置|进行MME/SGSN业务配置、接口配置等。具体参见MME/SGSN业务配置。
AMF业务配置|进行AMF业务配置、接口配置等。具体参见AMF业务配置。
### 配置准备 
#### 分层接入 
在EM客户端中进行分层接入操作，将各NF接入EM。 
所有NF接入EM的操作类似，分层接入的具体操作步骤参见“新建OAM代理
”。
 说明： 
新建代理时，代理类型固定选择OAM。 
协议选择HTTP时，端口号为7778。 
协议选择HTTPS时，端口号为8777。 
#### 配置模式说明 
维护人员在EM中进行数据配置之前，需要进入相应的配置页面。配置页面的具体说明参见“命令终端概述
”。
初始数据配置中涉及到的命令分为两种，分别为ROSNG命令和MML命令。 
##### ROSNG命令 
ROSNG命令需要在命令处理页面的命令输入区中手动输入完整的命令及所要配置的数据（例如ip address 195.166.88.11 255.255.255.0），输入完成后按回车键运行命令，命令结果会出现在结果输出区。
##### MML命令 
MML命令需要在命令处理页面中，通过GUI对命令参数进行选择和配置，输入完成后按“Enter”键或单击执行按钮运行命令，命令结果会出现在文本结果区域。
### 协议栈配置 
#### 配置VRF 
摘要 :本节介绍如何配置ZXUN uMAC的VRF。
在ZXUN uMAC上，可以创建多个VPN以对应和不同网元进行通信，每个VPN通过VRF进行标识。
将与各网元通信的物理地址、业务地址、路由分别与对应的VRF绑定，可以实现ZXUN uMAC与各网元间信令面的流量隔离。
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip vrf]命令，创建一个VRF并进入VRF配置模式。
执行[rd]命令，定义VRF的RD。
 说明： 
一个VRF下只能配置一个RD。 
VRF功能支持对两种地址族类型生效，包括IPv4和IPv6，必须使能至少一个地址族类型才能使VRF功能生效。 
执行address-family ipv4命令，使能IPv4格式的VRF功能，该命令执行成功后进入VRF-IPv4地址族模式。 
执行address-family ipv6命令，使能IPv6格式的VRF功能，该命令执行成功后进入VRF-IPv6地址族模式。 
执行[exit]命令，退出VRF配置模式。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
VRF名称|VPN ID|RD|IPv4地址|IPv6地址|用途
---|---|---|---|---|---
SBI|14|14:14|支持|支持|规划AMF与其他5GC NF之间的接口使用VRF SBI。
GTP|8|8:8|支持|支持|规划AMF与MME/DNS之间的接口使用VRF GTP。规划MME与SGSN/SGW之间的接口使用VRF GTP。
RAN|9|9:9|支持|支持|规划AMF与NR之间的N2接口使用VRF RAN。规划MME与eNodeB之间的S1-MME接口使用VRF RAN。
SIG|12|12:12|支持|支持|规划MME/SGSN与HSS/DRA/HLR/STP/LCS/EMS+之间的接口使用VRF SIG。
Gb|15|15:15|支持|支持|规划SGSN与BSC之间的Gb接口使用VRF Gb。
Softsw|16|16:16|支持|支持|规划MME与MSCS之间的接口使用VRF Softsw。
Ga|17|17:17|支持|支持|规划SGSN与CG之间的接口使用VRF Ga。
根据规划，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
配置VRF SBI的相关信息，命令如下。 
ZXROSNG(config)#ip vrf SBI vpnid 14 
ZXROSNG(config-vrf-SBI)#rd 14:14 
ZXROSNG(config-vrf-SBI)#address-family ipv4 
ZXROSNG(config-vrf-SBI-af-ipv4)#exit 
ZXROSNG(config-vrf-SBI)#address-family ipv6 
ZXROSNG(config-vrf-SBI-af-ipv6)#exit 
ZXROSNG(config-vrf-SBI)#exit 
配置VRF GTP的相关信息，命令如下。 
ZXROSNG(config)#ip vrf GTP vpnid 8 
ZXROSNG(config-vrf-GTP)#rd 8:8 
ZXROSNG(config-vrf-GTP)#address-family ipv4 
ZXROSNG(config-vrf-GTP-af-ipv4)#exit 
ZXROSNG(config-vrf-GTP)#address-family ipv6 
ZXROSNG(config-vrf-GTP-af-ipv6)#exit 
ZXROSNG(config-vrf-GTP)#exit 
配置VRF RAN的相关信息，命令如下。 
ZXROSNG(config)#ip vrf RAN vpnid 9 
ZXROSNG(config-vrf-RAN)#rd 9:9 
ZXROSNG(config-vrf-RAN)#address-family ipv4 
ZXROSNG(config-vrf-RAN-af-ipv4)#exit 
ZXROSNG(config-vrf-RAN)#address-family ipv6 
ZXROSNG(config-vrf-RAN-af-ipv6)#exit 
ZXROSNG(config-vrf-RAN)#exit 
配置VRF SIG的相关信息，命令如下。 
ZXROSNG(config)#ip vrf SIG vpnid 12 
ZXROSNG(config-vrf-SIG)#rd 12:12 
ZXROSNG(config-vrf-SIG)#address-family ipv4 
ZXROSNG(config-vrf-SIG-af-ipv4)#exit 
ZXROSNG(config-vrf-SIG)#address-family ipv6 
ZXROSNG(config-vrf-SIG-af-ipv6)#exit 
ZXROSNG(config-vrf-SIG)#exit 
配置VRF Gb的相关信息，命令如下。 
ZXROSNG(config)#ip vrf Gb vpnid 15 
ZXROSNG(config-vrf-Gb)#rd 15:15 
ZXROSNG(config-vrf-Gb)#address-family ipv4 
ZXROSNG(config-vrf-Gb-af-ipv4)#exit 
ZXROSNG(config-vrf-Gb)#address-family ipv6 
ZXROSNG(config-vrf-Gb-af-ipv6)#exit 
ZXROSNG(config-vrf-Gb)#exit 
配置VRF Softsw的相关信息，命令如下。 
ZXROSNG(config)#ip vrf Softsw vpnid 16 
ZXROSNG(config-vrf-Softsw)#rd 16:16 
ZXROSNG(config-vrf-Softsw)#address-family ipv4 
ZXROSNG(config-vrf-Softsw-af-ipv4)#exit 
ZXROSNG(config-vrf-Softsw)#address-family ipv6 
ZXROSNG(config-vrf-Softsw-af-ipv6)#exit 
ZXROSNG(config-vrf-Softsw)#exit 
配置VRF Ga的相关信息，命令如下。 
ZXROSNG(config)#ip vrf Ga vpnid 17 
ZXROSNG(config-vrf-Ga)#rd 17:17 
ZXROSNG(config-vrf-Ga)#address-family ipv4 
ZXROSNG(config-vrf-Ga-af-ipv4)#exit 
ZXROSNG(config-vrf-Ga)#address-family ipv6  
ZXROSNG(config-vrf-Softsw-af-ipv6)#exit 
ZXROSNG(config-vrf-Ga)#exit 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config-vrf)#end 
ZXROSNG#write 
相关任务 :配置完成后，可以执行[show ip vrf brief]命令查看相关信息。
#### 配置共子网 
摘要 :按照组网规范，ZXUN uMAC采用共子网的方式部署。共子网指多个虚机相同用途的接口/子接口归属相同的网段。
数据规划时，必须按照共子网的方式来规划子接口IP地址，同一VRF下的各个子接口应当使用同一网段的IP地址，同一VRF下的各个子接口的VLAN必须一致。 
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0节点。
选择菜单Rosng配置管理→router配置
，即可进入ROSNG界面进行接口配置。
执行[ip-address network-segment conflict-check] disable命令，关闭同网段冲突检测功能，即开启共子网配置全局开关。
执行[configure terminal]命令，进入全局配置模式。
执行[arp]命令，进入ARP配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[source-filtered] disable命令，关闭ARP源过滤。
执行[exit]命令，退出子接口配置模式。
执行[exit]命令，退出ARP配置模式。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
接口|子接口
---|---
xgei-1/0/1/1|xgei-1/0/1/1.1xgei-1/0/1/1.2xgei-1/0/1/1.3xgei-1/0/1/1.4xgei-1/0/1/1.5xgei-1/0/1/1.6xgei-1/0/1/1.7xgei-1/0/1/1.8
xgei-1/0/2/1|xgei-1/0/2/1.1xgei-1/0/2/1.2xgei-1/0/2/1.3xgei-1/0/2/1.4xgei-1/0/2/1.5xgei-1/0/2/1.6xgei-1/0/2/1.7xgei-1/0/2/1.8
根据规划，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
关闭同网段冲突检测功能，命令如下。 
ZXROSNG(config)#ip-address network-segment conflict-check disable 
关闭ARP源过滤，命令如下。 
ZXROSNG(config)#arp 
ZXROSNG(config-arp)#interface xgei-1/0/1/1 
ZXROSNG(config-arp-if-xgei-1/0/1/1)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.1 
ZXROSNG(config-arp-if-xgei-1/0/1/1.1)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.2 
ZXROSNG(config-arp-if-xgei-1/0/1/1.2)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.2)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.3 
ZXROSNG(config-arp-if-xgei-1/0/1/1.3)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.3)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.4 
ZXROSNG(config-arp-if-xgei-1/0/1/1.4)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.4)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.5 
ZXROSNG(config-arp-if-xgei-1/0/1/1.5)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.5)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.6 
ZXROSNG(config-arp-if-xgei-1/0/1/1.6)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.6)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.7 
ZXROSNG(config-arp-if-xgei-1/0/1/1.7)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.7)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.8 
ZXROSNG(config-arp-if-xgei-1/0/1/1.8)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/1/1.8)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1 
ZXROSNG(config-arp-if-xgei-1/0/2/1)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.1 
ZXROSNG(config-arp-if-xgei-1/0/2/1.1)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.2 
ZXROSNG(config-arp-if-xgei-1/0/2/1.2)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.2)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.3 
ZXROSNG(config-arp-if-xgei-1/0/2/1.3)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.3)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.4 
ZXROSNG(config-arp-if-xgei-1/0/2/1.4)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.4)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.5 
ZXROSNG(config-arp-if-xgei-1/0/2/1.5)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.5)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.6 
ZXROSNG(config-arp-if-xgei-1/0/2/1.6)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.6)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.7 
ZXROSNG(config-arp-if-xgei-1/0/2/1.7)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.7)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.8 
ZXROSNG(config-arp-if-xgei-1/0/2/1.8)#source-filtered disable 
ZXROSNG(config-arp-if-xgei-1/0/2/1.8)#exit 
ZXROSNG(config-arp)#exit 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
#### 配置地址 
##### 配置接口 
摘要 :同一VRF的各个子接口必须配置相同网段的接口IP地址，必须配置相同的VLAN。 
各个接口的MTU、速率必须一致，一般保持默认值即可。 
每个子接口必须配置描述信息，配置命令description，具体描述信息以现场要求为准。 
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[ip-address network-segment conflict-check] disable命令，关闭同网段冲突检测功能，即开启共子网配置全局开关。
执行[configure terminal]命令，进入全局配置模式。
执行[interface] xgei-命令，进入接口配置模式。
执行no [shutdown]命令，开启物理端口。
 说明： 
初始状态下，端口都处于关闭状态，必须开启后才能通信。 
执行[exit]命令，退出当前配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[ip vrf forwarding]命令，将物理接口与对应的VRF绑定。
（可选）执行[ip address]命令，配置接口的IPv4地址。
（可选）执行[ipv6 enable]命令，配置支持IPv6。
 说明： 
是否配置双栈地址根据运营商的要求决定。 
（可选）执行[ipv6 address]命令，配置接口的IPv6地址。
执行no [shutdown]命令，开启物理端口。
执行[exit]命令，退出当前配置模式。
执行[arp]命令，进入ARP配置模式。
执行[interface] xgei-命令，进入接口配置模式。
执行[source-filtered] disable命令，关闭ARP源过滤。
执行[exit]命令，退出接口配置模式。
执行[exit]命令，退出ARP配置模式。
执行[vlan-configuration]命令，进入VLAN配置模式。
执行[interface] xgei-命令，进入VLAN子接口配置模式。
执行[encapsulation-dot1q]命令，配置子接口支持的VLAN ID。该VLAN ID需与交换机上规划配置的VLAN ID一致。
执行[exit]命令，退出VLAN子接口配置模式。
执行[exit]命令，退出VLAN配置模式。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划（母接口数量根据实际IPU数量来确定），数据规划示例参见下表。 
接口|子接口|VRF|IPv4地址|IPv6地址|VLAN ID
---|---|---|---|---|---
xgei-1/0/1/1|xgei-1/0/1/1.1|SBI|192.168.12.1255.255.255.240|2409:8086:8413:285d::1/64|520
xgei-1/0/1/1.2|xgei-1/0/1/1|GTP|192.168.12.17255.255.255.240|2409:8086:8413:285e::1/64|521
xgei-1/0/1/1.3|xgei-1/0/1/1|RAN|192.168.12.33255.255.255.240|2409:8086:8413:285f::1/64|522
xgei-1/0/1/1.4|xgei-1/0/1/1|SIG|192.168.12.49255.255.255.240|2409:8086:8413:2860::1/64|523
xgei-1/0/1/1.5|xgei-1/0/1/1|Gb|192.168.12.65255.255.255.240|2409:8086:8413:2861::1/64|524
xgei-1/0/1/1.6|xgei-1/0/1/1|Softsw|192.168.12.81255.255.255.240|2409:8086:8413:2862::1/64|525
xgei-1/0/1/1.7|xgei-1/0/1/1|Ga|192.168.12.97255.255.255.240|2409:8086:8413:2863::1/64|526
xgei-1/0/2/1|xgei-1/0/2/1.1|SBI|192.168.12.9255.255.255.240|2409:8086:8413:285d::2/64|520
xgei-1/0/2/1.2|xgei-1/0/2/1|GTP|192.168.12.18255.255.255.240|2409:8086:8413:285e::2/64|521
xgei-1/0/2/1.3|xgei-1/0/2/1|RAN|192.168.12.34255.255.255.240|2409:8086:8413:285f::2/64|522
xgei-1/0/2/1.4|xgei-1/0/2/1|SIG|192.168.12.50255.255.255.240|2409:8086:8413:2860::2/64|523
xgei-1/0/2/1.5|xgei-1/0/2/1|Gb|192.168.12.66255.255.255.240|2409:8086:8413:2861::2/64|524
xgei-1/0/2/1.6|xgei-1/0/2/1|Softsw|192.168.12.82255.255.255.240|2409:8086:8413:2862::2/64|525
xgei-1/0/2/1.7|xgei-1/0/2/1|Ga|192.168.12.98255.255.255.240|2409:8086:8413:2863::2/64|526
根据规划，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
关闭同网段冲突检测功能，命令如下。 
ZXROSNG(config)#ip-address network-segment conflict-check disable 
配置xgei-1/0/1/1及其子接口的相关信息，命令如下。 
ZXROSNG(config)#interface xgei-1/0/1/1  
ZXROSNG(config-if-xgei-1/0/1/1)#no shutdown  
ZXROSNG(config-if-xgei-1/0/1/1)#exit  
ZXROSNG(config)#interface xgei-1/0/1/1.1 
ZXROSNG(config-if-xgei-1/0/1/1.1)#ip vrf forwarding SBI 
ZXROSNG(config-if-xgei-1/0/1/1.1)#ip address 192.168.12.1 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.1)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.1)#ipv6 address 2409:8086:8413:285d::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.1)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.1)#exit  
ZXROSNG(config)#interface xgei-1/0/1/1.2 
ZXROSNG(config-if-xgei-1/0/1/1.2)#ip vrf forwarding GTP 
ZXROSNG(config-if-xgei-1/0/1/1.2)#ip address 192.168.12.17 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.2)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.2)#ipv6 address 2409:8086:8413:285e::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.2)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.2)#exit  
ZXROSNG(config)#interface xgei-1/0/1/1.3 
ZXROSNG(config-if-xgei-1/0/1/1.3)#ip vrf forwarding RAN 
ZXROSNG(config-if-xgei-1/0/1/1.3)#ip address 192.168.12.33 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.3)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.3)#ipv6 address 2409:8086:8413:285f::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.3)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.3)#exit 
ZXROSNG(config)#interface xgei-1/0/1/1.4 
ZXROSNG(config-if-xgei-1/0/1/1.4)#ip vrf forwarding SIG 
ZXROSNG(config-if-xgei-1/0/1/1.4)#ip address 192.168.12.49 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.4)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.4)#ipv6 address 2409:8086:8413:2860::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.4)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.4)#exit 
ZXROSNG(config)#interface xgei-1/0/1/1.5 
ZXROSNG(config-if-xgei-1/0/1/1.5)#ip vrf forwarding Gb 
ZXROSNG(config-if-xgei-1/0/1/1.5)#ip address 192.168.12.65 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.5)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.5)#ipv6 address 2409:8086:8413:2861::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.5)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.5)#exit 
ZXROSNG(config)#interface xgei-1/0/1/1.6 
ZXROSNG(config-if-xgei-1/0/1/1.6)#ip vrf forwarding Softsw 
ZXROSNG(config-if-xgei-1/0/1/1.6)#ip address 192.168.12.81 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.6)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.6)#ipv6 address 2409:8086:8413:2862::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.6)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.6)#exit 
ZXROSNG(config)#interface xgei-1/0/1/1.7 
ZXROSNG(config-if-xgei-1/0/1/1.7)#ip vrf forwarding Ga 
ZXROSNG(config-if-xgei-1/0/1/1.7)#ip address 192.168.12.97 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/1/1.7)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/1/1.7)#ipv6 address 2409:8086:8413:2863::1/64  
ZXROSNG(config-if-xgei-1/0/1/1.7)#no shutdown 
ZXROSNG(config-if-xgei-1/0/1/1.7)#exit 
配置xgei-1/0/2/1及其子接口的相关信息，命令如下。 
ZXROSNG(config)#interface xgei-1/0/2/1  
ZXROSNG(config-if-xgei-1/0/2/1)#no shutdown  
ZXROSNG(config-if-xgei-1/0/2/1)#exit  
ZXROSNG(config)#interface xgei-1/0/2/1.1 
ZXROSNG(config-if-xgei-1/0/2/1.1)#ip vrf forwarding SBI 
ZXROSNG(config-if-xgei-1/0/1/2.1)#ip address 192.168.12.9 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.1)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.1)#ipv6 address 2409:8086:8413:285d::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.1)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.1)#exit  
ZXROSNG(config)#interface xgei-1/0/2/1.2 
ZXROSNG(config-if-xgei-1/0/2/1.2)#ip vrf forwarding GTP 
ZXROSNG(config-if-xgei-1/0/2/1.2)#ip address 192.168.12.18 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.2)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.2)#ipv6 address 2409:8086:8413:285e::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.2)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.2)#exit  
ZXROSNG(config)#interface xgei-1/0/2/1.3 
ZXROSNG(config-if-xgei-1/0/2/1.3)#ip vrf forwarding RAN 
ZXROSNG(config-if-xgei-1/0/2/1.3)#ip address 192.168.12.34 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.3)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.3)#ipv6 address 2409:8086:8413:285f::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.3)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.3)#exit 
ZXROSNG(config)#interface xgei-1/0/1/1.4 
ZXROSNG(config-if-xgei-1/0/2/1.4)#ip vrf forwarding SIG 
ZXROSNG(config-if-xgei-1/0/2/1.4)#ip address 192.168.12.50 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.4)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.4)#ipv6 address 2409:8086:8413:2860::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.4)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.4)#exit 
ZXROSNG(config)#interface xgei-1/0/2/1.5 
ZXROSNG(config-if-xgei-1/0/2/1.5)#ip vrf forwarding Gb 
ZXROSNG(config-if-xgei-1/0/2/1.5)#ip address 192.168.12.66 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.5)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.5)#ipv6 address 2409:8086:8413:2861::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.5)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.5)#exit 
ZXROSNG(config)#interface xgei-1/0/2/1.6 
ZXROSNG(config-if-xgei-1/0/2/1.6)#ip vrf forwarding Softsw 
ZXROSNG(config-if-xgei-1/0/2/1.6)#ip address 192.168.12.82 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.6)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.6)#ipv6 address 2409:8086:8413:2862::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.6)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.6)#exit 
ZXROSNG(config)#interface xgei-1/0/2/1.7 
ZXROSNG(config-if-xgei-1/0/2/1.7)#ip vrf forwarding Ga 
ZXROSNG(config-if-xgei-1/0/2/1.7)#ip address 192.168.12.98 255.255.255.240  
ZXROSNG(config-if-xgei-1/0/2/1.7)#ipv6 enable 
ZXROSNG(config-if-xgei-1/0/2/1.7)#ipv6 address 2409:8086:8413:2863::2/64  
ZXROSNG(config-if-xgei-1/0/2/1.7)#no shutdown 
ZXROSNG(config-if-xgei-1/0/2/1.7)#exit 
关闭ARP源过滤，命令如下。 
ZXROSNG(config)#arp 
ZXROSNG(config-arp)#interface xgei-1/0/1/1 
ZXROSNG(config-arp-if-xgei-1/0/1/1)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.1 
ZXROSNG(config-arp-if-xgei-1/0/1/1.1)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.2 
ZXROSNG(config-arp-if-xgei-1/0/1/1.2)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.2)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.3 
ZXROSNG(config-arp-if-xgei-1/0/1/1.3)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.3)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.4 
ZXROSNG(config-arp-if-xgei-1/0/1/1.4)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.4)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.5 
ZXROSNG(config-arp-if-xgei-1/0/1/1.5)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.5)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.6 
ZXROSNG(config-arp-if-xgei-1/0/1/1.6)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.6)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.7 
ZXROSNG(config-arp-if-xgei-1/0/1/1.7)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.7)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/1/1.8 
ZXROSNG(config-arp-if-xgei-1/0/1/1.8)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/1/1.8)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1 
ZXROSNG(config-arp-if-xgei-1/0/2/1)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.1 
ZXROSNG(config-arp-if-xgei-1/0/2/1.1)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.1)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.2 
ZXROSNG(config-arp-if-xgei-1/0/2/1.2)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.2)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.3 
ZXROSNG(config-arp-if-xgei-1/0/2/1.3)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.3)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.4 
ZXROSNG(config-arp-if-xgei-1/0/2/1.4)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.4)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.5 
ZXROSNG(config-arp-if-xgei-1/0/2/1.5)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.5)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.6 
ZXROSNG(config-arp-if-xgei-1/0/2/1.6)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.6)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.7 
ZXROSNG(config-arp-if-xgei-1/0/2/1.7)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.7)#exit 
ZXROSNG(config-arp)#interface xgei-1/0/2/1.8 
ZXROSNG(config-arp-if-xgei-1/0/2/1.8)#source-filtered disable  
ZXROSNG(config-arp-if-xgei-1/0/2/1.8)#exit 
ZXROSNG(config-arp)#exit 
配置VLAN ID，命令如下。 
ZXROSNG(config)#vlan-configuration 
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.1 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.1)#encapsulation-dot1q 520  
ZXROSNG(config-vlan-if-xgei-1/0/1/1.1)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.2 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.2)#encapsulation-dot1q 521 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.2)#exit  
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.3 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.3)#encapsulation-dot1q 522  
ZXROSNG(config-vlan-if-xgei-1/0/1/1.3)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.4 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.4)#encapsulation-dot1q 523  
ZXROSNG(config-vlan-if-xgei-1/0/1/1.4)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.5 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.5)#encapsulation-dot1q 524  
ZXROSNG(config-vlan-if-xgei-1/0/1/1.5)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.6 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.6)#encapsulation-dot1q 525  
ZXROSNG(config-vlan-if-xgei-1/0/1/1.6)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/1.7 
ZXROSNG(config-vlan-if-xgei-1/0/1/1.7)#encapsulation-dot1q 526  
ZXROSNG(config-vlan-if-xgei-1/0/1/1.7)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/2.1 
ZXROSNG(config-vlan-if-xgei-1/0/1/2.1)#encapsulation-dot1q 520  
ZXROSNG(config-vlan-if-xgei-1/0/1/2.1)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/2/1.2 
ZXROSNG(config-vlan-if-xgei-1/0/2/1.2)#encapsulation-dot1q 521  
ZXROSNG(config-vlan-if-xgei-1/0/2/1.2)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/2/1.3 
ZXROSNG(config-vlan-if-xgei-1/0/2/1.3)#encapsulation-dot1q 522  
ZXROSNG(config-vlan-if-xgei-1/0/2/1.3)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/2.4 
ZXROSNG(config-vlan-if-xgei-1/0/1/2.4)#encapsulation-dot1q 523  
ZXROSNG(config-vlan-if-xgei-1/0/1/2.4)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/2.5 
ZXROSNG(config-vlan-if-xgei-1/0/1/2.5)#encapsulation-dot1q 524  
ZXROSNG(config-vlan-if-xgei-1/0/1/2.5)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/2.6 
ZXROSNG(config-vlan-if-xgei-1/0/1/2.6)#encapsulation-dot1q 525  
ZXROSNG(config-vlan-if-xgei-1/0/1/2.6)#exit 
ZXROSNG(config-vlan)#interface xgei-1/0/1/2.7 
ZXROSNG(config-vlan-if-xgei-1/0/1/2.7)#encapsulation-dot1q 526  
ZXROSNG(config-vlan-if-xgei-1/0/1/2.7)#exit 
ZXROSNG(config-vlan)#exit 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
相关任务 :配置完成后，可以执行[show ip interface brief]命令查看接口配置的相关信息。
配置完成后，可以执行[show interface-vlan]命令查看VLAN配置的相关信息。
##### 配置loopback地址 
摘要 :本节介绍如何配置ZXUN uMAC的loopback地址。
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[interface] loopback命令，进入接口配置模式。
执行[description]命令，配置loopback描述信息。
执行[ip vrf forwarding]命令，将loopback与对应的VRF绑定。
执行[ip address]命令，配置loopback的IPv4地址。
执行[ipv6 enable]命令，配置支持IPv6。
执行[ipv6 address]命令，配置loopback的IPv6地址。
执行[exit]命令，退出当前配置模式。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
loopback|描述信息|VRF|IPv4地址|IPv6地址
---|---|---|---|---
loopback1|SERVICE SBI|SBI|10.124.17.80255.255.255.255|2409:802F:5003:1715::1101:101/128
loopback2|SERVICE MMESGSN GTPC|GTP|223.103.77.128255.255.255.255|2409:802F:2905:0701::04:101/128
Loopback3|SERVICEAMF GTPC|223.103.77.129255.255.255.255|GTP|2409:802F:2905:0701::04:102/128
Loopback4|SERVICE GTPU|223.103.77.130255.255.255.255|GTP|2409:802F:2905:0701::04:103/128
Loopback5|SERVICE GTPU|223.103.77.131255.255.255.255|GTP|2409:802F:2905:0701::04:104/128
Loopback6|SERVICE N2|RAN|10.124.108.64255.255.255.255|2409:802F:5015:1715::1101:101/128
Loopback7|SERVICE N2|10.124.108.65255.255.255.255|RAN|2409:802F:5015:1715::1101:102/128
Loopback8|SERVICE S1-MME|RAN|10.124.108.66255.255.255.255|2409:802F:5015:1715::1101:103/128
Loopback9|SERVICE S1-MME|10.124.108.67255.255.255.255|RAN|2409:802F:5015:1715::1101:104/128
Loopback10|SERVICE GB|Gb|10.35.123.128255.255.255.255|2409:802F:5016:1715:21::1011/128
Loopback11|SERVICE GB|10.35.123.129255.255.255.255|Gb|2409:802F:5016:1715:21::1012/128
Loopback12|SERVICE S6A|SIG|10.124.17.81255.255.255.255|2409:802F:5003:1715::1101:102/128
Loopback13|SERVICE S6A|10.124.17.82255.255.255.255|SIG|2409:802F:5003:1715::1101:103/128
Loopback14|SERVICE SLS|10.124.17.83255.255.255.255|SIG|2409:802F:5003:1715::1101:104/128
Loopback15|SERVICE SLS|10.124.17.84255.255.255.255|SIG|2409:802F:5003:1715::1101:105/128
Loopback16|SERVICE GR|SIG|10.124.17.85255.255.255.255|2409:802F:5003:1715::1101:106/128
Loopback17|SERVICE GR|10.124.17.86255.255.255.255|SIG|2409:802F:5003:1715::1101:107/128
Loopback18|SERVICE CHR|10.124.17.87255.255.255.255|SIG|2409:802F:5003:1715::1101:108/128
Loopback19|SERVICE IUPS-C|SIG|10.124.17.88255.255.255.255|2409:802F:5003:1715::1101:109/128
Loopback20|SERVICE IUPS-C|10.124.17.89255.255.255.255|SIG|2409:802F:5003:1715::1101:10A/128
Loopback21|SERVICE IUPS-U|10.124.17.90255.255.255.255|SIG|2409:802F:5003:1715::1101:10B/128
Loopback22|SERVICE SGS|Softsw|10.36.192.128255.255.255.255|2409:802F:500B:1715:21::1011/128
Loopback23|SERVICE SGS|10.36.192.129255.255.255.255|Softsw|2409:802F:500B:1715:21::1012/128
Loopback24|SERVICE SV|10.36.192.130255.255.255.255|Softsw|2409:802F:500B:1715:21::1013/128
Loopback25|SERVICE GA|Ga|-|2409:802F:5012:0712:0021::1011/128
根据规划，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
配置loopback1的相关信息，命令如下。 
ZXROSNG(config)#interface loopback1 
ZXROSNG(config-if-loopback1)#description SERVICE SBI  
ZXROSNG(config-if-loopback1)#ip vrf forwarding SBI 
ZXROSNG(config-if-loopback1)#ip address 10.124.17.80 255.255.255.255  
ZXROSNG(config-if-loopback1)#ipv6 enable 
ZXROSNG(config-if-loopback1)#ipv6 address 2409:802F:5003:1715::1101:101/128 
ZXROSNG(config-if-loopback1)#exit 
配置loopback2的相关信息，命令如下。 
ZXROSNG(config)#interface loopback2 
ZXROSNG(config-if-loopback2)#description SERVICE MMESGSN GTPC  
ZXROSNG(config-if-loopback2)#ip vrf forwarding GTP 
ZXROSNG(config-if-loopback2)#ip address 223.103.77.128 255.255.255.255  
ZXROSNG(config-if-loopback2)#ipv6 enable 
ZXROSNG(config-if-loopback2)#ipv6 address 2409:802F:2905:0701::04:101/128  
ZXROSNG(config-if-loopback2)#exit 
配置loopback3的相关信息，命令如下。 
ZXROSNG(config)#interface loopback3 
ZXROSNG(config-if-loopback3)#description SERVICE AMF GTPC  
ZXROSNG(config-if-loopback3)#ip vrf forwarding GTP 
ZXROSNG(config-if-loopback3)#ip address 223.103.77.129 255.255.255.255 
ZXROSNG(config-if-loopback3)#ipv6 enable 
ZXROSNG(config-if-loopback3)#ipv6 address 2409:802F:2905:0701::04:102/128  
ZXROSNG(config-if-loopback3)#exit 
配置loopback4的相关信息，命令如下。 
ZXROSNG(config)#interface loopback4 
ZXROSNG(config-if-loopback4)#description SERVICE GTPU  
ZXROSNG(config-if-loopback4)#ip vrf forwarding GTP 
ZXROSNG(config-if-loopback4)#ip address 223.103.77.130 255.255.255.255 
ZXROSNG(config-if-loopback4)#ipv6 enable 
ZXROSNG(config-if-loopback4)#ipv6 address 2409:802F:2905:0701::04:103/128  
ZXROSNG(config-if-loopback4)#exit 
配置loopback5的相关信息，命令如下。 
ZXROSNG(config)#interface loopback5 
ZXROSNG(config-if-loopback5)#description SERVICE GTPU  
ZXROSNG(config-if-loopback5)#ip vrf forwarding GTP 
ZXROSNG(config-if-loopback5)#ip address 223.103.77.131 255.255.255.255 
ZXROSNG(config-if-loopback5)#ipv6 enable 
ZXROSNG(config-if-loopback5)#ipv6 address 2409:802F:2905:0701::04:104/128  
ZXROSNG(config-if-loopback5)#exit 
配置loopback6的相关信息，命令如下。 
ZXROSNG(config)#interface loopback6 
ZXROSNG(config-if-loopback6)#description SERVICE N2  
ZXROSNG(config-if-loopback6)#ip vrf forwarding RAN 
ZXROSNG(config-if-loopback6)#ip address 10.124.108.64 255.255.255.255  
ZXROSNG(config-if-loopback6)#ipv6 enable 
ZXROSNG(config-if-loopback6)#ipv6 address 2409:802F:5015:1715::1101:101/128 
ZXROSNG(config-if-loopback5)#exit 
配置loopback7的相关信息，命令如下。 
ZXROSNG(config)#interface loopback7 
ZXROSNG(config-if-loopback7)#description SERVICE N2  
ZXROSNG(config-if-loopback7)#ip vrf forwarding RAN 
ZXROSNG(config-if-loopback7)#ip address 10.124.108.65 255.255.255.255 
ZXROSNG(config-if-loopback7)#ipv6 enable 
ZXROSNG(config-if-loopback7)#ipv6 address 2409:802F:5015:1715::1101:102/128   
ZXROSNG(config-if-loopback7)#exit 
配置loopback8的相关信息，命令如下。 
ZXROSNG(config)#interface loopback8 
ZXROSNG(config-if-loopback8)#description SERVICE S1-MME 
ZXROSNG(config-if-loopback8)#ip vrf forwarding RAN 
ZXROSNG(config-if-loopback8)#ip address 10.124.108.66 255.255.255.255  
ZXROSNG(config-if-loopback8)#ipv6 enable 
ZXROSNG(config-if-loopback8)#ipv6 address 2409:802F:5015:1715::1101:103/128 
ZXROSNG(config-if-loopback8)#exit 
配置loopback9的相关信息，命令如下。 
ZXROSNG(config)#interface loopback9 
ZXROSNG(config-if-loopback9)#description SERVICE S1-MME 
ZXROSNG(config-if-loopback9)#ip vrf forwarding RAN 
ZXROSNG(config-if-loopback9)#ip address 10.124.108.67 255.255.255.255 
ZXROSNG(config-if-loopback9)#ipv6 enable 
ZXROSNG(config-if-loopback9)#ipv6 address 2409:802F:5015:1715::1101:104/128   
ZXROSNG(config-if-loopback9)#exit 
配置loopback10的相关信息，命令如下。 
ZXROSNG(config)#interface loopback10 
ZXROSNG(config-if-loopback10)#description SERVICE GB 
ZXROSNG(config-if-loopback10)#ip vrf forwarding Gb 
ZXROSNG(config-if-loopback10)#ip address 10.35.123.128 255.255.255.255  
ZXROSNG(config-if-loopback10)#ipv6 enable 
ZXROSNG(config-if-loopback10)#ipv6 address 2409:802F:5016:1712:0021::1011/128 
ZXROSNG(config-if-loopback10)#exit 
配置loopback11的相关信息，命令如下。 
ZXROSNG(config)#interface loopback11 
ZXROSNG(config-if-loopback11)#description SERVICE GB 
ZXROSNG(config-if-loopback11)#ip vrf forwarding Gb  
ZXROSNG(config-if-loopback11)#ip address 10.35.123.129 255.255.255.255 
ZXROSNG(config-if-loopback11)#ipv6 enable 
ZXROSNG(config-if-loopback11)#ipv6 address 2409:802F:5016:1712:0021::1012/128   
ZXROSNG(config-if-loopback11)#exit 
配置loopback12的相关信息，命令如下。 
ZXROSNG(config)#interface loopback12 
ZXROSNG(config-if-loopback12)#description SERVICE S6A 
ZXROSNG(config-if-loopback12)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback12)#ip address 10.124.17.81 255.255.255.255  
ZXROSNG(config-if-loopback12)#ipv6 enable 
ZXROSNG(config-if-loopback12)#ipv6 address 2409:802F:5003:1715::1101:102/128 
ZXROSNG(config-if-loopback12)#exit 
配置loopback13的相关信息，命令如下。 
ZXROSNG(config)#interface loopback13 
ZXROSNG(config-if-loopback13)#description SERVICE S6A 
ZXROSNG(config-if-loopback13)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback13)#ip address 10.124.17.82 255.255.255.255 
ZXROSNG(config-if-loopback13)#ipv6 enable 
ZXROSNG(config-if-loopback13)#ipv6 address 2409:802F:5003:1715::1101:103/128  
ZXROSNG(config-if-loopback13)#exit 
配置loopback14的相关信息，命令如下。 
ZXROSNG(config)#interface loopback14 
ZXROSNG(config-if-loopback14)#description SERVICE SLS 
ZXROSNG(config-if-loopback14)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback14)#ip address 10.124.17.83 255.255.255.255 
ZXROSNG(config-if-loopback14)#ipv6 enable 
ZXROSNG(config-if-loopback14)#ipv6 address 2409:802F:5003:1715::1101:104/128  
ZXROSNG(config-if-loopback14)#exit 
配置loopback15的相关信息，命令如下。 
ZXROSNG(config)#interface loopback15 
ZXROSNG(config-if-loopback15)#description SERVICE SLS 
ZXROSNG(config-if-loopback15)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback15)#ip address 10.124.17.84 255.255.255.255 
ZXROSNG(config-if-loopback15)#ipv6 enable 
ZXROSNG(config-if-loopback15)#ipv6 address 2409:802F:5003:1715::1101:105/128   
ZXROSNG(config-if-loopback15)#exit 
配置loopback16的相关信息，命令如下。 
ZXROSNG(config)#interface loopback16 
ZXROSNG(config-if-loopback16)#description SERVICE GR 
ZXROSNG(config-if-loopback16)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback16)#ip address 10.124.17.85 255.255.255.255  
ZXROSNG(config-if-loopback16)#ipv6 enable 
ZXROSNG(config-if-loopback16)#ipv6 address 2409:802F:5003:1715::1101:106/128  
ZXROSNG(config-if-loopback7)#exit 
配置loopback17的相关信息，命令如下。 
ZXROSNG(config)#interface loopback17 
ZXROSNG(config-if-loopback17)#description SERVICE GR 
ZXROSNG(config-if-loopback17)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback17)#ip address 10.124.17.86 255.255.255.255 
ZXROSNG(config-if-loopback17)#ipv6 enable 
ZXROSNG(config-if-loopback17)#ipv6 address 2409:802F:5003:1715::1101:107/128 
ZXROSNG(config-if-loopback17)#exit 
配置loopback18的相关信息，命令如下。 
ZXROSNG(config)#interface loopback18 
ZXROSNG(config-if-loopback18)#description SERVICE CHR 
ZXROSNG(config-if-loopback18)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback18)#ip address 10.124.17.87 255.255.255.255 
ZXROSNG(config-if-loopback18)#ipv6 enable 
ZXROSNG(config-if-loopback18)#ipv6 address 2409:802F:5003:1715::1101:108/128 
ZXROSNG(config-if-loopback18)#exit 
配置loopback19的相关信息，命令如下。 
ZXROSNG(config)#interface loopback19 
ZXROSNG(config-if-loopback19)#description SERVICE IUPSC 
ZXROSNG(config-if-loopback19)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback19)#ip address 10.124.17.88 255.255.255.255  
ZXROSNG(config-if-loopback19)#ipv6 enable 
ZXROSNG(config-if-loopback19)#ipv6 address 2409:802F:5003:1715::1101:109/128 
ZXROSNG(config-if-loopback19)#exit 
配置loopback20的相关信息，命令如下。 
ZXROSNG(config)#interface loopback20 
ZXROSNG(config-if-loopback20)#description SERVICE IUPSC 
ZXROSNG(config-if-loopback20)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback20)#ip address 10.124.17.89 255.255.255.255 
ZXROSNG(config-if-loopback20)#ipv6 enable 
ZXROSNG(config-if-loopback20)#ipv6 address 2409:802F:5003:1715::1101:10A/128  
ZXROSNG(config-if-loopback8)#exit 
配置loopback21的相关信息，命令如下。 
ZXROSNG(config)#interface loopback21 
ZXROSNG(config-if-loopback21)#description SERVICE IUPSU 
ZXROSNG(config-if-loopback21)#ip vrf forwarding SIG 
ZXROSNG(config-if-loopback21)#ip address 10.124.17.90 255.255.255.255 
ZXROSNG(config-if-loopback21)#ipv6 enable 
ZXROSNG(config-if-loopback21)#ipv6 address 2409:802F:5003:1715::1101:10B/128 
ZXROSNG(config-if-loopback21)#exit 
配置loopback22的相关信息，命令如下。 
ZXROSNG(config)#interface loopback22 
ZXROSNG(config-if-loopback22)#description SERVICE SGS 
ZXROSNG(config-if-loopback22)#ip vrf forwarding Softsw 
ZXROSNG(config-if-loopback22)#ip address 10.36.192.128 255.255.255.255  
ZXROSNG(config-if-loopback22)#ipv6 enable 
ZXROSNG(config-if-loopback22)#ipv6 address 2409:802F:500B:0712:21::1011/128 
ZXROSNG(config-if-loopback22)#exit 
配置loopback23的相关信息，命令如下。 
ZXROSNG(config)#interface loopback23 
ZXROSNG(config-if-loopback23)#description SERVICE SGS 
ZXROSNG(config-if-loopback23)#ip vrf forwarding Softsw 
ZXROSNG(config-if-loopback23)#ip address 10.36.192.129 255.255.255.255 
ZXROSNG(config-if-loopback23)#ipv6 enable 
ZXROSNG(config-if-loopback23)#ipv6 address 2409:802F:500B:0712:21::1012/128 
ZXROSNG(config-if-loopback23)#exit 
配置loopback24的相关信息，命令如下。 
ZXROSNG(config)#interface loopback24 
ZXROSNG(config-if-loopback24)#description SERVICE SV 
ZXROSNG(config-if-loopback24)#ip vrf forwarding Softsw 
ZXROSNG(config-if-loopback24)#ip address 10.36.192.130 255.255.255.255 
ZXROSNG(config-if-loopback24)#ipv6 enable 
ZXROSNG(config-if-loopback24)#ipv6 address 2409:802F:500B:0712:21::1013/128 
ZXROSNG(config-if-loopback24)#exit 
配置loopback25的相关信息，命令如下。 
ZXROSNG(config)#interface loopback25 
ZXROSNG(config-if-loopback25)#description SERVICE GA 
ZXROSNG(config-if-loopback25)#ip vrf forwarding Ga 
ZXROSNG(config-if-loopback25)#ipv6 enable 
ZXROSNG(config-if-loopback25)#ipv6 address 2409:802F:5012:0712:0021::1011/128 
ZXROSNG(config-if-loopback25)#exit 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
相关任务 :配置完成后，可以执行[show ip interface brief]命令查看相关信息。
#### 配置静态路由及BFD 
##### 默认静态路由 
默认静态路由是一种特殊的静态路由。当路由表中的所有路由选择失败时，系统可以使用默认路由，给报文指定一个最终的发送地。 
使用默认路由可减少路由选择所占用的时间与包转发所占用的带宽资源，能在一定程度上满足大量用户同时进行通信的需求。如果没有默认路由且报文的目的地址不在路由表中，则该报文被丢弃，为了避免这种情况发生，需要配置默认路由数据。 
##### BFD功能 
运营商部署分组交换网，当ZXUN uMAC与其他网元通过交换机/路由器/防火墙连接时，为了减小设备故障对业务的影响，提高网络的可用性，设备需要能够尽快检测到与相邻设备间的通信故障，以便能够及时采取措施，从而保证业务继续进行。可以在相应的接口配置BFD会话。
BFD功能是指在两个需要通信的系统间建立BFD会话，并沿这两个系统之间的路径周期性发送BFD检测报文，如果一方在规定的时间内没有收到对端的BFD检测报文，则认为此条路径发生了故障。
BFD能够在相邻系统之间的任何类型的通道（例如：物理链路、虚电路、隧道、多跳路由通道以及非直连通道）上进行故障检测。若在一个商定的时间段内本端没有收到对端的检测报文，则判断与对端的通信通道出现故障。此时，BFD会话处于Down状态，系统通知上层协议重新选路。
配置说明 :对于SDN网络，网元侧不需要配置BFD相关数据，但是数通设备一侧需要配置BFD数据。 
对于非SDN网络，网元侧需要配置BFD相关数据。 
##### 配置静态路由（SDN网络） 
摘要 :本节介绍如何配置SDN网络的ZXUN uMAC与互联网元之间的默认静态路由数据。对于SDN网络，网元侧不需要配置BFD相关数据，但是数通设备一侧需要配置BFD数据。
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0节点。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip route]命令或[ipv6 route]命令，配置静态路由。
[ip route]命令中，如果此条静态路由的目的地址和子网掩码都为0.0.0.0，则表示此条静态路由是默认路由，否则就是非默认路由。
[ipv6 route]命令中，如果此条静态路由的目的IPv6地址/掩码地址为::/0，则表示此条静态路由是默认路由，否则就是非默认路由。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
VRF|目的IP地址|子网掩码|子接口|下一跳地址|是否开启BFD功能
---|---|---|---|---|---
SBI|0.0.0.0|0.0.0.0|1/0/1/1.1|192.168.12.14|否
SBI|0.0.0.0|0.0.0.0|1/0/2/1.1|192.168.12.14|否
GTP|0.0.0.0|0.0.0.0|1/0/1/1.2|192.168.12.30|否
GTP|0.0.0.0|0.0.0.0|1/0/2/1.2|192.168.12.30|否
RAN|0.0.0.0|0.0.0.0|1/0/1/1.3|192.168.12.46|否
RAN|0.0.0.0|0.0.0.0|1/0/2/1.3|192.168.12.46|否
SIG|0.0.0.0|0.0.0.0|1/0/1/1.4|192.168.12.62|否
SIG|0.0.0.0|0.0.0.0|1/0/2/1.4|192.168.12.62|否
Gb|0.0.0.0|0.0.0.0|1/0/1/1.5|192.168.12.78|否
Gb|0.0.0.0|0.0.0.0|1/0/2/1.5|192.168.12.78|否
Softsw|0.0.0.0|0.0.0.0|1/0/1/1.6|192.168.12.94|否
Softsw|0.0.0.0|0.0.0.0|1/0/2/1.6|192.168.12.94|否
VRF|目的IPv6地址/掩码地址|子接口|下一跳IPv6地址|是否开启BFD功能
---|---|---|---|---
SBI|::/0|1/0/1/1.1|2409:8086:8413:285d::ffff/64|否
SBI|::/0|1/0/2/1.1|2409:8086:8413:285d::ffff/64|否
GTP|::/0|1/0/1/1.2|2409:8086:8413:285e::ffff/64|否
GTP|::/0|1/0/2/1.2|2409:8086:8413:285e::ffff/64|否
RAN|::/0|1/0/1/1.3|2409:8086:8413:285f::ffff/64|否
RAN|::/0|1/0/2/1.3|2409:8086:8413:285f::ffff/64|否
SIG|::/0|1/0/1/1.4|2409:8086:8413:2860::ffff/64|否
SIG|::/0|1/0/2/1.4|2409:8086:8413:2860::ffff/64|否
Gb|::/0|1/0/1/1.5|2409:8086:8413:2861::ffff/64|否
Gb|::/0|1/0/2/1.5|2409:8086:8413:2861::ffff/64|否
Softsw|::/0|1/0/1/1.6|2409:8086:8413:2862::ffff/64|否
Softsw|::/0|1/0/2/1.6|2409:8086:8413:2862::ffff/64|否
Ga|::/0|1/0/1/1.7|2409:8086:8413:2863::ffff/64|否
Ga|::/0|1/0/2/1.7|2409:8086:8413:2863::ffff/64|否
根据规划，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
配置静态路由，命令如下。 
ZXROSNG(config)#ip route vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.12.14 
ZXROSNG(config)#ip route vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.12.14 
ZXROSNG(config)#ipv6 route vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8413:285d::ffff/64 
ZXROSNG(config)#ipv6 route vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8413:285d::ffff/64 
ZXROSNG(config)#ip route vrf GTP 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.12.30 
ZXROSNG(config)#ip route vrf GTP 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.12.30 
ZXROSNG(config)#ipv6 route vrf GTP ::/0 xgei-1/0/1/1.2 2409:8086:8413:285e::ffff/64 
ZXROSNG(config)#ipv6 route vrf GTP ::/0 xgei-1/0/2/1.2 2409:8086:8413:285e::ffff/64 
ZXROSNG(config)#ip route vrf RAN 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.12.46 
ZXROSNG(config)#ip route vrf RAN 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.12.46 
ZXROSNG(config)#ipv6 route vrf RAN ::/0 xgei-1/0/1/1.3 2409:8086:8413:285f::ffff/64 
ZXROSNG(config)#ipv6 route vrf RAN ::/0 xgei-1/0/2/1.3 2409:8086:8413:285f::ffff/64 
ZXROSNG(config)#ip route vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.12.62 
ZXROSNG(config)#ip route vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.12.62 
ZXROSNG(config)#ipv6 route vrf SIG ::/0 xgei-1/0/1/1.4 2409:8086:8413:2860::ffff/64 
ZXROSNG(config)#ipv6 route vrf SIG ::/0 xgei-1/0/2/1.4 2409:8086:8413:2860::ffff/64 
ZXROSNG(config)#ip route vrf Gb 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.12.78 
ZXROSNG(config)#ip route vrf Gb 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.12.78 
ZXROSNG(config)#ipv6 route vrf Gb ::/0 xgei-1/0/1/1.5 2409:8086:8413:2861::ffff/64 
ZXROSNG(config)#ipv6 route vrf Gb ::/0 xgei-1/0/2/1.5 2409:8086:8413:2861::ffff/64 
ZXROSNG(config)#ip route vrf Softsw 0.0.0.0 0.0.0.0 xgei-1/0/1/1.6 192.168.12.94 
ZXROSNG(config)#ip route vrf Softsw 0.0.0.0 0.0.0.0 xgei-1/0/2/1.6 192.168.12.94 
ZXROSNG(config)#ipv6 route vrf Softsw ::/0 xgei-1/0/1/1.6 2409:8086:8413:2862::ffff/64 
ZXROSNG(config)#ipv6 route vrf Softsw ::/0 xgei-1/0/2/1.6 2409:8086:8413:2862::ffff/64 
ZXROSNG(config)#ipv6 route vrf Ga ::/0 xgei-1/0/1/1.7 2409:8086:8413:2863::ffff/64 
ZXROSNG(config)#ipv6 route vrf Ga ::/0 xgei-1/0/2/1.7 2409:8086:8413:2863::ffff/64 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
相关任务 :配置完成后，可以执行如下命令查看相关信息。 
show ip forwarding route vrf <vrf_name>：查询路由信息中配置了VRF的IPv4静态路由。 
show ipv6 forwarding route vrf <vrf_name>：查询路由信息中配置了VRF的IPv6静态路由。 
##### 配置静态路由及BFD（非SDN网络） 
摘要 :本节介绍如何配置非SDN网络的ZXUN uMAC与互联网元之间的默认静态路由数据。对于非SDN网络，网元侧需要配置BFD相关数据。
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0节点。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip route]命令或[ipv6 route]命令，配置静态路由。
[ip route]命令中，如果此条静态路由的目的地址和子网掩码都为0.0.0.0，则表示此条静态路由是默认路由，否则就是非默认路由。
[ipv6 route]命令中，如果此条静态路由的目的IPv6地址/掩码地址为::/0，则表示此条静态路由是默认路由，否则就是非默认路由。
执行[bfd]命令，进入BFD配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[time-negotiation]命令，设置BFD会话发送检测报文的时间间隔、接收检测报文的最小时间间隔和检测倍数。
执行[exit]命令，退出当前配置模式。
执行[exit]命令，退出当前配置模式。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
VRF|目的IP地址|子网掩码|子接口|下一跳地址|是否开启BFD功能
---|---|---|---|---|---
SBI|0.0.0.0|0.0.0.0|1/0/1/1.1|192.168.12.12|是
192.168.12.13|SBI|0.0.0.0|0.0.0.0|1/0/1/1.1|是
SBI|0.0.0.0|0.0.0.0|1/0/2/1.1|192.168.12.12|是
192.168.12.13|SBI|0.0.0.0|0.0.0.0|1/0/2/1.1|是
GTP|0.0.0.0|0.0.0.0|1/0/1/1.2|192.168.12.28|是
192.168.12.29|GTP|0.0.0.0|0.0.0.0|1/0/1/1.2|是
GTP|0.0.0.0|0.0.0.0|1/0/2/1.2|192.168.12.28|是
192.168.12.29|GTP|0.0.0.0|0.0.0.0|1/0/2/1.2|是
RAN|0.0.0.0|0.0.0.0|1/0/1/1.3|192.168.12.44|是
192.168.12.45|RAN|0.0.0.0|0.0.0.0|1/0/1/1.3|是
RAN|0.0.0.0|0.0.0.0|1/0/2/1.3|192.168.12.44|是
192.168.12.45|RAN|0.0.0.0|0.0.0.0|1/0/2/1.3|是
SIG|0.0.0.0|0.0.0.0|1/0/1/1.4|192.168.12.60|是
192.168.12.61|SIG|0.0.0.0|0.0.0.0|1/0/1/1.4|是
SIG|0.0.0.0|0.0.0.0|1/0/2/1.4|192.168.12.60|是
192.168.12.61|SIG|0.0.0.0|0.0.0.0|1/0/2/1.4|是
Gb|0.0.0.0|0.0.0.0|1/0/1/1.5|192.168.12.76|是
192.168.12.77|Gb|0.0.0.0|0.0.0.0|1/0/1/1.5|是
Gb|0.0.0.0|0.0.0.0|1/0/2/1.5|192.168.12.76|是
192.168.12.77|Gb|0.0.0.0|0.0.0.0|1/0/2/1.5|是
Softsw|0.0.0.0|0.0.0.0|1/0/1/1.6|192.168.12.92|是
192.168.12.93|Softsw|0.0.0.0|0.0.0.0|1/0/1/1.6|是
Softsw|0.0.0.0|0.0.0.0|1/0/2/1.6|192.168.12.92|是
192.168.12.93|Softsw|0.0.0.0|0.0.0.0|1/0/2/1.6|是
VRF|目的IPv6地址/掩码地址|子接口|下一跳IPv6地址|是否开启BFD功能
---|---|---|---|---
SBI|::/0|1/0/1/1.1|2409:8086:8413:285d::fffd|是
2409:8086:8413:285d::fffe|SBI|::/0|1/0/1/1.1|是
SBI|::/0|1/0/2/1.1|2409:8086:8413:285d::fffd|是
2409:8086:8413:285d::fffe|SBI|::/0|1/0/2/1.1|是
GTP|::/0|1/0/1/1.2|2409:8086:8413:285e::fffd|是
2409:8086:8413:285e::fffe|GTP|::/0|1/0/1/1.2|是
GTP|::/0|1/0/2/1.2|2409:8086:8413:285e::fffd|是
2409:8086:8413:285e::fffe|GTP|::/0|1/0/2/1.2|是
RAN|::/0|1/0/1/1.3|2409:8086:8413:285f::fffd|是
2409:8086:8413:285f::fffe|RAN|::/0|1/0/1/1.3|是
RAN|::/0|1/0/2/1.3|2409:8086:8413:285f::fffd|是
2409:8086:8413:285f::fffe|RAN|::/0|1/0/2/1.3|是
SIG|::/0|1/0/1/1.4|2409:8086:8413:2860::fffd|是
2409:8086:8413:2860::fffe|SIG|::/0|1/0/1/1.4|是
SIG|::/0|1/0/2/1.4|2409:8086:8413:2860::fffd|是
2409:8086:8413:2860::fffe|SIG|::/0|1/0/2/1.4|是
Gb|::/0|1/0/1/1.5|2409:8086:8413:2861::fffd|是
2409:8086:8413:2861::fffe|Gb|::/0|1/0/1/1.5|是
Gb|::/0|1/0/2/1.5|2409:8086:8413:2861::fffd|是
2409:8086:8413:2861::fffe|Gb|::/0|1/0/2/1.5|是
Softsw|::/0|1/0/1/1.6|2409:8086:8413:2862::fffd|是
2409:8086:8413:2862::fffe|Softsw|::/0|1/0/1/1.6|是
Softsw|::/0|1/0/2/1.6|2409:8086:8413:2862::fffd|是
2409:8086:8413:2862::fffe|Softsw|::/0|1/0/2/1.6|是
Ga|::/0|1/0/1/1.7|2409:8086:8413:2863::fffd|是
2409:8086:8413:2863::fffe|Ga|::/0|1/0/1/1.7|是
Ga|::/0|1/0/2/1.7|2409:8086:8413:2863::fffd|是
2409:8086:8413:2863::fffe|Ga|::/0|1/0/2/1.7|是
参数|取值|说明
---|---|---
BFD会话发送检测报文的时间间隔|500毫秒|本示例把所有接口都配置为同一值。
BFD接收检测报文的最小时间间隔|500毫秒|本示例把所有接口都配置为同一值。
BFD检测倍数|4倍|本示例把所有接口都配置为同一值。
根据规划，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
配置静态路由，命令如下。 
ZXROSNG(config)#ip route vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.12.12 bfd enable 
ZXROSNG(config)#ip route vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.12.13 bfd enable 
ZXROSNG(config)#ip route vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.12.12 bfd enable 
ZXROSNG(config)#ip route vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.12.13 bfd enable 
ZXROSNG(config)#ipv6 route vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8413:285d::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8413:285d::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8413:285d::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8413:285d::fffe bfd enable 
ZXROSNG(config)#ip route vrf GTP 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.12.28 bfd enable 
ZXROSNG(config)#ip route vrf GTP 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.12.29 bfd enable 
ZXROSNG(config)#ip route vrf GTP 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.12.28 bfd enable 
ZXROSNG(config)#ip route vrf GTP 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.12.29 bfd enable 
ZXROSNG(config)#ipv6 route vrf GTP ::/0 xgei-1/0/1/1.2 2409:8086:8413:285e::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf GTP ::/0 xgei-1/0/1/1.2 2409:8086:8413:285e::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf GTP ::/0 xgei-1/0/2/1.2 2409:8086:8413:285e::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf GTP ::/0 xgei-1/0/2/1.2 2409:8086:8413:285e::fffe bfd enable 
ZXROSNG(config)#ip route vrf RAN 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.12.44 bfd enable 
ZXROSNG(config)#ip route vrf RAN 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.12.45 bfd enable 
ZXROSNG(config)#ip route vrf RAN 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.12.44 bfd enable 
ZXROSNG(config)#ip route vrf RAN 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.12.45 bfd enable 
ZXROSNG(config)#ipv6 route vrf RAN ::/0 xgei-1/0/1/1.3 2409:8086:8413:285f::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf RAN ::/0 xgei-1/0/1/1.3 2409:8086:8413:285f::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf RAN ::/0 xgei-1/0/2/1.3 2409:8086:8413:285f::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf RAN ::/0 xgei-1/0/2/1.3 2409:8086:8413:285f::fffe bfd enable 
ZXROSNG(config)#ip route vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.12.60 bfd enable 
ZXROSNG(config)#ip route vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.12.61 bfd enable 
ZXROSNG(config)#ip route vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.12.60 bfd enable 
ZXROSNG(config)#ip route vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.12.61 bfd enable 
ZXROSNG(config)#ipv6 route vrf SIG ::/0 xgei-1/0/1/1.4 2409:8086:8413:2860::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf SIG ::/0 xgei-1/0/1/1.4 2409:8086:8413:2860::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf SIG ::/0 xgei-1/0/2/1.4 2409:8086:8413:2860::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf SIG ::/0 xgei-1/0/2/1.4 2409:8086:8413:2860::fffe bfd enable 
ZXROSNG(config)#ip route vrf Gb 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.12.76 bfd enable 
ZXROSNG(config)#ip route vrf Gb 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.12.77 bfd enable 
ZXROSNG(config)#ip route vrf Gb 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.12.76 bfd enable 
ZXROSNG(config)#ip route vrf Gb 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.12.77 bfd enable 
ZXROSNG(config)#ipv6 route vrf Gb ::/0 xgei-1/0/1/1.5 2409:8086:8413:2861::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf Gb ::/0 xgei-1/0/1/1.5 2409:8086:8413:2861::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf Gb ::/0 xgei-1/0/2/1.5 2409:8086:8413:2861::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf Gb ::/0 xgei-1/0/2/1.5 2409:8086:8413:2861::fffe bfd enable 
ZXROSNG(config)#ip route vrf Softsw 0.0.0.0 0.0.0.0 xgei-1/0/1/1.6 192.168.12.92 bfd enable 
ZXROSNG(config)#ip route vrf Softsw 0.0.0.0 0.0.0.0 xgei-1/0/1/1.6 192.168.12.93 bfd enable 
ZXROSNG(config)#ip route vrf Softsw 0.0.0.0 0.0.0.0 xgei-1/0/2/1.6 192.168.12.92 bfd enable 
ZXROSNG(config)#ip route vrf Softsw 0.0.0.0 0.0.0.0 xgei-1/0/2/1.6 192.168.12.93 bfd enable 
ZXROSNG(config)#ipv6 route vrf Softsw ::/0 xgei-1/0/1/1.6 2409:8086:8413:2862::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf Softsw ::/0 xgei-1/0/1/1.6 2409:8086:8413:2862::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf Softsw ::/0 xgei-1/0/2/1.6 2409:8086:8413:2862::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf Softsw ::/0 xgei-1/0/2/1.6 2409:8086:8413:2862::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf Ga ::/0 xgei-1/0/1/1.7 2409:8086:8413:2863::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf Ga ::/0 xgei-1/0/1/1.7 2409:8086:8413:2863::fffe bfd enable 
ZXROSNG(config)#ipv6 route vrf Ga ::/0 xgei-1/0/2/1.7 2409:8086:8413:2863::fffd bfd enable 
ZXROSNG(config)#ipv6 route vrf Ga ::/0 xgei-1/0/2/1.7 2409:8086:8413:2863::fffe bfd enable 
进入BFD配置模式，命令如下。 
ZXROSNG(config)#bfd 
配置子接口BFD的相关信息，命令如下。 
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.1 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.2 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.3 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.5 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.6 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.6)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.6)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/1/1.7 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.7)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.7)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.1 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.2 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.3 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#exit 
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.5 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.6 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.6)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.6)#exit  
ZXROSNG(config-bfd)#interface xgei-1/0/2/1.7 
ZXROSNG(config-bfd-if-xgei-1/0/2/1.7)#time-negotiation interval 500 min-rx 500 multiplier 4 
ZXROSNG(config-bfd)#exit  
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
相关任务 :配置完成后，可以执行如下命令查看相关信息。 
show ip forwarding route vrf <vrf_name>：查询路由信息中配置了VRF的IPv4静态路由。 
show ipv6 forwarding route vrf <vrf_name>：查询路由信息中配置了VRF的IPv6静态路由。 
#### 配置GR功能 
操作人员对MPU进行倒换时，为减少倒换对业务的影响，需要开启GR功能。
 说明： 
开启GR功能时，业务有短时呼叫损失，需要提前与客户沟通，选择安全时间进行操作。
对于SDN网络，网元侧不需要配置BFD GR功能。 
对于非SDN网络，网元侧需要配置BFD GR功能。 
##### 配置全局GR 
摘要 :本节介绍如何配置全局GR。
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0节点。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[gr enable]命令，开启全局GR功能。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :开启全局GR功能，进行如下配置。 
进入全局配置模式，命令如下。 
ZXROSNG#configure terminal 
开启全局GR功能，命令如下。 
ZXROSNG(config)#gr enable 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
##### 配置BFD GR 
摘要 :本节介绍如何配置BFD GR。 
对于SDN网络，网元侧不需要配置BFD GR功能。 
步骤 :在EM客户端配置页面的左侧命令树中，展开uMAC节点，选择CommonS_TMSP_0节点。
选择菜单Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[bfd]命令，进入BFD配置模式。
执行[gr enable]命令，开启BFD GR功能。
执行[gr-time]命令，配置GR时间。
执行[exit]命令，退出当前配置模式。
执行[end]命令，退出配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
参数|取值
---|---
BFD GR功能|开启
gr-time|360毫秒
根据规划进行如下配置： 
进入全局配置模式，命令如下： 
ZXROSNG#configure terminal 
进入BFD配置模式，命令如下： 
ZXROSNG(config)#bfd 
开启GR功能，命令如下： 
ZXROSNG(config-bfd)#gr enable 
ZXROSNG(config-bfd)#gr-time 360 
ZXROSNG(config-bfd)#exit 
退出配置模式并保存配置数据，命令如下。 
ZXROSNG(config)#end 
ZXROSNG#write 
### 检查名称 
摘要 :本节介绍如何检查虚拟机和网元名称是否符合运营商名称规范，以及虚机个数是否与合同要求一致。 
步骤 :执行[SHOW VM]命令，检查虚拟机版本、虚拟机的规格、虚拟机的亲和组和虚拟机内部名称前缀部分是否符合运营商规范以及虚机个数是否与合同要求一致。如不符合运营商规范，需要修改规划并重新实例化。
执行[SHOW VNF]命令，检查VNF部署实例名称是否符合运营商网元名称规范。
举例 :检查虚拟机内部名称前缀部分是否符合运营商规范，虚机个数是否与合同要求一致，命令如下。 
[SHOW VM]
检查VNF部署实例名称是否符合运营商网元名称规范，命令如下。 
[SHOW VNF]
### 配置CDB 
摘要 :本节介绍如何配置CDB相关信息，使CDU虚机正常启动。CDU虚机提供的相关服务被称为CDB服务。
步骤 :执行[SYNA]命令，将网管存储的网元相关的数据传送到前台。
执行[SHOW CDBTENANT]命令，查询CDB租户配置信息。默认情况下，系统已配置了一条CDB租户信息，且租户信息只需配置一条即可。如果已配置的CDB租户信息不满足要求，可执行[SET CDBTENANT]命令进行更改。
执行[ADD CDBPARAM]命令，增加租户参数配置。
执行[ADD CDBLOADLV]命令，为租户增加过负荷配置。
执行[ADD CDBMEMALARMLV]命令，为租户设置内存告警阈值。
执行[ADD CDBBUFFLV]命令，为租户设置数据区告警阈值。
执行[SYNA]命令，将网管存储的网元相关的数据传送到前台。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值|说明
---|---|---|---
数据传送|传送类型|All tables|-|All tables|All tables|All tables|All tables
租户配置|租户ID|1|-|1|1|1|1
租户名称|租户配置|amfc01.amfsi041.amfri51.amf.5gc.mnc000. mcc460.3gppnetwork.org|根据运营商规范配置。必须与SHOW AMFLOCALOFFICECFG中的AMF名称配置一致。|amfc01.amfsi041.amfri51.amf.5gc.mnc000. mcc460.3gppnetwork.org|amfc01.amfsi041.amfri51.amf.5gc.mnc000. mcc460.3gppnetwork.org|amfc01.amfsi041.amfri51.amf.5gc.mnc000. mcc460.3gppnetwork.org|amfc01.amfsi041.amfri51.amf.5gc.mnc000. mcc460.3gppnetwork.org
每个域的默认激活节点数|租户配置|3|每个域的默认激活节点数量=激活节点数量/2激活节点数量=虚机初始启动数量*虚机上启动节点数(小规格C2M8虚机为1个节点，中规格C4M32虚机为3个节点)|3|3|3|3
主用NF(局)标识|租户配置|11|必须与实例化info中规划的局号值一致。|11|11|11|11
备用NF(局)标识|租户配置|0|AMF无需配置，采用默认值0。|0|0|0|0
左域SC TYPE|租户配置|9|与SHOW SERVICEINFO:SERVICETYPENAME="Nudsf_UnstructuredDataManagement"命令的查询结果中的SC类型名称为sc-cudr-cdn-l的SC类型ID一致。|9|9|9|9
右域SC TYPE|租户配置|10|与SHOW SERVICEINFO:SERVICETYPENAME="Nudsf_UnstructuredDataManagement"命令的查询结果中的SC类型名称为sc-cudr-cdn-r的SC类型ID一致。|10|10|10|10
增加参数配置|租户ID|1|-|1|1|1|1
内存库大小(MB)|增加参数配置|6656|中规格虚机（C4M32）配置值6656。小规格虚机（C2M8）配置值4096，且不能启用NBFS（Non-Blocking File System，非阻塞文件系统）。|6656|6656|6656|6656
日志库大小(MB)|增加参数配置|1024|建议使用默认值1024。|1024|1024|1024|1024
增加负荷配置|租户ID|1|-|1|1|1|1
过负荷等级|增加负荷配置|0|1|2|3|4|-
CPU负荷阈值(%)|增加负荷配置|75|80|85|90|95|-
增加内存告警阀值配置|租户ID|1|-|1|1|1|1
内存库一级告警阈值(%)|增加内存告警阀值配置|90|-|90|90|90|90
内存库二级告警阈值(%)|增加内存告警阀值配置|80|-|80|80|80|80
内存库三级告警阈值(%)|增加内存告警阀值配置|70|-|70|70|70|70
增加数据区告警阀值配置|租户ID|1|-|1|1|1|1
数据区1级告警阈值(%)|增加数据区告警阀值配置|90|-|90|90|90|90
数据区2级告警阈值(%)|增加数据区告警阀值配置|80|-|80|80|80|80
数据区3级告警阈值(%)|增加数据区告警阀值配置|70|-|70|70|70|70
数据区4级告警阈值(%)|增加数据区告警阀值配置|60|-|60|60|60|60
根据规划，进行如下配置。 
将网管存储的网元相关的数据传送到前台，命令如下。 
[SYNA]:STYPE="ALL"
查询CDB租户配置，确认和规划是否相符，命令如下。 
SHOW CDBTENANT 
如果输出结果与规划不符合，修改租户配置，命令如下。 
[SET CDBTENANT]:TENANTID=1,TENANTNAME="amfc01.amfsi041.amfri51.amf.5gc.mnc000.mcc460.3gppnetwork.org",ACTIVENODES=3,NFID1=11,NFID2=0,LEFTSCTYPE=9,RIGHTSCTYPE=10,ACCESSPOLICY="default_access"
增加租户参数配置，命令如下。 
[ADD CDBPARAM]:TENANTID=1,MDBSIZE=6656,LOGBUFSIZE=1024
增加租户过负荷配置，命令如下。 
[ADD CDBLOADLV]:TENANTID=1,LEVEL=0,CPU=75
[ADD CDBLOADLV]:TENANTID=1,LEVEL=1,CPU=80
[ADD CDBLOADLV]:TENANTID=1,LEVEL=2,CPU=85
[ADD CDBLOADLV]:TENANTID=1,LEVEL=3,CPU=90
[ADD CDBLOADLV]:TENANTID=1,LEVEL=4,CPU=95
增加内存告警阀值配置，命令如下。 
[ADD CDBMEMALARMLV]:TENANTID=1,DB_RATIO_LV1=90,DB_RATIO_LV2=80,DB_RATIO_LV3=70
增加数据区告警阈值配置，命令如下。 
[ADD CDBBUFFLV]:TENANTID=1,BUFF_LV1=90,BUFF_LV2=80,BUFF_LV3=70,BUFF_LV4=60
将网管存储的网元相关的数据传送到前台，命令如下。 
[SYNA]:STYPE="ALL"
### 公共基础数据配置 
#### 配置时间 
摘要 :本节介绍如何配置时区和NTP。 
为了保证ZXUN uMAC与其他网元协调工作，需要准确设置ZXUN uMAC的系统时区信息，使系统时区与ZXUN uMAC所在地的时区保持一致。
NTP用于实现网络上计算机之间精确的时间同步。
步骤 :执行命令[SET TIMEZONE]，配置本局的时区。
 说明： 
时区参数表示交换局所在的时区，设置在GMT时间的基础上偏移的小时。
执行命令[SET NTP]，配置NTP参数。
 说明： 
主服务器IP参数是主用NTP服务器的IP地址，设置为与EM同步的上级主用NTP服务器的IP地址。
用户初次配置完毕时，必须使用[SYNC NTPTIME]命令强制同步时间。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
时区配置|时区|GMT+08:00|根据设备所在国家时区配置。
NTP配置|是否启用|是|-
主服务器IP|NTP配置|180.3.6.5|主用NTP服务器地址。
主服务器版本|NTP配置|NTP协议版本3|NTP服务器版本号。
主服务器端口|NTP配置|123|-
次服务器IP|NTP配置|180.3.6.6|备用NTP服务器地址。
次服务器版本|NTP配置|NTP协议版本3|NTP服务器版本号。
次服务器端口|NTP配置|123|-
轮询间隔|NTP配置|10|建议设置为10，表示间隔1024秒到NTP服务器检查一次时间变更。
最大误差阈值(毫秒)|NTP配置|3000|建议设置为3000 ms。
Transmit时间戳|NTP配置|本地UTC时间|建议设置为本地UTC时间。
根据规划，进行如下配置。 
配置本局的时区为GMT+08:00，命令如下。 
[SET TIMEZONE]:TIMEZONE="GMTE0800"
配置启用NTP服务，命令如下。 
[SET NTP]:ENABLE="YES",PRIMARYADD="180.3.6.5",PRIMARYPORT=123,PRIMARYVER="NTP_VERSION_3",SECADD="180.3.6.6",SECPORT=123,SECVER="NTP_VERSION_3",POLL=10,MAXCHANGE=3000,TRANSMIT="TRANSMIT_LOCAL"
#### 配置夏令时（可选） 
摘要 :本节介绍当ZXUN uMAC所在地需要启用夏令时功能时，如何对夏令时功能进行设置。当用户成功配置了夏令时后，ZXUN uMAC会将本地时间和配置的夏令时进行对比，判断是否达到夏令时开始时间或夏令时结束时间，并对系统时间做相应的夏令时步长调整。
夏令时的时间格式分为绝对时间格式和相对时间格式。 
绝对时间格式使用固定的时间来设置夏令时，根据某月某日的某个时间来设置夏令时。 
相对时间格式使用相对的时间来设置夏令时，根据某月的第某个星期的某个时间来设置夏令时。 
相关信息 :夏令时也叫夏时制，是某些国家和地区实行的时间调整制度。 
每个国家的夏令时实施方式有所不同，比如美国的实施方法为：在3月份的第二个礼拜日凌晨2点将时间向前偏移1个小时，在11月份的第一个礼拜日凌晨2点将时间向后偏移一小时。简单讲，就是在春天将时间提前一小时，在秋天将时间推迟一小时。 
 说明： 
由于不同国家的夏令时时间设置可能不同，请根据ZXUN uMAC所在地的时间来配置夏令时。
步骤 :执行命令[SET DAYLIGHTSAVE]，配置本局的夏令时。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
夏令时开始时间|夏令时结束时间|夏令时步长
---|---|---
5月的第2个星期一的零点|7月的第2个星期一的零点|调快1小时（60分钟）
根据规划，进行如下配置。 
配置本局的夏令时，命令如下。 
[SET DAYLIGHTSAVE]:ENABLE="Relative",STARTMONTH="May",STARTWEEKNO="Second",STARTWEEKDAY="Mon",STARTTIME="00:00",ENDMONTH="Jul",ENDWEEKNO="Second",ENDWEEKDAY="Mon",ENDTIME="00:00",STEPTIME=60
#### 配置自愈功能 
摘要 :本节介绍自愈相关配置。 
步骤 :执行命令[SET AUTOHEALINGGLB]，配置自愈全局配置。
执行命令[SET AUTOHEALINGLV]，修改自愈级别配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
自愈全局配置|自愈功能总开关|开启|开启|开启
自愈级别配置|自愈级别|VRU重建|虚机重启|虚机重建
使能开关|自愈级别配置|开启|关闭|关闭
根据规划，进行如下配置。 
配置自愈功能开启，命令如下。 
[SET AUTOHEALINGGLB]:HEALINGSWITCH="ENABLE"
配置自愈级别，命令如下。 
[SET AUTOHEALINGLV]:LEVEL="VRUREBUILD",HEALINGSWITCH="ENABLE"
[SET AUTOHEALINGLV]:LEVEL="VMRESTART",HEALINGSWITCH="DISABLE"
[SET AUTOHEALINGLV]:LEVEL="VMREBUILD",HEALINGSWITCH="DISABLE"
#### 配置一致性检查 
摘要 :本节介绍一致性检查相关配置，检查内容包括服务最小副本数等。 
步骤 :执行命令[SET CONSISTENCECHECK]，修改一致性检查配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
一致性检查配置|检查开关|关闭
根据规划，进行如下配置。 
配置一致性检查开关，命令如下。 
[SET CONSISTENCECHECK]:CHECKSWITCH="DISABLE"
#### 配置仲裁 
摘要 :本节介绍如何开启仲裁配置。 
步骤 :执行命令[SET QUORUM]，开启仲裁配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
仲裁配置|仲裁开关|启用
根据规划，进行如下配置。 
配置仲裁开关开启，命令如下。 
[SET QUORUM]:QUORUM_SWITCH="ENABLE"
#### 配置SCTP全局信息 
摘要 :本节介绍如何配置SCTP全局配置。 
步骤 :执行命令[SET SCTPGLOBAL]，对gNB和eNB局向消息进行限速，避免上报CPU过高的告警。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
SCTP全局配置|消息通知阈值(数据发送数)|0
动态偶联INIT接入限速值|SCTP全局配置|2000
根据规划，进行如下配置。 
配置SCTP全局信息，命令如下。 
[SET SCTPGLOBAL]:SCTPTXNOTIFYTHRESH=0,SCTPDYNAINITLIMIT=2000
#### 配置抗网络闪断信息 
摘要 :本节介绍如何配置心跳相关参数，包含主备心跳、虚机/容器心跳、控制面SC心跳、业务面SC心跳等。 
步骤 :执行命令[SET VMHEARTBEAT]，修改主备心跳、虚机/容器心跳时长。
执行命令[SET ELECTION]，修改主备选举相关配置。
执行命令[MODIFY CPSCHEARTBEAT]，修改控制面SC心跳检测参数。
执行命令[MODIFY SPSCHEARTBEAT]，修改业务面SC心跳检测参数。
执行命令[SET ROSNGINTERFACEKEEPALIVE]，修改主用ROSNG协议栈单元检测接口处理单元的保活消息参数配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
VM心跳相关配置|虚机心跳超时时长(s)|12
主备选举相关配置|MGT容器主备心跳超时时长(ms)|8000
MGT容器主备心跳定时器时长(ms)|主备选举相关配置|200
MGT容器主备处理的过滤时长(ms)|主备选举相关配置|1000
主备心跳超时时长(ms)|主备选举相关配置|8000
主备心跳定时器时长(ms)|主备选举相关配置|200
主备处理的过滤时长(ms)|主备选举相关配置|1000
控制面SC心跳检测参数配置|使能开关|ENABLE
检测周期(ms)|控制面SC心跳检测参数配置|1000
门限次数|控制面SC心跳检测参数配置|12
业务面SC心跳检测参数配置|使能开关|ENABLE
检测周期(ms)|业务面SC心跳检测参数配置|1000
门限次数|业务面SC心跳检测参数配置|12
主用ROSNG协议栈单元检测接口处理单元的保活消息参数配置|保活时间间隔(millisecond)|1000
保活次数门限|主用ROSNG协议栈单元检测接口处理单元的保活消息参数配置|16
根据规划，进行如下配置。 
配置心跳相关信息，命令如下。 
[SET VMHEARTBEAT]:TIMEOUT=12
修改主备选举相关信息，命令如下。 
[SET ELECTION]:MGT_ELECT_TIMEOUT=8000,MGT_ELECT_TIMER_LEN=200,MGT_ELECT_FLITER=1000,ELECT_TIMEOUT=8000,ELECT_TIMER_LEN=200,ELECT_FLITER=1000
修改控制面SC心跳检测参数，命令如下。 
[MODIFY CPSCHEARTBEAT]:BSWITCH="ENABLE",DWINTERVAL=1000,DWTHRESHOLD=12
修改业务面SC心跳检测参数，命令如下。 
[MODIFY SPSCHEARTBEAT]:BSWITCH="ENABLE",DWINTERVAL=1000,DWTHRESHOLD=12
配置主用ROSNG协议栈单元检测接口处理单元的保活消息参数，命令如下。 
[SET ROSNGINTERFACEKEEPALIVE]:INTERVAL=1000,THRESHOLD=16
#### 配置虚机使用率告警阈值 
摘要 :本节介绍如何配置虚机使用率告警阈值，包含CPU、内存和硬盘使用率告警阈值。 
步骤 :执行命令[SET VMTHRESHOLD]，修改VM使用率告警阈值。
执行命令[ADD SPECDRA]，新增特定动态资源使用率告警参数配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
VM使用率告警阈值配置|虚机名称或类型|DEFAULT_CONFIG|DEFAULT_CONFIG|DEFAULT_CONFIG
资源类型|VM使用率告警阈值配置|CPU|内存|硬盘
一级告警阈值(%)|VM使用率告警阈值配置|96|98|95
二级告警阈值(%)|VM使用率告警阈值配置|94|97|90
三级告警阈值(%)|VM使用率告警阈值配置|92|96|85
四级告警阈值(%)|VM使用率告警阈值配置|90|95|80
特定动态资源使用率告警参数配置|资源名称|dbApp_Dyn|dbApp_Dyn|dbApp_Dyn
一级告警门限值(%)|特定动态资源使用率告警参数配置|95|95|95
二级告警门限值(%)|特定动态资源使用率告警参数配置|93|93|93
三级告警门限值(%)|特定动态资源使用率告警参数配置|90|90|90
恢复告警门限值(%)|特定动态资源使用率告警参数配置|85|85|85
根据规划，进行如下配置。 
修改VM使用率告警阈值，命令如下。 
[SET VMTHRESHOLD]:VM_NAME="DEFAULT_CONFIG",RES_TYPE="CPU",THRESHOLD=96,THRESHOLD2=94,THRESHOLD3=92,THRESHOLD4=90
[SET VMTHRESHOLD]:VM_NAME="DEFAULT_CONFIG",RES_TYPE="MEMORY",THRESHOLD=98,THRESHOLD2=97,THRESHOLD3=96,THRESHOLD4=95
[SET VMTHRESHOLD]:VM_NAME="DEFAULT_CONFIG",RES_TYPE="DISK",THRESHOLD=95,THRESHOLD2=90,THRESHOLD3=85,THRESHOLD4=80
新增特定动态资源使用率告警参数配置，命令如下。 
[ADD SPECDRA]:NAME="dbApp_Dyn",LEVEL1VALUE=95,LEVEL2VALUE=93,LEVEL3VALUE=90,RESTOREVALUE=85
### MME/SGSN业务配置 
#### 配置业务接口关联的VRF 
摘要 :本节介绍如何设置各业务接口关联的VRF， 用于隔离不同接口的业务网络，让某接口的信令/数据在不同的虚拟路由域内传输。 
步骤 :执行[SET VRFCFG]命令，依据组网规划，配置业务接口关联的VRF。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
VRF配置|S10口VRF标识|8
S11口VRF标识|VRF配置|8
Gn-C口VRF标识|VRF配置|8
Iu口用户面VRF标识|VRF配置|12
Sv口VRF标识|VRF配置|16
S11-U口VRF标识|VRF配置|8
Gn-U口VRF标识|VRF配置|8
N26口VRF标识|VRF配置|8
根据规划，进行如下配置。 
检查业务接口关联的VRF，命令如下。 
[SET VRFCFG]:S10VRF=8,S11VRF=8,GNVRF=8,IUVRF=12,SVVRF=16,S11UVRF=8,GNUVRF=8,N26VRF=8
#### 修改容量规划 
摘要 :本节介绍如何修改容量规划。 
步骤 :执行[SET CAPACITY]命令，设置容量规划。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
容量规划配置|CMP附着用户数(单进程)|40000
LCS资源容量(单进程)|容量规划配置|2048
CMP CAMEL用户数(单进程)|容量规划配置|1000
2G USUP MM上下文数(单进程)|容量规划配置|1000000
USUP PDP上下文数(单进程)|容量规划配置|500000
USUP报文缓存个数(单进程)|容量规划配置|60000
SGSN支持LCS用户数(单进程)|容量规划配置|40000
MME支持LCS用户数(单进程)|容量规划配置|40000
容灾备份数据容量|容量规划配置|40000
BVC数(全局)|容量规划配置|65000
最大CG服务器个数|容量规划配置|16
根据规划，进行如下配置。 
修改容量规划，命令如下。 
[SET CAPACITY]:BOARDTYPE="VMB",SGMPMM=40000,LCSNUM=2048,SCCF=1000,SPMM=1000000,UPPDP=500000,UPPACKBUF=60000,LCSSGSN=40000,LCSMME=40000,RESTOBAKCAP=40000,BVC=65000,MAXCGNUM=16
#### 配置MME基础数据 
##### 配置MME移动数据 
摘要 :本节介绍如何配置MME移动数据。 
MME移动数据配置包括本局移动数据配置、MME其他HPLMN配置、本局支持的其他GUMMEI配置。
网管系统默认生成“本局移动数据”，包括MME组ID号、国家号、国家目的码、移动国家码、移动网号等。如果系统默认生成的数据不符合本局数据规划，可以根据实际情况进行修改。 
MME支持多PLMN，当本局MME同时服务于两个或两个以上的PLMN时，需要增加“MME其他HPLMN配置”。 
一个MME，一般只需要一个GUMMEI。运营商出于运维和组网的特殊要求，也可以为一个MME分配多个GUMMEI。“本局移动数据”配置中，进行本局的GUMMEI配置；在此基础上，“本局支持的其他GUMMEI配置”可提供本局其他GUMMEI的配置功能。 
相关信息 :“本局移动数据”中配置的PLMN（MCC+MNC）和“MME其他HPLMN配置”中配置的PLMN一起组成了MME支持的全部HPLMN列表。
MMEHPLMN列表用于本MME判断接入用户是否属于漫游用户，判断规则如下。
若从接入用户IMSI中提取的PLMN在MME支持的全部HPLMN列表范围内，那么该用户在漫游管理上将被当作本局归属用户处理。 
若从接入用户IMSI中提取的PLMN不在MME支持的全部HPLMN列表范围内，根据以下规则进行判断。若从接入用户IMSI中提取的移动国家码MCC与MME支持的全部HPLMN列表中配置的某个移动国家码匹配，那么该用户在漫游管理上将被当作国内漫游用户处理。若从接入用户IMSI中提取的移动国家码MCC与MME支持的全部HPLMN列表中配置的移动国家码均不匹配，那么该用户在漫游管理上将被当作国际漫游用户处理。 
步骤 :执行命令[SET COMBOCFG]，配置本局移动数据。
[SET COMBOCFG]命令的关键参数说明参见[表1]。
参数标识|参数名称|参数设置说明
---|---|---
MMEGROUPID|MME组ID|MME所在池组的标识，一般以32768开始。单个MME开局采用默认值，多个MME组成POOL时需要规划并配置。
MMECODE|MME编号|MME组内的网元标识，组内的MME标识不能重复。
MMEWEIGHT|MME权重|MME组内多个MME的分担比例。多个MME组成MME POOL时，eNodeB和池内的所有MME相连。池内各个MME配置的权重因子，都会下发给eNodeB。eNodeB发送消息时，根据存储的各个MME的权重因子，按比例分发消息，实现MME的负荷分担。
SUPTYPE|支持类型|当MME需要与EIR对接时，支持类型要包含“S13”。
MMEULICHGRPT|支持用户位置信息变化上报配置|该参数用于设置MME是否支持4G用户位置信息变化上报（即位置区变换后将相应位置区参数通知PGW）。默认值为不支持。取值含义：不支持：MME不支持用户位置信息变化上报到PGW。支持：MME支持用户位置信息变化上报到PGW。
MMESHARETYPE|MME支持MOCN功能|该参数用于设置MME是否支持多个不同运营商的核心网共享一套无线接入网络。默认值为不支持。取值含义：不支持：MME不支持多个不同运营商的核心网共享一套无线接入网络。支持：MME支持多个不同运营商的核心网共享一套无线接入网络。
MMEIPV4APN|MME缺省IPv4 APN|如果4G用户在HSS上签约的APN为*且该APN对应的PDN类型为IPv4、在HSS上签约的缺省APN对应的PDN类型为IPv6，则当用户请求的PDN类型为IPv4且没有携带请求APN时，通过此缺省IPv4APN接入。
MMEIPV6APN|MME缺省IPv6 APN|如果4G用户在HSS上签约的APN为*且该APN对应的PDN类型为IPv6、在HSS上签约的缺省APN对应的PDN类型为IPv4，则当用户请求的PDN类型为IPv6且没有携带请求APN时，通过此缺省IPv6APN接入。
MMEIPV4V6APN|MME缺省IPv4IPv6 APN|如果4G用户在HSS上签约的APN为*且该APN对应的PDN类型为IPv4IPv6、在HSS上签约的缺省APN对应的PDN类型不是IPv4IPv6，则当用户请求的PDN类型为IPv4IPv6且没有携带请求APN时，通过此缺省IPv4IPv6APN接入。
（可选）执行命令[ADD MME HPLMNCFG]，配置本局MME支持的其他HPLMN。
（可选）执行命令[ADD GUMMEI]，配置本局支持的其他GUMMEI。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
本局移动数据|MME组ID|32849
MME节点名称|本局移动数据|MME1
国家号|本局移动数据|86
国家目的码|本局移动数据|139
MME移动国家码|本局移动数据|460
MME移动网号|本局移动数据|00
MME编号|本局移动数据|1
支持类型|本局移动数据|S13
MME权重|本局移动数据|100
本局支持的其他PLMN|移动国家码|460
移动网号|本局支持的其他PLMN|02、04、07、08、13
本局支持的其他GUMMEI|用户别名|其他GUMMEI
PLMN编号|本局支持的其他GUMMEI|460–00
MME组ID号|本局支持的其他GUMMEI|32849
MME编号|本局支持的其他GUMMEI|2
根据规划，进行如下配置。 
配置本局移动数据，命令如下。 
[SET COMBOCFG]:MMEGROUPID=32849,MMENAME="MME1",CC="86",NDC="139",MMCC="460",MMNC="00",MMECODE=1,SUPTYPE="S13",FLEXEN="YES",NRILEN=7,MMEWEIGHT=100
配置MME支持的其他HPLMN，命令如下。 
[ADD MME HPLMNCFG]:MCC="460",MNC="02"
[ADD MME HPLMNCFG]:MCC="460",MNC="04"
[ADD MME HPLMNCFG]:MCC="460",MNC="07"
[ADD MME HPLMNCFG]:MCC="460",MNC="08"
[ADD MME HPLMNCFG]:MCC="460",MNC="13"
配置本局支持的其他GUMMEI，命令如下。 
[ADD GUMMEI]:USERLABEL="其他GUMMEI",PLMN="460"-"00",MMEGID=32849,MMEC=2
##### 配置MME GTP-C信令地址 
摘要 :本节介绍如何配置MME GTP-C信令地址。 
MME的GTP-C信令地址是MME与其他网元（包括SGSN、MME、SGW等）基于GTP协议交互时的信令地址。
当MME与其他网元对接时，在其他网元上填写的对端IP地址或在其他网元上进行MME地址解析时填写的地址即为MME的GTP-C信令地址。
步骤 :执行命令[SET MME GTPC]，配置MME的GTP-C信令地址。
 说明： 
GTPC IPv4信令地址参数用于配置MME的IPv4信令地址，根据实际网络规划配置，只能配置一个IPv4地址。 
GTPC IPv6信令地址参数用于配置MME的IPv6信令地址，根据实际网络规划配置，只能配置一个IPv6地址。 
IPv4和IPv6地址可以同时配置，也可以只配置其中一个。 
IPv6地址需要license的支持，对应的license项为“支持IPv6功能”。 
如果现场配置了MME GTPC地址，不管是否带2/3G业务，SGSN GTPC地址都要配置，参考配置SGSN GTP-C信令地址。 
如果是中国移动项目的融合AMF/MME/SGSN局时，AMF GTPC和MME/SGSN GTPC地址需要相同。 
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME GTPC信令地址配置|GTPC IPv4信令地址|223.103.77.128
GTPC IPv6信令地址|MME GTPC信令地址配置|2409:802F:2905:0701::04:101
根据规划，进行如下配置。 
配置MME的GTP-C信令地址，命令如下。 
[SET MME GTPC]:IPADDR="223.103.77.128",IPV6ADDR="2409:802F:2905:0701::04:101"
##### 配置MME和AMF合一模式 
摘要 :MME支持N26口，并支持MME和AMF合一配置。 
本节介绍MME支持和AMF融合配置相关的信息。 
前提 :执行[SHOW VNF]命令，查询结果中“产品类型”必须为“Common AMF/MME/GnGp SGSN”，表示支持MME和AMF融合。
步骤 :执行[SET 5GC INTERWORKING]命令，设置MME和AMF的合一模式。
执行[SET 5GC INTERWORKING]命令，设置选择融合PGW-C+SMF失败后的策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
5GC互操作基本配置|互操作模式|with N26
支持N26互操作|5GC互操作基本配置|支持N26互操作
是否选择合一AMF|5GC互操作基本配置|是
签约的Interworking-5GS-Indicator处理策略|5GC互操作基本配置|无签约值时按允许处理
根据终端能力和签约信息选择融合的PGW-C+SMF策略|5GC互操作基本配置|终端能力和签约信息
是否支持AMF FQDN查询|5GC互操作基本配置|是
选择融合PGW-C+SMF失败后的策略|5GC互操作基本配置|优选普通PGW
根据规划，进行如下配置。 
配置MME支持N26口并支持MME和AMF合一模式，命令如下。 
[SET 5GC INTERWORKING]:MODE="WITHN26",SUPWITHN26="SUPWITHN26",SELECTCONVGCAMF="YES",SUBEDIWK5GSINDPOLICY="NOSUBSCRIBED",PGWCSMFSELECTPOLICY="ALLOFTHEM",IFSPRTAMFQUERY="YES"
设置选择融合PGW-C+SMF失败后的策略，命令如下。 
[SET 5GC INTERWORKING]:PLYAFSELSMFFAIL="PGW"
#### 配置SGSN基础数据 
##### 配置本局信令节点 
摘要 :本节介绍如何配置本局信令节点。 
信令点编码指信令网中用于标识每一个节点的唯一编码，设定本局的信令点编码用于MTP3协议的寻址。 
 说明： 
本局可配置多个信令点。 
相关信息 :ITU-T Q.Imp705协议中将全球信令网络分成国际网络、国内网络这两个功能独立的网络，这种划分可以使国际网络、各国内网络的信令点编码独立，可以清晰地管理信令网络。ITU-T Q.Imp704协议中network
indicator字段用于区分国际网络还是国内网络。同一网络类别下的子业务类型应相同。 
邻接局的网络类别需与本局信令点网络类别一致，即处于同一信令网络中。 
步骤 :执行命令[ADD OPC]，配置本局信令点。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
新增本局信令点|网络类别|1|2
别名|新增本局信令点|SPC_RNC|SPC_HLR
信令点编码格式|新增本局信令点|383/888格式的3段10进制数字符串|383/888格式的3段10进制数字符串
14位信令点编码|新增本局信令点|0.37.7|-
24位信令点编码|新增本局信令点|-|255.19.11
网络外貌|新增本局信令点|0|0
应用类型|新增本局信令点|SCCP|SCCP
标志字段|新增本局信令点|网络外貌无效|网络外貌无效
根据规划，进行如下配置。 
配置本局信令点，命令如下。 
[ADD OPC]:NET=1,NETWORKNAME="SPC_RNC",NETAPP=0,SPCMODE="TRIPLE_DEC",OPC14="0.37.7",UPTYPE="SCCP",INFO1="NONETAPP"
[ADD OPC]:NET=2,NETWORKNAME="SPC_HLR",NETAPP=0,SPCMODE="TRIPLE_DEC",OPC24="255.19.11",UPTYPE="SCCP",INFO1="NONETAPP"
##### 配置本局属性 
摘要 :需要设置SGSN对应的基本参数信息，用于描述SGSN的公共属性，包括网络类别、信令点类型等信息。
步骤 :执行命令[ADD LOFC]，配置本局属性。
 说明： 
SGSN的信令点类型参数设置为STEP，表示既是信令端节点也是信令转接点。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
本局配置|网络类别|1
信令点类型|本局配置|STEP
无效的网络外貌个数|本局配置|0
本局的类型|本局配置|SGSN
根据规划，进行如下配置。 
配置本局属性，命令如下。 
[ADD LOFC]:NET=1,SPTYPE="STEP",INVALIDNANUM=0,OFFICETYPE="SGSN"
##### 配置SGSN移动数据 
摘要 :本节介绍如何配置SGSN移动数据。 
网管系统默认设置了国家码、移动国家码、移动网号、国家目的码、支持接口类型等数据，如果不符合本局的数据规划，可以根据实际情况修改SGSN的本局移动数据。 
步骤 :执行命令[SET COMBOCFG]，配置本局移动数据。
执行命令[ADD FLEX NRI]，新增FLEX NRI配置。
执行命令[SET FLEX NULLNRI]，设置FLEX NULLNRI配置。
配置非广播RA。
执行命令[ADD LAI]，新增位置区配置。
执行命令[ADD RAI]，新增路由区配置。
执行命令[ADD HPLMNCFG]，配置本局SGSN支持的其他HPLMN。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
本局移动数据配置|国家号|86
国家目的码|本局移动数据配置|139
SGSN移动国家码|本局移动数据配置|460
SGSN移动网号|本局移动数据配置|00
SGSN号码|本局移动数据配置|8613903108
支持类型|本局移动数据配置|Gb&Iu&Egprs
PS用户面版本|本局移动数据配置|1
PS用户面模式|本局移动数据配置|透明模式
支持Flex功能|本局移动数据配置|超容
NRI的长度|本局移动数据配置|7
全局核心网标识|本局移动数据配置|1001
FLEX NRI配置|NRI值|11
用户别名|FLEX NRI配置|SGSN11-NRI1
FLEX NULLNRI配置|NRI值|15
用户别名|FLEX NULLNRI配置|NullNRI
位置区配置|位置区名|nonbroadcast-ffff
移动国家码|位置区配置|460
移动网号|位置区配置|00
位置区域码(HEX)|位置区配置|FFFF
路由区配置|路由区名|nonbroadcastra
位置区名|路由区配置|nonbroadcast-ffff
路由区码(HEX)|路由区配置|FB
是否使用全局时区|路由区配置|是
是否支持Flex功能|路由区配置|支持
是否具有Non Broadcast属性|路由区配置|是
本局其他HPLMN配置|移动国家码|460
移动网号|本局其他HPLMN配置|00、02、04、07、08、13
用户别名|本局其他HPLMN配置|CHINAMOBILE
在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置本局移动数据，命令如下。 
[SET COMBOCFG]:CC="86",NDC="139",MCC="460",MNC="00",GSNCODE="8613903108",SUPTYPE="Gb"&"Iu"&"Egprs",UPVER=1,UPMODE="TRNSPN",FLEXEN="ULTRA",NRILEN=7,CNID=1001
新增FLEX NRI配置，命令如下。 
[ADD FLEX NRI]:NRI=11,NAME="SGSN11-NRI1"
设置FLEX NULLNRI配置，命令如下。 
[SET FLEX NULLNRI]:NRI=15,NAME="NullNRI"
配置非广播RA。 
新增位置区配置，命令如下。 
[ADD LAI]:NAME="nonbroadcast-ffff",MCC="460",MNC="00",LAC="FFFF"
新增路由区配置，命令如下。 
[ADD RAI]:NAME="nonbroadcastra",LAI="nonbroadcast-ffff",RAC="FB",GLOBALTZ="YES",FLEX="YES",BROADCAST="YES"
 说明： 
BROADCAST参数要设置为YES。 
配置本局SGSN支持的其他HPLMN，命令如下。 
[ADD HPLMNCFG]:MCC="460",MNC="00",NAME="CHINAMOBILE"
[ADD HPLMNCFG]:MCC="460",MNC="02",NAME="CHINAMOBILE"
[ADD HPLMNCFG]:MCC="460",MNC="04",NAME="CHINAMOBILE"
[ADD HPLMNCFG]:MCC="460",MNC="07",NAME="CHINAMOBILE"
[ADD HPLMNCFG]:MCC="460",MNC="08",NAME="CHINAMOBILE"
[ADD HPLMNCFG]:MCC="460",MNC="13",NAME="CHINAMOBILE"
##### 配置SGSN GTP-C信令地址 
摘要 :本节介绍如何配置SGSN GTP-C信令地址。 
SGSN的GTP-C信令地址是SGSN与其他网元（包括MME、SGSN等）基于GTP协议交互时的信令地址。
当SGSN与其他网元对接时，在其他网元上填写的对端IP地址或在其他网元上进行SGSN地址解析时填写的地址即为SGSN的GTP-C信令地址。
 说明： 
如果是中国移动项目的融合AMF/MME/SGSN局时，AMF GTPC和MME/SGSN GTPC地址需要相同。 
如果已配置了SGSN GTPC地址，不管是否携带4G业务，MME GTPC地址都要配置，具体配置参见[配置MME GTP-C信令地址]。
步骤 :执行命令[SET SIGIP GTPC]，配置SGSN的GTP-C信令地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
GTPC信令地址配置|GTPC IPv4信令地址|223.103.77.128
GTPC IPv6信令地址|GTPC信令地址配置|2409:802F:2905:0701::04:101
根据规划，进行如下配置。 
配置SGSN的GTP-C信令地址，命令如下。 
[SET SIGIP GTPC]:IPADDR="223.103.77.128",IPV6ADDR="2409:802F:2905:0701::04:101"
##### 配置SGSN用户面地址 
摘要 :本节介绍如何配置SGSN用户面地址。 
SGSN支持媒体报文的转发，从RNC/BSC接收媒体报文，转发给GGSN；或者从GGSN接收报文，转发给RNC/BSC。
SGSN的用户面地址包括以下几种类型： 
SGSN与RNC交互媒体面报文时采用的Iu口IP地址。 
SGSN与GGSN交互媒体面报文时采用的Gn口IP地址。按照无线接入类型，可分为2G Gn口IP地址和3G Gn口IP地址。 
步骤 :执行命令[ADD UPA]，配置用户面地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
用户面地址配置|接口类型|IU|2G_GN|3G_GN|2G_GN|3G_GN
IP地址|用户面地址配置|10.124.17.90|223.103.77.130|223.103.77.131|2409:802F:2905:0701::04:103|2409:802F:2905:0701::04:104
根据规划，进行如下配置。 
配置SGSN用户面地址，命令如下。 
[ADD UPA]:INTERFACETYPE="IU",IPADDR="10.124.17.90"
[ADD UPA]:INTERFACETYPE="2G_GN",IPADDR="223.103.77.130"
[ADD UPA]:INTERFACETYPE="3G_GN",IPADDR="223.103.77.131"
[ADD UPA]:INTERFACETYPE="2G_GN",IPADDR="2409:802F:2905:0701::04:103"
[ADD UPA]:INTERFACETYPE="3G_GN",IPADDR="2409:802F:2905:0701::04:104"
#### 配置MME与其他网元的对接数据 
##### 配置MME与eNodeB对接数据 
摘要 :MME通过S1-MME接口与eNodeB连接。S1-MME接口用来传送MME和eNodeB之间的信令数据。MME通过S1-MME接口实现承载管理、上下文管理、切换、寻呼等功能。
MME与eNodeB对接组网及协议栈如[图1]所示。
图1  MME与eNodeB对接组网及协议栈

相关信息 :MME采用Client/Server动态偶联的方式实现与eNodeB之间的动态连接。
MME作为一个服务器对外发布本局的相关信息，在eNodeB中配置MME的这些相关信息后，当eNodeB上电或需要接入该MME时，eNodeB主动发起与MME间的建链。该建链包括承载链路偶联的建链以及业务层S1AP的建链。
MME与eNodeB对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|配置动态偶联|MME配置偶联别名、SCTP标识、本端IP地址和端口号。在eNodeB上电后，向MME发送偶联建链请求，并要求MME动态维护相关偶联信息。偶联建立后，eNodeB向MME发送网元级S1连接建链请求，并要求MME动态维护eNodeB相关信息。
2|配置eNodeB关联的跟踪区域|MME按照跟踪区对用户进行移动性管理，需要在MME中配置eNodeB关联的跟踪区域。
3|配置SGW管理跟踪区|MME接收到用户发送的请求消息后，结合请求消息中原有的跟踪区信息以及MME中配置的SGW管理跟踪区信息，生成恰当的TA List，在发送AttachAccept和TAU Accept消息时使用。
步骤 :执行命令[ADD SCTP]，配置S1AP动态偶联。
执行命令[ADD SCTPIDCFG]，配置偶联索引。
执行命令[ADD TA]，配置eNodeB关联的跟踪区域。
（可选）执行[SHOW LICENSE]命令，查询License项为eNodeB容量的值。当系统中接入的动态eNodeB数量达到该容量后，后续eNodeB接入会失败。
配置SGW管理跟踪区，选择执行如下操作。
如果…|那么…
---|---
要配置新的SGW和其管理的TA组|执行命令ADD SGW。
要为已配置的SGW新增其管理的TA组|执行命令ADD SGW GRPLIST。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
SCTP偶联配置|SCTP标识|2049
别名|SCTP偶联配置|eNodeB20
本端端口|SCTP偶联配置|36412
VPN ID 1|SCTP偶联配置|9
本端IP地址1|SCTP偶联配置|10.124.108.66
VPNID2|SCTP偶联配置|2
本端IP地址2|SCTP偶联配置|10.124.108.67
应用属性|SCTP偶联配置|服务端
是否启用链路切换功能|SCTP偶联配置|关闭
交叉建链属性|SCTP偶联配置|开启
单偶联通路断告警属性|SCTP偶联配置|关闭通路断告警
应用协议类型|SCTP偶联配置|S1AP
偶联索引配置|偶联ID|2049
偶联协议类型|偶联索引配置|S1AP
跟踪区配置|跟踪区标识|1
组号|跟踪区配置|1
移动国家码|跟踪区配置|460
移动网号|跟踪区配置|00
跟踪区域码(HEX)|跟踪区配置|0001
是否使用全局时区|跟踪区配置|是
跟踪区名称|跟踪区配置|Ta1
SGW管理区域配置|SGW标准名称|topon.s11.saegw85.gz.gd.node.epc.mnc000. mcc460.3gppnetwork.org
跟踪区组号|SGW管理区域配置|1
根据规划，进行如下配置。 
新增S1AP动态偶联，命令如下。 
[ADD SCTP]:ID=2049,NAME="eNodeB20",LOCPORT=36412,VPNID1=2,LOCADDR1="10.124.108.66",VPNID2=2,LOCADDR2="10.124.108.67",ROLE="SVR",FIXNH="CLOSE",CROSSLINK="OPEN",SCTPALARM="NOT_REPORT_ALARM",OFCID=0,PROTOCALTYPE="S1AP"
新增偶联索引，命令如下。 
[ADD SCTPIDCFG]:SCTPID=2049,TYPE="S1AP"
新增跟踪区域，命令如下。 
[ADD TA]:TAID=1,GRPID=1,MCC="460",MNC="00",TAC="0001",GLOBALTZ="YES",NAME="Ta1"
新增SGW管理区域，命令如下。 
[ADD SGW]:SGWNAME="topon.s11.saegw85.gz.gd.node.epc.mnc000.mcc460.3 gppnetwork.org",GRPLIST="1"
##### 配置MME与HSS/DRA对接数据 
摘要 :MME通过S6a接口与HSS连接，实现位置更新、用户数据管理、鉴权信息获取、HSS重置等功能。
为解决全网中的MME和HSS两两直连导致的复杂组网问题，在Diameter信令网中引入DRA，使得MME和HSS之间的Diameter信令通过一个或多个DRA进行转接。DRA将业务节点中Diameter相关的路由功能完全剥离出来，简化了网络管理，解决了LTE和IMS Diameter信令网管理需求。
MME与HSS对接组网及协议栈如[图1]所示。
图1  MME与HSS对接组网及协议栈

MME与HSS通过DRA对接组网及协议栈如[图2]所示。
图2  MME与HSS对接组网及协议栈（DRA转接）

相关信息 :MME向HSS发送消息时，获取路由的过程如下：
分析用户的IMSI号码，获取用户归属的HSS局向ID（MME与HSS直连）或DRA局向ID（MME与HSS之间通过DRA转接），对应的查询命令为[SHOW MDNAL]和[SHOW DIMOFC ANALYSIS]。
根据HSS局向ID或DRA局向ID，获取到Diameter局向路由，对应的查询命令为[SHOW DIAMADJ]
。
根据Diameter局向路由ID，查询到Diameter路由组，对应的查询命令为[SHOW DIAMADJROUTE]
。
根据Diameter路由组ID，查询到Diameter路由，对应的查询命令为[SHOW DIAMROUTEGROUP]
。
根据Diameter路由ID，查询到Diameter链路组，对应的查询命令为[SHOW DIAMROUTE]
。
根据Diameter链路组ID，查询到SCTP连接标识，对应的查询命令为[SHOW DIAMLINKGROUP]
。其中，SCTP连接标识已经在Diameter偶联中配置，对应的配置命令为[ADD SCTP]
。
MME与HSS/DRA对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|配置Diameter偶联|用于为Diameter连接配置相应的SCTP偶联。SCTP偶联提供面向连接的、点到点的可靠传输。
2|配置Diameter连接路由|配置Diameter连接路由，包括以下几个子步骤。新增Diameter连接，是Diameter路由数据配置的前提，也是使用Diameter协议交互的前提条件。新增Diameter链路组，从逻辑上维护一组Diameter连接。新增Diameter路由，从逻辑上维护一组Diameter链路组。新增Diameter路由组，从逻辑上维护一组Diameter路由。新增Diameter局向路由，从逻辑上维护一组Diameter路由组。新增Diameter局向，从逻辑上维护一组Diameter局向路由。
3|配置移动号码分析数据|配置移动号码分析数据，实现根据用户IMSI寻址到归属的HSS的功能，包括以下几个子步骤。新增Diameter邻接局分析结果索引，实现移动号码段和Diameter邻接局的关联。新增移动号码分析，把移动号码段分析为对应Diameter邻接局向的索引。
步骤 :执行命令[ADD SCTP]，配置Diameter偶联。
 说明： 
应用属性：选择CLT，MME作为SCTP连接的客户端。MME不论是直连HSS，还是连DRA，每个局向至少对接8条SCTP链路，如果License项4G在线用户数超过100万，每增加50万个用户，每个局向就要相应增加一条SCTP链路。
偶联归属组号：同一个局向的多条偶链设置是一样的。
执行命令[ADD SCTPIDCFG]，配置偶联索引。
配置Diameter连接路由。 
Diameter连接路由在不同组网情况下的参数配置规范参见[表2]。
组网|Diameter连接配置|Diameter局向路由配置
---|---|---
对端节点域名|对端节点主机名|是否默认路由局向|是否启用局向域名|域名|主机名
---|---|---|---|---|---
省内：MME和HSS直连|epc.mncxxx.mccxxx.3gppnetwork.org|hssname.epc.mncxxx.mccxxx.3gppnetwork.org|否|是|epc.mncxxx.mccxxx.3gppnetwork.org|hssname.epc.mncxxx.mccxxx.3gppnetwork.org
国内漫游：MME和DRA直连，由DRA转发到国内HSS|epc.mncxxx.mccxxx.3gppnetwork.org|draname.epc.mncxxx.mccxxx.3gppnetwork.org|否|是|epc.mncxxx.mccxxx.3gppnetwork.org|不配置
国际漫游：MME和DRA直连，由DRA转发到国际HSS|否|epc.mncxxx.mccxxx.3gppnetwork.org|draname.epc.mncxxx.mccxxx.3gppnetwork.org|是|epc.mncxxx.mccxxx.3gppnetwork.org（归属国的域名）|不配置
表格中的“xxx”根据运营商实际网络规划的MNC和MCC填写。 
表格中的“hssname”和“draname”分别根据运营商实际网络规划的HSS名称和DRA名称填写。 
执行命令[ADD DIAMCONN]，配置Diameter连接。
 说明： 
SCTP连接标识：需要关联ADD SCTP命令中配置的SCTP标识。 
MME根据SET COMBOCFG命令中配置的MMECODE、MMEGROUPID、MCC以及MNC自动生成一个主机名，根据MCC和MNC生成一个符合协议标准的域名。MME自动生成的主机名、域名样例分别为：
 mmec06.mmegi8052.mme.epc.mnc000.mcc460.3gppnetwork.org、epc.mnc000.mcc460.3gppnetwork.org，其中mmegi8052中的8052为十六进制数。 
对端HSS对接配置MME的主机名和域名时，可在MME本端通过SHOW DIAMCONN命令查询MME的主机名和域名。 
执行命令[ADD DIAMLINKGROUP]，配置Diameter链路组。
 说明： 
SCTP连接标识：需要关联[ADD DIAMCONN]命令中配置的SCTP连接标识。1个Diameter链路组最多可配置16条Diameter连接。
执行命令[ADD DIAMROUTE]，配置Diameter路由。
 说明： 
Diameter链路组：需要关联[ADD DIAMLINKGROUP]命令中配置的Diameter链路组。1条路由最多可配置2个链路组。
执行命令[ADD DIAMROUTEGROUP]，配置Diameter路由组。
 说明： 
Diameter路由ID：需要关联[ADD
DIAMROUTE]命令中配置的Diameter路由ID。1个路由组最多可配置2条路由。
执行命令[ADD DIAMADJROUTE]，配置Diameter局向路由。
 说明： 
Diameter路由组：需要关联[ADD DIAMROUTEGROUP]命令中配置的Diameter路由组ID。1个局向路由最多可配置4个Diameter路由组。
执行命令[ADD DIAMADJ ]，配置Diameter局向。
 说明： 
Diameter局向路由：需要关联ADD DIAMADJROUTE命令中配置的局向路由ID。1个局向最多可配置2条局向路由，2条局向路由为主备关系。 
对端局支持的协议版本号需要与对接局向确认。 
配置移动号码分析数据。 
执行命令[ADD DIMOFC ANALYSIS]，配置Diameter邻接局分析结果索引。
执行命令[ADD MDNAL]，配置移动号码分析。
 说明： 
被分析号码：可设置为1个IMSI号码或IMSI号段。
分析器入口：Diameter邻接局分析时，选择DAS_IMSI_DIAMETER。
号码分析结果索引：关联[ADD DIMOFC ANALYSIS]命令中配置的号码分析结果索引。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
SCTP偶联配置|SCTP标识|1、2、3、4、5、6、7、8|11、12、13、14、15、16、17、18
别名|SCTP偶联配置|DRA01_SCTP01~DRA01_SCTP08|DRA02_SCTP01~DRA02_SCTP08
本端端口|SCTP偶联配置|2181~2188|2181~2188
对端端口|SCTP偶联配置|2181~2188|2181~2188
VPNID1|SCTP偶联配置|12|12
本端IP地址1|SCTP偶联配置|SCTP标识为1、3、5、7的取值：10.124.17.81SCTP标识为2、4、6、8的取值：10.124.17.82|SCTP标识为11、13、15、17的取值：10.124.17.81SCTP标识为12、14、16、18的取值：10.124.17.82
对端IP地址1|SCTP偶联配置|SCTP标识为1、3、5、7的取值：192.10.51.1SCTP标识为2、4、6、8的取值：192.10.51.2|SCTP标识为11、13、15、17的取值：192.100.50.1SCTP标识为12、14、16、18的取值：192.100.50.2
本端IP地址2|SCTP偶联配置|SCTP标识为1、3、5、7的取值：10.124.17.82SCTP标识为2、4、6、8的取值：10.124.17.81|SCTP标识为11、13、15、17的取值：10.124.17.82SCTP标识为12、14、16、18的取值：10.124.17.81
对端IP地址2|SCTP偶联配置|SCTP标识为1、3、5、7的取值：192.10.51.2SCTP标识为2、4、6、8的取值：192.10.51.1|SCTP标识为11、13、15、17的取值：192.100.50.2SCTP标识为12、14、16、18的取值：192.100.50.1
应用属性|SCTP偶联配置|客户端|客户端
是否启用链路切换功能|SCTP偶联配置|开启|开启
检测报文长度|SCTP偶联配置|八分之一MTU|八分之一MTU
交叉建链属性|SCTP偶联配置|关闭|关闭
单偶联通路断告警属性|SCTP偶联配置|顺从全局配置|顺从全局配置
偶联归属组号|SCTP偶联配置|10|11
应用协议类型|SCTP偶联配置|DIAMETER|DIAMETER
偶联索引配置|偶联ID|1、2、3、4、5、6、7、8|11、12、13、14、15、16、17、18
偶联协议类型|偶联索引配置|Diameter|Diameter
用户别名|偶联索引配置|DRA01_SCTP01~DRA01_SCTP08|DRA02_SCTP01~DRA02_SCTP08
Diameter连接配置|对端节点域名|epc.mnc000.mcc460.3gppnetwork.org|epc.mnc000.mcc460.3gppnetwork.org
对端节点主机名|Diameter连接配置|DRA01.epc.mnc000.mcc460.3gppnetwork.org|DRA02.epc.mnc000.mcc460.3gppnetwork.org
SCTP连接标识|Diameter连接配置|1、2、3、4、5、6、7、8|11、12、13、14、15、16、17、18
Diameter链路组配置|Diameter链路组ID|10|11
SCTP连接标识|Diameter链路组配置|"1"&"2"&"3"&"4"&"5"&"6"&"7"&"8|"11"&"12"&"13"&"14"&"15"&"16"&"17"&"18"
分担方式|Diameter链路组配置|负荷分担|负荷分担
Diameter路由配置|Diameter路由ID|10|11
Diamerter链路组|Diameter路由配置|10|11
路由属性|Diameter路由配置|负荷分担|负荷分担
Diameter路由组配置|Diameter路由组ID|10|11
Diameter路由ID|Diameter路由组配置|10|11
路由属性|Diameter路由组配置|负荷分担|负荷分担
Diameter局向路由配置|局向路由ID|1|1
Diameter路由组|Diameter局向路由配置|"10"-"1"-"100"&"11"-"1"-"100"|"10"-"1"-"100"&"11"-"1"-"100"
是否默认局向路由|Diameter局向路由配置|否|否
域名|Diameter局向路由配置|epc.mnc000.mcc460.3gppnetwork.org|epc.mnc000.mcc460.3gppnetwork.org
用户别名|Diameter局向路由配置|DRA|DRA
Diameter局向配置|Diameter局向号|1|1
Diameter局向路由|Diameter局向配置|1|1
Diameter邻接局分析结果索引|号码分析结果索引|1|1
邻接局编号|Diameter邻接局分析结果索引|1|1
移动号码分析|被分析号码|46000、46002、46004、46007、46008、46013|46000、46002、46004、46007、46008、46013
号码分析结果索引|移动号码分析|1|1
分析器入口|移动号码分析|Diameter邻接局分析|Diameter邻接局分析
根据规划，进行如下配置。 
新增Diameter偶联，命令如下。 
[ADD SCTP]:ID=1,NAME="DRA01_SCTP01",LOCPORT=2181,REMPORT=2181,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.10.51.1",LOCADDR2="10.124.17.82",REMADDR2="192.10.51.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=2,NAME="DRA01_SCTP02",LOCPORT=2182,REMPORT=2182,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.10.51.2",LOCADDR2="10.124.17.81",REMADDR2="192.10.51.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=3,NAME="DRA01_SCTP03",LOCPORT=2183,REMPORT=2183,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.10.51.1",LOCADDR2="10.124.17.82",REMADDR2="192.10.51.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=4,NAME="DRA01_SCTP04",LOCPORT=2184,REMPORT=2184,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.10.51.2",LOCADDR2="10.124.17.81",REMADDR2="192.10.51.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=5,NAME="DRA01_SCTP05",LOCPORT=2185,REMPORT=2185,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.10.51.1",LOCADDR2="10.124.17.82",REMADDR2="192.10.51.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=6,NAME="DRA01_SCTP06",LOCPORT=2186,REMPORT=2186,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.10.51.2",LOCADDR2="10.124.17.81",REMADDR2="192.10.51.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=7,NAME="DRA01_SCTP07",LOCPORT=2187,REMPORT=2187,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.10.51.1",LOCADDR2="10.124.17.82",REMADDR2="192.10.51.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=8,NAME="DRA01_SCTP08",LOCPORT=2188,REMPORT=2188,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.10.51.2",LOCADDR2="10.124.17.81",REMADDR2="192.10.51.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=10,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=11,NAME="DRA02_SCTP01",LOCPORT=2181,REMPORT=2181,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.100.50.1",LOCADDR2="10.124.17.82",REMADDR2="192.100.50.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=12,NAME="DRA02_SCTP02",LOCPORT=2182,REMPORT=2182,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.100.50.2",LOCADDR2="10.124.17.81",REMADDR2="192.100.50.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=13,NAME="DRA02_SCTP03",LOCPORT=2183,REMPORT=2183,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.100.50.1",LOCADDR2="10.124.17.82",REMADDR2="192.100.50.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=14,NAME="DRA02_SCTP04",LOCPORT=2184,REMPORT=2184,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.100.50.2",LOCADDR2="10.124.17.81",REMADDR2="192.100.50.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=15,NAME="DRA02_SCTP05",LOCPORT=2185,REMPORT=2185,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.100.50.1",LOCADDR2="10.124.17.82",REMADDR2="192.100.50.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=16,NAME="DRA02_SCTP06",LOCPORT=2186,REMPORT=2186,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.100.50.2",LOCADDR2="10.124.17.81",REMADDR2="192.100.50.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=17,NAME="DRA02_SCTP07",LOCPORT=2187,REMPORT=2187,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="192.100.50.1",LOCADDR2="10.124.17.82",REMADDR2="192.100.50.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=18,NAME="DRA02_SCTP08",LOCPORT=2188,REMPORT=2188,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="192.100.50.2",LOCADDR2="10.124.17.81",REMADDR2="192.100.50.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=11,PROTOCALTYPE="DIAMETER"
新增偶联索引，命令如下。 
[ADD SCTPIDCFG]:SCTPID=1,TYPE="DIM",NAME="DRA01_SCTP01"
[ADD SCTPIDCFG]:SCTPID=2,TYPE="DIM",NAME="DRA01_SCTP02"
[ADD SCTPIDCFG]:SCTPID=3,TYPE="DIM",NAME="DRA01_SCTP08"
[ADD SCTPIDCFG]:SCTPID=4,TYPE="DIM",NAME="DRA01_SCTP04"
[ADD SCTPIDCFG]:SCTPID=5,TYPE="DIM",NAME="DRA01_SCTP05"
[ADD SCTPIDCFG]:SCTPID=6,TYPE="DIM",NAME="DRA01_SCTP06"
[ADD SCTPIDCFG]:SCTPID=7,TYPE="DIM",NAME="DRA01_SCTP07"
[ADD SCTPIDCFG]:SCTPID=8,TYPE="DIM",NAME="DRA01_SCTP08"
[ADD SCTPIDCFG]:SCTPID=11,TYPE="DIM",NAME="DRA02_SCTP01"
[ADD SCTPIDCFG]:SCTPID=12,TYPE="DIM",NAME="DRA02_SCTP02"
[ADD SCTPIDCFG]:SCTPID=13,TYPE="DIM",NAME="DRA02_SCTP03"
[ADD SCTPIDCFG]:SCTPID=14,TYPE="DIM",NAME="DRA02_SCTP04"
[ADD SCTPIDCFG]:SCTPID=15,TYPE="DIM",NAME="DRA02_SCTP05"
[ADD SCTPIDCFG]:SCTPID=16,TYPE="DIM",NAME="DRA02_SCTP06"
[ADD SCTPIDCFG]:SCTPID=17,TYPE="DIM",NAME="DRA02_SCTP07"
[ADD SCTPIDCFG]:SCTPID=18,TYPE="DIM",NAME="DRA02_SCTP08"
配置Diameter连接路由。 
新增Diameter连接，命令如下。 
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=1
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=2
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=3
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=4
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=5
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=6
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=7
[ADD DIAMCONN]:ADJNAME="DRA01.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=8
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=11
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=12
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=13
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=14
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=15
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=16
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=17
[ADD DIAMCONN]:ADJNAME="DRA02.epc.mnc000.mcc460.3gppnetwork.org",ADJDOMAIN="epc.mnc000.mcc460.3gppnetwork.org",SCTPID=18
新增Diameter链路组，命令如下。 
[ADD DIAMLINKGROUP]:LINKGRPID=10,SCTPLINKID="1"&"2"&"3"&"4"&"5"&"6"&"7"&"8",PARTAKEMODE="PARTAKE"
[ADD DIAMLINKGROUP]:LINKGRPID=11,SCTPLINKID="11"&"12"&"13"&"14"&"15"&"16"&"17"&"18",PARTAKEMODE="PARTAKE"
新增Diameter路由，命令如下。 
[ADD DIAMROUTE]:ROUTEID=10,LINKGRPID=10,PROPERTY="PARTAKE"
[ADD DIAMROUTE]:ROUTEID=11,LINKGRPID=11,PROPERTY="PARTAKE"
新增Diameter路由组，命令如下。 
[ADD DIAMROUTEGROUP]:ROUTEGRPID=10,ROUTEID="10",PROPERTY="PARTAKE"
[ADD DIAMROUTEGROUP]:ROUTEGRPID=11,ROUTEID="11",PROPERTY="PARTAKE"
新增Diameter局向路由，命令如下。 
[ADD DIAMADJROUTE]:ADJROUTEID=1,ROUTEGROUP="10"-"1"-"100"&"11"-"1"-"100",REALM="epc.mnc000.mcc460.3gppnetwork.org",USERLABEL="DRA"
新增Diameter局向，命令如下。 
[ADD DIAMADJ]:ADJID=1,ADJROUTEID="1"
配置移动号码分析数据。 
新增Diameter邻接局分析结果索引，命令如下。 
[ADD DIMOFC ANALYSIS]:IDX=1,DIAMGRPID=1
添加移动号码分析，命令如下。 
[ADD MDNAL]:DGT="46000",ENTR="DAS_IMSI_DIAMETER",RST=1
[ADD MDNAL]:DGT="46002",ENTR="DAS_IMSI_DIAMETER",RST=1
[ADD MDNAL]:DGT="46004",ENTR="DAS_IMSI_DIAMETER",RST=1
[ADD MDNAL]:DGT="46007",ENTR="DAS_IMSI_DIAMETER",RST=1
[ADD MDNAL]:DGT="46008",ENTR="DAS_IMSI_DIAMETER",RST=1
[ADD MDNAL]:DGT="46013",ENTR="DAS_IMSI_DIAMETER",RST=1
##### 配置MME与EIR对接数据 
摘要 :MME通过S13接口与EIR连接，实现对用户IMEI的认证和授权功能。
MME与EIR对接组网及协议栈如[图1]所示。
图1  MME与EIR对接组网及协议栈

相关信息 :MME与EIR对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|设置本局移动数据支持S13接口|查询本局移动数据中已开启的接口配置，在已配置接口的基础上增加S13接口。
2|新增Diameter EIR配置|MME最多只能关联一个EIR。若EIR与HSS合一，则直接在此配置中关联“配置MME与HSS/DRA对接数据”步骤3中已配置的HSS Diameter局向。若EIR局向与HSS局向单独部署时，则参照“配置MME与HSS/DRA对接数据”的步骤2和步骤3，先配置EIR对应的Diameter局向，再在此配置中关联已配置的EIR Diameter局向。
3|设置移动管理参数|开启MME获取用户IMEI类型开关，具体IMEI类型需要和运营商确认，推荐选择“获取IMEISV”。
4|设置安全参数|配置MME支持IMEI检查控制功能。
5|配置基于IMSI号段的IMEI检查|配置MME基于IMSI号段进行IMEI检查。
步骤 :设置本局移动数据支持S13接口，执行如下操作。 
如果通过[SHOW COMBOCFG]命令查询到当前局向的SUPTYPE为“Gb接口&Iu接口&增强GPRS”，则按如下命令开启S13接口：
[SET COMBOCFG]:SUPTYPE="Gb"&"Iu"&"Egprs"&"S13"
此处不能直接以命令脚本[SET COMBOCFG]:SUPTYPE="S13"
进行配置，此种配置方法会导致之前已开启的其他接口被关闭。
执行命令[ADD DIAMEIR]，新增Diameter EIR配置。
 说明： 
Diameter局向ID：该参数关联[ADD DIAMADJ]命令中配置的Diameter局向号，可以使用[SHOW DIAMADJ]命令查看已配置的Diameter局向号。
执行命令[SET MOBILE MANAGEMENT]，设置移动管理参数中的“MME获取IMEI(SV)”参数。
执行命令[SET SOFTWARE PARAMETER]，设置软件参数ID为786873的软件参数值为0，ID为262227的软件参数值为1。
执行命令[SET SECURITY PARAMETER]，设置安全参数，配置MME需要进行 IMEI检查控制。
[SET SECURITY PARAMETER]命令的关键参数说明参见[表2]。
参数标识|参数名称|参数设置说明
---|---|---
MMECHECKIMEI|MMEIMEI检查控制|根据运营商要求，配置MME是否检查IMEI。取值含义如下：需要：表示MME需要检查IMEI。不需要：表示MME不需要检查IMEI。
MMEFAILIMEI|MMEIMEI获取或检查失败处理控制|根据运营商要求，配置MME获取或检查IMEI失败后，流程是否继续。取值含义如下：流程继续：表示MME获取或检查IMEI失败后，流程继续。流程失败：表示MME获取或检查IMEI失败后，流程失败终止。
执行命令[ADD MME IMEI CHECK]，增加需要进行IMEI检查的IMSI号段。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
本局移动数据配置|支持类型|"Gb"&"Iu"&"Egprs"&"S13"|"Gb"&"Iu"&"Egprs"&"S13"
Diameter EIR配置|Diameter局向ID|15|15
移动管理参数配置|MME 获取IMEI(SV)|获取IMEISV|获取IMEISV
软件参数配置|软件参数ID|786873|262227
软件参数值|软件参数配置|0|1
安全参数配置|MME IMEI检查控制|需要|需要
MME IMEI获取或检查失败处理控制|安全参数配置|流程继续|流程继续
MME基于IMSI号段IMEI检查配置|IMSI号段|46000、46002、46004、46007、46008、46013|46000、46002、46004、46007、46008、46013
根据规划，进行如下配置。 
设置本局移动数据支持S13接口，命令如下。 
[SET COMBOCFG]:SUPTYPE="Gb"&"Iu"&"Egprs"&"S13"
新增Diameter EIR配置，命令如下。
[ADD DIAMEIR]:GRPID=15
设置移动管理参数，开启MME获取用户IMEI开关，命令如下。
[SET MOBILE MANAGEMENT]:MMEGETIMEI="Get IMEISV"
设置软件参数ID为786873的软件参数值为0，ID为262227的软件参数值为1，命令如下。 
[SET SOFTWARE PARAMETER]:PARAID=786873,PARAVALUE=0
[SET SOFTWARE PARAMETER]:PARAID=262227,PARAVALUE=1
设置安全参数，配置MME需要进行 IMEI检查控制，命令如下。
[SET SECURITY PARAMETER]:MMECHECKIMEI="Need",MMEFAILIMEI="Continue"
设置MME基于IMSI号段IMEI检查配置，命令如下。 
[ADD MME IMEI CHECK]:IMSI="46000"
[ADD MME IMEI CHECK]:IMSI="46002"
[ADD MME IMEI CHECK]:IMSI="46004"
[ADD MME IMEI CHECK]:IMSI="46007"
[ADD MME IMEI CHECK]:IMSI="46008"
[ADD MME IMEI CHECK]:IMSI="46013"
##### 配置MME与MSC对接数据 
摘要 :MME通过SGs接口与MSC连接，实现CSFB功能，采用SGsAP协议。
MME与MSC对接组网及协议栈如[图1]所示。
图1  MME与MSC对接组网及协议栈

前提 :已打开MME支持CSFB功能的License项。
步骤 :执行命令[SET SGSFLAG]，设置支持SGs口。
执行命令[ADD SCTP]，配置SGs口偶联。
执行命令[ADD SCTPIDCFG]，配置偶联索引。
执行命令[ADD SGSCONN]，配置SGs口连接。
执行命令[ADD SGS ROUTE]，配置SGs口路由。
执行命令[ADD SGS ROUTE GROUP]，配置SGs口路由组。
执行命令[ADD SGS OFFICE ROUTE GROUP]，配置SGs局向路由组。
执行命令[ADD VLROFFICE]，配置VLR局向。
执行命令[ADD VLRPOOL]，配置SGS口VLRPOOL。
执行命令[ADD LAI]，配置位置区。
执行命令[ADD TA]，配置跟踪区。
执行命令[ADD LAIVLRPOOL]，配置SGS选择VLRPOOL配置。
举例 :MME1和MSC1/MSC2直连，MSC1与MSC2进行负荷分担，组网如[图2]所示。
图2  MME与MSC组网举例

在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
SGS口开关配置|支持SGS口|是|是
SCTP偶联配置|SCTP标识|100、101、102、103|110、111、112、113
别名|SCTP偶联配置|MSC1SCTP_1、MSC1SCTP_2、MSC1SCTP_3、MSC1SCTP_4|MSC2SCTP_1、MSC2SCTP_2、MSC2SCTP_3、MSC2SCTP_4
本端端口|SCTP偶联配置|5011、5012、5013、5014|5011、5012、5013、5014
对端端口|SCTP偶联配置|5011、5012、5013、5014|5011、5012、5013、5014
VPNID1|SCTP偶联配置|16|16
本端IP地址1|SCTP偶联配置|SCTP标识为100、102的取值：10.36.192.128SCTP标识为101、103的取值：10.36.192.129|SCTP标识为110、112的取值：10.36.192.128SCTP标识为111、113的取值：10.36.192.129
对端IP地址1|SCTP偶联配置|SCTP标识为100、102的取值：40.40.1.1SCTP标识为101、103的取值：40.40.1.2|SCTP标识为110、112的取值：40.40.2.1SCTP标识为111、113的取值：40.40.2.2
本端IP地址2|SCTP偶联配置|SCTP标识为100、102的取值：10.36.192.129SCTP标识为101、103的取值：10.36.192.128|SCTP标识为110、112的取值：10.36.192.129SCTP标识为111、113的取值：10.36.192.128
对端IP地址2|SCTP偶联配置|SCTP标识为100、102的取值：40.40.1.2SCTP标识为101、103的取值：40.40.1.1|SCTP标识为110、112的取值：40.40.2.2SCTP标识为111、113的取值：40.40.2.1
应用属性|SCTP偶联配置|客户端|客户端
是否启用链路切换功能|SCTP偶联配置|开启|开启
检测报文长度|SCTP偶联配置|八分之一MTU|八分之一MTU
交叉建链属性|SCTP偶联配置|关闭|关闭
单偶联通路断告警属性|SCTP偶联配置|顺从全局配置|顺从全局配置
偶联归属组号|SCTP偶联配置|100|110
应用协议类型|SCTP偶联配置|SGS|SGS
偶联索引配置|偶联ID|100、101、102、103|110、111、112、113
偶联协议类型|偶联索引配置|SGs|SGs
用户别名|偶联索引配置|MSC1-SCTP1、MSC1-SCTP2、MSC1-SCTP3、MSC1-SCTP4|MSC2-SCTP1、MSC2-SCTP2、MSC2-SCTP3、MSC2-SCTP4
SGS连接配置|SGS连接编号|100、101、102、103|110、111、112、113
SCTP连接标识|SGS连接配置|100、101、102、103|110、111、112、113
SGS连接名称|SGS连接配置|MSC1-SCTP1、MSC1-SCTP2、MSC1-SCTP3、MSC1-SCTP4|MSC2-SCTP1、MSC2-SCTP2、MSC2-SCTP3、MSC2-SCTP4
SGs路由配置|路由ID|100|110
分担方式|SGs路由配置|负荷分担|负荷分担
连接编号|SGs路由配置|100&101&102&103|110&111&112&113
SGs路由组配置|路由组ID|100|110
分担方式|SGs路由组配置|负荷分担|负荷分担
路由ID|SGs路由组配置|100|110
SGs局向路由组配置|局向ID|100|110
直达路由组ID|SGs局向路由组配置|100|110
用户别名|SGs局向路由组配置|MSC1|MSC2
SGs口VLR局向配置|VLR局向标识|100|110
VLR名称|SGs口VLR局向配置|msc1.msc.mnc001.mcc460.3gppnetwork.org|msc2.msc.mnc001.mcc460.3gppnetwork.org
是否支持CS-MO-LR功能|SGs口VLR局向配置|未知|未知
局向属性|SGs口VLR局向配置|"LUR_TAI"&"NO_LAI"&"NO_TMSI"&"CS"&"ASSRES"|"LUR_TAI"&"NO_LAI"&"NO_TMSI"&"CS"&"ASSRES"
MT短信用户不可达原因值|SGs口VLR局向配置|用户临时不可达|用户临时不可达
SGs口VLR POOL配置|VLR POOL标识|1|1
VLR局向标识|SGs口VLR POOL配置|100|110
VLR级别|SGs口VLR POOL配置|1|1
VLR权重|SGs口VLR POOL配置|50|50
位置区配置|位置区名|lai110|lai110
移动国家码|位置区配置|460|460
移动网号|位置区配置|01|01
位置区域码(HEX)|位置区配置|0110|0110
跟踪区配置|跟踪区标识|110|110
组号|跟踪区配置|1|1
移动国家码|跟踪区配置|460|460
移动网号|跟踪区配置|01|01
跟踪区域码(HEX)|跟踪区配置|0110|0110
是否使用全局时区|跟踪区配置|是|是
位置区名|跟踪区配置|lai110|lai110
跟踪区名称|跟踪区配置|ta110|ta110
SGs口选择VLR POOL配置|位置区名|lai110|lai110
VLR POOL标识|SGs口选择VLR POOL配置|1|1
根据规划，进行如下配置。 
设置MME支持SGs口，命令如下。 
[SET SGSFLAG]:SGSFLAG="YES"
增加SGs偶联。 
增加MME与MSC1之间的SGs偶联连接SCTP，命令如下。 
[ADD SCTP]:ID=100,NAME="MSC1SCTP_1",LOCPORT=5011,REMPORT=5011,VPNID1=16,LOCADDR1="10.36.192.128",REMADDR1="40.40.1.1",LOCADDR2="10.36.192.129",REMADDR2="40.40.1.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=100,PROTOCALTYPE="SGS"
[ADD SCTP]:ID=101,NAME="MSC1SCTP_2",LOCPORT=5012,REMPORT=5012,VPNID1=16,LOCADDR1="10.36.192.129",REMADDR1="40.40.1.2",LOCADDR2="10.36.192.128",REMADDR2="40.40.1.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=100,PROTOCALTYPE="SGS"
[ADD SCTP]:ID=102,NAME="MSC1SCTP_3",LOCPORT=5013,REMPORT=5013,VPNID1=16,LOCADDR1="10.36.192.128",REMADDR1="40.40.1.1",LOCADDR2="10.36.192.129",REMADDR2="40.40.1.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=100,PROTOCALTYPE="SGS"
[ADD SCTP]:ID=103,NAME="MSC1SCTP_4",LOCPORT=5014,REMPORT=5014,VPNID1=16,LOCADDR1="10.36.192.129",REMADDR1="40.40.1.2",LOCADDR2="10.36.192.128",REMADDR2="40.40.1.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=100,PROTOCALTYPE="SGS"
增加MME与MSC2之间的SGs偶联连接SCTP，命令如下。 
[ADD SCTP]:ID=110,NAME="MSC2SCTP_1",LOCPORT=5011,REMPORT=5011,VPNID1=16,LOCADDR1="10.36.192.128",REMADDR1="40.40.2.1",LOCADDR2="10.36.192.129",REMADDR2="40.40.2.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=110,PROTOCALTYPE="SGS"
[ADD SCTP]:ID=111,NAME="MSC2SCTP_2",LOCPORT=5012,REMPORT=5012,VPNID1=16,LOCADDR1="10.36.192.129",REMADDR1="40.40.2.2",LOCADDR2="10.36.192.128",REMADDR2="40.40.2.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=110,PROTOCALTYPE="SGS"
[ADD SCTP]:ID=112,NAME="MSC2SCTP_3",LOCPORT=5013,REMPORT=5013,VPNID1=16,LOCADDR1="10.36.192.128",REMADDR1="40.40.2.1",LOCADDR2="10.36.192.129",REMADDR2="40.40.2.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=110,PROTOCALTYPE="SGS"
[ADD SCTP]:ID=113,NAME="MSC2SCTP_4",LOCPORT=5014,REMPORT=5014,VPNID1=16,LOCADDR1="10.36.192.129",REMADDR1="40.40.2.2",LOCADDR2="10.36.192.128",REMADDR2="40.40.2.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=110,PROTOCALTYPE="SGS"
新增偶联索引，命令如下。 
[ADD SCTPIDCFG]:SCTPID=100,TYPE="SGs",NAME="MSC1-SCTP1"
[ADD SCTPIDCFG]:SCTPID=101,TYPE="SGs",NAME="MSC1-SCTP2"
[ADD SCTPIDCFG]:SCTPID=102,TYPE="SGs",NAME="MSC1-SCTP3"
[ADD SCTPIDCFG]:SCTPID=103,TYPE="SGs",NAME="MSC1-SCTP4"
[ADD SCTPIDCFG]:SCTPID=110,TYPE="SGs",NAME="MSC2-SCTP1"
[ADD SCTPIDCFG]:SCTPID=111,TYPE="SGs",NAME="MSC2-SCTP2"
[ADD SCTPIDCFG]:SCTPID=112,TYPE="SGs",NAME="MSC2-SCTP3"
[ADD SCTPIDCFG]:SCTPID=113,TYPE="SGs",NAME="MSC2-SCTP4"
增加SGs连接。 
增加MME到MSC1的SGs连接，命令如下。 
[ADD SGSCONN]:ID=100,SCTPID=100,NAME="MSC1_SCTP1"
[ADD SGSCONN]:ID=101,SCTPID=101,NAME="MSC1_SCTP2"
[ADD SGSCONN]:ID=102,SCTPID=102,NAME="MSC1_SCTP3"
[ADD SGSCONN]:ID=103,SCTPID=103,NAME="MSC1_SCTP4"
增加MME到MSC2的SGs连接，命令如下。 
[ADD SGSCONN]:ID=110,SCTPID=110,NAME="MSC2_SCTP1"
[ADD SGSCONN]:ID=111,SCTPID=111,NAME="MSC2_SCTP2"
[ADD SGSCONN]:ID=112,SCTPID=112,NAME="MSC2_SCTP3"
[ADD SGSCONN]:ID=113,SCTPID=113,NAME="MSC2_SCTP4"
增加SGs路由配置。 
增加MME到MSC1的SGs路由配置，命令如下。 
[ADD SGS ROUTE]:ROUTEID=100,PARTAKEMODE="PARTAKE",CONNECTION="100&101&102&103"
增加MME到MSC2的SGs路由配置，命令如下。 
[ADD SGS ROUTE]:ROUTEID=110,PARTAKEMODE="PARTAKE",CONNECTION="110&111&112&113"
增加SGs路由组配置。 
增加MME到MSC1的SGs路由组配置，命令如下。 
[ADD SGS ROUTE GROUP]:ROUTEGRPID=100,PARTAKEMODE="PARTAKE",ROUTE="100"
增加MME到MSC2的SGs路由组配置，命令如下。 
[ADD SGS ROUTE GROUP]:ROUTEGRPID=110,PARTAKEMODE="PARTAKE",ROUTE="110"
增加SGs局向路由组配置。 
增加MME到MSC1局向的SGs路由组配置，命令如下。 
[ADD SGS OFFICE ROUTE GROUP]:OFFICEID=100,ROUTEGRPID=100,NAME="MSC1"
增加MME到MSC2局向的SGs路由组配置，命令如下。 
[ADD SGS OFFICE ROUTE GROUP]:OFFICEID=110,ROUTEGRPID=110,NAME="MSC2"
增加SGs VLR局向配置。 
增加MME到MSC1局向，命令如下。 
[ADD VLROFFICE]:VLROFFICEID=100,VLRNAME="msc1.msc.mnc001.mcc460.3gppnetwork.org",CSMOLR="CS-MO-LR_UNKNOWN",ATTR="LUR_TAI"&"NO_LAI"&"NO_TMSI"&"CS"&"ASSRES",SGSCAUSE="UE_TU"
增加MME到MSC2局向，命令如下。 
[ADD VLROFFICE]:VLROFFICEID=110,VLRNAME="msc2.msc.mnc001.mcc460.3gppnetwork.org",CSMOLR="CS-MO-LR_UNKNOWN",ATTR="LUR_TAI"&"NO_LAI"&"NO_TMSI"&"CS"&"ASSRES",SGSCAUSE="UE_TU"
增加VLR Pool配置。 
增加MME到MSC1的VLR Pool配置，命令如下。 
[ADD VLRPOOL]:VLRPOOLID=1,VLROFFICEID=100,VLRLEVEL="LEVEL_1",VLRWEIGHT=50
增加MME到MSC2的VLR Pool配置，命令如下。 
[ADD VLRPOOL]:VLRPOOLID=1,VLROFFICEID=110,VLRLEVEL="LEVEL_1",VLRWEIGHT=50
新增一个位置区，命令如下。 
[ADD LAI]:NAME="lai110",MCC="460",MNC="01",LAC="0110"
新增一个跟踪区，以及对应的位置区，命令如下。 
[ADD TA]:TAID=110,GRPID=1,MCC="460",MNC="01",TAC="0110",GLOBALTZ="YES",LAI="lai110",NAME="ta110"
新增SGs口选择VLR Pool配置，命令如下。 
[ADD LAIVLRPOOL]:LAINAME="lai110",VLRPOOLID=1
##### 配置MME与GW对接数据 
摘要 :MME通过S11接口与SGW连接，实现基本会话业务。MME不直接与PGW对接，但是在进行会话业务时，MME需根据APN解析出PGW的地址，根据TAI解析出需要接入的SGW地址，并将解析出的PGW地址传递给SGW。因此在配置MME与SGW对接数据时，需要配置对PGW的地址解析。
MME与SGW对接组网及协议栈如[图1]所示。
图1  MME与SGW对接组网及协议栈

相关信息 :用户在进行会话业务时，先创建默认承载，获取到PDN地址，再根据此PDN地址进行数据业务。其基本流程如下：
用户附着时需要创建默认承载。创建默认承载时，用户会发起PDN连接请求，其中携带APN参数，标识自己选择的接入点，例如用户选择zte.com作为接入点。
MME根据签约APN或用户请求中的APN，结合用户IMSI信息或MME本局属性里的PLMN构造出APN对应的FQDN，并据此解析需要接入的PGW地址。
MME得到PGW的地址后，再根据用户当前的TAI构造FQDN并解析需要接入的SGW地址，发送创建默认承载请求给SGW。SGW根据MME传来的PGW地址，再向PGW发送创建默认承载请求。PGW返回分配给UE使用的PDN地址。用户根据此PDN地址进行数据业务。
MME不直接与PGW对接，但是在进行会话业务时，MME需根据APN解析出PGW的地址，根据TAI解析出需要接入的SGW地址，并将解析出的PGW地址传递给SGW。因此在配置MME与SGW对接数据时，需要配置对PGW的地址解析，配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|配置对PGW的地址解析|设置PLMN网络中APN和PGW的IP地址对应关系。MME可以由APN解析得到PGW的IP地址。
2|配置对SGW的地址解析|设置PLMN网络中TAI和SGW的IP地址对应关系。MME可以由TAI解析得到SGW的IP地址
SGW和PGW的主机名配置规则为： 
<"topon" | "topoff"> . <single-label-interface-name>
. <canonical-node-name>。 
参数具体解释参见[表2]。
参数|说明
---|---
<"topon" | "topoff">|topon：表示优先选择合设且拓扑闭合的节点。topoff：表示不会优先选择合设且拓扑闭合的节点。
<single-label-interface-name>|用于命名特定接口的单标签。
<canonical-node-name>|用于指定具体的节点，具体配置规则为：网元名称.地市简拼.省份简拼.node.epc.mnc<MNC>.mcc<MCC>.3gppnetwork.org当SGW和PGW合一部署时，PGW的主机名中网元名称与SGW一致。
步骤 :执行命令[ADD EPC APN]，配置对PGW的地址解析。
[ADD EPC APN]命令的关键参数说明参见[表3]。
参数标识|参数名称|参数设置说明
---|---|---
SERVICE|支持服务类别|解析PGW地址时选择x-3gpp-pgw。
PROTOCOL|支持协议类型|解析PGW地址时选择x-s5-gtp和x-s8-gtp。
IPADDR|IP地址|PGW的S5/S8 GTP-C地址。
HOST|主机名|PGW的主机名。
执行命令[ADD EPCHOST]，配置对SGW的地址解析。
[ADD EPCHOST]命令的关键参数说明参见[表4]。
参数标识|参数名称|参数设置说明
---|---|---
NAME|逻辑名称|TAI逻辑名称：TA标识具有固定格式“tac-lbWW.tac-hbXX.tac.epc.mncYYY.mccZZZ.3gppnetwork.org”。WW为2位数值表示的TAC的低字节，不足2位的，靠前补零。XX为2位数值表示的TAC的高字节，不足2位的，靠前补零。YYY、ZZZ为3位数值表示的MNC、MCC，不足3位的，靠前补零。W、X为十六进制数，Y、Z为十进制数。例如：TAC低字节为01、高字节为02、MNC为02、MCC为460时，TAI逻辑名称为：tac-lb01.tac-hb02.tac.epc.mnc002.mcc460.3gppnetwork.org。
SERVICE|支持服务类别|解析SGW地址时选择x-3gpp-sgw。
PROTOCOL|支持协议类型|解析SGW地址时选择x-s5-gtp、x-s8-gtp和x-s11。
IPADDR|IP地址|SGW的S11 GTP-C地址。
HOST|主机名|SGW的主机名。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
PGW地址解析配置|APN名称|cmnet.apn.epc.mnc000.mcc460.3gppnetwork.org
主机名|PGW地址解析配置|topon.pgw-s5.saegw85.gz.gd.node.epc.mnc000.mcc460.3gppnetwork.org
IP地址|PGW地址解析配置|115.169.135.160
支持服务器类别|PGW地址解析配置|x-3gpp-pgw
支持协议类型|PGW地址解析配置|x-s5-gtp&x-s8-gtp
SGW地址解析配置|逻辑名称|tac-lb01.tac-hb00.tac.epc.mnc000.mcc460.3gppnetwork.org
支持服务器类别|SGW地址解析配置|x-3gpp-sgw
主机名|SGW地址解析配置|topon.s11.saegw85.gz.gd.node.epc.mnc000.mcc460.3 gppnetwork.org
IP地址|SGW地址解析配置|115.169.135.159
支持协议类型|SGW地址解析配置|x-s5-gtp&x-s8-gtp&x-s11
根据规划，进行如下配置。 
新增PGW地址解析配置，命令如下。
[ADD EPC APN]:APN="cmnet.apn.epc.mnc000.mcc460.3gppnetwork.org",HOST=" topon.pgw-s5.saegw85.gz.gd.node.epc.mnc000.mcc460.3gppnetwork.org", IPADDR="115.169.135.160",SERVICE="x-3gpp-pgw",PROTOCOL="x-s5-gtp"&"x-s8-gtp"
新增SGW地址解析配置，命令如下。
[ADD EPCHOST]:NAME="tac-lb01.tac-hb00.tac.epc.mnc000.mcc460.3gppnetwork.org", SERVICE="x-3gpp-sgw",HOST="topon.s11.saegw85.gz.gd.node.epc.mnc000.mcc460.3 gppnetwork.org",IPADDR="115.169.135.159",PROTOCOL="x-s5-gtp"&"x-s8-gtp"&"x-s11"
##### 配置MME与其他MME对接数据 
摘要 :MME通过S10接口与其他MME连接，实现MME上下文请求、前转重定位等功能。
MME与其他MME对接组网及协议栈如[图1]所示。
图1  MME与其他MME对接组网及协议栈

相关信息 :MME与其他MME的对接，只需配置要连接的MME地址解析即可。MME的地址解析过程包括以下两种情况：
用户在MME局间附着或局间TAU时，MME根据GUMMEI可查询到old MME。  
用户在MME局间切换时，MME根据相邻MME管理的TA跟踪区域可查询到相邻的MME。 
步骤 :执行命令[ADD EPCHOST]，新增MME地址解析配置。
[ADD EPCHOST]命令的关键参数说明参见[表1]。
参数标识|参数名称|参数设置说明
---|---|---
NAME|逻辑名称|用户在MME局间附着或局间TAU的情况下，逻辑名称根据GUMMEI构成。例如GUMMEI的MCC=WWW、MNC=ZZZ、MMEGI=YYYY，MMEC=XX，则此处的逻辑名称为mmecXX.mmegiYYYY.mme.epc.mncZZZ.mccWWW.3gppnetwork.org。XX为2位十六进制数值表示的MMEC，不足2位的，靠前补零。YYYY为4位十六进制数值表示的MMEGI，不足4位的，靠前补零。ZZZ、WWW分别为3位十进制数值表示的MNC、MCC，不足3位的，靠前补零。用户在MME局间切换的情况下，逻辑名称根据相邻切换MME管理的跟踪区TAI构成。例如TAI的MCC=WWW、MNC=ZZZ、TAC=XXYY，则此处的逻辑名称为tac-lbYY.tac-hbXX.tac.epc.mncZZZ.mccWWW.3gppnetwork.org。YY为2位十六进制数值表示的TAC的低字节，不足2位的，靠前补零。XX为2位十六进制数值表示的TAC的高字节，不足2位的，靠前补零。ZZZ、WWW分别为3位十进制数值表示的MNC、MCC，不足3位的，靠前补零。
SERVICE|支持服务类别|解析MME地址时选择x-3gpp-mme。
PROTOCOL|支持协议类型|解析MME地址时选择x-s10。
IPADDR|IP地址|对端MME的IP地址。
HOST|主机名|对端MME的主机名称。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
EPC地址解析配置（局间附着或局间TAU）|逻辑名称|mmec01.mmegi8058.mme.epc.mnc000.mcc460.3 gppnetwork.org
支持服务类别|EPC地址解析配置（局间附着或局间TAU）|x-3gpp-mme
主机名|EPC地址解析配置（局间附着或局间TAU）|mme58.epc.mnc000.mcc460.3 gppnetwork.org
IP地址|EPC地址解析配置（局间附着或局间TAU）|131.58.1.159
支持协议类型|EPC地址解析配置（局间附着或局间TAU）|x-s10
EPC地址解析配置（局间切换）|逻辑名称|"tac-lb01.tac-hb00.tac.epc.mnc000.mcc460.3gppnetwork. org
支持服务类别|EPC地址解析配置（局间切换）|x-3gpp-mme
主机名|EPC地址解析配置（局间切换）|mme58.epc.mnc000.mcc460.3gppnetwork. org
IP地址|EPC地址解析配置（局间切换）|131.58.1.159
支持协议类型|EPC地址解析配置（局间切换）|x-s10
根据规划，进行如下配置。 
增加对MME的地址解析，用于局间附着或局间TAU，命令如下。
[ADD EPCHOST]:NAME="mmec01.mmegi8058.mme.epc.mnc000.mcc460.3 gppnetwork.org",SERVICE="x-3gpp-mme",HOST="mme58.epc.mnc000.mcc460.3 gppnetwork.org",IPADDR="131.58.1.159",PROTOCOL="x-s10"
增加对MME的地址解析，用于局间切换，命令如下。 
[ADD EPCHOST]:NAME="tac-lb01.tac-hb00.tac.epc.mnc000.mcc460.3gppnetwork. org",SERVICE="x-3gpp-mme",HOST="mme58.epc.mnc000.mcc460.3gppnetwork. org",IPADDR="131.58.1.159",PROTOCOL="x-s10"
##### 配置MME与Gn/Gp SGSN对接数据 
摘要 :MME通过Gn/Gp接口与Gn/Gp SGSN连接，实现前转重定位、上下文请求、ID请求等功能。
MME与Gn/Gp SGSN对接组网及协议栈如[图1]所示。
图1  MME与Gn/Gp SGSN对接组网及协议栈

相关信息 :MME与Gn/Gp SGSN对接，只需要配置要连接的Gn/Gp SGSN地址解析即可。Gn/Gp SGSN的地址解析过程包括以下两种情况：
用户从Gn/Gp SGSN重选到MME进行TAU或附着时，MME根据RAI可查询到old Gn/Gp SGSN。  
用户从MME切换到Gn/Gp SGSN时，MME根据相邻SGSN管理的RNCID可查询到相邻的Gn/Gp SGSN。 
步骤 :执行命令[ADD EPCHOST]，新增Gn/Gp SGSN地址解析配置。
[ADD EPCHOST]命令的关键参数说明参见[表1]。
参数标识|参数名称|参数设置说明
---|---|---
NAME|逻辑名称|用户从Gn/Gp SGSN重选到MME进行TAU或附着的情况下，逻辑名称根据RAI构成。例如RAI的MCC=WWW、MNC=ZZZ、RAC=XXXX，LAC=YYYY，则此处的逻辑名称为racXXXX.lacYYYY.rac.epc.mncZZZ.mccWWW.3gppnetwork.org。XXXX、YYYY分别为4位十六进制数值表示的RAC、LAC，不足4位的，靠前补零。ZZZ、WWW分别为3位十进制数值表示的MNC、MCC，不足3位的，靠前补零。用户从MME切换到Gn/Gp SGSN的情况下，逻辑名称根据相邻切换Gn/Gp SGSN管理的RNCID构成。例如RNCID的MCC=WWW、MNC=ZZZ、RNC=XXXX，则此处的逻辑名称为rncXXXX.rnc.epc.mncZZZ.mccWWW.3gppnetwork.org。XXXX为4位十六进制数值表示的RNC，不足4位的，靠前补零。ZZZ、WWW分别为3位十进制数值表示的MNC、MCC，不足3位的，靠前补零。
SERVICE|支持服务类别|解析Gn/Gp SGSN地址时选择x-3gpp-sgsn。
PROTOCOL|支持协议类型|解析Gn/Gp SGSN地址时选择x-gn和x-gp。
IPADDR|IP地址|对端Gn/Gp SGSN的IP地址。
HOST|主机名|对端MME的主机名称。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
EPC地址解析配置（Gn/Gp SGSN重选到MME）|逻辑名称|rac0029.lac0001.rac.epc.mnc000.mcc460.3gppnetwork. org
支持服务类别|EPC地址解析配置（Gn/Gp SGSN重选到MME）|x-3gpp-sgsn
主机名|EPC地址解析配置（Gn/Gp SGSN重选到MME）|sgsn29.epc.mnc000.mcc460.3gppnetwork. org
IP地址|EPC地址解析配置（Gn/Gp SGSN重选到MME）|31.129.1.159
持协议类型|EPC地址解析配置（Gn/Gp SGSN重选到MME）|"x-gn"&"x-gp"
EPC地址解析配置（MME切换到Gn/Gp SGSN）|逻辑名称|rnc0009.rnc.epc.mnc000.mcc460.3gppnetwork.org
支持服务类别|EPC地址解析配置（MME切换到Gn/Gp SGSN）|"x-3gpp-sgsn
主机名|EPC地址解析配置（MME切换到Gn/Gp SGSN）|sgsn29.epc.mnc000.mcc460.3gppnetwork.org
IP地址|EPC地址解析配置（MME切换到Gn/Gp SGSN）|131.129.1.159
持协议类型|EPC地址解析配置（MME切换到Gn/Gp SGSN）|"x-gn"&"x-gp"
根据规划，进行如下配置。 
增加对Gn/Gp SGSN的地址解析，用于Gn/Gp SGSN重选到MME，命令如下。 
[ADD EPCHOST]:NAME="rac0029.lac0001.rac.epc.mnc000.mcc460.3gppnetwork. org",SERVICE="x-3gpp-sgsn",HOST="sgsn29.epc.mnc000.mcc460.3gppnetwork. org",IPADDR="131.129.1.159",PROTOCOL="x-gn"&"x-gp"
增加对Gn/Gp SGSN的地址解析，用于MME切换到Gn/Gp SGSN，命令如下。 
[ADD EPCHOST]:NAME="rnc0009.rnc.epc.mnc000.mcc460.3gppnetwork.org", SERVICE="x-3gpp-sgsn",HOST="sgsn29.epc.mnc000.mcc460.3gppnetwork.org", IPADDR="131.129.1.159",PROTOCOL="x-gn"&"x-gp"
##### 配置MME与DNS对接数据 
摘要 :DNS服务器是网络中专门提供域名解析服务的服务器。MME通过DNS服务器进行域名解析，根据域名获取对应的IP地址。
在附着、TAU、切换、PDN连接等业务流程中，MME需要获取与之进行交互的SGW、PGW、SGSN、其他MME的地址。如果这些网元的地址没有在MME上进行配置，那么MME需要查询DNS服务器以获取这些网元的地址，此时MME需要内置DNS客户端功能，以实现与DNS服务器的对接。
MME与DNS对接组网及协议栈如[图1]所示。
图1  MME与DNS对接组网及协议栈

相关信息 :MME与DNS对接配置流程参见[表1]。步骤|操作|操作说明
---|---|---
1|（可选）配置DNS全局参数|运营商可根据实际的网络情况配置MME作为DNS客户端的全局参数，用于调整MME和DNS服务器之间的交互质量，也可以采用系统默认值。
2|新增DNS服务器|配置MME相连的DNS服务器，配置信息包括DNS客户端地址、DNS服务器端地址、VRFID、DNS服务器编号和名称。MME可以跟多个DNS服务器相连接。
3|新增DNS服务器组|一个DNS服务器组包含一个或多个DNS服务器，多个DNS服务器之间的工作模式可以是负荷分担或主备。
4|新增DNS Profile|MME向DNS服务器发起DNS查询时，根据DNS Profile来选择DNS服务器的入口。DNS Profile包括两种类型：LTE Profile：用于MME进行EPC查询时选择DNS服务器。GPRS Profile：用于MME进行GPRS查询时选择DNS服务器。一个DNS profile包含一个或多个DNS服务器组，最多可包含4个DNS服务器组，多个DNS服务器组之间的工作模式可以是负荷分担或主备。多个DNS服务器组之间的工作模式是负荷分担时：MME需要根据各服务器组的权重进行选择。多个DNS服务器组之间的工作模式是主备时：权重值无效，排列在第一个的服务器组是第一优先级的服务器组，依照排列顺序，优先级逐渐降低，优先级高的服务器组中有服务器可达时，则一定选择优先级高的服务器组。
5|（可选）配置DNS服务器UDP链路状态检测机制|可根据实际需求配置DNS服务器UDP链路状态检测机制，包括故障检测和故障恢复检测机制，也可以采用系统默认值。故障检测：是指对当前可用的DNS服务器UDP链路进行定时检测，以便尽快了解其是否故障。故障恢复检测：是指对当前不可用的DNS服务器UDP链路进行定时检测，以确定其是否恢复可用。
步骤 :（可选）执行命令[SET DNS GLB]，设置DNS全局参数。
 说明： 
DNS查询方式
是指MME在查询DNS服务器时使用的方式，分为如下三种方式：
UDP方式：使用UDP报文查询，查询响应的最大长度为512字节。 
TCP方式：使用TCP协议查询，查询响应的理论长度最大为64 K字节。 
UDP优先方式：使用UDP查询，发现查询响应的长度超过512字节（响应中带截断标志）时，临时自动修改为TCP方式再次进行查询。 
DNS查询方式
参数的默认值为“UDP优先方式”，无需修改。
执行命令[ADD DNS SERVER]，新增DNS服务器。
 说明： 
DNS客户端IP地址和DNS服务器IP地址需为同一类型，即DNS客户端IP地址和DNS服务器IP地址都是IPv4地址或都是IPv6地址。
执行命令[ADD DNS SRVGRP]，新增DNS服务器组。
 说明： 
DNS服务器ID需要关联[ADD DNS SERVER]命令中配置的DNS服务器编号。
执行命令[ADD DNS PROFILE]，新增DNS Profile。
 说明： 
DNS服务器组ID需要关联[ADD DNS SRVGRP]命令中配置的DNS服务器组号。
（可选）执行命令[SET DNS SRVCHECK]，配置DNS服务器UDP链路状态检测参数。
 说明： 
此配置只对UDP链路有效，当DNS全局参数配置中的DNS查询方式为TCP方式时，此配置不生效。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
DNS全局参数配置|DNS UDP查询超时时长(秒)|3|3
TTL（分钟）|DNS全局参数配置|180|180
DNS服务器配置|DNS服务器编号|1|2
DNS服务器IP地址|DNS服务器配置|172.16.12.101|172.16.12.102
DNS客户端IP地址|DNS服务器配置|223.103.77.128|223.103.77.128
VRFID|DNS服务器配置|8|8
DNS服务器名称|DNS服务器配置|DNS01|DNS02
DNS服务器组配置|DNS服务器组号|1|1
选择模式|DNS服务器组配置|负荷分担|负荷分担
DNS服务器列表|DNS服务器组配置|1"-"100"&"2"-"100"|1"-"100"&"2"-"100"
DNS服务器组名称|DNS服务器组配置|DNS Group|DNS Group
DNS Profile配置|DNS Profile类型|LTE|GPRS
选择模式|DNS Profile配置|主备|主备
DNS服务器组列表|DNS Profile配置|"1"-"0"|"1"-"0"
根据规划，进行如下配置。 
设置DNS全局参数，命令如下。
[SET DNS GLB]:TIMEOUT=3,TTL=180
新增DNS服务器。
新增DNS服务器1，命令如下。
[ADD DNS SERVER]:ID=1,SERVERIPADDR="172.16.12.101",CLIENTIPADDR="223.103.77.128",VRFID=8,NAME="DNS01"
新增DNS服务器2，命令如下。
[ADD DNS SERVER]:ID=2,SERVERIPADDR="172.16.12.102",CLIENTIPADDR="223.103.77.128",VRFID=8,NAME="DNS02"
新增DNS服务器组，命令如下。
[ADD DNS SRVGRP]:ID=1,SELECTMODE="PARTAKE",SVRLST="1"-"100"&"2"-"100",NAME="DNS Group"
新增DNS Profile，命令如下。
[ADD DNS PROFILE]:TYPE="LTE",SELECTMODE="BACKUP",SVRGRPLST="1"-"0"
[ADD DNS PROFILE]:TYPE="GPRS",SELECTMODE="BACKUP",SVRGRPLST="1"-"0"
##### 配置MME与LCS对接数据 
摘要 :LCS是一种提供移动用户位置信息的业务。提供的位置信息可以被网络内部使用，也可以被第三方使用。
LCS涉及的实体包括LCS服务方、LCS客户方、以及被定位的目标用户。 
MME通过SLg协议和SLs协议来实现LCS功能。 
MME通过SLg协议接口和GMLC交互实现LCS功能。MME与GMLC对接组网及协议栈如图1所示。图1  MME与GMLCMME与GMLC对接组网及协议栈 
MME通过SLs协议接口和E-SMLC交互实现LCS功能。MME与E-SMLC对接组网及协议栈如图2所示。图2  MME与E-SMLC对接组网及协议栈 
前提 :已打开MME支持LCS功能的License项。
步骤 :执行[SET SOFTWARE PARAMETER]命令，设置软参65835支持LCS功能。
执行[ADD SCTP]命令，增加E-SMLC SCTP偶联配置
执行[ADD SCTPIDCFG]命令，增加偶联索引配置
执行[ADD ESMLC]命令，增加E-SMLC配置。
执行[ADD ESMLCGRPID]命令，增加E-SMLC组配置。
执行[ADD DIAMGMLCROUTE]命令，新增Diameter GMLC局向路由配置。
执行[ADD DIAMGMLCADJ]命令，新增Diameter GMLC局向配置。
执行[ADD DIMGMLC ANALYSIS]命令，增加Diameter GMLC分析结果索引配置。
执行[ADD TA]命令，增加跟踪区配置。
执行[SET PACKET DOMAIN PARAMETER]命令，设置支持紧急定位参数。
执行[ADD MDNAL]命令，增加移动号码分析。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
软件参数配置|软件参数ID|65835|65835
软件参数值|软件参数配置|1|1
SCTP偶联配置|SCTP标识|100|101
别名|SCTP偶联配置|E-SMLC_1|E-SMLC_2
本端端口|SCTP偶联配置|49601|49601
对端端口|SCTP偶联配置|49601|49601
VPNID1|SCTP偶联配置|12|12
本端IP地址1|SCTP偶联配置|10.124.17.83|10.124.17.84
对端IP地址1|SCTP偶联配置|192.10.51.1|192.10.51.2
本端IP地址2|SCTP偶联配置|10.124.17.84|10.124.17.83
对端IP地址2|SCTP偶联配置|192.10.51.2|192.10.51.1
应用属性|SCTP偶联配置|客户端|客户端
偶联归属组号|SCTP偶联配置|201|110
应用协议类型|SCTP偶联配置|LCSAP|LCSAP
偶联索引配置|偶联ID|100|101
偶联协议类型|偶联索引配置|LCSAP|LCSAP
E-SMLC配置|E-SMLC标识|1|1
SCTP标识|E-SMLC配置|"100&101"|"100&101"
用户别名|E-SMLC配置|ESMLC|ESMLC
E-SMLC组标识配置|E-SMLC组标识|1|1
E-SMLC标识|E-SMLC组标识配置|1|1
Diameter GMLC局向路由配置|局向路由标识|332|332
Diameter路由组标识|Diameter GMLC局向路由配置|"1&2"|"1&2"
路由属性|Diameter GMLC局向路由配置|负荷分担|负荷分担
是否默认局向路由|Diameter GMLC局向路由配置|是|是
域名|Diameter GMLC局向路由配置|zte.com.cn|zte.com.cn
主机名|Diameter GMLC局向路由配置|DIM332.zte.com.cn|DIM332.zte.com.cn
用户别名|Diameter GMLC局向路由配置|GMLC|GMLC
Diameter GMLC局向配置|局向标识|332|332
Diameter GMLC局向路由标识|Diameter GMLC局向配置|332|332
AVP Profile标识|Diameter GMLC局向配置|2|2
用户别名|Diameter GMLC局向配置|GMLC|GMLC
Diameter GMLC分析结果索引|号码分析结果索引|256|256
Diameter GMLC局向标识|Diameter GMLC分析结果索引|332|332
用户别名|Diameter GMLC分析结果索引|GMLC|GMLC
跟踪区配置|跟踪区标识|168|168
组号|跟踪区配置|1|1
移动国家码|跟踪区配置|460|460
移动网号|跟踪区配置|00|00
跟踪区域码(HEX)|跟踪区配置|AAAA|AAAA
是否使用全局时区|跟踪区配置|是|是
紧急号码列表ID|跟踪区配置|0|0
紧急GMLC号码|跟踪区配置|8613900131|8613900131
跟踪区名称|跟踪区配置|GMLC|GMLC
分组域参数配置|MME/SGSN支持Override参数|是|是
MME支持紧急定位参数|分组域参数配置|是|是
移动号码分析配置|被分析号码|86139000031|86139000031
分析器入口|移动号码分析配置|GMLC邻接局分析|GMLC邻接局分析
号码分析结果索引|移动号码分析配置|256|256
用户别名|移动号码分析配置|GMLC|GMLC
根据规划，进行如下配置。 
设置软参65835支持LCS功能，命令如下。 
[SET SOFTWARE PARAMETER]:PARAID=65835,PARAVALUE=1
新增至E-SMLC SCTP偶联配置，命令如下。 
[ADD SCTP]:ID=100,NAME="E-SMLC_1",LOCPORT=49601,REMPORT=49601,VPNID1=12,LOCADDR1="10.124.17.83",REMADDR1="192.10.51.1",LOCADDR2="10.124.17.84",REMADDR2="192.10.51.2",ROLE="CLT",OFCID=201,PROTOCALTYPE="LCSAP"
[ADD SCTP]:ID=101,NAME="E-SMLC_2",LOCPORT=49601,REMPORT=49601,VPNID1=12,LOCADDR1="10.124.17.84",REMADDR1="192.10.51.2",LOCADDR2="10.124.17.83",REMADDR2="192.10.51.1",ROLE="CLT",OFCID=201,PROTOCALTYPE="LCSAP"
新增偶联索引配置，命令如下。 
[ADD SCTPIDCFG]:SCTPID=100,TYPE="LCSAP"
[ADD SCTPIDCFG]:SCTPID=101,TYPE="LCSAP"
新增ESMLC配置，命令如下。 
[ADD ESMLC]:ESMLCID=1,SCTPID="100&101",NAME="ESMLC"
新增E-SMLC组配置，命令如下。 
[ADD ESMLCGRPID]:ESMLCGRPID=1,ESMLCID="1"
新增Diameter GMLC局向路由配置，命令如下。 
[ADD DIAMGMLCROUTE]:GMLCROUTEID=332,ROUTEGROUP="1&2",PROPERTY="PARTAKE",DFTROUTE="YES",REALM="zte.com.cn",HOSTNAME="DIM332.zte.com.cn",NAME="GMLC"
新增Diameter GMLC局向配置，命令如下。 
[ADD DIAMGMLCADJ]:GMLCADJID=332,GMLCROUTEID="332",AVPPROFILEID=2,NAME="GMLC"
新增Diameter GMLC分析结果索引配置，命令如下。 
[ADD DIMGMLC ANALYSIS]:IDX=256,DIAMGMLCID=332,NAME="GMLC"
新增跟踪区配置，命令如下。 
[ADD TA]:TAID=168,GRPID=1,MCC="460",MNC="00",TAC="AAAA",GLOBALTZ="YES",LISTID=0,GMLCNUM="8613900131",NAME="GMLC"
新增分组域参数设置，命令如下。 
[SET PACKET DOMAIN PARAMETER]:OVERLOADINLCS="YES",MMESUPLCS="YES"
新增移动号码分析配置，命令如下。 
[ADD MDNAL]:DGT="86139000031",ENTR="DAS_GMLC",RST=256,NAME="GMLC"
#### 配置SGSN与其他网元的对接数据 
##### 配置与GGSN/PGW对接数据 
摘要 :SGSN与GGSN/PGW的对接配置可以采用两种方式。
 说明： 
本节中的PGW特指内嵌GGSN的PGW。
根据DNS服务器来解析GGSN/PGW地址，从而达到对接目的，具体方法参见“配置与DNS对接数据”。 
设置APN与GGSN/PGW的GTP-C地址关联，SGSN可以根据APN本地域名解析得到GGSN/PGW的IP地址，并通过路由连接到GGSN/PGW，从而达到对接目的。本节介绍此种方式来进行SGSN与GGSN/PGW的对接。 
SGSN与GGSN/PGW之间采用Gn/Gp接口。 
Gn接口是同一个PLMN内GSN节点间的接口。 
Gp接口是不同的PLMN内GSN间的接口。 
SGSN与GGSN/PGW之间采用GTP协议。GTP协议分为控制面协议（GTP-C）和用户面协议（GTP-U）。控制面协议栈如[图1]所示，用户面协议栈如[图2]所示。
图1  控制面协议栈

图2  用户面协议栈

相关信息 :需要在SGSN上配置相应APN数据，以保证SGSN能够根据用户提供的APN信息，寻址到对应的GGSN/PGW。 
SGSN与GGSN/PGW对接数据配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|（可选）配置APN计费模板|一个计费模板表示一个计费策略，具有相同计费策略的APN可共用一个计费模板。
2|配置APN和GGSN/PGW的GTP-C关联地址|设置以下信息：根据GPRS APN设置需要解析的对应的GGSN IP地址；根据EPC APN设置需要解析的对应的PGW IP地址。设置GPRS APN对应的计费模板信息。设置该APN解析到的GGSN/PGW是否支持隧道直传。设置该APN是否支持终端双栈。
步骤 :（可选）执行命令[ADD APNCTPL]，新增APN计费模板。
根据不同情况，选择执行如下操作。 
如果…|那么…
---|---
APN为GPRS APN|执行命令ADD GPRS APN，配置GPRS APN和GGSN的GTP-C关联地址。
APN为EPC APN|执行命令ADD EPC APN，配置EPC APN和PGW的GTP-C关联地址。
 说明： 
计费模板标识参数即为步骤1中新增的计费模板标识。
IP地址参数设置为GGSN/PGW的GTP-C地址。
举例 :SGSN与GGSN对接在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。表2  SGSN和GGSN对接数据规划示例配置项参数名称取值举例APN计费模板配置计费模板标识1计费方式时间计费时间门限(分钟)20计费流量门限(字节)4096000000部分话单最大碎片数5无线承载释放时间(分钟)120无活动PDP存在时长(分钟)360用户别名cmnetGPRS APN HOST配置APN名称cmnet.mnc000.mcc460.gprsIP地址"192.168.10.1"&"192.168.10.2"&"192.168.10.3"计费模板标识1支持DT功能支持支持终端双栈功能支持根据规划，进行如下配置。创建计费模板，命令如下。ADD APNCTPL:TPLID=1,TYPE="TIME",TIMELMT=20,FLOWLMT=4096000000,MAXFRAG=5, RABTIMELMT=120,PDPTIMELMT=360,NAME="cmnet"配置GPRS APN和GGSN的GTP-C关联地址，命令如下。ADD GPRS APN:APN="cmnet.mnc000.mcc460.gprs",IPADDR="192.168.10.1"&"192.168.10.2"&"192.168.10.3",CTPLID=1,DTSPRT="YES",DUALSTACKFLAG="YES" 
SGSN与PGW对接在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。表3  SGSN和PGW对接数据规划示例配置项参数名称取值举例EPC APN HOST配置APN名称cmnet.apn.epc.mnc000.mcc460.3gppnetwork. orgPGW主机名pgw95.node.epc.mnc000.mcc460.3gppnetwork.orgIP地址"192.168.10.1"&"192.168.10.2"&"192.168.10.3"支持服务类别"x-3gpp-pgw"&"x-3gpp-ggsn"支持协议类型x-s5-gtp"&"x-s8-gtp"&"x-gn"&"x-gp"支持DT功能支持支持终端双栈功能支持根据规划，进行如下配置。配置EPC APN和PGW的GTP-C关联地址，命令如下。ADD EPC APN:APN="cmnet.apn.epc.mnc000.mcc460.3gppnetwork. org",HOST="pgw95.node.epc.mnc000.mcc460.3gppnetwork.org",IPADDR="192.168.10.1"&"192.168.10.2"&"192.168.10.3",SERVICE="x-3gpp-pgw"&"x-3gpp-ggsn",PROTOCOL="x-s5-gtp"&"x-s8-gtp"&"x-gn"&"x-gp",DTSPRT="YES",DUALSTACKFLAG="YES" 
##### 配置与STP/HLR对接数据 
摘要 :SGSN通过Gr接口与STP/HLR相连，用以交换移动用户的位置信息，以便管理用户。有些局点只直联对接STP，HLR通过STP转接信令。
当用户附着至网络时，SGSN会通过Gr接口从HLR取得用户签约数据。 
当用户发生路由区更新时，SGSN会通过Gr接口更新HLR中相应的位置信息。 
当HLR中的用户数据有变动时，会通过Gr接口通知SGSN进行相关的处理。 
Gr接口采用MAP信令，信令传输采用以太网承载，其协议栈如[图1]所示。
图1  Gr接口协议栈

相关信息 :SGSN与STP/HLR对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|配置STP/HLR邻接局|创建与SGSN对接的邻接局，通过网络类型，关联本局信令点。
2|配置SIGTRAN|配置SGSN与HLR之间IP承载的SIGTRAN数据。
3|配置号码分析数据|配置移动号码分析结果索引及移动号码分析。移动号码分析结果索引配置中设置该索引对应的IMSI变换方式（ISDN或者HLR），并设置变换后的号码。SGSN在用户进行附着和RAU等业务时，根据移动号码分析中的配置匹配号码分析结果索引，根据此索引，在本配置项中获取IMSI变换后的号码，进行GT翻译，获取到用户对应的HLR局向号。
4|配置GT翻译|配置GT翻译选择子和GT翻译数据。GT翻译选择子是对应各种GT翻译的入口，是GT的一部分。GT翻译的作用就是把应用层提供的GT号码形式的路由标签，翻译成目的信令点/信令转接点的GT形式或DPC+SSN形式，并根据实际的网络传输特性，选择用GT形式或DPC+SSN形式发送。
步骤 :执行命令[ADD ADJOFC]，配置STP/HLR邻接局向。
 说明： 
邻接局号参数：设置为STP/HLR邻接局的局号。
信令点编码参数：设置为对端HLR网元的信令点编码。
信令点类型参数：设置为STEP，表示即是信令端接点也是信令转接点。
邻接局类别参数：STP设置为MSCSERVER，HLR设置为HLR/HLRe。
配置SIGTRAN。 
执行命令[ADD SCTP]，配置SCTP偶联。
要求到每个STP/HLR至少配置4条SCTP，如果License项2G在线用户数和3G在线用户数的总是超过100万，每增加50万用户每局向就要相应增加一条SCTP链路。
 说明： 
应用属性参数：设置为SCTP应用属性，分为服务器端和客户端，与STP/HLR对接时，STP/HLR配置为服务端，SGSN设置为客户端。
偶联归属组号：同一个局向的多条偶链设置为一样的，建议为邻接局号。
执行命令[ADD M3UASCTP]，配置SIG偶联。
执行命令[ADD M3UAASP]，配置ASP。
ASP信息定义ASP与SCTP偶联的一一对应关系。 
执行命令[ADD M3UAAS]，配置AS。
AS信息定义AS由哪些ASP组成，可通过一组关键字来选择对应的逻辑实体，例如每个AS标识对应一组ASP标识，可根据标识识别对应的ASP或AS。 
 说明： 
用户类型参数设置为AS支持的用户类型，定义了使用应用服务器的上层用户类型。邻接局为STP/HLR时，此处设置为SCCP。
执行命令[ADD M3UART]，配置M3UA静态路由。
M3UA静态路由信息定义激活状态ASP列表，完成信令的分发。一个M3UA静态路由最多由64个M3UA动态路由引用。超过此限制时，需要配置多个M3UA静态路由。 
执行命令[ADD SIOLOCAS]，配置M3UA动态路由。
SIO是业务指示标识，用于标识M3UA上有哪些协议（如SCCP、BICC等）。 
M3UA动态路由配置用于把一种业务定位到一个路由表，该路由表由AS下的ASP共同维护。其中，选路关键字描述一组No.7信令的参数和参数值，根据消息的属性，选择对应的AS，起到消息选路的作用。 
 说明： 
消息的属性包括DPC+NET+OPC+SIO，其中DPC为目的信令点编码，NET为网络类别，OPC为源信令点编码，SIO为业务信息八位位组。 
配置号码分析数据。 
执行命令[ADD IROAM]，配置移动号码分析索引。
在配置移动号码分析索引中设置IMSI号码分析转换的结果及分析结果指示，并被引用到移动号码分析配置中。
执行命令[ADD MDNAL]，配置移动号码分析。
配置GT翻译。 
执行命令[ADD GTT]，配置GT翻译选择子和最小GT位长。
 说明： 
翻译类型参数在SGSN网元中设置为0。
GT翻译属性参数在SGSN网元中配置为R_L，表示最大匹配为从右到左进行匹配。在分析一个GT号码时，先查找最大长度的可匹配项，由长号码到短号码进行分析，有助于减少GT数据配置量。
执行命令[ADD GT]，配置GT翻译数据。
GT翻译数据定义了交换局中所有的GT号码。GT号码以及号码的选路方式需要规划。本局和HLR邻接局的GT翻译数据都需要配置。 
 说明： 
邻接局GT翻译数据中，局向号为邻接局配置中配置的对应邻接局的局向号。如果本局GT翻译数据中局向号为0时，表示为本局。 
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
邻接局配置|邻接局号|1|2
别名|邻接局配置|STP1|STP2
信令点编码格式|邻接局配置|383/888格式的3段10进制数字符串|383/888格式的3段10进制数字符串
信令点编码|邻接局配置|38.255.1|38.255.2
网络类别|邻接局配置|2|2
信令点类型|邻接局配置|信令转接点|信令转接点
子业务类型|邻接局配置|国内信令点编码|国内信令点编码
信令点编码类型|邻接局配置|24位信令点编码|24位信令点编码
连接关系|邻接局配置|直联方式|直联方式
协议类型|邻接局配置|国际电信标准联盟|国际电信标准联盟
宽带属性|邻接局配置|支持宽带|支持宽带
邻接局的类型|邻接局配置|MSCSERVER|MSCSERVER
SCTP配置|SCTP标识|1001、1002、1003、1004|1011、1012、1013、1014
别名|SCTP配置|STP1-1、STP1-2、STP1-3、STP1-4|STP2-1、STP2-2、STP2-3、STP2-4
本端端口|SCTP配置|3001、3002、3003、3004|3011、3012、3013、3014
对端端口|SCTP配置|3001、3002、3003、3004|3011、3012、3013、3014
VPNID1|SCTP配置|12|12
本端IP地址1|SCTP配置|SCTP标识为1001、1003的取值：10.124.17.81SCTP标识为1002、1004的取值：10.124.17.82|SCTP标识为1011、1013的取值：10.124.17.81SCTP标识为1012、1014的取值：10.124.17.82
对端IP地址1|SCTP配置|SCTP标识为1001、1003的取值：10.10.11.1SCTP标识为1002、1004的取值：10.10.11.2|SCTP标识为1011、1013的取值：10.100.11.1SCTP标识为1012、1014的取值：10.100.11.2
VPNID1|SCTP配置|12|12
本端IP地址2|SCTP配置|SCTP标识为1001、1003的取值：10.124.17.82SCTP标识为1002、1004的取值：10.124.17.81|SCTP标识为1011、1013的取值：10.124.17.82SCTP标识为1012、1014的取值：10.124.17.81
对端IP地址2|SCTP配置|SCTP标识为1001、1003的取值：10.10.11.2SCTP标识为1002、1004的取值：10.10.11.1|SCTP标识为1011、1013的取值：10.100.11.2SCTP标识为1012、1014的取值：10.100.11.1
应用属性|SCTP配置|客户端|客户端
是否启用链路切换功能|SCTP配置|开启|开启
检测报文长度|SCTP配置|八分之一MTU|八分之一MTU
交叉建链属性|SCTP配置|关闭|关闭
单偶联通路断告警属性|SCTP配置|顺从全局配置|顺从全局配置
偶联归属组号|SCTP配置|1|2
应用协议类型|SCTP配置|M3UA|M3UA
SIG偶联配置|SCTP偶联标识|1001、1002、1003、1004|1005、1006、1007、1008
协议类型|SIG偶联配置|M3UA|M3UA
对端邻接局号|SIG偶联配置|1|2
M3UA ASP配置|ASP标识|1001、1002、1003、1004|1005、1006、1007、1008
别名|M3UA ASP配置|STP1-1、STP1-2、STP1-3、STP1-4|STP2-1、STP2-2、STP2-3、STP2-4
SCTP标识|M3UA ASP配置|1001、1002、1003、1004|1005、1006、1007、1008
M3UA AS配置|AS标识|1000|1001
别名|M3UA AS配置|STP1|STP2
ASP标识 1|M3UA AS配置|1001|-
ASP标识 2|M3UA AS配置|1002|-
ASP标识 3|M3UA AS配置|1003|-
ASP标识 4|M3UA AS配置|1004|-
ASP标识 5|M3UA AS配置|-|1005
ASP标识 6|M3UA AS配置|-|1006
ASP标识 7|M3UA AS配置|-|1007
ASP标识 8|M3UA AS配置|-|1008
M3UA静态路由配置|M3UA静态路由标识|1000|1001
别名|M3UA静态路由配置|STP1|STP2
AS标识1|M3UA静态路由配置|1000|1001
M3UA动态路由配置|路由编号|1000|1001
目的邻接局号|M3UA动态路由配置|1|2
业务指示语|M3UA动态路由配置|SCCP|SCCP
一级路由标识|M3UA动态路由配置|1000|1001
移动号码分析结果索引配置|号码分析结果索引|1、2、3、4、5、6|1、2、3、4、5、6
类型|移动号码分析结果索引配置|ISDN|ISDN
转换的结果|移动号码分析结果索引配置|86139、86138、86137、86157、86135、86136|86139、86138、86137、86157、86135、86136
附加特性列表|移动号码分析结果索引配置|NULL|NULL
用户别名|移动号码分析结果索引配置|CMCC86139、CMCC86138、CMCC86137、CMCC86157、CMCC86135、CMCC86136|CMCC86139、CMCC86138、CMCC86137、CMCC86157、CMCC86135、CMCC86136
移动号码分析|被分析号码|46000、46002、46004、46007、46008、46013|46000、46002、46004、46007、46008、46013
分析器入口|移动号码分析|IMSI号码分析|IMSI号码分析
号码分析结果索引|移动号码分析|1、2、3、4、5、6|1、2、3、4、5、6
用户别名|移动号码分析|CMCC46000、CMCC46002、CMCC46004、CMCC46007、CMCC46008、CMCC46013|CMCC46000、CMCC46002、CMCC46004、CMCC46007、CMCC46008、CMCC46013
GT翻译选择子配置|GT类型|4|4
翻译类型|GT翻译选择子配置|0|0
编号计划|GT翻译选择子配置|ISDN/电话编号计划(1)|ISDN/移动编号计划(7)
地址性质表示语|GT翻译选择子配置|国际号码(4)|国际号码(4)
SCCP路由索引|GT翻译选择子配置|0|0
GT翻译选择子配置|GT翻译选择子配置|1|2
GT翻译方向|GT翻译选择子配置|双向|双向
国内最小位长|GT翻译选择子配置|1|1
国内最大位长|GT翻译选择子配置|20|20
国际最小位长|GT翻译选择子配置|1|1
国际最大位长|GT翻译选择子配置|20|20
GT翻译数据配置（用于本局）|被叫GT号码|8613903108|8613903108
翻译选择子|GT翻译数据配置（用于本局）|1|1
选路方式|GT翻译数据配置（用于本局）|GT|GT
第1个轮选局向|GT翻译数据配置（用于本局）|0|0
第1个局向轮选次数|GT翻译数据配置（用于本局）|1|1
GT翻译数据配置（用于国际漫游）|被叫GT号码|1~9|1~9
翻译选择子|GT翻译数据配置（用于国际漫游）|1|2
选路方式|GT翻译数据配置（用于国际漫游）|GT|GT
第1个轮选局向|GT翻译数据配置（用于国际漫游）|0|0
第1个局向轮选次数|GT翻译数据配置（用于国际漫游）|1|1
第2个轮选局向|GT翻译数据配置（用于国际漫游）|2|2
第2个局向轮选次数|GT翻译数据配置（用于国际漫游）|1|1
局向分组|GT翻译数据配置（用于国际漫游）|不支持|不支持
 说明： 
1局和2局为与SGSN的直联局向。 
根据规划，进行如下配置。 
创建邻接局，命令如下。 
[ADD ADJOFC]:OFFICEID=1,NETWORKNAME="STP1",SPCMODE="TRIPLE_DEC",DPC="38.255.1",NET=2,SPTYPE="STP",SSF="NATIONAL",SPCTYPE="24",AM="AM_SURE",PROT="ITU",BANDFLAG="YES",OFFICETYPE="MSCSERVER"
[ADD ADJOFC]:OFFICEID=2,NETWORKNAME="STP2",SPCMODE="TRIPLE_DEC",DPC="38.255.2",NET=2,SPTYPE="STP",SSF="NATIONAL",SPCTYPE="24",AM="AM_SURE",PROT="ITU",BANDFLAG="YES",OFFICETYPE="MSCSERVER"
创建8条SCTP，命令如下。 
[ADD SCTP]:ID=1001,NAME="STP1-1",LOCPORT=3001,REMPORT=3001,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="10.10.11.1",VPNID2=12,LOCADDR2="10.124.17.82",REMADDR2="10.10.11.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=1,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1002,NAME="STP1-2",LOCPORT=3002,REMPORT=3002,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="10.10.11.2",VPNID2=12,LOCADDR2="10.124.17.81",REMADDR2="10.10.11.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=1,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1003,NAME="STP1-3",LOCPORT=3003,REMPORT=3003,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="10.10.11.1",VPNID2=12,LOCADDR2="10.124.17.82",REMADDR2="10.10.11.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=1,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1004,NAME="STP1-4",LOCPORT=3004,REMPORT=3004,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="10.10.11.2",VPNID2=12,LOCADDR2="10.124.17.81",REMADDR2="10.10.11.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=1,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1011,NAME="STP2-1",LOCPORT=3011,REMPORT=3011,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="10.100.11.1",VPNID2=12,LOCADDR2="10.124.17.82",REMADDR2="10.100.11.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=2,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1012,NAME="STP2-2",LOCPORT=3012,REMPORT=3012,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="10.100.11.2",VPNID2=12,LOCADDR2="10.124.17.81",REMADDR2="10.100.11.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=2,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1013,NAME="STP2-3",LOCPORT=3013,REMPORT=3013,VPNID1=12,LOCADDR1="10.124.17.81",REMADDR1="10.100.11.1",VPNID2=12,LOCADDR2="10.124.17.82",REMADDR2="10.100.11.2",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=2,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=1014,NAME="STP2-4",LOCPORT=3014,REMPORT=3014,VPNID1=12,LOCADDR1="10.124.17.82",REMADDR1="10.100.11.2",VPNID2=12,LOCADDR2="10.124.17.81",REMADDR2="10.100.11.1",ROLE="CLT",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=2,PROTOCALTYPE="M3UA"
配置SIG偶联，命令如下。 
[ADD M3UASCTP]:ASSOCID=1001,SCTPPROTYPE="M3UA",OFFICEID=1
[ADD M3UASCTP]:ASSOCID=1002,SCTPPROTYPE="M3UA",OFFICEID=1
[ADD M3UASCTP]:ASSOCID=1003,SCTPPROTYPE="M3UA",OFFICEID=1
[ADD M3UASCTP]:ASSOCID=1004,SCTPPROTYPE="M3UA",OFFICEID=1
[ADD M3UASCTP]:ASSOCID=1005,SCTPPROTYPE="M3UA",OFFICEID=2
[ADD M3UASCTP]:ASSOCID=1006,SCTPPROTYPE="M3UA",OFFICEID=2
[ADD M3UASCTP]:ASSOCID=1007,SCTPPROTYPE="M3UA",OFFICEID=2
[ADD M3UASCTP]:ASSOCID=1008,SCTPPROTYPE="M3UA",OFFICEID=2
配置M3UA ASP，命令如下。 
[ADD M3UAASP]:ASPID=1001,NAME="STP1-1",ASSOCID=1001
[ADD M3UAASP]:ASPID=1002,NAME="STP1-2",ASSOCID=1002
[ADD M3UAASP]:ASPID=1003,NAME="STP1-3",ASSOCID=1003
[ADD M3UAASP]:ASPID=1004,NAME="STP1-4",ASSOCID=1004
[ADD M3UAASP]:ASPID=1005,NAME="STP2-1",ASSOCID=1005
[ADD M3UAASP]:ASPID=1006,NAME="STP2-2",ASSOCID=1006
[ADD M3UAASP]:ASPID=1007,NAME="STP2-3",ASSOCID=1007
[ADD M3UAASP]:ASPID=1008,NAME="STP2-4",ASSOCID=1008
配置M3UA AS，命令如下。 
[ADD M3UAAS]:ASID=1000,NAME="STP1",ASPID1=1001,ASPID2=1002,ASPID3=1003,ASPID4=1004
[ADD M3UAAS]:ASID=1001,NAME="STP2",ASPID5=1005,ASPID6=1006,ASPID7=1007,ASPID8=1008
配置M3UA静态路由，命令如下。 
[ADD M3UART]:ROUTEID=1000,ALIAS="STP1",ASID1=1000
[ADD M3UART]:ROUTEID=1001,ALIAS="STP2",ASID1=1001
配置M3UA动态路由，命令如下。 
[ADD SIOLOCAS]:DROUTEID=1000,ALIAS="STP1",DSTOFFICEID=1,SIO="SCCP", ROUTEID1=1000
[ADD SIOLOCAS]:DROUTEID=1001,ALIAS="STP2",DSTOFFICEID=2,SIO="SCCP", ROUTEID1=1001
创建移动号码分析结果索引，命令如下。 
[ADD IROAM]:IDX=1,TP="ISDN",RST="86139",EXFL="NULL",NAME="CMCC86139"
[ADD IROAM]:IDX=2,TP="ISDN",RST="86138",EXFL="NULL",NAME="CMCC86138"
[ADD IROAM]:IDX=3,TP="ISDN",RST="86137",EXFL="NULL",NAME="CMCC86137"
[ADD IROAM]:IDX=4,TP="ISDN",RST="86157",EXFL="NULL",NAME="CMCC86157"
[ADD IROAM]:IDX=5,TP="ISDN",RST="86135",EXFL="NULL",NAME="CMCC86135"
[ADD IROAM]:IDX=6,TP="ISDN",RST="86136",EXFL="NULL",NAME="CMCC86136"
配置移动号码分析，命令如下。 
[ADD MDNAL]:DGT="46000",ENTR="DAS_IMSI_ROAM",RST=1,NAME="CMCC46000"
[ADD MDNAL]:DGT="46002",ENTR="DAS_IMSI_ROAM",RST=2,NAME="CMCC46002"
[ADD MDNAL]:DGT="46004",ENTR="DAS_IMSI_ROAM",RST=3,NAME="CMCC46004"
[ADD MDNAL]:DGT="46007",ENTR="DAS_IMSI_ROAM",RST=4,NAME="CMCC46007"
[ADD MDNAL]:DGT="46008",ENTR="DAS_IMSI_ROAM",RST=5,NAME="CMCC46008"
[ADD MDNAL]:DGT="46013",ENTR="DAS_IMSI_ROAM",RST=6,NAME="CMCC46013"
配置GT翻译选择子，命令如下。 
[ADD GTT]:GTTYPE=4,TRANSTYPE=0,PLAN="E164",NATURE="INT",IMSI=0,TRANSLATOR=1,NGTMIN=1,NGTMAX=20,IGTMIN=1,IGTMAX=20,DIRECTION="BIDIRECTIONAL"
[ADD GTT]:GTTYPE=4,TRANSTYPE=0,PLAN="E214",NATURE="INT",IMSI=0,TRANSLATOR=2,NGTMIN=1,NGTMAX=20,IGTMIN=1,IGTMAX=20,DIRECTION="BIDIRECTIONAL"
配置GT翻译数据。 
配置本局GT翻译数据，命令如下。ADD GT:GT="8613903108",TRANS=1,ROUTEMODE="GT",OFFICEID1=0,SELECTEDNUM1=1 
配置国际漫游最大匹配GT翻译数据，命令如下。ADD GT:GT="1",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="2",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="3",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="4",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="5",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="6",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="7",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="8",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="9",TRANS=1,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="1",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="2",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="3",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="4",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="5",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="6",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="7",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="8",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO"ADD GT:GT="9",TRANS=2,ROUTEMODE="GT",OFFICEID1=1,SELECTEDNUM1=1,OFFICEID2=2,SELECTEDNUM2=1,INFO_OFF_GRP="NO" 
##### 配置与RNC对接数据 
摘要 :SGSN通过Iu-PS接口与RNC相连，实现以下功能。
RAB的建立、维护和释放管理。 
完成系统间、系统内部的切换和SRNS的重定位。 
支持小区广播业务。 
和用户无关的一般的管理过程。 
用户信令管理。 
在用户和核心网之间传送NAS信令消息。 
支持位置业务。 
支持用户同时接入核心网中不同的域。 
安全功能。 
Iu-PS接口可以分为用户面和控制面，其协议栈如[图1]所示。
用户面实现用户数据报的承载。 
控制面实现信令的交换及承载。 
图1  Iu-PS接口协议栈

相关信息 :SGSN与RNC进行对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|配置RNC邻接局|创建与SGSN对接的邻接局，通过网络类型，关联本局信令点。
2|配置邻接局索引|配置邻接局类型为RNC类型。
3|配置SIGTRAN|配置SGSN与RNC为IP承载时需要配置SIGTRAN数据。
4|配置接入区域|配置RNC管辖的位置区、路由区。只有本局支持的所有LAI和RAI都配置之后，BSC和RNC才能正常接入SGSN局，覆盖区内的用户才能正常注册。
5|配置RNC局向附加信息|配置RNC局向附加属性及寻呼区域。配置RNC局向附加属性，用于实现该RNC局向的对应功能实现，配置相应某一属性为支持则表明该RNC局向支持该项功能。寻呼区域决定了对该RNC无线信号覆盖下的用户进行寻呼时，在哪些位置区或路由区范围内进行寻呼。
步骤 :执行命令[ADD ADJOFC]，创建邻接局。
 说明： 
邻接局号参数设置为RNC邻接局的局号。
信令点编码参数设置为对端RNC网元的信令点编码。
信令点类型参数设置为SEP，表示为信令端接点。
邻接局类别参数设置为RNC
执行命令[ADD ADJOFCIDCFG]，配置邻接局索引，设置该邻接局为RNC局。
配置SIGTRAN，配置步骤参见“[配置与STP/HLR对接数据]”
中的步骤2。
要求到每个RNC至少配置4条SCTP。 
配置接入区域。 
执行命令[ADD LAI]，配置位置区。
执行命令[ADD RAI]，配置路由区。
配置RNC局向附加信息。 
执行命令[ADD RNC]，新增RNC局向附加属性。
执行命令[ADD RNC PAGING AREA]，新增RNC局向寻呼区域。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
邻接局配置|邻接局号|101
别名|邻接局配置|RNC-101
信令点编码格式|邻接局配置|83/888格式的3段10进制数字符串
信令点编码|邻接局配置|1.1.1
网络类别|邻接局配置|1
信令点类型|邻接局配置|信令端接点
子业务类型|邻接局配置|国内信令点编码
信令点编码类型|邻接局配置|14位信令点编码
连接关系|邻接局配置|直联方式
协议类型|邻接局配置|中国
宽带属性|邻接局配置|支持宽带
邻接局的类型|邻接局配置|RNC
邻接局索引配置|邻接局号|101
邻接局类别|邻接局索引配置|RNC局
SCTP偶联配置|SCTP标识|501、502、503、504
别名|SCTP偶联配置|RNC101-1、RNC101-2、RNC101-3、RNC101-4
本端端口|SCTP偶联配置|3011、3012、3013、3014
对端端口|SCTP偶联配置|3011、3012、3013、3014
VPNID1|SCTP偶联配置|12
本端IP地址1|SCTP偶联配置|SCTP标识为501、503的取值：10.124.17.88SCTP标识为502、504的取值：10.124.17.89
对端IP地址1|SCTP偶联配置|SCTP标识为501、503的取值：10.10.21.1SCTP标识为502、504的取值：10.10.21.2
VPNID1|SCTP偶联配置|12
本端IP地址2|SCTP偶联配置|SCTP标识为501、503的取值：10.124.17.89SCTP标识为502、504的取值：10.124.17.88
对端IP地址2|SCTP偶联配置|SCTP标识为501、503的取值：10.10.21.2SCTP标识为502、504的取值：110.10.21.1
应用属性|SCTP偶联配置|服务端
是否启用链路切换功能|SCTP偶联配置|开启
检测报文长度|SCTP偶联配置|八分之一MTU
交叉建链属性|SCTP偶联配置|关闭
单偶联通路断告警属性|SCTP偶联配置|顺从全局配置
偶联归属组号|SCTP偶联配置|101
应用协议类型|SCTP偶联配置|M3UA
SIG偶联配置|SCTP标识|501、502、503、504
协议类型|SIG偶联配置|M3UA
对端邻接局号|SIG偶联配置|101
ASP配置|ASP标识|501、502、503、504
别名|ASP配置|RNC101-1、RNC101-2、RNC101-3、RNC101-4
SCTP标识|ASP配置|501、502、503、504
AS配置|AS标识|101
别名|AS配置|RNC101
业务模式|AS配置|负荷分担
ASP标识 1|AS配置|501
ASP标识 2|AS配置|502
ASP标识 3|AS配置|503
ASP标识 4|AS配置|504
M3UA静态路由配置|M3UA静态路由标识|101
别名|M3UA静态路由配置|RNC101
AS标识1|M3UA静态路由配置|101
M3UA动态路由配置|路由编号|101
目的邻接局号|M3UA动态路由配置|101
业务指示语|M3UA动态路由配置|SCCP
一级路由标识|M3UA动态路由配置|101
别名|M3UA动态路由配置|RNC101
位置区配置|位置区名|RNC101_0CCC
移动国家码|位置区配置|460
移动网号|位置区配置|00
位置区域码|位置区配置|0CCC
路由区配置|路由区名称|RAI1
位置区名|路由区配置|RNC101_0CCC
路由区码(HEX)|路由区配置|01
是否使用全局时区|路由区配置|是
RNC局向附加属性|RNC局向号|101
移动国家码|RNC局向附加属性|460
移动网号|RNC局向附加属性|00
RNC标识|RNC局向附加属性|101
RNC局向寻呼区域|RNC局向号|101
路由区名|RNC局向寻呼区域|RAI1
配置邻接局，命令如下： 
[ADD ADJOFC]:OFFICEID=101,NETWORKNAME="RNC-101",SPCMODE="TRIPLE_DEC",DPC="1.1.1",NET=1,SPTYPE="SEP",SSF="NATIONAL",SPCTYPE="14",AM="AM_SURE",PROT="CHINA",BANDFLAG="YES",OFFICETYPE="RNC"
配置邻接局索引，设置该邻接局为RNC局，命令如下： 
[ADD ADJOFCIDCFG]:OFCID=101,OFCTYPE="RNC"
配置SIGTRAN。 
配置4条SCTP，命令如下： 
[ADD SCTP]:ID=501,NAME="RNC101-1",LOCPORT=3011,REMPORT=3011,VPNID1=12,LOCADDR1="10.124.17.88",REMADDR1="10.10.21.1",VPNID2=12,LOCADDR2="10.124.17.89",REMADDR2="10.10.21.2",ROLE="SVR",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=101,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=502,NAME="RNC101-2",LOCPORT=3012,REMPORT=3012,VPNID1=12,LOCADDR1="10.124.17.89",REMADDR1="10.10.21.2",VPNID2=12,LOCADDR2="10.124.17.88",REMADDR2="10.10.21.1",ROLE="SVR",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=101,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=503,NAME="RNC101-3",LOCPORT=3013,REMPORT=3013,VPNID1=12,LOCADDR1="10.124.17.88",REMADDR1="10.10.21.1",VPNID2=12,LOCADDR2="10.124.17.89",REMADDR2="10.10.21.2",ROLE="SVR",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=101,PROTOCALTYPE="M3UA"
[ADD SCTP]:ID=504,NAME="RNC101-4",LOCPORT=3014,REMPORT=3014,VPNID1=12,LOCADDR1="10.124.17.89",REMADDR1="10.10.21.2",VPNID2=12,LOCADDR2="10.124.17.88",REMADDR2="10.10.21.1",ROLE="SVR",FIXNH="OPEN",DPLEN="1_8MTU",CROSSLINK="CLOSE",SCTPALARM="CONFORM",OFCID=101,PROTOCALTYPE="M3UA"
配置SIG偶联，命令如下： 
[ADD M3UASCTP]:ASSOCID=501,SCTPPROTYPE="M3UA",OFFICEID=101
[ADD M3UASCTP]:ASSOCID=502,SCTPPROTYPE="M3UA",OFFICEID=101
[ADD M3UASCTP]:ASSOCID=503,SCTPPROTYPE="M3UA",OFFICEID=101
[ADD M3UASCTP]:ASSOCID=504,SCTPPROTYPE="M3UA",OFFICEID=101
配置ASP，命令如下： 
[ADD M3UAASP]:ASPID=501,NAME="RNC101-1",ASSOCID=501
[ADD M3UAASP]:ASPID=502,NAME="RNC101-2",ASSOCID=502
[ADD M3UAASP]:ASPID=503,NAME="RNC101-3",ASSOCID=503
[ADD M3UAASP]:ASPID=504,NAME="RNC101-4",ASSOCID=504
配置AS，命令如下： 
[ADD M3UAAS]:ASID=101,NAME="RNC101",MODE="LOAD",ASPID1=501,ASPID2=502,ASPID3=503,ASPID4=504
配置M3UA静态路由，命令如下： 
[ADD M3UART]:ROUTEID=101,ALIAS="RNC101",ASID1=101
配置M3UA动态路由，命令如下： 
[ADD SIOLOCAS]:DROUTEID=101,ALIAS="RNC101",DSTOFFICEID=101,SIO="SCCP",ROUTEID1=101
配置接入区域。 
配置位置区，命令如下： 
[ADD LAI]:NAME="RNC101_0CCC",MCC="460",MNC="00",LAC="0CCC"
配置路由区，命令如下： 
[ADD RAI]:NAME="RAI1",LAI="RNC101_0CCC",RAC="01",GLOBALTZ="YES"
配置RNC局向附加属性。 
新增RNC局向附加属性，命令如下： 
[ADD RNC]:RNCOFFID=101,MCC="460",MNC="00",RNC=101
新增RNC局向寻呼区域，命令如下： 
[ADD RNC PAGING AREA]:RNCOFFID=101,RAI="RAI1"
##### 配置与BSC对接数据 
摘要 :SGSN通过Gb接口与BSC相连。Gb接口用来传送SGSN和BSC之间的信令和用户数据。SGSN通过Gb口可以完成分组数据传送、移动性管理、会话管理方面的功能。
Gb接口的协议层如[图1]所示。
图1  Gb接口的协议栈

SGSN和BSC对接可采用静态NSVC方式或者动态NSVC方式。
本节介绍采用静态NSVC方式或者动态NSVC方式进行SGSN与BSC对接的配置过程。 
相关信息 :SGSN与BSC采用静态NSVC方式进行对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|配置NSE|配置NSE的主要目的是用来管理BVCI、NSVC以及用来进行负荷分担。NSE分别位于BSC侧和SGSN侧，当BSC和SGSN对接时，在BSC侧新增一个NSE，在SGSN侧也需要增加相应的NSE。
2|配置本端IP端点|要使SGSN能够与基于IP承载的BSC建立连接通路，SGSN必须提供本端IP端点。BSC可以根据该IP端点建立网络业务虚连接。
3|配置远端IP端点|要使SGSN能够与基于IP承载的BSC建立静态的IP连接通路，需要向SGSN提供远端IP端点，即BSC上的本端IP端点。SGSN可以根据该IP端点主动建立网络业务虚连接。
4|配置IP NSVC|要在BSC网元与SGSN网元之间完成通讯，必须建立相应的通讯链路，即网络业务虚连接（NSVC）。配置基于IP承载的NSVC，将配置的本地IP端点和远端IP端点以及NSEI关联起来。
5|配置接入区域|配置BSC管辖的位置区、路由区。位置区是指UE在不更新VLR的情况下可以自由移动的区域。路由区是位置区的子集，即一个位置区可以作为一个路由区，也可进一步划分为几个路由区。
6|配置NSE保护路由区|设置NSE和路由区关联记录，即将路由区和NSE绑定，让路由区在数据库中被引用到，避免该路由区在其他配置中被异常删除。
 说明： 
SGSN与BSC采用动态NSVC方式进行对接时，只需执行步骤1、2、5、6即可。 
步骤 :执行命令[ADD NSE]，配置NSE。
 说明： 
NSE标识号参数起到代表物理承载的链路资源的作用，具体取值要跟BSC侧约定，使用时跟NSVC标识（代表具体的物理连接资源）关联来实现，可以是一对多的关系。
执行命令[ADD LOCAL ENDPOINT]，新增本端IP端点。
 说明： 
IP地址参数设置为NSVC本端的IP地址。
执行命令[ADD REMOTE ENDPOINT]，新增远端IP端点。
 说明： 
NSE标识号参数需要与[ADD NSE]命令中的NSE标识号一致。
IP地址参数设置为NSVC对端的IP地址。
执行命令[ADD IP NSVC]，配置IP NSVC。
NSVC是NS层提供的虚拟链路，在SGSN中是唯一的。可以将多个NSVC组成一组，一组NSVC都由NSEI标识，同一组中的NSVC实现负荷分担。 
 说明： 
NSE标识号参数需要与[ADD NSE]命令中的NSE标识号一致。
配置接入区域。 
执行命令[ADD LAI]，配置位置区。
执行命令[ADD RAI]，配置路由区。
执行命令[SET NSE RAI]，配置NSE关联路由区。
 说明： 
路由区名参数需要与[ADD
RAI]命令中的路由区名一致。
举例 :静态BSC配置
在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
网络业务实体配置|NSE标识号|1|1
支持Flex功能|网络业务实体配置|支持|支持
配置属性|网络业务实体配置|静态|静态
VRF标识|网络业务实体配置|15|15
MS流控漏率缩放比|网络业务实体配置|1|1
MS流控桶容量缩放比|网络业务实体配置|1|1
NSE名称|网络业务实体配置|Gb_IP|Gb_IP
本端IP端点配置|IP地址|10.35.123.128|10.35.123.129
UDP端口|本端IP端点配置|40000|40000
本端IP端点标识|本端IP端点配置|1|2
远端IP端点配置|NSE标识号|1|1
IP地址|远端IP端点配置|192.165.17.17|192.165.17.17
UDP端口|远端IP端点配置|40000|40000
信令权重|远端IP端点配置|100|100
数据权重|远端IP端点配置|100|100
远端IP端点标识|远端IP端点配置|2|2
IP网络业务虚连接配置|NSE标识号|1|1
本端IP端点标识|IP网络业务虚连接配置|1|2
远端IP端点标识|IP网络业务虚连接配置|2|2
连接方式|IP网络业务虚连接配置|单一|单一
位置区配置|位置区名|BSC110_01CC|BSC110_01CC
移动国家码|位置区配置|460|460
移动网号|位置区配置|00|00
位置区域码(HEX)|位置区配置|01CC|01CC
路由区配置|路由区名|RAI11|RAI11
位置区名|路由区配置|BSC110_01CC|BSC110_01CC
路由区码(HEX)|路由区配置|11|11
是否使用全局时区|路由区配置|是|是
NSE保护路由区配置|NSE标识号|1|1
路由区名|NSE保护路由区配置|RAI11|RAI11
根据规划，进行如下配置。 
配置NSE，命令如下： 
[ADD NSE]:NSEI=1,FLEX="YES",NSVCMODE="Static",VPNID=15,FCM_R_SCALE="1",FCM_B_SCALE="1",NAME="Gb_IP"
配置本地IP端点，命令如下： 
[ADD LOCAL ENDPOINT]:IPADDR="10.35.123.128",PORT=40000,ENDPOINTID=1
[ADD LOCAL ENDPOINT]:IPADDR="10.35.123.129",PORT=40000,ENDPOINTID=2
配置远端IP端点，命令如下： 
[ADD REMOTE ENDPOINT]:NSEI=1,IPADDR="192.165.17.17",PORT=40000,SIGWEIGHT=100, DATAWEIGHT=100,ENDPOINTID=2
配置IP NSVC，命令如下： 
[ADD IP NSVC]:NSEI=1,LIPPORTID="1",RIPPORTID="2",MODE="SINGLE"
[ADD IP NSVC]:NSEI=1,LIPPORTID="2",RIPPORTID="2",MODE="SINGLE"
配置接入区域。 
配置位置区，命令如下： 
[ADD LAI]:NAME="BSC110_01CC",MCC="460",MNC="00",LAC="01CC"
配置路由区，命令如下： 
[ADD RAI]:NAME="RAI11",LAI="BSC110_01CC",RAC="11",GLOBALTZ="YES"
配置NSE保护路由区，命令如下： 
[SET NSE RAI]:NSEI=1,RANAME="RAI11"
动态BSC配置
配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
网络业务实体配置|NSE标识号|1|1
支持Flex功能|网络业务实体配置|支持|支持
配置属性|网络业务实体配置|动态|动态
VRF标识|网络业务实体配置|15|15
MS流控漏率缩放比|网络业务实体配置|1|1
MS流控桶容量缩放比|网络业务实体配置|1|1
NSE名称|网络业务实体配置|Gb_IP|Gb_IP
本端IP端点配置|IP地址|10.35.123.128|10.35.123.129
UDP端口|本端IP端点配置|40000|40000
本端IP端点标识|本端IP端点配置|1|2
位置区配置|位置区名|BSC110_01CC|BSC110_01CC
移动国家码|位置区配置|460|460
移动网号|位置区配置|00|00
位置区域码(HEX)|位置区配置|01CC|01CC
路由区配置|路由区名|RAI11|RAI11
位置区名|路由区配置|BSC110_01CC|BSC110_01CC
路由区码(HEX)|路由区配置|11|11
是否使用全局时区|路由区配置|是|是
NSE保护路由区配置|NSE标识号|1|1
路由区名|NSE保护路由区配置|RAI11|RAI11
根据规划，进行如下配置。 
配置NSE，命令如下： 
[ADD NSE]:NSEI=1,FLEX="YES",NSVCMODE="Dynamic",VPNID=15,FCM_R_SCALE="1",FCM_B_ SCALE="1",NAME="Gb_IP"
配置本地IP端点，命令如下： 
[ADD LOCAL ENDPOINT]:IPADDR="10.35.123.128",PORT=40000,ENDPOINTID=1
[ADD LOCAL ENDPOINT]:IPADDR="10.35.123.129",PORT=40000,ENDPOINTID=2
配置接入区域。 
配置位置区，命令如下： 
[ADD LAI]:NAME="BSC110_01CC",MCC="460",MNC="00",LAC="01CC"
配置路由区，命令如下： 
[ADD RAI]:NAME="RAI11",LAI="BSC110_01CC",RAC="11",GLOBALTZ="YES"
配置NSE保护路由区，命令如下： 
[SET NSE RAI]:NSEI=1,RANAME="RAI11"
##### 配置与MME对接数据 
摘要 :SGSN通过Gn/Gp接口与MME相连，实现GPRS到EPS网络的互通，主要实现以下功能：
前转重定位功能。 
前转SRNS上下文功能。 
上下文请求功能。 
ID请求功能。 
SGSN与MME之间采用GTP协议，其协议栈如[图1]所示。
图1  Gn/Gp接口协议栈

相关信息 :配置SGSN与MME对接数据，只需配置对接的MME地址解析即可。
SGSN与MME对接数据成功后，用户从SGSN重选到MME时，MME一般根据RAC+LAC查询到SGSN。
步骤 :执行命令[ADD SGSNHOST]，新增MME地址解析配置。
 说明： 
逻辑名称参数格式为rncxxxx.mncyyy.mcczzz.gprs，其中xxxx为4位数值表示的RNC，不足4位的靠前补零；yyy、zzz为3位数值表示的MNC、MCC，不足3位的，靠前补零。x为十六进制数，y、z
为十进制数。 
IP地址参数设置为MME的IP地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
参数名称|取值举例
---|---
逻辑名称|rac0005.lac1101.mnc001.mcc460.gprs
IP地址|131.58.1.159
根据规划，进行如下配置。 
增加对MME的地址解析，命令如下。 
[ADD SGSNHOST]:NAME="rac0005.lac1101.mnc001.mcc460.gprs",IPADDR="131.58.1.159"
##### 配置与CG对接数据 
摘要 :SGSN通过Ga接口与CG相连，使话单传送到CG上进行计费操作和话单存储，采用GTP'协议，遵循3GPP32.215协议，其协议栈如[图1]所示。
图1  Ga接口协议栈

相关信息 :SGSN与CG对接配置流程参见[表1]。
步骤|操作|操作说明
---|---|---
1|新增CG服务器配置|新增一个CG服务器来接收话单，设置CG服务器的地址及使用的端口号。
2|新增CG Profile配置|SGSN将两个CG服务器作为一组，为一个CG Profile，以CG Profile ID为标识。SGSN发送话单时，使用此ID在本模块查找到CG Profile。如CG Profile中配置为主备模式，优先选择主用CG服务器。如CG Profile中配置为负荷分担模式，基于用户IMSI的后三位数字选择CG服务器。
3|配置本端单地址|为SGSN配置一个IPV4或IPV6地址，各个处理单元均使用此地址，用于和CG网元建立Ga连接。在网络IP地址资源有限的情况下，可选择单地址模式减少IP地址的占用。
步骤 :执行命令[ADD CGCFG]，新增CG服务器配置。
 说明： 
CG侧端口号参数为SGSN与CG对接的端口号，设置为3386。
执行命令[SET CGPROFILE]，修改CG Profile配置。
 说明： 
CG服务器 ID参数设置为CG服务器的标识，需要关联[ADD CGCFG]命令中配置的CG服务器ID。
执行命令[SET SINGLE ADDR]，配置本端单地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
CG服务器配置|CG服务器ID|1|2
CG侧地址|CG服务器配置|802F:5012:0811:0011::4001|8027:5015:0811:0011::4001
CG起始端口号|CG服务器配置|3386|3386
CG Profile配置|CG Profile ID|0|0
CG服务器 ID|CG Profile配置|"1"-"1"-"100"&"2"-"2"-"100"|"1"-"1"-"100"&"2"-"2"-"100"
本端单地址配置|本端IPv6地址|2409:802F:500B:1715:21::1013|2409:802F:500B:1715:21::1013
VRF ID|本端单地址配置|17|17
根据规划，进行如下配置。 
新增CG服务器配置，命令如下。 
[ADD CGCFG]:ID=1,CGADDR="802F:5012:0811:0011::4001",CGPORT=3386
[ADD CGCFG]:ID=2,CGADDR="8027:5015:0811:0011::4001",CGPORT=3386
修改CG Profile配置，两个CG服务器为主备方式，服务器1为主用，服务器2为备用，命令如下。 
[SET CGPROFILE]:PROFILEID=0,CGSERVER="1"-"1"-"100"&"2"-"2"-"100"
配置本端单地址，命令如下。 
[SET SINGLE ADDR]:LOCALV6ADDR="2409:802F:500B:1715:21::1013",VRF=17
##### 配置与DNS对接数据 
摘要 :DNS服务器是网络中专门提供域名解析服务的服务器。SGSN通过DNS进行域名解析，根据域名获取对应的IP地址。
在附着、RAU、切换、PDP激活等业务流程中，需要获取交互的MME、SGSN、GGSN/PGW的地址，如果这些地址没有在SGSN配置，则需要查询DNS服务器，此时SGSN需要内置DNS客户端功能。SGSN通过DNS配置来完成内置DNS客户端功能的配置。
相关信息 :SGSN与DNS对接配置流程参见[表1]。步骤|操作|操作说明
---|---|---
1|（可选）配置DNS全局参数|可根据实际需求配置SGSN作为DNS客户端的全局参数，用于运营商根据实际的网络情况来调整SGSN和DNS服务器之间的交互质量，也可以采用系统默认值。
2|新增DNS服务器|配置SGSN相连的DNS服务器，包括DNS客户端地址、DNS服务器端地址、VRFID、DNS服务器编号和名称。SGSN可以跟多个DNS服务器相连接。
3|新增DNS服务器组|一个DNS服务器组包含一个或多个DNS服务器，多个DNS服务器之间的工作模式可以是负荷分担或主备。
4|新增DNS Profile|DNS Profile用于进行DNS查询时选择DNS服务器的入口，包括LTE Profile和GPRS Profile。LTE Profile用于进行EPC查询时选择DNS服务器。GRPS Profile用于进行GPRS查询时选择DNS服务器。一个DNS profile包含一个或多个DNS服务器组，最多4个DNS服务器组，多个DNS服务器组之间可以负荷分担或主备。负荷分担时，则需要根据各服务器组的权重进行选择，权重值越大则被选择的概率越高。主备时，则排列在第一个的服务器组是第一优先级的服务器组，依照排列顺序，优先级逐渐降低，优先级高的服务器组中有服务器可达时，则一定选择高优先级的服务器组。主备时，权重值无效。
5|（可选）配置DNS服务器状态检测机制|可根据实际需求配置DNS服务器状态检测机制，包括故障检测和故障恢复检测两方面功能，也可以采用系统默认值。故障检测，是指对当前可用的DNS服务器进行定时检测，以便尽快了解其是否故障。故障恢复检测，是指对当前处于不可用的DNS服务器进行定时检测，以确定其是否恢复可用。
步骤 :（可选）执行命令[SET DNS GLB]，设置DNS全局参数。
 说明： 
DNS查询方式是指SGSN在查询DNS服务器时使用的方式，具体分为：
UDP方式：使用UDP报文查询，返回结果的最大长度为512字节。 
TCP方式：使用TCP协议查询，理论长度限制达到64 K字节。 
UDP优先方式：使用UDP查询时发现结果超过512字节（协议描述是查询响应中带截断标志）时，临时自动修改为TCP方式再次进行查询。 
DNS查询方式
参数的默认值为“UDP优先方式”，无需修改。
执行命令[ADD DNS SERVER]，新增DNS服务器。
 说明： 
DNS客户端地址，和本配置中DNS服务器IP地址同类型，即DNS客户端IP地址和DNS服务器IP地址都是IPv4或都是IPv6地址。 
执行命令[ADD DNS SRVGRP]，新增DNS服务器组。
 说明： 
DNS服务器ID需要关联[ADD DNS SERVER]命令中配置的DNS服务器编号，且一个DNS服务器ID不能在一个DNS服务器组中重复出现。
执行命令[ADD DNS PROFILE]，新增DNS Profile。
 说明： 
DNS服务器组ID需要关联[ADD DNS SRVGRP]命令中配置的DNS服务器组号，且一个DNS服务器组ID不能在一个DNS Profile中重复出现。
（可选）执行命令[SET DNS SRVCHECK]，配置DNS服务器状态检测参数。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
DNS全局参数|DNS UDP查询超时时长(秒)|3|3
TTL（分钟）|DNS全局参数|180|180
DNS服务器|DNS服务器编号|1|2
DNS服务器IP地址|DNS服务器|172.16.12.101|172.16.12.102
DNS客户端IP地址|DNS服务器|223.103.77.128|223.103.77.128
VRFID|DNS服务器|8|8
DNS服务器名称|DNS服务器|DNS01|DNS02
DNS服务器组|DNS服务器组编号|1|1
选择模式|DNS服务器组|负荷分担|负荷分担
DNS服务器列表|DNS服务器组|"1"-"100"&"2"-"100"|"1"-"100"&"2"-"100"
DNS服务器组名称|DNS服务器组|DNS Group|DNS Group
DNS Profile配置|DNS Profile类型|GPRS|GPRS
选择模式|DNS Profile配置|主备|主备
DNS服务器组列表|DNS Profile配置|"1"-"0"|"1"-"0"
根据规划，进行如下配置。 
设置DNS全局参数，命令如下。 
[SET DNS GLB]:TIMEOUT=3,TTL=180
新增DNS服务器。 
新增DNS服务器1，命令如下。 
[ADD DNS SERVER]:ID=1,SERVERIPADDR=172.16.12.101, CLIENTIPADDR=223.103.77.128,VRFID=8,NAME="DNS01"
新增DNS服务器2，命令如下。 
[ADD DNS SERVER]:ID=2,SERVERIPADDR=172.16.12.102, CLIENTIPADDR=223.103.77.128,VRFID=8,NAME="DNS02"
新增DNS服务器组，命令如下。 
[ADD DNS SRVGRP]:ID=1,SELECTMODE="PARTAKE",SVRLST="1"-"100"&"2"-"100",NAME="DNS Group"
新增DNS Profile，命令如下。 
[ADD DNS PROFILE]:TYPE="GPRS",SELECTMODE="BACKUP",SVRGRPLST="1"-"0"
#### 安全配置 
##### 配置鉴权 
摘要 :本节介绍如何进行MME和SGSN的鉴权配置。 
步骤 :执行[SET MME IMSI AUTH DEFAULT]命令，配置MME IMSI鉴权策略。
执行[SET SECURITY PARAMETER]命令，配置SGSN鉴权策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME IMSI鉴权配置|业务类型|IMSI附着、RAT内局间附着、跨RAT局间附着、RAT内局间TAU、跨RAT局间TAU
鉴权类型|MME IMSI鉴权配置|强制鉴权
安全参数配置|SGSN附着时鉴权|强制鉴权
根据规划，进行如下配置。 
配置MME IMSI鉴权策略，命令如下。 
[SET MME IMSI AUTH DEFAULT]:SERVICETYPE="IMSIATTACH",AUTHTYPE="Force"
[SET MME IMSI AUTH DEFAULT]:SERVICETYPE="MMECHANGE",AUTHTYPE="Force"
[SET MME IMSI AUTH DEFAULT]:SERVICETYPE="IERATAIERRAT",AUTHTYPE="Force"
[SET MME IMSI AUTH DEFAULT]:SERVICETYPE="IERTAUIRARAT",AUTHTYPE="Force"
[SET MME IMSI AUTH DEFAULT]:SERVICETYPE="IERTAUIERRAT",AUTHTYPE="Force"
配置SGSN IMSI鉴权策略，命令如下。 
[SET SECURITY PARAMETER]:AUTHONATTACH="Compelling authentication"
##### 配置加密 
摘要 :本节介绍如何进行MME的加密配置。 
步骤 :执行[SET NAS ENCRYCTRL]命令，配置MME NAS加密算法。
执行[SET NAS INTEGCTRL]命令，配置MME NAS完整性保护算法。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
EPC NAS加密控制参数配置|NAS加密控制|加密
EEA0|EPC NAS加密控制参数配置|支持
EEA1|EPC NAS加密控制参数配置|支持
EEA2|EPC NAS加密控制参数配置|支持
EEA3|EPC NAS加密控制参数配置|不支持
EEA0优先级|EPC NAS加密控制参数配置|0
EEA1优先级|EPC NAS加密控制参数配置|1
EEA2优先级|EPC NAS加密控制参数配置|2
EEA3优先级|EPC NAS加密控制参数配置|3
EPC NAS完整性保护参数配置|E1A1|支持
E1A2|EPC NAS完整性保护参数配置|支持
E1A3|EPC NAS完整性保护参数配置|不支持
E1A1优先级|EPC NAS完整性保护参数配置|0
E1A2优先级|EPC NAS完整性保护参数配置|1
E1A3优先级|EPC NAS完整性保护参数配置|2
根据规划，进行如下配置。 
配置MME NAS加密算法，命令如下。 
[SET NAS ENCRYCTRL]:ENCRYPTION="Encrypt",EEA0="Support",EEA1="Support",EEA2="Support",EEA3="Not support",PRIORENCRY0="0",PRIORENCRY1="1",PRIORENCRY2="2",PRIORENCRY3="3"
配置MME NAS完整性保护算法，命令如下。 
[SET NAS INTEGCTRL]:INTEGALGO1="Support",INTEGALGO2="Support",INTEGALGO3="Not support",PRIORINTEG1="0",PRIORINTEG2="1",PRIORINTEG3="2"
#### VoLTE配置 
##### 开启VoLTE功能 
摘要 :本节介绍如何开启VoLTE相关配置。
详细的功能和配置说明参见特性ZUF-78-12-001 VOLTE能力管理
。
步骤 :执行[SET PACKET DOMAIN PARAMETER]命令，打开MME支持基于PS会话IMS语音开关。
执行[ADD IMS APN]命令，配置通用IMS APN名称。
执行[SET DEFAULT IMSI VOICE POLICY]命令，设置缺省语音参数策略的根据IMS APN签约决策IMS VoPS能力。
执行[SET DEFAULT IMSI VOICE POLICY]命令，设置缺省语音参数策略的IMS VoPS。
执行[ADD IMSI VOICE POLICY]命令，新增基于IMSI的语音参数策略配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
分组域参数配置|MME支持基于PS会话IMS语音|是
IMS APN配置|IMS APN名称|ims
缺省语音参数策略配置|支持根据IMS APN签约决策IMS VoPS能力|是
IMS VoPS|缺省语音参数策略配置|支持
新增基于IMSI的语音参数策略配置|IMSI|46000、46002、46004、46007、46008、46013
附加更新结果|新增基于IMSI的语音参数策略配置|无附加信息
IMS VoPS|新增基于IMSI的语音参数策略配置|支持
支持根据IMS APN签约决策IMS VoPS能力|新增基于IMSI的语音参数策略配置|是
根据规划，进行如下配置。 
打开MME支持基于PS会话IMS语音开关，命令如下。 
[SET PACKET DOMAIN PARAMETER]:MMEIMSVOPS="YES"
配置通用IMS APN名称，命令如下。 
[ADD IMS APN]:APNNAME="ims"
设置缺省语音参数策略的根据IMS APN签约决策IMS VoPS能力，命令如下。 
[SET DEFAULT IMSI VOICE POLICY]:IMSAPNCHK="YES"
设置缺省语音参数策略的IMS VoPS，命令如下。 
[SET DEFAULT IMSI VOICE POLICY]:IMSVOPS="SPRT"
新增基于IMSI的语音参数策略配置，命令如下。 
[ADD IMSI VOICE POLICY]:IMSI="46000",UPTRSLT="NOADD",IMSVOPS="YES",IMSAPNCHK="YES"
[ADD IMSI VOICE POLICY]:IMSI="46002",UPTRSLT="NOADD",IMSVOPS="YES",IMSAPNCHK="YES"
[ADD IMSI VOICE POLICY]:IMSI="46004",UPTRSLT="NOADD",IMSVOPS="YES",IMSAPNCHK="YES"
[ADD IMSI VOICE POLICY]:IMSI="46007",UPTRSLT="NOADD",IMSVOPS="YES",IMSAPNCHK="YES"
[ADD IMSI VOICE POLICY]:IMSI="46008",UPTRSLT="NOADD",IMSVOPS="YES",IMSAPNCHK="YES"
[ADD IMSI VOICE POLICY]:IMSI="46013",UPTRSLT="NOADD",IMSVOPS="YES",IMSAPNCHK="YES"
##### 配置VoLTE寻呼 
摘要 :本节介绍如何进行VoLTE寻呼配置。 
MME支持将VoLTE DDN触发寻呼和分组数据智能寻呼方式区分开。VoLTE要求首次寻呼不采用eNB列表范围寻呼，防止首次eNB寻呼缩短失败再二次发起TALIST范围寻呼，造成VoLTE呼叫接续时间长。MME根据SGW/PGW的DDN消息中EBI执行对应的寻呼策略进行寻呼，从而缩短VoLTE业务寻呼的时间，加快VoLTE呼叫接续过程。 
详细的功能和配置说明参见特性ZUF-78-12-001 VOLTE能力管理
。
步骤 :执行[ADD MME PS PAGING POLICY]命令，配置数据业务寻呼策略。
执行[ADD MME PAGING POLICY FACTOR]命令，配置MME寻呼策略因子。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
数据业务寻呼策略配置|寻呼策略编号|51
寻呼策略|数据业务寻呼策略配置|"GUTITALIST"-30-"PRIO_255"&"GUTITALIST"-30-"PRIO_255"&"GUTITALIST"-30-"PRIO_255"
MME寻呼策略因子配置|QCI|5、1、2
APNNI|MME寻呼策略因子配置|ims
寻呼策略|MME寻呼策略因子配置|"PS"-"51"
根据规划，进行如下配置。 
配置数据业务寻呼策略，命令如下。 
[ADD MME PS PAGING POLICY]:ID=51,PAGEPOLICY="GUTITALIST"-30-"PRIO_255"&"GUTITALIST"-30-"PRIO_255"&"GUTITALIST"-30-"PRIO_255"
配置MME寻呼策略因子，命令如下。 
[ADD MME PAGING POLICY FACTOR]:QCI=5,APNNI="ims",PGPOLICY="PS"-"51"
[ADD MME PAGING POLICY FACTOR]:QCI=1,APNNI="ims",PGPOLICY="PS"-"51"
[ADD MME PAGING POLICY FACTOR]:QCI=2,APNNI="ims",PGPOLICY="PS"-"51"
##### 配置SRVCC 
摘要 :本节介绍如何进行SRVCC配置。
为使用LTE接入的IMS语音服务网络提供单信道语音连续性解决方案。SRVCC在UE从LTE移动到CS的时候，建立CS域呼叫分支，并通过SCC AS锚点，将CS分支和原IMS到呼叫对端分支连接，从而形成完整的呼叫链，保持了IMS域呼叫能够在切换后继续进行。 
详细的功能和配置说明参见特性ZUF-78-12-005 SRVCC
。
前提 :已打开MME支持SRVCC功能的License项。
步骤 :执行[SET DEFAULT VOICESET POLICY]命令，配置缺省的语音参数策略。
执行[SET MME SX GTPC]命令，配置Sv接口地址。
执行[SET GLOBAL DFTMSCS]命令，配置全局缺省SRVCC的eMSC。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
缺省语音参数策略配置|附加更新结果|无附加信息
IMS VoPS|缺省语音参数策略配置|支持
MME Sx信令地址配置|Sv IPv4信令地址|10.36.192.130
Sv IPv6信令地址|MME Sx信令地址配置|2409:802F:500B:1715:21::1013
全局缺省SRVCC增强MSC Server配置|缺省MSC Server地址|"10.120.207.2"&"10.120.207.130"
根据规划，进行如下配置。 
配置缺省的语音参数策略，默认同时支持CSFB和IMS VoPS，命令如下。 
[SET DEFAULT VOICESET POLICY]:UPDATERESULT="NOADD",IMSVOPS="SPRT"
配置Sv接口地址， 命令如下。 
[SET MME SX GTPC]:SVIPADDR="10.36.192.130",SVIPV6ADDR="2409:802F:500B:1715:21::1013"
配置全局缺省SRVCC的eMSC， 命令如下。 
[SET GLOBAL DFTMSCS]:MSCSIP="10.120.207.2"&"10.120.207.130"
##### 配置IMS APN重建 
摘要 :本节介绍如何进行IMS APN重建配置。 
步骤 :执行[SET DEFAULT BEARER REBUILD]命令，配置默认承载重建策略。
执行[ADD REBUILD BEARER APN]命令，新增需重建默认承载的APN配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
默认承载重建策略配置|支持默认承载重建|是
SGW和PGW合一时FQDN相同的Label数|默认承载重建策略配置|7
需重建默认承载的APN配置|APN名称|ims
根据规划，进行如下配置。 
配置默认承载重建策略，命令如下。 
[SET DEFAULT BEARER REBUILD]:RESETBEAR="YES",SAMELABELNUM=7
新增需重建默认承载的APN配置，命令如下。 
[ADD REBUILD BEARER APN]:APNNAME="ims"
##### 配置容灾 
摘要 :本节介绍如何进行容灾配置。 
详细的功能和配置说明参见特性ZUF-78-12 语音和短消息
中VoLTE容灾相关部分。
前提 :以下License项已打开。 
MME支持MME容灾故障恢复功能 
MME支持P-CSCF恢复功能 
MME支持SGW容灾故障恢复功能 
MME支持PGW容灾故障恢复功能 
步骤 :执行[SET SERVRSTOCFG]命令，配置备份MME地址。根据规划的链式备份关系，每MME上配置对应备份MME的GTPC地址。如果POOL内仅有两套MME，仅需配置此命令即可。
（可选）执行[ADD POOLBAKMMECFG]命令，添加POOL内其他MME地址。
执行[SET SERVRSTOCFG]命令，打开容灾功能。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
容灾恢复配置|备份MME的MME IP地址|221.177.203.3|221.177.203.3|221.177.203.3
POOL内其他MME及其备份MME配置|MME的GTPC地址|221.177.203.3|221.177.203.53|221.177.203.5
备份MME的GTPC地址|POOL内其他MME及其备份MME配置|221.177.203.53|221.177.203.5|221.103.77.128
用户别名|POOL内其他MME及其备份MME配置|MME3ToMME2|MME2ToMME4|MME4ToMME1
容灾恢复配置|支持SGW容灾恢复|支持|支持|支持
支持PGW容灾恢复|容灾恢复配置|支持|支持|支持
支持MME容灾恢复|容灾恢复配置|支持|支持|支持
支持P-CSCF容灾恢复|容灾恢复配置|支持|支持|支持
根据规划，进行如下配置。 
配置备份MME的GTPC地址，命令如下。 
[SET SERVRSTOCFG]:BAKMMEIP="221.177.203.3"
配置POOL内其他MME备份关系，命令如下。 
[ADD POOLBAKMMECFG]:MMEIP="221.177.203.3",BAKMMEIP="221.177.203.53",NAME="MME3ToMME2"
[ADD POOLBAKMMECFG]:MMEIP="221.177.203.53",BAKMMEIP="221.177.203.5",NAME="MME2ToMME4"
[ADD POOLBAKMMECFG]:MMEIP="221.177.203.5",BAKMMEIP="221.103.77.128",NAME="MME4ToMME1"
打开容灾功能开关，命令如下。 
[SET SERVRSTOCFG]:SGWRSTOFLAG="YES",PGWRSTOFLAG="YES",MMERSTOFLAG="YES",PCSCFRSTOFLAG="YES"
#### 业务功能配置 
##### 配置位置信息上报 
摘要 :本节介绍如何进行位置信息上报配置。 
步骤 :执行[SET COMBOCFG]命令，开启位置信息上报功能。
执行[ADD PGWCHAR]命令，配置PGW局向特性。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
Combo本局移动数据配置|支持用户位置信息变化上报配置|支持
PGW局向特性配置|PLMN|"460"-"00"、"460"-"02"、"460"-"04"、"460"-"07"、"460"-"08"、"460"-"13"
主动上报ULI|PGW局向特性配置|在任何CRA信息未知情况下主动上报
支持主动上报eNodeBID|PGW局向特性配置|不支持
根据规划，进行如下配置。 
配置支持用户位置信息变化上报，命令如下。 
[SET COMBOCFG]:MMEULICHGRPT="YES"
配置PGW局向特性，命令如下。 
[ADD PGWCHAR]:PLMN="460"-"00",RISEREPULI="CRA_UNKNOWN",MMEPLMNRPTENB="NO"
[ADD PGWCHAR]:PLMN="460"-"02",RISEREPULI="CRA_UNKNOWN",MMEPLMNRPTENB="NO"
[ADD PGWCHAR]:PLMN="460"-"04",RISEREPULI="CRA_UNKNOWN",MMEPLMNRPTENB="NO"
[ADD PGWCHAR]:PLMN="460"-"07",RISEREPULI="CRA_UNKNOWN",MMEPLMNRPTENB="NO"
[ADD PGWCHAR]:PLMN="460"-"08",RISEREPULI="CRA_UNKNOWN",MMEPLMNRPTENB="NO"
[ADD PGWCHAR]:PLMN="460"-"13",RISEREPULI="CRA_UNKNOWN",MMEPLMNRPTENB="NO"
##### 配置NITZ 
摘要 :本节介绍如何进行NITZ配置。 
详细的功能和配置说明参见特性ZUF-78-09-008 NITZ
。
步骤 :执行[SET MME NITZ]命令，修改MME全局NITZ配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME全局NITZ配置|是否发送NI|否
是否发送TZ|MME全局NITZ配置|是
发送TZ场景|MME全局NITZ配置|"IMSI"&"GUTI"&"RATTOGUTI"&"RATTEGUTI"
根据规划，进行如下配置。 
修改MME全局NITZ配置，命令如下。 
[SET MME NITZ]:IFSENDNI="NO",IFSENDTZ="YES",SCENETZ="IMSI"&"GUTI"&"RATTOGUTI"&"RATTEGUTI"
##### 配置信令风暴抑制 
摘要 :本节介绍如何进行信令风暴抑制功能配置。 
详细的功能和配置说明参见特性ZUF-78-20-005 终端异常信令管控
。
前提 :以下License项已打开。 
MME支持信令风暴抑制 
SGSN支持信令风暴抑制 
步骤 :执行[SET SIGSRESTRAIN FLAG]命令，打开MME信令风暴抑制开关。
执行[SET SIGSRESTRAIN]命令，设置MME信令风暴抑制配置。
执行[SET SGSN SIGSRESTRAIN FLAG]命令，打开SGSN信令风暴抑制开关。
执行[SET SGSN SIGSRESTRAIN]命令，设置SGSN信令风暴抑制配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME是否支持信令风暴抑制配置|MME支持信令风暴抑制|支持
MME信令风暴抑制配置|附着请求信令统计周期(秒)|720
附着请求最大信令数|MME信令风暴抑制配置|15
附着拒绝原因值|MME信令风暴抑制配置|7
附着请求黑名单定时器时长(秒)|MME信令风暴抑制配置|1200
业务请求信令统计周期(秒)|MME信令风暴抑制配置|720
业务请求最大信令数|MME信令风暴抑制配置|50
业务请求拒绝原因值|MME信令风暴抑制配置|7
业务请求黑名单定时器时长(秒)|MME信令风暴抑制配置|1200
PDN连接请求信令统计周期(秒)|MME信令风暴抑制配置|720
PDN连接请求最大信令数|MME信令风暴抑制配置|10
PDN连接拒绝原因值|MME信令风暴抑制配置|55
PDN连接请求黑名单定时器时长(秒)|MME信令风暴抑制配置|1200
SGSN是否支持信令风暴抑制配置|SGSN支持信令风暴抑制|支持
SGSN信令风暴抑制配置|附着请求信令统计周期(秒)|720
附着请求最大信令数|SGSN信令风暴抑制配置|15
附着拒绝原因值|SGSN信令风暴抑制配置|7
附着请求黑名单定时器时长(秒)|SGSN信令风暴抑制配置|1200
业务请求信令统计周期(秒)|SGSN信令风暴抑制配置|720
业务请求最大信令数|SGSN信令风暴抑制配置|30
业务请求拒绝原因值|SGSN信令风暴抑制配置|7
业务请求黑名单定时器时长(秒)|SGSN信令风暴抑制配置|1200
PDP激活请求信令统计周期(秒)|SGSN信令风暴抑制配置|720
PDP激活请求最大信令数|SGSN信令风暴抑制配置|10
PDP激活拒绝原因值|SGSN信令风暴抑制配置|31
PDP激活请求黑名单定时器时长(秒)|SGSN信令风暴抑制配置|1200
根据规划，进行如下配置。 
打开MME信令风暴抑制开关，命令如下。 
[SET SIGSRESTRAIN FLAG]:FLAG="YES"
设置MME信令风暴抑制配置，命令如下。 
[SET SIGSRESTRAIN]:ATTSTATISPERD=720,ATTMAXSIGNUM=15,ATTREJCAUSE=7,ATTBLACKLISTDUR=1200,SERVSTATISPERD=720,SERVMAXSIGNUM=50,SERVREJCAUSE=7,SERVBLACKLISTDUR=1200,PDNSTATISPERD=720,PDNMAXSIGNUM=10,PDNREJCAUSE=55,PDNBLACKLISTDUR=1200
打开SGSN信令风暴抑制开关，命令如下。 
[SET SGSN SIGSRESTRAIN FLAG]:FLAG="ON"
设置SGSN信令风暴抑制配置，命令如下。 
[SET SGSN SIGSRESTRAIN]:ATTSTATISPERD=720,ATTMAXSIGNUM=15,ATTREJCAUSE=7,ATTBLACKLISTDUR=1200,SERVSTATISPERD=720,SERVMAXSIGNUM=30,SERVREJCAUSE=7,SERVBLACKLISTDUR=1200,PDPSTATISPERD=720,PDPMAXSIGNUM=10,PDPREJCAUSE=31,PDPBLACKLISTDUR=1200
##### 配置终端双栈 
摘要 :本节介绍如何进行终端双栈配置。 
终端双栈功能是指UE注册到EPC网络后，UE发起PDN连接建立请求，指示申请IPv4v6双栈地址，PGW可以根据策略判断为用户同时分配IPv4和IPv6地址。SGW将PGW分配的IPv4v6双栈地址携带给MME，MME发送给UE。通过双栈功能，UE可以通过激活一个承载获取IPv4和IPv6地址和转发IPv4和IPv6报文，不需要激活两个承载分别获取IPv4和IPv6地址。 
UE激活双栈PDN连接后，可以同时访问IPv4的PDN和IPv6的PDN。 
步骤 :执行[SET MME DUAL STACK]命令，配置终端双栈。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
终端双栈数据配置|优选PDN类型|优选IPv4
UE切换的所有SGSN支持终端双栈|终端双栈数据配置|是
根据规划，进行如下配置。 
配置智能寻呼策略，命令如下。 
[SET MME DUAL STACK]:MMEPDNTYPE="IPv4",MMEDUALSTACK="YES"
##### 配置智能寻呼 
摘要 :本节介绍如何进行智能寻呼配置。 
智能寻呼是指MME基于用户类型、业务类型选择相应的寻呼规则，综合用户的移动性，选择合适的范围对用户进行寻呼，从而有效地减少整个网络中eNodeB的寻呼负荷，节省网络资源。MME可以根据不同业务要求，在保证一定寻呼成功率基础上，选择合适的策略进行寻呼。 
详细的功能和配置说明参见特性ZUF-78-09-002 智能寻呼
。
步骤 :执行[SET MME GLOBAL PS PAGING POLICY]命令，配置智能寻呼策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
数据业务全局寻呼策略配置|寻呼类型|自定义寻呼
寻呼策略|数据业务全局寻呼策略配置|"LASTENBLIST"-"30"-"PRIO_4"-"NEIGENBLIST"&"GUTITALIST"-"80"-"PRIO_4"-"N/A"&"IMSITALIST"-"80"-"PRIO_3"-"N/A"
根据规划，进行如下配置。 
配置智能寻呼策略，命令如下。 
[SET MME GLOBAL PS PAGING POLICY]:PAGETYPE="USER",PAGEPOLICY="LASTENBLIST"-"30"-"PRIO_4"-"NEIGENBLIST"&"GUTITALIST"-"80"-"PRIO_4"-"N/A"&"IMSITALIST"-"80"-"PRIO_3"-"N/A"
##### 配置APN更正 
摘要 :本节介绍如何进行APN更正配置。 
当用户接入EPC网络时，如果请求消息中携带的APN不合法，则MME对用户使用的APN按运营商的策略更正为其他APN，用户使用更正后的APN激活EPS承载上下文访问数据业务和其他业务。APN不合法通常是用户请求的APN和签约的APN不匹配，也可能是用户请求的APN格式错误。 
详细的功能和配置说明参见特性ZUF-78-10-001 APN更正
。
步骤 :执行[SET MME APNMOD POLICY]命令，配置MME支持APN更正。
执行[ADD MME APN MODIFICATION]命令，配置某用户IMSI号段使用的APN更正方式。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
EPC APN更正策略配置|是否支持APN更正功能|支持
指定APN更正时检查签约|EPC APN更正策略配置|不检查
支持APN控制更正策略|EPC APN更正策略配置|不支持
APN默认控制策略|EPC APN更正策略配置|更正
EPC APN更正配置|IMSI号段|46000、46002、46004、46007、46008、46013
用户是否签约通配|EPC APN更正配置|忽略
更正APN方式|EPC APN更正配置|HSS签约的默认APN
根据规划，进行如下配置。 
配置EPC APN更正策略，命令如下。 
[SET MME APNMOD POLICY]:APNMODIFY="YES",SPECAPNCHKSUB="NOTCHECK",SUPEAPNCTLMODPLY="NO",EAPNDFTCTLPLY="YES"
增加本地用户号段的APN更正策略为“签约APN”，命令如下。 
[ADD MME APN MODIFICATION]:IMSI="46000",SUBWILDCHK="IGNORE",MODIFYMODE="Default APN Signed by HSS"
[ADD MME APN MODIFICATION]:IMSI="46002",SUBWILDCHK="IGNORE",MODIFYMODE="Default APN Signed by HSS"
[ADD MME APN MODIFICATION]:IMSI="46004",SUBWILDCHK="IGNORE",MODIFYMODE="Default APN Signed by HSS"
[ADD MME APN MODIFICATION]:IMSI="46007",SUBWILDCHK="IGNORE",MODIFYMODE="Default APN Signed by HSS"
[ADD MME APN MODIFICATION]:IMSI="46008",SUBWILDCHK="IGNORE",MODIFYMODE="Default APN Signed by HSS"
[ADD MME APN MODIFICATION]:IMSI="46013",SUBWILDCHK="IGNORE",MODIFYMODE="Default APN Signed by HSS"
##### 配置拓扑优选开关 
摘要 :配置MME拓扑优选开关，控制MME在选择SGW或者PGW时，MME是否优先选择拓扑关系最接近的一对SGW和PGW。 
详细的功能和配置说明参见特性ZUF-78-05-001 PGW选择
。
步骤 :执行[SET PACKET DOMAIN PARAMETER]命令，配置MME拓扑优选开关。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
分组域参数配置|Gateway选择是否考虑拓扑关系|是
根据规划，进行如下配置。 
打开MME拓扑优选开关，命令如下。 
[SET PACKET DOMAIN PARAMETER]:TOPOLOGY="YES"
##### 配置DSCP（可选） 
摘要 :本节介绍如何进行DSCP配置。 
步骤 :执行[SET SIG DSCP]命令，配置信令DSCP。
执行[ADD QOS DSCP]命令，新增QoS与DSCP映射。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
信令DSCP配置|GTP信令DSCP|46
DSCP映射配置|业务类别|会话类型、流类型、交互类型、背景类型
数据报文方向|DSCP映射配置|上行链路
QoS参数类型|DSCP映射配置|缺省分配/保持优先级
DSCP值|DSCP映射配置|18
根据规划，进行如下配置。 
设置信令DSCP，命令如下。 
[SET SIG DSCP]:GNGTPSIGDSCP=46
新增QoS与DSCP映射，命令如下。 
[ADD QOS DSCP]:TRAFFCLASS="Conversational",DIRECTION="UPLINK",QOSTYPE="ARP",DSCP=18
[ADD QOS DSCP]:TRAFFCLASS="Streaming",DIRECTION="UPLINK",QOSTYPE="ARP",DSCP=18
[ADD QOS DSCP]:TRAFFCLASS="Interactive",DIRECTION="UPLINK",QOSTYPE="ARP",DSCP=18
[ADD QOS DSCP]:TRAFFCLASS="Background",DIRECTION="UPLINK",QOSTYPE="ARP",DSCP=18
##### 配置NSA（可选） 
摘要 :本节介绍如何进行NSA配置。 
前提 :以下License项已打开。 
支持NSA功能 
MME支持双连接功能 
步骤 :执行[SET SOFTWARE PARAMETER]命令，MME打开支持双连接功能软参（ID：786803）。
执行[SET NSA CONTROL POLICY]命令，设置MME NSA业务控制策略。
执行[SET DCNR RESTRICT DEFAULT POLICY]命令，设置DCNR限制默认策略。
执行[ADD IMSI DCNR RESTRICT POLICY]命令，新增IMSI号段DCNR限制策略。
执行[SET MCAQOSCTL]命令，设置MME支持大于256Mbps速率控制。
执行[SET QOS RATE EXTCTRL]命令，设置QoS扩展控制在哪些业务接口上开启。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数|取值
---|---|---
软件参数配置|软件参数ID|786803
软件参数值|软件参数配置|1
MME NSA业务控制策略配置|是否支持NSA|支持
是否支持DCNR限制|MME NSA业务控制策略配置|支持
是否支持5G QoS速率扩展|MME NSA业务控制策略配置|支持
是否支持选择NC-NR的SGW|MME NSA业务控制策略配置|支持
是否支持选择NC-NR的PGW|MME NSA业务控制策略配置|支持
选择可达的NC-NR的SGW失败后的策略|MME NSA业务控制策略配置|优选普通SGW
选择可达的NC-NR的PGW失败后的策略|MME NSA业务控制策略配置|优选具有NC-NR能力的PGW
是否支持SGW用量报告|MME NSA业务控制策略配置|支持
是否支持PGW用量报告|MME NSA业务控制策略配置|支持
是否支持UE 5G安全能力|MME NSA业务控制策略配置|支持
SGW四步查询时支持选择仅S11接口有nc-nr能力的nc-nr SGW|MME NSA业务控制策略配置|是
MME DCNR限制默认策略配置|DCNR限制策略优先级|本地策略
MME本地DCNR限制策略|MME DCNR限制默认策略配置|限制
IMSI号段DCNR限制策略配置|IMSI号段|46000、46002、46004、46007、46008、46013
DCNR限制策略优先级|IMSI号段DCNR限制策略配置|HSS支持时取签约值，不支持时本地策略
MME本地DCNR限制策略|IMSI号段DCNR限制策略配置|不限制
MME支持大于256Mbps速率控制配置|S11接口是否支持CA|支持
S10接口是否支持CA|MME支持大于256Mbps速率控制配置|支持
S1接口是否支持CA|MME支持大于256Mbps速率控制配置|支持
NAS接口是否支持CA|MME支持大于256Mbps速率控制配置|支持
NAS接口Pre-R8 QoS是否支持CA|MME支持大于256Mbps速率控制配置|不支持
MME支持QoS速率扩展控制配置|S11接口是否支持5G QoS速率扩展|支持
S10接口是否支持5G QoS速率扩展|MME支持QoS速率扩展控制配置|支持
S1接口是否支持5G QoS速率扩展|MME支持QoS速率扩展控制配置|支持
NAS接口是否支持5G QoS速率扩展|MME支持QoS速率扩展控制配置|支持
NAS接口Pre-R8 QoS是否支持5G QoS速率扩展|MME支持QoS速率扩展控制配置|不支持
根据规划，进行如下配置。 
MME打开支持双连接功能软参，命令如下。
[SET SOFTWARE PARAMETER]:PARAID=786803,PARAVALUE=1
设置MME NSA业务控制策略，命令如下。 
[SET NSA CONTROL POLICY]:SUPNSA="YES",SUPDCNRRESTRICT="YES",SUPQOSEXT="YES",SUPSELNCNRSGW="YES",SUPSELNCNRPGW="YES",RESELSGWNCNRFAIL="SELECT_COMMON_SGW",RESELPGWNCNRFAIL="SELECT_PGW_WITH_NC-NR",SUPSGWUSEDATARPT="YES",SUPPGWUSEDATARPT="YES",SUPUE5GSECCAPA="YES",SGWFOURSTEPNCNROPTM="YES"
设置DCNR限制默认策略，命令如下。 
[SET DCNR RESTRICT DEFAULT POLICY]:DFTDCNR="LOCAL",LOCALPOLICY="YES"
新增IMSI号段DCNR限制策略，命令如下。 
[ADD IMSI DCNR RESTRICT POLICY]:IMSI="46000",IMSIDCNRRESTRIC="HSS",IMSILOCALPOLICY="NO"
[ADD IMSI DCNR RESTRICT POLICY]:IMSI="46002",IMSIDCNRRESTRIC="HSS",IMSILOCALPOLICY="NO"
[ADD IMSI DCNR RESTRICT POLICY]:IMSI="46004",IMSIDCNRRESTRIC="HSS",IMSILOCALPOLICY="NO"
[ADD IMSI DCNR RESTRICT POLICY]:IMSI="46007",IMSIDCNRRESTRIC="HSS",IMSILOCALPOLICY="NO"
[ADD IMSI DCNR RESTRICT POLICY]:IMSI="46008",IMSIDCNRRESTRIC="HSS",IMSILOCALPOLICY="NO"
[ADD IMSI DCNR RESTRICT POLICY]:IMSI="46013",IMSIDCNRRESTRIC="HSS",IMSILOCALPOLICY="NO"
设置MME支持大于256Mbps速率控制，命令如下。 
[SET MCAQOSCTL]:IFS11="YES",IFS10="YES",IFS1="YES",IFNAS="YES",IFPRER8="NO"
配置QoS扩展控制在哪些业务接口上开启。NAS接口Pre-R8 QoS是否支持5G QoS速率扩展必须设置为“不支持”。 
[SET QOS RATE EXTCTRL]:S11SUPQOSEXT="YES",S10SUPQOSEXT="YES",S1SUPQOSEXT="YES",NASSUPQOSEXT="YES",NASPRER8SUPQOSEXT="NO"
##### 配置NBIoT（可选） 
摘要 :本节介绍如何进行NBIoT配置。 
步骤 :执行[SET MME IOT CFG]命令，设置MME物联网相关业务功能开关。
执行[SET MME GTPU IP]命令，设置MME GTPU地址。
执行[SET SOFTWARE PARAMETER]命令，打开软参MME支持S1-U和S11-U地址分开（ID：786890）。
执行[SET MME GLOBAL NBIOT PAGING POLICY]命令，设置NB-IoT业务全局寻呼策略。
执行[SET DEFAULT POWERSAVE POLICY]命令，设置缺省节电策略。
执行[ADD POWERSAVE POLICY]命令，新增节电策略。
执行[ADD POWERSAVE POLICY FACTOR]命令，新增节电策略因子。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数|取值
---|---|---
物联网业务配置|支持控制面优化|支持
支持PSM|物联网业务配置|支持
支持eDRX|物联网业务配置|支持
支持HLCom|物联网业务配置|支持
支持用户面优化|物联网业务配置|支持
支持物联网终端短消息优化|物联网业务配置|支持
支持Non-IP数据SGi口传输|物联网业务配置|支持
支持NB-IoT接入时采用S1-U承载进行数据传输|物联网业务配置|支持
MME GTPU地址配置|GTPU IPv4地址|223.103.138.129
GTPU IPv6地址|MME GTPU地址配置|2409:801D:2902:0900::0101
软件参数配置|软件参数ID|786890
软件参数值|软件参数配置|1
NB-IoT业务全局寻呼策略配置|寻呼类型|自定义寻呼
寻呼策略|NB-IoT业务全局寻呼策略配置|"LASTENB"-"120"-"PRIO_3"-"RECENBLIST"&"LASTENBLIST"-"120"-"PRIO_3"-"N/A"
物联网寻呼增强|NB-IoT业务全局寻呼策略配置|"YES"-"YES"-"YES"
缺省节电策略配置|H-SFN起始时间|1980-01-05 23:59:42
节电策略配置|节电策略模板编号|256
节电策略模板名称|节电策略配置|cmnbiot1-SavePolicy
UE同时请求PSM和eDRX时授权策略|节电策略配置|PSM and eDRX
支持PSM|节电策略配置|支持
支持eDRX|节电策略配置|支持
节电策略因子配置|APNNI|cmnbiot1
节电策略模板编号|节电策略因子配置|256
根据规划，进行如下配置。 
设置MME物联网相关业务功能开关，命令如下。 
[SET MME IOT CFG]:CPSW="YES",SUPPSM="YES",SUPEDRX="YES",SUPHLCOM="YES",UPSW="YES",ERWOPDNSW="YES",SGNIPDNSW="YES",NBS1U="YES"
设置MME GTPU地址，命令如下。 
[SET MME GTPU IP]:S11UIPADDR="223.103.138.129",S11UIPV6ADDR="2409:801D:2902:0900::0101"
打开软参MME支持S1-U和S11-U地址分开，命令如下。
[SET SOFTWARE PARAMETER]:PARAID=786890,PARAVALUE=1
设置NB-IoT业务全局寻呼策略，命令如下。 
[SET MME GLOBAL NBIOT PAGING POLICY]:PAGETYPE="USER",PAGEPOLICY="LASTENB"-120-"PRIO_255"&"LASTENBLIST"-120-"PRIO_255"&"GUTITALIST"-120-"PRIO_255",IOTPAGEEN="YES"-"YES"-"YES"
设置缺省节电策略，命令如下。 
[SET DEFAULT POWERSAVE POLICY]:HSFNSTARTTIME="1980-01-05 23:59:42"
新增节电策略，命令如下。 
[ADD POWERSAVE POLICY]:POLICYID=256,POLICYNAME="cmnbiot1-SavePolicy",AUTHPOLICY="PSM_EDRX",SUPPORTPSM="YES",SUPPORTEDRX="YES"
新增节电策略因子，命令如下。 
[ADD POWERSAVE POLICY FACTOR]:FACTORAPN="cmnbiot1",POLICYID=256
##### 配置IPv6地址细分（可选） 
摘要 :本节介绍如何进行地址细分配置。 
前提 :License项支持用户IP地址和位置关联功能已打开。
步骤 :执行[SET MMEIPLOC]命令，设置MME IP地址和位置关联配置。
执行[ADD TAGROUP RULE]命令，新增TA编组规则配置。
执行[ADD TAGROUP]命令，新增位置IP关联TA编组配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数|取值
---|---|---
MME IP地址和位置关联配置|位置IP关联功能是否去连接IMS PDN|否
支持IMS呼叫跨区延时下线|MME IP地址和位置关联配置|支持
TA编组规则配置|TA编组规则标识|1
TA编组是否支持用户IP地址和位置关联|TA编组规则配置|否
MME位置IP关联功能是否限制国际漫游用户|TA编组规则配置|否
MME位置IP关联功能是否限制国内漫游用户|TA编组规则配置|同非漫游用户处理
MME由于位置IP关联功能拒绝国际漫游用户接入的原因值|TA编组规则配置|该跟踪区无合适小区
MME由于位置IP关联功能拒绝国内漫游用户接入的原因值|TA编组规则配置|该跟踪区无合适小区
用户别名|TA编组规则配置|Rule1
位置IP关联TA编组配置|位置IP关联TA编组编号|1
跟踪区|位置IP关联TA编组配置|"460"-"00"-"4632"
编组别名|位置IP关联TA编组配置|TA1
TA编组规则标识|位置IP关联TA编组配置|1
根据规划，进行如下配置。 
设置MME IP地址和位置关联配置，命令如下。 
[SET MMEIPLOC]:IFOFFIMSSESS="NO",SUPIMSDELAYDIS="YES"
新增TA编组规则配置，命令如下。 
[ADD TAGROUP RULE]:RULEID=1,TAGROUPIPLOC="NO",IMPACTINTERROAM="NO",IMPACTINTRAROAM="SAMENOTROAM",MLMTINTERCAUSE="NoCellInTA",MLMTINTRACAUSE="NoCellInTA",NAME="rule1"
新增位置IP关联TA编组配置，命令如下。 
[ADD TAGROUP]:GROUPID=1,NAME="TA1",RULEID=1,TAI="460"-"00"-"4632"
#### 优化配置 
##### 配置GUTI重分配 
摘要 :本节介绍如何配置GUTI重分配。 
步骤 :执行[SET MME GUTI REALLOC GLB]命令，配置MME GUTI重分配全局参数。
执行[SET MME GUTI REALLOC DFT]命令，配置MME GUTI重分配缺省配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME GUTI重分配全局参数配置|功能开关|开启
MME GUTI重分配缺省配置|附着模式|系统判断
正常TAU模式|MME GUTI重分配缺省配置|集中按比例
正常TAU周期频次|MME GUTI重分配缺省配置|100
正常TAU选中频次|MME GUTI重分配缺省配置|100
周期TAU模式|MME GUTI重分配缺省配置|集中按比例
周期TAU周期频次|MME GUTI重分配缺省配置|100
周期TAU选中频次|MME GUTI重分配缺省配置|100
其他流程模式|MME GUTI重分配缺省配置|系统判断
根据规划，进行如下配置。 
配置MME GUTI重分配全局参数，命令如下。 
[SET MME GUTI REALLOC GLB]:FLAG="OPEN"
配置MME GUTI重分配缺省配置，命令如下。 
[SET MME GUTI REALLOC DFT]:ATTMODE="SYSTEMD",NTAUMODE="GROUPR",NTAUCIRNUM=100,NTAUSELNUM=100,PTAUMODE="GROUPR",PTAUCIRNUM=100,PTAUSELNUM=100,OTHMODE="SYSTEMD"
##### 配置原因值映射 
摘要 :本节介绍如何进行原因值映射配置。 
步骤 :执行[SET DIAMERR EMM]命令，配置S6a错误码到EMM原因值的转换。
执行[SET MAPERR GMM]命令，配置MAP错误码到GMM原因值的映射。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
S6a错误码到EMM原因值的转换配置|S6a错误码|HSS time out、HSS Office Unreachable、DIAMETER_UNABLE_TO_DELIVER (3002)、DIAMETER_REALM_NOT_SERVED (3003)
EMM原因值|S6a错误码到EMM原因值的转换配置|Protocol error, unspecified
是否携带扩展EMM原因|S6a错误码到EMM原因值的转换配置|不携带
MAP错误码到GMM原因值的映射配置|MAP错误码|MAP procedure error or provider error
GMM原因值|MAP错误码到GMM原因值的映射配置|Network failure
根据规划，进行如下配置。 
配置S6a错误码到EMM原因值的转换，命令如下。 
[SET DIAMERR EMM]:DIAMERR="HSS_TIME_OUT",EMMCAUSE="Protocol error, unspecified",EXEMMCAUSE="NOTCARRY"
[SET DIAMERR EMM]:DIAMERR="HSS_OFFICE_UNREACHABLE",EMMCAUSE="Protocol error, unspecified",EXEMMCAUSE="NOTCARRY"
[SET DIAMERR EMM]:DIAMERR="S6_ERRORCODE_32",EMMCAUSE="Protocol error, unspecified",EXEMMCAUSE="NOTCARRY"
[SET DIAMERR EMM]:DIAMERR="S6_ERRORCODE_33",EMMCAUSE="Protocol error, unspecified",EXEMMCAUSE="NOTCARRY"
配置MAP错误码到GMM原因值的映射，命令如下。 
[SET MAPERR GMM]:MAPERR="MAPPROC_PROVIDER_ERR",GMMCAUSE="NETFAIL"
##### 配置流控 
摘要 :本节介绍如何进行流控配置。 
步骤 :执行[SET SERVICE CONTROL]命令，设置SGSN通用业务控制。
执行[SET SGSN AUTO CNGCTL]命令，配置SGSN自动业务控制策略。
执行[SET MME SERVICE CONTROL]命令，配置MME通用业务控制。
执行[SET MME AUTO CNGCTL]命令，设置S6a接口局向统一ALC业务流控策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数|取值
---|---|---
SGSN通用业务控制配置|每实例每秒通过附着业务个数|300
SGSN自动业务控制策略配置|是否开启|是
触发拥塞的接入业务通过数量(单模块每秒)|SGSN自动业务控制策略配置|20
允许通过的接入业务最大数量(单模块每秒)|SGSN自动业务控制策略配置|60
触发拥塞的HLR业务成功率(%)|SGSN自动业务控制策略配置|85
接入业务控制步长|SGSN自动业务控制策略配置|4
控制持续时间(分钟)|SGSN自动业务控制策略配置|5
MME通用业务控制配置|每实例每秒通过附着业务个数|300
S6a统一ALC流控策略配置|是否开启|是
触发拥塞的接入业务通过数量(单模块每秒)|S6a统一ALC流控策略配置|20
初始限制的接入业务最大数量(单模块每秒)|S6a统一ALC流控策略配置|50
允许通过的接入业务最大数量(单模块每秒)|S6a统一ALC流控策略配置|300
触发拥塞的HSS业务成功率(%)|S6a统一ALC流控策略配置|90
接入业务控制步长|S6a统一ALC流控策略配置|3
控制持续时间(分钟)|S6a统一ALC流控策略配置|5
根据规划，进行如下配置。 
配置SGSN通用业务控制，命令如下。 
[SET SERVICE CONTROL]:ATTNUM=300
配置SGSN自动业务控制策略，命令如下。 
[SET SGSN AUTO CNGCTL]:FLG="YES",STARTCAPS=20,MAXCAPS=60,SUCCRATE=85,STEP=4,LASTTIME=5
配置MME通用业务控制，命令如下。 
[SET MME SERVICE CONTROL]:ATTNUM=300
设置S6a接口局向统一ALC业务流控策略，命令如下。 
[SET MME AUTO CNGCTL]:FLG="YES",STARTCAPS=20,LIMTCAPS=50,MAXCAPS=300,SUCCRATE=90,STEP=3,LASTTIME=5
##### 配置自动备份 
摘要 :本节介绍如何进行自动备份配置。 
步骤 :执行[ADD AUTO STRATEGY]命令，增加自动备份策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
自动备份策略|自动备份任务编号|1|2|3|4|5|6
自动备份任务名称|自动备份策略|BASICCM|IPSTACK|SECDATA|LOGDATA|DBFILE|NFSDATA
备份文件名称|自动备份策略|BASICCM|IPSTACK|SECDATA|LOGDATA|DBFILE|NFSDATA
备份对象|自动备份策略|1|2|3|4|5|6
策略时间类型|自动备份策略|每日|每日|每日|每日|每日|每日
策略启动时间|自动备份策略|02:00|02:10|02:20|02:30|02:40|02:50
根据规划，进行如下配置。 
增加自动备份策略，命令如下。 
[ADD AUTO STRATEGY]:ID=1,NAME="BASICCM",BASEFILENAME="BASICCM",SETID="1",TIMETYPE="DAY",TIME="02:00"
[ADD AUTO STRATEGY]:ID=2,NAME="IPSTACK",BASEFILENAME="IPSTACK",SETID="2",TIMETYPE="DAY",TIME="02:10"
[ADD AUTO STRATEGY]:ID=3,NAME="SECDATA",BASEFILENAME="SECDATA",SETID="3",TIMETYPE="DAY",TIME="02:20"
[ADD AUTO STRATEGY]:ID=4,NAME="LOGDATA",BASEFILENAME="LOGDATA",SETID="4",TIMETYPE="DAY",TIME="02:30"
[ADD AUTO STRATEGY]:ID=5,NAME="DBFILE",BASEFILENAME="DBFILE",SETID="5",TIMETYPE="DAY",TIME="02:40"
[ADD AUTO STRATEGY]:ID=6,NAME="NFSDATA",BASEFILENAME="NFSDATA",SETID="6",TIMETYPE="DAY",TIME="02:50"
#### 性能统计配置 
##### 配置基于MME与SGW间控制面链路的统计 
摘要 :本节介绍对MME与SGW间控制面链路的性能统计的配置方法。 
步骤 :执行[ADD MMESGWLINK]命令，添加MME与SGW控制面链路。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME与SGW链路配置|链路编号|1
MME地址|MME与SGW链路配置|223.103.77.128
SGW地址|MME与SGW链路配置|223.103.131.4
类型|MME与SGW链路配置|S11-C
用户别名|MME与SGW链路配置|SAEGWC1
根据规划，进行如下配置。 
添加MME与SGW控制面链路，命令如下。 
[ADD MMESGWLINK]:LINKID=1,SRCADDR="223.103.77.128",DESTADDR="223.103.131.4",TYPE="S11-C",NAME="SAEGWC1"
##### 配置基于MME与SGW间用户面链路的统计 
摘要 :本节介绍对MME与SGW间用户面链路的性能统计的配置方法。 
步骤 :执行[ADD MMESGWLINK]命令，新增MME与SGW用户面链路。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME与SGW链路配置|链路编号|1
MME地址|MME与SGW链路配置|223.103.77.128
SGW地址|MME与SGW链路配置|223.103.131.4
类型|MME与SGW链路配置|S11-U
用户别名|MME与SGW链路配置|S11-U
根据规划，进行如下配置。 
新增MME与SGW用户面链路，命令如下。 
[ADD MMESGWLINK]:LINKID=1,SRCADDR="223.103.77.128",DESTADDR="223.103.131.4",TYPE="S11-U",NAME="S11-U"
##### 配置基于IMSI号段的统计 
摘要 :本节介绍对IMSI号码段用户数进行统计的方法。 
步骤 :执行[ADD IMSI]命令，新增IMSI号码段用于性能统计。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
IMSI号段配置|IMSI编号|1|2|3|4|5|6
IMSI号段|IMSI号段配置|46000|46002|46004|46007|46008|46013
用户别名|IMSI号段配置|46000|46002|46004|46007|46008|46013
根据规划，进行如下配置。 
新增IMSI号码段，命令如下。 
[ADD IMSI]:ID=1,IMSI="46000",NAME="46000"
[ADD IMSI]:ID=2,IMSI="46002",NAME="46002"
[ADD IMSI]:ID=3,IMSI="46004",NAME="46004"
[ADD IMSI]:ID=4,IMSI="46007",NAME="46007"
[ADD IMSI]:ID=5,IMSI="46008",NAME="46008"
[ADD IMSI]:ID=6,IMSI="46013",NAME="46013"
##### 配置基于MSISDN号段的统计 
摘要 :本节介绍对MSISDN号码段用户数进行统计的方法。 
步骤 :执行[ADD MSISDN]命令，新增MSISDN号码段用于性能统计。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MSISDN号段配置|MSISDN编号|1
MSISDN号段|MSISDN号段配置|861XX
根据规划，进行如下配置。 
新增MSISDN号码段，命令如下。 
[ADD MSISDN]:ID=1,MSISDN="861XX"
##### 配置基于APN的统计 
摘要 :本节介绍根据APN进行性能统计时的配置方法。 
步骤 :执行[SET APN MODE]命令，配置系统支持的APN统计格式。
执行[ADD APN STATIS]命令，配置基于APN进行性能统计的测量对象。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
APN方式配置|APN方式|NI|NI
APN配置|APN名称|cmnet|ims
根据规划，进行如下配置。 
配置系统支持的APN统计格式，命令如下。 
[SET APN MODE]:MODE="NI"
配置基于APN进行性能统计的测量对象，命令如下。 
[ADD APN STATIS]:APNNAME="cmnet"
[ADD APN STATIS]:APNNAME="ims"
##### 配置测量类型对象数 
摘要 :本节介绍如何配置测量类型对象数。 
该配置用来控制系统支持的测量类型所对应的对象容量，可以针对不同的测量类型设置不同的对象容量。 
步骤 :执行[ADD POOBJNUMCFG]命令，新增测量类型对象数配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
测量类型对象数配置|测量类型标识|40562~40565
容量|测量类型对象数配置|500
根据规划，进行如下配置。 
新增测量类型对象数配置，命令如下。 
[ADD POOBJNUMCFG]:POID=40562,CAPACITY=500
[ADD POOBJNUMCFG]:POID=40563,CAPACITY=500
[ADD POOBJNUMCFG]:POID=40564,CAPACITY=500
[ADD POOBJNUMCFG]:POID=40565,CAPACITY=500
### AMF业务配置 
#### 业务基础配置 
##### 配置本局信息 
摘要 :本节介绍如何进行本局基础信息配置。 
步骤 :AMF NRI配置
执行[ADD AMFNRI]命令，配置增加AMF资源标识。
全局配置
执行[SET AMFLOCALOFFICECFG]命令，修改AMF本局配置。
NF实例ID配置
执行[ADD NF]命令，增加一个NF类型。
网元标识配置
执行[ADD GUAMICFG]命令，进行GUAMI配置。
执行[ADD LOCALGUAMI]命令，配置增加AMF的本局GUAMI标识。
本局其他PLMN配置
执行[ADD PLMNCFG]命令，进行PLMN配置。
增加对端PLMN配置
执行[ADD DEFAULTEPLMN]命令，配置本AMF默认的EPLMN。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
AMF资源标识配置|AMF名称|amfc01.amfsi003.amfri06.amf.5gc.mnc000.mcc460.3 gppnetwork.org|与全局配置中的AMF名称规划保持一致。
AMF资源标识|AMF资源标识配置|1|取AMF名称中amfcxx的xx值，转为十进制格式。
全局配置|移动国家码|460|-
移动网络码|全局配置|00|-
AMF名称|全局配置|amfc01.amfsi003.amfri06.amf.5gc.mnc000.mcc460.3gppnetwork.org|根据运营商规范配置。AMF Name FQDN的格式为.amf.5gc.mnc.mcc.3gppnetwork.org。推荐格式设置为：amfcxx.amfsiyyy.amfrizz。其中，xx取GUAMI中pt值，yyy取GUAMI中set值，zz取region值，采用十六进制描述。
AMF权重因子|全局配置|100|-
优先级|全局配置|1|根据运营商规范配置。AMF POOL中进行负荷分担的各AMF优先级保持一致，建议配置为1。
优先级是否有效|全局配置|是|-
容量|全局配置|1000|建议使用默认配置1000。
容量值是否有效|全局配置|是|-
位置信息|全局配置|JS.NJ.DC1|配置运营商规划的region+province值。若运营商没有规划，则无需配置。
位置信息是否有效|全局配置|是|-
跨PLMN FQDN|全局配置|amfc01.amfsi003.amfri06.amf.5gc.mnc000.mcc460.3gppnetwork. org|与AMF名称保存一致。
跨PLMN FQDN是否有效|全局配置|是|-
NF管理|NF类型|NONE|固定配置为NONE。
NF类型别名|NF管理|AMF|-
NFID Node|NF管理|030280000001|根据运营商编码要求配置。对于运营商未明确定义的字节，需要确保每个AMF不一致。
GUAMI池配置|GUAMI标识|1|与Pt标识保持一致，配置为十进制。
移动国家码|GUAMI池配置|460|-
移动网络码|GUAMI池配置|00|-
Region标识|GUAMI池配置|6|运营商规划，配置为十进制。
Set标识|GUAMI池配置|3|运营商规划，配置为十进制。
Point标识|GUAMI池配置|1|运营商规划，配置为十进制。
本局GUAMI配置|Guami标识|1|-
AMF其他PLMN配置|PLMN标识|1、2、3、4、5|-
移动国家码|AMF其他PLMN配置|460|-
移动网络码|AMF其他PLMN配置|02、04、07、08、13|-
默认EPLMN配置|EPLMN标识|1、2、3、4、5|-
移动国家码|默认EPLMN配置|460|-
移动网络码|默认EPLMN配置|02、04、07、08、13|-
根据规划，进行如下配置。 
配置增加AMF资源标识，命令如下。 
[ADD AMFNRI]:AMFNAME="amfc01.amfsi003.amfri06.amf.5gc.mnc000.mcc460.3 gppnetwork.org",AMFNRI=1
修改AMF本局配置，命令如下。 
[SET AMFLOCALOFFICECFG]:MCC="460",MNC="00",AMFNAME="amfc01.amfsi003.amfri06.amf.5gc.mnc000.mcc460.3gppnetwork.org",RELATIVEAMFCAPACITY=100,PRIORITY=1,PRIORITYFLG="ISVALID",CAPACITY=1000,CAPACITYFLG="ISVALID",LOCALITY="JS.NJ.DC1",LOCALITYFLG="ISVALID",INTERPLMNFQDN="amfc01.amfsi003.amfri06.amf.5gc.mnc000.mcc460.3gppnetwork. org",INTERPLMNFQDNFLG="ISVALID"
增加一个NF类型，命令如下。 
[ADD NF]:NFTYPE="NONE",ALIASNFTYPE="AMF",NFIDNODE="030280000001"
进行GUAMI配置，命令如下。
[ADD GUAMICFG]:GUAMIID=1,MCC="460",MNC="00",REGIONID=6,SETID=3,POINTID=1
配置增加AMF的本局GUAMI标识，命令如下。
[ADD LOCALGUAMI]:GUAMIID=1
增加本局其他PLMN配置，命令如下。 
[ADD PLMNCFG]:PLMNID=1,MCC="460",MNC="02"
[ADD PLMNCFG]:PLMNID=2,MCC="460",MNC="04"
[ADD PLMNCFG]:PLMNID=3,MCC="460",MNC="07"
[ADD PLMNCFG]:PLMNID=4,MCC="460",MNC="08"
[ADD PLMNCFG]:PLMNID=5,MCC="460",MNC="13"
增加对端EPLMN配置，命令如下。
[ADD DEFAULTEPLMN]:EPLMNID=1,MCC="460",MNC="02"
[ADD DEFAULTEPLMN]:EPLMNID=2,MCC="460",MNC="04"
[ADD DEFAULTEPLMN]:EPLMNID=3,MCC="460",MNC="07"
[ADD DEFAULTEPLMN]:EPLMNID=4,MCC="460",MNC="08"
[ADD DEFAULTEPLMN]:EPLMNID=5,MCC="460",MNC="13"
##### 配置AMF和MME融合模式 
摘要 :本节介绍AMF与MME的融合模式配置。 
步骤 :执行[SET CONVERGENCECFG]命令，设置AMF和MME的融合模式。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
融合模式配置|融合模式|合一模式
根据规划，进行如下配置。 
配置融合模式为合一模式，命令如下。 
SET CONVERGENCECFG:MODE="CONVERGENCE" 
##### 配置GUMMEI 
摘要 :本节介绍与AMF融合的MME的GUMMEI配置。
步骤 :执行[ADD GUMMEICFG]命令，配置与AMF融合的MME的GUMMEI信息。
 说明： 
当AMF和MME的GTP-C地址不同，且MME不支持使用AMF-FQDN格式查询AMF的GTP-C地址时，此处配置的GUMMEI不能和AMF的GUAMI映射的GUMMEI相同。 
当AMF和MME的GTP-C地址相同时，此处配置的GUMMEI可以和AMF的GUAMI映射的GUMMEI相同，也可以不同。 
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
GUMMEI配置|GUMMEI标识|1|自定义
移动国家码|GUMMEI配置|460|和本局MME的移动数据配置一致
移动网络码|GUMMEI配置|00|和本局MME的移动数据配置一致
MME组ID|GUMMEI配置|32849|和本局MME的移动数据配置一致
MME编号|GUMMEI配置|1|和本局MME的移动数据配置一致
根据规划，进行如下配置。 
配置与AMF融合的MME的GUMMEI信息，命令如下。 
[ADD GUMMEICFG]:GUMMEIID=1,MCC="460",MNC="00",MMEGROUPID=32849,MMECODE=1
##### 配置AMF和MME融合时的TAC 
摘要 :本节介绍AMF和MME融合时TAC相关的配置。 
如果不执行本节的配置，那么融合局内切换时将会执行DNS查询域名流程。 
步骤 :执行[ADD MMETACFG]命令，配置AMF和MME合一部署时，本融合局所管理的MME的TAI。
执行[ADD AMFTACFG]命令，配置AMF和MME合一部署时，本融合局所管理的AMF的TAI。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MME TAC配置|跟踪区标识|1
移动国家码|MME TAC配置|460
移动网络码|MME TAC配置|00
跟踪区码|MME TAC配置|0001
AMF TAC配置|跟踪区标识|1
移动国家码|AMF TAC配置|460
移动网络码|AMF TAC配置|00
跟踪区码|AMF TAC配置|000001
跟踪区名称|AMF TAC配置|Tac01
根据规划，进行如下配置。 
配置MME TAC，命令如下。 
[ADD MMETACFG]:TAID="1",MCC="460",MNC="00",TAC="0001"
配置AMF TAC，命令如下。 
[ADD AMFTACFG]:TAID="1",MCC="460",MNC="00",TAC="000001",NAME="tac01"
##### 配置AMF和MME融合局的网管参数 
摘要 :本节介绍AMF和MME融合局涉及到的网管参数的配置方法。 
步骤 :执行[SET SYSPARA]命令，配置网管参数。
执行[RESET VRU]命令，重启主备OAM容器。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
系统参数管理|参数编号|100300|200012|200013|200200|200201|200406
参数值|系统参数管理|1|10000|30000|10000|2000|16
VRU管理|VRU名称|vru-oam-main-1（主用）|vru-oam-main-0（备用）|vru-oam-main-1（主用）|vru-oam-main-0（备用）|vru-oam-main-0（备用）|vru-oam-main-1（主用）
根据规划，进行如下配置。 
打开MML命令执行后提示功能，命令如下。 
[SET SYSPARA]:NO=100300,VALUE="1"
设置8k UB个数，命令如下。 
[SET SYSPARA]:NO=200012,VALUE="10000"
设置状态机邮箱个数，命令如下。 
[SET SYSPARA]:NO=200013,VALUE="30000"
设置16k UB个数，命令如下。 
[SET SYSPARA]:NO=200200,VALUE="10000"
设置32k UB个数，命令如下。 
[SET SYSPARA]:NO=200201,VALUE="2000"
设置性能数据包大小，命令如下。 
[SET SYSPARA]:NO=200406,VALUE="16"
重启OAM，待主用OAM容器成功后，再重启备用OAM容器，命令如下。 
[RESET VRU]:VRUNAME="vru-oam-main-1"
[RESET VRU]:VRUNAME="vru-oam-main-0"
##### 配置切片功能 
摘要 :本节介绍AMF的切片功能配置。 
步骤 :执行[SET AMFSUPPOTSLICESELECT]命令，配置AMF开启支持网络切片选择功能。
执行[ADD AMFSNSSAI]命令，增加本AMF的S-NSSAI。
执行[SET EMERGSRVSNSSAI]命令，设置紧急业务[S-NSSAI]
。
执行[SET INTERWORKINGSNSSAI]命令，配置紧急呼叫切片。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数|取值
---|---|---
网络切片策略配置|本地有Allowed NSSAI时AMF是否被允许确定是否可以为该UE服务|支持切片选择|支持切片选择
本地无Allowed NSSAI时AMF是否被允许确定是否可以为该UE服务|网络切片策略配置|支持切片选择|支持切片选择
PDU会话建立支持切片选择|网络切片策略配置|不支持切片选择|不支持切片选择
是否支持注册拒绝携带reject NSSAI|网络切片策略配置|不支持注册拒绝携带RejectNssai|不支持注册拒绝携带RejectNssai
AMF支持的S-NSSAI配置|S-NSSAI标识|2CeMBB|2CeMBB
SST|AMF支持的S-NSSAI配置|1-eMBB|1-eMBB
SD|AMF支持的S-NSSAI配置|NULL（用于中国移动）|000000（用于中国电信、中国联通）
紧急业务S-NSSAI配置|紧急业务SST|1-eMBB|1-eMBB
紧急业务SD|紧急业务S-NSSAI配置|NULL（用于中国移动）|000000（用于中国电信、中国联通）
互操作的S-NSSAI配置|SST|1-eMBB|1-eMBB
SD|互操作的S-NSSAI配置|NULL（用于中国移动）|000000（用于中国电信、中国联通）
根据规划，进行如下配置。 
配置AMF开启支持网络切片选择功能，命令如下。 
[SET AMFSUPPOTSLICESELECT]:IFSERVEUEWITHALLOWED="AMFSUPTSLICESELECT",IFSERVEUEWITHOUT="AMFSUPTSLICESELECT",PDUSUPSLICESELECT="AMFNOTSUPTSLICESELECT",REGREJCARRYREJNSSAI="NOTCARRYREJECTNSSAIINREGREJ"
配置增加本AMF的S-NSSAI。 
如果是中国移动时，命令如下。ADD AMFSNSSAI:SNSSAINAME="2CeMBB",SST="eMBB",SD="NULL" 
如果是中国电信或中国联通时，命令如下。ADD AMFSNSSAI:SNSSAINAME="2CeMBB",SST="eMBB",SD="000000" 
配置互紧急业务S-NSSAI。 
如果是中国移动时，命令如下。SET EMERGSRVSNSSAI:EMGSST="eMBB",EMGSD="NULL" 
如果是中国电信或中国联通时，命令如下。SET EMERGSRVSNSSAI:EMGSST="eMBB",EMGSD="000000" 
设置互操作的S-NSSAI。 
如果是中国移动时，命令如下。SET INTERWORKINGSNSSAI:SST="eMBB",SD="NULL" 
如果是中国电信或中国联通时，命令如下。SET INTERWORKINGSNSSAI:SST="eMBB",SD="000000" 
##### 配置HTTP模板 
摘要 :本节介绍如何配置HTTP客户端模板和HTTP服务端模板。 
步骤 :执行[ADD CLIENTPROFILE]命令，配置客户端模板。
执行[SET DEFAULTHTTPCLIENTID]命令，配置默认HTTP client模板ID。
执行[ADD SERVERPROFILE]命令，配置服务端模板。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
客户端模板配置|编号|1|2|-
IP地址|客户端模板配置|2409:802F:5003:1715::1101:101|10.124.17.80|客户端地址和服务端地址合一。
起始端口|客户端模板配置|10000|10000|根据规划配置，建议配置为10000。
终止端口|客户端模板配置|60000|60000|根据规划配置，建议配置为60000。
VPN ID|客户端模板配置|14|14|配置为SBI接口的VPNID。
链路数量|客户端模板配置|1|1|-
接收响应消息体最大长度(字节）|客户端模板配置|2097152|2097152|必须配置为2097152。
HTTP版本|客户端模板配置|HTTP 2|HTTP 2|-
默认HTTP客户端模板标识配置|缺省支持http与Ipv4的客户端模板ID|2|-|2
缺省支持http与Ipv6的客户端模板ID|默认HTTP客户端模板标识配置|1|-|1
服务端模板配置|编号|1|2|-
IP地址|服务端模板配置|2409:802F:5003:1715::1101:101|10.124.17.80|客户端地址和服务端地址合一。
端口|服务端模板配置|80|80|根据运营商规划配置，建议为8080。
VPN ID|服务端模板配置|14|14|配置为SBI接口的VPNID。
接收响应消息体最大长度(字节）|服务端模板配置|2097152|2097152|必须配置为2097152。
HTTP版本|服务端模板配置|HTTP 2|HTTP 2|-
根据规划，进行如下配置。 
配置客户端模板，命令如下。 
[ADD CLIENTPROFILE]:ID=1,IPADDR="2409:802F:5003:1715::1101:101",STARTPORT=10000,ENDPORT=60000,VPNID=14,CONNNUM=1,RESPBODYMAXLENGTH=2097152,HTTPVERSION="HTTP_2"
[ADD CLIENTPROFILE]:ID=2,IPADDR=10.124.17.80,STARTPORT=10000,ENDPORT=60000, VPNID=14,CONNNUM=1,RESPBODYMAXLENGTH=2097152, HTTPVERSION="HTTP_2"
配置默认HTTP客户端模板标识，命令如下。 
[SET DEFAULTHTTPCLIENTID]:DEFAULTHTTPIPV4ID=2,DEFAULTHTTPIPV6ID=1
配置服务端模板，命令如下。 
[ADD SERVERPROFILE]:ID=1,IPADDR=2409:802F:5003:1715::1101:101,PORT=80, VPNID=14,REQBODYMAXLENGTH=2097152,HTTPVERSION="HTTP_2"
[ADD SERVERPROFILE]:ID=2,IPADDR=10.124.17.80,PORT=80,VPNID=14, REQBODYMAXLENGTH=2097152,HTTPVERSION="HTTP_2"
##### 配置服务 
摘要 :本节用于配置AMF支持的服务。 
步骤 :执行[ADD SERVICECFG]命令，配置新增AMF支持的服务类型，以及设置为该服务类型的HTTP服务端时的IP地址类型、版本号、优先级等信息。
执行[ADD ASSOCIATED HTTPSERVERPROFILEID]命令，配置指定类型的AMF Service作为HTTP服务端时关联的HTTP服务端模板。
执行[SET NFADDRCHOICEPOLICYCFG]命令，配置NF的IP地址类型选择策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值
---|---|---
SERVICE基本配置|服务类型|namf-comm、namf-evts、namf-mt、namf-loc
URI版本号|SERVICE基本配置|1
作为服务端IP地址类型|SERVICE基本配置|IPV6
优先级|SERVICE基本配置|根据运营商规范配置。1
优先级是否有效|SERVICE基本配置|是
容量|SERVICE基本配置|1000
容量值是否有效|SERVICE基本配置|是
SERVICE关联HTTP服务端模板配置|服务类型|namf-comm、namf-evts、namf-mt、namf-loc
关联的HTTP服务端模板ID|SERVICE关联HTTP服务端模板配置|1/2（所有服务类型都配置1和2的ID）
地址类型选择策略配置|SMF地址选择策略|优选IPV6
PCF地址选择策略|地址类型选择策略配置|优选IPV6
UDM地址选择策略|地址类型选择策略配置|优选IPV6
AUSF地址选择策略|地址类型选择策略配置|优选IPV6
AMF地址选择策略|地址类型选择策略配置|优选IPV6
SMSF地址选择策略|地址类型选择策略配置|优选IPV6
NSSF地址选择策略|地址类型选择策略配置|优选IPV6
根据规划，进行如下配置。 
配置新增AMF支持的服务类型，以及设置为该服务类型的HTTP服务端时的IP地址类型、版本号、优先级等信息，命令如下。 
如需提供支持IPv4地址类型服务，把IP地址类型设置为IPV4即可。 
[ADD SERVICECFG]:SERVICETYPE="COMMUNICATION",VERSION=1,IPADDRTYPE="IPV6", PRIORITY=1,PRIORITYFLG="ISVALID",CAPACITY=1000,CAPACITYFLG="ISVALID"
[ADD SERVICECFG]:SERVICETYPE="EVENTEXPOSURE",VERSION=1,IPADDRTYPE="IPV6", PRIORITY=1,PRIORITYFLG="ISVALID",CAPACITY=1000,CAPACITYFLG="ISVALID"
[ADD SERVICECFG]:SERVICETYPE="MT",VERSION=1,IPADDRTYPE="IPV6",PRIORITY=1, PRIORITYFLG="ISVALID",CAPACITY=1000,CAPACITYFLG="ISVALID"
[ADD SERVICECFG]:SERVICETYPE="LOCATION",VERSION=1,IPADDRTYPE="IPV6",PRIORITY=1, PRIORITYFLG="ISVALID",CAPACITY=1000,CAPACITYFLG="ISVALID"
配置指定类型的AMF Service作为HTTP服务端时关联的HTTP服务端模板，命令如下。 
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="COMMUNICATION", HTTPSERVERPROFILEID=1
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="COMMUNICATION", HTTPSERVERPROFILEID=2
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="EVENTEXPOSURE", HTTPSERVERPROFILEID=1
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="EVENTEXPOSURE", HTTPSERVERPROFILEID=2
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="MT",HTTPSERVERPROFILEID=1
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="MT",HTTPSERVERPROFILEID=2
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="LOCATION",HTTPSERVERPROFILEID=1
[ADD ASSOCIATED HTTPSERVERPROFILEID]:SERVICETYPE="LOCATION",HTTPSERVERPROFILEID=2
配置NF的IP地址类型选择策略，命令如下。 
[SET NFADDRCHOICEPOLICYCFG]:SMFADDRCHOICEPOLICY="IPV6",PCFADDRCHOICEPOLICY="IPV6",UDMADDRCHOICEPOLICY="IPV6",AUSFADDRCHOICEPOLICY="IPV6",AMFADDRCHOICEPOLICY="IPV6",SMSFADDRCHOICEPOLICY="IPV6",NSSFADDRCHOICEPOLICY="IPV6"
##### 配置AMF GTP-C地址 
摘要 :本节介绍AMF GTP-C地址的配置。
AMF的GTP-C地址，适用在Interworking with N26场景下，在N26接口上AMF使用此地址和MME进行通信。 
 说明： 
如果是中国移动项目的融合AMF/MME/SGSN局时，AMF GTPC和MME/SGSN GTPC地址需要相同。 
步骤 :执行[SET AMFGTPCADDRCFG]命令，配置AMF在N26接口上的GTP-C地址和归属的VRF。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
AMF GTPC地址配置|AMF GTPC IPV4地址|223.103.77.129
AMF GTPC IPV6地址|AMF GTPC地址配置|2409:802F:2905:0701::04:102
AMF N26 VRF|AMF GTPC地址配置|8
根据规划，进行如下配置。 
配置AMF的GTP-C地址，命令如下。 
[SET AMFGTPCADDRCFG]:AMFGTPCIPV4ADDRESS="223.103.77.129",AMFGTPCIPV6ADDRESS="2409:802F:2905:0701::04:102",AMFN26VRF=8
#### 业务接口配置 
##### 配置N2接口信息 
摘要 :本节介绍如何配置N2接口信息。 
步骤 :执行[ADD SCTP]命令，配置新增SCTP偶联。
执行[ADD N2SCTPIDCFG]命令，配置新增AMF的SCTP ID。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值|说明
---|---|---|---
SCTP偶联配置|SCTP标识|1|2|-
别名|SCTP偶联配置|AMF01SCTPIPV4|AMF01SCTPIPV6|-
本端端口|SCTP偶联配置|38412|38412|建议配置为38412。
VPNID1|SCTP偶联配置|9|9|采用N2接口规划的VRF ID。
本端IP地址1|SCTP偶联配置|10.124.108.64|2409:802F:5015:1715::1101:101|如果运营商要求配置偶联为多归属，那么需要配置本端IP地址1和本端IP地址2。如果偶联不配置为多归属，那么仅配置一个IP地址即可。
VPNID2|SCTP偶联配置|9|9|采用N2接口规划的VRF ID。
本端IP地址2|SCTP偶联配置|10.124.108.65|2409:802F:5015:1715::1101:101|-
应用属性|SCTP偶联配置|服务端|服务端|-
应用协议类型|SCTP偶联配置|N2AP|N2AP|固定配置为N2AP。
交叉建链属性|SCTP偶联配置|开启|开启|建议配置为开启。
单偶联通路断告警属性|SCTP偶联配置|关闭通路断告警|关闭通路断告警|建议配置为关闭通路断告警。
SCTP ID配置|Sctp偶联标识|1|2|-
根据规划，进行如下配置。 
配置新增SCTP偶联，命令如下。 
[ADD SCTP]:ID=1,NAME="AMF01SCTPIPV4",LOCPORT=38412,VPNID1=9,LOCADDR1="10.124.108.64",VPNID2=9,LOCADDR2="10.124.108.65",ROLE="SVR",CROSSLINK="OPEN",SCTPALARM="NOT_REPORT_ALARM",PROTOCALTYPE="N2AP"
[ADD SCTP]:ID=2,NAME="AMF01SCTPIPV6",LOCPORT=38412,VPNID1=9,LOCADDR1="2409:802F:5015:1715::1101:101",VPNID2=9,LOCADDR2="2409:802F:5015:1715::1101:101",ROLE="SVR",CROSSLINK="OPEN",SCTPALARM="NOT_REPORT_ALARM",PROTOCALTYPE="N2AP"
配置新增AMF的SCTP ID，命令如下。 
[ADD N2SCTPIDCFG]:SCTPID=1
[ADD N2SCTPIDCFG]:SCTPID=2
##### 配置与NRF对接数据 
摘要 :本节介绍如何配置AMF与NRF对接的信息。 
步骤 :执行[SET NRFCLIENTCFG]命令，配置NRF查询方式，启用SBI-GW功能。
执行[ADD SBINRFGROUP]命令，配置NRF服务器分组。
执行[ADD SBINRFNODE]命令，配置NRF服务器节点。
执行[ADD SBINRFPOLICY]命令，配置NRF服务器策略。
执行[ADD SBINRFPROFILE]命令，配置NRF服务器模板。
执行[ADD SBINRFPROFILESEL]命令，配置NRF服务器模板选择。
执行[ADD SBIRESELECT]命令，新建重选配置。
支持[ADD SBISUBCOND]命令，新增订阅条件配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值
---|---|---
NRF Client配置|是否启用SBI-GW功能|是|是|是|是
NRF服务器分组配置|NRF服务器组编号|1、2|1、2|1、2|1、2
NRF服务器节点配置|NRF服务器节点编号|1|2|3|4
NRF服务器IP地址|NRF服务器节点配置|172.12.39.33|170.12.39.44|2408:8143:60FF:FA90:1:1:322:5|2408:8143:60FF:FA90:1:1:322:8
NRF服务器端口|NRF服务器节点配置|80|80|80|80
URI scheme|NRF服务器节点配置|HTTP|HTTP|HTTP|HTTP
API版本|NRF服务器节点配置|v1|v1|v1|v1
HTTP客户端模板编号|NRF服务器节点配置|1|1|2|2
通知时使用的HTTP服务端模板编号|NRF服务器节点配置|1|1|2|2
NRF服务器节点优先级|NRF服务器节点配置|2|2|1|1
归属的NRF服务器组编号|NRF服务器节点配置|1|2|1|2
NRF服务器策略配置|NRF服务器策略编号|1|1|1|1
NRF模式|NRF服务器策略配置|互备双活模式|互备双活模式|互备双活模式|互备双活模式
主用恢复后启用方式|NRF服务器策略配置|自动倒回|自动倒回|自动倒回|自动倒回
临时重定向次数|NRF服务器策略配置|2|2|2|2
主备不可用响应码|NRF服务器策略配置|420|420|420|420
主备间永久重定向响应码|NRF服务器策略配置|308|308|308|308
是否启用流控功能|NRF服务器策略配置|不启用|不启用|不启用|不启用
心跳间隔(秒)|NRF服务器策略配置|60|60|60|60
负载上报变化量阈值(%)|NRF服务器策略配置|5|5|5|5
NRF服务器模板配置|NRF服务器模板编号|1|1|1|1
NRF服务器策略编号|NRF服务器模板配置|1|1|1|1
主用NRF服务器组编号|NRF服务器模板配置|1|1|1|1
备用NRF服务器组编号|NRF服务器模板配置|2|2|2|2
检测方法|NRF服务器模板配置|HEARTBEAT|HEARTBEAT|HEARTBEAT|HEARTBEAT
检测使用的NF实例标识|NRF服务器模板配置|00000000-0000-0000-0000-000000000000|00000000-0000-0000-0000-000000000000|00000000-0000-0000-0000-000000000000|00000000-0000-0000-0000-000000000000
异常不可用检测次数|NRF服务器模板配置|5|5|5|5
可用检测次数|NRF服务器模板配置|3|3|3|3
检测间隔（秒）|NRF服务器模板配置|5|5|5|5
服务信息格式类型配置|NRF服务器模板配置|ARRAY|ARRAY|ARRAY|ARRAY
NRF服务器模板选择配置|NF类型|全部|全部|全部|全部
NRF服务器模板编号|NRF服务器模板选择配置|1|1|1|1
重选配置|目的NF类型|NRF|NRF|NRF|NRF
链路重选次数|重选配置|0|0|0|0
IP重选次数|重选配置|0|0|0|0
NF重选次数|重选配置|1|1|1|1
重选等待时长(秒)|重选配置|5|5|5|5
订阅条件配置|ID|1|1|1|1
目的NF类型|订阅条件配置|AMF|AMF|AMF|AMF
条件类型|订阅条件配置|AMF集|AMF集|AMF集|AMF集
条件值|订阅条件配置|{"amfRegionId":"56","amfSetId":"02A"}|{"amfRegionId":"56","amfSetId":"02A"}|{"amfRegionId":"56","amfSetId":"02A"}|{"amfRegionId":"56","amfSetId":"02A"}
事件类型|订阅条件配置|"EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"|"EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"|"EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"|"EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"
根据规划，进行如下配置。 
设置NRF查询方式，命令如下。 
[SET NRFCLIENTCFG]:SUPPORTSBIGWFLAG="ISVALID"
新增NRF服务器分组配置，命令如下。 
[ADD SBINRFGROUP]:ID=1
[ADD SBINRFGROUP]:ID=2
新增NRF服务器节点配置，命令如下。 
[ADD SBINRFNODE]:ID=1,SERVERIPADDR="172.12.39.33",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=2,GROUPID=1
[ADD SBINRFNODE]:ID=2,SERVERIPADDR="170.12.39.44",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=2,GROUPID=2
[ADD SBINRFNODE]:ID=3,SERVERIPADDR="2408:8143:60FF:FA90:1:1:322:5",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=2,NOTIFYSVRPROFILEID=2,PRIORITY=1,GROUPID=1
[ADD SBINRFNODE]:ID=4,SERVERIPADDR="2408:8143:60FF:FA90:1:1:322:8",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=2,NOTIFYSVRPROFILEID=2,PRIORITY=1,GROUPID=2
新增NRF服务器策略配置，命令如下。 
[ADD SBINRFPOLICY]:ID=1,NRFPATTERN="DUAL_ACTIVE",NRFENABLEMODE="AUTO_SWITCH",TRAFFICCONTROLFLAG="false",HEARTBEATINTERVAL=60,LOADREPORTTHRESHOLD=5
新增NRF服务器模板配置，命令如下。 
[ADD SBINRFPROFILE]:ID=1,POLICYID=1,ACTIVESRVGRPID=1,BAKSRVGRPID=2,DETECTMETHOD="DETECTBY_HEARTBEAT",INTERVAL=60,SERVICESFORMAT="FORMAT_ARRAY"
新增NRF服务器模板选择配置，命令如下。 
[ADD SBINRFPROFILESEL]:NFTYPE="ALL",NRFPROFILEID=1
新增重选配置，命令如下。 
[ADD SBIRESELECT]:TARGETNFTYPE="NRF_TYPE",LINKRESELTIMES=0,IPRESELECTIMES=0,NFRESELECTIMES=1,RESELECTTIME=5
新增订阅条件配置，命令如下。 
[ADD SBISUBCOND]:ID=1,TARGETNFTYPE="AMF_TYPE",CONDTYPE="COND_AMF",CONDVALUE="{\"amfRegionId\":\"56\",\"amfSetId\":\"02A\"}",EVENTTYPE="EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"
##### 配置与NSSF对接数据 
摘要 :本节介绍如何配置AMF与NSSF对接的信息。 
步骤 :执行[ADD NSSFLOCALADDRPOOL]命令，增加NSSF地址池配置。
执行[ADD NSSFPROFILECFG]命令，增加NSSF Prrofile配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
NSSF地址池配置|地址池标识|1|2|-
IP地址|NSSF地址池配置|183.26.3.5|183.26.3.6|-
端口号|NSSF地址池配置|80|80|-
NSSF地址解析配置|NSSF Profile标识|1|2|-
域名|NSSF地址解析配置|NSSFmaster|NSSFbackup|运营商规划的NSSF的FQDN名称。
地址池标识|NSSF地址解析配置|1|2|关联NSSF地址池配置中的地址池标识。
优先级|NSSF地址解析配置|1|2|优先级值越小表示优先级越高。主用NSSF设置的值小于备用NSSF设置的值。
权重|NSSF地址解析配置|200|200|-
URI scheme|NSSF地址解析配置|http|http|-
API版本|NSSF地址解析配置|v1|v1|-
根据规划，进行如下配置。 
增加NSSF地址池配置，命令如下。 
[ADD NSSFLOCALADDRPOOL]:ADDRPOOLID=1,IPADDRESS="183.26.3.5",PORT=80
[ADD NSSFLOCALADDRPOOL]:ADDRPOOLID=2,IPADDRESS="183.26.3.6",PORT=80
增加NSSF Profile配置，命令如下。 
[ADD NSSFPROFILECFG]:NSSFPROFILEID=1,HOST="NSSFmaster",IPADDRESSID=1,PRIORITY=1,WEIGHT=200,SCHEMA="HTTP",APIVERSION="V1"
[ADD NSSFPROFILECFG]:NSSFPROFILEID=2,HOST="NSSFbackup",IPADDRESSID=1,PRIORITY=1,WEIGHT=200,SCHEMA="HTTP",APIVERSION="V1"
##### 配置与DNS对接数据 
摘要 :本节介绍如何配置AMF与DNS对接的信息。 
步骤 :执行[ADD COMMU DNS SERVER]命令，增加DNS服务器地址配置。
执行[ADD COMMU DNS SRVGRP]命令，增加DNS服务器组配置。
执行[ADD COMMU DNS PROFILE]命令，增加DNS Profile配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值
---|---|---
DNS服务器配置|DNS服务器编号|1|2
DNS服务器IP地址|DNS服务器配置|192.168.7.90|192.168.7.91
DNS客户端IP地址|DNS服务器配置|223.103.77.128|223.103.77.128
VRFID|DNS服务器配置|8|8
TCP链路数量|DNS服务器配置|2|2
DNS服务器组配置|DNS服务器组编号|1|1
选择模式|DNS服务器组配置|负荷分担|负荷分担
DNS服务器1ID|DNS服务器组配置|1|1
DNS服务器1权重|DNS服务器组配置|100说明：该参数仅在选择模式为负荷分担时有效。需要根据各服务器的权重进行选择，权重值越大则被选择的概率越高。|100说明：该参数仅在选择模式为负荷分担时有效。需要根据各服务器的权重进行选择，权重值越大则被选择的概率越高。
DNS服务器2ID|DNS服务器组配置|2|2
DNS服务器2权重|DNS服务器组配置|100|100
DNS profile配置|DNS profile类型|LTE|LTE
选择模式|DNS profile配置|主备|主备
DNS服务器组1ID|DNS profile配置|1|1
根据规划，进行如下配置。 
增加DNS服务器地址配置，命令如下。 
[ADD COMMU DNS SERVER]:ID=1,SERVERIPADDR="192.168.7.90",CLIENTIPADDR="223.103.77.128",VRFID=8,TCPNUM=2
[ADD COMMU DNS SERVER]:ID=2,SERVERIPADDR="192.168.7.91",CLIENTIPADDR="223.103.77.128",VRFID=8,TCPNUM=2
增加DNS服务器组配置，命令如下。 
[ADD COMMU DNS SRVGRP]:ID=1,SELECTMODE="PARTAKE",SRVID1=1,WEIGHT1=100,SRVID2=2,WEIGHT2=100
增加DNS Profile配置，命令如下。 
[ADD COMMU DNS PROFILE]:TYPE="LTE",SELECTMODE="BACKUP",SRVGRPID1=1
##### 配置与EMS+对接数据 
摘要 :本节介绍如何配置AMF与EMS+对接的配置信息。 
步骤 :执行[SET EMSPLUSCFG]命令，修改EMS+对接相关配置。
执行[SET AMFCHRFUNC]命令，修改EMS+上报功能配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
EMS+配置|开启EMS+日志上报功能|开启
链路IP地址类型|EMS+配置|IPV4
主用远端服务器IPv4地址|EMS+配置|183.14.20.19
主用远端服务器UDP端口号|EMS+配置|15000
本端IPv4地址|EMS+配置|10.124.17.87
本端UDP起始端口号|EMS+配置|15000
VRF标识|EMS+配置|12
EMS+上报功能配置|功能开关|"SUCCESS"&"FAILURE"
上报日志功能开关|EMS+上报功能配置|"MM"&"SM"&"PAGING"&"HANDOVER"&"RELEASE"&"SMS"&"UECONFIGUPDATE"
根据规划，进行如下配置。 
修改EMS+对接相关配置，命令如下。 
[SET EMSPLUSCFG]:ENABLE="ON",IPADDRESSTYPE="IPV4",REMOTEIPV4="183.14.20.19",REMOTEUDPPORT=15000,LOCALIPV4="10.124.17.87",LOCALUDPPORT=15000,VRFID=12
修改EMS+上报功能配置，命令如下。 
[SET AMFCHRFUNC]:FLG="SUCCESS"&"FAILURE",LOGFUNCFLG="MM"&"SM"&"PAGING"&"HANDOVER"&"RELEASE"&"SMS"&"UECONFIGUPDATE"
##### 配置与LMF对接数据 
摘要 :本节介绍如何配置AMF与LMF对接的配置信息。
前提 :AMF支持LCS功能的License项已打开。
步骤 :执行[SET LCSSWITCH]命令，修改LCS定位开关配置。
执行[SET LCSDISCOMODE]命令，修改发现模式配置。
执行[ADD LMFLOCALADDRPOOL]命令，新增LMF地址池配置。
执行[ADD LMFNODECFG]命令，新增LMF节点配置。
执行[SET TCPKA]命令，修改TCP保活配置。
执行[SET LOCDEFPRETIMER]命令，修改AMF有名定时器时长配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
定位开关配置|是否启用定位功能|是
是否启用紧急呼叫主动上报|定位开关配置|是
发现模式配置|LMF发现模式|本地配置
GMLC发现模式|发现模式配置|NRF发现
LMF地址池配置|地址池标识|1
IP地址|LMF地址池配置|10.60.103.60
端口号|LMF地址池配置|19999
LMF节点配置|NF实例标识|1
别名|LMF节点配置|LMF
安全标识|LMF节点配置|http
API版本|LMF节点配置|v1
地址池标识|LMF节点配置|1
TCP保活配置|空闲时保活间隔（秒）|0
无响应时保活间隔（秒）|TCP保活配置|1
无响应时保活次数|TCP保活配置|3
AMF有名定时器时长配置|ID|1、2
当前时长(ms)|AMF有名定时器时长配置|2000、25000
根据规划，进行如下配置。 
修改LCS定位功能状态，命令如下。 
[SET LCSSWITCH]:SWITCHLOCATION="YES",ESSWITCH="YES"
修改发现模式配置，命令如下。 
[SET LCSDISCOMODE]:LMFDISCOVERYMODE="LOCAL_CONFIG",GMLCDISCOVERYMODE="NRF_DISCOVERY"
新增LMF地址池配置，命令如下。 
[ADD LMFLOCALADDRPOOL]:ADDRPOOLID=1,IPADDRESS="10.60.103.60",PORT=19999
新增LMF节点配置，命令如下。 
[ADD LMFNODECFG]:NFID="1",NAME="LMF",SCHEMA="HTTP",APIVERSION="V1",IPADDRESSID=1
新增TCP保活配置，命令如下。 
[SET TCPKA]:KAIDLE=0,KAINTERVAL=1,KACOUNT=3
修改AMF有名定时器时长配置，命令如下。 
[SET LOCDEFPRETIMER]:ID=1,VALUE=2000
[SET LOCDEFPRETIMER]:ID=2,VALUE=25000
#### NF注册发现 
##### 配置NF发现策略 
摘要 :本节介绍如何配置NF发现策略，包括NF发现模式和服务发现配置。 
步骤 :执行[SET NFDISCOVERYMODE CONFIG]命令，修改NF发现模式。
执行[SET SBISRVDISCOVERY]命令，修改服务发现配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值
---|---|---
发现模式配置|SMSF发现模式|通过NRF发现NF
NSSF发现模式|发现模式配置|通过本地配置发现NF
5G-EIR发现模式|发现模式配置|通过NRF发现NF
服务发现配置|是否启用缓存发现结果功能|启用
续缓存时间阈值（秒）|服务发现配置|300
根据规划，进行如下配置。 
修改NF发现模式，命令如下。 
[SET NFDISCOVERYMODE CONFIG]:DISCOVERYSMSFMODE="DiscNfByNrf",DISCOVERYNSSFMODE="DiscNfByLocal",DISCOVERYEIRMODE="DiscNfByNrf"
修改服务发现配置，命令如下。 
[SET SBISRVDISCOVERY]:CACHEFLAG="true",RECACHETHRESHOLD=300
##### 配置NF发现参数 
摘要 :本节介绍如何配置NF发现参数。 
详细的功能和配置说明参见特性ZUF-79-10 网络功能发现选择
。
步骤 :执行[SET NRFDISCAUSFPARACFG]命令，修改NRF发现AUSF参数配置。
执行[SET NRFDISCUDMPARACFG]命令，修改NRF发现UDM参数配置。
执行[SET NRFDISCSMFPARACFG]命令，修改NRF发现A-SMF参数配置。
执行[SET NRFDISCAMFPARACFG]命令，修改NRF发现AMF参数配置。
执行[SET NRFDISCPCFPARACFG]命令，修改NRF发现PCF参数配置。
执行[SET DEFAULT DNNPARACONFIG]命令，修改DNN相关参数配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值
---|---|---
NRF发现AUSF参数配置|携带参数方式|SUPI优先
NRF发现UDM参数配置|携带SUPI|支持SUPI
NRF发现A-SMF参数配置|DNN携带OI|不支持OI
携带S-NSSAI|NRF发现A-SMF参数配置|支持S-NSSAI
携带目标PLMN|NRF发现A-SMF参数配置|不支持PLMN
携带切片实例号|NRF发现A-SMF参数配置|不支持切片实例号
携带pgw-ind标识|NRF发现A-SMF参数配置|支持携带pgw-ind标识
支持基于Locality优选|NRF发现A-SMF参数配置|不支持
携带Preferred跟踪区标识|NRF发现A-SMF参数配置|携带
NRF发现AMF参数配置|携带Region|不支持Region
携带Set|NRF发现AMF参数配置|不支持Set
携带S-NSSAI|NRF发现AMF参数配置|支持S-NSSAI
NRF发现PCF参数配置（用于中国移动）|携带SUPI|不支持SUPI
携带S-NSSAI|NRF发现PCF参数配置（用于中国移动）|支持S-NSSAI
携带GPSI|NRF发现PCF参数配置（用于中国移动）|支持GPSI
NRF发现PCF参数配置（用于中国电信和中国联通）|携带SUPI|支持SUPI
携带S-NSSAI|NRF发现PCF参数配置（用于中国电信和中国联通）|不支持S-NSSAI
携带GPSI|NRF发现PCF参数配置（用于中国电信和中国联通）|不支持GPSI
DNN相关参数配置|选择DNN与请求DNN不同时DNN携带策略|0-携带dnn，不携带selectedDnn
本网用户携带DNN OI|DNN相关参数配置|0-不携带
LBO漫游用户携带DNN OI|DNN相关参数配置|0-不携带
HR漫游用户携带DNN OI|DNN相关参数配置|0-不携带
根据规划，进行如下配置。 
修改NRF发现AUSF参数配置，命令如下。 
[SET NRFDISCAUSFPARACFG]:CARRYPARAMODE="SupiPrior"
修改NRF发现UDM参数配置，命令如下。 
[SET NRFDISCUDMPARACFG]:CARRYSUPI="SupSupi"
修改NRF发现A-SMF参数配置，命令如下。 
[SET NRFDISCSMFPARACFG]:CARRYOIINDNN="NotCarryOI",CARRYSNSSAI="SupSNSSAI",CARRYPLMN="NotSupPlmn",CARRYNSIID="NotSupNsiId",CARRYPGWIND="SupCarryPgwInd",SUPPLOCALITYSEL="NOTSUPPORT",CARRYPREFERREDTAI="SupPreferredTai"
修改NRF发现AMF参数配置，命令如下。 
[SET NRFDISCAMFPARACFG]:CARRYREGION="NotSupRegion",CARRYSET="NotSupSet",CARRYSNSSAI="SupSNSSAI"
修改NRF发现PCF参数配置，命令如下。 
如果是中国移动时，命令如下。SET NRFDISCPCFPARACFG:CARRYSUPI="NotSupSupi",CARRYSNSSAI="SupSNSSAI",CARRYGPSI="SupGpsi" 
如果是中国电信或中国联通时，命令如下。SET NRFDISCPCFPARACFG:CARRYSUPI="SupSupi",CARRYSNSSAI="NotSupSNSSAI",CARRYGPSI="NotSupGpsi" 
修改DNN相关参数配置，命令如下。 
[SET DEFAULT DNNPARACONFIG]:DNNCARRYPOLICY="ONLYCARRYDNN",LOCALCARRYDNNOI="LOCALNOTCARRYDNNOI",LBOCARRYDNNOI="LBONOTCARRYDNNOI",HRCARRYDNNOI="HRNOTCARRYDNNOI"
##### 配置NF发现流控 
摘要 :本节介绍如何配置NF发现流控配置。 
步骤 :执行[ADD SBISRVDISCOVFLOWCTRL]命令，配置AUSF/UDM发现流控配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
新增服务发现流控配置|目标NF类型|AUSF|UDM
并发的服务发现次数|新增服务发现流控配置|8|8
根据规划，进行如下配置。 
配置AUSF发现参数，命令如下。 
[ADD SBISRVDISCOVFLOWCTRL]:TARGETNFTYPE="AUSF_TYPE",THRESHOLD=8
[ADD SBISRVDISCOVFLOWCTRL]:TARGETNFTYPE="UDM_TYPE",THRESHOLD=8
#### 移动性管理 
##### 配置注册区域 
摘要 :本节介绍如何配置跟踪区和注册区域。 
步骤 :执行[SET 5GTALISTASSIGNPOLICY]命令，配置用户注册区域分配策略。
执行[ADD TACFG]命令，配置跟踪区。
执行[ADD REGAREACFG]命令，配置注册区域。
执行[ADD REGAREA TAIDLIST]命令，配置已增加的注册区域与跟踪区域的关联关系。
 说明： 
注册区域与跟踪区域的关联关系为一一对应。 
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
注册区域分配策略|分配注册区域增加UE最近一次拜访的TA|支持分配注册区域增加UE最近一次拜访的TA|支持分配注册区域增加UE最近一次拜访的TA
跟踪区配置|跟踪区标识|1|2
移动国家码|跟踪区配置|460|460
移动网络码|跟踪区配置|01|01
跟踪区码|跟踪区配置|07D000|07D001
跟踪区名称|跟踪区配置|FJ-07D000|FJ-07D001
TA语音策略模板ID|跟踪区配置|0|0
紧急业务能力|跟踪区配置|NR和E-UTRAN均支持|NR和E-UTRAN均支持
支持紧急业务回落|跟踪区配置|是|是
紧急回落能力|跟踪区配置|NR和E-UTRAN均支持|NR和E-UTRAN均支持
紧急号码列表ID|跟踪区配置|0|0
扩展紧急号码列表ID|跟踪区配置|0|0
注册区域配置|注册区域ID|1|2
注册区域名称|注册区域配置|XATEST|YBTEST
注册区域跟踪区标识列表配置|注册区域ID|1|2
跟踪区标识|注册区域跟踪区标识列表配置|1|2
根据规划，进行如下配置。 
配置用户注册区域分配策略，命令如下。 
[SET 5GTALISTASSIGNPOLICY]:WITHLASTVISITEDTA="SUPTLASTTA"
配置跟踪区，命令如下。 
[ADD TACFG]:TAID=1,MCC="460",MNC="01",TAC="07D000",TANAME="FJ-07D000",TAVOICEPOLICYTEMPID=0,EMERGCAPA="BOTHNRANDEUTRANSPRT",SPRTEMERGFALLBACK="YES",EMERGFALLBACKCAPA="BOTHNRANDEUTRANSPRT",EMERGENCYNUMLISTID=0,EXTEMERGNUMLISTID=0
[ADD TACFG]:TAID=2,MCC="460",MNC="01",TAC="07D001",TANAME="FJ-07D001",TAVOICEPOLICYTEMPID=0,EMERGCAPA="BOTHNRANDEUTRANSPRT",SPRTEMERGFALLBACK="YES",EMERGFALLBACKCAPA="BOTHNRANDEUTRANSPRT",EMERGENCYNUMLISTID=0,EXTEMERGNUMLISTID=0
配置注册区域，命令如下。 
[ADD REGAREACFG]:REGAREAID=1,REGAREANAME="XATEST"
[ADD REGAREACFG]:REGAREAID=2,REGAREANAME="YBTEST"
配置已增加的注册区域与跟踪区域的关联关系，命令如下。 
[ADD REGAREA TAIDLIST]:REGAREAID=1,TAID=1
[ADD REGAREA TAIDLIST]:REGAREAID=2,TAID=2
##### 配置GUTI分配策略 
摘要 :本节介绍如何配置GUTI分配策略。 
步骤 :执行[SET GUTIALLOPOLICY]命令，配置GUTI分配策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
GUTI分配策略配置|周期性注册更新分配GUTI开关|不支持周期性注册更新分配GUTI
寻呼过程业务请求分配GUTI开关|GUTI分配策略配置|不支持寻呼过程业务请求分配GUTI
根据规划，进行如下配置。 
修改GUTI分配策略配置，命令如下。 
[SET GUTIALLOPOLICY]:SUPTPERIODREGALLO="NOTSUPPERIODREGALLO",SUPTPAGSERVREQALLO="NOTSUPPAGSERVREQALLO"
##### 配置获取IMEISV功能 
摘要 :本节介绍如何配置AMF获取IMEISV。 
步骤 :执行[SET AMFMOBCFG]命令，配置AMF获取IMEISV。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
AMF移动性配置|AMF是否获取IMEI(SV)|获取IMEISV
根据规划，进行如下配置。 
配置AMF获取IMEISV，命令如下。 
[SET AMFMOBCFG]:AMFGETIMEI="GETIMEISV"
##### 配置MT基础数据 
摘要 :本节介绍如何配置MT基础数据。 
步骤 :执行[SET MTBASICCFG]命令，修改AMF默认寻呼基站数量。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MT基础配置|批量寻呼消息发送个数|512
根据规划，进行如下配置。 
配置AMF批量发送寻呼消息的个数，命令如下。 
[SET MTBASICCFG]:BATCHPAGINGNUM=512
##### 配置UE策略和AM策略 
摘要 :本节介绍如何配置UE策略和AM策略。 
步骤 :执行[SET DEFASUPTPCFPOLICY]命令，修改缺省UE策略和AM策略。
 说明： 
中国移动项目中建议关闭UE策略和AM策略。 
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
缺省UE策略和AM策略|向PCF获取AM策略|不支持AM策略
向PCF获取UE策略|缺省UE策略和AM策略|不支持UE策略
根据规划，进行如下配置。 
关闭UE策略和AM策略，命令如下。 
[SET DEFASUPTPCFPOLICY]:IFAMPOLICY="AMPOLICYNOTSUPT",IFUEPOLICY="UEPOLICYNOTSUPT"
##### 配置移动性参数 
摘要 :本节介绍如何进行移动性参数配置。 
步骤 :执行[SET MOBILITYTIMERLENGTH]命令，修改移动性时长配置。
执行[SET MOBTIMERSELCFG]命令，修改移动性定时器选取配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
移动性时长配置|T3512（秒）|中国移动设置为：3000中国电信按默认值设置：3240中国联通设置为：3600
不可达定时器（秒）|移动性时长配置|中国移动和中国电信设置为：3480中国联通设置为：4080
隐式分离定时器（秒）|移动性时长配置|中国移动和中国电信设置为：3480中国联通设置为：4080
T3502（秒）|移动性时长配置|720
资源保护定时器（秒）|移动性时长配置|10
移动性定时器选取配置|周期性注册定时器选取模式|签约优先
根据规划，进行如下配置。 
修改移动性时长配置，命令如下。 
[SET MOBILITYTIMERLENGTH]:T3512=3000,UNREACHABLETIMER=3480,RESOURCERESERVETIMER=10,T3502=720
如果是中国移动时，命令如下。SET MOBILITYTIMERLENGTH:T3512=3000,UNREACHABLETIMER=3480,IMPLICITDETACHTIMER=3480,RESOURCERESERVETIMER=10,T3502=720 
如果是中国电信时，命令如下。SET MOBILITYTIMERLENGTH:T3512=3240,UNREACHABLETIMER=3480,IMPLICITDETACHTIMER=3480,RESOURCERESERVETIMER=10,T3502=720 
如果是中国联通时，命令如下。SET MOBILITYTIMERLENGTH:T3512=3600,UNREACHABLETIMER=4080,IMPLICITDETACHTIMER=4080,RESOURCERESERVETIMER=10,T3502=720 
修改移动性定时器选取配置，命令如下。 
[SET MOBTIMERSELCFG]:PERIOREGTIMERSELMODE="VIASUB"
#### 安全配置 
##### 配置鉴权 
摘要 :本节介绍如何配置AMF鉴权策略。 
步骤 :执行[SET DEFAUTHSTRATEGY]命令，设置AMF的缺省鉴权策略。
 说明： 
鉴权配置与运营商要求有关。除SUCI初始注册、RAT内局间GUTI初始注册、RAT间局间GUTI初始注册、 
RAT间局间移动性注册更新的鉴权策略建议配置为强制鉴权，其余流程建议配置为系统判断。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
缺省鉴权策略配置|业务类型|SUCI初始注册|RAT内局间GUTI初始注册|RAT间局间GUTI初始注册|RAT间局间移动性注册更新|RAT间局间切换后的移动性注册更新
鉴权策略|缺省鉴权策略配置|强制鉴权|强制鉴权|强制鉴权|强制鉴权|强制鉴权
根据规划，进行如下配置。 
SUCI初始注册、RAT内局间GUTI初始注册、RAT间局间GUTI 初始注册、RAT间局间移动性注册更新配置为强制鉴权，命令如下。 
[SET DEFAUTHSTRATEGY]:SERVICETYPE="SUCIINITREG",AUTHSTRATEGY="FORCEAUTH"
[SET DEFAUTHSTRATEGY]:SERVICETYPE="INTERGUTIINITREG",AUTHSTRATEGY="FORCEAUTH"
[SET DEFAUTHSTRATEGY]:SERVICETYPE="RATGUTIINITREG",AUTHSTRATEGY="FORCEAUTH"
[SET DEFAUTHSTRATEGY]:SERVICETYPE="RATMOBREG",AUTHSTRATEGY="FORCEAUTH"
（可选）针对中国联通，需要把RAT间局间切换后的移动性注册更新配置为强制鉴权，命令如下。 
[SET DEFAUTHSTRATEGY]:SERVICETYPE="RATMOBREGAFTERHO",AUTHSTRATEGY="FORCEAUTH"
##### 配置加密完保 
摘要 :本节介绍如何配置加密完保策略。 
步骤 :执行[SET ENCRYANDINTEG]命令，进行AMF的加密完保配置，包括AMF所支持的完整性算法、加密算法及各算法对应的优先级。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
加密完保配置|EA0算法开关|支持5G加密算法0|支持5G加密算法0|支持5G加密算法0|支持5G加密算法0
EA0算法优先级|加密完保配置|1|1|1|1
EA1算法开关|加密完保配置|不支持5G加密算法1|不支持5G加密算法1|不支持5G加密算法1|不支持5G加密算法1
EA1算法优先级|加密完保配置|2|2|2|2
EA2算法开关|加密完保配置|不支持5G加密算法2|不支持5G加密算法2|不支持5G加密算法2|不支持5G加密算法2
EA2算法优先级|加密完保配置|3|3|3|3
EA3算法开关|加密完保配置|不支持5G加密算法3|不支持5G加密算法3|不支持5G加密算法3|不支持5G加密算法3
EA3算法优先级|加密完保配置|4|4|4|4
IA1算法开关|加密完保配置|支持5G完整性算法1|支持5G完整性算法1|支持5G完整性算法1|支持5G完整性算法1
IA1算法优先级|加密完保配置|1|1|1|1
IA2算法开关|加密完保配置|支持5G完整性算法2|支持5G完整性算法2|支持5G完整性算法2|支持5G完整性算法2
IA2算法优先级|加密完保配置|2|2|2|2
IA3算法开关|加密完保配置|支持5G完整性算法3|支持5G完整性算法3|支持5G完整性算法3|支持5G完整性算法3
IA3算法优先级|加密完保配置|3|3|3|3
根据规划，进行如下配置。 
进行AMF的加密完保配置，包括AMF所支持的完整性算法、加密算法及各算法对应的优先级，命令如下。 
[SET ENCRYANDINTEG]:EA0="EA0SUPPORT",EA0ALGPRIORITY=1,EA1="EA1NOSUPPORT",EA1ALGPRIORITY=2,EA2="EA2NOSUPPORT",EA2ALGPRIORITY=3,EA3="EA3NOSUPPORT",EA3ALGPRIORITY=4,IA1="IA1SUPPORT",IA1ALGPRIORITY=1,IA2="IA2SUPPORT",IA2ALGPRIORITY=2,IA3="IA3SUPPORT",IA3ALGPRIORITY=3
#### 业务功能配置 
##### 配置VoNR和EPSFallback 
摘要 :本节介绍如何配置VoNR和EPSFallback功能。 
详细的功能和配置说明参见特性ZUF-79-13-001 VoNR
和ZUF-79-13-002 EPS回落
。
前提 :已开启License项AMF支持VONR功能。
步骤 :执行[SET 5GVONRCFG]命令，配置是否支持IMS VoPS业务，配置是否检查UE无线能力。
执行[SET 5GDEFAULTSUPIVOICEPOLICY]命令，配置基于SUPI的缺省语音参数策略配置。
执行[ADD 5GSUPIVOICEPOLICY]命令，配置基于SUPI的语音参数策略配置。
执行[SET 5GDEFAULTTAVOICEPOLICY]命令，配置基于TA的缺省语音参数策略配置。
（可选）执行[ADD 5GTAVOICEPOLICYTEMPLATE]命令，配置基于TA的语音参数策略模板配置。
（可选）执行[ADD TACFG]命令，新增跟踪区配置。
执行[ADD 5GDNNVOICEPOLICY]命令，配置支持语音策略的DNN列表。
执行[SET 5GINTERWORKCFG]命令，配置AMF支持N26互操作。
执行[SET 5GTALISTASSIGNPOLICY]命令，设置注册区域分配策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
AMF支持VONR配置|IMSVoPs|支持IMS VoPS业务
UE无线能力检查|AMF支持VONR配置|不检查UE无线能力
基于SUPI的缺省语音参数策略配置|IMSVoPs|不支持IMS VoPS业务
基于SUPI的语音参数策略配置|SUPI号段|46000
接入类型|基于SUPI的语音参数策略配置|3GPP接入
IMSVoPs|基于SUPI的语音参数策略配置|支持IMS VoPS业务
基于TA的缺省语音参数策略配置|IMSVoPs|支持IMS VoPS业务
EPSFallback|基于TA的缺省语音参数策略配置|支持Fallback业务
用户别名|基于TA的缺省语音参数策略配置|vonr1
基于TA的语音参数策略模板配置|策略模板标识|1
IMSVoPs|基于TA的语音参数策略模板配置|支持IMS VoPS业务
EPSFallBack|基于TA的语音参数策略模板配置|支持FallBack业务
用户别名|基于TA的语音参数策略模板配置|Vonr
跟踪区配置|跟踪区标识|1
移动国家码|跟踪区配置|460
移动网络码|跟踪区配置|00
跟踪区码|跟踪区配置|0001
跟踪区名称|跟踪区配置|Vonr1
TA语音策略模板ID|跟踪区配置|1
紧急业务能力|跟踪区配置|NR和E-UTRAN均支持
支持紧急业务回落|跟踪区配置|是
紧急回落能力|跟踪区配置|NR和E-UTRAN均支持
紧急号码列表ID|跟踪区配置|1
扩展紧急号码列表ID|跟踪区配置|1
支持语音策略的DNN配置|DNN|ims
AMF互操作配置|支持N26互操作|支持N26互操作
注册区域分配策略配置|注册区域分配参考IMS VoPS能力|需要具有相同IMS VoPS能力
根据规划，进行如下配置。 
修改AMF支持VoNR配置功能，命令如下。 
[SET 5GVONRCFG]:IMSVOPS="SPRT",UERADIOCAPCHECK="NO"
基于SUPI的缺省语音参数策略配置，配置为默认不支持IMS VoPS业务，命令如下。 
[SET 5GDEFAULTSUPIVOICEPOLICY]:IMSVOPS="NOSPRT"
配置基于SUPI的语音参数策略配置，配置用户所在的SUPI号段支持IMS VoPS业务，命令如下。 
[ADD 5GSUPIVOICEPOLICY]:SUPI="46000",ACCESSTYPE="_3GPP",IMSVOPS="SPRT"
基于TA的缺省语音参数策略配置，配置为默认支持IMS VoPS业务，命令如下。 
[SET 5GDEFAULTTAVOICEPOLICY]:IMSVOPS="SPRT",FALLBACK="SPRT",USERALIAS="vonr1"
（可选）基于TA的语音参数策略模板配置，配置用户所在的TA支持IMS VoPS业务，命令如下。 
[ADD 5GTAVOICEPOLICYTEMPLATE]:POLICYTEMPID=1,IMSVOPS="SPRT",FALLBACK="SPRT",USERALIAS="vonr-ta"
（可选）新增跟踪区配置，配置用户所在TA的语音策略模板，命令如下。 
[ADD TACFG]:TAID=1,MCC="460",MNC="00",TAC="0001",TANAME="Vonr1",TAVOICEPOLICYTEMPID=1,EMERGCAPA="BOTHNRANDEUTRANSPRT",SPRTEMERGFALLBACK="YES",EMERGFALLBACKCAPA="BOTHNRANDEUTRANSPRT",EMERGENCYNUMLISTID=1,EXTEMERGNUMLISTID=1
 说明： 
此处的TAVOICEPOLICYTEMPID参数需与步骤5中的POLICYTEMPID参数一致，如果步骤5未配置，则POLICYTEMPID默认为0，此时TAVOICEPOLICYTEMPID配置为0。
配置支持语音策略的DNN配置，将用户签约的DNN配置到支持语音策略的DNN列表中，命令如下。 
[ADD 5GDNNVOICEPOLICY]:DNN="ims"
配置AMF支持N26互操作，命令如下。 
[SET 5GINTERWORKCFG]:SUPINTERWITHN26="SPRT"
设置注册区域分配策略，命令如下。 
[SET 5GTALISTASSIGNPOLICY]:SAMEIMSVOPS="YES"
##### 配置支持N26接口的4/5G互操作 
摘要 :本节介绍如何配置支持N26接口的4/5G互操作。 
详细的功能和配置说明参见特性ZUF-79-12-001 支持N26接口互操作
。
前提 :已开启License项AMF支持N26互操作功能。
步骤 :执行[SET AMFGTPCADDRCFG]命令，配置AMF的GTPC地址和VRF。
执行[SET COMMU SOFTWARE PARAMETER]命令，设置将EPS映射安全上下文中的NAS COUNT设置为5G NAS COUNT（软参索引对应39），并设置在当前5G安全上下文下行NAS COUNT基础上设置下行NAS COUNT（软参索引对应41）。
执行[SET 5GINTERWORKCFG]命令，配置支持N26互操作。
执行[SET MMESELECTPOLICYCFG]命令，配置MME地址选择策略。
执行[ADD ADDRPOOL]命令，配置ADD MMEHOST命令里面的地址池ID对应的MME地址。
执行[ADD MMEHOST]命令，配置MME的FQDN、主机名、地址池、权重和优先级之间的对应关系。其中地址池标识参数与[ADD ADDRPOOL]命令中的地址池标识参数互相关联。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
修改AMF GTPC地址配置|AMF GTPC IPV4地址|223.103.77.128|223.103.77.128
AMF N26 VRF|修改AMF GTPC地址配置|8|8
Communication软件参数配置|软参索引|39|41
当前参数值|Communication软件参数配置|1|1
AMF互操作配置|支持N26互操作|支持N26互操作|支持N26互操作
支持无N26互操作|AMF互操作配置|不支持无N26互操作|不支持无N26互操作
互操作模式|AMF互操作配置|有N26|有N26
gtp重发队列间隔(秒)|AMF互操作配置|3|3
支持空闲态模式下4G移动5G时V-SMF或I-SMF重选|AMF互操作配置|不支持|不支持
空闲态模式下互操作S-NSSAI获取策略|AMF互操作配置|本地选择（用于中国移动TOC和中国联通）|智能推导（用于中国移动TOB和中国电信）
MME选择策略配置|MME地址解析优先级|Host Local->DNS Cache->DNS Server|Host Local->DNS Cache->DNS Server
优选IP类型|MME选择策略配置|IPv4|IPv4
支持通过权重和优先级选择切换目标MME|MME选择策略配置|支持|支持
地址池配置|IP类型|IPV4|IPV4
IP地址|地址池配置|192.168.22.22|192.168.22.22
地址池标识|地址池配置|1|1
MME地址解析配置|FQDN|tac-lb02.tac-hb01.tac.epc.mnc000.mcc460.3gppnetwork.org（用于连接态下5G->4G的切换）|mmec02.mmegi8001.mme.epc.mnc000.mcc460.3gppnetwork.org（用于空闲态4G->5G重选）
主机名|MME地址解析配置|mme50.zte.com.cn|mme50.zte.com.cn
优先级|MME地址解析配置|1|0
权重|MME地址解析配置|50|200
地址池ID|MME地址解析配置|1|1
根据规划，进行如下配置。 
修改AMF GTPC地址配置，命令如下。 
[SET AMFGTPCADDRCFG]:AMFGTPCIPV4ADDRESS="223.103.77.128",AMFN26VRF=8
设置软参，命令如下。 
[SET COMMU SOFTWARE PARAMETER]:ID=39,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=41,VALUE=1
修改AMF互操作配置。 
如果是中国移动TOC和中国联通，命令如下。SET 5GINTERWORKCFG:SUPINTERWITHN26="SPRT",SUPINTERWITHOUTN26="NOSPRT",INTERWORKMODE="WITHN26",GTPRETRYINTERVAL=3,SUPIVSMFRESELIDLE="NOSPRT",IDLEIWKSNSSAIPLY="LOCALCONFIG" 
如果是中国移动TOB和中国电信，命令如下。SET 5GINTERWORKCFG:SUPINTERWITHN26="SPRT",SUPINTERWITHOUTN26="NOSPRT",INTERWORKMODE="WITHN26",GTPRETRYINTERVAL=3,SUPIVSMFRESELIDLE="NOSPRT",IDLEIWKSNSSAIPLY="INTELLIGENTDEDUCTION" 
设置MME地址选择策略配置，命令如下。 
[SET MMESELECTPOLICYCFG]:MMEADDRRESOLPRI="HOST_DCACHE_DSERVER",SERVIPTYPE4DUSTACK="IPv4",AMFSELMMEBYPRIOR="SUPPORT"
新增地址池配置，命令如下。 
[ADD ADDRPOOL]:IPTYPE="IPV4",IPADDR="192.168.22.22",ADDRPOOLID=1
新增MME地址解析配置。 
设置连接态从5G切换到4G的地址解析，命令如下。ADD MMEHOST:LOGICNAME="tac-lb02.tac-hb01.tac.epc.mnc000.mcc460.3gppnetwork.org",HOSTNAME="mme50.zte.com.cn",PRIORITY=1,WEIGHT=50,ADDRPOOLID=1 
设置空闲态从4G 注册更新到5G的地址解析，命令如下。ADD MMEHOST:LOGICNAME="mmec02.mmegi8001.mme.epc.mnc000.mcc460.3gppnetwork.org",HOSTNAME="mme50.zte.com.cn",PRIORITY=0,WEIGHT=200,ADDRPOOLID=1 
##### 配置DNN更正 
摘要 :本节介绍如何进行DNN更正配置。 
详细的功能和配置说明参见特性ZUF-79-06-005 DNN更正
。
步骤 :执行[SET DNNCORRECT POLICY]命令，开启DNN更正功能。
执行[ADD DNNCORRECT CONFIG]命令，新增DNN更正配置。
执行[ADD DEFAULTDNNCONFIG]命令，添加默认DNN配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
DNN更正策略|DNN更正策略|支持DNN更正
DNN更正配置|SUPI号段|46000、46002、46004、46007、46008、46013
DNN更正方式|DNN更正配置|签约DNN
缺省DNN配置|SST|1-eMBB
SD|缺省DNN配置|NULL
DNN|缺省DNN配置|cmnet
根据规划，进行如下配置。 
打开DNN更正策略，命令如下。 
[SET DNNCORRECT POLICY]:DNNCORRECTPOLICY="SUPDNNCORRECT"
增加本地用户号段的DNN更正配置，命令如下。 
[ADD DNNCORRECT CONFIG]:SUPI="46000",DNNCORRECTPOLICY="SUBSCRIBEDNN"
[ADD DNNCORRECT CONFIG]:SUPI="46002",DNNCORRECTPOLICY="SUBSCRIBEDNN"
[ADD DNNCORRECT CONFIG]:SUPI="46004",DNNCORRECTPOLICY="SUBSCRIBEDNN"
[ADD DNNCORRECT CONFIG]:SUPI="46007",DNNCORRECTPOLICY="SUBSCRIBEDNN"
[ADD DNNCORRECT CONFIG]:SUPI="46008",DNNCORRECTPOLICY="SUBSCRIBEDNN"
[ADD DNNCORRECT CONFIG]:SUPI="46013",DNNCORRECTPOLICY="SUBSCRIBEDNN"
添加默认DNN配置，命令如下。 
[ADD DEFAULTDNNCONFIG]:SST="eMBB",SD="NULL",DNN="cmnet"
##### 配置紧急呼叫 
摘要 :本节介绍如何进行紧急呼叫配置。 
详细的功能和配置说明参见特性ZUF-79-13-005 紧急业务
。
步骤 :执行[SET EMERGSRVPLY]命令，设置紧急业务策略。
执行[SET EMERGSRVFALLBACKPLY]命令，设置紧急业务回落策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
紧急业务策略|支持紧急业务|否
紧急业务回落策略|支持紧急业务回落|是
根据规划，进行如下配置。 
设置紧急业务策略，命令如下。 
[SET EMERGSRVPLY]:SPRTEMERGSRV="NO"
设置紧急业务回落策略，命令如下。 
[SET EMERGSRVFALLBACKPLY]:SPRTEMERGFALLBACK="YES"
##### 配置智能寻呼 
智能寻呼详细的功能和配置说明参见特性ZUF-79-04-003 智能寻呼
。
开启智能寻呼时，需要在License中打开AMF支持基于机器学习的智能寻呼。
AMF默认有智能寻呼策略，可采用默认值配置即可。 
##### 配置NITZ 
摘要 :本节介绍如何进行NITZ配置。 
详细的功能和配置说明参见特性ZUF-79-03-010 NITZ
。
步骤 :执行SET NITZCFG命令，修改网络标识和时区配置，设置流程对应的参数值携带NITZ。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
修改网络标识和时区配置|携带NI|不携带网络名称
携带TZ|修改网络标识和时区配置|携带时区
初始注册流程是否携带NITZ|修改网络标识和时区配置|初始注册流程携带NITZ
跨AMF流程是否携带NITZ|修改网络标识和时区配置|跨AMF流程携带NITZ
跨RAT流程是否携带NITZ|修改网络标识和时区配置|跨RAT流程不携带NITZ
周期性注册流程是否携带NITZ|修改网络标识和时区配置|周期性注册流程不携带NITZ
局内移动性注册流程是否携带NITZ|修改网络标识和时区配置|局内移动性注册流程不携带NITZ
根据规划，进行如下配置。 
修改网络标识和时区配置，命令如下。 
[SET NITZCFG]:CARRYNI="NOTCARRYNI",CARRYTZ="CARRYTZ",INTIALREG="CARRYININTIALREG",INTERAMF="CARRYININTERAMFREG",INTERRAT="NOTCARRYININTERRAT",PERIODICREG="NOTCARRYINPERIODICREG",INTRAAMFMOBILEREG="NOTCARRYININTRAAMFMOBILEREG"
##### 配置IP地址细分（可选） 
摘要 :本节介绍如何进行AMF的IP地址细分配置。 
前提 :以下License项功能已打开。 
支持用户IP地址和位置关联功能 
AMF支持用户IP地址和位置关联功能 
步骤 :执行[SET 5GIPLOCPOLICY]命令，修改IP和位置关联策略。
执行[ADD 5GTAGROUP RULE]命令，新增5G TA编组策略模板配置。
执行[ADD TAGROUPCFG]命令，新增5G跟踪区组配置。
执行[ADD 5GTAGROUP]命令，新增5G TA编组配置。
执行[ADD MMETAGROUP]命令，新增位置IP关联4G TA编组配置。
执行[ADD AREAGROUP]命令，新增区域编组配置。
执行[SET APN SUBDIVISION POLICY]命令，修改基于数据APN或DNN的IP地址细分策略配置。
执行[ADD APN SUBDIVISION]命令，新增基于数据APN或DNN的IP地址细分配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
IP和位置关联策略配置|支持IP和位置关联功能|否
IP和位置关联功能开启时强制下线|IP和位置关联策略配置|是
IP和位置关联功能关闭时强制下线|IP和位置关联策略配置|是
从TA编组到非TA编组时强制下线|IP和位置关联策略配置|是
从TA编组到未知区域时强制下线|IP和位置关联策略配置|是
位置IP关联功能限制紧急会话|IP和位置关联策略配置|否
位置IP关联功能限制IMS会话|IP和位置关联策略配置|是
支持IMS和紧急呼叫会话跨区延迟释放|IP和位置关联策略配置|是
5G TA编组策略模板配置|5G TA编组策略模板标识|1
支持IP和位置关联功能|5G TA编组策略模板配置|否
限制国际漫游用户|5G TA编组策略模板配置|是
拒绝国际漫游用户接入的原因值|5G TA编组策略模板配置|67
限制国内跨PLMN漫游用户|5G TA编组策略模板配置|是
拒绝国内跨PLMN漫游用户接入的原因值|5G TA编组策略模板配置|67
限制国内不跨PLMN漫游用户|5G TA编组策略模板配置|是
拒绝国内不跨PLMN漫游用户接入的原因值|5G TA编组策略模板配置|67
跟踪区组配置|跟踪区组标识|1
移动国家码|跟踪区组配置|460
移动网络码|跟踪区组配置|00
跟踪区码|跟踪区组配置|112233
跟踪区码起始|跟踪区组配置|000111
跟踪区码终止|跟踪区组配置|000222
跟踪区组类型|跟踪区组配置|通用
别名|跟踪区组配置|test
5G TA编组配置|5G TA编组编号|1
跟踪区组号|5G TA编组配置|1
5G TA编组策略模板标识|5G TA编组配置|1
别名|5G TA编组配置|test
位置IP关联TA编组配置|位置IP关联TA编组编号|1
移动国家码|位置IP关联TA编组配置|460
移动网络码|位置IP关联TA编组配置|00
跟踪区域码|位置IP关联TA编组配置|1234
TA编组规则标识|位置IP关联TA编组配置|1
别名|位置IP关联TA编组配置|4GTAG-test
区域编组配置|区域编组编号|1
5G TA编组编号|区域编组配置|1
4G TA编组编号|区域编组配置|1
别名|区域编组配置|test
基于数据APN或DNN的IP地址细分策略配置|MME支持基于数据APN的IP地址细分|支持
AMF支持基于数据DNN的IP地址细分|基于数据APN或DNN的IP地址细分策略配置|支持
默认基于数据APN或DNN是否去PDN连接|基于数据APN或DNN的IP地址细分策略配置|是
基于数据APN或DNN的IP地址细分配置|APN或DNN名称|cmnet、ims
APN或DNN是否去PDN连接|基于数据APN或DNN的IP地址细分配置|否
根据规划，进行如下配置。 
配置IP和位置关联策略，命令如下。 
[SET 5GIPLOCPOLICY]:IFAMFIPLOC="NO",IFOFFSESSFUNCON="YES",IFOFFSESSFUNCOFF="YES",IFOFFSESSTONOTA="YES",IFOFFSESSTOUNKONWN="YES",IFIMPACTEMERG="NO",IFIMPACTVONR="YES",IFSPRTDELAYRLS="YES"
新增5G TA编组策略模板配置，命令如下。 
[ADD 5GTAGROUP RULE]:RULEID=1,IFIPLOCFUNC="NO",IFRSTRINTERNATION="YES",INTERNATIONREJCAUSE=67,IFRSTRINTERPLMN="YES",INTERPLMNREJCAUSE=67,IFRSTRINTRAPLMN="YES",INTRAPLMNREJCAUSE=67
新增跟踪区组配置。 
如果只新增一个TA段，命令如下。ADD TAGROUPCFG:TAGROUPID=1,MCC="460",MNC="00",TACST="000111",TACEND="000222",TAGRPTYPE="COMMONTYPE",ALIAS="test" 
如果只新增一个TA，命令如下。ADD TAGROUPCFG:TAGROUPID=1,MCC="460",MNC="00",TAC="112233",TAGRPTYPE="COMMONTYPE",ALIAS="test" 
如果新增一个TA段和一个TA，命令如下。ADD TAGROUPCFG:TAGROUPID=1,MCC="460",MNC="00",TAC="112233",TACST="000111",TACEND="000222",TAGRPTYPE="COMMONTYPE",ALIAS="test" 
新增5G TA编组配置，命令如下。 
[ADD 5GTAGROUP]:AMFTAGROUPID=1,TAGROUPID=1,RULEID=1,ALIAS="test"
新增位置IP关联4G TA编组配置,命令如下。 
[ADD MMETAGROUP]:GROUPID=1,MCC="460",MNC="00",TAC="1234",RULEID=1,ALIAS="4GTAG-test"
新增区域编组配置，可以通过本命令关联到同一个区域编组中，当用户跨RAT接入AMF时，AMF可以根据本命令的配置判断用户是否跨区域，命令如下。 
[ADD AREAGROUP]:AREAGROUPID=1,AMFTAGROUPID=1,MMETAGROUPID=1,ALIAS="test"
修改基于数据APN或DNN的IP地址细分策略配置，命令如下。 
[SET APN SUBDIVISION POLICY]:MMESUPDAPNIPSUB="SPRT",AMFSUPDAPNIPSUB="SPRT",DEFAPNDISC="YES"
新增基于数据APN或DNN的IP地址细分配置，命令如下。 
[ADD APN SUBDIVISION]:APN="cmnet",APNDISC="NO"
[ADD APN SUBDIVISION]:APN="ims",APNDISC="NO"
#### AMF容灾配置 
##### 配置AMF主用局 
摘要 :本节介绍在AMF容灾情况下，AMF主用局上的配置内容。例如AM1F为主用局，AMF2为容灾局，即本节介绍在AMF1上的配置内容。 
步骤 :执行[SET DISASTERSWITCHPARA]命令，修改容灾开关配置。
执行[SET DISASTERRECOVERYPOLICY]命令，配置AMF容灾策略参数。
执行[SET AMFLOCALOFFICECFG]命令，配置AMF权重。
执行[ADD OTHERAMFCFG]命令，配置备份AMF。
执行[SET CONTROLPARA]命令，配置备份AMF GTPC地址。
执行[ADD GUAMICFG]命令，配置容灾局的GUAMI。
执行[ADD AMFNRI]命令，配置备份容灾局NRI资源标识。
执行[ADD BACKUPAMF]命令，配置本局的GUAMI可被容灾局接管。
执行[ADD TAKEOVERAMF]命令，配置本局接管容灾局的GUAMI。
执行[ADD NOTIFYIP]命令，配置本AMF对应的备份AMF的Notify IP。
执行[SET CONTROLPOLICY]命令，配置控制策略中打开携带备份AMF。
执行[SET COMMU SOFTWARE PARAMETER]命令，配置连接类消息amfngapid异常时发release消息。
举例 :在配置数据之前，应当完成相关数据规划，主用局为AMF1，备份局为AMF2，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
容灾开关配置|是否支持容灾功能|是|-
是否携带Timer Approach字段|容灾开关配置|是|-
无UDSF时SBI是否携带NotifyIp|容灾开关配置|是|-
容灾策略配置|容灾策略配置|无UDSF部分备份|-
AMF本局配置|AMF权重因子|100（用于中国移动和中国电信）、255（用于中国联通）|-
Set内其他AMF配置|Pointer标识|2|-
IP地址|Set内其他AMF配置|2409:8027:5003:1713::1102:101|IP地址是备份局（AMF2）的HTTP服务端地址。
端口号|Set内其他AMF配置|80|端口号备份局（AMF2）的服务端端口号。
URI Schema|Set内其他AMF配置|http|-
API版本|Set内其他AMF配置|v1|-
控制参数配置|备份AMF的GTPC地址|223.103.79.1|该地址是备份局（AMF2）的GTPC地址。
GUAMI配置|GUAMI标识|2|-
移动国家码|GUAMI配置|460|-
移动网络码|GUAMI配置|00|-
Region标识|GUAMI配置|55|该参数是备份局（AMF2）的Region标识。
Set标识|GUAMI配置|65|该参数是备份局（AMF2）的Set标识。
Point标识|GUAMI配置|2|该参数是备份局（AMF2）的Point标识。
AMF资源标识|AMF名称|amfc02.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org|该参数是备份局（AMF2）的AMF名称。
AMF资源标识|AMF资源标识|2|该参数是备份局（AMF2）的AMF资源标识。
备份AMF配置|本局GUAMI标识|1|该参数是本局（AMF1）的GUAMIID。
备份局AMF名称|备份AMF配置|amfc02.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org|该参数是备份局（AMF2）的AMF名称。
接管AMF配置|接管GUAMI标识|2|该参数是备份局（AMF2）的GUAMI标识。
接管AMF名称|接管AMF配置|amfc02.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org|该参数是备份局（AMF2）的AMF名称。
Notify IP配置|通知IP名称|AMF2|-
通知IP地址类型|Notify IP配置|IPV6|-
通知IP地址|Notify IP配置|2409:8027:5003:1713::1102:101|-
控制策略配置|携带备份AMF开关|携带|-
Communication软件参数配置|软参索引|80|控制连接类消息amfngapid异常时给RAN发送发release消息。
当前参数值|Communication软件参数配置|0|控制连接类消息amfngapid异常时给RAN发送发release消息。
根据规划，进行如下配置。 
修改容灾开关配置，命令如下。 
[SET DISASTERSWITCHPARA]:SUPPORTDISASTER="YES",TAKETIMERAPPROACH="YES",TAKENOTIIPNOUDSF="YES"
配置AMF容灾策略参数，命令如下。 
[SET DISASTERRECOVERYPOLICY]:DISASTERPOLICY="WITHOUT_UDSF_PARTIAL"
配置AMF权重。 
如果是中国移动和中国电信，命令如下。SET AMFLOCALOFFICECFG:RELATIVEAMFCAPACITY=100 
如果是中国联通，命令如下。SET AMFLOCALOFFICECFG:RELATIVEAMFCAPACITY=255 
配置备份AMF，地址是备份局（AMF2）的HTTP服务端地址，端口是备份局（AMF2）的服务端端口，命令如下。 
[ADD OTHERAMFCFG]:POINTERID=2,IPADDRESS="2409:8027:5003:1713::1102:101",PORT=80,SCHEMA="HTTP",APIVERSION="V1"
配置备份AMF GTPC地址，地址是备份局（AMF2）的GTPC地址，命令如下。 
[SET CONTROLPARA]:BACKAMFIP="223.103.79.1"
配置容灾局的GUAMI，命令如下。 
[ADD GUAMICFG]:GUAMIID=2,MCC="460",MNC="00",REGIONID=55,SETID=65,POINTID=2
配置容灾局NRI资源标识，命令如下。 
[ADD AMFNRI]:AMFNAME="amfc02.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org",AMFNRI=2
配置本局的GUAMI可被容灾局接管，GUAMI是本局（AMF1）的GUAMI标识，AMF名称是备份局（AMF2）的名称，命令如下。 
[ADD BACKUPAMF]:GUAMIID=1,AMFNAME="amfc02.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org"
配置本局接管容灾局的GUAMI，BACKUPGUAMI是备份局（AMF2）的GUAMI标识，MASTERAMFNAME是备份局（AMF2）的AMF名称，命令如下。 
[ADD TAKEOVERAMF]:BACKUPGUAMI=2,MASTERAMFNAME="amfc02.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org"
配置本AMF对应的容灾局的Notify IP，命令如下。 
[ADD NOTIFYIP]:IPADDRNAME="AMF2",IPADDRTYPE="IPV6",IPADDRESS="2409:8027:5003:1713::1102:101"
配置控制策略中打开携带备份AMF，命令如下。 
[SET CONTROLPOLICY]:BACKUPSWITCH="CARRY"
配置连接类消息amfngapid异常时发release消息，命令如下。 
[SET COMMU SOFTWARE PARAMETER]:ID=80,VALUE=0
##### 配置AMF容灾局 
摘要 :本节介绍在AMF容灾情况下，AMF主用局上的配置内容。例如AM1F为主用局，AMF2为容灾局，即本节介绍在AMF2上的配置内容。此时AMF1是AMF2的备份局。 
步骤 :执行[SET DISASTERSWITCHPARA]命令，修改容灾开关配置。
执行[SET DISASTERRECOVERYPOLICY]命令，配置AMF容灾策略参数。
执行[SET AMFLOCALOFFICECFG]命令，配置AMF权重。
执行[ADD OTHERAMFCFG]命令，配置备份AMF。
执行[SET CONTROLPARA]命令，配置备份AMF GTPC地址。
执行[ADD GUAMICFG]命令，配置容灾局的GUAMI。
执行[ADD AMFNRI]命令，配置备份容灾局NRI资源标识。
执行[ADD BACKUPAMF]命令，配置本局的GUAMI可被容灾局接管。
执行[ADD TAKEOVERAMF]命令，配置本局接管容灾局的GUAMI。
执行[ADD NOTIFYIP]命令，配置本AMF对应的备份AMF的Notify IP。
执行[SET CONTROLPOLICY]命令，配置控制策略中打开携带备份AMF。
执行[SET COMMU SOFTWARE PARAMETER]命令，配置连接类消息amfngapid异常时发release消息。
举例 :在配置数据之前，应当完成相关数据规划，主用局为AMF1，容灾局为AMF2，此时AMF1相对于AMF2是备份局，数据规划示例参见下表。 
配置项|参数名称|取值举例|说明
---|---|---|---
容灾开关配置|是否支持容灾功能|是|-
是否携带Timer Approach字段|容灾开关配置|是|-
无UDSF时SBI是否携带NotifyIp|容灾开关配置|是|-
容灾策略配置|容灾策略配置|无UDSF部分备份|-
AMF本局配置|AMF权重因子|100（用于中国移动和中国电信）、255（用于中国联通）|-
Set内其他AMF配置|Pointer标识|1|-
IP地址|Set内其他AMF配置|2409:802F:5003:1715::1101:101|IP地址是备份局（AMF1）的HTTP服务端地址。
端口号|Set内其他AMF配置|80|端口号备份局（AMF1）的服务端端口号。
URI Schema|Set内其他AMF配置|http|-
API版本|Set内其他AMF配置|v1|-
控制参数配置|备份AMF的GTPC地址|223.103.77.128|该地址是备份局（AMF1）的GTPC地址。
GUAMI配置|GUAMI标识|1|-
移动国家码|GUAMI配置|460|-
移动网络码|GUAMI配置|00|-
Region标识|GUAMI配置|55|该参数是备份局（AMF1）的Region标识。
Set标识|GUAMI配置|65|该参数是备份局（AMF1）的Set标识。
Point标识|GUAMI配置|1|该参数是备份局（AMF1）的Point标识。
AMF资源标识|AMF名称|amfc01.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org|该参数是备份局（AMF1）的AMF名称。
AMF资源标识|AMF资源标识|1|该参数是备份局（AMF1）的AMF资源标识。
备份AMF配置|本局GUAMI标识|2|该参数是本局（AMF2）的GUAMIID。
备份局AMF名称|备份AMF配置|amfc01.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org|该参数是备份局（AMF1）的AMF名称。
接管AMF配置|接管GUAMI标识|1|该参数是备份局（AMF1）的GUAMI标识。
接管AMF名称|接管AMF配置|amfc01.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org|该参数是备份局（AMF1）的AMF名称。
Notify IP配置|通知IP名称|AMF1|-
通知IP地址类型|Notify IP配置|IPV6|-
通知IP地址|Notify IP配置|2409:802F:5003:1715::1101:101|-
控制策略配置|携带备份AMF开关|携带|-
Communication软件参数配置|软参索引|80|控制连接类消息amfngapid异常时给RAN发送发release消息。
当前参数值|Communication软件参数配置|0|控制连接类消息amfngapid异常时给RAN发送发release消息。
根据规划，进行如下配置。 
修改容灾开关配置，命令如下。 
[SET DISASTERSWITCHPARA]:SUPPORTDISASTER="YES",TAKETIMERAPPROACH="YES",TAKENOTIIPNOUDSF="YES"
配置AMF容灾策略参数，命令如下。 
[SET DISASTERRECOVERYPOLICY]:DISASTERPOLICY="WITHOUT_UDSF_PARTIAL"
配置AMF权重。 
如果是中国移动和中国电信，命令如下。SET AMFLOCALOFFICECFG:RELATIVEAMFCAPACITY=100 
如果是中国联通，命令如下。SET AMFLOCALOFFICECFG:RELATIVEAMFCAPACITY=255 
配置备份AMF，地址是备份局（AMF2）的HTTP服务端地址，端口是备份局（AMF2）的服务端端口，命令如下。 
[ADD OTHERAMFCFG]:POINTERID=1,IPADDRESS="2409:802F:5003:1715::1101:101",PORT=80,SCHEMA="HTTP",APIVERSION="V1"
配置备份AMF GTPC地址，地址是备份局（AMF2）的GTPC地址，命令如下。 
[SET CONTROLPARA]:BACKAMFIP="223.103.77.128"
配置容灾局的GUAMI，命令如下。 
[ADD GUAMICFG]:GUAMIID=1,MCC="460",MNC="00",REGIONID=55,SETID=65,POINTID=1
配置容灾局NRI资源标识，命令如下。 
[ADD AMFNRI]:AMFNAME="amfc01.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org",AMFNRI=1
配置本局的GUAMI可被容灾局接管，GUAMI是本局（AMF1）的GUAMI标识，AMF名称是备份局（AMF2）的名称，命令如下。 
[ADD BACKUPAMF]:GUAMIID=2,AMFNAME="amfc01.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org"
配置本局接管容灾局的GUAMI，BACKUPGUAMI是备份局（AMF2）的GUAMI标识，MASTERAMFNAME是备份局（AMF2）的AMF名称，命令如下。 
[ADD TAKEOVERAMF]:BACKUPGUAMI=1,MASTERAMFNAME="amfc01.amfsi041.amfri37.amf.5gc.mnc000.mcc460.3gppnetwork.org"
配置本AMF对应的容灾局的Notify IP，命令如下。 
[ADD NOTIFYIP]:IPADDRNAME="AMF1",IPADDRTYPE="IPV6",IPADDRESS="2409:802F:5003:1715::1101:101"
配置控制策略中打开携带备份AMF，命令如下。 
[SET CONTROLPOLICY]:BACKUPSWITCH="CARRY"
配置连接类消息amfngapid异常时发release消息，命令如下。 
[SET COMMU SOFTWARE PARAMETER]:ID=80,VALUE=0
##### 配置其他NF容灾 
摘要 :本节介绍如何进行其他NF容灾配置。 
详细的功能和配置说明参见特性ZUF-79-21 容灾
。
步骤 :执行[ADD RESELECTION]命令，配置其他NF容灾AMF IP重选次数和链路重选次数。
执行[SET SMFDRPOLICYCFG]命令，修改SMF容灾策略公共配置。
执行[SET UDMDRCFG]命令，修改UDM容灾重选配置。
执行[SET PCFDRPOLICYCFG]命令，修改PCF容灾策略配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
重选配置|NF类型|AMF、SMF、PCF、UDM、AUSF、NSSF、BSF、SMSF
链路重选次数|重选配置|0
IP重选次数|重选配置|1
SMF容灾策略公共配置|故障延时判断时间(second)|0
会话释放频率(millisecond)|SMF容灾策略公共配置|500
单次查询用户个数|SMF容灾策略公共配置|60
UDM容灾重选配置|UDM无响应重选开关|无响应重选
UDM重用开关|UDM容灾重选配置|不重用
PCF容灾策略配置|PCF故障重选开关|PCF故障重选
PCF恢复后启用方式|PCF容灾策略配置|PCF恢复后启用方式为话务倒回
根据规划，进行如下配置。 
配置其他NF容灾AMF IP重选次数和链路重选次数，命令如下。 
[ADD RESELECTION]:NFTYPE="AMF",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="SMF",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="PCF",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="UDM",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="AUSF",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="NSSF",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="BSF",LINKRESELTIME=0,IPRESELTIME=1
[ADD RESELECTION]:NFTYPE="SMSF",LINKRESELTIME=0,IPRESELTIME=1
修改SMF容灾策略公共配置，命令如下。 
[SET SMFDRPOLICYCFG]:DELAYTIME=0,RELEASERATE=500,QUERYNUMBER=60
修改UDM容灾重选配置，命令如下。 
[SET UDMDRCFG]:UDMRESELECTSWITCH="SUPTUDMRESELECT",UDMREUSESWITCH="NOTSUPTUDMREUSE"
修改PCF容灾策略配置，命令如下。 
[SET PCFDRPOLICYCFG]:PCFRESELESWITCH="SWITCH_ON",PCFENABLEMODE="REVERSE"
#### 商用优化配置 
##### 配置AMF过负荷控制 
摘要 :本节介绍如何配置AMF过负荷控制。 
步骤 :执行[SET OVERLOADCFG]命令，修改过负荷控制参数。
执行[SET OLCPULEVELCFG]命令，修改CPU负荷等级。
执行[ADD OLINPUTN2SRVCFG]命令，新增N2入向业务配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
过负荷控制参数配置|是否启用CPU过负荷控制|开启
是否启用业务通过量负荷控制|过负荷控制参数配置|开启
CPU负荷等级配置|一级负荷低门限值(%)|90
二级负荷低门限值(%)|CPU负荷等级配置|80
三级负荷低门限值(%)|CPU负荷等级配置|70
四级负荷低门限值(%)|CPU负荷等级配置|60
N2入向业务配置|业务类型|初始注册、注册更新
N2口入向业务每秒每实例最大通过量|N2入向业务配置|600
过负荷控制业务权重|N2入向业务配置|50
根据规划，进行如下配置。 
修改过负荷控制参数，命令如下。 
[SET OVERLOADCFG]:OLSWITCH="AMFOLSWITCHON",SRVSWITCH="SRVSWITCHON"
修改CPU负荷等级，命令如下。 
[SET OLCPULEVELCFG]:OL1THRESHOLD=90,OL2THRESHOLD=80,OL3THRESHOLD=70,OL4THRESHOLD=60
新增N2入向业务配置，命令如下。 
[ADD OLINPUTN2SRVCFG]:SRVTYPE="REGISTRATION",OLMAXNUM=600,OLWEIGHT=50
[ADD OLINPUTN2SRVCFG]:SRVTYPE="REGISTERUPDATE",OLMAXNUM=600,OLWEIGHT=50
##### 关闭基于本地号段解析A-SMF解析策略 
摘要 :本节介绍如何关闭基于本地号段解析A-SMF解析策略。 
步骤 :执行[SET RESOLVESMFPOLICY]命令，关闭基于本地号段解析A-SMF解析策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
解析SMF策略配置|支持基于号段本地解析A-SMF地址|不支持
根据规划，进行如下配置。 
关闭基于本地号段解析A-SMF解析策略，命令如下。 
[SET RESOLVESMFPOLICY]:LOCALRESOLVEASMF="NOSPRT"
##### 配置支持I-SMF 
摘要 :本节介绍如何进行AMF支持I-SMF配置。 
前提 :已开启License项AMF支持I-SMF功能。
步骤 :执行[SET AMFSUPPORTISMF]命令，配置AMF是否支持I-SMF。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
AMF是否支持I-SMF配置|AMF是否支持I-SMF|支持
根据规划，进行如下配置。 
配置AMF支持I-SMF功能，命令如下。 
[SET AMFSUPPORTISMF]:AMFSUPPORTISMF="SUPPORT"
##### 配置AUSF和UDM原因值映射 
摘要 :本节介绍如何配置AUSF和UDM原因值映射。
步骤 :执行[SET AUSFCAUSEMAPPINGCFG]命令，修改AUSF原因值映射。
 说明： 
如果AUSF原因值映射不存在，则使用[ADD AUSFCAUSEMAPPINGCFG]命令，添加AUSF原因值映射。
执行[SET UDMCAUSEMAPPINGCFG]命令，修改UDM原因值映射。
 说明： 
如果UDM原因值映射不存在，则使用[ADD UDMCAUSEMAPPINGCFG]命令，添加UDM原因值映射。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|HTTP状态码|应用层错误码|5GMM 原因值|计数归类
---|---|---|---|---
Nausf原因值映射配置|403 Forbidden|SERVING_NETWORK_NOT_AUTHORIZED|11 - PLMN not allowed|-
403 Forbidden|Nausf原因值映射配置|AUTHENTICATION_REJECTED|27 - N1 mode not allowed|27
403 Forbidden|Nausf原因值映射配置|INVALID_HN_PUBLIC_KEY_IDENTIFIER|27 - N1 mode not allowed|27
403 Forbidden|Nausf原因值映射配置|INVALID_SCHEME_OUTPUT|27 - N1 mode not allowed|27
403 Forbidden|Nausf原因值映射配置|AUTO_SA_ENABLE|111 - Protocol error, unspecified|-
404 Not Found|Nausf原因值映射配置|CONTEXT_NOT_FOUND|111 - Protocol error, unspecified|111
404 Not Found|Nausf原因值映射配置|USER_NOT_FOUND|27 - N1 mode not allowed|27
HTTP_500|Nausf原因值映射配置|AV_GENERATION_PROBLEM|111 - Protocol error, unspecified|-
HTTP_501|Nausf原因值映射配置|UNSUPPORTED_PROTECTION_SCHEME|27 - N1 mode not allowed|27
HTTP_504|Nausf原因值映射配置|UPSTREAM_SERVER_ERROR|111 - Protocol error, unspecified|-
HTTP_504|Nausf原因值映射配置|NETWORK_FAILURE|111 - Protocol error, unspecified|-
AUSF全拥塞流控|Nausf原因值映射配置|无关|111 - Protocol error, unspecified|7
等待HTTP响应超时|Nausf原因值映射配置|无关|111 - Protocol error, unspecified|-
通配|Nausf原因值映射配置|通配|111 - Protocol error, unspecified|-
UDM原因值映射配置|403 Forbidden|UNKNOWN_5GS_SUBSCRIPTION|27 - N1 mode not allowed|27
403 Forbidden|UDM原因值映射配置|NO_PS_SUBSCRIPTION|7 - 5GS services not allowed|-
403 Forbidden|UDM原因值映射配置|ROAMING_NOT_ALLOWED|11 - PLMN not allowed|-
403 Forbidden|UDM原因值映射配置|ACCESS_NOT_ALLOWED|15 - No suitable cells in tracking area|-
403 Forbidden|UDM原因值映射配置|RAT_NOT_ALLOWED|15 - No suitable cells in tracking area|-
404 Not Found|UDM原因值映射配置|CONTEXT_NOT_FOUND|9 - UE identity cannot be derived by the network|-
404 Not Found|UDM原因值映射配置|DATA_NOT_FOUND|27 - N1 mode not allowed|27
404 Not Found|UDM原因值映射配置|USER_NOT_FOUND|27 - N1 mode not allowed|-
404 Not Found|UDM原因值映射配置|AUTO_SA_ENABLE|111 - Protocol error, unspecified|-
422 Unprocessable Entity|UDM原因值映射配置|UNPROCESSABLE_REQUEST|111 - Protocol error, unspecified|-
UDM全拥塞流控|UDM原因值映射配置|无关|111 - Protocol error, unspecified|7
等待HTTP响应超时|UDM原因值映射配置|无关|111 - Protocol error, unspecified|-
通配|UDM原因值映射配置|通配|111 - Protocol error, unspecified|-
根据规划，进行如下配置。 
设置AUSF原因值映射，命令如下。 
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="SERVING_NETWORK_NOT_AUTHORIZED",AUSFMMCAUSE="PLMNNOALLOWED"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="AUTHENTICATION_REJECTED",AUSFMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="INVALID_HN_PUBLIC_KEY_IDENTIFIER",AUSFMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="INVALID_SCHEME_OUTPUT",AUSFMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[ADD AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="AUTO_SA_ENABLE",AUSFMMCAUSE="PROTOCOLERRUNSPEC"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_404",APPLICATIONERROR="CONTEXT_NOT_FOUND",AUSFMMCAUSE="PROTOCOLERRUNSPEC",COUNTER=111
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_404",APPLICATIONERROR="USER_NOT_FOUND",AUSFMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[ADD UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_404",APPLICATIONERROR="AUTO_SA_ENABLE",UDMMMCAUSE="PROTOCOLERRUNSPEC"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_500",APPLICATIONERROR="AV_GENERATION_PROBLEM",AUSFMMCAUSE="PROTOCOLERRUNSPEC"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_501",APPLICATIONERROR="UNSUPPORTED_PROTECTION_SCHEME",AUSFMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_504",APPLICATIONERROR="UPSTREAM_SERVER_ERROR",AUSFMMCAUSE="PROTOCOLERRUNSPEC"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_504",APPLICATIONERROR="NETWORK_FAILURE",AUSFMMCAUSE="PROTOCOLERRUNSPEC"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="AUSFFULLCONGESCTL",APPLICATIONERROR="APP_NOT_APPLICABLE",AUSFMMCAUSE="PROTOCOLERRUNSPEC",COUNTER=7
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="WAITHTTPTIMEOUT",APPLICATIONERROR="APP_NOT_APPLICABLE",AUSFMMCAUSE="PROTOCOLERRUNSPEC"
[SET AUSFCAUSEMAPPINGCFG]:HTTPSTATUSCODE="ANYHTTPSTATUS",APPLICATIONERROR="ANY_APPLICATION_ERR",AUSFMMCAUSE="PROTOCOLERRUNSPEC"
设置UDM原因值映射，命令如下。 
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="UNKNOWN_5GS_SUBSCRIPTION",UDMMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="NO_PS_SUBSCRIPTION",UDMMMCAUSE="SERVICENOTALLOWED"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="ROAMING_NOT_ALLOWED",UDMMMCAUSE="PLMNNOALLOWED"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="ACCESS_NOT_ALLOWED",UDMMMCAUSE="NOSUITABLECELLSINTA"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_403",APPLICATIONERROR="RAT_NOT_ALLOWED",UDMMMCAUSE="NOSUITABLECELLSINTA"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_404",APPLICATIONERROR="CONTEXT_NOT_FOUND",UDMMMCAUSE="UEIDNOTDERIVEDBYNET"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_404",APPLICATIONERROR="DATA_NOT_FOUND",UDMMMCAUSE="N1MODENOTALLOWED",COUNTER=27
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_404",APPLICATIONERROR="USER_NOT_FOUND",UDMMMCAUSE="N1MODENOTALLOWED"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="HTTP_422",APPLICATIONERROR="UNPROCESSABLE_REQUEST",UDMMMCAUSE="PROTOCOLERRUNSPEC"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="UDMFULLCONGESCTL",APPLICATIONERROR="APP_NOT_APPLICABLE",UDMMMCAUSE="PROTOCOLERRUNSPEC",COUNTER=7
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="WAITHTTPTIMEOUT",APPLICATIONERROR="APP_NOT_APPLICABLE",UDMMMCAUSE="PROTOCOLERRUNSPEC"
[SET UDMCAUSEMAPPINGCFG]:HTTPSTATUSCODE="ANYHTTPSTATUS",APPLICATIONERROR="ANY_APPLICATION_ERR",UDMMMCAUSE="PROTOCOLERRUNSPEC"
##### 配置AMF Communication软参 
摘要 :本节介绍如何进行AMF Communication软参配置。 
步骤 :执行[SET COMMU SOFTWARE PARAMETER]命令，配置AMF Communication软参。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数ID|参数名称|取值举例
---|---|---|---
AMF Communication软参配置|13|是否支持无SUPI时缓存上报用户信令|1
59|AMF Communication软参配置|初始上下文建立失败时是否上报通信失败|1
65|AMF Communication软参配置|initial ue message偶联有效性检查失败是否要abort偶联|1
80|AMF Communication软参配置|连接类消息amfngapid异常时给RAN发送释放命令还是Error Indication|0
86|AMF Communication软参配置|是否在注册更新流程时的注册拒绝消息中携带T3502（仅中国电信要求设置）|1
91|AMF Communication软参配置|是否支持主动负载重平衡|1
92|AMF Communication软参配置|是否支持5G SA默开的特定T3502（仅中国电信要求设置）|1
93|AMF Communication软参配置|是否在未做完保的注册拒绝消息中携带T3502（仅中国电信要求设置）|1
122|AMF Communication软参配置|是否将业务请求接受消息码流填入到PDUSessionResourceSetupList中|1
128|AMF Communication软参配置|是否将注册接受消息码流填入到PDUSessionResourceSetupList中|1
130|AMF Communication软参配置|AMBR从bps转化为kbps时的取整方式|1
140|AMF Communication软参配置|收到PRA订阅后是否立即上报|0
141|AMF Communication软参配置|跨AMF注册流程中源AMF收到目标AMF UE上下文传递失败指示时是否设置响应消息中regStatusTransferComplete信元值为false|0
153|AMF Communication软参配置|AMF是否支持下发Redirection for Voice EPS Fallback指示|0
165|AMF Communication软参配置|UE-AMBR传递优化|1
170|AMF Communication软参配置|非漫游用户的DNN OI中PLMN来源|1
172|AMF Communication软参配置|SMF容灾IMS会话释放原因值|1
179|AMF Communication软参配置|v2版本的UplinkSMS中是否支持imeisv|1
180|AMF Communication软参配置|向NSSF发送更新和订阅消息时携带TA的最大个数|10000
185|AMF Communication软参配置|SmContextCreateData结构中hSmfUri, smfUri, additionalHsmfUri, additionalSmfUri信元的URI模式|1
186|AMF Communication软参配置|局间移动性注册更新，老局完整性检查失败，新局鉴权成功后，老局再次响应时UEContext是否包含SeafData|1
190|AMF Communication软参配置|是否限制用户建立多个紧急PDU|1
192|AMF Communication软参配置|是否统计业务请求流程无失败原因计数器时的请求数，用于控制版本间KPI波动过大|0
195|AMF Communication软参配置|UE安全能力校验失败时的拒绝原因值|6
196|AMF Communication软参配置|AMF局间传递是否携带smssupport字段|0
198|AMF Communication软参配置|移动性流程是否支持基于preferred-locality发现I-SMF/V-SMF|1
409|AMF Communication软参配置|当UE处于去注册态，此时AMF收到MME的context request，是否直接返回失败|1
412|AMF Communication软参配置|X1口获取用户信息填写AMF上报信息时是否强制携带上次使用的EPS PLMN标识|0
417|AMF Communication软参配置|UE从4G移动到5G，如果已经在AMF侧鉴权合法，AMF向MME要上下文是否携带GUTI|1
424|AMF Communication软参配置|启用SBI发送保序|1
430|AMF Communication软参配置|IP地址细分导致切换失败后是否释放N2连接|0
436|AMF Communication软参配置|局内切换过程中收到上行的SM、SMS、LCS等消息时的处理方式|2
443|AMF Communication软参配置|是否优化PDU级上行透传流程被冲突的处理机制|1
444|AMF Communication软参配置|紧急PDU建立失败是否使用配置原因值|1
446|AMF Communication软参配置|4到5注册是否使用从老局AMF获取到的SUPI|1
451|AMF Communication软参配置|移动性流程AS安全未建立时是否需要拒绝冲突的只携带N1容器的N1N2 Msg Transfer消息|0
452|AMF Communication软参配置|初始注册下发注册接受后被移动性注册冲突时是否拒绝移动性注册|0
457|AMF Communication软参配置|局间注册老局流程被携带本局GUTI的注册流程冲突时是否释放会话资源|1
458|AMF Communication软参配置|是否在注册流程中的鉴权流程完成之前启动异常信令管控|1
462|AMF Communication软参配置|5GS到EPS的切换流程中是否限制未请求切换的PDU建立非直传隧道|1
463|AMF Communication软参配置|HANDOVER COMMAND消息是否限制携带未请求切换的PDU信息|1
471|AMF Communication软参配置|当收到context request消息不带GUTI标识时，流程是否继续使用IMSI处理|1
473|AMF Communication软参配置|A-SMF发现携带preferred-tai时是否忽略nrfSupportedFeatures|1
484|AMF Communication软参配置|AMF是否支持连接态用户由于收到SMF的N1N2MessageTransfer触发I-SMF改变|1
根据规划，进行如下配置。 
配置AMF Communication软参，命令仅包括和默认值不一致的软参，命令如下。 
[SET COMMU SOFTWARE PARAMETER]:ID=13,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=59,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=65,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=80,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=86,VALUE=1
（仅中国电信要求设置）
[SET COMMU SOFTWARE PARAMETER]:ID=91,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=92,VALUE=1
（仅中国电信要求设置）
[SET COMMU SOFTWARE PARAMETER]:ID=93,VALUE=1
（仅中国电信要求设置）
[SET COMMU SOFTWARE PARAMETER]:ID=122,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=128,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=130,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=140,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=141,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=153,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=165,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=170,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=172,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=179,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=180,VALUE=10000
[SET COMMU SOFTWARE PARAMETER]:ID=185,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=186,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=190,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=192,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=195,VALUE=6
[SET COMMU SOFTWARE PARAMETER]:ID=196,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=198,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=409,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=412,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=417,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=424,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=430,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=436,VALUE=2
[SET COMMU SOFTWARE PARAMETER]:ID=443,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=444,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=446,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=451,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=452,VALUE=0
[SET COMMU SOFTWARE PARAMETER]:ID=457,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=458,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=462,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=463,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=471,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=473,VALUE=1
[SET COMMU SOFTWARE PARAMETER]:ID=484,VALUE=1
##### 配置AMF EE软参 
摘要 :本节介绍如何进行AMF EE软参配置。 
步骤 :执行[SET EE SOFTWARE PARAMETER]命令，配置AMF EE软参。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数ID|参数名称|取值
---|---|---|---
AMF EE软参配置|4|是否对订阅数据去重|0
根据规划，进行如下配置。 
配置AMF EE软参，命令仅包括和默认值不一致的软参，命令如下。 
SET EE SOFTWARE PARAMETER:ID=4,VALUE=0 
##### 配置AMF Communication定时器 
摘要 :本节介绍如何配置AMF Communication定时器。 
步骤 :执行[SET DEFPRETIMER]命令，配置AMF Communication定时器。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|ID|名称|当前时长(ms)
---|---|---|---
AMF Communication定时器配置|4|AMF等待UE响应时长（秒）|6000
6|AMF Communication定时器配置|AMF等待NRF发现时长（秒）|5000
9|AMF Communication定时器配置|AMF等待PCF响应时长（秒）|4000
12|AMF Communication定时器配置|AMF NRF Client等待HTTP响应时长（秒）|5000
根据规划，进行如下配置。 
配置AMF Communication定时器，命令仅包括和默认值不一致的定时器，命令如下。 
[SET DEFPRETIMER]:ID=4,VALUE=6000
[SET DEFPRETIMER]:ID=6,VALUE=5000
[SET DEFPRETIMER]:ID=9,VALUE=4000
[SET DEFPRETIMER]:ID=12,VALUE=5000
##### 配置全局参数 
摘要 :本节介绍如何配置HTTP建链负荷、服务发现缓存NfProfile最大个数、订阅有效时长和携带location进行后续订阅路由。 
步骤 :执行[ADD GLOBALPARAMETER]命令，配置HTTP建链负荷、服务发现缓存NfProfile最大个数、订阅有效时长和携带location进行后续订阅路由。
执行[RESET NFS]命令，重启HTTP_LB服务。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|编号|名称|参数值|说明
---|---|---|---|---
全局参数配置|34|建链请求报文限速值|655|（4096/N）*80%，结果向下取整，N为IPU虚机数量。以5个IPU虚机为例，该参数值为655。
35|全局参数配置|非建链请求报文限速值|655|（4096/N）*80%，结果向下取整，N为IPU虚机数量。取值以5个IPU虚机为例，该参数值为655。
53|全局参数配置|订阅有效时长|1500|单位为分钟。
61|全局参数配置|使用订阅成功响应中携带的Location进行后续订阅路由的开关|1|1表示打开，0表示关闭。
64|全局参数配置|服务发现缓存NfProfile最大个数|4096|-
根据规划，进行如下配置。 
设置全局参数，命令如下。 
配置HTTP建链负荷，命令如下。 
[ADD GLOBALPARAMETER]:ID=34,VALUE=655
[ADD GLOBALPARAMETER]:ID=35,VALUE=655
配置订阅有效时长，命令如下。 
[ADD GLOBALPARAMETER]:ID=53,VALUE=1500
配置使用订阅成功响应中携带的location进行后续订阅路由的开关，命令如下。 
[ADD GLOBALPARAMETER]:ID=61,VALUE=1
配置服务发现缓存NfProfile最大个数，命令如下。 
[ADD GLOBALPARAMETER]:ID=64,VALUE=4096
重启HTTP_LB服务，命令如下。 
[RESET NFS]:NFSNAME="CommonS_HTTP_LB_0"
##### 配置特定流程冲突处理策略 
摘要 :本节介绍如何配置特定流程冲突处理策略。 
步骤 :执行[SET PROCCOLLISIONPOLICY]命令，配置特定流程冲突处理策略。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
特定流程冲突处理策略配置|切换时收到SMF的EBI分配请求消息冲突处理策略|拒绝
注册更新时收到SMF的EBI分配请求消息冲突处理策略|特定流程冲突处理策略配置|拒绝
切换时收到SMF的PDU修改类型的N1N2消息传输冲突处理策略|特定流程冲突处理策略配置|拒绝
切换时收到SMF的PDU释放类型的N1N2消息传输冲突处理策略|特定流程冲突处理策略配置|拒绝
切换时收到SMF的PDU建立类型的N1N2消息传输冲突处理策略|特定流程冲突处理策略配置|拒绝
处理N1N2MessageTransfer时收到注册更新冲突处理策略|特定流程冲突处理策略配置|挂起N1N2MessageTransfer
业务请求时收到SMF的N1N2消息传输冲突处理策略|特定流程冲突处理策略配置|拒绝
切换时收到非SMF触发的N1N2消息传输冲突处理策略|特定流程冲突处理策略配置|缓存
切换之后等待注册更新时长(millisecond)|特定流程冲突处理策略配置|0
是否处理原因值UE上下文传输|特定流程冲突处理策略配置|否
根据规划，进行如下配置。 
修改特定流程冲突处理策略配置，命令如下。 
[SET PROCCOLLISIONPOLICY]:EBIALLOCCOLLISION="REJECT",EBIALLOCREGUPDATE="REJECT",N1N2TRANSCOLLISION="REJECT",N1N2RLSCONFLICTHO="REJECT",PDUESTANDMOB="REJECT",REGCONFLICTN1N2="SUSPEND",SRSMPLY="REJECT",MOBNONSMPLY="CACHE",DURWAITREGUPD=0,IFUECTXTRANSFER="NO"
#### 性能统计配置 
##### 配置基于TA的测量 
摘要 :本节介绍如何配置基于TA的测量。 
涉及TA测量的计数器包括： 
C51100 基于TA初始注册流程测量 
C51101 基于TA注册更新流程测量 
C51102 基于TA业务请求流程测量 
C51302 基于TA寻呼流程测量 
C51354 基于TA的用户数测量 
步骤 :执行[ADD AMFTACFG]命令，配置基于TA测量的统计对象，其中TA数据可通过[ADD TACFG]命令配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
AMF跟踪区配置|跟踪区标识|1
移动国家码|AMF跟踪区配置|460
移动网络码|AMF跟踪区配置|00
跟踪区码|AMF跟踪区配置|001122
跟踪区名称|AMF跟踪区配置|001122
根据规划，进行如下配置。 
配置基于TA测量的统计对象，命令如下。 
[ADD AMFTACFG]:TAID=1,MCC="460",MNC="00",TAC="001122",NAME="001122"
##### 配置基于S-NSSAI的测量 
摘要 :本节介绍如何配置基于S-NSSAI的测量。涉及S-NSSAI测量的计数器为“C51355 基于SNSSAI的用户数测量
”
。
步骤 :执行[ADD PMSNSSAI]命令，配置基于S-NSSAI测量的统计对象，其中S-NSSAI数据通过[ADD AMFSNSSAI]命令配置。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
S-NSSAI统计对象配置|ID|1
SST|S-NSSAI统计对象配置|1-eMBB
SD|S-NSSAI统计对象配置|NULL
根据规划，进行如下配置。 
配置基于S-NSSAI测量的统计对象，命令如下。 
[ADD PMSNSSAI]:ID=1,SST="eMBB",SD="NULL"
##### 配置基于N8链路的测量 
摘要 :本节介绍如何配置基于N8链路的测量。涉及N8链路测量的计数器为“C51140 基于链路的N8接口测量
”
。
步骤 :执行[ADD N8PMIP]命令，配置基于N8链路测量的统计对象，其中IP地址为UDM网元的HTTP业务地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
N8接口统计对象配置|ID|1
ip地址|N8接口统计对象配置|240e:180:1e0:1:ffff::24
别名|N8接口统计对象配置|UDM
根据规划，进行如下配置。 
配置基于N8链路测量的统计对象，命令如下。 
[ADD N8PMIP]:ID=1,IPADDRESS="240e:180:1e0:1:ffff::24",USERALIAS="UDM"
##### 配置基于N11链路的测量 
摘要 :本节介绍如何配置基于N11链路的测量。涉及N11链路测量的计数器为“C51141 基于链路的N11接口测量
”
。
步骤 :执行[ADD N11PMIP]命令，配置基于N11链路测量的统计对象，其中IP地址为SMF网元的HTTP业务地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
N11接口统计对象配置|ID|3
ip地址|N11接口统计对象配置|240e:180:1e1:1:ffff::13
别名|N11接口统计对象配置|SMF
根据规划，进行如下配置。 
配置基于N11链路测量的统计对象，命令如下。 
[ADD N11PMIP]:ID=3,IPADDRESS="240e:180:1e1:1:ffff::13",USERALIAS="SMF"
##### 配置基于N12链路的测量 
摘要 :本节介绍如何配置基于N12链路的测量。涉及N12链路测量的计数器为“C51142 基于链路的N12接口测量
”
。
步骤 :执行[ADD N12PMIP]命令，配置基于N12链路测量的统计对象，其中IP地址为AUSF网元的HTTP业务地址。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
N12接口统计对象配置|ID|2
ip地址|N12接口统计对象配置|240e:180:1e1:1:ffff::24
别名|N12接口统计对象配置|AUSF
根据规划，进行如下配置。 
配置基于N12链路测量的统计对象，命令如下。 
[ADD N12PMIP]:ID=2,IPADDRESS="240e:180:1e1:1:ffff::24",USERALIAS="AUSF"
##### 配置基于IMSI号段的测量 
摘要 :本节介绍如何配置基于IMSI号段的测量。涉及IMSI号段测量的为“C51352 基于IMSI号段的用户数测量
”
。
步骤 :执行[ADD IMSI SEGMENT]命令，配置基于IMSI号段测量的统计对象，其中中国移动的IMSI号段应包含所有的号段46000、46002、46004、46007、46008、46013。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
IMSI号段配置|IMSI ID|1|2|3|4|5|6
IMSI 号段|IMSI号段配置|46000|46002|46004|46007|46008|46013
根据规划，进行如下配置。 
配置基于IMSI号段测量的统计对象，命令如下。 
[ADD IMSI SEGMENT]:IMSIID=1,IMSISEGMENT="46000"
[ADD IMSI SEGMENT]:IMSIID=2,IMSISEGMENT="46002"
[ADD IMSI SEGMENT]:IMSIID=3,IMSISEGMENT="46004"
[ADD IMSI SEGMENT]:IMSIID=4,IMSISEGMENT="46007"
[ADD IMSI SEGMENT]:IMSIID=5,IMSISEGMENT="46008"
[ADD IMSI SEGMENT]:IMSIID=6,IMSISEGMENT="46013"
##### 配置基于MSISDN号段的测量 
摘要 :本节介绍如何配置基于MSISDN号段的测量。涉及MSISDN号段测量的计数器为“C51353 基于MSISDN号段的用户数测量
”
。
步骤 :执行[ADD MSISDN SEGMENT]命令，配置基于MSISDN号段测量的统计对象，其中中国移动的MSISDN号段应包含所有861号段。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
MSISDN号段配置|MSISDN ID|1
MSISDN 号段|MSISDN号段配置|861XX
根据规划，进行如下配置。 
配置基于MSISDN号段测量的统计对象，命令如下。 
[ADD MSISDN SEGMENT]:ISDNID=1,ISDNSEGMENT="861XX"
#### 配置南向接口 
摘要 :配置AMF的位置名称和显示名称。 
步骤 :执行[SET VNF]命令，输入LOCATIONNAME参数， 配置位置名称，配置原则为“大区-省份-地市”。
执行[SET VNF]命令，输入DISPLAYNAME参数， 配置显示名称。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
配置项|参数名称|取值举例
---|---|---
设置VNF|位置名称|ZG-JS-NJ
显示名称|设置VNF|AMF_158
根据规划，进行如下配置。 
配置位置名称，命令如下。 
[SET VNF]:LOCATIONNAME="ZG-JS-NJ"
配置显示名称，命令如下。 
[SET VNF]:DISPLAYNAME="AMF_158"
### 参考：数据First Download和语音First Call最简配置 
本节介绍在打通数据First Download和语音First Call时，在AMF配置的最简配置，适用于商用局局点和测试局局点。 
#### 数据First Download最简配置 
数据First Download最简配置参见下表。 
配置|备注
---|---
协议栈配置|配置VRF|-
配置地址|协议栈配置|-
配置静态路由及BFD|协议栈配置|-
检查名称|-|检查名称
配置CDB|-|配置CDB
业务基础配置|公共基础数据配置|-
配置本局信息|业务基础配置|-
配置切片功能|业务基础配置|-
配置HTTP模板|业务基础配置|-
配置服务|业务基础配置|-
业务接口配置|配置N2接口信息|-
配置与NRF对接数据|业务接口配置|当NRF不具备条件时，可以采用静态路由方式对接其他网元，具体配置方法请联系中兴通讯技术支持。
移动性管理|配置注册区域|-
安全配置|配置加密完保|-
#### 语音First Call最简配置 
语音First Call最简配置基于数据业务新增以下配置，参见下表。 
配置|备注
---|---
业务功能配置|配置VoNR和EPSFallback|已开启License项AMF支持VONR功能。由于5G建网初期，NR不能实现连续覆盖，建议采用EPS Fallback实现语音业务。
配置支持N26接口的4/5G互操作|业务功能配置|已开启License项AMF支持N26互操作功能。建议语音First Call采用本地解析MME，商用后再对接DNS。打开License中的“AMF支持N26互操作功能”。
## 缩略语 
## 缩略语 
APN :Access Point Name接入点名称
AUSF :Authentication Server Function鉴权服务器功能
### BFD 
Bidirectional Forwarding Detection双向转发检测
### BSC 
Base Station Controller基站控制器
### BVCI 
BSSGP
Virtual Connection IdentifierBSSGP虚连接标识符
### CDB 
Cloud Database云数据库
### CDU 
Cloud Database Unit云数据库单元
### CG 
Charging Gateway计费网关
DNS :Domain Name System域名系统
Domain Name Server域名服务器
### DRA 
Diameter Routing AgentDiameter路由代理
EIR :Equipment Identity Register设备标识寄存器
EPC :Evolved Packet Core演进的分组核心网
### EPLMN 
Equivalent Public Land Mobile Network对等公用陆地移动网
EPS :Evolved Packet System演进的分组系统
FQDN :Fully Qualified Domain Name全称域名
GGSN :Gateway GPRS Support NodeGPRS网关支持节点
### GMT 
Greenwich Mean Time格林尼治标准时间
GPRS :General Packet Radio Service通用无线分组数据业务
### GR 
Graceful Restart优雅重启
### GTP-C 
GTP Control PlaneGTP控制面
### GTP-U 
GTP User PlaneGTP用户面
GTP :GPRS Tunneling ProtocolGPRS隧道协议
### GUAMI 
Globally Unique AMF ID全球唯一AMF标识
### GUI 
Graphical User Interface图形用户界面
### GUMMEI 
Globally Unique MME Identifier全球唯一移动性管理实体标识
HLR :Home Location Register归属位置寄存器
### HPLMN 
Home Public Land Mobile Network归属公众陆地移动网
HSS :Home Subscriber Server归属用户服务器
IMEI :International Mobile Equipment Identity国际移动设备标识
### IMEISV 
International Mobile Equipment Identity and Software Version number国际移动设备识别码和软件版本号
IMS :IP Multimedia SubsystemIP多媒体子系统
IMSI :International Mobile Subscriber Identity国际移动用户标识
IPv4 :Internet Protocol version 4第四版互联网协议
IPv6 :Internet Protocol Version 6IP协议的版本6
### LAC 
Location Area Code位置区码
### LAI 
Location Area Identity位置区标识
### LCS 
LoCation Services定位业务
### LMF 
Location Management Function定位管理功能
LTE :Long Term Evolution长期演进
### MAP 
Mobile Application Part移动应用部分
### MCC 
Mobile Country Code移动国家码
MME :Mobility Management Entity移动管理实体
### MMEC 
MME CodeMME编码
### MNC 
Mobile Network Code移动网络号
MSC :Mobile Switching Center移动交换中心
NAS :Network Attached Storage网络附加存储
### NSE 
Network Service Entity网络服务实体
### NSEI 
Network
Service Entity Identifier网络业务实体标识
### NSVC 
Network Service Virtual Connection网络服务虚连接
### NTP 
Network Time Protocol网络时间协议
OAM :Operation, Administration and Maintenance操作管理维护
PDN :Packet Data Network分组数据网
PDP :Packet Data Protocol分组数据协议
PGW :PDN Gateway分组数据网网关
PLMN :Public Land Mobile Network公共陆地移动网
### RA 
Routing Area路由区
### RAC 
Routing Area Code路由区域码
### RAI 
Routing Area Identity路由区标识
### RAU 
Routing Area Update路由区更新
### RD 
Route Distinguisher路由标识符
RNC :Radio Network Controller无线网络控制器
S-NSSAI :Single Network Slice Selection Assistance Information单个网络切片选择辅助信息
### S1AP 
S1 Application ProtocolS1应用协议
SCTP :Stream Control Transmission Protocol流控制传输协议
SGSN :Serving GPRS Support Node服务GPRS支持节点
SGW :Serving Gateway服务网关
### SRNS 
Serving RNS服务无线网络子系统
### SRVCC 
Single Radio Voice Call Continuity单射频语音呼叫连续性
### STP 
Signaling Transfer Point信令转接点
TA :Tracking Area跟踪区域
### TAC 
Tracking Area Code跟踪区域码
### TAI 
Tracking Area Identity跟踪区标识
TAU :Tracking Area Update跟踪区域更新
TCP :Transmission Control Protocol传输控制协议
UDM :Unified Data Management统一数据管理
### UDP 
User Datagram Protocol用户数据报协议
UE :User Equipment用户设备
### VLR 
Visitor Location Register拜访位置寄存器
### VPN 
Virtual Private Network虚拟专用网
### VRF 
Virtual Route Forwarding虚拟路由转发
### VoLTE 
Voice over LTELTE语音
VoNR :Voice over New Radio新空口承载语音
### eMSC 
Enhanced Mobile Switching Center增强移动交换中心
eNodeB :Evolved NodeB演进的NodeB
## 个人数据保护 
特性描述 :特性描述 :术语 :无。 
描述 :定义 :GDPR，即通用数据保护条例，是2016年4月27日在欧洲议会通过的《一般数据保护条例》法律条例，并在2018年5月25日生效。 
uMAC支持GDPR是指产品遵守欧盟的《一般数据保护条例》。 
背景知识 :GDPR中的个人信息是指通过已识别或可识别的自然人相关的任何数据，包括姓名、身份证号、定位数据、网络标识符以及特定的身体、心理、基因、精神状态、经济、文化、社会身份等识别符能够直接或间接识别到身份的自然人。 
GDPR保护的个人数据包括但不限于姓名，照片，电话，邮件地址，身份证号，住宅地址，信用评分，指纹，基因，员工ID，出生日期，婚姻状况，个人账号，信息记录，工作经历，教育背景，薪资，IP地址，IMSI，IMEI，位置信息，设备ID。 
 说明： 
单独使用或结合其他信息使用时能够确定个人身份的信息的数据也属于个人数据。 
依据GDPR的法规要求，个人数据的处理应遵循以下原则。 
正当、合法、透明：数据主体的个人数据应当以正当、合法、透明的方式被处理 
目的限制：个人数据应当基于具体、明确、合法的目的收集，不应以与此目的不相容的方式进一步处理 
数据最小化：处理的个人数据应与处理数据的目的是适当、相关且必要的 
准确性：个人数据应当是准确的，并在必要的情况下及时更新，根据数据处理的目的，采取合理的措施确保及时删除或修正不准确的个人数据 
存储期限：存储个人数据不超过处理目的所必要的期限 
完整性与保密性：采取必要的技术或组织措施确保个人数据的适度安全，包括防止未授权或非法处理个人数据、数据丢失或毁损 
可归责：数据控制者须负责且能展示遵从上述原则 
针对ZXUN uMAC产品的产品特性，有下列5类数据为个人隐私数据需要关注。
数据类型|数据描述|处理策略
---|---|---
IMSI/SUPI|An IMSI is a unique ID that the switching system of the core network allocates to a mobile subscriber.|需要脱敏处理
MSISDN|A MSISDN is the number dialed when a caller calls a mobile subscriber in a PLMN.|需要脱敏处理
IMEI/IMEISV/PEI|An IMEI/IMEISV identifies a mobile terminal.|需要脱敏处理
position|A location is the latitude and longitude coordinates provided by the BSC/RNC/eNB/NR.|不做脱敏处理，管理规范限制其数据溢出
Dynamic/Static IP address|PGW provide to subscriber for packet data service.|不做脱敏处理，管理规范限制其数据溢出
针对个人数据保护的权限控制有三类。 
个人数据明文显示对登录用户查看个人数据是否显示明文进行权限控制，无此权限的用户只显示安全保护处理后的个人数据。 
个人数据明文导出对登录用户是否有权限导出个人数据进行权限控制。有此权限的用户能够同时具备导出明文和匿名文件的权限。有此权限用户，自动赋予个人数据匿名导出权限。有此权限的用户自由选择明文导出或匿名导出。赋予此权限时，系统自动检查用户是否有个人数据明文显示权限，如没有则无法赋予此权限。用户在明文导出文件时，界面给出隐私保护警告提示。 
个人数据匿名导出对登录用户是否有权限导出安全保护处理后的个人数据进行权限控制。如果用户不具有个人数据明文导出和个人数据匿名导出权限，则禁止导出。 
应用场景 :###### 场景1：动态管理支持GDPR 
MME/SGSN/AMF动态管理要根据用户GDPR权限对个人用户数据进行安全保护，保证为不同权限的用户显示明文或匿名的动态管理，并控制动态管理文件明文或匿名导出。 
###### 场景2：信令跟踪支持GDPR 
MME/SGSN/AMF信令跟踪要根据用户GDPR权限对个人用户数据进行安全保护，保证为不同权限的用户显示明文或匿名的信令跟踪，并控制信令跟踪文件明文或匿名导出。 
###### 场景3：失败观察支持GDPR 
MME/SGSN/AMF要根据用户GDPR权限对失败观察附加信息中的个人用户数据进行安全保护。 
###### 场景4：运行日志支持GDPR 
运行日志包括操作日志、系统记录日志、安全日志等，MME/SGSN/AMF根据用户GDPR权限对其中的个人用户数据进行安全保护。 
###### 场景5：告警支持GDPR 
MME/SGSN/AMF告警中涉及个人用户数据，MME/SGSN/AMF根据用户GDPR权限进行安全保护。 
###### 场景6：前台话单支持GDPR 
SGSN前台暂存的CDR包含用户号码，需要执行安全保护。 
实现原理 :系统架构 :uMAC产品MME、SGSN和AMF各自网元内部处理，不涉及对外网元交互。 
涉及的网元 :网元名称|网元作用
---|---
MME|MME对动态管理、信令跟踪、失败观察、运行日志和告警根据用户GDPR权限对个人用户数据进行安全保护。
SGSN|SGSN对动态管理、信令跟踪、失败观察、运行日志、告警和前台话单根据用户GDPR权限对个人用户数据进行安全保护。
AMF|AMF对动态管理、信令跟踪、失败观察和运行日志根据用户GDPR权限对个人用户数据进行安全保护。
本网元实现 :MME/SGSN/AMF的处理包括： 
OAM登录时增加隐私保护警告 
个人数据保护权限控制 
个人数据界面增强保护 
个人数据存储保护 
密钥中心统一管理密钥 
网络间使用安全的传输协议进行数据传输 
证书管理和数字签名 
算法定义 
OAM登录时增加隐私保护警告
用户登录系统时给出隐私保护警告提示。 
OAM涉及的场景：ssh/netconf登录。 
个人数据保护权限控制
系统新增个人数据明文显示、个人数据明文导出和个人数据匿名导出三个权限；升级、全新安装后用户默认不具有这三个权限，需要通过权限管理功能追加权限。
三个权限对登录用户的个人数据查看和导出行为进行权限控制。 
个人数据明文显示对登录用户查看个人数据是否显示明文进行权限控制，无此权限的用户只显示匿名化处理后的个人数据。 
个人数据明文导出对登录用户是否有权限导出个人数据，进行权限控制。有此权限用户，能够同时具备导出明文和匿名文件的权限。有此权限用户，自动赋予个人数据匿名导出权限。有此权限的用户自由选择明文导出或匿名导出。赋予此权限时，系统自动检查用户是否有个人数据明文显示权限，如没有则无法赋予此权限。用户在明文导出文件时，界面给出隐私保护警告提示。 
个人数据匿名导出对登录用户是否有权限导出匿名化处理后的个人数据，进行权限控制。如果用户不具有个人数据明文导出和个人数据匿名导出权限，则禁止导出。结合典型运维场景（运维示例，非系统默认定义角色），个人数据界面显示、导出权限控制设置参见下表。角色行为能力“个人数据明文显示”权限“个人数据明文导出”权限“个人数据匿名导出”权限数据保护官（DPO）个人数据界面明文显示、明文导出有有有客户运维人员个人数据界面明文显示、匿名导出研发排障必须通过客户运维人员导出数据有或无无有或无第三方代维人员个人数据界面明文显示、不能导出有或无无无admin系统预置的超级用户，不受权限控制日常运维不使用该用户，仅用于高级管理员设备上线后，运营商应修改密码回收帐号有有有 
个人数据界面增强保护
界面显示增加水印，不区分是否含有个人数据信息的界面水印内容包含用户名、登录时间、运营商LOGO（可配置） 
含有个人数据信息的界面，界面禁用拷贝功能，包括Ctrl+C、鼠标右键复制客户端拷贝事件捕获，弹出警告 
任何用户，每次登录增加隐私保护警告用户登录系统时给出隐私保护警告提示，用户确认后可以登录否则禁止登录。 
个人数据存储保护
本地文件保护，通过如下手段对包含个人数据的四类文件（数据库文件、文本类日志文件、文本类的备份文件、文本类导出文件）进行保护。文件权限严格设定，禁止非程序运行用户外的其他用户访问（操作系统访问权限被客户收回）。文件目录禁用远程访问，如必须访问的特定文件目录需设置口令。个人数据所在的数据库中的表字段不加密（原有逻辑已经加密的，保持原有处理），数据库文件需要进行访问控制。个人数据所在的数据库导出保存在服务器本地文件系统上时，备份文件进行访问控制。记录日志时直接进行匿名化处理。存储期限管理本地存储的非持久化文件，临时文件用完后直接删除；需要配合其他系统（如EMS）使用需要留存一定时间的临时数据，定期进行清理。 
传递到本服务器外的文件保护，通过如下手段对包含个人数据的两类文本类（数据库文件、文本类的备份文件）进行保护。远程备份的文件设置口令，且口令强度达到安全标准（强密码）。增加口令管理，确保口令可追溯。OAM波及：安全模块将sqlite中的个人信息去掉；PG数据库、ZDB有密码保护不波及，Sqlite数据库废弃，转移到ZDB中；运行期日志一律不记录个人信息；需要上传给EMS的性能数据有定期清理策略。 

密钥中心统一管理密钥
提供统一的密钥管理功能，使得密钥安全可控，支持集中配置秘钥，且能统一下发密钥，密钥中心应具备以下能力。 
支持对接上级密钥中心，在无上级密钥中心场景，能够提供本地密钥中心。 
上下级密钥传输采用标准的密钥传输协议（IKE） 
密钥用于加密和匿名化方法 
在有EMS的情况下，为了上下级数据能够关联起来，需要统一EMS和OAM上的秘钥数据，也就是说，OAM上的秘钥从EMS上获取；在没有EMS的情况下，为了下级各模块数据的关联，OAM上维护一个统一的秘钥。 
网络间使用安全的传输协议进行数据传输
网元之间的协议，如果是3GPP规范规定的保持不变；自定义协议，如OAM和网元、OAM和EMS之间，系统间网络传输的通道需要使用安全传输协议，传输要求通道必须加密，安全通道要求原则如下。 
TCP\UDP通道支持IpSec 
Http     通道支持TLS 1.2 
Snmp通道支持SNMP V3.0 
Ftp通道支持SFTP 
传输使用到的证书，在内部对接时可使用自生成证书，如需与第三方对接需运营商购买合法签发的证书。 
OAM波及：ssh/netconf登录；web方式登录；各模块与EMS之间的通道。 
证书管理和数字签名
内部使用，不跟第三方对接，使用自己生成的证书。 
与第三方对接的证书，由运营商提供。 
算法定义
对于需要还原的个人数据采用对称加密算法，统一为AES256。 
对于无需还原或需要发出EEA范围之外的个人数据采用非对称HASH算法，统一为HMAC-SHA256。 
业务流程 :无。 
系统影响 :本特性涉及匿名化加密处理，大部分功能在后台执行，仅少量在前台进行，对前台性能影响较小。 
应用限制 :该特性应用于遵从欧洲《一般数据保护条例》（简称“GDPR”）法律条例的现网环境。 
特性交互 :无。 
遵循标准 :GDPR（General Data Protection Regulation）《通用数据保护条例》。
特性能力 :无。 
可获得性 :License要求 :系统通过“个人数据保护”（Personal data protection）License项，控制个人数据保护功能开启或关闭。 
“个人数据保护”开启时GDPR生效 
“个人数据保护”关闭时维持原有实现方式 
对其他网元的要求 :本特性完成uMAC自身网元的GDPR保护，不涉及与其他网元的交互。 
工程规划要求 :支持GDPR需要在EMS上开启GDPR，工程实施保证同步打开网元对应的GDPR License开关。EMS上配置安全秘钥，区分用户明文或匿名的显示和导出权限。 
特性配置 :特性配置 :配置说明 :uMAC网元和网管EM中都启用LICENSE_PERSONAL_DATA_PROTECTION，通过配置实现不同级别用户的GDPR权限控制。 
配置前提 :uMAC通信状态正常。 
uMAC对接EM成功。 
配置实例 :###### 加载GDPR功能LICENSE 
加载网元uMAC 的License在EM客户端维护页签的网元许可证管理界面下，选择需要加载License的网元，单击发布，进入许可证发布页面。上传License文件，单击发布。uMAC中查询LICENSE命令为 SHOW LICENSE。如果查询结果中“Support GDPR Function”选项为ENABLE，表示uMAC已启用GDPR功能。 
加载网管EM的License在EM客户端系统页签的许可证管理界面下，单击替换，上传要加载的License文件。EM中在许可证管理界面下查看控制项列表，GDPR开关使能控制项为TRUE，表示EM已启用GDPR功能。 
###### 低权限用户操作 
低权限用户指超级管理员之外的所有用户 
低权限用户只能设置外部信令跟踪，不能设置内部信令跟踪，信令跟踪只能保存外部消息。 
信令跟踪中涉及概要解码，详细解码，不涉及原始码流。 
信令跟踪，失败观察跟踪结果中不包含用户敏感信息或者用户敏感信息被匿名化。 
信令跟踪、失败观察支持保存导出，导出格式仅支持txt和html格式，不支持pcap和sta格式 。 
数据跟踪支持pcap格式保存，保留每条数据的前40字节，后面的字节被截断。 
###### 高权限用户操作 
高权限用户指超级管理员。 
高权限用户只能设置外部信令跟踪，不能设置内部信令跟踪，信令跟踪只能保存外部消息。 
信令跟踪中设计概要解码，详细解码和原始码流。 
信令跟踪，失败观察跟踪信息中用户敏感信息明文显示，不匿名化。 
信令跟踪、失败观察支持保存导出，导出格式仅仅支持txt和html格式，不支持pcap和sta格式 ，保存结果与低权限保存一致。 
数据跟踪支持pcap格式保存，保留每条数据的前40字节，后面的字节被截断。 
调整特性 :###### 数据跟踪pcap文件裁剪功能 
数据跟踪保存的文件，每条数据前40字节数是原内容，其后的内容被截断。 
###### 基于IMSI号段的流量统计功能 
基于IMSI号段的流量统计功能在导出性能统计数据时，需要对用户IMSI进行匿名化。
###### 快照功能 
不支持。 
###### 动态命令脱敏功能 
执行动态命令，返回信息做脱敏处理，涉及命令如下。 
SHOW USERDATA 
SHOW BAKDATAPOOL 
SHOW SUBSCRIBER SIGSTATUS 
SHOW BLACK SUBSCRIBER 
SHOW SGSN SUBSCRIBER SIGSTATUS 
SHOW SGSN BLACK SUBSCRIBER 
SHOW TCE INFO 
SHOW COMMON MSISDN 
SHOW CMP MODULE 
REPORT DATAVOL 
PURGE SUBS 
SHOW MME COMMON MSISDN 
SHOW GUTI IMSI 
SHOW SGSNUSERSUB 
SHOW SGSNUSERDYN 
SHOW MMEUSERDYN 
SHOW MMEUSERSUB 
测试用例 :###### License中Personal_Data_Protection打开，高权限用户 
测试项目|GDPR功能
---|---
测试目的|测试高权限用户的GDPR功能
预置条件|uMAC 的License中Personal_Data_Protection设置为enable。EM 的License中Personal_Data_Protection设置为enable。uMAC和EM对接正常。
测试过程|高权限用户登录EM。新建用户跟踪，数据跟踪，失败观察。用户进行附着，做业务。在用户跟踪，失败观察界面，选择要导出文件，点击导出已选。
通过准则|用户跟踪的概要解码，详细解码，原始码流正常显示，不做匿名处理。导出保存文件仅支持txt 和html格式，不支持pcap和sta格式。失败观察概要解码，详细解码正常显示，原始码流隐藏。导出保存文件仅支持txt 和html格式，不支持pcap和sta格式。信令跟踪导出成功，保存的文件其中IMSI，IMEI，MSISDN号码等信息被匿名处理。失败观察导出成功，保存的文件其中IMSI，IMEI，MSISDN号码等信息被匿名处理。数据跟踪文件下载成功，仅保留报文的前40个字节。
测试结果|
###### License中Personal_Data_Protection打开，低权限用户 
测试项目|GDPR功能
---|---
测试目的|测试低权限用户的GDPR功能
预置条件|uMAC 的License中Personal_Data_Protection设置为enable。EM 的License中Personal_Data_Protection设置为enable。uMAC和EM对接正常。
测试过程|普通用户登录EM。新建用户跟踪，失败观察 ，数据跟踪。用户进行附着，做业务。在用户跟踪，数据跟踪、失败观察界面，选择保存各格式文件。
通过准则|用户跟踪的概要解码，详细解码中的敏感信息做匿名处理，原始码流不显示。导出保存文件仅支持txt 和html格式，不支持pcap和sta格式。失败观察概要解码，详细解码中的敏感信息做匿名处理，原始码流不显示。导出保存文件仅支持txt 和html格式，不支持pcap和sta格式。信令跟踪导出成功，保存的文件其中IMSI，IMEI，MSISDN号码等信息被匿名处理。失败观察导出成功，保存的文件其中IMSI，IMEI，MSISDN号码等信息被匿名处理。数据跟踪文件下载成功，仅保留报文的前40个字节。
测试结果|
## 缩略语 
## 缩略语 
IMEI :International Mobile Equipment Identity国际移动设备标识
IMSI :International Mobile Subscriber Identity国际移动用户标识
MSISDN :Mobile Station International Subscriber Directory Number移动台国际用户目录号
## 网络通信端口表 
说明 :概述 :本节介绍了ZXUN uMAC产品通信矩阵的相关解释说明。
#### 结构 
通信矩阵的详细描述参见[端口清单]，通讯矩阵结构中各列项目的含义参见下表。
项目|含义
---|---
接口|网元之间的接口名称。
本端网元|本端的网元名称，ZXUN uMAC的本端网元包括ZXUN uMAC-MME、ZXUN uMAC-SGSN、ZXUN uMAC-AMF。
本端端口|本端的端口号。
对端网元|与本端对接的对端网元名称。
对端端口|对端的端口号。
协议|该接口采用的协议。
描述|简单介绍该接口的相关信息。
 说明： 
涉及到具体的地址和端口号，需根据现场实际情况来配置。 
### 端口清单 
#### ZXUN uMAC-MME的端口清单 
接口|本端网元|本端端口|对端网元|对端端口|协议|描述
---|---|---|---|---|---|---
S1|ZXUN uMAC-MME|SCTP：[1, 65535]|eNodeB|SCTP：[1, 65535]|S1AP|用于MME网元和eNodeB网元的S1接口，使用S1AP协议。
S10|ZXUN uMAC-MME|UDP：2123、[30000, 31024]|MME|UDP：2123|GTPv2-C|用于MME网元和MME网元的S10接口，使用GTPv2-C协议。
S11|ZXUN uMAC-MME|UDP：2123、[30000, 31024]|SGW|UDP：2123|GTPv2-C|用于MME网元和SGW网元的S11接口，使用GTPv2-C协议。
S6a|ZXUN uMAC-MME|SCTP：[1, 65535]|HSS|SCTP：[1, 65535]|DIAMETER|用于MME网元和HSS网元的S6a接口，使用DIAMETER协议。
SGs|ZXUN uMAC-MME|SCTP：[1, 65535]|MSC|SCTP：[1, 65535]|SGsAp|用于MME网元和MSC网元的SGs接口，使用SGsAp协议。
UBAS|ZXUN uMAC-MME|UDP：[60001, 60250]|UBAS|UDP：[1, 65535]|Private|用于MME网元和UBAS网元的UBAS接口，使用中兴通讯私有协议。
DNS|ZXUN uMAC-MME|UDP：[51000, 51024]|DNS-Server|UDP：53|DNS|用于MME网元和DNS网元的DNS接口，使用DNS的协议，底层使用UDP协议。
ZXUN uMAC-MME|DNS|TCP：[51000, 59199]|DNS-Server|TCP：53|DNS|用于MME网元和DNS网元的DNS接口，使用DNS的协议，底层使用TCP协议。
#### ZXUN uMAC-SGSN的端口清单 
接口|本端网元|本端端口|对端网元|对端端口|协议|描述
---|---|---|---|---|---|---
Gb|ZXUN uMAC-SGSN|UDP：[40000, 40999]|BSC|UDP：[1, 65535]|BSSGP|用于SGSN网元和BSC网元的Gb接口，使用BSSGP协议，NS提供了透明的非确认的信令传送通道。
Iu|ZXUN uMAC-SGSN|UDP：2123、[30000, 31024]|RNC|UDP：2123|GTP-V1|用于SGSN网元和RNC网元的Iu接口，使用GTP-V1协议。
ZXUN uMAC-SGSN|Iu|UDP：2152|RNC|UDP：2152|GTP-V1|用于SGSN网元和RNC网元的Iu接口，使用GTP-V1协议。
Gn/Gp|ZXUN uMAC-SGSN|UDP：3386、[30000, 31024]|GGSN/SGSN|UDP：3386|GTP-V0|用于SGSN网元和GGSN/SGSN网元的Gn/Gp接口，使用GTP-V0协议。
ZXUN uMAC-SGSN|Gn/Gp|UDP：2123、[30000, 31024]|GGSN/SGSN|UDP：2123|GTP-V1|用于SGSN网元和GGSN/SGSN网元的Gn/Gp接口，使用GTP-V1协议。
ZXUN uMAC-SGSN|Gn/Gp|UDP：3386|GGSN/SGSN|UDP：3386|GTP-V0|用于SGSN网元和GGSN/SGSN网元的Gn/Gp接口，使用GTP-V0协议。
ZXUN uMAC-SGSN|Gn/Gp|UDP：2152|GGSN/SGSN|UDP：2152|GTP-V1|用于SGSN网元和GGSN/SGSN网元的Gn/Gp接口，使用GTP-V1协议。
Ga|ZXUN uMAC-SGSN|UDP：[35000, 35255]|CGF|UDP：3386|GTP'|用于SGSN网元和CGF网元的Ga接口，使用GTP'协议。当SGSN Ga口使用单地址时使用。
ZXUN uMAC-SGSN|Ga|UDP：[1, 65535]|CGF|UDP：3386|GTP'|用于SGSN网元和CGF网元的Ga接口，使用GTP'协议。当SGSN Ga口使用多地址时使用。
Gf|ZXUN uMAC-SGSN|SCTP：[1, 65535]|EIR|SCTP：[1, 65535]|MAP|用于SGSN网元和EIR网元的Gf接口，使用MAP协议。
Gr|ZXUN uMAC-SGSN|SCTP：[1, 65535]|HLR|SCTP：[1, 65535]|MAP|用于SGSN网元和HLR网元的Gr接口，使用MAP协议。
Gs|ZXUN uMAC-SGSN|SCTP：[1, 65535]|MSC/VLR|SCTP：[1, 65535]|BSSAP+|用于SGSN网元和MSC/VLR网元的Gs接口，使用BSSAP+协议。
UBAS|ZXUN uMAC-SGSN|UDP：[15000, 15255]|UBAS|UDP：[1, 65535]|Private|用于SGSN网元和UBAS网元的UBAS-C接口，使用中兴通讯私有协议。
ZXUN uMAC-SGSN|UBAS|UDP：[16024, 16279]|UBAS|UDP：[1, 65535]|Private|用于SGSN网元和UBAS网元的UBAS-U接口，使用中兴通讯私有协议。
DNS|ZXUN uMAC-SGSN|UDP：[51000, 51024]|DNS-Server|UDP：53|DNS|用于SGSN网元和DNS网元的DNS接口，使用DNS的协议，底层使用UDP协议。
ZXUN uMAC-SGSN|DNS|TCP：[51000, 59199]|DNS-Server|TCP：53|DNS|用于SGSN网元和DNS网元的DNS接口，使用DNS的协议，底层使用TCP协议。
#### ZXUN uMAC-AMF的端口清单 
接口|本端网元|本端端口|对端网元|对端端口|协议|描述
---|---|---|---|---|---|---
N2|ZXUN uMAC-AMF|SCTP：[1, 65535]、5000、38412|gNodeB|SCTP：[1, 65535]|NG-AP|用于AMF网元和gNodeB网元的N2接口，使用NG-AP协议。
N26|ZXUN uMAC-AMF|UDP：2123、[30000, 31024]|MME|UDP：2123|GTPv2-C|用于AMF网元和MME网元的N26接口，使用GTPv2-C协议。
N11|ZXUN uMAC-AMF|TCP：2123、[30000, 31024]|SMF|TCP：2123|GTPv2-C|用于AMF网元和MME网元的SMF接口，使用GTPv2-C协议。
SBI|ZXUN uMAC-AMF|客户端端口：[10000, 60000]服务端端口：80、443、8080|其它5GC网元|[1, 65535]|HTTP/HTTP2/HTTPS|用于AMF网元和其他5GC网元的服务化接口，使用HTTP或HTTP2或HTTPS协议。
DNS|ZXUN uMAC-AMF|UDP：[60000, 61024]|DNS-Server|UDP：53|DNS|用于AMF网元和DNS网元的DNS接口，使用DNS的协议，底层使用UDP协议。
ZXUN uMAC-AMF|DNS|TCP：[61000, 63040]|DNS-Server|TCP：53|DNS|用于AMF网元和DNS网元的DNS接口，使用DNS的协议，底层使用TCP协议。
EMS+|ZXUN uMAC-AMF|-|EMS+服务器|-|Private|用于AMF网元和EMS+服务器的EMS+接口，使用中兴通讯私有协议。
#### 开放端口清单 
接口|端口|协议|描述
---|---|---|---
系统端口|22|TCP|SSH方式登录时使用。
OAM端口|2332|TCP|WEB客户端访问端口。
OAM端口|2333|TCP|WEB客户端双向认证端口（OAMV4.20.13.B4版本开始支持）。
OAM端口|7700|TCP|OAM监测NDF告警上报客户端连接的端口号。
OAM端口|7722|TCP|OAM支持基于SSH协议的MML配置交互端口号。
OAM端口|7778|TCP|OAM支持单向认证HTTP服务器端口号。
OAM端口|7788|TCP|OAM支持基于SSH协议的MML输出格式化的MML配置交互端口号。
OAM端口|7800|TCP|OAM基于SSH协议的NDF告警上报端口。
OAM端口|8777|TCP|OAM支持单向认证HTTPS服务器端口号。
OAM端口|8778|TCP|OAM支持双向认证HTTPS服务器端口号。
OAM端口|8780|TCP|OAM支持TCF 单向HTTPS服务器端口号（OAMV4.20.12.B5版本开始支持）。
OAM端口|29029|TCP|OAM提供的SFTP服务器的端口号。
平台端口|10000|TCP|PLAT_MGT专用。ushell 调试使用。
OAM端口|30161|UDP|OAM SNMP Agent接收请求的端口号。
OAM端口|30162|UDP|OAM SNMP服务器的端口号。
平台端口|6124|UDP|给JOB发消息所监测的端口。
平台端口|6125|UDP|给JOB发消息所监测的端口。
平台端口|6224|UDP|关联TULIP组件，用于UDP通讯。
平台端口|6225|UDP|关联TULIP组件，用于UDP通讯。
平台端口|6230|UDP|关联TULIP组件，用于UDP通讯。
平台端口|8112|UDP|TIPC用户态承载的UDP端口.
平台端口|20001|UDP|接收PP节点模拟BOOT上电上报消息。
平台端口|[32768, 60999]|UDP|平台临时通讯端口。
平台端口|7790|UDP|仲裁服务监测端口(IAAS版本)，用于IPv4监测。
平台端口|7791|UDP|仲裁服务监测端口(IAAS版本)，用于IPv6监测。
MME/SGSN端口|26001|UDP|UDPWatch端口。
OAM端口|61514|UDP|OAM网元日志远程输出端口。
## 缩略语 
## 缩略语 
AMF :Access and Mobility Management Function接入和移动管理功能
### BSC 
Base Station Controller基站控制器
### BSSGP 
Base
Station Subsystem GPRS Protocol基站子系统GPRS协议
### CGF 
Charging
Gateway Function 计费网关功能
DNS :Domain Name System域名系统
EIR :Equipment Identity Register设备标识寄存器
eNodeB :Evolved NodeB演进的NodeB
GGSN :Gateway GPRS Support NodeGPRS网关支持节点
HLR :Home Location Register归属位置寄存器
HSS :Home Subscriber Server归属用户服务器
### MAP 
Mobile Application Part移动应用部分
MME :Mobility Management Entity移动管理实体
MSC :Mobile Switching Center移动交换中心
### NDF 
Native Direct Function本地直连接口
OAM :Operation, Administration and Maintenance操作管理维护
RNC :Radio Network Controller无线网络控制器
### S1AP 
S1 Application ProtocolS1应用协议
SCTP :Stream Control Transmission Protocol流控制传输协议
SGSN :Serving GPRS Support Node服务GPRS支持节点
SGW :Serving Gateway服务网关
### UBAS 
User Behavior Analysis System用户行为分析系统
