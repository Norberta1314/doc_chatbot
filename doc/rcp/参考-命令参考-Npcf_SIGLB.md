专业维护 :专业维护 :

[](None)背景知识 


专业维护用于查询短信服务的内部统计和短信相关信息。 




[](None)功能说明 


该节点包括内部统计和短信信息管理。 




[](None)子主题： 






## 内部统计 
## 内部统计 


[](None)背景知识 


PCF需要提供一种方式用于运维人员通过EM界面查询系统运行信息，以快速检查系统运行的状态。 




[](None)功能说明 


该命令用于查询系统模块的统计信息。 

可使用此命令可以详细查询各个模块的业务和失败统计，通过统计来分析系统运行状态。 




[](None)子主题： 






### 查询统计(SHOW_STAT) 
### 查询统计(SHOW_STAT) 


[](None)功能说明 

该命令用于查询系统模块统计。
工程或者运维人员可以通过该命令定期检查系统运行状态是否正常。


[](None)注意事项 

无。


[](None)输入参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
LogicNo|SC逻辑编号|参数可选性: 任选参数类型: 数字参数范围: 0-65535|用于选择查询的SC的LogicNO。 不填默认查询所有SC统计之和。
InstNo|进程实例号|参数可选性: 任选参数类型: 数字参数范围: 0-16|该参数用于表示需要查询模块信息的进程实例号，填0或者不填时代表查询所有实例的模块统计信息。




[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
STATINFO|统计信息|参数可选性: 任选参数类型: 字符串参数范围: 0-30000|该参数用来表示各个模块的业务和失败统计。




[](None)命令举例 


`
查询逻辑号为1，进程实例号为1的的业务统计信息。
SHOW_STAT:LOGICNO=1,INSTNO=1

-----------------Npcf_SMPolicyControl_0----------------
统计信息
N7_STAT_REQ_PREPROC_SUCC                1       
N7_STAT_GET_POLICY_CHK_MSG_SUCC         1       
N7_STAT_GET_POLICY_CHK_SESS_DUP_SUCC    1       
N7_STAT_GET_POLICY_CREATE_SESS_SUCC     1       
N7_STAT_GET_POLICY_MAKE_SEND_CCA_SUCC   1       
N7_STAT_GET_NOTIFY_DEC_SUCC             1       
N7_STAT_HTTP_RECV_REQ_MSG               1       
记录数：1

` 


### 短信缓冲区信息查询(SHOW_SMS_CACHE_STAT) 
### 短信缓冲区信息查询(SHOW_SMS_CACHE_STAT) 


[](None)功能说明 

SC（Service Component，服务组件 ）是系统架构中的公共组件层的基本元素之一，代表一种可独立运行的组件。 

该命令用于查询短信数据区和短信转发数据区的使用情况。短信数据区是当前SC发送短信需要创建的数据区，短信转发数据区是SC把短信转发到其他SC需要创建的数据区。 

该命令用于按占用数查询短信数据区的使用情况，返回每一种数据区占用最多的SC关于该数据区的使用情况，包括SC编号、数据区名、总数、占用数、占用比。 


[](None)注意事项 

无


[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
SCNO|SC编号|参数可选性: 必选参数类型: 数字|该参数用于表示数据区占用最多的SC编号，查询关于该SC占用数据区的使用情况。
RESNAME|数据区名|参数可选性: 必选参数类型: 枚举，参见枚举定义|该参数用于表示数据区名称，包含短信数据区和短信转发数据区。短信数据区是当前SC发送短信需要创建的数据区。短信转发数据区是SC把短信转发到其他SC需要创建的数据区。
SUM|总数|参数可选性: 必选参数类型: 数字|该参数用于表示数据区总数，包含短信数据区总数和短信转发数据区总数。
USAGE|占用数|参数可选性: 必选参数类型: 数字|该参数用于表示业务流程已经使用的数据区数。
PERCENT|占用百分比|参数可选性: 必选参数类型: 数字|该参数用于表示业务流程已经使用的数据区数占数据区总数的百分比。




[](None)命令举例 


`
查询数据区使用情况。
SHOW_SMS_CACHE_STAT

(No.1) : SHOW_SMS_CACHE_STAT:
-----------------Npcf_SIGLB_0----------------
SC编号 数据区名       总数  占用数 占用百分比 
----------------------------------------------
1      短信数据区     80000 0      0          
1      短信转发数据区 80000 0      0          
----------------------------------------------
记录数：2
执行成功开始时间:2021-09-15 15:56:11 耗时: 0.136 秒

` 


## 短信信息管理 
## 短信信息管理 


[](None)背景知识 


当用户不明确自身目前的消费情况时，无法合理安排近期的消费，影响业务体验。运营商希望在一些特定的场景（例如套餐用量达到对应的百分比、用户位置切换等）发生时，通过短信及时提醒用户当前的消费情况，提升用户满意度。 

短信信息管理用于给运维人员提供查询短信服务的相关信息，以具体了解短信服务的运行状态。 




[](None)功能说明 


短信信息管理用于查询短信链路状态、短信链路组分配以及短信SC（Service Component，服务组件）群组分配状态。将多条短信链路归属同一个链路组，再把链路组平均分配给各个SC使用，从而实现短信链路负荷分担功能。 




[](None)子主题： 






### 查询短信链路状态(SHOW SMLINKSTAT) 
### 查询短信链路状态(SHOW SMLINKSTAT) 


[](None)功能说明 

该命令用于查询短信链路状态，可以查询所有短信链路或某一条指定短信链路的链路状态。 

该命令用于工程或测试人员通过EM界面查询当前短信链路状态的详细信息，包括短信链路状态和链路模式、短信的TCP承载链路号和链路状态。 


[](None)注意事项 

无。 


[](None)输入参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
LINKID|链路ID|参数可选性: 任选参数类型: 数字|该参数用于表示短信链路号，唯一标识一条短信链路。链路号引用了“短信链路配置”中的配置，通过SHOW SMLINK命令查询。若不输入链路号，则查询所有短信链路的链路状态。若输入链路号，则查询指定短信链路的链路状态。




[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
LINKID|链路号|参数可选性: 必选参数类型: 数字参数范围: 0-65535|该参数用于表示一条短信链路。
INSTANCEID|实例号|参数可选性: 必选参数类型: 字符串参数范围: 0-50|该参数用于表示短信链路所连接的短信中心实例信息。
LINKSTAT|链路状态|参数可选性: 必选参数类型: 枚举，参见枚举定义参数范围: 0-10|该参数用来表示短信链路的状态。 注册：表示PCF和对端绑定成功。绑定成功指PCF向对端发送绑定消息，收到成功响应，表示短信链路处于工作状态。 未注册：表示PCF和对端未绑定成功。
LINKMODE|链路模式|参数可选性: 必选参数类型: 枚举，参见枚举定义参数范围: 0-10|该参数用来表示短信链路的模式：  长连接：短信链路的模式为长连接模式，链路一直保持。短连接：短信链路的模式为短连接模式，只有短信发送时才建链。
TCPLINKNO|TCP承载链路号|参数可选性: 必选参数类型: 数字参数范围: 0-65535|该参数用来唯一标识一条短信的TCP承载链路，承载编号不能重复。
TCPSTATUS|TCP承载状态|参数可选性: 必选参数类型: 枚举，参见枚举定义参数范围: 0-10|该参数用来表示短信的TCP承载链路状态。 无效状态：TCP承载未建链。正在建链：TCP承载正在建链中。建链成功：TCP承载建链成功。




[](None)命令举例 


`
查询短信链路1的状态。
SHOW SMLINKSTAT:LINKID=1 

(No.1) :SHOW SMLINKSTAT:LINKID=1 
-----------------Npcf_SIGLB_0---------------- 
链路号  实例号            链路状态  链路模式  TCP承载链路号  TCP承载状态  
1       vru-npcf-siglb-0  注册      长链接    8              建链成功     
记录数：1

执行成功 开始时间:2021-03-18 16:24:46 耗时: 0.044 秒 

` 


### 查询链路组分配情况(SHOW_LINK_GROUP_IN_SC) 
### 查询链路组分配情况(SHOW_LINK_GROUP_IN_SC) 


[](None)功能说明 

该命令用于查询短信链路组分配状态。将多条短信链路归属同一个链路组，再把链路组平均分配给各个SC使用，从而实现短信链路负荷分担功能。 

当用户成功配置短信链路后，可以执行该命令查询当前短信链路组的分配情况，具体包括每个短信链路组所归属的SC以及SC的CommID。CommID是SC的唯一标识。 


[](None)注意事项 

无。 


[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
GROUPINSC|链路组归属SC|参数可选性: 任选参数类型: 字符串参数范围: 0-1000|该参数用于表示短信链路组分配状态，具体包括每个短信链路组所归属的SC以及SC的CommID。CommID是SC的唯一标识。




[](None)命令举例 


`
查询短信链路组分配状态。
SHOW_LINK_GROUP_IN_SC

(No.1) : SHOW_LINK_GROUP_IN_SC:
-----------------Npcf_SIGLB_0----------------
链路组归属SC                                 
---------------------------------------------
LinkGroupID: [1]----SC CommID: [1442872321]
 
---------------------------------------------
记录数：1
执行成功开始时间:2021-03-20 13:45:41 耗时: 0.217秒

` 


### 复位指定链路组(LINK_GROUP_RESET) 
### 复位指定链路组(LINK_GROUP_RESET) 


[](None)功能说明 

该命令用于重建指定短信链路组内的所有链路。 

当链路组的一条或多条短信链路一直处于异常状态，可尝试使用该命令触发链路组内的所有链路重新建链。 

该命令执行成功后，指定链路组内的所有短信链路都会重新建链。 


[](None)注意事项 

此命令将触发指定短信链路组内的所有短信链路重建，影响正在此链路发送的短信。尽可能选择没有业务的时间段执行该命令。 


[](None)输入参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
LINKGROUPID|链路组ID|参数可选性: 必选参数类型: 数字|该参数用于表示一条短信链路组，链路组ID引用了“短信链路组配置”中的配置，通过SHOW SMLINKGRP命令查询。




[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
RESULTINFO|执行信息|参数可选性: 任选参数类型: 字符串参数范围: 0-1000|该参数用于表示重建指定短信链路组内链路的执行结果，成功或失败。




[](None)命令举例 


`
复位短信链路组1。
LINK_GROUP_RESET:LINKGROUPID=1

(No.1) :LINK_GROUP_RESET:LINKGROUPID=1 
-----------------Npcf_SIGLB_0---------------- 
执行信息                                 
Reset link group [1] in SC [1442872321]  

执行成功 开始时间:2021-03-22 11:00:59 耗时: 0.048 秒 

` 


### 查询短信缓冲区(SHOW_SMS_CACHE) 
### 查询短信缓冲区(SHOW_SMS_CACHE) 


[](None)功能说明 

该命令用于查询短信数据区的使用情况。具体包括每个支持短信服务的SC的短信数据区的最大容量/已使用容量/剩余容量。 

当用户想了解短信数据区的实际使用情况时，可以使用该命令。 


[](None)注意事项 

无。 


[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
CACHEINFO|SM缓存信息|参数可选性: 任选参数类型: 字符串参数范围: 0-1000|该参数用于表示短信数据区使用情况，具体包括每个支持短信服务的SC的短信数据区的最大容量/已使用容量/剩余容量。




[](None)命令举例 


`
查询短信数据区使用情况。
SHOW_SMS_CACHE

(No.1) :SHOW_SMS_CACHE: 
-----------------Npcf_SIGLB_0---------------- 
SM缓存信息                                   
SMS cache info in SC [0X56007c01]----        
                         Total capacity: 50  
                         Used  capacity: 0   
                         Free  capacity: 50  
执行成功 开始时间:2021-03-20 14:22:35 耗时: 0.042 秒 

` 


### 查询SC群组分配(SHOW_SC_GROUP) 
### 查询SC群组分配(SHOW_SC_GROUP) 


[](None)功能说明 

该命令用于查询短信SC群组分配状态。具体包括短信群组个数，每个群组状态。 

用户群（简称群）是一个中间层的逻辑概念，业务承载在群上，而群承载在SC上，可以在不同SC之间进行迁移。这样业务可以不用关心真实的位置，只要根据对应的群号查找实际承载的SC唯一编号，从而实现SC的负荷分担。 

当用户想查询短信SC的群分布状态时，可以使用该命令。 

该命令执行成功后，可以查看短信SC群组分配的详细信息。 


[](None)注意事项 

无。 


[](None)输入参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
SC_Logic_NO|SC逻辑号|参数可选性: 必选参数类型: 数字参数范围: 1-1000默认值: 1|该参数用于表示SC的逻辑号。通过SHOW SCTYPE:NFSNAME="Npcf_SIGLB_0"命令查询短信SC的实例个数。如果SC的实例个数为N，那么SC逻辑号就可以取值1,2,3...N。




[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
GROUPINFO|群组分配|参数可选性: 任选参数类型: 字符串参数范围: 0-1500|该命令用于查询短信SC的群组分配状态。具体包括短信群组个数，每个群组状态。1：表示该群在当前SC为工作状态。0：表示该群在当前SC为非工作状态。




[](None)命令举例 


`
查询SC逻辑号1的短信群组分配状态。
SHOW_SC_GROUP:SC_LOGIC_NO=1

(No.1) :SHOW_SC_GROUP:SC_LOGIC_NO=1 
-----------------Npcf_SIGLB_0---------------- 
群组分配                                       
g_bGrpInfoLoadOK value:1,GroupID.wValidNum:3  
GroupNO:0,status:1                             
GroupNO:1,status:1                             
GroupNO:2,status:1
执行成功 开始时间:2021-03-20 14:06:51 耗时: 0.051 秒 

` 


操作维护 :操作维护 :

[](None)背景知识 


平台提供的调试命令集合。 




[](None)功能说明 


该节点下面包括系统调测配置。 




[](None)子主题： 






系统调测 :系统调测 :

[](None)背景知识 


对系统进行调试和信息收集，以判断运行状况。 




[](None)功能说明 


对系统进行调试和信息收集，包括调测信息收集等功能。 




[](None)子主题： 






调测信息收集 :调测信息收集 :

[](None)背景知识 


在系统调试过程中，需要采集系统的运行信息，可提供给运维人员进行分析，达到监测系统是否正常的目的。 




[](None)功能说明 


本配置可以显示系统当前支持的所有模块，可针对模块名进行信息采集，也可以采集系统所有模块的信息，同时具备清除模块信息的功能。 




[](None)子主题： 






#### 查询含有Debug信息的模块列表(SHOW DEBUG MODULELIST) 
#### 查询含有Debug信息的模块列表(SHOW DEBUG MODULELIST) 


[](None)功能说明 

该命令用于查询其归属的NFS内含有调测信息的模块列表。当运维人员需要收集或者清除指定模块的调试信息时，可以执行该命令查询含有调测信息的模块名称。 


[](None)注意事项 

无。 


[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
MODULE_NAME|模块名|参数可选性: 必选参数类型: 字符串参数范围: 1-47|该参数用于表示支持统计信息的模块名称。
MODULE_INST|模块实例数|参数可选性: 必选参数类型: 数字参数范围: 0-4294967295|该参数用于表示支持统计信息的模块实例数。




[](None)命令举例 


`
查询某个NFS中含有调试统计信息的模块列表。
 SHOW DEBUG MODULELIST

------CommonS_TMSP_0--------
模块名         模块实例数
ROSNG_ADAPT    1
ROSNG_ARCH     1
记录数：2

执行成功耗时: 0.259 秒

` 


#### 清理模块内部统计信息(CLEAR DEBUG INFO) 
#### 清理模块内部统计信息(CLEAR DEBUG INFO) 


[](None)功能说明 

该命令用于清理其归属NFS内模块的调测信息。当需要获取新的调测信息前，先执行该命令。 


[](None)注意事项 

获取新的调测信息前可以先执行该命令，该命令返回的“失败数量”为非0则需要联系中兴通讯技术人员支持；为0则可获取新的调测信息。 


[](None)输入参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
MODULE_NAME|模块名称|参数可选性: 任选参数类型: 字符串参数范围: 1-47|该参数用于表示需要清除调测信息的模块名称。该参数选项的含义是：默认为空：表示清除NFS内所有的调测信息。非空：表示清除指定模块的调测信息，可由SHOW DEBUG MODULELIST命令获取模块名称。




[](None)输出参数说明 


[](None)标识|名称|类型|说明
---|---|---|---
MODULE_NUMBER|模块实例数量|参数可选性: 必选参数类型: 数字参数范围: 0-4294967295|该参数用于表示清理的模块实例总数量。
SUCCESS_NUMBER|成功数量|参数可选性: 必选参数类型: 数字参数范围: 0-4294967295|该参数用于表示清理成功的模块实例数量。
FAILED_NUMBER|失败数量|参数可选性: 必选参数类型: 数字参数范围: 0-4294967295|该参数用于表示清理失败的模块实例数量。




[](None)命令举例 


`
清理名称为ROSNG_ADAPT的模块的调测信息。

CLEAR DEBUG INFO:MODULE_NAME="ROSNG_ADAPT"
` 


