# 安装与调试 
## 软件安装（AIC部署）-SDN 
### 安装概述 
#### 虚拟化系统的组网架构 
概述 :在部署中兴通讯虚拟化核心网设备ZXUN RCP的运行环境之前，需要先了解虚拟化系统相关概念，包括组网架构及各部分的功能。
##### 组网架构 
虚拟化又称为云化，云是网络的一种比喻说法，是对电信网、互联网和底层基础设施的抽象描述。 
 说明： 
底层基础设施指的是主机、内存、CPU、接口、网络等硬件设施或网络资源。
云化就是指通过虚拟化技术NFV，将核心网网元的基础架构从专用硬件向通用硬件进行演进，从而实现软硬件的解耦。
对核心网进行云化后，其硬件设备和网元不再是一一对应的关系，由于底层的硬件设施和上层应用是解耦的，底层的硬件资源通过NFV可以被上层的多种应用共享。
NFV是云化核心网的关键技术。通过基于行业标准的x86服务器、存储和交换设备及虚拟化技术，使网络设备功能不再依赖于专用硬件，从而降低网络昂贵的设备成本，资源可以充分灵活共享，帮助运营商获得更多、更灵活的网络能力，实现新业务的快速开发和部署。
ETSI制定的NFV架构由NFVI、VNF以及MANO三个部分组成。
NFVI：基础硬件设施NFVI包括通用的硬件设施及其虚拟化。 
MANO：云管理及调度平台在NFV架构中，MANO负责对整个NFVI资源的管理和编排，负责业务网络和NFVI资源的映射和关联。MANO包括VIM、VNFM和NFVO三个部分，分别完成对NFVI、VNF和NS三个层次的管理。 
VNF：上层业务应用VNF使用软件实现虚拟化网络功能。 
根据核心网云化的三层结构，NFV架构中各个节点的关系如[图1]所示。
图1  NFV三层架构

各节点的功能说明参见[表1]。
架构|节点|描述|对应的产品
---|---|---|---
NFVI（基础硬件设施）|服务器|NFVI是网络功能虚拟化基础设施，通常指的是物理资源，包括主机、内存、CPU、接口等硬件设施。|云平台的硬件通常采用高性能的服务器，如HP C7000，DELL R730等。中兴通讯自研的云平台服务器为ZXCLOUDE9000企业级刀片服务器。
磁阵|NFVI（基础硬件设施）|用于数据存储的设备，运营商可以根据实际运营状况决定是否需要配置磁阵，在交接局业务量较小的情况下，无需配置。|根据运营商的实际环境配置，对磁阵的型号没有限制。通常情况下使用Fujitsu DX100 S3。
外部交换机|NFVI（基础硬件设施）|外部交换机指的是在实际组网环境中，用于将NFVI和磁阵接入运营商维护网络的交换机。|根据运营商的实际环境配置，对交换机的型号没有限制。通常情况下需要配备2台外部交换机（启用堆叠）。
MANO（云管理及调度平台）|VIM|VIM是虚拟化基础设施管理系统，是NFVI的管理者。VIM主要负责基础设施层硬件资源、虚拟化资源的管理、监控和故障上报，面向上层业务应用提供虚拟化资源池。VIM为NFVO和VNFM提供VNF相关虚拟资源的操作接口。|VIM称为云平台管理软件，常见的VIM包括VMWare、OpenStack等。中兴通讯基于OpenStack开源标准接口研发的云平台管理软件的产品名称为ZTE TECS OpenStack。
VNFM和NFVO|MANO（云管理及调度平台）|VNFM和NFVO统称为NFV管理器。NFVO负责全网的网络服务、虚拟资源以及物理资源的编排和管理功能。VNFM对核心网所有网元提供生命周期管理以及弹性伸缩相关的虚拟机操作管理功能。|由中兴通讯自研的用于实现VNFM和NFVO功能的产品名称为CloudStudio。
VNF（上层业务应用）|VNF|一个VNF对应于在传统非虚拟化网络中的一个物理网络功能，即对应核心网的各种网元，如：PCF等。|中兴通讯用于实现PCF网元功能的产品名称为ZXUN RCP。
 说明： 
本文档仅涉及承担虚拟化架构中的一种VNF功能的ZXUN RCP的软件安装过程。
#### 安装导读 
在进行ZXUN RCP软件安装前，确保已经完成硬件设备安装、VIM云平台管理软件和MANO软件安装，本文只涉及ZXUN RCP的版本软件的安装过程。安装全流程参见[表1]。
安装步骤|安装内容|安装参考文档
---|---|---
1|VIM|安装TECS OpenStack|参考ZTE TECS OpenStack用户手册文档包中用户手册文档包中的《软件安装》内容进行安装。
2|MANO|安装CloudStudio|参CloudStudio用户手册文档包中用户手册文档包中的“安装与调测”内容进行安装。
安装ElasticNet UME R50s|2|MANO|参考ElasticNet UME R50s成套用户手册中的“软件安装指导”内容进行安装。
3|VNF|安装ZXUN RCP|详细信息请参考本文档后续内容。
#### 安装说明 
##### 部署场景 
商用规格|适用运营商|应用场景
---|---|---
商用大规格(cmcc)|中国移动数据局|有报表功能无热备容灾
中国移动语音局|商用大规格(cmcc)|无报表功能无热备容灾
中国移动物联网局点|商用大规格(cmcc)|有报表功能无热备容灾
商用大规格|中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF
中国电信非UDSF局|商用大规格|无报表功能有热备容灾，外置UDSF
国际通用局点|商用大规格|无报表功能无热备容灾
部分国际局|商用大规格|无报表功能有EDR功能无热备容灾
商用小规格|部分测试局|无报表功能无热备容灾
部分测试局|商用小规格|无报表功能有EDR功能无热备容灾
 说明： 
商用大规格(hg)场景目前仅用于测试，无商用场景。 
商用大规格和商用大规格(cmcc)的区别：商用大规格中OMU/AMU虚机的规格：内存为24
G，硬盘为110 G。商用大规格(cmcc)中OMU/AMU虚机的规格：内存为32 G，硬盘为410 G。 
##### 安装方式 
ZXUN RCP部署支持MANO手工部署和iDeploy自动部署两种方式。现场部署时可参考下表，选择合适的部署方式完成RCP的实例化部署。
产品和功能|MANO手工部署|iDeploy自动部署
---|---|---
TECS+中兴通讯MANO（R50s、CloudStudio）|√|√
第三方VIM或MANO|√|×
#### 安装流程 
ZXUN RCP虚拟化的软件安装流程参见[表1]。
步骤|操作|说明|参考
---|---|---|---
1|安装前准备|安装前的准备工作，包括准备软件、规划网络数据及获取系统默认的用户名和密码。|安装准备
2|制作LLD|使用ZXUN AIC（iDevise）工具输出部署所需的LLD文件。LLD在HLD的基础上，定义各种网络资源的分配细则、网络配置要求的设计文档。ZXUN AIC旨在打造NFV的CI/CD（Continuous Integration，持续集成/Continuous Delivery，持续交付），主要用于NFVI层的自动化部署、VNF的持续集成及交付。iDevise是ZXUNAIC的一个组件，用于DC的数据规划设计。iDevise基于ZTE NFV相关组网规范，按照硬件、承载、虚拟层、VNF等层次进行数据设计，输出开局部署所需的LLD文件。本文仅介绍VNF的LLD的制作过程。|LLD制作
3|部署VNF|使用ZXUN AIC（iDeploy）工具完成VNF所需虚拟资源的创建和业务程序的自动部署。iDeploy是ZXUNAIC的一个组件，用于实现端到端的自动化部署。iDeploy中导入iDevise输出的LLD文件，以及版本文件，并进行VNF的自动部署，整个流程无需人工干预。|VNF部署
### 安装准备 
#### 软件准备 
##### 简介 
软件准备包括AIC工具、ZXUN RCP的版本软件和客户端上需要安装的软件。
##### AIC工具 
名称|说明
---|---
AIC(iDevise) V*|LLD数据规划设计工具。最终文件路径示例如下：AIC(iDevise) V*└─ZXUNAIC (iDevise)(WPS版).xlsm└─Templates└─VNF LLD Template PCF.xlsm└─Tools└─rsa.dll└─rsa_go.dll
AIC(iDeploy) V*|自动化部署工具。
其中"V*"为版本号，以实际版本为准。 
AIC工具的获取方式如下： 
AIC(iDevise) V*：LLD数据规划设计工具随RCP版本包发布，获取路径： /RCPVx/AIC(iDevise) V*。其中，“Vx”为RCP版本号，以实际版本为准。 
AIC(iDeploy) V*：自动化部署工具和iDeploy License需要联系中兴通讯技术支持。 
##### 版本软件 
安装ZXUN RCP需要准备相关的软件包参见[表2]。
版本包类型|说明|版本包名称|获取路径
---|---|---|---
基础包|基础包也称部署插件包，包含了虚机部署info.xml文件、policy.xml文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。|ZXUN_RCP_VNFD.VXXX.csar|/RCPVXXX/versions/IAAS/pcf/vnfd
镜像包|镜像包是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。|cgsl_YYY.zip|/RCPVXXX/versions/IAAS/images
业务软件包|业务软件包是ZXUN RCP完成公共服务及特定业务的软件包。|ZXUN_RCP_VXXX.zip|/RCPVXXX/versions/IAAS/pcf/version
AIC插件包|网元为支持AIC工具所提供的插件。|aic-plugin-pcf-VZZZ-PCF.zip|/RCPVXXX
XXX表示ZXUN RCP具体的版本号，以实际版本为准。
YYY表示镜像文件包具体的版本号，以实际版本为准。 
ZZZ表示AIC部署工具具体的版本号，以实际版本为准。 
##### 调试机的软件配置要求 
调试机的功能参见[表3]。
类别|描述
---|---
与VIM通信|作为VIM客户端。在本文档中，作为客户端，访问中兴通讯自研的云平台管理软件TECS OpenStack。
与VNFM和NFVO通信|作为VNFM和NFVO的客户端。在本文档中，作为客户端，访问中兴通讯自研的NFVI资源编排和管理软件NFVO。
与NFVI通信|以SSH方式访问作为控制节点或计算节点的硬件服务器。
存放版本文件|将ZXUN RCP的版本安装软件从客户端上传到NFVI。
调试机中需要安装的软件参见[表4]。
软件类型|备注
---|---
操作系统|建议安装Windows 7或更高级的版本。
浏览器|只支持Google Chrome，操作员需要通过Google Chrome浏览器登录到TECS OpenStack和NFVO的图形化操作页面。
FTP或SFTP工具|将ZXUN RCP的版本文件从客户端上传到NFVI上。
远程访问工具|以TELNET或SSH方式访问作为控制节点或计算节点的硬件服务器。
#### 默认用户名和密码 
在安装过程中涉及到系统默认的用户名及密码参见[表1]。
 小心！ 
部署完成后，请立即登录并修改所有帐号的默认密码。 
建议定期修改密码，防止密码被盗窃和破解。 
系统|用户名及密码
---|---
NFVO/VNFM客户端（CloudStudio）|用户名：admin密码：Zenap_123
NFVO/VNFM操作系统（CloudStudio）|用户名：root密码：CloudStudio__123（此处为双下划线）
NFVO/VNFM客户端（ElasticNet UME R50s）|用户名：admin密码：Zenap_123
PaaS操作系统（ElasticNet UME R50s）|用户名：ubuntu密码：UbuntU1!2@3#4$
安全加固后的PaaS操作系统（ElasticNet UME R50s）|用户名：pict密码：PicT1!2@3#4$
TECS OpenStack|登录TECS OpenStack客户端的默认用户名及密码如下：TECS OpenStack V3.17.14版本以上用户名：admin密码：KeystoneTECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123
登录主机的操作系统的默认用户名及密码如下：用户名：通过tecs用户登录，使用sudo -i命令切换到root用户密码：ossdbg1|TECS OpenStack
#### VIM侧的数据准备 
检查当前TECS OpenStack版本信息和规划版本是否相同。 
检查iDeploy工具版本号是否满足使用要求。 
检查获取的用户名和密码能否正常登录TECS OpenStack的客户端和主机操作系统。 
检查TECS OpenStack系统运行状态正常，有无重要/紧急的异常告警。 
检查TECS OpenStack上剩余的CPU、内存、存储等虚拟资源是否充足。 
检查TECS OpenStack上预定义的租户配额是否充足。 
检查后端存储，如磁阵、CEPH是否已经正常接入，对应版本是否正确，存储资源是否充足。 
#### MANO侧的数据准备 
检查当前MANO版本和规划版本是否相同。 
检查获取的用户名和密码能否正常登录MANO。 
检查MANO系统运行状态正常，有无重要、紧急的异常告警。 
检查NFVO上接入的VNFM是否正常，确保其状态为正常。 
检查NFVO上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
检查VNFM上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
#### 查询VNFM用户的权限 
概述 :本节介绍如何查询VNFM用户的权限，在部署ZXUN RCP之前，需要确认用户权限是否配置正确。
VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，在中国移动等国内运营商的部署环境中，由于安全原因，禁止使用admin用户，需要新建用户，此用户名之前已经由MANO维护人员创建成功，创建操作参见“[在VNFM上创建用户]”，在部署ZXUN RCP之前，需要确认用户的权限是否正确。
##### 操作前提 
已经从MANO的维护人员处获取了VNFM用户的名称。 
操作步骤 :登录VNFM客户端，选择系统→安全→用户管理
，进入用户管理页面，如[图1]所示。
图1  用户管理页面

查看从MANO的维护人员处获取的VNFM用户的权限，单击VNFM用户列表中对应操作列的修改按钮。
出现修改用户页面，如[图2]所示。
图2  修改用户页面

单击用户规则后的查看详情按钮，出现查看账户规则页面，如[图3]所示。
图3  查看账户规则页面

确认帐号登录方式，Web和API必须为勾选状态。
数据规划 :#### 基础数据规划 
##### 虚拟环境资源规划 
ZXUN RCP的虚拟环境资源规划参见[表1]。
资源规划|作用|示例
---|---|---
项目|项目又称为租户。TECS OpenStack以项目的方式实现各个虚拟VNF之间虚拟资源的隔离。同一个VNF内的主机、网络等资源归属到同一项目。|项目名称：admin（系统默认的项目，无需创建）。项目名称：PROJ-RCP-1（此项目主要是部署与ZXUN RCP相关的一些网络平面和VM）。
用户|登录VIM云平台管理软件TECS OpenStack的账号，需要为用户指定其所属的项目。|用户名称：SysAdmin（系统默认的用户，无需创建），密码为SysAdmin_123。用户名称：ZXUN RCP。通常情况下，除了TECSOpenStack默认的用户之外，还需要为每个项目都创建一个用户。本文档规划为PROJ-RCP-1项目创建一个用户ZXUN RCP。该ZXUNRCP用户仅可管理PROJ-RCP-1项目，而admin用户可以管理所有的项目。
##### VM类型 
ZXUN RCP的VM类型参见[表2]。
虚机类型|功能描述
---|---
OMU|对接CN-OAM（核心网集中网管），管理整局上电、版本加载、配置同步、网管命令执行、告警和性能统计汇总、各服务弹缩控制等功能。
IPU|IP接口虚拟机，收发IP承载的控制面信令和用户面报文。
GSU（HTTP LB）|HTTP负荷分担服务，实现HTTP协议消息分发。
GSU（SIG LB）|信令负荷分担服务，实现Diameter和SMS消息分发。
GSU（PolicyControl）|处理PCF和PCRF业务逻辑，提供AMPolicyControl、UEPolicyControl、SMPolicyControl和PolicyAuthorization服务。
GSU（GW）|UDSF统一接入网关。
CDU|UDSF数据存储单元。
LOG|策略日志单元，产生策略日志并存入云盘或LSU，并可通过SFTP上传给外部服务器。
LSU|策略日志存储单元，用于策略日志分析。
各业务模块VM支持的工作模式参见[表3]。
VM类型|工作模式
---|---
OMU|1+1+1冗余备份
IPU|N+1
GSU|N+1
CDU|1+1
LOG|N+1
LSU|N+1
#### SDN组网规划 
网络平面是指各个VM通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN RCP网络平面规划示例的详细描述参见[表1]。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。 
虚机名称|网络平面|子网平面|描述
---|---|---|---
All|ZTE_RCP_NfId_SERV_INT_NET|IPv4：ZTE_RCP_NfId_SERV_INT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_SERV_INT_SUBNET_IPv6|ZTE_RCP_NfId_SERV_INT_NET|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面，本文档规划内部控制面名称为ZTE_RCP_NfId_MGT_INT_NET，内部媒体面名称为ZTE_RCP_NfId_SERV_INT_NET。
All|ZTE_RCP_NfId_MGT_INT_NET|IPv4：ZTE_RCP_NfId_MGT_INT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_MGT_INT_SUBNET_IPv6|ZTE_RCP_NfId_MGT_INT_NET|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面，本文档规划内部控制面名称为ZTE_RCP_NfId_MGT_INT_NET，内部媒体面名称为ZTE_RCP_NfId_SERV_INT_NET。
OMU|ZTE_RCP_NfId_OAM_EXT_NET|IPv4：ZTE_RCP_NfId_OAM_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_OAM_EXT_SUBNET_IPv6|ZTE_RCP_NfId_OAM_EXT_NET|网管平面是ZXUN RCP和EMS、MANO进行通信的网络平面。部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。
IPU|parent（父）网络平面|ZTE_RCP_NfId_EXT_NET|IPv4：ZTE_RCP_NfId_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_EXT_SUBNET_IPv6|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。采用SDN组网，启用VLANTrunk功能的情况下，通常将ZTE_RCP_NfId_EXT_NET定义为parent（父）网络平面，将其他的所有的外部网络平面定义为child（子）网络平面，将所有child（子）网络平面都配置在parent（父）网络平面的VLANTrunk子接口中。
child（子）网络平面|IPU|ZTE_RCP_NfId_SBI_EXT_NET|IPv4：ZTE_RCP_NfId_SBI_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_SBI_EXT_SUBNET_IPv6|规划为ZXUN RCP与5G网络中其他的NF的SBI接口通信的网络平面名称。
ZTE_RCP_NfId_SIG_EXT_NET|child（子）网络平面|IPU|IPv4：ZTE_RCP_NfId_SIG_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_SIG_EXT_SUBNET_IPv6|规划为ZXUN RCP与不同业务域网元间信令互通的网络平面名称。
ZTE_RCP_NfId_LOG_EXT_NET|child（子）网络平面|IPU|IPv4：ZTE_RCP_NfId_LOG_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_LOG_EXT_SUBNET_IPv6|规划为ZXUN RCP与策略日志服务器通信的网络平面名称。
ZTE_RCP_NfId_SMS_EXT_NET|child（子）网络平面|IPU|IPv4：ZTE_RCP_NfId_SMS_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_SMS_EXT_SUBNET_IPv6|规划为ZXUN RCP与短信中心通信的网络平面名称。
### LLD制作 
注意事项 :通过iDevise进行的所有操作，从ZXUN AIC (iDevise)(WPS版).xlsm入口，通过ZXUN AIC (iDevise)(WPS版).xlsm生成模板文件。勿直接修改Templates目录下的模板文件。 
如iDevise设计参数填写错误，需要进行修改，从ZXUN AIC (iDevise)(WPS版).xlsm文件入口修改后重新生成LLD，勿直接修改最终的LLD文件。 
iDevise设计过程中，只有表格为橙色底纹红色字体时，才需要使用者填写参数或者确认默认值是否正确，其余格式的单元格保持默认值不要修改，如图1所示。 说明：部分橙色底色单元格带有批注信息，当鼠标移动到该单元格时，将会自动显示批注信息。需特别关注批注信息，按要求填写单元格内容。图1  LLD模板 
如需要向LLD的单元格拷贝粘贴数据，勿直接进行粘贴，选择”粘贴为数值”的方式进行粘贴，以免破坏LLD中的单元格格式。 
#### 创建工程 
摘要 :本节介绍通过AIC工具如何创建一个工程。 
 说明： 
本文档中的AIC工具版本号仅为示例，请以实际的版本为准。 
步骤 :在客户端PC打开AIC工具文件夹，双击ZXUN AIC (iDevise)(WPS版).xlsm，出现如[图1]所示的页面，用于分层选择不同领域的LLD进行设计。
图1  ZXUN AIC(iDevise)页面

登录对话框的参数说明参见[表1]。
参数名称|参数说明
---|---
Project Name|本参数用于设置本次工程的名称，由操作员自行定义即可，仅针对LLD文档设计过程中有效，不影响后续部署。
DC Name|本参数用于设置本次工程所在的DC的名称，由操作员自定义即可，仅针对LLD文档设计过程中有效，不影响后续部署。
Template|该参数是用于控制下方各层次LLD模板选择的总开关，包括两个选项：General LLD Template普通场景下的LLD模板设计，一般情况下都需要设置为此选项。xGW-E LLD Templat目前只有中兴通讯的ZXUN xGW（GW-U）产品才需要设置为此选项。
Networking|用于承载组网LLD规划设计。
Superfusion|超融合组网LLD规划设计。如果Superfusion设置为Y，因为Superfusion模板中是CEPH和VIM的配置，所以CEPH和VIM所在单元格灰化受保护，不支持CEPH和VIM的模板文件的修改。
CEPH|用于CEPH集群LLD规划设计。
VIM|用于VIM云平台LLD规划设计。
MANO&EMS|用于MANO和EM层LLD设计。
VNF|用于VNF层的LLD设计。
iChecklist|在各领域部署前后如果需要自检，则在iChecklist进行相关LLD设计。
本文档示例通过AIC工具部署ZXUN RCP，只需要将VNF设置为Y，其他都设置为Ｎ，选择完毕后，单击New Project，系统弹出提示确认框，如[图2]所示。
图2  提示确认框

单击是按钮，在连续弹出的提示框中单击确定按钮。
将PCF设置为Y，单击Edit Project按钮，开始进行VNF的模板选择及LLD参数设计，如[图3]所示。
图3  VNF

单击Open按钮，新建一个模板，会自动创建一个名称为VNF LLD Template PCF.xlsm的表格，如[图4]所示。
图4  VNF LLD Template PCF.xlsm

#### 配置LLD 
在如[图4]所示的VNF LLD Template PCF.xlsm模板中，依次进入以下各sheet页面，根据规划配置相关参数。
##### Global Setting 
Global Setting页签用于配置VNF的全局参数，示例如[图1]所示。
 说明： 
Global Setting页签中的某些参数的配置结果将影响后续其他设计页签的呈现，包括Application scenarios、Network Type和Storage Type，详细说明参见[表1]。
图1  Global Setting页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Applicationscenarios|0-Common：通用场景1-5GS：通用5G切片场景（MANO为CMCC模式）11-CMCC Phase1：中国移动一期资源池场景（MANO为CMCC模式）当选择为本场景时，某些表格中部分单元格底色变为绿色的，表示该处已根据中国移动的规范要求设置好对应的数值，非特殊情况下不需要修改。中国移动非SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VNF Network Setting或者VNF Network Setting IPv6。12-CMCC Phase2：中国移动二期资源池场景（MANO为CMCC模式，SDN组网）中国移动SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VRouter Summary、VRouter External Network和VNF SDNNetwork Setting。13-CMCC Phase3: 中国移动三期资源池场景（MANO为CMCC协议模式，SDN组网，NS纳管）中国移动SDN组网场景、执行NS纳管VNF时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要将NS Info页签中是否执行NS纳管VNF参数配置为YES。21-CTCC：中国电信资源池（MANO为CMCC模式）31-CUCC：中国联通资源池（MANO为CMCC模式）41-CBNC：中国广电资源池51-OverSea：海外国际局点
Room Name|本参数用于设置机房名称，请根据实际情况配置。请根据运营商的规划进行设置。
DC Name|本参数用于设置DC名称。该参数的值来源于创建工程时，配置的参数DC Name，参见“创建工程”，此处使用默认值，不需要设置。
DC Description|本参数用于设置DC的信息描述，一般根据运营商的工程规划方案设置，表示DC的物理位置，例如具体的大楼、机房位置等。请根据运营商的规划进行设置。
Network Type|本参数用于设置需要部署的VIM云平台的网络类型。SDN组网场景时，该参数需要设置为VxLAN。非SDN组网场景时，该参数需要设置为VLAN。
VIM ID|本参数用于设置ZXUN RCP需要部署的VIM云平台的编号，用于VIM接入MANO时使用。配置原则如下：中国移动命名规则：NFV-RP-HBBAD-01A-ZX-01中国电信命名规则：GD-GZ-ZSC-RP0001B-V-ZE-01中国联通命名规则：az1.xa1.chinaunicom.cn（MANO的V5.20.11版本支持域名方式，其他版本不支持域名方式）除上述运营商之外的其他运营商，不必遵循上述格式，可自定义合法字符串，例如VIM01。
VIM NAME|本参数用于设置ZXUN RCP需要部署的VIM云平台的名称。根据运营商的规划进行设置。
VIM Type|本参数用于设置ZXUN RCP需要部署的VIM云平台类型。配置为TECS，表示ZXUN RCP需要部署的VIM云平台为中兴通讯自研的的ZTE TECS OpenStack。配置为OSP，表示ZXUN RCP需要部署的VIM云平台为OpenStack Platform ，OSP是OpenStack Platform开源项目的服务。配置为OIaaS，表示ZXUN RCP需要部署的VIM云平台为IaaS，基础设施服务，即多个基础设施组成的服务。
VIM Version|本参数用于设置需要部署的VIM云平台的版本号。与现场实际安装的TECS OpenStack版本号保持一致。
Storage Type|本参数用于设置VIM云平台在存储数据时，使用的存储类型。CEPHVIM云平台使用CEPH存储数据。Local DiskVIM云平台使用本地盘存储数据，由服务器自身携带的存储硬盘提供整个系统的存储能力。Disk ArrayVIM云平台由单独的磁盘阵列设备提供存储能力。当Storage Type配置为CEPH或Disk Array时（表示ZXUN RCP使用后端存储设备），后续需要额外配置的页签如下：Volume Types页签，表示在这两种情况下，需要设置ZXUN RCP规划的云硬盘类型名称，参见“Volume Types”。Storage QoS页签，表示在这两种情况下，需要设置ZXUN RCP规划的存储QoS策略，参见“Storage QoS”。中国电信和中国移动部署场景：本参数需要设置为CEPH。中国联通部署场景：本参数需要设置为Disk Array。
Use Huge Pages / CPU Dedication|本参数用于设置VIM云平台是否启用巨页（Huge Page）/绑核（NUMA）功能。国内运营商部署场景：本参数需要设置为YES。
Use Security Group|本参数用于设置VIM云平台是否开启安全组。安全组是在VIM云平台上（如中兴通讯自研的ZTE TECSOpenStack）上创建的一个地址段范围，在VIM云平台和VNF同时开启安全组的情况下，VNF可以和处于该地址段范围内的外部网元进行通信。国内运营商部署场景：本参数需要设置为NO。
Use Port SecurityGroup|本参数用于设置ZXUN RCP是否开启端口安全组。当Application scenarios设置为12-CMCC Phase2（即中国移动二期资源池）或13-CMCC Phase3（即中国移动三期资源池）时，本参数需要设置为YES，除此之外的其他场景，本参数需要设置为NO。
VNF IP Type|本参数用于设置需要部署的VNF使用的网络地址类型。IPv6：IPv6类型地址IPv4：IPv4类型地址本参数需要根据现场的实际组网情况进行配置。中国移动部署场景：本参数需要设置为IPv6。如果ZXUN RCP使用的网络地址类型需要部署为双栈，此参数还是设置为单栈方式（即设置为IPv6或者IPv4都可以），在ZXUN RCP实例化成功后，通过后续的业务配置来实现ZXUN RCP的双栈功能。
Timezone|本参数用于设置ZXUN RCP所在地的时区。根据实际情况从下拉列表中选择，比如中国的时区为东8区，设置为GMT+08:00Asia/Shanghai。国内运营商场景：固定设置为GMT+08:00 Asia/Shanghai。
Physical Network Name|本参数用于设置VIM云平台的租户网络所映射的物理网卡名称。当VIM Type参数配置为TECS时，通常默认为default。当VIM Type参数配置为OSP时，通常默认为datacentre。当VIM Type参数配置为OIaaS时，通常默认为oiaas-net。
Language|本参数用于设置部署VNF时，VNF的网管系统的语言类型。en_US.UTF-8：英文zh_CN.UTF-8：中文国内运营商场景：固定配置为zh_CN.UTF-8。
VNFM ID|本参数用于设置ZXUN RCP所在的VNFM ID。此处需要配置为VNFM接入NFVO时的实际数值，在多个VNFM接入同一个NFVO时，需要配置此参数。
Resource Prefix|本参数用于设置资源前缀名称，用于LLD定义租户、云盘、网络等资源时，系统在原有的名称前，自动添加的前缀。此参数需要根据运营商的规范进行配置。各运营商局点填写示例：中国移动：HBBAD-01A-ZX-01。 地理位置-硬件资源池编号-厂家-池编号。中国电信：GD-GZ-ZSC-RP0001BE。省份标签-地市标签-局点标签-云属性+序号。中国联通：XA1-SN-SN-XA。站点名称-大区-省份-城市。其他运营商：可自定义合法字符串，或根据指定要求填写。
Allow Cross AZ Deployment|本参数是指在Storage Type参数设置为非本地盘（即配置为CEPH或Disk Array）的情况下，是否允许虚机的可用域与存储后端的可用域不相同。中移资源池规范中，要求虚机可用域与存储可用域必须一致，该参数应设置为NO。TECS OpenStack V06.10.10版本没有存储后端的可用域，因此当ZXUN RCP部署在该版本VIM云平台时，该参数需要设置为YES。其他场景下，根据运营商规范及虚机可用域与存储可用域实际规划情况设置。该参数配置需要与daisy界面中的跨AZ挂载云盘参数保持一致，查询路径如图2所示。
Support Duplicate Resource Name|本参数用于设置，操作员在TECS OpenStack上创建资源（如vRrouter等）时，是否允许不同租户下有重名的资源。YES：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，允许在本租户下继续创建该名称的资源。NO：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，则不允许在本租户下继续创建该名称的资源。中国移动部署场景：本参数需要设置为NO。
Quorum Service Num|本参数用于设置仲裁服务节点数目，默认配置为1，表示由一个AMU虚机为两个OMU虚机提供主备仲裁服务。本参数建议保持默认值。
Enable Accel Resources|本参数用于设置是否启用加速资源控制，具备硬件条件的资源池可以启用（即资源池计算节点安装加速网卡），不具备条件的资源池默认关闭。
Enable Flexible Resources|本参数用于设置是否启用弹性资源控制，TECS OpnenStack平台Train版本支持该功能，默认关闭。
Only Deploy Omu Test Instance|本参数用于设置是否使用OMU连通性测试部署。YES：OMU连通性测试部署。NO：正常实例化部署。
图2  查询跨AZ挂载云盘配置

##### VIM Controller Info 
VIM Controller Info页签用于配置VNF所在VIM云平台的相关信息，如[图1]所示。
 说明： 
VIM Controller Info页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
图1  VIM Controller Info页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VIM Controller IP|该参数用于配置ZXUN RCP的VIM云平台（本文档指中兴通讯的TECS OpenStack）控制节点的TECSClient网络平面的浮动IP地址。操作员通过TECS Client网络平面，可以在客户端使用Chrome浏览器访问TECS OpenStack提供的图形化网管界面。
##### Host Aggregate 
Host Aggregate页签用于配置HA（主机集合）和AZ（可用域），如[图1]所示。
主机集合（Host Aggregates）HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。 
可用域（Availability Zones）AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。可以理解为只是一些主机在工程上的独立，例如可以把一个机架上的主机划分在一个可用域中。 
一个AZ可以包含多个HA，一个HA只能属于一个AZ，根据实际规划来配置。 
一般为了达到容灾的效果，一个DC会按照硬件位置划分为两个AZ，相同元数据属性的HA要在两个AZ里都存在，但同时一个HA只能属于一个AZ，因此在规划时对同一元数据属性的HA，可以定义两个HA名称，分别属于不同的AZ。 
图1  Host Aggregate页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Usage|本参数用于配置可用域用途，如管理域、控制面域。Management表示管理域。Control-Plane表示控制域。
Available Zone Name|本参数用于配置可用域（Availability Zones）的名称。AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域（AZ）是一个面向终端客户的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。
Host Aggregate Name|本参数用于配置主机集合（Host Aggregates）的名称。HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是制定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。
Host Aggregate Metadata|本参数用于配置主机集合（Host Aggregates）的元数据，也就是设置各种调度过滤器的类型及其取值。主机集合（Host Aggregates）主要用来为过滤调度器nova-scheduler通过某一属性进行实例（instance）的调度。比如：将数据库服务的实例（instances）都调度到具有SSD属性的主机集合（HostAggregates）中，又或者让某个镜像（image）的实例（instances）调度到同一个主机集合（Host Aggregates）中。调度是指从现有的可用的计算节点中，选择其中一个作为目的节点进行虚机部署、迁移以及规格调整等操作。过滤调度器是常用的调度器之一，过滤调度器使用多个功能不同的过滤器对主机进行筛选。本参数用于设置各种调度过滤器的类型及其取值，比如Aggregate_Instance_Extra_SpecsFilter是主机集合flavor的扩展字段调试器。
Comment|本参数用于配置自定义的描述信息。
 说明： 
确保资源域、主机集合资源满足要求。 
Host Aggregate Metadata参数配置与实际保持一致，若填写错误，则实例化过程会找不到对应的主机集合，上报资源不足失败。 
##### MANO Info 
MANO Info页签用于配置部署VNF所使用到的MANO相关信息，根据实际信息配置，如[图1]所示。
 说明： 
MANO Info页签中的参数，全部继承MANO（本文档指中兴通讯的CloudStudio）侧的配置数据，需要和MANO侧的配置数据保持一致，在配置前请从MANO侧获取相关数据。如果VNF的LLD是与MANO的LLD同时规划的，则需要从ZTE NFV LLD(MANO) XX.xlsx表中获取。
图1  MANO Info页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
NFVO/VNFM Version|本参数用于设置MANO的版本号，与现场实际使用版本号保持一致。若在参数配置下拉框中未找到对应的MANO版本号，则需要在iDeploy部署工具的领域设置→MANO组件版本号中选取正确的版本号，如图2所示。
NFVO Tenant Username|本参数用于设置NFVO的用户名称，是NFVO与VIM对接使用的用户名。
NFVO User Group|本参数用于设置NFVO的用户组名称，是NFVO与VIM对接使用的用户组。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。
VNFM Tenant Username|本参数用于设置VNFM的租户名称，是VNFM与VIM对接使用的用户名。
VNFM User Group|本参数用于设置VNFM的用户组，是VNFM与VIM对接使用的用户组 。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。
VNFM VM Username|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的用户名。
VNFM VM Password|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的密码。
NFVO OMM Username|本参数用于设置NFVO网管系统的用户名。
NFVO OMM Password|本参数用于设置NFVO网管系统的密码。
VNFM OMM Username|本参数用于设置VNFM网管系统的用户名。
VNFM OMM Password|本参数用于设置VNFM网管系统的密码。
NFVO OAM Net Name|本参数用于设置NFVO的网管网络平面（OAM）名称。
NFVO OAM Subnet Name|本参数用于设置NFVO的网管网络平面（OAM）子网名称。
NFVO OAM Floating IP|本参数用于设置NFVO的网管网络平面（OAM）浮动地址。
NFVO OAM Subnet IP Prefix|本参数用于设置NFVO的网管网络平面（OAM）子网地址前缀（不带掩码）。
NFVO OAM Subnet Mask|本参数用于设置NFVO的网管网络平面（OAM）子网掩码。
NFVO OAM Subnet Gateway IP|本参数用于设置NFVO的网管网络平面（OAM）子网网关地址。
VNFM OAM Net Name|本参数用于设置VNFM的网管网络平面（OAM）名称。
VNFM OAM Subnet Name|本参数用于设置VNFM的网管网络平面（OAM）子网名称。
VNFM OAM Floating IP|本参数用于设置VNFM的网管网络平面（OAM）的浮动IP地址。
VNFM OAM Subnet IP Prefix|本参数用于设置VNFM的网管网络平面（OAM）子网地址前缀（不带掩码）。
VNFM OAM Subnet Mask|本参数用于设置VNFM的网管网络平面（OAM）子网掩码。
VNFM OAM Subnet Gateway IP|本参数用于设置VNFM的网管网络平面（OAM）子网网关地址。
VNFM OAM Subnet Name DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网名称（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Floating IP DualStack|本参数用于设置VNFM的网管网络平面（OAM）浮动地址（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet IP Prefix DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网地址前缀（不带掩码）（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Mask DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网掩码（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Gateway IP DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网网关地址（双栈）。如果不使用双栈，该参数不需要配置。
NFVO/VNFM & VIM Interface Protocol|本参数用于设置MANO与VIM对接协议类型。国内运营商场景：固定使用https。
NFVO/VNFM & VIM Authentication Type|本参数用于设置MANO与VIM对接鉴权方式。国内运营商场景：固定使Two-way Authentication
NFVO/VNFM Login Protocol|本参数用于设置登录MANO使用的协议类型。国内运营商场景：固定使用https。
图2  设置MANO版本号

##### VNF ID 
VNF ID页签用于配置需要通过AIC工具进行实例化部署的网元，本文档仅部署PCF网元，如[图1]所示。
图1  VNF ID页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VNF TYPE|该参数用于设置ZXUN RCP的网元类型。
ID|该参数用于设置ZXUN RCP的网元编号。用于标识网元名称及各种相关资源名称。需要根据运营商的规划来设置。
VNF Brief Name|此单元格的值是由VNF Type和ID两个参数设置后， 在本单元格自动引用生成的，需要操作员确认是否正确即可。如果需要修改，可以直接修改。
VNF Resource Prefix|该参数用于设置资源名称前缀，该前缀将作为虚机、云盘、端口等资源名称的一部分。运营商可以通过设置VNF Resource Name Prefix对ZXUN RCP使用的虚拟资源进行严格规范的命名，以便资源的统一管理。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。定义了命名规则后，对于在VNF实例化过程中创建的各种虚拟资源，系统都会按照规定进行命名。在运营商没有特殊要求的场景下，操作员可以自行定义名称。默认情况下，Global Setting页面的Resource Prefix参数设置后，此处自动引用，通常无需修改。
VNF APP ID|网元业务系统标识的关键部分。此处仅为模板提供的默认值，必须根据实际规划数据修改。中国移动填写移动数据：“所属省份标识+网元标识+网元序号+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahPCF001PCF001BZX。移动语音：“所属省份标识+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahPCF001BZX。移动物联网：“所属省份标识+网元标识+m+网元序号+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahPCFm001PCF001BZX。后续在LLD制作中，“VNF Advanced Settings”页面的虚机名称前缀参数直接引用此处配置。说明：VNF Resource Prefix参数和VNF APP ID参数长度总和需要小于等于38，虚机组名称总长必须小于等于62位。中国电信填写：“[网元标识+序号]-[网元属性]”，如：PCF03-B。后续在LLD制作中，“VNF Advanced Settings”页面的虚机名称前缀参数自动置空，不填写。说明：VNF Resource Prefix参数和VNF APP ID参数长度总和需要小于等于35，虚机组名称总长必须小于等于62位。中国联通填写：“[网元类型+序号]-[BC/B/C/专网名称]-[厂家缩写]”，如：PCF003-B-ZX。后续在LLD制作中，“VNF Advanced Settings”页面的虚机名称前缀参数自动置空，不填写。说明：VNF Resource Prefix参数和VNF APP ID参数长度总和需要小于等于38，虚机组名称总长必须小于等于62位。其他运营商规范确定后，按规范要求填写。
Bureau ID|该参数用于设置ZXUN RCP的局号。取值范围：1~255之间的整数，需要根据运营商的规划来设置。规划原则：在同一个NFVO之内的各个NF的局号不能相同。在一个大区内及其容灾大区内同一类型的NF的局号不能相同。在特殊情况下，如果同一类型的NF的个数超过255，只需要保证有容灾关系的NF的局号不相同即可。
是否实例化|该参数用于配置需要通过AIC工具进行实例化部署的网元，本文档仅部署PCF网元，需要将是否实例化设置为YES。
实例化时使用网络预留功能|该参数在SDN组网环境时，需要配置为YES。该参数设置为YES，表示后续在实例化ZXUN RCP的过程，不会创建VNF SDN Network Setting页签中设置为规划预留的网络，这些网络需要在实例化成功后，操作员在MANO上通过NS方式纳管VNF，根据需要进行创建。该参数设置为NO，表示后续在实例化ZXUN RCP的过程，不会创建VNF SDN Network Setting页签中设置为规划预留的网络，后续操作员在MANO上也无法进行创建。
Vm Extern Size|该参数用于配置是否启用ZXUN RCP虚机规格别名。虚机规格别名主要控制虚机内部名称，可以由运营商规划虚机的名称。该参数设置为disable：不启用。该参数设置为enable：启用。启用虚机规格别名时，可配置VM Parameters中的Vm Extern Size列，该列默认为空。若不填写，则使用系统默认虚机规格别名。若填写，则使用此处所填的虚机规格别名。同一虚机的不同规格不能取同样的别名。国内运营商部署场景：本参数需要设置为enable。
##### VNF Resource Prefix 
VNF Resource Prefix页签仅用于核对各类资源名称前缀是否正确，不需要操作员配置，如[图1]所示。
 说明： 
在VNF Resource Prefix页签中禁止操作员手工执行解锁表格，增加/删除行、列或随意修改内容等操作。
图1  VNF Resource Prefix页签
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### VNF Version 
VNF Version用于配置ZXUN RCP的版本号，请根据实际情况配置，如[图1]所示。
 说明： 
此处的版本为中兴通讯内部使用的版本号。 
版本号只能选择下拉列表中的版本，不能手动更改隐藏表增加选项。 
图1  VNF Version页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### VNF Scenario 
VNF Scenario页签主要选择本次部署的VNF所使用的场景，如[图1]所示。
图1  VNF Scenario页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VNF Scenario Name|该参数用于根据实际业务量设置ZXUN RCP的局类型，参见表2。该参数决定了ZXUN RCP所要部署的NFS、虚机的个数和规格等参数。当该参数配置为商用大规格(hg)时，需要配置Enable OMU MultiQ参数和Enable IPU MultiQ参数。
Share|该参数用于设置5GC网元是否以共享方式部署。TRUE共享方式部署，需要支持5G切片功能，被多个切片共享时，必须选TRUE。FALSE不共享方式部署。不需要被多个切片共享，或者仅属于某个专用切片中的网元，设置为FALSE。本参数设置为TRUE。
Enable OMU MultiQ|该参数用于设置是否启用OMU虚机网卡多队列。当需要提升网络性能时，可以启用该功能。使用该功能需要满足如下条件：TECS OpenStack为V6.10版本及以上版本。虚机镜像为P9版本及以上版本。“VNF Advanced Settings”中OMU虚机是否启用TECS私有参数配置为enable。
Enable IPU MultiQ|该参数用于设置是否启用IPI虚机网卡多队列。当需要提升网络性能时，可以启用该功能。使用该功能需要满足如下条件：TECS OpenStack为V6.10版本及以上版本。虚机镜像为P9版本及以上版本。“VNF Advanced Settings”中IPI虚机是否启用TECS私有参数配置为enable。
商用规格|适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活/去激活预埋服务
---|---|---|---|---|---|---|---
商用大规格(cmcc)|中国移动数据局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务激活Npcf_LogStoreUnit服务
中国移动语音局|商用大规格(cmcc)|无报表功能无热备容灾|有|无|无|无|无
中国移动物联网局点|商用大规格(cmcc)|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务激活Npcf_LogStoreUnit服务
商用大规格|中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF|有|有|无|无|激活Ncudr_Access服务
中国电信非UDSF局|商用大规格|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务去激活Ncudr_SystemManagement服务回收CDU虚机激活Ncudr_AccessManagement服务激活Ncudr_Access服务
国际通用局点|商用大规格|无报表功能无热备容灾|有|无|无|无|无
部分国际局|商用大规格|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务
商用小规格|部分测试局|无报表功能无热备容灾|有|无|无|无|无
部分测试局|商用小规格|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务
 说明： 
商用大规格(hg)场景目前仅用于测试，无商用场景。 
商用大规格和商用大规格(cmcc)的区别：商用大规格中OMU/AMU虚机的规格：内存为24 G，硬盘为110 G。商用大规格(cmcc)中OMU/AMU虚机的规格：内存为32 G，硬盘为410 G。 
 说明： 
ZXUN RCP产品V7.21.30版本后启用了“服务预埋”功能，即部署VNF时预埋Npcf_LOG服务、Npcf_LogStoreUnit服务和Ncudr_Access服务，默认不实例化，在需要该服务时再激活服务，具体操作参见“[激活预埋服务（可选）]”。
对于无UDSF的场景，需要去激活UDSF相关服务，具体操作参见“[去激活服务（可选）]”。
##### Tenant & User 
本页签用于配置ZXUN RCP所规划的Tenant（租户）和User（用户）信息，如[图1]所示。
 说明： 
Tenant & Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
租户租户又称为项目。ZTE TECS OpenStack以项目的方式实现各个虚拟网元之间虚拟资源的隔离。同一个VNF内的主机、网络等资源归属到同一项目。 
用户ZTE TECS OpenStack支持多用户接入，不同的用户，在ZTE TECS OpenStack上可以拥有不同的操作权限和资源访问范围，可以为每一个项目创建一个用户。当一个VIM云平台同时管理运营商的多个VNF时，为隔离不同运营商的VNF，需要使用不同的用户来接入。通常情况下，除了ZTE TECS OpenStack默认的用户之外，还需要为每个项目都创建一个用户。本文档规划为ZXUN RCP项目创建自己的用户。 
Tenant & Users页签如[图1]所示，需要配置的Tenant（租户）和User（用户）信息涉及到三种类型：
VIM云平台（本文档指中兴通讯的TECS OpenStack） 
ZXUN RCP需要根据运营商的要求进行配置。 
SDN仅SDN组网架构时，才需要配置。 
图1  Tenant和Users页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]和[表2]。
参数名称|参数说明
---|---
Tenant Name|TECS Provider|该参数用于配置ZTE TECS OpenStack的租户名称，默认值为admin。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
PCF|Tenant Name|该参数用于配置ZXUN RCP的租户名称，请根据实际规划进行配置。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Shared External Network for vRouters|Tenant Name|该参数用于配置SDN的租户名称。本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
User Group Name|PCF|该参数用于配置ZXUN RCP所要创建的用户组的名称。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Username|TECS Provider|该参数用于配置ZTE TECS OpenStack的用户名称，默认值为admin。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
PCF|Username|该参数用于配置ZXUN RCP的用户名称，请根据实际规划进行配置。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Shared External Network for vRouters|Username|该参数用于配置SDN的用户名称。本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Password|TECS Provider|该参数用于配置ZTE TECS OpenStack的用户密码。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
PCF|Password|该参数用于配置ZXUN RCP的用户密码。需要按照如下原则设置密码：长度8位以上至少包含一个大写字母至少包含一个小写字母至少包含一个特殊字符不能包含用户名不能包含键盘上的连续三位不能包含三位连续字符不能包含三位重复的字符
Shared External Network for vRouters|Password|该参数用于配置SDN的用户密码。本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。
参数名称|参数说明
---|---
Enable VNF quota application|本参数的使用场景为：某些运营商要求，需要在MANO可以支持创建ZXUN RCP创建对应的项目，在创建项目（即租户）的同时，需要为项目分配资源，包括虚拟内核个数、内存大小、磁盘空间大小等虚拟资源。如果需要使用此功能，则此参数需要配置为YES。当本参数设置为YES时，需要依次配置下面三个参数。中国移动三期部署场景：本参数设置为YES，虚拟内核个数、内存大小、磁盘空间大小根据HLD规划填写实际配额。
VNF vCPU qouta (core)|表示为ZXUN RCP对应的租户（项目）分配的虚拟内核数量，该项目中启动的虚机的内核数总和不得超过该参数值。
VNF vRAM qouta (GB)|表示为ZXUN RCP对应的租户（项目）分配的虚拟内存数量。
VNF vStorage qouta (GB)|表示为ZXUN RCP对应的租户（项目）分配存储空间。
##### NTP Server 
NTP Server页签用于配置ZXUN RCP对应的NTP服务器，如[图1]所示。
 说明： 
通常情况下，使用EM作为ZXUN RCP的NTP服务器。本页参数无需修改。
图1  NTP Server页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### Volume Types 
Volume Types页签配置为ZXUN RCP规划的云硬盘类型名称，以及所使用的后端类型，如[图1]所示。
 说明： 
当Global Setting页签中的Storage
Type配置为CEPH或Disk Array时，才会出现该页签。
图1  Volume Types页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Volume Type Count|本参数用于设置ZXUN RCP的云硬盘类型个数。当ZXUN RCP需要部署存储QoS策略时，通常需要配置多个云硬盘类型，不同的云硬盘类型关联对应的存储QoS策略，并将不同的云硬盘类型关联到不同的虚机。存储Qos策略需要在“Storage QoS”页签中进行配置。当ZXUN RCP不需要部署存储QoS策略时，1个网元只需要1个云硬盘类型，该网元的所有虚机共用这个云硬盘类型。中国移动部署场景：本参数配置为3，即需要配置3个云硬盘类型。如图1所示，OMU虚机使用后缀为“-OMU-DISK”的云盘类型，LOG和LSU虚机使用后缀为“-LOG-DISK”的云盘类型，其他业务虚机使用后缀不带特殊标识的云盘类型。中国电信部署场景：本参数配置为1，即仅需配置1个云硬盘类型。
Volume Type Name|该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的ZTE TECS OpenStack）上创建的云硬盘对应的名称，用于给虚拟机分配数据存储空间。该参数引用VIM云管理平台已配置的名称，一般不建议修改。
Volume Backend|该参数是指在VIM云平台上创建云盘类型时，指定的存储后端。该参数是运营商操作员预先在VIM云平台（本文档指中兴通讯的ZTETECS OpenStack）上创建的。存储后端表示运营商使用磁阵或者Ceph来存储数据。配置时，需要注意：该参数为VIM云平台中（本文档指中兴通讯的TECSOpenStack）配置的存储池对应的存储后端的名称，而不是存储池的名称。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以根据中兴通讯的规范定义名称。
 说明： 
当修改了本页签中的Volume Type Count（云硬盘类型数量）、Volume Type Name（云硬盘名称）等参数后，需要同步修改“[Storage QoS]”页签、“[VM Parameters]”页签中各个存储QoS、虚机对应的云硬盘类型的数量和名称。
##### Storage QoS 
Storage QoS页签配置为ZXUN RCP规划的存储QoS策略，存储QoS策略是用于在VIM云管理平台上创建的云硬盘的读写策略。如[图1]所示。
运营商可以定义多个存储QoS策略，每个存储QoS策略都设置一个对应的名称，每个虚机都可以关联一个对应的存储QoS策略，该存储QoS策略可以对虚机对应的在VIM云管理平台上创建的云硬盘的读写策略进行限制。 
Storage QoS策略的实现原理为：本页签中定义的存储QoS策略会被Volume Types中定义的云硬盘类型关联、云硬盘类型被VM Parameters页签中定义的VNF虚机使用的云硬盘关联，最终体现为VNF虚机关联了存储QoS策略，相应的QoS策略生效。
 说明： 
如果运营商不使用后端存储设备，使用服务器主机的硬盘作为数据存储的设备的情况下，不需要配置本页签，即当Global Setting页签中的Storage Type配置为CEPH或Disk Array时，才会出现本页签。
图1  Storage QoS页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
QoS Policy Count|本参数用于设置ZXUN RCP的存储QoS策略的个数。规划了几个存储QoS策略供虚机使用，则此处就需要配置几个存储QoS策略。设置为0：表示ZXUN RCP不使用存储QoS策略。设置为非0的数字：表示ZXUN RCP使用存储QoS策略。通常情况下需要配置2个存储QoS策略，LOG和LSU虚机使用1个QoS策略，其他虚机使用1个QoS策略。
Storage QoS Policy Name|本参数用于设置ZXUN RCP的存储QoS策略的名称。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Volume Type Name|本参数用于设置当前QoS策略关联的云硬盘类型名称。该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的ZTETECS OpenStack）上创建的云硬盘对应的名称。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。云硬盘类型与存储QoS策略是一对一的关系，即：每个云硬盘类型只能关联1个存储QoS，每个存储QoS只能关联到1个云硬盘类型。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Total  Input/Output Bytes Per Second|总读写速度(字节/秒)，该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写速度。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
Total  Input/Output Bytes Per Second|总读写IOPS（次/秒），该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写IOPS。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
##### VM Parameters 
VM Parameters页签主要填写VNF相关虚机的规格、最大个数、虚机归属的AZ域及HA、使用的云盘类型等信息，如[图1]所示。
 说明： 
一般情况下该页签保持默认不修改，严禁修改VM Count和VM Max Count列，如果虚机数量和售前HLD不一致，待实例化完成后，再对相应的虚机进行扩容操作，直至所有虚机数量和售前HLD保持一致。 
 说明： 
规划网络地址数据时，需要满足如下原则： 
规划内部网络平面的CIDR地址段中可用地址数量不小于所有虚机最大数（VM MAX Count）的总和。 
规划IPU的外部网络平面的CIDR地址段中可用地址数量不小于所有IPU虚机最大数。 
需要检查隐藏表，是否已启用了虚机规格别名的修改。如果隐藏表中已启用虚机规格别名，并且虚机规格别名是大写并符合规范的，则不需要修改，反之需要修改。 
图1  VM Parameters页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
在配置本页面前，需要先了解ZXUN RCP的VM规划数据，参见[表1]。
VM|描述
---|---
OMU|对接CN-OAM（核心网集中网管），管理整局上电、版本加载、配置同步、网管命令执行、告警和性能统计汇总、各服务弹缩控制等功能。
CDU|UDSF数据存储单元。
GSU（HTTP LB）|HTTP负荷分担服务，实现HTTP协议消息分发。
GSU（SIG LB）|信令负荷分担服务，实现Diameter和SMS消息分发。
GSU（PolicyControl）|处理PCF和PCRF业务逻辑，提供AMPolicyControl、UEPolicyControl、SMPolicyControl和PolicyAuthorization服务。
GSU（GW）|UDSF统一接入网关。
IPU|IP接口虚拟机，收发IP承载的控制面信令和用户面报文。
LOG|策略日志单元，产生策略日志并存入云盘或LSU，并可通过FTP/SFTP上传给外部服务器。
LSU|策略日志存储单元，用于策略日志分析。
ZXUN RCP各个虚机类型的参数配置说明参见[表2]。
虚机类型|参数配置说明
---|---
CDU|CDU虚机的VM Count建议保持默认值。如果ZXUN RCP在后续使用过程中不再需要已部署的CDU虚机，则参见“去激活服务（可选）”，去激活Ncudr_Access服务和Nudsf_UnstructuredDataManagement服务，回收CDU虚机。
GSU|GSU虚机分别配置GSU (HTTP LB)、GSU (PolicyControl)、GSU (SIG LB)和GSU (GW)虚机类型。以图1为例，在商用大规格场景下，GSU各个虚机类型与虚机规格（VM Flavor）的对应关系如下：GSU (HTTP LB)：GSU-Common-C8GSU (PolicyControl)：GSU-Common-C8M32GSU (SIG LB)：GSU-C8-NGSU (GW)：GSU-CGW-C8其中，GSU (GW)虚机类型的VM Count需要配置为0。如果运营商有热备容灾功能，且内置UDSF，则需要参见“激活预埋服务（可选）”，在实例化后激活预埋的Ncudr_Access服务。
LOG|若运营商选择的部署场景涉及LOG虚机，则VM Count配置为0，且在ZXUN RCP实例化后参见“激活预埋服务（可选）”，激活预埋的Npcf_LOG服务。
LSU|若运营商选择的部署场景涉及LSU虚机，则VM Count配置为0，且在ZXUN RCP实例化后参见“激活预埋服务（可选）”，激活预埋的Npcf_LogStoreUnit服务。
参数说明参见[表3]。
参数名称|参数说明
---|---
VM Flavor|本参数用于设置ZXUN RCP虚机的规格，包括：vCPU：CPU核数Memory (GB)：内存数Local Storage(GB)：本地存储Remote Storage(GB)：远端存储这些参数不需要操作员配置，是由“VNF Scenario”页签中的参数VNF Scenario Name决定的。
VM Count|本参数根据“VNF Scenario”中选择的场景可以得到默认值，严禁修改。如果虚机数量和HLD规划不一致，待实例化完成后，可参考“配置虚机弹扩”对相应的虚机进行扩容操作，直到所有虚机数量和HLD规划数据一致。
VM MAX COUNT|本参数根据“VNF Scenario”中选择的场景可以得到默认值，严禁修改。如果虚机数量和HLD规划不一致，待实例化完成后，可参考“配置虚机弹扩”对相应的虚机进行扩容操作，直到所有虚机数量和HLD规划数据一致。
Availability Zone|本参数用于设置ZXUN RCP虚机所属的可用域（Availability Zones）的名称。本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪个可用域（Availability Zones），就配置为哪个可用域（AvailabilityZones）的名称。
Host Aggregate Metadata|本参数用于设置HA元数据属性。本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪种HA元数据属性的主机上，就配置为对应的HA元数据属性。
Anti-affinity Policy / Factor|本参数用于设置Anti-affinity Policy（反亲和策略）或者Anti-affinity Factor（反亲和因子）。ZXUN RCP只涉及到配置Anti-affinity Policy（反亲和策略）。本参数用于控制是否将一个虚拟机组（Server-group）中的多个同种类型的虚机（例如OMU虚机）分别部署在不同的主机上。包括如下选项：no_limitation不限制。表示系统不对虚机部署进行限制，即同种类型的虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。anti_affinity反亲和。设置为此选项，表示系统需要对虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个同种类型的虚机必须分散部署在ZXUN RCP所在可用域（Availability Zones）的不同主机上。设置为本参数后，操作员还可以通过反亲和组名来设置互斥组的名称。soft_anti_affinity软反亲和。设置为此选项，表示系统需要对同种类型的虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。OMU/AMU/IPU/CDU虚机建议配置为anti_affinity，其他虚机建议配置为soft_anti_affinity。
antiAffinity VMNumber|本参数表示反亲和组内虚机最大个数，建议保持默认值。
dedicated|本参数用于设置虚机使用的亲和策略是否由专用插件管理。CDU虚机使用的亲和策略由专用插件管理，建议保持默认值。
Accel Resource Policy|本参数用于设置虚机使用的加速资源策略，建议保持默认值。
Backup Instance Number|本参数用于设置同一批次允许下电的虚机个数或者虚机比例。若本参数配置为比例值，则取值为单批次允许下电的虚机数占用当前虚机数的比例。
VM Volume Type|本参数用于设置ZXUN RCP的虚机使用的云硬盘类型。本参数的取值是通过Volume Types页签配置的。当在Volume Types页签中为ZXUN RCP设定了多个云硬盘类型时，在本表格的下拉框中可以进行选择，参见“Volume Types”。
Priority of VM creation|本参数用于设置在实例化过程中，创建虚机资源的优先级，数字越小表示优先级越高。建议所有的虚机都使用默认值1，即所有的虚机的优先级都为最高，表示在实例化ZXUN RCP的过程中，会并行创建所有虚机及相关资源。
Priority of VM restart|本参数用于设置虚拟机启动上电的优先级。取值范围为1~10，数值1表示优先级最高，数值10表示优先级最低。虚拟机启动上电时，虚拟机所在的服务器根据虚拟机对应的优先级进行处理，将优先级高的虚拟机先上电，将优先级低的虚拟机后上电， 一般情况下，建议将OMU优先级设置为1。
Vm Extern Size|本参数用于设置虚机规格别名。当VNF ID中的Vm Extern Size参数设置为enable时，表示启用虚机规格别名。虚机规格别名主要控制虚机内部名称。同一虚机的不同规格不能取同样的别名，保持默认值即可。
Qos Policy Name of MGT|本参数用于设置MGT网络的QoS策略，保持默认即可。
Qos Policy Name of SERVICE|本参数用于设置SERVICE网络的QoS策略，保持默认即可。
Qos Policy Name of EMS/EXT|本参数用于设置EMS/EXT网络的QoS策略，保持默认即可。
Flexible Resource Policy|本参数用于设置灵活的资源策略，保持默认即可。
##### VRF Summary 
VRF Summary用于配置交换机侧的VRF和VNF侧的VRF，如[图1]所示。
本页签的配置原则如下： 
本页签默认包括了所有类型的NF可能涉及到的所有的VRF。一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可。
 说明： 
该页签无效，AIC不会读取该页签数据，保持默认值即可。中移物联网七期增加EDGE和SMS VRF。 
图1  VRF Summary页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
默认的VRF参数说明参见[表1]。
类别|VRF名称（示例）|说明
---|---|---
业务交换机侧需要配置的VRF|mng|交换机管理口内置VRF。
EMS|业务交换机侧需要配置的VRF|用于ZXUN RCP与EMS通信。
SIG|业务交换机侧需要配置的VRF|用于ZXUN RCP与不同业务域网元间信令互通。
NF侧需要配置的VRF|SBI|用于ZXUN RCP与5G网络中的SBI接口。在5G标准规范的系统架构中引入了服务化接口（即SBI）的概念，来表述一个NF提供其所具有的服务（或服务集合）给其他的NF使用的方式，在5G标准中一般采用Nxxx（如Namf，Nudm等）的方式表达。
EMS|NF侧需要配置的VRF|用于ZXUN RCP与EMS通信。
SIG|NF侧需要配置的VRF|用于ZXUN RCP与不同业务域网元间信令互通。
##### VNF Network Qos 
VNF Network Qos页签用于配置ZXUN RCP的网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略，如[图1]所示。
 说明： 
该页签不修改，保持默认值，中移三期将使用20种网络QoS。 
图1  VNF Network Qos页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Qos Policy Count|本参数用于设置ZXUN RCP的网络Qos策略的个数。规划了几个网络QoS策略供虚机使用，则此处就需要配置几个网络QoS策略。设置为0：表示ZXUN RCP不使用网络QoS策略。设置为非0值：表示ZXUN RCP使用的网络QoS策略数量，需要在VNFNetwork Setting或VNF Network Setting IPv6页签中修改网络QoS策略最大带宽值。
Network Qos Policy Name|该参数用于设置ZXUN RCP的网络QoS策略的名称。运营商可以定义多个网络QoS策略，每个网络QoS策略都设置一个对应的名称，每个虚机都可以配置一个对应的网络QoS策略，该网络QoS策略可以对虚机中的各个网卡进行限制。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以根据中兴通讯的规范定义名称。
Max Egress Bandwidth (kbps)|（出口）双向最大带宽，该参数用于配置硬件服务器网卡出口的双向最大带宽。
Max Egress Bandwidth (kbps)|（出口）双向最大突发带宽，该参数用于配置硬件服务器网卡出口的双向最大突发带宽。
Max Ingress Bandwidth (kbps)|（入口）双向最大带宽，该参数用于配置硬件服务器网卡入口的双向最大带宽。
Max Ingress Burst Bandwidth (kbps)|（入口）双向最大突发带宽，该参数用于配置硬件服务器网卡入口的双向最大突发带宽。
 说明： 
ZXUN RCP在此处设置是否启用网络Qos功能，启用后，需要在VNF
Network Setting或VNF Network Setting IPv6页签中修改网络Qos策略最大带宽值。
##### VRouter Summary 
VRouter Summary用于配置ZXUN RCP的虚拟路由，如[图1]所示。
当ZXUN RCP采用SDN+VxLAN组网时，需要在SDN中配置虚拟路由，这些数据会由TECS
OpenStack传递给SDN控制器。
VRouter Summary页签的配置原则如下：
当Global Setting页签中的Network Type配置为VxLAN时（表示ZXUN RCP使用SDN组网架构），操作员才需要配置此页签。
图1  VRouter Summary页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VRouter Name|本参数用于配置虚拟路由的名称，包括需要创建的虚拟路由和当前已存在的虚拟路由。虚拟路由名称限制长度为不超过31个字符。
VRouter Usage (VPN)|本参数用于配置虚拟路由器的用途说明。
VRouter Deployment|本参数用于配置本次实例化时是否创建该虚拟路由。包括以下选项：本次实例化当前已存在第一个通过AIC自动工具部署的NF，则选择本次实例化，后续通过AIC工具再部署其他的NF，由于VRouter已经创建过，则选择当前已经存在。
 说明： 
中国移动数据部署场景下：需要规划NMS平面、SG平面和SMS平面三个vRouter。 
中国移动物联网部署场景下：需要规划NMS平面、SG平面、SMS平面和EDGE平面四个vRouter）。 
中国移动语音部署场景下：只需要规划NMS平面和SG平面的vRouter，不需要规划SMS平面的vRouter。 
##### VRouter External Network 
VRouter External Network用于配置ZXUN RCP的虚拟路由的外部网络和子网信息，如[图1]所示。虚拟机可以通过虚拟路由器上配置的外网网段的接口访问外部网络。
当ZXUN RCP采用SDN+VxLAN组网时，需要在SDN中配置虚拟路由，这些数据会由TECS
OpenStack传递给SDN控制器。
所有的VRouter目前支持的共享网络平面都只能用一个外部网络，对外网络相关信息全部由SDN侧提供。 
VRouter External Network页签的配置原则如下：
当Global Setting页签中的Network Type配置为VxLAN时（表示ZXUN RCP使用SDN组网架构），操作员才需要配置此页签。
图1  VRouter External Network页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
VRouter External Network参数说明参见[表1]。
参数名称|参数说明
---|---
VRouter Name|本参数用于设置虚拟路由的名称，根据规则默认生成，不建议修改。
VRouter Deployment|本参数用于设置虚拟路由的部署方式，保持默认值“本次实例化”。
Distributed|本参数保持默认值“True”。
External Net Enable|本参数用于设置外部网络开关，NMS网络默认开启一个“ExNET1”，其余网络默认开启两个“ExNET1”。
External Net Name|本参数用于设置外部网络名称，根据规则生成默认名称，若需改动，删除规则后手动输入即可。
Share Type|本参数用于设置外部网络共享类型。shared：外部网络平面为共享式外部网络平面。private：外部网络平面为独立的直挂式外部网络平面。默认设置为“shared”。
VLAN ID|本参数用于设置VLAN ID，根据实际规划填写。
External Subnet|本参数用于设置外部网络的子网IP类型，保持默认即可。
External Subnet Enable|本参数用于设置外部网络的子网开关。若需要开启子网，则保持默认“Enable”。
External Subnet Name|本参数用于设置外部网络的子网名称，根据规则生成默认名称。若需改动，删除规则后手动输入即可。
IP Version|本参数用于设置子网IP版本，与External Subnet保持一致即可。
ABCDEFGH|IPv4地址填写ABCD列，IPv6地址填写ABCDEFGH列。
Mask|本参数用于设置子网掩码，根据实际规划填写。
Subnet CIDR|本参数用于设置子网CIDR，自动生成，生成后保持默认。
Gateway IP|本参数用于设置子网网关IP地址，根据实际规划填写。
Next Hop|本参数用于设置外部网络下一跳地址，保持默认即可。
MTU|本参数用于设置网卡的MTU值，默认值1500。
Physical Network|本参数用于设置物理网络，保持默认即可。
Comment|本参数用于设置备注，保持默认即可。
 说明： 
所有的VRouter目前支持共享网络平面，都只能用一个外部网络，配置的子网与SDN控制器对应。 
需要SDN侧添加路由，Ping通VRouter上的网关地址（OAM平面网关地址）。 
该页签设置的对外网络相关信息全部由SDN侧提供。 
中移三期，使用具有Admin权限的用户和租户，创建共享外部网络平面和子网（平面的名称、VLAN、CIDR等信息需提前规划，并在SDN控制器手工进行对应配置）。 
每个设置为“本次实例化”的VRouter，使用一个外部共享网络平面，填写该网络和子网的信息， AIC在部署时会查询。如果网络平面不存在，则新建；反之，则直接引用。 
##### VNF SDN Network Setting 
VNF SDN Network Setting配置为ZXUN RCP规划的网络平面相关信息，包括网络平面名称、网段、网关等信息，如[图1]所示。
 说明： 

根据实际LLD规划填写或者修改VxLAN ID、IP地址、MASK、Gateway IP等红色字体部分，其他地方保持默认值即可。 
业务网络平面、子接口、VLAN ID划分，需要根据实际组网规划来进行划分。相应交换机或者路由器上需要配置相对应的网络平面网关及所属业务VRF。 
当Global Setting页签中的Network Type配置为VxLAN时（表示ZXUN RCP使用SDN组网架构），操作员才需要配置此页签。
图1  VNF SDN Network Setting页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
 说明： 
在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VNF Brief Name|本参数为网元简称。
Network Usage|ZXUN RCP的各个网络平面的网络用途规定如下：内部控制面需要设置为INTERNAL MGT（内部管理通信）内部媒体面需要设置为INTERNAL SERVICE（内部服务通信）所有的外部网络平面需要设置为EXTERNAL（外部业务通信）ZXUN RCP的网管平面的设置原则如下：OAM (Used OAM network of VNFM)ZXUN RCP的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行二层互通。OAM (Used Shared IPv4 OAM Subnet)ZXUN RCP的OAM平面（即网管平面）使用已存在的多网元共享的OAM网络平面（非VNFM的OAM平面）与VNFM进行三层互通。OAM (Create individual OAM network)ZXUN RCP的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行三层互通。ZXUN RCP的网管平面需要区别IPv4和IPv6分别设置。
Share type|本参数用于配置网络透传模式。True：透传False：不透传参考以下原则进行配置：当NFVI启用QinQ功能时，需设置为True。对于网元内部网络平面，默认采用非透传模式，不可修改。对于业务外部网络平面需要使用透传模式时选择True，需要使用非透传模式时选择False。
vNIC Type|本参数用于配置业务虚机的网卡类型。normal：表示虚机的网卡启用OVS/DVS。SR-IOV：表示虚机的网卡启用SR-IOV。
Network Deployment|本参数用于配置ZXUN RCP的网络平面是事先通过TECS OpenStack创建的，还是由操作员直接在LLD中配置的。对于所有的NF共用的网管平面，在部署ZXUN RCP之前，如果已经创建成功，则网管平面需要配置为当前已存在。本次实例化如果操作员直接通过LLD创建ZXUN RCP的网络平面，则需要配置为本次实例化。当前已经存在表示LLD中配置的网络平面，操作员已经预先通过TECS OpenStack创建成功，LLD表格中填写的网络平面名称需要从TECS OpenStack处查询获取。
Brief Net Name|ZXUN RCP的网络平面的简称。需要新增网络平面时，在红色底纹的空行处，在此列填写一个简要名称，就会自动增加一行网络平面，再选择对应的vNICType、填写相应的网段、VLAN信息。
Net Name|该参数用于设置网络平面的名称。根据规划的数据进行创建。
VxLAN ID|本参数用于配置每个网络平面的VxLAN ID。需要根据规划配置。
Subport Count|本参数用于配置子接口个数，表示对应网络平面生成的接口下规划多少个子接口。
SubNet IP Type|本参数为子网IP类型。
Subnet Name|本参数为子网名称。
Subport VLAN ID|本参数用于配置每个网络平面子接口的的VLAN ID。需要根据规划配置。
VRouter|本参数用于配置该网络平面对外通信所需使用的虚拟路由。
VNF Side VRF|本参数用于配置VNF侧的VRF信息。
A-H|本参数用于配置每个网络平面的IPv6地址，注意D为VLAN ID。根据组网规范的IPv6地址填写。
MASK|本参数用于配置每个网络平面的掩码。根据需要确定掩码大小。
Subnet CIDR|本参数为子网的网段范围。在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。
Gateway IP|本参数为网关IP地址。
MTU|该参数表示VNF的MTU数值。如果运营商没有特殊要求，则内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。如果运营商对MTU有特殊要求，则需要根据运营商的规范进行设置。
Network Qos Policy Name|本参数用于配置每个网络平面的网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略，需要根据规划配置。
Physical Network|该参数用于设置此网络平面对应的物理网络名称，根据规划数据，VNF的项目所有网络平面对应的物理网络名称都规划为physnet1。
Security group|安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（SecurityGroup Rule）。需要预先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组的情况下，该参数的值才会生效。
##### VNF Vlan Trunk IP 
配置原则 :VNF Vlan Trunk IP页签用于配置IPU虚机的IP地址范围。
该页签保持默认值不修改，PortIpList保持为空不填写。 
配置说明 :VNF Vlan Trunk IP页签如[图1]所示。
本页签配置的IP地址是为实例化成功后，系统为IPU虚机分配的IPv4或IPv6地址。
图1  VNF Vlan Trunk IP

##### VNF O&M IPv6 
本页签用于修改ZXUN RCP的操作维护网段的公网及浮动IP地址，如[图1]所示。
 说明： 
在本页签中，仅需要修改H列的内容，H列根据C列地址段范围内前三个地址按顺序填写，对于VNF O&M IPv6页签中其他参数，取值为固定值，操作员不需要修改。
图1  VNF O&M IPv6页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### VNF Advanced Settings 
VNF Advanced Settings页签用于设置ZXUN RCP的属性，如[图1]所示。
图1  VNF Advanced Settings页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
业务系统名称|本参数用于设置ZXUN RCP实例化成功后，在MANO上看到的ZXUN RCP的名称。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称，名称中不能包含“.”。|业务系统名称
蓝图包名称|本参数用于设置在MANO上快速创建ZXUN RCP的版本包时，配置的新包名称，需根据运营商规范配置。|蓝图包名称
蓝图包版本号|本参数用于设置在MANO上快速创建ZXUN RCP的版本包时，配置的新包的版本号。此处配置的是交付运营商的软件包的对外版本号。不是中兴通讯内部的版本号。|蓝图包版本号
蓝图包厂商|本参数用于设置在MANO上快速创建版本包时，设置的厂商名称。中国联通场景，本参数需要设置为ZX。中国移动场景，本参数需要设置为ZT。中国电信场景，本参数需要设置为ZE。其他场景，本参数需要设置为ZTE。|蓝图包厂商
镜像包名称|本参数用于设置导入到MANO中，显示的CGSL镜像包的名称，需要根据实际包中的resource.meta里的Name字段填写。|镜像包名称
接入的EMS地址|本参数用于配置VNF部署后，需要接入的EMS地址。实例化VNF时，会将该地址传给VNFM，在实例化VNF完成后由VNFM将VNF自动接入指定的EMS。该功能需VNFM上提前打开功能开关。|接入的EMS地址
所属地域|本参数用于设置ZXUN RCP归属的地域，在某些特殊运营商的要求下，才需要配置。配置原则：归属省份，如果ZXUN RCP归属的地区是广州市，那么该参数配置为广东。|所属地域
分权网元类型|本参数用于设置ZXUN RCP的网元类型，在某些特殊运营商的要求下，才需要配置。需根据运营商规范配置。|分权网元类型
虚机名称前缀|在某些特殊运营商的要求下，才需要设置此参数，需要根据规范配置：所属省份标识+网元标识+网元序号+网元属性+厂家标识，示例：JS-PCF-100-A-ZX命名规范格式如下所示，分为多个部分，每个部分之间用短横线-连接：网元归属省/大区：由2-3位英文字母组成，示例：JS网元标识：由1-8位英文字母组成，示例：PCF网元序号：由1-3位数字组成，示例：100网元属性：两个取值，A表示骨干，B表示省内。厂家标识：由2-3位英文字母组成，示例：ZX|虚机名称前缀
云主机类型命名规则|命名规则1：ram_x_vcpus_x_disk_x_uuid在运营商没有特殊要求的情况下，默认使用此种规则命名规则2：资源前缀-FLA-自定义IDGlobal Setting页签中Application scenarios设置为12-CMCCPhase2、11-CMCC Phase1和1-5GS三种场景之一时，使用此种规则。|云主机类型命名规则
镜像可视性|该参数用于设置ZXUN RCP的虚机操作系统镜像的属性，一般配置为private（私有），在特殊情况下，才需要配置为public（共享）。publicprivatesharedcommunity国内运营商场景：固定配置为private。|镜像可视性
启用密文传输敏感数据|本参数通常情况下，建议设置为enable，启用此功能后，VNFD版本包插件的内容中不会有明文密码等敏感信息，系统会进行加密处理。国内运营商场景：固定配置为enable。|启用密文传输敏感数据
对接VNFM的IP地址版本|该参数用于设置NF对接VNFM的IP地址版本，根据实际组网规划配置。|对接VNFM的IP地址版本
vnf和vnfm间会话协议类型|该参数用于配置VNF和VNFM之间的会话协议类型，VNF和VNFM之间支持双向认证，配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为http。如果运营商的部署环境，开启了安全加固功能，则此参数配置为https。国内运营商场景：固定配置为https。|vnf和vnfm间会话协议类型
vnf向vnfm获取token|该参数用于设置VNF是否可以向VNFM获取token。token是计算机术语，表示令牌的意思，令牌是一种能够控制站点占有媒体的特殊帧，以区别数据帧及其他控制帧。通俗的说法，token可以称为暗号，在一些数据传输之前，服务端和客户端之间要先进行暗号的核对，不同的暗号会被授权不同的数据操作权限。Token是在服务端产生的。如果客户端使用用户名/密码向服务端请求认证，服务端认证成功，那么服务端会给客户端返回一个Token。客户端可以在每次发起请求消息时，携带Token证明自己的合法地位。该参数的配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为不启用。如果运营商的部署环境，开启了安全加固功能，则此参数配置为启用。|vnf向vnfm获取token
vnf向vnfm获取token的用户名|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其他的用户，具体操作参见“在VNFM上创建用户”。需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。|vnf向vnfm获取token的用户名
vnf向vnfm获取token的密码|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其他的用户，具体操作参见“在VNFM上创建用户”。需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。|vnf向vnfm获取token的密码
镜像看门狗超时措施|本参数用于设置启用镜像watchdog功能后，自动触发的动作（watchdog_action）。ZXUN RCP定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。国内运营商场景：固定配置为reset。|镜像看门狗超时措施
虚机看门狗超时措施|本参数用于设置启用虚机watchdog功能后，自动触发的动作（watchdog_action）。ZXUN RCP定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。国内运营商场景：固定配置为none。|虚机看门狗超时措施
虚机看门狗监控时长(分钟)|该功能用于设置虚机看门狗超时（watchdog_enabledelay）时长，默认值为600000毫秒，即10分钟。通常情况下建议使用默认值。该时长是VM启动后，到首次喂狗动作之间的时间间隔，如果超过这个间隔没有进行喂狗操作，则会触发watchdog_action的动作。如果虚机看门狗触发动作（watchdog_action）配置为reset，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM会主动复位虚机。如果虚机看门狗触发动作（watchdog_action）配置为none，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM不会执行复位虚机的操作。|虚机看门狗监控时长(分钟)
OMU虚机MGT平面端口的网络Qos|该参数表示OMU虚机的MGT平面端口的网络QoS值。此处如果为空值，则取对应MGT网络平面的网络QoS值。|OMU虚机MGT平面端口的网络Qos
其他虚机的端口QoS配置数据参见OMU虚机MGT平面端口的网络QoS参数说明。|其他虚机的端口QoS配置数据参见OMU虚机MGT平面端口的网络QoS参数说明。|其他虚机的端口QoS配置数据参见OMU虚机MGT平面端口的网络QoS参数说明。
OMU虚机|cpu_model参数|对应flavor中的hw:cpu_model参数。不同种类的虚机可以根据实际部署时使用的计算节点CPU类型进行配置。配置该参数之前，需要在TECS OpenStack控制节点上，通过命令查询虚机部署使用的计算节点的cpu信息，示例：source keystonerc_admin nova hypervisor-show Computer0102 |grep cpu_info_model Haswell
mem_page_size参数|OMU虚机|该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。small：选择使用小页。large：选择使用巨页。1048576：选择使用1048576的页面。1GB：选择1GB的页面。该参数建议采用默认值1GB。
trait_required参数|OMU虚机|该参数提供给虚拟层平台自定义扩展使用，实际部署时与平台协商约定。例如，平台可以定义使用某个字符串代表本虚机必须部署在哪些主机上。如平台无要求，该参数可以保持默认值空。
trait_forbidden参数|OMU虚机|该参数提供给虚拟层平台自定义扩展使用，实际部署时与平台协商约定。例如，平台可以定义使用某个字符串代表本虚机禁止部署在哪些主机上。如平台无要求，该参数可以保持默认值空。
是否启用TECS私有参数|OMU虚机|如果VIM云管理平台使用中兴通讯的TECS OpenStack，则该参数建议设置为启用。如果VIM云管理平台使用第三方厂家的系统，则该参数建议设置为不启用。
其他虚机的配置数据参见OMU虚机的参数说明。|其他虚机的配置数据参见OMU虚机的参数说明。|其他虚机的配置数据参见OMU虚机的参数说明。
是否实例化CGW|该参数用于配置是否实例化CGW。disable：ZXUN RCP享受其他运营商提供的CGW服务。enable：ZXUN RCP自身提供CGW服务。|是否实例化CGW
UDSF配置信息|租户id|该参数用于唯一标识一个租户。保持默认值。
租户名称|UDSF配置信息|该参数用于配置租户名称。保持默认值。
初始数量|UDSF配置信息|该参数用于配置初始启动的CDU虚机数。保持默认值。
最大数量|UDSF配置信息|该参数用于配置最大的CDU虚机数。保持默认值。
虚机规格|UDSF配置信息|该参数用于配置CDU虚机的规格。保持默认值。
主用NF|UDSF配置信息|该参数用于配置租户对应的主用NF标识。保持默认值。
备用NF|UDSF配置信息|该参数用于配置租户对应的备用NF标识。保持默认值。
CGW配置信息|最大数量|该参数用于配置CGW节点的最大数量，需要根据实际的规划来设置。
虚机规格|CGW配置信息|保持默认值。
是否启用删除虚拟机不删除数据盘|各个虚机的该参数配置保持默认值。|是否启用删除虚拟机不删除数据盘
##### VNF Resourse Naming Rules 
VNF Resourse Naming Rules用于配置ZXUN RCP使用的虚拟资源的规范，需要根据各个运营商的实际情况进行配置。无特殊要求可不配置。
VNF Resourse Naming Rules页签如[图1]所示。
图1  VNF Resourse Naming Rules

##### Capabilities Flows 
Capabilities Flows页签用于配置是否下发各个虚机的流表容量参数给VIM，如[图1]所示。
图1  Capabilities Flows

参数说明参见[表1]。
参数名称|参数说明
---|---
是否下发流表容量|本参数适用于VIM平台使用中兴通讯自研的TECS OpenStack的场景，在配置此参数前，需要操作员确认TECS OpenStack的版本是否支持流表，如果TECS OpenStack不支持，则此参数需要配置为disable，否则会报错。在实际环境中，如果当前的TECS OpenStack支持流表，且规划了ZXUN RCP需要将流表容量参数下发给VIM，则本参数需要配置为enable。同时，需要将VNF Advanced Settings中各虚机的是否启用TECS私有参数设置为enable。在实际部署过程中，ZXUN RCP会将本表格中的参数流表容量值配置的数据，下发给VIM。中国移动三期部署场景：本参数设置为enable，且仅需设置IPU虚机的流表容量值为40000，其余虚机流表容量值保持默认值为3000。
##### Version File 
Version File页签用于配置ZXUN RCP的版本文件名称，如[图1]所示。
图1  Version File页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
FileName|本参数用于配置版本文件的名称，包括以下文件：基础包：pcf_vnfd.VXXX.csar业务软件包：PCF_VXXX.zip镜像包：cgsl.YYY.zipAIC插件包：aic-plugin-pcf-v*.zip
XXX表示ZXUN RCP具体的版本号，以实际版本为准。
YYY代表对应VIM云平台管理系统（如TECS OpenStack）版本号，以实际版本为准。 
##### Image Setting 
Image Setting页签用于配置在实例化ZXUN RCP过程中，是否使用镜像包名称自动修改功能。
自动修改镜像包名称功能是指通过MANO上传、导入镜像包后，MANO根据该页签参数设置值自动修改镜像包的名称和属性。 
当启用自动修改镜像包名称功能时，要求TECS OpenStack平台上没有重名镜像包。如果此前有一个镜像包未改名而且已被注册使用，那么后续相同名称的镜像包就无法上传也无法修改，将会导致ZXUN RCP实例化失败。
此时，需要参考“[修改镜像文件名称]”操作，手工修改镜像包名称。
中国移动三期要求启用自动修改镜像包名称功能，不采用手工镜像改名方式。 
 说明： 
此处的镜像包是指创建虚机时使用的CGSL操作系统镜像文件包（通常以cgsl.vXXX.zip的形式命名，包含操作系统和双机软件）。
Image Setting页签如[图1]所示。
图1  Image Setting

参数说明参见[表1]。
参数名称|参数说明
---|---
Enable Image Name Modification|本参数需要根据运营商的情况进行配置。如果运营商对镜像包名称有特殊要求，需要根据运营商的命名规范来修改镜像包的名称，本参数需要配置为YES。若配置为YES，则需要同时配置下面CGSL相关参数。如果运营商对镜像包名称没有特殊要求，操作员可以使用默认值 ，则本参数需要配置为NO。中国移动三期部署场景：本参数建议设置为YES，采用自动修改镜像包名称功能。
CGSL Package name|本参数用于修改CGSL镜像包名称，对应CGSL镜像包的resource.meta文件中的Name参数。
CGSL Package version|本参数用于修改CGSL镜像版本号，对应CGSL镜像包的resource.meta文件中的Version参数。
CGSL Image name|本参数用于修改CGSL镜像文件名称，对应CGSL镜像包的resourceList.json文件中的name参数。
CGSL file_url|本参数用于修改CGSL镜像文件相对于包根目录的URL路径，对应CGSL镜像包的resourceList.json文件中的file_url参数。
CGSL Image tags|本参数用于修改CGSL镜像标签，如： tag1,tag2,tag3。
CGSL hw_disk_bus|本参数用于修改CGSL镜像的磁盘总线类型。建议保持默认值。
CGSL hw_scsi_model|本参数用于修改CGSL镜像的scsi模式。建议保持默认值。
CGSL hw_watchdog_action|本参数用于设置是否启用镜像看门狗，对应CGSL镜像包的resourceList.json文件中扩展属性的hw_watchdog_action参数。
##### VNF SFTP Server 
VNF SFTP Server页签用于配置ZXUN RCP的SFTP服务器信息，如[图1]所示。
图1  VNF SFTP Server页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
SFTP server IPv4/IPv6 address|本参数用于设置上传、导入版本包时使用的SFTP服务器IP地址。此处需要配置可以和NFVO的网管平面互通的IP地址。存放在SFTP服务器的软件，需要通过FTP方式上传至NFVO服务器的指定路径下，所以SFTP服务器的地址，是需要与NFVO的网管网络平面互通的地址。
SFTP username|本参数用于设置访问SFTP服务器的用户名。默认用户名为root。
SFTP password|本参数用于设置访问SFTP服务器的密码。默认的密码为CloudStudio__123，其中__为两个下划线。
Path|本参数用于设置FTP服务器上存放ZXUN RCP的基础包路径，此处需要设置为绝对路径。可设置为基础包的具体文件所在路径或上一级目录。设置为目录时，可上传该目录下的所有软件包。此路径需要开通可写权限，此路径在部署ZXUN RCP前需要已经存在。
Delete version packages after successful deployment|本参数用于配置ZXUN RCP部署成功后，是否自动删除SFTP服务器上的版本包。YES：删除如果临时使用VNFM为SFTP服务器，建议删除。NO：不删除如果后续还会部署相同版本的ZXUN RCP时，建议不需要删除，后续操作可以继续五个他当前版本包。
##### NS Info 
NS Info页签用于配置在ZXUN RCP部署成功后，是否还继续创建NS实例来纳管本ZXUN RCP。
NS Info页签如[图1]所示。
图1  NS Info

参数说明参见[表1]。
参数名称|配置指引
---|---
是否执行NS纳管VNF|本参数用于配置在ZXUN RCP部署成功后，是否还需要创建NS实例来纳管本ZXUN RCP。根据运营商的规划进行配置。若本参数设置为YES，则需要同时配置下面的参数。
NS蓝图包名称|根据运营商规范命名，无规范时自定义。建议与网元实例名称对应，例如：NSD-HDBNJahSMF001BZX-03AZX011。
NS蓝图包厂商|本参数的取值来源于VNF Advanced Settings页签中的蓝图包厂商参数值 ,参见VNF Advanced Settings，此处自动引用，无需修改。
NS蓝图包版本号|根据运营商的规范填写，在运营商没有规范的情况下，需要配置为默认值：1.0。
NS实例名称|根据运营商规范命名，运营商没有规范时，操作员可以自定义。建议参考VNF命名规范的定义，前缀改成"NS-"。例如： NS-HDBNJahSMF001BZX-03AZX011
NS实例类型|本参数配置为固定值5GC。
NS实例规格|本参数配置为固定值Default。
NS实例操作场景|本参数配置为固定值access。
NS实例中纳管的VNF实例名称|本参数的取值来源于VNF Advanced Settings页签中的业务系统名称参数值 ,参见VNF Advanced Settings，此处自动引用，无需修改。
纳管的VNF实例所在的VIM名称|本参数的取值来源于Global Setting页签中的VIM Name参数值 ,参见Global Setting，此处自动引用，无需修改。
需纳管的vRouter列表|本参数的取值来源于VRouter Summary页签中的VRouter Name参数值 ,参见VRouter Summary，此处自动引用，无需修改。
##### VNF Static Route 
VNF Static Route页签用于获取ZXUN RCP的静态路由信息，如[图1]所示。
 说明： 
通常情况下，这些数据可以在ZXUN RCP实例化成功后，由操作员手动进行配置，不需要在本页签中进行配置。
图1  VNF Static Route页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Service IP|本参数用于表示目的地址，空值表示无需配置该网络平面的静态路由。
Source IP|本参数用于表示源地址，空值表示无需配置该网络平面的静态路由。
VRouter Usage(VPN)|本参数可以不填写，不影响静态路由配置。默认数据取自“VRouter Summary”的VRouter Usage参数。
##### TAP Service和TAP Flow（可选） 
配置原则 :TAP Service和TAP Flow页签用于配置流镜像相关的数据。
流镜像是VIM云平台（本文档指中兴通讯的TECS OpenStack）中的neutron组件实现的一种网络端口镜像的功能，可以对网络流量进行监控，在网络出现问题时，维护人员通过流镜像可以快速发现和定位故障。 
配置流镜像，是指把某个虚机（源虚机）的报文复制到其他虚机（目的虚机）的网卡或者物理交换机端口。 
在运营商使用了流镜像功能的场景下，才需要配置TAP Service和TAP Flow页签。
如果运营商没有使用流镜像功能，则操作员可以将这两个页签中默认的数据全部删除；也可以在执行VNF部署时不勾选PCF配置TAAS部署功能项，参见“[自动部署VNF]”。
 说明： 
TAP Service和TAP Flow页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
配置说明 :TAP Service页签如[图1]所示。
图1  TAP Service

TAP Flow页签如[图2]所示。
图2  TAP Flow

参数说明参见[表1]。
参数名称|参数说明
---|---
TAP Service Name|本参数用于配置目的虚机网卡和物理交换机端口，即抓包端口。
TAP Flow Name|本参数用于配置源虚机的端口，即需要镜像报文的端口。可以指定镜像的报文方向和使用的流镜像过滤器。
##### VPC（可选） 
VPC页签用于配置两端虚拟路由器的业务地址信息，实现路由互通，如[图1]所示。
 说明： 
在运营商开启了VPC功能的场景下，才需要配置。
通常情况下，VPC数据可以在ZXUN RCP实例化成功后，由操作员手动进行配置，不需要在本页签中进行配置。
操作员可以将该页签中默认的数据全部删除；也可以在执行VNF部署时不勾选PCF配置VPC部署功能项，参见“[自动部署VNF]”。
图1  VPC页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Local vRouter Name|本端vRouter名称，与对端vRouter互通。
Local CIDR List|填写本端vRouter的业务地址，用于与对端vRouter互通。
Remote vRouter Name|对端vRouter名称，与本端vRouter互通。
Remote CIDR LIst|填写对端vRouter的业务地址，用于与本端vRouter互通。
Local FW|保持默认值。
Remote FW|保持默认值。
FW Mode|保持默认值。
VPC Name|由本端vRouter与对端vRouter中间加上“-2-”组成，即命名形式为“本端vRouter Name-2-对端vRouter Name“。
#### 导出LLD 
摘要 :本节介绍导出LLD的操作过程。 
步骤 :VNF LLD Template PCF.xlsm中的所有的页签配置完成后，切换到Run页签，如[图1]所示。
图1  Run页签

单击生成VNF规则数据，弹出提示框，如[图2]所示。
图2  提示框

单击是，开始自动生成VNF规则数据，等待结束后，回到ZXUN AIC(iDevise)(WPS版).xlsm页面，如[图3]所示。
图3  ZXUN AIC(iDevise)(WPS版).xlsm页面

单击右上方的Next，出现Output LLD页签，如[图4]所示。
图4  Output LLD页签

单击下方的Output按钮，在ZXUN AIC(iDevise)(WPS版).xlsm文件同级目录下会生成最终的LLD，名字为ZTE NFV LLD(PCF) XXXX.xlsx（XXXX为首页输入的Project Name)。本文档示例为ZTE NFV LLD(PCF) New Project.xlsx。
### VNF部署 
VNF指虚拟化后的核心网网元（如PCF），执行3GPP定义的网元功能。
本文档介绍通过AIC工具部署PCF的过程。 
#### 前置条件 
##### VNF部署准备 
序号|准备工作|说明
---|---|---
1|打通客户端与TECS的TECS_Client平面的路由|客户端配置到TECS_Client网段的路由，网关交换机配置TECS_Client平面的网关。正常情况下在部署VNF时网关交换机上已经配置了TECS_Client平面的网关，一般仅检查即可，以保证VNF部署过程中可以访问TECS的TECS_Client地址。
2|检查客户端可以正常访问NFVO及VNFM|客户端可以正常访问NFVO及VNFM的网管页面，可以正常SSH登录。
3|网关交换机配置VNF OAM平面的网关|网关交换机配置VNF OAM平面的网关，用于保证部署过程中VNF的OAM地址与VNFM的EMS地址正常通讯。如果VNF OAM平面复用VNFM的EMS平面，则不需要额外配置。
##### LLD文件准备 
已经准备好iDevise输出的最终LLD文件，LLD文件名为ZTE NFV LLD xxxx.xlsx（其中xxxx为iDevise输入的Project Name），例如ZTE NFV LLD HDBNJ.xlsx。
#### 部署VNF 
摘要 :本节介绍通过iDeploy工具部署ZXUN RCP的过程，iDeploy工具自动完成ZXUN RCP所需虚拟资源的创建和业务程序的自动部署。
 说明： 
运行iDeploy工具的PC机，需去除PC机休眠设置。 
PC机的8002端口不能被占用。 
因Windows系统对文件路径存在最大200字节的限制，iDeploy工具所在路径不宜过长（建议将iDeploy工具放在根目录下），否则iDeploy无法正常运行。 
步骤 :导入LLD文件和版本包
打开AIC工具的iDeploy目录，选择iDeploy应用程序，如[图1]所示。
图1  iDeploy应用程序

双击iDeploy图标，在打开的iDeploy部署页面中选择部署平台，如[图2]所示。
图2  iDeploy部署平台

首次打开iDeploy时，由于没有导入LLD，会出现如[图3]所示界面。
图3  iDeploy界面

单击点击这里导入LLD文件按钮，在弹出的对话框中选择LLD文件，文件格式为.xlsx。iDeploy工具支持一次导入多个LLD，也支持多次导入多个LLD。
LLD文件导入成功后，会显示LLD文件所属领域、文件名称、导入时间等信息，如[图4]所示。
图4  导入LLD文件成功

选择左侧目录树的DC概览
→DC概览
，右侧出现DC概览页面。在该页面会显示LLD中设计的相关组件的概览信息，此处无需操作，仅用于浏览概要信息。
选择左侧目录树的版本导入→文件列表
，右侧出现版本导入页面。检查列表中的文件名称是否和准备导入的文件名相同。此时页面状态栏中的红叉（）表示版本文件缺失，需要导入，如[图5]示。
 说明： 
操作员手工导入的各个版本文件名称和后缀，都需要和版本导入页面中的文件名称相同，否则iDeploy工具会识别不到文件。
图5  版本导入

根据不同情况，选择执行以下操作导入版本文件。 
如果...|那么...
---|---
批量导入版本文件|选中一个领域：PCF下的所有版本文件对应的选项框，单击（批量导入）图标。在弹出的对话框中选择版本文件目录，工具会自动扫描所选目录下的所有文件自动匹配导入。导入成功后，对应文件的状态会变成绿勾状（），如图6所示。如有部分文件缺失，工具会在上方给出红色栏提示，同时对应文件状态栏依然是红叉状态（），此时检查所选的导入目录中版本文件是否缺失，或者名称及后缀是否与LLD中填写的一致。
单个导入版本文件|选择需要导入的文件，单击选择导入的按钮，如图7所示。在弹出的对话框中选择对应的版本文件。
图6  批量导入版本文件
图7  单个导入版本文件
所有版本文件导入成功后，结果如[图8]所示。
图8  所有版本文件导入成功页面

配置iDeploy工具
 说明： 
由于LLD配置文件的MANO Info页签中将NFVO/VNFM & VIM Authentication Type参数设置为Two-way Authentication，即启用了双向认证功能，因此iDeploy工具也需要打开双向认证开关。
单击页面左下角的领域设置，如[图9]所示。
图9  iDeploy部署工具

在领域设置页面中开启VIM双向认证，并填写VIM控制节点虚机的用户名和密码，如[图10]所示。
图10  领域设置

单击[图9]中页面右上角的设置，在通用设置页面打开允许网元回滚操作开关，如[图11]所示。
图11  设置回滚

部署VNF
返回部署页面，勾选需要部署的对象，单击图标，iDeploy工具开始自动部署ZXUN RCP，正常情况下部署过程无需人工干预，如[图12]所示。
 说明： 
如果不启用流镜像功能和VPC功能，则不需要勾选PCF配置TAAS部署和PCF配置VPC部署两个选项。
图12  开始自动部署
 说明： 
请耐心等待大约40分钟，自动部署完成。部署过程中可能会因为外部环境因素导致部署过程异常，工具提供了停止、重试、继续等按钮供手工干预。 
### 去激活服务（可选） 
摘要 :服务去激活（删除）是服务预埋反向过程。当不需要某个服务时，删除该服务可以节省资源。 
相关信息 :对于部分运营商场景，需要在完成VNF部署后进行去激活服务操作，相关信息参见[表1]。
适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活/去激活预埋服务
---|---|---|---|---|---|---
中国电信非UDSF局|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务。去激活Ncudr_SystemManagement服务。回收CDU虚机。激活Ncudr_AccessManagement服务。激活Ncudr_Access服务。
非UDSF局是指没有部署Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
 说明： 
如果Ncudr_Access服务已激活，则需要先去激活Ncudr_Access服务和Nudsf_UnstructuredDataManagement服务，再去激活Ncudr_SystemManagement服务。 
如果Ncudr_Access服务未激活，则需要先去激活Nudsf_UnstructuredDataManagement服务，再去激活Ncudr_SystemManagement服务。 
本节介绍去激活Nudsf_UnstructuredDataManagement服务和Ncudr_SystemManagement服务的操作，激活Ncudr_AccessManagement服务和Ncudr_Access服务参见[激活预埋服务（可选）]。
步骤 :打开自动扩缩容开关
打开浏览器，在地址栏输入NFVO客户端地址https://IP地址:28808/nfvo-mano-portal，在登录页面中输入用户名和密码，登录NFVO客户端，如[图1]所示。
图1  登录NFVO客户端

选择编排→VNF
，打开VNF页面，如[图2]所示。
图2  VNF页面

在VNF页面中选择更多→自动扩缩容开关
，打开自动扩缩容开关页面，如[图3]所示。
图3  自动扩缩容界面

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择开启。单击提交按钮，打开自动扩容开关，如[图4]所示。
图4  打开自动扩容开关

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择开启，打开自动缩容开关，如[图5]所示。
图5  打开自动缩容开关

去激活Nudsf_UnstructuredDataManagement_0和Ncudr_SystemManagement_0服务
打开浏览器，在地址栏输入https://IP地址:28808/em-portal，输入用户名和密码，登录EM客户端，如[图6]所示。
图6  登录EM客户端

在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
去激活Nudsf_UnstructuredDataManagement_0和Ncudr_SystemManagement_0服务。 
 说明： 
必须先去激活Nudsf_UnstructuredDataManagement_0服务，再去激活Ncudr_SystemManagement_0服务。 
执行[DEACTIVATE NFS]:NFSNAME="Nudsf_UnstructuredDataManagement_0"命令，去激活Nudsf_UnstructuredDataManagement_0服务。
执行[DEACTIVATE NFS]:NFSNAME="Ncudr_SystemManagement_0"命令，去激活Ncudr_SystemManagement_0服务。
 说明： 
去激活服务后需要等待1-3分钟，MANO才会建立起自动扩缩容的任务。 
检查自动扩缩容任务
登录NFVO客户端，单击页面右上角的图标，在显示的任务页面中查看自动扩缩容任务状态为已完成，如[图7]所示。
图7  检查自动扩缩容任务

检查去激活服务状态
去激活服务后执行命令检查，确保服务被成功去激活。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|两个服务的部署状态为False，如图8所示。
实例类型|SHOW SCTYPE:NFSNAME="Ncudr_SystemManagement_0"SHOW SCTYPE:NFSNAME="Nudsf_UnstructuredDataManagement_0"|检查服务对应的当前SC已被删除，如图9所示。
容器|SHOW VRU:NFSNAME="Ncudr_SystemManagement_0"SHOW VRU:NFSNAME="Nudsf_UnstructuredDataManagement_0"|检查服务对应的容器已被删除，查询结果为空，如图10所示。
图8  检查服务

图9  检查实例类型

图10  检查容器

回收所有的CDU虚机。 
执行[SHOW VM]命令，查询CDU虚机的虚机内部名称，如[图11]所示。
图11  查询CDU虚机

执行[RECYCLE VM]命令，回收所有CDU虚机。
VMNAME参数填写步骤[a]中查询到的CDU虚机内部名称。
关闭自动扩缩容开关
在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择关闭，关闭自动扩容开关，如[图12]所示。
图12  关闭自动扩容开关

在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择关闭，关闭自动缩容开关，如[图13]所示。
图13  关闭自动缩容开关

### 激活预埋服务（可选） 
摘要 :ZXUN RCP网元提供了Ncudr_Access、Npcf_LOG和Npcf_LogStoreUnit可选服务。这些服务在不同场景可能不部署、也可能部署其中的一种或多种。并且还存在某个服务原本不部署，后期由于需求变化又要求部署的情况。
因此ZXUN RCP启用了“服务预埋”功能，即预埋以上服务，默认不实例化。在需要时再激活该预埋的服务，根据需要进行实例化部署。
相关信息 :对于部分运营商场景，需要在完成VNF部署后进行激活预埋服务操作，相关信息参见[表1]。
适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活预埋服务
---|---|---|---|---|---|---
中国移动数据局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务，默认弹出2个LOG虚机。激活Npcf_LogStoreUnit服务，默认弹出3个LSU虚机。
中国移动物联网局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务，默认弹出2个LOG虚机。激活Npcf_LogStoreUnit服务，默认弹出3个LSU虚机。
中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF|有|有|无|无|激活Ncudr_Access服务，默认弹出2个带有CGW标签的GSU虚机。
中国电信非UDSF局|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务。去激活Ncudr_SystemManagement服务。回收CDU虚机。激活Ncudr_AccessManagement服务。激活Ncudr_Access服务，默认弹出2个带有CGW标签的GSU虚机。
中国移动语音局国际通用局部分测试局|无报表功能无热备容灾|有|无|无|无|无。
部分国际局部分测试局|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务，默认弹出2个LOG虚机。
UDSF局是指部署了Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
非UDSF局是指没有部署Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
本节介绍激活各个服务的操作，去激活Ncudr_AccessManagement服务、去激活Ncudr_Access服务和回收CDU虚机的操作参见[去激活服务（可选）]。
步骤 :检查ZXUN RCP和MANO版本
检查ZXUN RCP版本，需要等于或高于V7.21.20.B3版本，以支持服务预埋功能。
检查使用的MANO版本，如果是V5.21.11.P4.B2，则需要进一步确认是否执行过补丁V5.21.11.P4.B2SP01，检查方法如下：
使用SSH方式登录VNFM主节点，执行docker stats sm命令，查询SM容器内存LIMIT值。
如果…|那么…
---|---
LIMIT值是550 MiB|表示未扩过内存，未执行补丁技术通知单，需要联系中兴通讯技术支持执行补丁技术通知单。
LIMIT值大于550 MiB|表示已扩过内存。
检查完成后，执行ctrl c停止命令。
（可选）检查VNF应用配额
 说明： 
若运营商资源池启用了VNF三级租户，则需要检查VNF应用配额是否满足服务激活的需求。 
打开浏览器，在地址栏输入NFVO客户端地址https://IP地址:28808/nfvo-mano-portal，在登录页面中输入用户名和密码，登录NFVO客户端，如[图1]所示。
图1  登录NFVO客户端

选择系统→NFVO→配置管理→租户
，默认显示一级租户页面。
切换至应用配额页面，查看VNF的应用配额，如[图2]所示。
图2  查看VNF配额

打开自动扩缩容开关
在NFVO客户端页面选择编排→VNF
，打开VNF页面，如[图3]所示。
图3  VNF页面

在VNF页面中选择更多→自动扩缩容开关
，打开自动扩缩容开关页面，如[图4]所示。
图4  自动扩缩容界面

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择开启。单击提交按钮，打开自动扩容开关，如[图5]所示。
图5  打开自动扩容开关

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择开启，打开自动缩容开关，如[图6]所示。
图6  打开自动缩容开关

激活预埋服务Ncudr_AccessManagement
打开浏览器，在地址栏输入https://IP地址:28808/em-portal，输入用户名和密码，登录EM客户端，如[图7]所示。
图7  登录EM客户端

在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW NFS]命令，查询部署状态为False的Ncudr_AccessManagement服务的实例名称，如[图8]所示。
图8  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Ncudr_AccessManagement_0"命令（以步骤[12]中查询到的Ncudr_AccessManagement_0实例名称为例），激活预埋服务Ncudr_AccessManagement。
激活预埋服务Ncudr_Access
执行[SHOW NFS]命令，查询部署状态为False的Ncudr_Access服务的实例名称，如[图9]所示。
图9  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Ncudr_Access_0"命令（以步骤[13]中查询到的Ncudr_Access_0实例名称为例），激活预埋服务Ncudr_Access。
激活预埋服务Npcf_LOG
执行[SHOW NFS]命令，查询部署状态为False的Npcf_LOG服务的实例名称，如[图10]所示。
图10  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Npcf_LOG_0"命令（以步骤[11]中查询到的Npcf_LOG_0实例名称为例），激活预埋服务Npcf_LOG。
激活预埋服务Npcf_LogStoreUnit
执行[SHOW NFS]命令，查询部署状态为False的Npcf_LogStoreUnit服务的实例名称，如[图11]所示。
图11  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Npcf_LogStoreUnit_0"命令（以步骤[13]中查询到的Npcf_LogStoreUnit_0实例名称为例），激活预埋服务Npcf_LogStoreUnit。
 说明： 
激活预埋服务后需要等待1-3分钟，MANO才会建立起自动扩缩容的任务。 
检查自动扩缩容任务
登录NFVO客户端，单击页面右上角的图标，在显示的任务页面中查看自动扩缩容任务状态为已完成，如[图12]所示。
图12  检查自动扩缩容任务

检查Ncudr_AccessManagement服务和Ncudr_Access服务激活状态
执行命令检查Ncudr_Access服务相关信息，确保Ncudr_Access服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Ncudr_Access服务的部署状态为TRUE。
虚机|SHOW VM|Ncudr_Access服务激活后弹出2个带CGW标签的GSU虚机，如图13所示。
实例类型|SHOW SCTYPE:NFSNAME="Ncudr_Access_0"SHOW SCTYPE:NFSNAME="Ncudr_AccessManagement_0"|检查Ncudr_Access服务对应的SC类型和SC当前实例数，如图14所示。SC类型sc-cudr-access-cgw对应的当前实例数是2（与弹出GSU虚机个数一致）。SC类型sc-tmsp-nff对应的当前实例数是2（与弹出GSU虚机个数一致）。SC类型sc-cudr-access-mp对应的当前实例数是2（1+1主备OMU虚机）。检查Ncudr_AccessManagement服务对应的SC类型和SC当前实例数。SC类型sc-cudr-accessmgt-mp对应的当前实例数是2，如图15所示。
容器|SHOW VRU:NFSNAME="Ncudr_Access_0"SHOW VRU:NFSNAME="Ncudr_AccessManagement_0"|检查Ncudr_Access服务对应的SC类型包含2个sc-cudr-access-cgw、2个sc-tmsp-nff和2个sc-cudr-access-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图16所示。检查Ncudr_AccessManagement服务对应的SC类型包含2个sc-cudr-accessmgt-mp。SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图17所示。
图13  检查虚机

图14  检查Ncudr_Access服务的实例类型

图15  检查Ncudr_AccessManagement服务的实例类型

图16  检查Ncudr_Access服务的容器

图17  检查Ncudr_AccessManagement服务的容器

检查Npcf_LOG服务激活状态
执行命令检查Npcf_LOG服务相关信息，确保Npcf_LOG服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Npcf_LOG服务的部署状态为TRUE。
虚机|SHOW VM|Npcf_LOG服务激活后弹出2个LOG虚机，如图18所示。
实例类型|SHOW SCTYPE:NFSNAME="Npcf_LOG_0"|检查Npcf_LOG服务对应的当前SC类型和SC当前实例数，如图19所示。SC类型sc-pcf-log对应的当前实例数是2（与弹出LOG虚机个数一致）。SC类型sc-pcf-log-mp对应的当前实例数是2（1+1主备OMU虚机）。
容器|SHOW VRU:NFSNAME="Npcf_LOG_0"|检查Npcf_LOG服务对应的SC类型包含2个sc-pcf-log和2个sc-pcf-log-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图20所示。
图18  检查虚机

图19  检查实例类型

图20  检查容器

检查Npcf_LogStoreUnit服务激活状态
执行命令检查Npcf_LogStoreUnit服务相关信息，确保Npcf_LogStoreUnit服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Npcf_LogStoreUnit服务的部署状态为TRUE。
虚机|SHOW VM|Npcf_LogStoreUnit服务激活后弹出3个LSU虚机，如图21所示。
实例类型|SHOW SCTYPE:NFSNAME="Npcf_LogStoreUnit_0"|检查Npcf_LogStoreUnit服务对应的当前SC类型和SC当前实例数，如图22所示。SC类型sc-pcf-lsu对应的当前实例数是3（与弹出LSU虚机个数一致）。SC类型sc-pcf-lsu-mp对应的当前实例数是2（1+1主备OMU虚机）。
容器|SHOW VRU:NFSNAME="Npcf_LogStoreUnit_0"|检查Npcf_LogStoreUnit服务对应的SC类型包含3个sc-pcf-lsu和2个sc-pcf-lsu-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图23所示。
图21  检查虚机

图22  检查实例类型

图23  检查容器

关闭自动扩缩容开关
在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择关闭，关闭自动扩容开关，如[图24]所示。
图24  关闭自动扩容开关

在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择关闭，关闭自动缩容开关，如[图25]所示。
图25  关闭自动缩容开关

### 配置虚机弹扩 
摘要 :在ZXUN RCP实例化成功后，各个虚机都是最少个数，商用场景需要的虚机个数一般都比实例化时的个数多，操作员需要根据商务合同，将各个虚机的数量，弹扩到要求的数量。
本节介绍弹扩ZXUN RCP虚机的操作。
相关信息 :弹性是通过弹扩（增加资源）或弹缩（减少资源）来协调系统的资源占用与系统性能间的平衡，弹性功能包括弹扩和弹缩。 
弹扩（Scale Out）即申请所占用的虚拟资源。 
弹缩（Scale In）即释放所占用的虚拟资源。 
一个NF由多个类型的虚机组成，一种类型的虚机包含多个NFS，NFS是一种可独立开发、测试、部署的单元，每个NFS包含多个SC。
每个虚机可运行不同的SC数量，根据HLD中虚机数量计算需要增加的SC数量，将每种SC类型的虚机扩容到HLD配置数量，满足商用容量要求。
以商用大规格场景为例，ZXUN RCP涉及到弹性伸缩的虚机类型参见[表1]。
虚机类型|规格|SC类型名称|单虚机SC数量（最小弹性步长）|建议每次扩容最大SC个数
---|---|---|---|---
CDU|C-C4M32|sc-cudr-cdn-l-001/sc-cudr-cdn-l|3|15
sc-cudr-cdn-r-001/sc-cudr-cdn-r|CDU|C-C4M32|3|15
GSU (Policy Control)|Common-C8M32|sc-pcf-pcm|1|5
GSU (HTTP LB)|Common-C8|sc-http-lb|1|5
GSU (SIG LB)|Common-C8|sc-sig|1|5
sc-pcf-siglb|GSU (SIG LB)|Common-C8|1|5
GSU (CGW)|Common-C8|sc-cudr-access-cgw|1|4
sc-tmsp-nff|GSU (CGW)|Common-C8|1|4
IPU|C8|sc-ips|1|5
LOG|Common-C8M24|sc-pcf-log|1|5
LSU|C12|sc-pcf-lsu|1|5
合入UDSF插件实例化后的CDU虚机的SC类型为sc-cudr-cdn-l-001和sc-cudr-cdn-r-001。
未合入UDSF插件实例化后的CDU虚机的SC类型为sc-cudr-cdn-l和sc-cudr-cdn-r。
 说明： 
首次扩容的SC数量固定设置为最小弹性步长，等单个虚机扩容成功后，后续扩容可以将SC数量设置为需要扩容的数量，最大不能超过建议每次扩容最大SC个数。
步骤 :打开自动扩缩容开关
登录NFVO客户端，选择菜单编排→应用→VNF
，在界面右侧默认显示VNF页面，如[图1]所示。
图1  VNF页面

选择更多→自动扩缩容开关
，进入自动扩缩容开关设置页面，如[图2]所示。
图2  自动扩缩容开关

在自动扩缩容开关页面中，粒度选择VNF，查看网元的自动缩容开关状态和自动扩容开关状态。
如果…|那么…
---|---
自动缩容开关状态和自动扩容开关状态为关|转至步骤4
自动缩容开关状态和自动扩容开关状态为开|转至步骤5
将操作类型分别设置为缩容和扩容，开关设置为开启。设置完成后，单击提交按钮，如[图3]所示。
图3  打开自动扩缩容开关

配置自愈功能总开关、弹性模式和检查开关
在EM客户端，切换到配置页面，在配置页面的左侧命令树中，展开需要进行手工弹性操作的PCF节点。
在命令输入框中执行[SHOW AUTOHEALINGGLB]命令，查询自愈功能总开关状态。
如果…|那么…
---|---
自愈功能总开关状态为启用|转至步骤7
自愈功能总开关状态为禁用|转至步骤8
在命令输入框中执行[SET AUTOHEALINGGLB]:HEALINGSWITCH="DISABLE"命令，禁用自愈功能总开关。
在命令输入框中执行[SHOW SCALEGLBBASECFG]命令，查询弹性模式。
如果…|那么…
---|---
弹性模式为手动|转至步骤9
弹性模式为自动|通常弹性模式需要设为手工，请联系中兴通讯技术支持。
在命令输入框中执行[SHOW CONSISTENCECHECK]命令，查询检查开关状态。
如果…|那么…
---|---
检查开关状态为启用|转至步骤10
检查开关状态为禁用|转至步骤11
在命令输入框中执行[SET CONSISTENCECHECK]:CHECKSWITCH="DISABLE"命令，禁用检查开关。
CDU虚机扩容SC
 说明： 
CDU虚机扩容SC时需要分别对sc-cudr-cdn-l-001/sc-cudr-cdn-l和sc-cudr-cdn-r-001/sc-cudr-cdn-r进行弹扩操作，才会创建新的CDU虚机。两种SC类型的需要扩容的虚机数量分别为CDU需要扩容总虚机数的一半。例如现场需要扩容4个CDU，即扩容6个sc-cudr-cdn-l-001/sc-cudr-cdn-l和6个sc-cudr-cdn-r-001/sc-cudr-cdn-r。 
首次扩容SC_NUM步长固定设置为3，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过15。 
在命令输入框中执行如下命令，查询当前CDU虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Nudsf_UnstructuredDataManagement_0"
SC类型的名称以实际查询结果为准，sc-cudr-cdn-l-001和sc-cudr-cdn-r-001，或者sc-cudr-cdn-l和sc-cudr-cdn-r。 
例如现场需要扩容2个CDU，由于CDU虚机的最小弹性步长为3，需扩容3个sc-cudr-cdn-l-001和3个sc-cudr-cdn-r-001。 
在命令输入框中执行如下命令，对sc-cudr-cdn-l-001进行弹扩操作。 
[INC SC]:NFSNAME="Nudsf_UnstructuredDataManagement_0",SCTYPE="sc-cudr-cdn-l-001",SC_NUM=3
执行同样的操作，在命令输入框中执行如下命令，对sc-cudr-cdn-r-001进行弹扩操作。 
[INC SC]:NFSNAME="Nudsf_UnstructuredDataManagement_0",SC_TYPE="sc-cudr-cdn-r-001",SC_NUM=3
GSU (Policy Control)虚机扩容SC
 说明： 
GSU (Policy Control)虚机扩容将会导致用户在业务虚机上重新分布。 
冷备场景：性能统计过程中可能会出现会话数骤降，后逐步恢复的现象。 
热备场景：性能统计过程中可能会出现会话数骤降，等待30分钟后逐步恢复的现象。 
恢复时间受1102全局参数配置值影响，恢复完毕后对业务无影响。 
在命令输入框中执行如下命令，查询当前GSU (Policy Control)虚机的SC类型名称和SC个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_SMPolicyControl_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Npcf_SMPolicyControl_0",SCTYPE="sc-pcf-pcm",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-pcf-pcm的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
GSU (HTTP LB)虚机扩容SC
在命令输入框中执行如下命令，查询当前GSU (HTTP LB)虚机的SC类型名称和SC个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_HTTP_LB_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_HTTP_LB_0",SCTYPE="sc-http-lb",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-http-lb的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
GSU (SIG LB)虚机扩容SC
 说明： 
扩容GSU (SIG LB)虚机需要扩容sc-sig和sc-pcf-siglb两种类型SC。先扩容sc-pcf-siglb类型SC，再扩容sc-sig类型SC。
sc-pcf-siglb类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
sc-sig类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
在命令输入框中执行如下命令，查询当前GSU (SIG LB)虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_SIGLB_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Npcf_SIGLB_0",SCTYPE="sc-pcf-siglb",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-pcf-siglb的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
在命令输入框中执行如下命令，查询当前GSU（SIG LB）虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_SIG_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_SIG_0",SCTYPE="sc-sig",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-sig的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
GSU (CGW)虚机扩容SC
激活Ncudr_Access服务，默认弹出2个sc-cudr-access-cgw、2个sc-tmsp-nff和2个sc-cudr-access-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容GSU (CGW)虚机仅需扩容sc-cudr-access-cgw和sc-tmsp-nf两种类型SC，2个sc-cudr-access-mp用于1+1主备OMU虚机。sc-tmsp-nff类型的SC个数要与sc-cudr-access-cgw类型的SC个数一致。
sc-cudr-access-cgw类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过4。 
sc-tmsp-nf类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过4。 
扩容顺序：先扩容sc-cudr-access-cgw类型SC，再扩容sc-tmsp-nff类型SC。 
在命令输入框中执行如下命令，查询当前GSU (CGW)虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Ncudr_Access_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Ncudr_Access_0",SCTYPE="sc-cudr-access-cgw",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-cudr-access-cgw的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Ncudr_Access_0",SCTYPE="sc-tmsp-nff",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-tmsp-nff的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
IPU虚机扩容SC
在命令输入框中执行如下命令，查询当前IPU虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_IPS_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_IPS_0",SCTYPE="sc-ips",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-ips的弹扩最小步长为1，即增加1个SC就增加一个IPU，如果要弹扩2个IPU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
LOG虚机扩容SC
激活Npcf_LOG_0服务，默认弹出2个sc-pcf-log和2个sc-pcf-log-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容LOG虚机仅需扩容sc-pcf-log，2个sc-pcf-log-mp用于1+1主备OMU虚机。
在命令输入框中执行如下命令，查询当前LOG虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_LOG_0"
在命令输入框中执行如下命令，对sc-pcf-log进行弹扩操作。 
[INC SC]:NFSNAME="Npcf_LOG_0",SCTYPE="sc-pcf-log",SCNUM=1
本示例中需要新增的LOG虚机个数为1。sc-pcf-log的弹扩最小步长为1，即增加1个SC就增加一个LOG，如果要弹扩2个LOG，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
LSU虚机扩容SC
激活Npcf_LogStoreUnit_0服务，默认弹出2个sc-pcf-lsu和2个sc-pcf-lsu-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容LOG虚机仅需扩容sc-pcf-lsu，2个sc-pcf-lsu-mp用于1+1主备OMU虚机。
在命令输入框中执行如下命令，查询当前LSG虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_LogStoreUnit_0"
在命令输入框中执行如下命令，对sc-pcf-lsu进行弹扩操作。 
[INC SC]:NFSNAME="Npcf_LogStoreUnit_0",SCTYPE="sc-pcf-lsu",SCNUM=1
本示例中需要新增的LSU虚机个数为1。sc-pcf-lsu的弹扩最小步长为1，即增加1个SC就增加一个LSU，如果要弹扩2个LSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
（可选）恢复自愈功能总开关和检查开关
如果步骤[6]中查询到的自愈功能总开关状态为启用，那么需要在命令输入框中执行如下命令，恢复自愈功能总开关。
[SET AUTOHEALINGGLB]:HEALINGSWITCH="ENABLE"
如果步骤[9]中查询到的检查开关状态为启用，那么需要在命令输入框中执行如下命令，恢复检查开关。
[SET CONSISTENCECHECK]:CHECKSWITCH="ENABLE"
（可选）恢复自动扩缩容开关
如果步骤[3]中查询到的自动缩容开关状态和自动扩容开关状态为关，那么需要参考步骤[4]，将操作类型分别设置为缩容和扩容，开关设置为关闭，关闭自动扩缩容开关。
### 安装后检查 
#### 检查虚机 
摘要 :ZXUN RCP实例化完成后，需要检查虚机是否为运行状态。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VM]命令，检查虚机信息，如[图1]所示。
图1  查询虚机信息

检查标准 :检查虚机内部名称前缀部分是否符合规范，虚机内部名称中的前缀如果不符合运营商规范，请根据规划修改，重新实例化虚机。 
检查虚机规格及数量是否和HLD一致。 
检查虚机运行状态是否正常，所有虚机运行状态需为running。 
#### 检查SC状态 
摘要 :ZXUN RCP实例化完成后，需要检查虚机SC状态。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VRU]命令，检查SC运行状态，如[图1]所示。
图1  查询SC运行状态

检查标准 :所有SC运行状态为running。
#### 检查网元名称 
摘要 :ZXUN RCP实例化完成后，需要检查网元是否符合运营商网元名称规范。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VNF]命令，检查网元名称，如[图1]所示。
图1  查询网元名称

检查标准 :VNF部署实例名称符合运营商网元名称规范要求。
### 参考 
#### 在VNFM上创建用户 
摘要 :ZXUN RCP支持HTTPS认证功能，VNF需要向VNFM获取token。由于安全原因，禁止使用admin用户，需要新建用户。本节介绍在VNFM上创建用户的操作过程。
步骤 :在VNFM上新建账户规则
在VNFM客户端，选择菜单系统→安全→账户规则
，进入账户规则页面，如[图1]所示。
图1  账户规则页面

单击新建账户规则，进入新建账户规则页面。
在规则名称与密码策略区域，设置规则名称与密码相关策略，如[图2]所示。
图2  新建账户规则

参数名|参数说明
---|---
规则名称|根据规划填写账户规则名称。在创建用户时将会引用本规则名称。
首次登录|不勾选该选项。
密码最大有效期|设置为0。
在账号策略区域，设置账号允许登录的方式和有效期等参数，如[图3]所示。
图3  账号策略

参数名|参数说明
---|---
账号登录方式|选中Web和API。
单击新建按钮，完成账户规则的创建。
在VNFM上新建用户
在VNFM客户端，选择菜单系统→安全→用户管理
，进入用户管理页面，如[图4]所示。
图4  用户管理页面

单击新建用户，进入基本信息页面，如[图5]所示。
图5  基本信息页面

基本信息页面的参数说明参见[表3]。
参数名|参数说明
---|---
用户名|根据规划填写用户的用户名，即该用户的登录名称。用户名不区分大小写，不允许重复，最长30个字符。
密码|用户登录时输入的口令。在用户账户规则中，可以定制密码的长度范围。
确认密码|再次输入密码，必须和用户密码一致。
账户规则|在下拉菜单中选择在“在VNFM上新建账户规则”中创建的账户规则。
同时登录数限制|选中不限制。各选项含义如下：全局：同一个用户名只允许1个人同时登录。不限制：同一个用户名允许多人同时登录。自定义：自定义同一个用户名的同时登录人数。
单击下一步，进入权限分配页面，选中所有角色，如[图6]。
图6  权限分配

单击新建按钮，完成用户的创建。
#### 修改镜像文件名称 
摘要 :本节介绍根据运营商的规范要求，使用工具修改镜像文件名称。 
前提 :获取修改镜像名称的脚本文件（与版本包中镜像文件处于同级目录）：change-pcf-image.sh。
相关信息 :镜像包名称由三部分组成： 
第一部分根据运营商的要求填写，例如：NFV-R-HDNJIH-01A-ZTE-01-MIR。 
第二部分对应部署的局号，例如：PCF52。 
第三部分对应部署的版本号，例如：V7.19.12。 
三个部分之间以下划线连接：NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12。
本节以将镜像包名称修改为NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12为例。
步骤 :在TECS节点CGSL操作系统的/home/tecs路径下新建一个目录，如pcfimage目录。
将change-pcf-image.sh脚本文件和镜像包（以cgsl_F16P4_200408.zip为例）拷贝到TECS CGSL系统的pcfimage目录下。
使用SSH方式登录TECS节点的CGSL操作系统，进入/home/tecs/pcfimage目录。
执行ll命令，显示当前目录下文件的详细信息，如下所示。
`[tecs@host-2000--1-1-1-246 pcfimage]$ ll
total 400740
-rw-------. 1 tecs tecs 410353325 May  4 09:19 cgsl_F16P4_200408.zip
-rwx--x--x. 1 tecs tecs       923 May  4 09:17 change-pcf-image.sh
[tecs@host-2000--1-1-1-246 pcfimage]$` 
执行./change-pcf-image.sh命令，修改镜像包文件名为NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12，如下所示。
 说明： 
执行./change-pcf-image.sh命令之前需确认当前目录不能有其他zip文件。
`[tecs@host-2000--1-1-1-246 pcfimage]$ cd /home/tecs/pcfimage/
[tecs@host-2000--1-1-1-246 pcfimage]$ chmod +x change-pcf-image.sh
[tecs@host-2000--1-1-1-246 pcfimage]$ ./change-pcf-image.sh NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12
./change-pcf-image.sh: line 1: /bin/bash: No such file or directory
Archive:  cgsl_F16P4_200408.zip
  inflating: image_tmp/resourceList.json
   creating: image_tmp/SoftwareImages/
  inflating: image_tmp/SoftwareImages/CGS-Linux-CORE.V5.04.F16P4_20200408-x86_64.img
  inflating: image_tmp/resource.meta
  inflating: image_tmp/checksum.lst
NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12
  adding: checksum.lst (deflated 15%)
  adding: resourceList.json (deflated 40%)
  adding: resource.meta (deflated 3%)
  adding: SoftwareImages/ (stored 0%)
  adding: SoftwareImages/NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12.img (deflated 2%)
Making the image file is successfully !!` 
执行ll命令，确认修改名称后的镜像包是否在pcfimage目录下，如下所示。
`[tecs@host-2000--1-1-1-246 pcfimage]$ ll
total 801480
-rw-------. 1 tecs tecs 410353325 May  4 09:19 cgsl_F16P4_200408.zip
-rwx--x--x. 1 tecs tecs       975 May  4 09:34 change-pcf-image.sh
drwxr-xr-x. 3 tecs tecs      4096 May  4 09:35 image_tmp
-rw-r--r--. 1 tecs tecs 410353392 May  4 09:36 NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12.zip` 
（可选）取出镜像压缩包后，如果没有别的需要，可以在TECS CGSL系统上删除pcfimage目录。
#### iDeploy相关操作 
##### 删除自动部署的网元 
摘要 :如果需要删除自动化部署的网元（已成功部署的网元、部署失败还尚未清除残留资源的网元），可参考本节的操作。 
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中打开是否显示网元清除按钮开关，如[图1]所示。
图1  显示清除按钮标志

网元部署旁会显示清除按钮标志，如[图2]所示。
图2  删除已部署的组件

单击清除按钮，在弹出的对话框中单击是，如[图3]所示，一键自动删除已部署的组件。
图3  网元初始化

##### 日志使用 

##### 日志使用 



部署过程支持实时日志上报，且可根据日志级别过滤日志，根据关键字查找日志，单击用例直接跳转到该用例对应的日志，支持日志的一键采集。 


日志级别由高到低为：ERROR、WARN、INFO、DEBUG、TRACE，默认为INFO。



###### 设置日志级别 
摘要 :本节介绍在iDeploy工具设置日志级别的操作。 
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中设置最低日志级别，如[图1]所示。
图1  设置最低日志级别

用户可在部署页面选择实时显示的最低日志级别，如[图2]所示。
图2  查看最低级别日志



###### 快速定位日志 




摘要 :本节介绍在iDeploy工具快速定位日志的操作。 


######## 日志快速定位 


日志窗口仅显示当前用户选择的用例对应的日志，这样更方便帮助用户快速定位到所需的日志，如[图3]所示。
图3  当前日志






（可选）在部署页面，单击全部日志按钮，如[图4]所示。日志窗口显示当前所有日志。
图4  全部日志










###### 清除日志 
摘要 :本节介绍在iDeploy工具清除日志的操作。 
步骤 :手工清除日志在部署页面，单击清除按钮，清除当前页面已产生的日志信息，如图5所示。图5  部署实施 
设置日志自动清除单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中设置自动清除日志消息。开启点击开始按钮时清除日志信息后，每次iDeploy工具重新执行时，就会自动清除之前已产生的日志，如图6所示。图6  设置自动清除日志消息 
###### 一键采集日志 
摘要 :本节介绍在iDeploy工具一键采集日志的操作。 
步骤 :在部署页面，单击（报告采集）按钮一键自动采集日志，如[图7]所示。
图7  部署实施

采集完成后，弹出日志采集完成对话框提示单击下载按钮将日志下载保存，如[图8]所示。
图8  日志采集完成

##### 报告查看 

##### 报告查看 



iDeploy支持当前部署报告和历史报告的查看。 





###### 查看当前部署报告 




摘要 :本节介绍在iDeploy工具查看当前部署报告的操作。 


步骤 :

部署完成后会在部署页面的日志下方生成当前部署报告链接，单击iDeploy Report链接查看当前部署报告，如[图1]所示。
图1  查看当前部署报告












###### 查看历史报告 




摘要 :本节介绍在iDeploy工具查看历史报告的操作。 


步骤 :

在部署页面，单击（查看报告）按钮打开历史报告列表，如[图2]所示。
图2  部署实施






在历史报告列表页面，单击所需查看的时间段，打开历史报告，如[图3]所示。
图3  历史报告列表










##### 设置iDeploy工具语言 
摘要 :iDeploy支持语言设置。本节介绍使用iDeploy工具设置语言的操作。 
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中设置语言，如[图1]所示。
图1  设置语言

##### 检查LLD 
摘要 :iDeploy支持LLD检查。本节介绍在iDeploy工具进行LLD检查的操作。
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中打开是否进行LLD检查开关，如[图1]所示。
图1  设置LLD检查

在导入LLD文件时，iDeploy工具就会对LLD中的关键参数进行合法性检查。如检查不通过会给出提示信息，如[图2]所示。
图2  LLD检查失败信息

## 缩略语 
## 缩略语 
3GPP :3rd Generation Partnership Project第三代合作伙伴计划
5GC :5G Core Network5G核心网
### AIC 
Automatic Integration Center自动化集成中心
### CDU 
Cloud Database Unit云数据库单元
### CGSL 
Carrier Grade Server Linux电信级服务器Linux
### CGW 
CDB GatewayCDB接入网关
### CIDR 
Classless Inter-Domain Routing无类别域间路由
### CMCC 
China Mobile Communications Corporation中国移动通信集团公司
### CN 
Core Network核心网
### CPU 
Central Processing Unit中央处理器
### DC 
Data Center数据中心
### DVS 
Distributed Virtual Switch分布式虚拟交换机
EM :Element Management网元管理
EMS :Element Management System网元管理系统
ETSI :European Telecommunications Standards Institute欧洲电信标准化协会
FTP :File Transfer Protocol文件传输协议
GSU :General Service Unit通用业务单元
### HLD 
High Level Design高层次设计
HTTP :Hypertext Transfer Protocol超文本传输协议
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
### IOPS 
Input/Output Operations Per Second每秒输入/输出操作
IP :Internet Protocol因特网协议
### IPU 
Interface Process Unit接口处理单元
IPv4 :Internet Protocol Version 4互联网通信协议第四版
IPv6 :Internet Protocol Version 6互联网通信协议第六版
### IaaS 
Infrastructure as a Service基础设施即服务
### LB 
Load Balance负载均衡
### LLD 
Low Level Design详细设计
MANO :Management and Orchestration管理和编排
### MTU 
Maximum Transmission Unit最大传输单元
NF :Network Function网络功能
NFS :Network Function Service网络功能服务
NFV :Network Functions Virtualization网络功能虚拟化
### NFVI 
Network Functions Virtualization Infrastructure网络功能虚拟化基础设施
NFVO :Network Functions Virtualization Orchestrator网络功能虚拟化编排器
### NS 
Network Service网络服务
Network Slice网络切片
### NTP 
Network Time Protocol网络时间协议
OAM :Operation, Administration and Maintenance操作管理维护
OMU :Operation & Management Unit操作管理单元
### OSP 
OpenStack PlatformOpenStack平台
### OVS 
Open VSwitch虚拟交换机
### PC 
Personal Computer个人电脑
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
QoS :Quality of Service服务质量
### SBI 
Service Based Interface基于服务的接口
SC :Service Component服务组件
### SDN 
Software Defined Network软件定义网络
SFTP :Secure File Transfer Protocol安全文件传输协议
### SIG 
Signal信令
SMS :Short Message Service短消息业务
### SR-IOV 
Single-Root I/O Virtualization单根I/O虚拟化
Single-Root Input/Output Virtualization单根I/O虚拟化
### SSH 
Secure Shell安全外壳协议
### TEC 
Thermoelectric Cooler热电制冷器
### TECS 
Tulip Elastic Cloud System郁金香弹性云系统
### TELNET 
Telecommunication Network Protocol远程登录协议
UDSF :Unstructured Data Storage Function非结构化数据存储功能
VIM :Virtualized Infrastructure Manager虚拟化基础设施管理系统
### VLAN 
Virtual Local Area Network虚拟局域网
VM :Virtual Machine虚拟机
VNF :Virtualized Network Function虚拟化网络功能
### VNFD 
Virtualized Network Function Descriptor虚拟化网络功能描述符
VNFM :Virtualized Network Function Manager虚拟化网络功能管理器
### VPC 
Virtual Private Cloud虚拟私有云
### VRF 
Virtual Route Forwarding虚拟路由转发
VPN Routing and ForwardingVPN路由转发
ZTE :Zhongxing Telecommunications Equipment中兴通讯
### uMAC 
unified Mobile Access Controller统一的移动性接入控制器
## 软件安装（AIC部署）-非SDN 
### 安装概述 
#### 虚拟化系统的组网架构 
概述 :在部署中兴通讯虚拟化核心网设备ZXUN RCP的运行环境之前，需要先了解虚拟化系统相关概念，包括组网架构及各部分的功能。
##### 组网架构 
虚拟化又称为云化，云是网络的一种比喻说法，是对电信网、互联网和底层基础设施的抽象描述。 
 说明： 
底层基础设施指的是主机、内存、CPU、接口、网络等硬件设施或网络资源。
云化就是指通过虚拟化技术NFV，将核心网网元的基础架构从专用硬件向通用硬件进行演进，从而实现软硬件的解耦。
对核心网进行云化后，其硬件设备和网元不再是一一对应的关系，由于底层的硬件设施和上层应用是解耦的，底层的硬件资源通过NFV可以被上层的多种应用共享。
NFV是云化核心网的关键技术。通过基于行业标准的x86服务器、存储和交换设备及虚拟化技术，使网络设备功能不再依赖于专用硬件，从而降低网络昂贵的设备成本，资源可以充分灵活共享，帮助运营商获得更多、更灵活的网络能力，实现新业务的快速开发和部署。
ETSI制定的NFV架构由NFVI、VNF以及MANO三个部分组成。
NFVI：基础硬件设施NFVI包括通用的硬件设施及其虚拟化。 
MANO：云管理及调度平台在NFV架构中，MANO负责对整个NFVI资源的管理和编排，负责业务网络和NFVI资源的映射和关联。MANO包括VIM、VNFM和NFVO三个部分，分别完成对NFVI、VNF和NS三个层次的管理。 
VNF：上层业务应用VNF使用软件实现虚拟化网络功能。 
根据核心网云化的三层结构，NFV架构中各个节点的关系如[图1]所示。
图1  NFV三层架构

各节点的功能说明参见[表1]。
架构|节点|描述|对应的产品
---|---|---|---
NFVI（基础硬件设施）|服务器|NFVI是网络功能虚拟化基础设施，通常指的是物理资源，包括主机、内存、CPU、接口等硬件设施。|云平台的硬件通常采用高性能的服务器，如HP C7000，DELL R730等。中兴通讯自研的云平台服务器为ZXCLOUDE9000企业级刀片服务器。
磁阵|NFVI（基础硬件设施）|用于数据存储的设备，运营商可以根据实际运营状况决定是否需要配置磁阵，在交接局业务量较小的情况下，无需配置。|根据运营商的实际环境配置，对磁阵的型号没有限制。通常情况下使用Fujitsu DX100 S3。
外部交换机|NFVI（基础硬件设施）|外部交换机指的是在实际组网环境中，用于将NFVI和磁阵接入运营商维护网络的交换机。|根据运营商的实际环境配置，对交换机的型号没有限制。通常情况下需要配备2台外部交换机（启用堆叠）。
MANO（云管理及调度平台）|VIM|VIM是虚拟化基础设施管理系统，是NFVI的管理者。VIM主要负责基础设施层硬件资源、虚拟化资源的管理、监控和故障上报，面向上层业务应用提供虚拟化资源池。VIM为NFVO和VNFM提供VNF相关虚拟资源的操作接口。|VIM称为云平台管理软件，常见的VIM包括VMWare、OpenStack等。中兴通讯基于OpenStack开源标准接口研发的云平台管理软件的产品名称为ZTE TECS OpenStack。
VNFM和NFVO|MANO（云管理及调度平台）|VNFM和NFVO统称为NFV管理器。NFVO负责全网的网络服务、虚拟资源以及物理资源的编排和管理功能。VNFM对核心网所有网元提供生命周期管理以及弹性伸缩相关的虚拟机操作管理功能。|由中兴通讯自研的用于实现VNFM和NFVO功能的产品名称为CloudStudio。
VNF（上层业务应用）|VNF|一个VNF对应于在传统非虚拟化网络中的一个物理网络功能，即对应核心网的各种网元，如：PCF等。|中兴通讯用于实现PCF网元功能的产品名称为ZXUN RCP。
 说明： 
本文档仅涉及承担虚拟化架构中的一种VNF功能的ZXUN RCP的软件安装过程。
#### 安装导读 
在进行ZXUN RCP软件安装前，确保已经完成硬件设备安装、VIM云平台管理软件和MANO软件安装，本文只涉及ZXUN RCP的版本软件的安装过程。安装全流程参见[表1]。
安装步骤|安装内容|安装参考文档
---|---|---
1|VIM|安装TECS OpenStack|参考ZTE TECS OpenStack用户手册文档包中用户手册文档包中的《软件安装》内容进行安装。
2|MANO|安装CloudStudio|参CloudStudio用户手册文档包中用户手册文档包中的“安装与调测”内容进行安装。
安装ElasticNet UME R50s|2|MANO|参考ElasticNet UME R50s成套用户手册中的“软件安装指导”内容进行安装。
3|VNF|安装ZXUN RCP|详细信息请参考本文档后续内容。
#### 安装流程 
ZXUN RCP虚拟化的软件安装流程参见[表1]。
步骤|操作|说明|参考
---|---|---|---
1|安装前准备|安装前的准备工作，包括准备软件、规划网络数据及获取系统默认的用户名和密码。|安装准备
2|制作LLD|使用ZXUN AIC（iDevise）工具输出部署所需的LLD文件。LLD在HLD的基础上，定义各种网络资源的分配细则、网络配置要求的设计文档。ZXUN AIC旨在打造NFV的CI/CD（Continuous Integration，持续集成/Continuous Delivery，持续交付），主要用于NFVI层的自动化部署、VNF的持续集成及交付。iDevise是ZXUNAIC的一个组件，用于DC的数据规划设计。iDevise基于ZTE NFV相关组网规范，按照硬件、承载、虚拟层、VNF等层次进行数据设计，输出开局部署所需的LLD文件。本文仅介绍VNF的LLD的制作过程。|LLD制作
3|部署VNF|使用ZXUN AIC（iDeploy）工具完成VNF所需虚拟资源的创建和业务程序的自动部署。iDeploy是ZXUNAIC的一个组件，用于实现端到端的自动化部署。iDeploy中导入iDevise输出的LLD文件，以及版本文件，并进行VNF的自动部署，整个流程无需人工干预。|VNF部署
### 安装准备 
#### 软件准备 
##### 简介 
软件准备包括AIC工具、ZXUN RCP的版本软件和客户端上需要安装的软件。
##### AIC工具 
名称|说明
---|---
AIC(iDevise) V*|LLD数据规划设计工具。最终文件路径示例如下：AIC(iDevise) V*└─ZXUNAIC (iDevise)(WPS版).xlsm└─Templates└─VNF LLD Template PCF.xlsm└─Tools└─rsa.dll└─rsa_go.dll
AIC(iDeploy) V*|自动化部署工具。
其中"V*"为版本号，以实际版本为准。 
AIC工具的获取方式如下： 
AIC(iDevise) V*：LLD数据规划设计工具随RCP版本包发布，获取路径： /RCPVx/AIC(iDevise) V*。其中，“Vx”为RCP版本号，以实际版本为准。 
AIC(iDeploy) V*：自动化部署工具和iDeploy License需要联系中兴通讯技术支持。 
##### 版本软件 
安装ZXUN RCP需要准备相关的软件包参见[表2]。
版本包类型|说明|版本包名称|获取路径
---|---|---|---
基础包|基础包也称部署插件包，包含了虚机部署info.xml文件、policy.xml文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。|ZXUN_RCP_VNFD.VXXX.csar|/RCPVXXX/versions/IAAS/pcf/vnfd
镜像包|镜像包是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。|cgsl_YYY.zip|/RCPVXXX/versions/IAAS/images
业务软件包|业务软件包是ZXUN RCP完成公共服务及特定业务的软件包。|ZXUN_RCP_VXXX.zip|/RCPVXXX/versions/IAAS/pcf/version
AIC插件包|网元为支持AIC工具所提供的插件。|aic-plugin-pcf-VZZZ-PCF.zip|/RCPVXXX
XXX表示ZXUN RCP具体的版本号，以实际版本为准。
YYY表示镜像文件包具体的版本号，以实际版本为准。 
ZZZ表示AIC部署工具具体的版本号，以实际版本为准。 
##### 调试机的软件配置要求 
调试机的功能参见[表3]。
类别|描述
---|---
与VIM通信|作为VIM客户端。在本文档中，作为客户端，访问中兴通讯自研的云平台管理软件TECS OpenStack。
与VNFM和NFVO通信|作为VNFM和NFVO的客户端。在本文档中，作为客户端，访问中兴通讯自研的NFVI资源编排和管理软件NFVO。
与NFVI通信|以SSH方式访问作为控制节点或计算节点的硬件服务器。
存放版本文件|将ZXUN RCP的版本安装软件从客户端上传到NFVI。
调试机中需要安装的软件参见[表4]。
软件类型|备注
---|---
操作系统|建议安装Windows 7或更高级的版本。
浏览器|只支持Google Chrome，操作员需要通过Google Chrome浏览器登录到TECS OpenStack和NFVO的图形化操作页面。
FTP或SFTP工具|将ZXUN RCP的版本文件从客户端上传到NFVI上。
远程访问工具|以TELNET或SSH方式访问作为控制节点或计算节点的硬件服务器。
#### 默认用户名和密码 
在安装过程中涉及到系统默认的用户名及密码参见[表1]。
 小心！ 
部署完成后，请立即登录并修改所有帐号的默认密码。 
建议定期修改密码，防止密码被盗窃和破解。 
系统|用户名及密码
---|---
NFVO/VNFM客户端（CloudStudio）|用户名：admin密码：Zenap_123
NFVO/VNFM操作系统（CloudStudio）|用户名：root密码：CloudStudio__123（此处为双下划线）
NFVO/VNFM客户端（ElasticNet UME R50s）|用户名：admin密码：Zenap_123
PaaS操作系统（ElasticNet UME R50s）|用户名：ubuntu密码：UbuntU1!2@3#4$
安全加固后的PaaS操作系统（ElasticNet UME R50s）|用户名：pict密码：PicT1!2@3#4$
TECS OpenStack|登录TECS OpenStack客户端的默认用户名及密码如下：TECS OpenStack V3.17.14版本以上用户名：admin密码：KeystoneTECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123
登录主机的操作系统的默认用户名及密码如下：用户名：通过tecs用户登录，使用sudo -i命令切换到root用户密码：ossdbg1|TECS OpenStack
#### VIM侧的数据准备 
检查当前TECS OpenStack版本信息和规划版本是否相同。 
检查iDeploy工具版本号是否满足使用要求。 
检查获取的用户名和密码能否正常登录TECS OpenStack的客户端和主机操作系统。 
检查TECS OpenStack系统运行状态正常，有无重要/紧急的异常告警。 
检查TECS OpenStack上剩余的CPU、内存、存储等虚拟资源是否充足。 
检查TECS OpenStack上预定义的租户配额是否充足。 
检查后端存储，如磁阵、CEPH是否已经正常接入，对应版本是否正确，存储资源是否充足。 
#### MANO侧的数据准备 
检查当前MANO版本和规划版本是否相同。 
检查获取的用户名和密码能否正常登录MANO。 
检查MANO系统运行状态正常，有无重要、紧急的异常告警。 
检查NFVO上接入的VNFM是否正常，确保其状态为正常。 
检查NFVO上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
检查VNFM上接入的VIM平台（TECS OpenStack）是否正常，能否正常查询VIM租户信息。 
#### 查询VNFM用户的权限 
概述 :本节介绍如何查询VNFM用户的权限，在部署ZXUN RCP之前，需要确认用户权限是否配置正确。
VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，在中国移动等国内运营商的部署环境中，由于安全原因，禁止使用admin用户，需要新建用户，此用户名之前已经由MANO维护人员创建成功，创建操作参见“[在VNFM上创建用户]”，在部署ZXUN RCP之前，需要确认用户的权限是否正确。
##### 操作前提 
已经从MANO的维护人员处获取了VNFM用户的名称。 
操作步骤 :登录VNFM客户端，选择系统→安全→用户管理
，进入用户管理页面，如[图1]所示。
图1  用户管理页面

查看从MANO的维护人员处获取的VNFM用户的权限，单击VNFM用户列表中对应操作列的修改按钮。
出现修改用户页面，如[图2]所示。
图2  修改用户页面

单击用户规则后的查看详情按钮，出现查看账户规则页面，如[图3]所示。
图3  查看账户规则页面

确认帐号登录方式，Web和API必须为勾选状态。
#### 修改镜像文件名称 
摘要 :本节介绍根据运营商的规范要求，使用工具修改镜像文件名称。 
前提 :获取修改镜像名称的脚本文件（与版本包中镜像文件处于同级目录）：change-pcf-image.sh。
相关信息 :镜像包名称由三部分组成： 
第一部分根据运营商的要求填写，例如：NFV-R-HDNJIH-01A-ZTE-01-MIR。 
第二部分对应部署的局号，例如：PCF52。 
第三部分对应部署的版本号，例如：V7.19.12。 
三个部分之间以下划线连接：NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12。
本节以将镜像包名称修改为NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12为例。
步骤 :在TECS节点CGSL操作系统的/home/tecs路径下新建一个目录，如pcfimage目录。
将change-pcf-image.sh脚本文件和镜像包（以cgsl_F16P4_200408.zip为例）拷贝到TECS CGSL系统的pcfimage目录下。
使用SSH方式登录TECS节点的CGSL操作系统，进入/home/tecs/pcfimage目录。
执行ll命令，显示当前目录下文件的详细信息，如下所示。
`[tecs@host-2000--1-1-1-246 pcfimage]$ ll
total 400740
-rw-------. 1 tecs tecs 410353325 May  4 09:19 cgsl_F16P4_200408.zip
-rwx--x--x. 1 tecs tecs       923 May  4 09:17 change-pcf-image.sh
[tecs@host-2000--1-1-1-246 pcfimage]$` 
执行./change-pcf-image.sh命令，修改镜像包文件名为NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12，如下所示。
 说明： 
执行./change-pcf-image.sh命令之前需确认当前目录不能有其他zip文件。
`[tecs@host-2000--1-1-1-246 pcfimage]$ cd /home/tecs/pcfimage/
[tecs@host-2000--1-1-1-246 pcfimage]$ chmod +x change-pcf-image.sh
[tecs@host-2000--1-1-1-246 pcfimage]$ ./change-pcf-image.sh NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12
./change-pcf-image.sh: line 1: /bin/bash: No such file or directory
Archive:  cgsl_F16P4_200408.zip
  inflating: image_tmp/resourceList.json
   creating: image_tmp/SoftwareImages/
  inflating: image_tmp/SoftwareImages/CGS-Linux-CORE.V5.04.F16P4_20200408-x86_64.img
  inflating: image_tmp/resource.meta
  inflating: image_tmp/checksum.lst
NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12
  adding: checksum.lst (deflated 15%)
  adding: resourceList.json (deflated 40%)
  adding: resource.meta (deflated 3%)
  adding: SoftwareImages/ (stored 0%)
  adding: SoftwareImages/NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12.img (deflated 2%)
Making the image file is successfully !!` 
执行ll命令，确认修改名称后的镜像包是否在pcfimage目录下，如下所示。
`[tecs@host-2000--1-1-1-246 pcfimage]$ ll
total 801480
-rw-------. 1 tecs tecs 410353325 May  4 09:19 cgsl_F16P4_200408.zip
-rwx--x--x. 1 tecs tecs       975 May  4 09:34 change-pcf-image.sh
drwxr-xr-x. 3 tecs tecs      4096 May  4 09:35 image_tmp
-rw-r--r--. 1 tecs tecs 410353392 May  4 09:36 NFV-R-HDNJIH-01A-ZTE-01-MIR_PCF52_V7.19.12.zip` 
（可选）取出镜像压缩包后，如果没有别的需要，可以在TECS CGSL系统上删除pcfimage目录。
数据规划 :#### 基础数据规划 
##### 虚拟环境资源规划 
ZXUN RCP的虚拟环境资源规划参见[表1]。
资源规划|作用|示例
---|---|---
项目|项目又称为租户。TECS OpenStack以项目的方式实现各个虚拟VNF之间虚拟资源的隔离。同一个VNF内的主机、网络等资源归属到同一项目。|项目名称：admin（系统默认的项目，无需创建）。项目名称：PROJ-RCP-1（此项目主要是部署与ZXUN RCP相关的一些网络平面和VM）。
用户|登录VIM云平台管理软件TECS OpenStack的账号，需要为用户指定其所属的项目。|用户名称：SysAdmin（系统默认的用户，无需创建），密码为SysAdmin_123。用户名称：ZXUN RCP。通常情况下，除了TECSOpenStack默认的用户之外，还需要为每个项目都创建一个用户。本文档规划为PROJ-RCP-1项目创建一个用户ZXUN RCP。该ZXUNRCP用户仅可管理PROJ-RCP-1项目，而admin用户可以管理所有的项目。
##### VM类型 
ZXUN RCP的VM类型参见[表2]。
虚机类型|功能描述
---|---
OMU|对接CN-OAM（核心网集中网管），管理整局上电、版本加载、配置同步、网管命令执行、告警和性能统计汇总、各服务弹缩控制等功能。
IPU|IP接口虚拟机，收发IP承载的控制面信令和用户面报文。
GSU（HTTP LB）|HTTP负荷分担服务，实现HTTP协议消息分发。
GSU（SIG LB）|信令负荷分担服务，实现Diameter和SMS消息分发。
GSU（PolicyControl）|处理PCF和PCRF业务逻辑，提供AMPolicyControl、UEPolicyControl、SMPolicyControl和PolicyAuthorization服务。
GSU（GW）|UDSF统一接入网关。
CDU|UDSF数据存储单元。
LOG|策略日志单元，产生策略日志并存入云盘或LSU，并可通过SFTP上传给外部服务器。
LSU|策略日志存储单元，用于策略日志分析。
各业务模块VM支持的工作模式参见[表3]。
VM类型|工作模式
---|---
OMU|1+1+1冗余备份
IPU|N+1
GSU|N+1
CDU|1+1
LOG|N+1
LSU|N+1
#### 非SDN组网规划 
网络平面是指各个VM通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN RCP规划的网络平面的详细描述参见[表1]。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。 
虚机名称|网络平面|子网平面|描述
---|---|---|---
All|ZTE_RCP_NfId_SERV_INT_NET|IPv4：ZTE_RCP_NfId_SERV_INT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_SERV_INT_SUBNET_IPv6|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面，本文档规划内部控制面名称为ZTE_RCP_NfId_MGT_INT_NET，内部媒体面名称为ZTE_RCP_NfId_SERV_INT_NET。
All|ZTE_RCP_NfId_MGT_INT_NET|IPv4：ZTE_RCP_NfId_MGT_INT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_MGT_INT_SUBNET_IPv6|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面，本文档规划内部控制面名称为ZTE_RCP_NfId_MGT_INT_NET，内部媒体面名称为ZTE_RCP_NfId_SERV_INT_NET。
OMU|ZTE_RCP_NfId_OAM_EXT_NET|IPv4：ZTE_RCP_NfId_OAM_EXT_SUBNET_IPv4IPv6：ZTE_RCP_NfId_OAM_EXT_SUBNET_IPv6|网管平面是ZXUN RCP和EMS、MANO进行通信的网络平面。部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。
IPU|ZTE_RCP_NfId_EXT_NET|IPv4：ZTE_RCP_NfId_EXT_NET_SUBNET_IPv4IPv6：ZTE_RCP_NfId_EXT_NET_SUBNET_IPv6|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
### LLD制作 
注意事项 :通过iDevise进行的所有操作，从ZXUN AIC (iDevise)(WPS版).xlsm入口，通过ZXUN AIC (iDevise)(WPS版).xlsm生成模板文件。勿直接修改Templates目录下的模板文件。 
如iDevise设计参数填写错误，需要进行修改，从ZXUN AIC (iDevise)(WPS版).xlsm文件入口修改后重新生成LLD，勿直接修改最终的LLD文件。 
iDevise设计过程中，只有表格为橙色底纹红色字体时，才需要使用者填写参数或者确认默认值是否正确，其余格式的单元格保持默认值不要修改，如图1所示。 说明：部分橙色底色单元格带有批注信息，当鼠标移动到该单元格时，将会自动显示批注信息。需特别关注批注信息，按要求填写单元格内容。图1  LLD模板 
如需要向LLD的单元格拷贝粘贴数据，勿直接进行粘贴，选择”粘贴为数值”的方式进行粘贴，以免破坏LLD中的单元格格式。 
#### 创建工程 
摘要 :本节介绍通过AIC工具如何创建一个工程。 
 说明： 
本文档中的AIC工具版本号仅为示例，请以实际的版本为准。 
步骤 :在客户端PC打开AIC工具文件夹，双击ZXUN AIC (iDevise)(WPS版).xlsm，出现如[图1]所示的页面，用于分层选择不同领域的LLD进行设计。
图1  ZXUN AIC(iDevise)页面

登录对话框的参数说明参见[表1]。
参数名称|参数说明
---|---
Project Name|本参数用于设置本次工程的名称，由操作员自行定义即可，仅针对LLD文档设计过程中有效，不影响后续部署。
DC Name|本参数用于设置本次工程所在的DC的名称，由操作员自定义即可，仅针对LLD文档设计过程中有效，不影响后续部署。
Template|该参数是用于控制下方各层次LLD模板选择的总开关，包括两个选项：General LLD Template普通场景下的LLD模板设计，一般情况下都需要设置为此选项。xGW-E LLD Templat目前只有中兴通讯的ZXUN xGW（GW-U）产品才需要设置为此选项。
Networking|用于承载组网LLD规划设计。
Superfusion|超融合组网LLD规划设计。如果Superfusion设置为Y，因为Superfusion模板中是CEPH和VIM的配置，所以CEPH和VIM所在单元格灰化受保护，不支持CEPH和VIM的模板文件的修改。
CEPH|用于CEPH集群LLD规划设计。
VIM|用于VIM云平台LLD规划设计。
MANO&EMS|用于MANO和EM层LLD设计。
VNF|用于VNF层的LLD设计。
iChecklist|在各领域部署前后如果需要自检，则在iChecklist进行相关LLD设计。
本文档示例通过AIC工具部署ZXUN RCP，只需要将VNF设置为Y，其他都设置为Ｎ，选择完毕后，单击New Project，系统弹出提示确认框，如[图2]所示。
图2  提示确认框

单击是按钮，在连续弹出的提示框中单击确定按钮。
将PCF设置为Y，单击Edit Project按钮，开始进行VNF的模板选择及LLD参数设计，如[图3]所示。
图3  VNF

单击Open按钮，新建一个模板，会自动创建一个名称为VNF LLD Template PCF.xlsm的表格，如[图4]所示。
图4  VNF LLD Template PCF.xlsm

#### 配置LLD 
在如[图4]所示的VNF LLD Template PCF.xlsm模板中，依次进入以下各sheet页面，根据规划配置相关参数。
##### Global Setting 
Global Setting页签用于配置VNF的全局参数，示例如[图1]所示。
 说明： 
Global Setting页签中的某些参数的配置结果将影响后续其他设计页签的呈现，包括Application scenarios、Network Type和Storage Type，详细说明参见[表1]。
图1  Global Setting页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Applicationscenarios|0-Common：通用场景1-5GS：通用5G切片场景（MANO为CMCC模式）11-CMCC Phase1：中国移动一期资源池场景（MANO为CMCC模式）当选择为本场景时，某些表格中部分单元格底色变为绿色的，表示该处已根据中国移动的规范要求设置好对应的数值，非特殊情况下不需要修改。中国移动非SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VNF Network Setting或者VNF Network Setting IPv6。12-CMCC Phase2：中国移动二期资源池场景（MANO为CMCC模式，SDN组网）中国移动SDN组网场景时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要配置与网络数据相关的页签为VRouter Summary、VRouter External Network和VNF SDNNetwork Setting。13-CMCC Phase3: 中国移动三期资源池场景（MANO为CMCC协议模式，SDN组网，NS纳管）中国移动SDN组网场景、执行NS纳管VNF时，需要设置为本参数。在此种场景下，后续在LLD制作中，需要将NS Info页签中是否执行NS纳管VNF参数配置为YES。21-CTCC：中国电信资源池（MANO为CMCC模式）31-CUCC：中国联通资源池（MANO为CMCC模式）41-CBNC：中国广电资源池51-OverSea：海外国际局点
Room Name|本参数用于设置机房名称，请根据实际情况配置。请根据运营商的规划进行设置。
DC Name|本参数用于设置DC名称。该参数的值来源于创建工程时，配置的参数DC Name，参见“创建工程”，此处使用默认值，不需要设置。
DC Description|本参数用于设置DC的信息描述，一般根据运营商的工程规划方案设置，表示DC的物理位置，例如具体的大楼、机房位置等。请根据运营商的规划进行设置。
Network Type|本参数用于设置需要部署的VIM云平台的网络类型。SDN组网场景时，该参数需要设置为VxLAN。非SDN组网场景时，该参数需要设置为VLAN。
VIM ID|本参数用于设置ZXUN RCP需要部署的VIM云平台的编号，用于VIM接入MANO时使用。配置原则如下：中国移动命名规则：NFV-RP-HBBAD-01A-ZX-01中国电信命名规则：GD-GZ-ZSC-RP0001B-V-ZE-01中国联通命名规则：az1.xa1.chinaunicom.cn（MANO的V5.20.11版本支持域名方式，其他版本不支持域名方式）除上述运营商之外的其他运营商，不必遵循上述格式，可自定义合法字符串，例如VIM01。
VIM NAME|本参数用于设置ZXUN RCP需要部署的VIM云平台的名称。根据运营商的规划进行设置。
VIM Type|本参数用于设置ZXUN RCP需要部署的VIM云平台类型。配置为TECS，表示ZXUN RCP需要部署的VIM云平台为中兴通讯自研的的ZTE TECS OpenStack。配置为OSP，表示ZXUN RCP需要部署的VIM云平台为OpenStack Platform ，OSP是OpenStack Platform开源项目的服务。配置为OIaaS，表示ZXUN RCP需要部署的VIM云平台为IaaS，基础设施服务，即多个基础设施组成的服务。
VIM Version|本参数用于设置需要部署的VIM云平台的版本号。与现场实际安装的TECS OpenStack版本号保持一致。
Storage Type|本参数用于设置VIM云平台在存储数据时，使用的存储类型。CEPHVIM云平台使用CEPH存储数据。Local DiskVIM云平台使用本地盘存储数据，由服务器自身携带的存储硬盘提供整个系统的存储能力。Disk ArrayVIM云平台由单独的磁盘阵列设备提供存储能力。当Storage Type配置为CEPH或Disk Array时（表示ZXUN RCP使用后端存储设备），后续需要额外配置的页签如下：Volume Types页签，表示在这两种情况下，需要设置ZXUN RCP规划的云硬盘类型名称，参见“Volume Types”。Storage QoS页签，表示在这两种情况下，需要设置ZXUN RCP规划的存储QoS策略，参见“Storage QoS”。中国电信和中国移动部署场景：本参数需要设置为CEPH。中国联通部署场景：本参数需要设置为Disk Array。
Use Huge Pages / CPU Dedication|本参数用于设置VIM云平台是否启用巨页（Huge Page）/绑核（NUMA）功能。国内运营商部署场景：本参数需要设置为YES。
Use Security Group|本参数用于设置VIM云平台是否开启安全组。安全组是在VIM云平台上（如中兴通讯自研的ZTE TECSOpenStack）上创建的一个地址段范围，在VIM云平台和VNF同时开启安全组的情况下，VNF可以和处于该地址段范围内的外部网元进行通信。国内运营商部署场景：本参数需要设置为NO。
Use Port SecurityGroup|本参数用于设置ZXUN RCP是否开启端口安全组。当Application scenarios设置为12-CMCC Phase2（即中国移动二期资源池）或13-CMCC Phase3（即中国移动三期资源池）时，本参数需要设置为YES，除此之外的其他场景，本参数需要设置为NO。
VNF IP Type|本参数用于设置需要部署的VNF使用的网络地址类型。IPv6：IPv6类型地址IPv4：IPv4类型地址本参数需要根据现场的实际组网情况进行配置。中国移动部署场景：本参数需要设置为IPv6。如果ZXUN RCP使用的网络地址类型需要部署为双栈，此参数还是设置为单栈方式（即设置为IPv6或者IPv4都可以），在ZXUN RCP实例化成功后，通过后续的业务配置来实现ZXUN RCP的双栈功能。
Timezone|本参数用于设置ZXUN RCP所在地的时区。根据实际情况从下拉列表中选择，比如中国的时区为东8区，设置为GMT+08:00Asia/Shanghai。国内运营商场景：固定设置为GMT+08:00 Asia/Shanghai。
Physical Network Name|本参数用于设置VIM云平台的租户网络所映射的物理网卡名称。当VIM Type参数配置为TECS时，通常默认为default。当VIM Type参数配置为OSP时，通常默认为datacentre。当VIM Type参数配置为OIaaS时，通常默认为oiaas-net。
Language|本参数用于设置部署VNF时，VNF的网管系统的语言类型。en_US.UTF-8：英文zh_CN.UTF-8：中文国内运营商场景：固定配置为zh_CN.UTF-8。
VNFM ID|本参数用于设置ZXUN RCP所在的VNFM ID。此处需要配置为VNFM接入NFVO时的实际数值，在多个VNFM接入同一个NFVO时，需要配置此参数。
Resource Prefix|本参数用于设置资源前缀名称，用于LLD定义租户、云盘、网络等资源时，系统在原有的名称前，自动添加的前缀。此参数需要根据运营商的规范进行配置。各运营商局点填写示例：中国移动：HBBAD-01A-ZX-01。 地理位置-硬件资源池编号-厂家-池编号。中国电信：GD-GZ-ZSC-RP0001BE。省份标签-地市标签-局点标签-云属性+序号。中国联通：XA1-SN-SN-XA。站点名称-大区-省份-城市。其他运营商：可自定义合法字符串，或根据指定要求填写。
Allow Cross AZ Deployment|本参数是指在Storage Type参数设置为非本地盘（即配置为CEPH或Disk Array）的情况下，是否允许虚机的可用域与存储后端的可用域不相同。中移资源池规范中，要求虚机可用域与存储可用域必须一致，该参数应设置为NO。TECS OpenStack V06.10.10版本没有存储后端的可用域，因此当ZXUN RCP部署在该版本VIM云平台时，该参数需要设置为YES。其他场景下，根据运营商规范及虚机可用域与存储可用域实际规划情况设置。该参数配置需要与daisy界面中的跨AZ挂载云盘参数保持一致，查询路径如图2所示。
Support Duplicate Resource Name|本参数用于设置，操作员在TECS OpenStack上创建资源（如vRrouter等）时，是否允许不同租户下有重名的资源。YES：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，允许在本租户下继续创建该名称的资源。NO：操作员在网元租户（项目）下创建资源时，如果其他租户下已有同名资源，则不允许在本租户下继续创建该名称的资源。中国移动部署场景：本参数需要设置为NO。
Quorum Service Num|本参数用于设置仲裁服务节点数目，默认配置为1，表示由一个AMU虚机为两个OMU虚机提供主备仲裁服务。本参数建议保持默认值。
Enable Accel Resources|本参数用于设置是否启用加速资源控制，具备硬件条件的资源池可以启用（即资源池计算节点安装加速网卡），不具备条件的资源池默认关闭。
Enable Flexible Resources|本参数用于设置是否启用弹性资源控制，TECS OpnenStack平台Train版本支持该功能，默认关闭。
Only Deploy Omu Test Instance|本参数用于设置是否使用OMU连通性测试部署。YES：OMU连通性测试部署。NO：正常实例化部署。
图2  查询跨AZ挂载云盘配置

##### VIM Controller Info 
VIM Controller Info页签用于配置VNF所在VIM云平台的相关信息，如[图1]所示。
 说明： 
VIM Controller Info页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
图1  VIM Controller Info页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VIM Controller IP|该参数用于配置ZXUN RCP的VIM云平台（本文档指中兴通讯的TECS OpenStack）控制节点的TECSClient网络平面的浮动IP地址。操作员通过TECS Client网络平面，可以在客户端使用Chrome浏览器访问TECS OpenStack提供的图形化网管界面。
##### Host Aggregate 
Host Aggregate页签用于配置HA（主机集合）和AZ（可用域），如[图1]所示。
主机集合（Host Aggregates）HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。 
可用域（Availability Zones）AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。可以理解为只是一些主机在工程上的独立，例如可以把一个机架上的主机划分在一个可用域中。 
一个AZ可以包含多个HA，一个HA只能属于一个AZ，根据实际规划来配置。 
一般为了达到容灾的效果，一个DC会按照硬件位置划分为两个AZ，相同元数据属性的HA要在两个AZ里都存在，但同时一个HA只能属于一个AZ，因此在规划时对同一元数据属性的HA，可以定义两个HA名称，分别属于不同的AZ。 
图1  Host Aggregate页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Usage|本参数用于配置可用域用途，如管理域、控制面域。Management表示管理域。Control-Plane表示控制域。
Available Zone Name|本参数用于配置可用域（Availability Zones）的名称。AZ可以简单理解为一组节点的集合，这组节点具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域（AZ）是一个面向终端客户的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。
Host Aggregate Name|本参数用于配置主机集合（Host Aggregates）的名称。HA是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是制定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。
Host Aggregate Metadata|本参数用于配置主机集合（Host Aggregates）的元数据，也就是设置各种调度过滤器的类型及其取值。主机集合（Host Aggregates）主要用来为过滤调度器nova-scheduler通过某一属性进行实例（instance）的调度。比如：将数据库服务的实例（instances）都调度到具有SSD属性的主机集合（HostAggregates）中，又或者让某个镜像（image）的实例（instances）调度到同一个主机集合（Host Aggregates）中。调度是指从现有的可用的计算节点中，选择其中一个作为目的节点进行虚机部署、迁移以及规格调整等操作。过滤调度器是常用的调度器之一，过滤调度器使用多个功能不同的过滤器对主机进行筛选。本参数用于设置各种调度过滤器的类型及其取值，比如Aggregate_Instance_Extra_SpecsFilter是主机集合flavor的扩展字段调试器。
Comment|本参数用于配置自定义的描述信息。
 说明： 
确保资源域、主机集合资源满足要求。 
Host Aggregate Metadata参数配置与实际保持一致，若填写错误，则实例化过程会找不到对应的主机集合，上报资源不足失败。 
##### MANO Info 
MANO Info页签用于配置部署VNF所使用到的MANO相关信息，根据实际信息配置，如[图1]所示。
 说明： 
MANO Info页签中的参数，全部继承MANO（本文档指中兴通讯的CloudStudio）侧的配置数据，需要和MANO侧的配置数据保持一致，在配置前请从MANO侧获取相关数据。如果VNF的LLD是与MANO的LLD同时规划的，则需要从ZTE NFV LLD(MANO) XX.xlsx表中获取。
图1  MANO Info页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
NFVO/VNFM Version|本参数用于设置MANO的版本号，与现场实际使用版本号保持一致。若在参数配置下拉框中未找到对应的MANO版本号，则需要在iDeploy部署工具的领域设置→MANO组件版本号中选取正确的版本号，如图2所示。
NFVO Tenant Username|本参数用于设置NFVO的用户名称，是NFVO与VIM对接使用的用户名。
NFVO User Group|本参数用于设置NFVO的用户组名称，是NFVO与VIM对接使用的用户组。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。
VNFM Tenant Username|本参数用于设置VNFM的租户名称，是VNFM与VIM对接使用的用户名。
VNFM User Group|本参数用于设置VNFM的用户组，是VNFM与VIM对接使用的用户组 。如果使用用户组，则用户组必须已经关联用户，如果不使用用户组，则该参数配置为空。
VNFM VM Username|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的用户名。
VNFM VM Password|本参数用于设置使用SSH方式登录VNFM的虚机操作系统的密码。
NFVO OMM Username|本参数用于设置NFVO网管系统的用户名。
NFVO OMM Password|本参数用于设置NFVO网管系统的密码。
VNFM OMM Username|本参数用于设置VNFM网管系统的用户名。
VNFM OMM Password|本参数用于设置VNFM网管系统的密码。
NFVO OAM Net Name|本参数用于设置NFVO的网管网络平面（OAM）名称。
NFVO OAM Subnet Name|本参数用于设置NFVO的网管网络平面（OAM）子网名称。
NFVO OAM Floating IP|本参数用于设置NFVO的网管网络平面（OAM）浮动地址。
NFVO OAM Subnet IP Prefix|本参数用于设置NFVO的网管网络平面（OAM）子网地址前缀（不带掩码）。
NFVO OAM Subnet Mask|本参数用于设置NFVO的网管网络平面（OAM）子网掩码。
NFVO OAM Subnet Gateway IP|本参数用于设置NFVO的网管网络平面（OAM）子网网关地址。
VNFM OAM Net Name|本参数用于设置VNFM的网管网络平面（OAM）名称。
VNFM OAM Subnet Name|本参数用于设置VNFM的网管网络平面（OAM）子网名称。
VNFM OAM Floating IP|本参数用于设置VNFM的网管网络平面（OAM）的浮动IP地址。
VNFM OAM Subnet IP Prefix|本参数用于设置VNFM的网管网络平面（OAM）子网地址前缀（不带掩码）。
VNFM OAM Subnet Mask|本参数用于设置VNFM的网管网络平面（OAM）子网掩码。
VNFM OAM Subnet Gateway IP|本参数用于设置VNFM的网管网络平面（OAM）子网网关地址。
VNFM OAM Subnet Name DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网名称（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Floating IP DualStack|本参数用于设置VNFM的网管网络平面（OAM）浮动地址（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet IP Prefix DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网地址前缀（不带掩码）（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Mask DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网掩码（双栈）。如果不使用双栈，该参数不需要配置。
VNFM OAM Subnet Gateway IP DualStack|本参数用于设置VNFM的网管网络平面（OAM）子网网关地址（双栈）。如果不使用双栈，该参数不需要配置。
NFVO/VNFM & VIM Interface Protocol|本参数用于设置MANO与VIM对接协议类型。国内运营商场景：固定使用https。
NFVO/VNFM & VIM Authentication Type|本参数用于设置MANO与VIM对接鉴权方式。国内运营商场景：固定使Two-way Authentication
NFVO/VNFM Login Protocol|本参数用于设置登录MANO使用的协议类型。国内运营商场景：固定使用https。
图2  设置MANO版本号

##### VNF ID 
VNF ID页签用于配置需要通过AIC工具进行实例化部署的网元，本文档仅部署PCF网元，如[图1]所示。
图1  VNF ID页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VNF TYPE|该参数用于设置ZXUN RCP的网元类型。
ID|该参数用于设置ZXUN RCP的网元编号。用于标识网元名称及各种相关资源名称。需要根据运营商的规划来设置。
VNF Brief Name|此单元格的值是由VNF Type和ID两个参数设置后， 在本单元格自动引用生成的，需要操作员确认是否正确即可。如果需要修改，可以直接修改。
VNF Resource Prefix|该参数用于设置资源名称前缀，该前缀将作为虚机、云盘、端口等资源名称的一部分。运营商可以通过设置VNF Resource Name Prefix对ZXUN RCP使用的虚拟资源进行严格规范的命名，以便资源的统一管理。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。定义了命名规则后，对于在VNF实例化过程中创建的各种虚拟资源，系统都会按照规定进行命名。在运营商没有特殊要求的场景下，操作员可以自行定义名称。默认情况下，Global Setting页面的Resource Prefix参数设置后，此处自动引用，通常无需修改。
VNF APP ID|网元业务系统标识的关键部分。此处仅为模板提供的默认值，必须根据实际规划数据修改。中国移动填写移动数据：“所属省份标识+网元标识+网元序号+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahPCF001PCF001BZX。移动语音：“所属省份标识+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahPCF001BZX。移动物联网：“所属省份标识+网元标识+m+网元序号+网元标识+网元序号+网元属性+厂家标识”，中间没有"-"，如：ahPCFm001PCF001BZX。后续在LLD制作中，“VNF Advanced Settings”页面的虚机名称前缀参数直接引用此处配置。说明：VNF Resource Prefix参数和VNF APP ID参数长度总和需要小于等于38，虚机组名称总长必须小于等于62位。中国电信填写：“[网元标识+序号]-[网元属性]”，如：PCF03-B。后续在LLD制作中，“VNF Advanced Settings”页面的虚机名称前缀参数自动置空，不填写。说明：VNF Resource Prefix参数和VNF APP ID参数长度总和需要小于等于35，虚机组名称总长必须小于等于62位。中国联通填写：“[网元类型+序号]-[BC/B/C/专网名称]-[厂家缩写]”，如：PCF003-B-ZX。后续在LLD制作中，“VNF Advanced Settings”页面的虚机名称前缀参数自动置空，不填写。说明：VNF Resource Prefix参数和VNF APP ID参数长度总和需要小于等于38，虚机组名称总长必须小于等于62位。其他运营商规范确定后，按规范要求填写。
Bureau ID|该参数用于设置ZXUN RCP的局号。取值范围：1~255之间的整数，需要根据运营商的规划来设置。规划原则：在同一个NFVO之内的各个NF的局号不能相同。在一个大区内及其容灾大区内同一类型的NF的局号不能相同。在特殊情况下，如果同一类型的NF的个数超过255，只需要保证有容灾关系的NF的局号不相同即可。
是否实例化|该参数用于配置需要通过AIC工具进行实例化部署的网元，本文档仅部署PCF网元，需要将是否实例化设置为YES。
实例化时使用网络预留功能|该参数在SDN组网环境时，需要配置为YES。该参数设置为YES，表示后续在实例化ZXUN RCP的过程，不会创建VNF SDN Network Setting页签中设置为规划预留的网络，这些网络需要在实例化成功后，操作员在MANO上通过NS方式纳管VNF，根据需要进行创建。该参数设置为NO，表示后续在实例化ZXUN RCP的过程，不会创建VNF SDN Network Setting页签中设置为规划预留的网络，后续操作员在MANO上也无法进行创建。
Vm Extern Size|该参数用于配置是否启用ZXUN RCP虚机规格别名。虚机规格别名主要控制虚机内部名称，可以由运营商规划虚机的名称。该参数设置为disable：不启用。该参数设置为enable：启用。启用虚机规格别名时，可配置VM Parameters中的Vm Extern Size列，该列默认为空。若不填写，则使用系统默认虚机规格别名。若填写，则使用此处所填的虚机规格别名。同一虚机的不同规格不能取同样的别名。国内运营商部署场景：本参数需要设置为enable。
##### VNF Resource Prefix 
VNF Resource Prefix页签仅用于核对各类资源名称前缀是否正确，不需要操作员配置，如[图1]所示。
 说明： 
在VNF Resource Prefix页签中禁止操作员手工执行解锁表格，增加/删除行、列或随意修改内容等操作。
图1  VNF Resource Prefix页签
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### VNF Version 
VNF Version用于配置ZXUN RCP的版本号，请根据实际情况配置，如[图1]所示。
 说明： 
此处的版本为中兴通讯内部使用的版本号。 
版本号只能选择下拉列表中的版本，不能手动更改隐藏表增加选项。 
图1  VNF Version页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### VNF Scenario 
VNF Scenario页签主要选择本次部署的VNF所使用的场景，如[图1]所示。
图1  VNF Scenario页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VNF Scenario Name|该参数用于根据实际业务量设置ZXUN RCP的局类型，参见表2。该参数决定了ZXUN RCP所要部署的NFS、虚机的个数和规格等参数。当该参数配置为商用大规格(hg)时，需要配置Enable OMU MultiQ参数和Enable IPU MultiQ参数。
Share|该参数用于设置5GC网元是否以共享方式部署。TRUE共享方式部署，需要支持5G切片功能，被多个切片共享时，必须选TRUE。FALSE不共享方式部署。不需要被多个切片共享，或者仅属于某个专用切片中的网元，设置为FALSE。本参数设置为TRUE。
Enable OMU MultiQ|该参数用于设置是否启用OMU虚机网卡多队列。当需要提升网络性能时，可以启用该功能。使用该功能需要满足如下条件：TECS OpenStack为V6.10版本及以上版本。虚机镜像为P9版本及以上版本。“VNF Advanced Settings”中OMU虚机是否启用TECS私有参数配置为enable。
Enable IPU MultiQ|该参数用于设置是否启用IPI虚机网卡多队列。当需要提升网络性能时，可以启用该功能。使用该功能需要满足如下条件：TECS OpenStack为V6.10版本及以上版本。虚机镜像为P9版本及以上版本。“VNF Advanced Settings”中IPI虚机是否启用TECS私有参数配置为enable。
商用规格|适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活/去激活预埋服务
---|---|---|---|---|---|---|---
商用大规格(cmcc)|中国移动数据局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务激活Npcf_LogStoreUnit服务
中国移动语音局|商用大规格(cmcc)|无报表功能无热备容灾|有|无|无|无|无
中国移动物联网局点|商用大规格(cmcc)|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务激活Npcf_LogStoreUnit服务
商用大规格|中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF|有|有|无|无|激活Ncudr_Access服务
中国电信非UDSF局|商用大规格|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务去激活Ncudr_SystemManagement服务回收CDU虚机激活Ncudr_AccessManagement服务激活Ncudr_Access服务
国际通用局点|商用大规格|无报表功能无热备容灾|有|无|无|无|无
部分国际局|商用大规格|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务
商用小规格|部分测试局|无报表功能无热备容灾|有|无|无|无|无
部分测试局|商用小规格|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务
 说明： 
商用大规格(hg)场景目前仅用于测试，无商用场景。 
商用大规格和商用大规格(cmcc)的区别：商用大规格中OMU/AMU虚机的规格：内存为24 G，硬盘为110 G。商用大规格(cmcc)中OMU/AMU虚机的规格：内存为32 G，硬盘为410 G。 
 说明： 
ZXUN RCP产品V7.21.30版本后启用了“服务预埋”功能，即部署VNF时预埋Npcf_LOG服务、Npcf_LogStoreUnit服务和Ncudr_Access服务，默认不实例化，在需要该服务时再激活服务，具体操作参见“[激活预埋服务（可选）]”。
对于无UDSF的场景，需要去激活UDSF相关服务，具体操作参见“[去激活服务（可选）]”。
##### Tenant & User 
本页签用于配置ZXUN RCP所规划的Tenant（租户）和User（用户）信息，如[图1]所示。
 说明： 
Tenant & Users页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。如果VNF的LLD是与VIM的LLD同时规划的，则需要从ZTE NFV LLD(VIM) XX.xlsx表中获取。
租户租户又称为项目。ZTE TECS OpenStack以项目的方式实现各个虚拟网元之间虚拟资源的隔离。同一个VNF内的主机、网络等资源归属到同一项目。 
用户ZTE TECS OpenStack支持多用户接入，不同的用户，在ZTE TECS OpenStack上可以拥有不同的操作权限和资源访问范围，可以为每一个项目创建一个用户。当一个VIM云平台同时管理运营商的多个VNF时，为隔离不同运营商的VNF，需要使用不同的用户来接入。通常情况下，除了ZTE TECS OpenStack默认的用户之外，还需要为每个项目都创建一个用户。本文档规划为ZXUN RCP项目创建自己的用户。 
Tenant & Users页签如[图1]所示，需要配置的Tenant（租户）和User（用户）信息涉及到三种类型：
VIM云平台（本文档指中兴通讯的TECS OpenStack） 
ZXUN RCP需要根据运营商的要求进行配置。 
SDN仅SDN组网架构时，才需要配置。 
图1  Tenant和Users页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]和[表2]。
参数名称|参数说明
---|---
Tenant Name|TECS Provider|该参数用于配置ZTE TECS OpenStack的租户名称，默认值为admin。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
PCF|Tenant Name|该参数用于配置ZXUN RCP的租户名称，请根据实际规划进行配置。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Shared External Network for vRouters|Tenant Name|该参数用于配置SDN的租户名称。本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
User Group Name|PCF|该参数用于配置ZXUN RCP所要创建的用户组的名称。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Username|TECS Provider|该参数用于配置ZTE TECS OpenStack的用户名称，默认值为admin。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
PCF|Username|该参数用于配置ZXUN RCP的用户名称，请根据实际规划进行配置。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Shared External Network for vRouters|Username|该参数用于配置SDN的用户名称。本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Password|TECS Provider|该参数用于配置ZTE TECS OpenStack的用户密码。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
PCF|Password|该参数用于配置ZXUN RCP的用户密码。需要按照如下原则设置密码：长度8位以上至少包含一个大写字母至少包含一个小写字母至少包含一个特殊字符不能包含用户名不能包含键盘上的连续三位不能包含三位连续字符不能包含三位重复的字符
Shared External Network for vRouters|Password|该参数用于配置SDN的用户密码。本参数继承SDN侧的配置数据，需要和SDN侧的配置数据保持一致，在配置前请从SDN侧获取相关数据。
参数名称|参数说明
---|---
Enable VNF quota application|本参数的使用场景为：某些运营商要求，需要在MANO可以支持创建ZXUN RCP创建对应的项目，在创建项目（即租户）的同时，需要为项目分配资源，包括虚拟内核个数、内存大小、磁盘空间大小等虚拟资源。如果需要使用此功能，则此参数需要配置为YES。当本参数设置为YES时，需要依次配置下面三个参数。中国移动三期部署场景：本参数设置为YES，虚拟内核个数、内存大小、磁盘空间大小根据HLD规划填写实际配额。
VNF vCPU qouta (core)|表示为ZXUN RCP对应的租户（项目）分配的虚拟内核数量，该项目中启动的虚机的内核数总和不得超过该参数值。
VNF vRAM qouta (GB)|表示为ZXUN RCP对应的租户（项目）分配的虚拟内存数量。
VNF vStorage qouta (GB)|表示为ZXUN RCP对应的租户（项目）分配存储空间。
##### NTP Server 
NTP Server页签用于配置ZXUN RCP对应的NTP服务器，如[图1]所示。
 说明： 
通常情况下，使用EM作为ZXUN RCP的NTP服务器。本页参数无需修改。
图1  NTP Server页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### Volume Types 
Volume Types页签配置为ZXUN RCP规划的云硬盘类型名称，以及所使用的后端类型，如[图1]所示。
 说明： 
当Global Setting页签中的Storage
Type配置为CEPH或Disk Array时，才会出现该页签。
图1  Volume Types页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Volume Type Count|本参数用于设置ZXUN RCP的云硬盘类型个数。当ZXUN RCP需要部署存储QoS策略时，通常需要配置多个云硬盘类型，不同的云硬盘类型关联对应的存储QoS策略，并将不同的云硬盘类型关联到不同的虚机。存储Qos策略需要在“Storage QoS”页签中进行配置。当ZXUN RCP不需要部署存储QoS策略时，1个网元只需要1个云硬盘类型，该网元的所有虚机共用这个云硬盘类型。中国移动部署场景：本参数配置为3，即需要配置3个云硬盘类型。如图1所示，OMU虚机使用后缀为“-OMU-DISK”的云盘类型，LOG和LSU虚机使用后缀为“-LOG-DISK”的云盘类型，其他业务虚机使用后缀不带特殊标识的云盘类型。中国电信部署场景：本参数配置为1，即仅需配置1个云硬盘类型。
Volume Type Name|该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的ZTE TECS OpenStack）上创建的云硬盘对应的名称，用于给虚拟机分配数据存储空间。该参数引用VIM云管理平台已配置的名称，一般不建议修改。
Volume Backend|该参数是指在VIM云平台上创建云盘类型时，指定的存储后端。该参数是运营商操作员预先在VIM云平台（本文档指中兴通讯的ZTETECS OpenStack）上创建的。存储后端表示运营商使用磁阵或者Ceph来存储数据。配置时，需要注意：该参数为VIM云平台中（本文档指中兴通讯的TECSOpenStack）配置的存储池对应的存储后端的名称，而不是存储池的名称。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以根据中兴通讯的规范定义名称。
 说明： 
当修改了本页签中的Volume Type Count（云硬盘类型数量）、Volume Type Name（云硬盘名称）等参数后，需要同步修改“[Storage QoS]”页签、“[VM Parameters]”页签中各个存储QoS、虚机对应的云硬盘类型的数量和名称。
##### Storage QoS 
Storage QoS页签配置为ZXUN RCP规划的存储QoS策略，存储QoS策略是用于在VIM云管理平台上创建的云硬盘的读写策略。如[图1]所示。
运营商可以定义多个存储QoS策略，每个存储QoS策略都设置一个对应的名称，每个虚机都可以关联一个对应的存储QoS策略，该存储QoS策略可以对虚机对应的在VIM云管理平台上创建的云硬盘的读写策略进行限制。 
Storage QoS策略的实现原理为：本页签中定义的存储QoS策略会被Volume Types中定义的云硬盘类型关联、云硬盘类型被VM Parameters页签中定义的VNF虚机使用的云硬盘关联，最终体现为VNF虚机关联了存储QoS策略，相应的QoS策略生效。
 说明： 
如果运营商不使用后端存储设备，使用服务器主机的硬盘作为数据存储的设备的情况下，不需要配置本页签，即当Global Setting页签中的Storage Type配置为CEPH或Disk Array时，才会出现本页签。
图1  Storage QoS页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
QoS Policy Count|本参数用于设置ZXUN RCP的存储QoS策略的个数。规划了几个存储QoS策略供虚机使用，则此处就需要配置几个存储QoS策略。设置为0：表示ZXUN RCP不使用存储QoS策略。设置为非0的数字：表示ZXUN RCP使用存储QoS策略。通常情况下需要配置2个存储QoS策略，LOG和LSU虚机使用1个QoS策略，其他虚机使用1个QoS策略。
Storage QoS Policy Name|本参数用于设置ZXUN RCP的存储QoS策略的名称。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Volume Type Name|本参数用于设置当前QoS策略关联的云硬盘类型名称。该参数是指运营商操作员预先在VIM云管理平台（本文档指中兴通讯的ZTETECS OpenStack）上创建的云硬盘对应的名称。本参数继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。云硬盘类型与存储QoS策略是一对一的关系，即：每个云硬盘类型只能关联1个存储QoS，每个存储QoS只能关联到1个云硬盘类型。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称。
Total  Input/Output Bytes Per Second|总读写速度(字节/秒)，该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写速度。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
Total  Input/Output Bytes Per Second|总读写IOPS（次/秒），该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写IOPS。本参数继承VIM平台（本文档指中兴通讯的TECSOpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
##### VM Parameters 
VM Parameters页签主要填写VNF相关虚机的规格、最大个数、虚机归属的AZ域及HA、使用的云盘类型等信息，如[图1]所示。
 说明： 
一般情况下该页签保持默认不修改，严禁修改VM Count和VM Max Count列，如果虚机数量和售前HLD不一致，待实例化完成后，再对相应的虚机进行扩容操作，直至所有虚机数量和售前HLD保持一致。 
 说明： 
规划网络地址数据时，需要满足如下原则： 
规划内部网络平面的CIDR地址段中可用地址数量不小于所有虚机最大数（VM MAX Count）的总和。 
规划IPU的外部网络平面的CIDR地址段中可用地址数量不小于所有IPU虚机最大数。 
需要检查隐藏表，是否已启用了虚机规格别名的修改。如果隐藏表中已启用虚机规格别名，并且虚机规格别名是大写并符合规范的，则不需要修改，反之需要修改。 
图1  VM Parameters页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
在配置本页面前，需要先了解ZXUN RCP的VM规划数据，参见[表1]。
VM|描述
---|---
OMU|对接CN-OAM（核心网集中网管），管理整局上电、版本加载、配置同步、网管命令执行、告警和性能统计汇总、各服务弹缩控制等功能。
CDU|UDSF数据存储单元。
GSU（HTTP LB）|HTTP负荷分担服务，实现HTTP协议消息分发。
GSU（SIG LB）|信令负荷分担服务，实现Diameter和SMS消息分发。
GSU（PolicyControl）|处理PCF和PCRF业务逻辑，提供AMPolicyControl、UEPolicyControl、SMPolicyControl和PolicyAuthorization服务。
GSU（GW）|UDSF统一接入网关。
IPU|IP接口虚拟机，收发IP承载的控制面信令和用户面报文。
LOG|策略日志单元，产生策略日志并存入云盘或LSU，并可通过FTP/SFTP上传给外部服务器。
LSU|策略日志存储单元，用于策略日志分析。
ZXUN RCP各个虚机类型的参数配置说明参见[表2]。
虚机类型|参数配置说明
---|---
CDU|CDU虚机的VM Count建议保持默认值。如果ZXUN RCP在后续使用过程中不再需要已部署的CDU虚机，则参见“去激活服务（可选）”，去激活Ncudr_Access服务和Nudsf_UnstructuredDataManagement服务，回收CDU虚机。
GSU|GSU虚机分别配置GSU (HTTP LB)、GSU (PolicyControl)、GSU (SIG LB)和GSU (GW)虚机类型。以图1为例，在商用大规格场景下，GSU各个虚机类型与虚机规格（VM Flavor）的对应关系如下：GSU (HTTP LB)：GSU-Common-C8GSU (PolicyControl)：GSU-Common-C8M32GSU (SIG LB)：GSU-C8-NGSU (GW)：GSU-CGW-C8其中，GSU (GW)虚机类型的VM Count需要配置为0。如果运营商有热备容灾功能，且内置UDSF，则需要参见“激活预埋服务（可选）”，在实例化后激活预埋的Ncudr_Access服务。
LOG|若运营商选择的部署场景涉及LOG虚机，则VM Count配置为0，且在ZXUN RCP实例化后参见“激活预埋服务（可选）”，激活预埋的Npcf_LOG服务。
LSU|若运营商选择的部署场景涉及LSU虚机，则VM Count配置为0，且在ZXUN RCP实例化后参见“激活预埋服务（可选）”，激活预埋的Npcf_LogStoreUnit服务。
参数说明参见[表3]。
参数名称|参数说明
---|---
VM Flavor|本参数用于设置ZXUN RCP虚机的规格，包括：vCPU：CPU核数Memory (GB)：内存数Local Storage(GB)：本地存储Remote Storage(GB)：远端存储这些参数不需要操作员配置，是由“VNF Scenario”页签中的参数VNF Scenario Name决定的。
VM Count|本参数根据“VNF Scenario”中选择的场景可以得到默认值，严禁修改。如果虚机数量和HLD规划不一致，待实例化完成后，可参考“配置虚机弹扩”对相应的虚机进行扩容操作，直到所有虚机数量和HLD规划数据一致。
VM MAX COUNT|本参数根据“VNF Scenario”中选择的场景可以得到默认值，严禁修改。如果虚机数量和HLD规划不一致，待实例化完成后，可参考“配置虚机弹扩”对相应的虚机进行扩容操作，直到所有虚机数量和HLD规划数据一致。
Availability Zone|本参数用于设置ZXUN RCP虚机所属的可用域（Availability Zones）的名称。本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪个可用域（Availability Zones），就配置为哪个可用域（AvailabilityZones）的名称。
Host Aggregate Metadata|本参数用于设置HA元数据属性。本参数的取值是通过Host Aggregate页签配置的，参见“Host Aggregate”。虚机需要部署在哪种HA元数据属性的主机上，就配置为对应的HA元数据属性。
Anti-affinity Policy / Factor|本参数用于设置Anti-affinity Policy（反亲和策略）或者Anti-affinity Factor（反亲和因子）。ZXUN RCP只涉及到配置Anti-affinity Policy（反亲和策略）。本参数用于控制是否将一个虚拟机组（Server-group）中的多个同种类型的虚机（例如OMU虚机）分别部署在不同的主机上。包括如下选项：no_limitation不限制。表示系统不对虚机部署进行限制，即同种类型的虚机可以任意部署在任意的主机上（比如可以全部部署在一台主机上）。anti_affinity反亲和。设置为此选项，表示系统需要对虚机将基于主机进行部署限制，即一个虚拟机组（Server-group）中的多个同种类型的虚机必须分散部署在ZXUN RCP所在可用域（Availability Zones）的不同主机上。设置为本参数后，操作员还可以通过反亲和组名来设置互斥组的名称。soft_anti_affinity软反亲和。设置为此选项，表示系统需要对同种类型的虚机基于主机进行部署限制。在计算资源充足的情况下，虚拟机必须部署在不同主机（计算节点）上。在计算资源不足情况下，尽可能将这些虚拟机部署在不同的主机（计算节点）上，避免剩余的虚机无法部署。OMU/AMU/IPU/CDU虚机建议配置为anti_affinity，其他虚机建议配置为soft_anti_affinity。
antiAffinity VMNumber|本参数表示反亲和组内虚机最大个数，建议保持默认值。
dedicated|本参数用于设置虚机使用的亲和策略是否由专用插件管理。CDU虚机使用的亲和策略由专用插件管理，建议保持默认值。
Accel Resource Policy|本参数用于设置虚机使用的加速资源策略，建议保持默认值。
Backup Instance Number|本参数用于设置同一批次允许下电的虚机个数或者虚机比例。若本参数配置为比例值，则取值为单批次允许下电的虚机数占用当前虚机数的比例。
VM Volume Type|本参数用于设置ZXUN RCP的虚机使用的云硬盘类型。本参数的取值是通过Volume Types页签配置的。当在Volume Types页签中为ZXUN RCP设定了多个云硬盘类型时，在本表格的下拉框中可以进行选择，参见“Volume Types”。
Priority of VM creation|本参数用于设置在实例化过程中，创建虚机资源的优先级，数字越小表示优先级越高。建议所有的虚机都使用默认值1，即所有的虚机的优先级都为最高，表示在实例化ZXUN RCP的过程中，会并行创建所有虚机及相关资源。
Priority of VM restart|本参数用于设置虚拟机启动上电的优先级。取值范围为1~10，数值1表示优先级最高，数值10表示优先级最低。虚拟机启动上电时，虚拟机所在的服务器根据虚拟机对应的优先级进行处理，将优先级高的虚拟机先上电，将优先级低的虚拟机后上电， 一般情况下，建议将OMU优先级设置为1。
Vm Extern Size|本参数用于设置虚机规格别名。当VNF ID中的Vm Extern Size参数设置为enable时，表示启用虚机规格别名。虚机规格别名主要控制虚机内部名称。同一虚机的不同规格不能取同样的别名，保持默认值即可。
Qos Policy Name of MGT|本参数用于设置MGT网络的QoS策略，保持默认即可。
Qos Policy Name of SERVICE|本参数用于设置SERVICE网络的QoS策略，保持默认即可。
Qos Policy Name of EMS/EXT|本参数用于设置EMS/EXT网络的QoS策略，保持默认即可。
Flexible Resource Policy|本参数用于设置灵活的资源策略，保持默认即可。
##### VRF Summary 
VRF Summary用于配置交换机侧的VRF和VNF侧的VRF，如[图1]所示。
本页签的配置原则如下： 
本页签默认包括了所有类型的NF可能涉及到的所有的VRF。一般情况下，操作员不需要删除原有默认的VRF，如果默认的VRF不适用，可以根据实际情况在用户自定义VRF1中进行新增即可。
 说明： 
该页签无效，AIC不会读取该页签数据，保持默认值即可。中移物联网七期增加EDGE和SMS VRF。 
图1  VRF Summary页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
默认的VRF参数说明参见[表1]。
类别|VRF名称（示例）|说明
---|---|---
业务交换机侧需要配置的VRF|mng|交换机管理口内置VRF。
EMS|业务交换机侧需要配置的VRF|用于ZXUN RCP与EMS通信。
SIG|业务交换机侧需要配置的VRF|用于ZXUN RCP与不同业务域网元间信令互通。
NF侧需要配置的VRF|SBI|用于ZXUN RCP与5G网络中的SBI接口。在5G标准规范的系统架构中引入了服务化接口（即SBI）的概念，来表述一个NF提供其所具有的服务（或服务集合）给其他的NF使用的方式，在5G标准中一般采用Nxxx（如Namf，Nudm等）的方式表达。
EMS|NF侧需要配置的VRF|用于ZXUN RCP与EMS通信。
SIG|NF侧需要配置的VRF|用于ZXUN RCP与不同业务域网元间信令互通。
##### VNF Network Qos 
VNF Network Qos页签用于配置ZXUN RCP的网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略，如[图1]所示。
 说明： 
该页签不修改，保持默认值，中移三期将使用20种网络QoS。 
图1  VNF Network Qos页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
Qos Policy Count|本参数用于设置ZXUN RCP的网络Qos策略的个数。规划了几个网络QoS策略供虚机使用，则此处就需要配置几个网络QoS策略。设置为0：表示ZXUN RCP不使用网络QoS策略。设置为非0值：表示ZXUN RCP使用的网络QoS策略数量，需要在VNFNetwork Setting或VNF Network Setting IPv6页签中修改网络QoS策略最大带宽值。
Network Qos Policy Name|该参数用于设置ZXUN RCP的网络QoS策略的名称。运营商可以定义多个网络QoS策略，每个网络QoS策略都设置一个对应的名称，每个虚机都可以配置一个对应的网络QoS策略，该网络QoS策略可以对虚机中的各个网卡进行限制。在某些运营商对名称有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以根据中兴通讯的规范定义名称。
Max Egress Bandwidth (kbps)|（出口）双向最大带宽，该参数用于配置硬件服务器网卡出口的双向最大带宽。
Max Egress Bandwidth (kbps)|（出口）双向最大突发带宽，该参数用于配置硬件服务器网卡出口的双向最大突发带宽。
Max Ingress Bandwidth (kbps)|（入口）双向最大带宽，该参数用于配置硬件服务器网卡入口的双向最大带宽。
Max Ingress Burst Bandwidth (kbps)|（入口）双向最大突发带宽，该参数用于配置硬件服务器网卡入口的双向最大突发带宽。
 说明： 
ZXUN RCP在此处设置是否启用网络Qos功能，启用后，需要在VNF
Network Setting或VNF Network Setting IPv6页签中修改网络Qos策略最大带宽值。
##### VNF Network Setting IPv6 
VNF Network Setting IPv6配置为ZXUN RCP规划的网络平面相关信息，如[图1]所示。
如果在Global Setting页签中，将Network
Type设置VLAN，将VNF IP Type设置为IPv4，此处的页签名称为VNF Network Setting。 
如果在Global Setting页签中，将Network
Type设置VLAN，将VNF IP Type设置为IPv6，此处的页签名称为VNF Network Setting IPv6。 
 说明： 
当Global Setting页签中的Network Type配置为VLAN时（表示ZXUN RCP使用非SDN组网架构），操作员才需要配置此页签。
图1  VNF Network Setting IPv6页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
 说明： 
在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。 
参数说明参见[表1]。
参数名称|参数说明
---|---
VNF Brief Name|本参数为网元简称。
Tenant|本参数为NF对应的租户。
Network Usage|ZXUN RCP的各个网络平面的网络用途规定如下：内部控制面需要设置为INTERNAL MGT（内部管理通信）内部媒体面需要设置为INTERNAL SERVICE（内部服务通信）所有的外部网络平面需要设置为EXTERNAL（外部业务通信）ZXUN RCP的网管平面的设置原则如下：OAM (Used OAM network of VNFM)ZXUN RCP的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行二层互通。OAM (Used Shared IPv4 OAM Subnet)ZXUN RCP的OAM平面（即网管平面）使用已存在的多网元共享的OAM网络平面（非VNFM的OAM平面）与VNFM进行三层互通。OAM (Create individual OAM network)ZXUN RCP的OAM平面（即网管平面）使用独立创建的网络平面与VNFM进行三层互通。ZXUN RCP的网管平面需要区别IPv4和IPv6分别设置。
Share type|本参数用于配置网络平面是否共享。
Transparent|本参数用于配置网络透传模式。True：透传False：不透传参见以下原则进行配置：当NFVI启用QinQ功能时，需设置为True。对于网元内部网络平面，默认采用非透传模式，不可修改。对于业务外部网络平面需要使用透传模式时选择True，需要使用非透传模式时选择False。
vNIC Type|本参数用于配置业务虚机的网卡类型。normal：表示虚机的网卡启用OVS/DVS。SR-IOV：表示虚机的网卡启用SR-IOV。
Network Deployment|本参数用于配置ZXUN RCP的网络平面是事先通过TECS OpenStack创建的，还是由操作员直接在LLD中配置的。对于所有的NF共用的网管平面，在部署ZXUN RCP之前，如果已经创建成功，则网管平面需要配置为当前已存在。本次实例化如果操作员直接通过LLD创建ZXUN RCP的网络平面，则需要配置为本次实例化。当前已经存在表示LLD中配置的网络平面，操作员已经预先通过TECS OpenStack创建成功，LLD表格中填写的网络平面名称需要从TECS OpenStack处查询获取。
Brief Net Name|ZXUN RCP的网络平面的简称。需要新增网络平面时，在红色底纹的空行处，在此列填写一个简要名称，就会自动增加一行网络平面，再选择对应的vNICType、填写相应的网段、VLAN信息。
Neutron Net Name|该参数用于设置网络平面的名称。根据规划的数据进行创建。
VLAN ID|对于透传网络（Transparent为True），必须设置VLAN范围，即需要配置起始VLAN、终止VLAN和NativeVLAN。对于非透传网络（Transparent为False），在规划的交换机的VLAN ID范围内，选择一个VLANID。
Begin VLAN|对于透传网络（Transparent为True），需要配置。
End VLAN|对于透传网络（Transparent为True），需要配置。
Native VLAN|对于透传网络（Transparent为True），需要配置。
Neutron Subnet Name|该参数用于设置网络平面子网的名称。根据规划的数据进行创建。
Subinterface Count|本参数用于配置子接口个数。在网络透传模式下才需要填写此参数，表明对应网络平面生成的接口下规划多少个子接口。
Subinterface Name|不需要填写。
VNF Side VRF|不需要填写。
Switch Side VRF|不需要填写。
A-H|本参数用于配置每个网络平面的IPv6地址，注意D为VLAN ID。根据组网规范的IPv6地址填写。
MASK|本参数用于配置每个网络平面的掩码。根据需要确定掩码大小。
Subnet CIDR|此列由工具自动生成。注意检查此列，确定填写的地址是否正确。在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。
Gateway IP|本参数用于配置网关IP地址。当VNFM和VNF平面使用三层互通时，需要根据现场规划填写网关IP地址。
MTU|该参数表示VNF的MTU数值。如果运营商没有特殊要求，则内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。如果运营商对MTU有特殊要求，则需要根据运营商的规范进行设置。
Network Qos Policy Name / Value|本参数用于配置每个网络平面的网络QoS策略，需要根据规划配置。
Physical Network|该参数用于设置此网络平面对应的物理网络名称，根据规划数据，VNF的项目所有网络平面对应的物理网络名称都规划为physnet1。
Security group|本参数用于配置网络平面的安全组名称。需要根据规划配置。安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（SecurityGroup Rule）。配置该参数，需要事先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组。
##### VNF Vlan Trunk IP 
配置原则 :VNF Vlan Trunk IP页签用于配置IPU虚机的IP地址范围。
该页签保持默认值不修改，PortIpList保持为空不填写。 
配置说明 :VNF Vlan Trunk IP页签如[图1]所示。
本页签配置的IP地址是为实例化成功后，系统为IPU虚机分配的IPv4或IPv6地址。
图1  VNF Vlan Trunk IP

##### VNF O&M IPv6 
本页签用于修改ZXUN RCP的操作维护网段的公网及浮动IP地址，如[图1]所示。
 说明： 
在本页签中，仅需要修改H列的内容，H列根据C列地址段范围内前三个地址按顺序填写，对于VNF O&M IPv6页签中其他参数，取值为固定值，操作员不需要修改。
图1  VNF O&M IPv6页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
##### VNF Advanced Settings 
VNF Advanced Settings页签用于设置ZXUN RCP的属性，如[图1]所示。
图1  VNF Advanced Settings页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
业务系统名称|本参数用于设置ZXUN RCP实例化成功后，在MANO上看到的ZXUN RCP的名称。在某些运营商对命名有特殊规范要求的情况下，需要按运营商的规范进行配置。在运营商没有特殊要求的场景下，操作员可以自行定义名称，名称中不能包含“.”。|业务系统名称
蓝图包名称|本参数用于设置在MANO上快速创建ZXUN RCP的版本包时，配置的新包名称，需根据运营商规范配置。|蓝图包名称
蓝图包版本号|本参数用于设置在MANO上快速创建ZXUN RCP的版本包时，配置的新包的版本号。此处配置的是交付运营商的软件包的对外版本号。不是中兴通讯内部的版本号。|蓝图包版本号
蓝图包厂商|本参数用于设置在MANO上快速创建版本包时，设置的厂商名称。中国联通场景，本参数需要设置为ZX。中国移动场景，本参数需要设置为ZT。中国电信场景，本参数需要设置为ZE。其他场景，本参数需要设置为ZTE。|蓝图包厂商
镜像包名称|本参数用于设置导入到MANO中，显示的CGSL镜像包的名称，需要根据实际包中的resource.meta里的Name字段填写。|镜像包名称
接入的EMS地址|本参数用于配置VNF部署后，需要接入的EMS地址。实例化VNF时，会将该地址传给VNFM，在实例化VNF完成后由VNFM将VNF自动接入指定的EMS。该功能需VNFM上提前打开功能开关。|接入的EMS地址
所属地域|本参数用于设置ZXUN RCP归属的地域，在某些特殊运营商的要求下，才需要配置。配置原则：归属省份，如果ZXUN RCP归属的地区是广州市，那么该参数配置为广东。|所属地域
分权网元类型|本参数用于设置ZXUN RCP的网元类型，在某些特殊运营商的要求下，才需要配置。需根据运营商规范配置。|分权网元类型
虚机名称前缀|在某些特殊运营商的要求下，才需要设置此参数，需要根据规范配置：所属省份标识+网元标识+网元序号+网元属性+厂家标识，示例：JS-PCF-100-A-ZX命名规范格式如下所示，分为多个部分，每个部分之间用短横线-连接：网元归属省/大区：由2-3位英文字母组成，示例：JS网元标识：由1-8位英文字母组成，示例：PCF网元序号：由1-3位数字组成，示例：100网元属性：两个取值，A表示骨干，B表示省内。厂家标识：由2-3位英文字母组成，示例：ZX|虚机名称前缀
云主机类型命名规则|命名规则1：ram_x_vcpus_x_disk_x_uuid在运营商没有特殊要求的情况下，默认使用此种规则命名规则2：资源前缀-FLA-自定义IDGlobal Setting页签中Application scenarios设置为12-CMCCPhase2、11-CMCC Phase1和1-5GS三种场景之一时，使用此种规则。|云主机类型命名规则
镜像可视性|该参数用于设置ZXUN RCP的虚机操作系统镜像的属性，一般配置为private（私有），在特殊情况下，才需要配置为public（共享）。publicprivatesharedcommunity国内运营商场景：固定配置为private。|镜像可视性
启用密文传输敏感数据|本参数通常情况下，建议设置为enable，启用此功能后，VNFD版本包插件的内容中不会有明文密码等敏感信息，系统会进行加密处理。国内运营商场景：固定配置为enable。|启用密文传输敏感数据
对接VNFM的IP地址版本|该参数用于设置NF对接VNFM的IP地址版本，根据实际组网规划配置。|对接VNFM的IP地址版本
vnf和vnfm间会话协议类型|该参数用于配置VNF和VNFM之间的会话协议类型，VNF和VNFM之间支持双向认证，配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为http。如果运营商的部署环境，开启了安全加固功能，则此参数配置为https。国内运营商场景：固定配置为https。|vnf和vnfm间会话协议类型
vnf向vnfm获取token|该参数用于设置VNF是否可以向VNFM获取token。token是计算机术语，表示令牌的意思，令牌是一种能够控制站点占有媒体的特殊帧，以区别数据帧及其他控制帧。通俗的说法，token可以称为暗号，在一些数据传输之前，服务端和客户端之间要先进行暗号的核对，不同的暗号会被授权不同的数据操作权限。Token是在服务端产生的。如果客户端使用用户名/密码向服务端请求认证，服务端认证成功，那么服务端会给客户端返回一个Token。客户端可以在每次发起请求消息时，携带Token证明自己的合法地位。该参数的配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为不启用。如果运营商的部署环境，开启了安全加固功能，则此参数配置为启用。|vnf向vnfm获取token
vnf向vnfm获取token的用户名|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其他的用户，具体操作参见“在VNFM上创建用户”。需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。|vnf向vnfm获取token的用户名
vnf向vnfm获取token的密码|当vnf向vmfm获取token设置为启用时，还需要设置两个参数vnf向vmfm获取token的密码和vnf向vmfm获取token的用户名。VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其他的用户，具体操作参见“在VNFM上创建用户”。需要注意：接入VNFM的所有的网元都可以共用VNFM用户，不需要每个网元都建立各自对应的VNFM用户，在配置此参数前，需要先查询已经配置好的VNMF用户和密码。|vnf向vnfm获取token的密码
镜像看门狗超时措施|本参数用于设置启用镜像watchdog功能后，自动触发的动作（watchdog_action）。ZXUN RCP定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。国内运营商场景：固定配置为reset。|镜像看门狗超时措施
虚机看门狗超时措施|本参数用于设置启用虚机watchdog功能后，自动触发的动作（watchdog_action）。ZXUN RCP定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。国内运营商场景：固定配置为none。|虚机看门狗超时措施
虚机看门狗监控时长(分钟)|该功能用于设置虚机看门狗超时（watchdog_enabledelay）时长，默认值为600000毫秒，即10分钟。通常情况下建议使用默认值。该时长是VM启动后，到首次喂狗动作之间的时间间隔，如果超过这个间隔没有进行喂狗操作，则会触发watchdog_action的动作。如果虚机看门狗触发动作（watchdog_action）配置为reset，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM会主动复位虚机。如果虚机看门狗触发动作（watchdog_action）配置为none，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM不会执行复位虚机的操作。|虚机看门狗监控时长(分钟)
OMU虚机MGT平面端口的网络Qos|该参数表示OMU虚机的MGT平面端口的网络QoS值。此处如果为空值，则取对应MGT网络平面的网络QoS值。|OMU虚机MGT平面端口的网络Qos
其他虚机的端口QoS配置数据参见OMU虚机MGT平面端口的网络QoS参数说明。|其他虚机的端口QoS配置数据参见OMU虚机MGT平面端口的网络QoS参数说明。|其他虚机的端口QoS配置数据参见OMU虚机MGT平面端口的网络QoS参数说明。
OMU虚机|cpu_model参数|对应flavor中的hw:cpu_model参数。不同种类的虚机可以根据实际部署时使用的计算节点CPU类型进行配置。配置该参数之前，需要在TECS OpenStack控制节点上，通过命令查询虚机部署使用的计算节点的cpu信息，示例：source keystonerc_admin nova hypervisor-show Computer0102 |grep cpu_info_model Haswell
mem_page_size参数|OMU虚机|该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。small：选择使用小页。large：选择使用巨页。1048576：选择使用1048576的页面。1GB：选择1GB的页面。该参数建议采用默认值1GB。
trait_required参数|OMU虚机|该参数提供给虚拟层平台自定义扩展使用，实际部署时与平台协商约定。例如，平台可以定义使用某个字符串代表本虚机必须部署在哪些主机上。如平台无要求，该参数可以保持默认值空。
trait_forbidden参数|OMU虚机|该参数提供给虚拟层平台自定义扩展使用，实际部署时与平台协商约定。例如，平台可以定义使用某个字符串代表本虚机禁止部署在哪些主机上。如平台无要求，该参数可以保持默认值空。
是否启用TECS私有参数|OMU虚机|如果VIM云管理平台使用中兴通讯的TECS OpenStack，则该参数建议设置为启用。如果VIM云管理平台使用第三方厂家的系统，则该参数建议设置为不启用。
其他虚机的配置数据参见OMU虚机的参数说明。|其他虚机的配置数据参见OMU虚机的参数说明。|其他虚机的配置数据参见OMU虚机的参数说明。
是否实例化CGW|该参数用于配置是否实例化CGW。disable：ZXUN RCP享受其他运营商提供的CGW服务。enable：ZXUN RCP自身提供CGW服务。|是否实例化CGW
UDSF配置信息|租户id|该参数用于唯一标识一个租户。保持默认值。
租户名称|UDSF配置信息|该参数用于配置租户名称。保持默认值。
初始数量|UDSF配置信息|该参数用于配置初始启动的CDU虚机数。保持默认值。
最大数量|UDSF配置信息|该参数用于配置最大的CDU虚机数。保持默认值。
虚机规格|UDSF配置信息|该参数用于配置CDU虚机的规格。保持默认值。
主用NF|UDSF配置信息|该参数用于配置租户对应的主用NF标识。保持默认值。
备用NF|UDSF配置信息|该参数用于配置租户对应的备用NF标识。保持默认值。
CGW配置信息|最大数量|该参数用于配置CGW节点的最大数量，需要根据实际的规划来设置。
虚机规格|CGW配置信息|保持默认值。
是否启用删除虚拟机不删除数据盘|各个虚机的该参数配置保持默认值。|是否启用删除虚拟机不删除数据盘
##### Capabilities Flows 
Capabilities Flows页签用于配置是否下发各个虚机的流表容量参数给VIM，如[图1]所示。
图1  Capabilities Flows

参数说明参见[表1]。
参数名称|参数说明
---|---
是否下发流表容量|本参数适用于VIM平台使用中兴通讯自研的TECS OpenStack的场景，在配置此参数前，需要操作员确认TECS OpenStack的版本是否支持流表，如果TECS OpenStack不支持，则此参数需要配置为disable，否则会报错。在实际环境中，如果当前的TECS OpenStack支持流表，且规划了ZXUN RCP需要将流表容量参数下发给VIM，则本参数需要配置为enable。同时，需要将VNF Advanced Settings中各虚机的是否启用TECS私有参数设置为enable。在实际部署过程中，ZXUN RCP会将本表格中的参数流表容量值配置的数据，下发给VIM。中国移动三期部署场景：本参数设置为enable，且仅需设置IPU虚机的流表容量值为40000，其余虚机流表容量值保持默认值为3000。
##### Version File 
Version File页签用于配置ZXUN RCP的版本文件名称，如[图1]所示。
图1  Version File页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
FileName|本参数用于配置版本文件的名称，包括以下文件：基础包：pcf_vnfd.VXXX.csar业务软件包：PCF_VXXX.zip镜像包：cgsl.YYY.zipAIC插件包：aic-plugin-pcf-v*.zip
XXX表示ZXUN RCP具体的版本号，以实际版本为准。
YYY代表对应VIM云平台管理系统（如TECS OpenStack）版本号，以实际版本为准。 
##### Image Setting 
Image Setting页签用于配置在实例化ZXUN RCP过程中，是否使用镜像包名称自动修改功能。
自动修改镜像包名称功能是指通过MANO上传、导入镜像包后，MANO根据该页签参数设置值自动修改镜像包的名称和属性。 
当启用自动修改镜像包名称功能时，要求TECS OpenStack平台上没有重名镜像包。如果此前有一个镜像包未改名而且已被注册使用，那么后续相同名称的镜像包就无法上传也无法修改，将会导致ZXUN RCP实例化失败。
此时，需要参考“[修改镜像文件名称]”操作，手工修改镜像包名称。
中国移动三期要求启用自动修改镜像包名称功能，不采用手工镜像改名方式。 
 说明： 
此处的镜像包是指创建虚机时使用的CGSL操作系统镜像文件包（通常以cgsl.vXXX.zip的形式命名，包含操作系统和双机软件）。
Image Setting页签如[图1]所示。
图1  Image Setting

参数说明参见[表1]。
参数名称|参数说明
---|---
Enable Image Name Modification|本参数需要根据运营商的情况进行配置。如果运营商对镜像包名称有特殊要求，需要根据运营商的命名规范来修改镜像包的名称，本参数需要配置为YES。若配置为YES，则需要同时配置下面CGSL相关参数。如果运营商对镜像包名称没有特殊要求，操作员可以使用默认值 ，则本参数需要配置为NO。中国移动三期部署场景：本参数建议设置为YES，采用自动修改镜像包名称功能。
CGSL Package name|本参数用于修改CGSL镜像包名称，对应CGSL镜像包的resource.meta文件中的Name参数。
CGSL Package version|本参数用于修改CGSL镜像版本号，对应CGSL镜像包的resource.meta文件中的Version参数。
CGSL Image name|本参数用于修改CGSL镜像文件名称，对应CGSL镜像包的resourceList.json文件中的name参数。
CGSL file_url|本参数用于修改CGSL镜像文件相对于包根目录的URL路径，对应CGSL镜像包的resourceList.json文件中的file_url参数。
CGSL Image tags|本参数用于修改CGSL镜像标签，如： tag1,tag2,tag3。
CGSL hw_disk_bus|本参数用于修改CGSL镜像的磁盘总线类型。建议保持默认值。
CGSL hw_scsi_model|本参数用于修改CGSL镜像的scsi模式。建议保持默认值。
CGSL hw_watchdog_action|本参数用于设置是否启用镜像看门狗，对应CGSL镜像包的resourceList.json文件中扩展属性的hw_watchdog_action参数。
##### VNF SFTP Server 
VNF SFTP Server页签用于配置ZXUN RCP的SFTP服务器信息，如[图1]所示。
图1  VNF SFTP Server页签示例
浅蓝色底，白色字体。是红色标签的表格头部样式。 
无底色，黑色字体。默认格式，单元格的值是固定的，其内容不得修改。 
橙色底，红色字体。需要操作员进行配置的参数或者确认默认值是否正确。 
橙色底，红色字体。带有批注信息的橙色底色单元格。请特别关注批注内容，按批注要求填写单元格。 
绿色底，红色字体。根据选择的应用场景而相对固化不需要操作员修改默认值的单元格。目前主要用于中国移动一期资源池场景。 
无底色，蓝色字体。单元格的值是由其他参数设置后，在本处自动引用生成的，如果需要改变，只能去修改其引用的相关参数，本处不能直接修改。 
参数说明参见[表1]。
参数名称|参数说明
---|---
SFTP server IPv4/IPv6 address|本参数用于设置上传、导入版本包时使用的SFTP服务器IP地址。此处需要配置可以和NFVO的网管平面互通的IP地址。存放在SFTP服务器的软件，需要通过FTP方式上传至NFVO服务器的指定路径下，所以SFTP服务器的地址，是需要与NFVO的网管网络平面互通的地址。
SFTP username|本参数用于设置访问SFTP服务器的用户名。默认用户名为root。
SFTP password|本参数用于设置访问SFTP服务器的密码。默认的密码为CloudStudio__123，其中__为两个下划线。
Path|本参数用于设置FTP服务器上存放ZXUN RCP的基础包路径，此处需要设置为绝对路径。可设置为基础包的具体文件所在路径或上一级目录。设置为目录时，可上传该目录下的所有软件包。此路径需要开通可写权限，此路径在部署ZXUN RCP前需要已经存在。
Delete version packages after successful deployment|本参数用于配置ZXUN RCP部署成功后，是否自动删除SFTP服务器上的版本包。YES：删除如果临时使用VNFM为SFTP服务器，建议删除。NO：不删除如果后续还会部署相同版本的ZXUN RCP时，建议不需要删除，后续操作可以继续五个他当前版本包。
##### TAP Service和TAP Flow（可选） 
配置原则 :TAP Service和TAP Flow页签用于配置流镜像相关的数据。
流镜像是VIM云平台（本文档指中兴通讯的TECS OpenStack）中的neutron组件实现的一种网络端口镜像的功能，可以对网络流量进行监控，在网络出现问题时，维护人员通过流镜像可以快速发现和定位故障。 
配置流镜像，是指把某个虚机（源虚机）的报文复制到其他虚机（目的虚机）的网卡或者物理交换机端口。 
在运营商使用了流镜像功能的场景下，才需要配置TAP Service和TAP Flow页签。
如果运营商没有使用流镜像功能，则操作员可以将这两个页签中默认的数据全部删除；也可以在执行VNF部署时不勾选PCF配置TAAS部署功能项，参见“[自动部署VNF]”。
 说明： 
TAP Service和TAP Flow页签中的参数，全部继承VIM平台（本文档指中兴通讯的TECS OpenStack）侧的配置数据，需要和VIM侧的配置数据保持一致，在配置前请从VIM侧获取相关数据。
配置说明 :TAP Service页签如[图1]所示。
图1  TAP Service

TAP Flow页签如[图2]所示。
图2  TAP Flow

参数说明参见[表1]。
参数名称|参数说明
---|---
TAP Service Name|本参数用于配置目的虚机网卡和物理交换机端口，即抓包端口。
TAP Flow Name|本参数用于配置源虚机的端口，即需要镜像报文的端口。可以指定镜像的报文方向和使用的流镜像过滤器。
#### 导出LLD 
摘要 :本节介绍导出LLD的操作过程。 
步骤 :VNF LLD Template PCF.xlsm中的所有的页签配置完成后，切换到Run页签，如[图1]所示。
图1  Run页签

单击生成VNF规则数据，弹出提示框，如[图2]所示。
图2  提示框

单击是，开始自动生成VNF规则数据，等待结束后，回到ZXUN AIC(iDevise)(WPS版).xlsm页面，如[图3]所示。
图3  ZXUN AIC(iDevise)(WPS版).xlsm页面

单击右上方的Next，出现Output LLD页签，如[图4]所示。
图4  Output LLD页签

单击下方的Output按钮，在ZXUN AIC(iDevise)(WPS版).xlsm文件同级目录下会生成最终的LLD，名字为ZTE NFV LLD(PCF) XXXX.xlsx（XXXX为首页输入的Project Name)。本文档示例为ZTE NFV LLD(PCF) New Project.xlsx。
### VNF部署 
VNF指虚拟化后的核心网网元（如PCF），执行3GPP定义的网元功能。
本文档介绍通过AIC工具部署PCF的过程。 
#### 前置条件 
##### VNF部署准备 
序号|准备工作|说明
---|---|---
1|打通客户端与TECS的TECS_Client平面的路由|客户端配置到TECS_Client网段的路由，网关交换机配置TECS_Client平面的网关。正常情况下在部署VNF时网关交换机上已经配置了TECS_Client平面的网关，一般仅检查即可，以保证VNF部署过程中可以访问TECS的TECS_Client地址。
2|检查客户端可以正常访问NFVO及VNFM|客户端可以正常访问NFVO及VNFM的网管页面，可以正常SSH登录。
3|网关交换机配置VNF OAM平面的网关|网关交换机配置VNF OAM平面的网关，用于保证部署过程中VNF的OAM地址与VNFM的EMS地址正常通讯。如果VNF OAM平面复用VNFM的EMS平面，则不需要额外配置。
##### LLD文件准备 
已经准备好iDevise输出的最终LLD文件，LLD文件名为ZTE NFV LLD xxxx.xlsx（其中xxxx为iDevise输入的Project Name），例如ZTE NFV LLD HDBNJ.xlsx。
#### 部署VNF 
摘要 :本节介绍通过iDeploy工具部署ZXUN RCP的过程，iDeploy工具自动完成ZXUN RCP所需虚拟资源的创建和业务程序的自动部署。
 说明： 
运行iDeploy工具的PC机，需去除PC机休眠设置。 
PC机的8002端口不能被占用。 
因Windows系统对文件路径存在最大200字节的限制，iDeploy工具所在路径不宜过长（建议将iDeploy工具放在根目录下），否则iDeploy无法正常运行。 
步骤 :导入LLD文件和版本包
打开AIC工具的iDeploy目录，选择iDeploy应用程序，如[图1]所示。
图1  iDeploy应用程序

双击iDeploy图标，在打开的iDeploy部署页面中选择部署平台，如[图2]所示。
图2  iDeploy部署平台

首次打开iDeploy时，由于没有导入LLD，会出现如[图3]所示界面。
图3  iDeploy界面

单击点击这里导入LLD文件按钮，在弹出的对话框中选择LLD文件，文件格式为.xlsx。iDeploy工具支持一次导入多个LLD，也支持多次导入多个LLD。
LLD文件导入成功后，会显示LLD文件所属领域、文件名称、导入时间等信息，如[图4]所示。
图4  导入LLD文件成功

选择左侧目录树的DC概览
→DC概览
，右侧出现DC概览页面。在该页面会显示LLD中设计的相关组件的概览信息，此处无需操作，仅用于浏览概要信息。
选择左侧目录树的版本导入→文件列表
，右侧出现版本导入页面。检查列表中的文件名称是否和准备导入的文件名相同。此时页面状态栏中的红叉（）表示版本文件缺失，需要导入，如[图5]示。
 说明： 
操作员手工导入的各个版本文件名称和后缀，都需要和版本导入页面中的文件名称相同，否则iDeploy工具会识别不到文件。
图5  版本导入

根据不同情况，选择执行以下操作导入版本文件。 
如果...|那么...
---|---
批量导入版本文件|选中一个领域：PCF下的所有版本文件对应的选项框，单击（批量导入）图标。在弹出的对话框中选择版本文件目录，工具会自动扫描所选目录下的所有文件自动匹配导入。导入成功后，对应文件的状态会变成绿勾状（），如图6所示。如有部分文件缺失，工具会在上方给出红色栏提示，同时对应文件状态栏依然是红叉状态（），此时检查所选的导入目录中版本文件是否缺失，或者名称及后缀是否与LLD中填写的一致。
单个导入版本文件|选择需要导入的文件，单击选择导入的按钮，如图7所示。在弹出的对话框中选择对应的版本文件。
图6  批量导入版本文件
图7  单个导入版本文件
所有版本文件导入成功后，结果如[图8]所示。
图8  所有版本文件导入成功页面

配置iDeploy工具
 说明： 
由于LLD配置文件的MANO Info页签中将NFVO/VNFM & VIM Authentication Type参数设置为Two-way Authentication，即启用了双向认证功能，因此iDeploy工具也需要打开双向认证开关。
单击页面左下角的领域设置，如[图9]所示。
图9  iDeploy部署工具

在领域设置页面中开启VIM双向认证，并填写VIM控制节点虚机的用户名和密码，如[图10]所示。
图10  领域设置

单击[图9]中页面右上角的设置，在通用设置页面打开允许网元回滚操作开关，如[图11]所示。
图11  设置回滚

部署VNF
返回部署页面，勾选需要部署的对象，单击图标，iDeploy工具开始自动部署ZXUN RCP，正常情况下部署过程无需人工干预，如[图12]所示。
 说明： 
如果不启用流镜像功能和VPC功能，则不需要勾选PCF配置TAAS部署和PCF配置VPC部署两个选项。
图12  开始自动部署
 说明： 
请耐心等待大约40分钟，自动部署完成。部署过程中可能会因为外部环境因素导致部署过程异常，工具提供了停止、重试、继续等按钮供手工干预。 
### 激活预埋服务（可选） 
摘要 :ZXUN RCP网元提供了Ncudr_Access、Npcf_LOG和Npcf_LogStoreUnit可选服务。这些服务在不同场景可能不部署、也可能部署其中的一种或多种。并且还存在某个服务原本不部署，后期由于需求变化又要求部署的情况。
因此ZXUN RCP启用了“服务预埋”功能，即预埋以上服务，默认不实例化。在需要时再激活该预埋的服务，根据需要进行实例化部署。
相关信息 :对于部分运营商场景，需要在完成VNF部署后进行激活预埋服务操作，相关信息参见[表1]。
适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活预埋服务
---|---|---|---|---|---|---
中国移动数据局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务，默认弹出2个LOG虚机。激活Npcf_LogStoreUnit服务，默认弹出3个LSU虚机。
中国移动物联网局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务，默认弹出2个LOG虚机。激活Npcf_LogStoreUnit服务，默认弹出3个LSU虚机。
中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF|有|有|无|无|激活Ncudr_Access服务，默认弹出2个带有CGW标签的GSU虚机。
中国电信非UDSF局|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务。去激活Ncudr_SystemManagement服务。回收CDU虚机。激活Ncudr_AccessManagement服务。激活Ncudr_Access服务，默认弹出2个带有CGW标签的GSU虚机。
中国移动语音局国际通用局部分测试局|无报表功能无热备容灾|有|无|无|无|无。
部分国际局部分测试局|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务，默认弹出2个LOG虚机。
UDSF局是指部署了Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
非UDSF局是指没有部署Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
本节介绍激活各个服务的操作，去激活Ncudr_AccessManagement服务、去激活Ncudr_Access服务和回收CDU虚机的操作参见[去激活服务（可选）]。
步骤 :检查ZXUN RCP和MANO版本
检查ZXUN RCP版本，需要等于或高于V7.21.20.B3版本，以支持服务预埋功能。
检查使用的MANO版本，如果是V5.21.11.P4.B2，则需要进一步确认是否执行过补丁V5.21.11.P4.B2SP01，检查方法如下：
使用SSH方式登录VNFM主节点，执行docker stats sm命令，查询SM容器内存LIMIT值。
如果…|那么…
---|---
LIMIT值是550 MiB|表示未扩过内存，未执行补丁技术通知单，需要联系中兴通讯技术支持执行补丁技术通知单。
LIMIT值大于550 MiB|表示已扩过内存。
检查完成后，执行ctrl c停止命令。
（可选）检查VNF应用配额
 说明： 
若运营商资源池启用了VNF三级租户，则需要检查VNF应用配额是否满足服务激活的需求。 
打开浏览器，在地址栏输入NFVO客户端地址https://IP地址:28808/nfvo-mano-portal，在登录页面中输入用户名和密码，登录NFVO客户端，如[图1]所示。
图1  登录NFVO客户端

选择系统→NFVO→配置管理→租户
，默认显示一级租户页面。
切换至应用配额页面，查看VNF的应用配额，如[图2]所示。
图2  查看VNF配额

打开自动扩缩容开关
在NFVO客户端页面选择编排→VNF
，打开VNF页面，如[图3]所示。
图3  VNF页面

在VNF页面中选择更多→自动扩缩容开关
，打开自动扩缩容开关页面，如[图4]所示。
图4  自动扩缩容界面

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择开启。单击提交按钮，打开自动扩容开关，如[图5]所示。
图5  打开自动扩容开关

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择开启，打开自动缩容开关，如[图6]所示。
图6  打开自动缩容开关

激活预埋服务Ncudr_AccessManagement
打开浏览器，在地址栏输入https://IP地址:28808/em-portal，输入用户名和密码，登录EM客户端，如[图7]所示。
图7  登录EM客户端

在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW NFS]命令，查询部署状态为False的Ncudr_AccessManagement服务的实例名称，如[图8]所示。
图8  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Ncudr_AccessManagement_0"命令（以步骤[12]中查询到的Ncudr_AccessManagement_0实例名称为例），激活预埋服务Ncudr_AccessManagement。
激活预埋服务Ncudr_Access
执行[SHOW NFS]命令，查询部署状态为False的Ncudr_Access服务的实例名称，如[图9]所示。
图9  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Ncudr_Access_0"命令（以步骤[13]中查询到的Ncudr_Access_0实例名称为例），激活预埋服务Ncudr_Access。
激活预埋服务Npcf_LOG
执行[SHOW NFS]命令，查询部署状态为False的Npcf_LOG服务的实例名称，如[图10]所示。
图10  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Npcf_LOG_0"命令（以步骤[11]中查询到的Npcf_LOG_0实例名称为例），激活预埋服务Npcf_LOG。
激活预埋服务Npcf_LogStoreUnit
执行[SHOW NFS]命令，查询部署状态为False的Npcf_LogStoreUnit服务的实例名称，如[图11]所示。
图11  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Npcf_LogStoreUnit_0"命令（以步骤[13]中查询到的Npcf_LogStoreUnit_0实例名称为例），激活预埋服务Npcf_LogStoreUnit。
 说明： 
激活预埋服务后需要等待1-3分钟，MANO才会建立起自动扩缩容的任务。 
检查自动扩缩容任务
登录NFVO客户端，单击页面右上角的图标，在显示的任务页面中查看自动扩缩容任务状态为已完成，如[图12]所示。
图12  检查自动扩缩容任务

检查Ncudr_AccessManagement服务和Ncudr_Access服务激活状态
执行命令检查Ncudr_Access服务相关信息，确保Ncudr_Access服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Ncudr_Access服务的部署状态为TRUE。
虚机|SHOW VM|Ncudr_Access服务激活后弹出2个带CGW标签的GSU虚机，如图13所示。
实例类型|SHOW SCTYPE:NFSNAME="Ncudr_Access_0"SHOW SCTYPE:NFSNAME="Ncudr_AccessManagement_0"|检查Ncudr_Access服务对应的SC类型和SC当前实例数，如图14所示。SC类型sc-cudr-access-cgw对应的当前实例数是2（与弹出GSU虚机个数一致）。SC类型sc-tmsp-nff对应的当前实例数是2（与弹出GSU虚机个数一致）。SC类型sc-cudr-access-mp对应的当前实例数是2（1+1主备OMU虚机）。检查Ncudr_AccessManagement服务对应的SC类型和SC当前实例数。SC类型sc-cudr-accessmgt-mp对应的当前实例数是2，如图15所示。
容器|SHOW VRU:NFSNAME="Ncudr_Access_0"SHOW VRU:NFSNAME="Ncudr_AccessManagement_0"|检查Ncudr_Access服务对应的SC类型包含2个sc-cudr-access-cgw、2个sc-tmsp-nff和2个sc-cudr-access-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图16所示。检查Ncudr_AccessManagement服务对应的SC类型包含2个sc-cudr-accessmgt-mp。SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图17所示。
图13  检查虚机

图14  检查Ncudr_Access服务的实例类型

图15  检查Ncudr_AccessManagement服务的实例类型

图16  检查Ncudr_Access服务的容器

图17  检查Ncudr_AccessManagement服务的容器

检查Npcf_LOG服务激活状态
执行命令检查Npcf_LOG服务相关信息，确保Npcf_LOG服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Npcf_LOG服务的部署状态为TRUE。
虚机|SHOW VM|Npcf_LOG服务激活后弹出2个LOG虚机，如图18所示。
实例类型|SHOW SCTYPE:NFSNAME="Npcf_LOG_0"|检查Npcf_LOG服务对应的当前SC类型和SC当前实例数，如图19所示。SC类型sc-pcf-log对应的当前实例数是2（与弹出LOG虚机个数一致）。SC类型sc-pcf-log-mp对应的当前实例数是2（1+1主备OMU虚机）。
容器|SHOW VRU:NFSNAME="Npcf_LOG_0"|检查Npcf_LOG服务对应的SC类型包含2个sc-pcf-log和2个sc-pcf-log-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图20所示。
图18  检查虚机

图19  检查实例类型

图20  检查容器

检查Npcf_LogStoreUnit服务激活状态
执行命令检查Npcf_LogStoreUnit服务相关信息，确保Npcf_LogStoreUnit服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Npcf_LogStoreUnit服务的部署状态为TRUE。
虚机|SHOW VM|Npcf_LogStoreUnit服务激活后弹出3个LSU虚机，如图21所示。
实例类型|SHOW SCTYPE:NFSNAME="Npcf_LogStoreUnit_0"|检查Npcf_LogStoreUnit服务对应的当前SC类型和SC当前实例数，如图22所示。SC类型sc-pcf-lsu对应的当前实例数是3（与弹出LSU虚机个数一致）。SC类型sc-pcf-lsu-mp对应的当前实例数是2（1+1主备OMU虚机）。
容器|SHOW VRU:NFSNAME="Npcf_LogStoreUnit_0"|检查Npcf_LogStoreUnit服务对应的SC类型包含3个sc-pcf-lsu和2个sc-pcf-lsu-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图23所示。
图21  检查虚机

图22  检查实例类型

图23  检查容器

关闭自动扩缩容开关
在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择关闭，关闭自动扩容开关，如[图24]所示。
图24  关闭自动扩容开关

在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择关闭，关闭自动缩容开关，如[图25]所示。
图25  关闭自动缩容开关

### 去激活服务（可选） 
摘要 :服务去激活（删除）是服务预埋反向过程。当不需要某个服务时，删除该服务可以节省资源。 
相关信息 :对于部分运营商场景，需要在完成VNF部署后进行去激活服务操作，相关信息参见[表1]。
适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活/去激活预埋服务
---|---|---|---|---|---|---
中国电信非UDSF局|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务。去激活Ncudr_SystemManagement服务。回收CDU虚机。激活Ncudr_AccessManagement服务。激活Ncudr_Access服务。
非UDSF局是指没有部署Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
 说明： 
如果Ncudr_Access服务已激活，则需要先去激活Ncudr_Access服务和Nudsf_UnstructuredDataManagement服务，再去激活Ncudr_SystemManagement服务。 
如果Ncudr_Access服务未激活，则需要先去激活Nudsf_UnstructuredDataManagement服务，再去激活Ncudr_SystemManagement服务。 
本节介绍去激活Nudsf_UnstructuredDataManagement服务和Ncudr_SystemManagement服务的操作，激活Ncudr_AccessManagement服务和Ncudr_Access服务参见[激活预埋服务（可选）]。
步骤 :打开自动扩缩容开关
打开浏览器，在地址栏输入NFVO客户端地址https://IP地址:28808/nfvo-mano-portal，在登录页面中输入用户名和密码，登录NFVO客户端，如[图1]所示。
图1  登录NFVO客户端

选择编排→VNF
，打开VNF页面，如[图2]所示。
图2  VNF页面

在VNF页面中选择更多→自动扩缩容开关
，打开自动扩缩容开关页面，如[图3]所示。
图3  自动扩缩容界面

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择开启。单击提交按钮，打开自动扩容开关，如[图4]所示。
图4  打开自动扩容开关

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择开启，打开自动缩容开关，如[图5]所示。
图5  打开自动缩容开关

去激活Nudsf_UnstructuredDataManagement_0和Ncudr_SystemManagement_0服务
打开浏览器，在地址栏输入https://IP地址:28808/em-portal，输入用户名和密码，登录EM客户端，如[图6]所示。
图6  登录EM客户端

在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
去激活Nudsf_UnstructuredDataManagement_0和Ncudr_SystemManagement_0服务。 
 说明： 
必须先去激活Nudsf_UnstructuredDataManagement_0服务，再去激活Ncudr_SystemManagement_0服务。 
执行[DEACTIVATE NFS]:NFSNAME="Nudsf_UnstructuredDataManagement_0"命令，去激活Nudsf_UnstructuredDataManagement_0服务。
执行[DEACTIVATE NFS]:NFSNAME="Ncudr_SystemManagement_0"命令，去激活Ncudr_SystemManagement_0服务。
 说明： 
去激活服务后需要等待1-3分钟，MANO才会建立起自动扩缩容的任务。 
检查自动扩缩容任务
登录NFVO客户端，单击页面右上角的图标，在显示的任务页面中查看自动扩缩容任务状态为已完成，如[图7]所示。
图7  检查自动扩缩容任务

检查去激活服务状态
去激活服务后执行命令检查，确保服务被成功去激活。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|两个服务的部署状态为False，如图8所示。
实例类型|SHOW SCTYPE:NFSNAME="Ncudr_SystemManagement_0"SHOW SCTYPE:NFSNAME="Nudsf_UnstructuredDataManagement_0"|检查服务对应的当前SC已被删除，如图9所示。
容器|SHOW VRU:NFSNAME="Ncudr_SystemManagement_0"SHOW VRU:NFSNAME="Nudsf_UnstructuredDataManagement_0"|检查服务对应的容器已被删除，查询结果为空，如图10所示。
图8  检查服务

图9  检查实例类型

图10  检查容器

回收所有的CDU虚机。 
执行[SHOW VM]命令，查询CDU虚机的虚机内部名称，如[图11]所示。
图11  查询CDU虚机

执行[RECYCLE VM]命令，回收所有CDU虚机。
VMNAME参数填写步骤[a]中查询到的CDU虚机内部名称。
关闭自动扩缩容开关
在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择关闭，关闭自动扩容开关，如[图12]所示。
图12  关闭自动扩容开关

在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择关闭，关闭自动缩容开关，如[图13]所示。
图13  关闭自动缩容开关

### 配置虚机弹扩 
摘要 :在ZXUN RCP实例化成功后，各个虚机都是最少个数，商用场景需要的虚机个数一般都比实例化时的个数多，操作员需要根据商务合同，将各个虚机的数量，弹扩到要求的数量。
本节介绍弹扩ZXUN RCP虚机的操作。
相关信息 :弹性是通过弹扩（增加资源）或弹缩（减少资源）来协调系统的资源占用与系统性能间的平衡，弹性功能包括弹扩和弹缩。 
弹扩（Scale Out）即申请所占用的虚拟资源。 
弹缩（Scale In）即释放所占用的虚拟资源。 
一个NF由多个类型的虚机组成，一种类型的虚机包含多个NFS，NFS是一种可独立开发、测试、部署的单元，每个NFS包含多个SC。
每个虚机可运行不同的SC数量，根据HLD中虚机数量计算需要增加的SC数量，将每种SC类型的虚机扩容到HLD配置数量，满足商用容量要求。
以商用大规格场景为例，ZXUN RCP涉及到弹性伸缩的虚机类型参见[表1]。
虚机类型|规格|SC类型名称|单虚机SC数量（最小弹性步长）|建议每次扩容最大SC个数
---|---|---|---|---
CDU|C-C4M32|sc-cudr-cdn-l-001/sc-cudr-cdn-l|3|15
sc-cudr-cdn-r-001/sc-cudr-cdn-r|CDU|C-C4M32|3|15
GSU (Policy Control)|Common-C8M32|sc-pcf-pcm|1|5
GSU (HTTP LB)|Common-C8|sc-http-lb|1|5
GSU (SIG LB)|Common-C8|sc-sig|1|5
sc-pcf-siglb|GSU (SIG LB)|Common-C8|1|5
GSU (CGW)|Common-C8|sc-cudr-access-cgw|1|4
sc-tmsp-nff|GSU (CGW)|Common-C8|1|4
IPU|C8|sc-ips|1|5
LOG|Common-C8M24|sc-pcf-log|1|5
LSU|C12|sc-pcf-lsu|1|5
合入UDSF插件实例化后的CDU虚机的SC类型为sc-cudr-cdn-l-001和sc-cudr-cdn-r-001。
未合入UDSF插件实例化后的CDU虚机的SC类型为sc-cudr-cdn-l和sc-cudr-cdn-r。
 说明： 
首次扩容的SC数量固定设置为最小弹性步长，等单个虚机扩容成功后，后续扩容可以将SC数量设置为需要扩容的数量，最大不能超过建议每次扩容最大SC个数。
步骤 :打开自动扩缩容开关
登录NFVO客户端，选择菜单编排→应用→VNF
，在界面右侧默认显示VNF页面，如[图1]所示。
图1  VNF页面

选择更多→自动扩缩容开关
，进入自动扩缩容开关设置页面，如[图2]所示。
图2  自动扩缩容开关

在自动扩缩容开关页面中，粒度选择VNF，查看网元的自动缩容开关状态和自动扩容开关状态。
如果…|那么…
---|---
自动缩容开关状态和自动扩容开关状态为关|转至步骤4
自动缩容开关状态和自动扩容开关状态为开|转至步骤5
将操作类型分别设置为缩容和扩容，开关设置为开启。设置完成后，单击提交按钮，如[图3]所示。
图3  打开自动扩缩容开关

配置自愈功能总开关、弹性模式和检查开关
在EM客户端，切换到配置页面，在配置页面的左侧命令树中，展开需要进行手工弹性操作的PCF节点。
在命令输入框中执行[SHOW AUTOHEALINGGLB]命令，查询自愈功能总开关状态。
如果…|那么…
---|---
自愈功能总开关状态为启用|转至步骤7
自愈功能总开关状态为禁用|转至步骤8
在命令输入框中执行[SET AUTOHEALINGGLB]:HEALINGSWITCH="DISABLE"命令，禁用自愈功能总开关。
在命令输入框中执行[SHOW SCALEGLBBASECFG]命令，查询弹性模式。
如果…|那么…
---|---
弹性模式为手动|转至步骤9
弹性模式为自动|通常弹性模式需要设为手工，请联系中兴通讯技术支持。
在命令输入框中执行[SHOW CONSISTENCECHECK]命令，查询检查开关状态。
如果…|那么…
---|---
检查开关状态为启用|转至步骤10
检查开关状态为禁用|转至步骤11
在命令输入框中执行[SET CONSISTENCECHECK]:CHECKSWITCH="DISABLE"命令，禁用检查开关。
CDU虚机扩容SC
 说明： 
CDU虚机扩容SC时需要分别对sc-cudr-cdn-l-001/sc-cudr-cdn-l和sc-cudr-cdn-r-001/sc-cudr-cdn-r进行弹扩操作，才会创建新的CDU虚机。两种SC类型的需要扩容的虚机数量分别为CDU需要扩容总虚机数的一半。例如现场需要扩容4个CDU，即扩容6个sc-cudr-cdn-l-001/sc-cudr-cdn-l和6个sc-cudr-cdn-r-001/sc-cudr-cdn-r。 
首次扩容SC_NUM步长固定设置为3，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过15。 
在命令输入框中执行如下命令，查询当前CDU虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Nudsf_UnstructuredDataManagement_0"
SC类型的名称以实际查询结果为准，sc-cudr-cdn-l-001和sc-cudr-cdn-r-001，或者sc-cudr-cdn-l和sc-cudr-cdn-r。 
例如现场需要扩容2个CDU，由于CDU虚机的最小弹性步长为3，需扩容3个sc-cudr-cdn-l-001和3个sc-cudr-cdn-r-001。 
在命令输入框中执行如下命令，对sc-cudr-cdn-l-001进行弹扩操作。 
[INC SC]:NFSNAME="Nudsf_UnstructuredDataManagement_0",SCTYPE="sc-cudr-cdn-l-001",SC_NUM=3
执行同样的操作，在命令输入框中执行如下命令，对sc-cudr-cdn-r-001进行弹扩操作。 
[INC SC]:NFSNAME="Nudsf_UnstructuredDataManagement_0",SC_TYPE="sc-cudr-cdn-r-001",SC_NUM=3
GSU (Policy Control)虚机扩容SC
 说明： 
GSU (Policy Control)虚机扩容将会导致用户在业务虚机上重新分布。 
冷备场景：性能统计过程中可能会出现会话数骤降，后逐步恢复的现象。 
热备场景：性能统计过程中可能会出现会话数骤降，等待30分钟后逐步恢复的现象。 
恢复时间受1102全局参数配置值影响，恢复完毕后对业务无影响。 
在命令输入框中执行如下命令，查询当前GSU (Policy Control)虚机的SC类型名称和SC个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_SMPolicyControl_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Npcf_SMPolicyControl_0",SCTYPE="sc-pcf-pcm",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-pcf-pcm的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
GSU (HTTP LB)虚机扩容SC
在命令输入框中执行如下命令，查询当前GSU (HTTP LB)虚机的SC类型名称和SC个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_HTTP_LB_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_HTTP_LB_0",SCTYPE="sc-http-lb",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-http-lb的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
GSU (SIG LB)虚机扩容SC
 说明： 
扩容GSU (SIG LB)虚机需要扩容sc-sig和sc-pcf-siglb两种类型SC。先扩容sc-pcf-siglb类型SC，再扩容sc-sig类型SC。
sc-pcf-siglb类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
sc-sig类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
在命令输入框中执行如下命令，查询当前GSU (SIG LB)虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_SIGLB_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Npcf_SIGLB_0",SCTYPE="sc-pcf-siglb",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-pcf-siglb的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
在命令输入框中执行如下命令，查询当前GSU（SIG LB）虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_SIG_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_SIG_0",SCTYPE="sc-sig",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-sig的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
GSU (CGW)虚机扩容SC
激活Ncudr_Access服务，默认弹出2个sc-cudr-access-cgw、2个sc-tmsp-nff和2个sc-cudr-access-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容GSU (CGW)虚机仅需扩容sc-cudr-access-cgw和sc-tmsp-nf两种类型SC，2个sc-cudr-access-mp用于1+1主备OMU虚机。sc-tmsp-nff类型的SC个数要与sc-cudr-access-cgw类型的SC个数一致。
sc-cudr-access-cgw类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过4。 
sc-tmsp-nf类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过4。 
扩容顺序：先扩容sc-cudr-access-cgw类型SC，再扩容sc-tmsp-nff类型SC。 
在命令输入框中执行如下命令，查询当前GSU (CGW)虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Ncudr_Access_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Ncudr_Access_0",SCTYPE="sc-cudr-access-cgw",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-cudr-access-cgw的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Ncudr_Access_0",SCTYPE="sc-tmsp-nff",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-tmsp-nff的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
IPU虚机扩容SC
在命令输入框中执行如下命令，查询当前IPU虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_IPS_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_IPS_0",SCTYPE="sc-ips",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-ips的弹扩最小步长为1，即增加1个SC就增加一个IPU，如果要弹扩2个IPU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
LOG虚机扩容SC
激活Npcf_LOG_0服务，默认弹出2个sc-pcf-log和2个sc-pcf-log-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容LOG虚机仅需扩容sc-pcf-log，2个sc-pcf-log-mp用于1+1主备OMU虚机。
在命令输入框中执行如下命令，查询当前LOG虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_LOG_0"
在命令输入框中执行如下命令，对sc-pcf-log进行弹扩操作。 
[INC SC]:NFSNAME="Npcf_LOG_0",SCTYPE="sc-pcf-log",SCNUM=1
本示例中需要新增的LOG虚机个数为1。sc-pcf-log的弹扩最小步长为1，即增加1个SC就增加一个LOG，如果要弹扩2个LOG，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
LSU虚机扩容SC
激活Npcf_LogStoreUnit_0服务，默认弹出2个sc-pcf-lsu和2个sc-pcf-lsu-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容LOG虚机仅需扩容sc-pcf-lsu，2个sc-pcf-lsu-mp用于1+1主备OMU虚机。
在命令输入框中执行如下命令，查询当前LSG虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_LogStoreUnit_0"
在命令输入框中执行如下命令，对sc-pcf-lsu进行弹扩操作。 
[INC SC]:NFSNAME="Npcf_LogStoreUnit_0",SCTYPE="sc-pcf-lsu",SCNUM=1
本示例中需要新增的LSU虚机个数为1。sc-pcf-lsu的弹扩最小步长为1，即增加1个SC就增加一个LSU，如果要弹扩2个LSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
（可选）恢复自愈功能总开关和检查开关
如果步骤[6]中查询到的自愈功能总开关状态为启用，那么需要在命令输入框中执行如下命令，恢复自愈功能总开关。
[SET AUTOHEALINGGLB]:HEALINGSWITCH="ENABLE"
如果步骤[9]中查询到的检查开关状态为启用，那么需要在命令输入框中执行如下命令，恢复检查开关。
[SET CONSISTENCECHECK]:CHECKSWITCH="ENABLE"
（可选）恢复自动扩缩容开关
如果步骤[3]中查询到的自动缩容开关状态和自动扩容开关状态为关，那么需要参考步骤[4]，将操作类型分别设置为缩容和扩容，开关设置为关闭，关闭自动扩缩容开关。
### 安装后检查 
#### 检查虚机 
摘要 :ZXUN RCP实例化完成后，需要检查虚机是否为运行状态。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VM]命令，检查虚机信息，如[图1]所示。
图1  查询虚机信息

检查标准 :检查虚机内部名称前缀部分是否符合规范，虚机内部名称中的前缀如果不符合运营商规范，请根据规划修改，重新实例化虚机。 
检查虚机规格及数量是否和HLD一致。 
检查虚机运行状态是否正常，所有虚机运行状态需为running。 
#### 检查SC状态 
摘要 :ZXUN RCP实例化完成后，需要检查虚机SC状态。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VRU]命令，检查SC运行状态，如[图1]所示。
图1  查询SC运行状态

检查标准 :所有SC运行状态为running。
#### 检查网元名称 
摘要 :ZXUN RCP实例化完成后，需要检查网元是否符合运营商网元名称规范。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VNF]命令，检查网元名称，如[图1]所示。
图1  查询网元名称

检查标准 :VNF部署实例名称符合运营商网元名称规范要求。
### 在VNFM上创建用户 
摘要 :ZXUN RCP支持HTTPS认证功能，VNF需要向VNFM获取token。由于安全原因，禁止使用admin用户，需要新建用户。本节介绍在VNFM上创建用户的操作过程。
步骤 :在VNFM上新建账户规则
在VNFM客户端，选择菜单系统→安全→账户规则
，进入账户规则页面，如[图1]所示。
图1  账户规则页面

单击新建账户规则，进入新建账户规则页面。
在规则名称与密码策略区域，设置规则名称与密码相关策略，如[图2]所示。
图2  新建账户规则

参数名|参数说明
---|---
规则名称|根据规划填写账户规则名称。在创建用户时将会引用本规则名称。
首次登录|不勾选该选项。
密码最大有效期|设置为0。
在账号策略区域，设置账号允许登录的方式和有效期等参数，如[图3]所示。
图3  账号策略

参数名|参数说明
---|---
账号登录方式|选中Web和API。
单击新建按钮，完成账户规则的创建。
在VNFM上新建用户
在VNFM客户端，选择菜单系统→安全→用户管理
，进入用户管理页面，如[图4]所示。
图4  用户管理页面

单击新建用户，进入基本信息页面，如[图5]所示。
图5  基本信息页面

基本信息页面的参数说明参见[表3]。
参数名|参数说明
---|---
用户名|根据规划填写用户的用户名，即该用户的登录名称。用户名不区分大小写，不允许重复，最长30个字符。
密码|用户登录时输入的口令。在用户账户规则中，可以定制密码的长度范围。
确认密码|再次输入密码，必须和用户密码一致。
账户规则|在下拉菜单中选择在“在VNFM上新建账户规则”中创建的账户规则。
同时登录数限制|选中不限制。各选项含义如下：全局：同一个用户名只允许1个人同时登录。不限制：同一个用户名允许多人同时登录。自定义：自定义同一个用户名的同时登录人数。
单击下一步，进入权限分配页面，选中所有角色，如[图6]。
图6  权限分配

单击新建按钮，完成用户的创建。
### iDeploy相关操作 
#### 删除自动部署的网元 
摘要 :如果需要删除自动化部署的网元（已成功部署的网元、部署失败还尚未清除残留资源的网元），可参考本节的操作。 
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中打开是否显示网元清除按钮开关，如[图1]所示。
图1  显示清除按钮标志

网元部署旁会显示清除按钮标志，如[图2]所示。
图2  删除已部署的组件

单击清除按钮，在弹出的对话框中单击是，如[图3]所示，一键自动删除已部署的组件。
图3  网元初始化

#### 日志使用 

#### 日志使用 



部署过程支持实时日志上报，且可根据日志级别过滤日志，根据关键字查找日志，单击用例直接跳转到该用例对应的日志，支持日志的一键采集。 


日志级别由高到低为：ERROR、WARN、INFO、DEBUG、TRACE，默认为INFO。



##### 设置日志级别 
摘要 :本节介绍在iDeploy工具设置日志级别的操作。 
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中设置最低日志级别，如[图1]所示。
图1  设置最低日志级别

用户可在部署页面选择实时显示的最低日志级别，如[图2]所示。
图2  查看最低级别日志



##### 快速定位日志 




摘要 :本节介绍在iDeploy工具快速定位日志的操作。 


####### 日志快速定位 


日志窗口仅显示当前用户选择的用例对应的日志，这样更方便帮助用户快速定位到所需的日志，如[图3]所示。
图3  当前日志






（可选）在部署页面，单击全部日志按钮，如[图4]所示。日志窗口显示当前所有日志。
图4  全部日志










##### 清除日志 
摘要 :本节介绍在iDeploy工具清除日志的操作。 
步骤 :手工清除日志在部署页面，单击清除按钮，清除当前页面已产生的日志信息，如图5所示。图5  部署实施 
设置日志自动清除单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中设置自动清除日志消息。开启点击开始按钮时清除日志信息后，每次iDeploy工具重新执行时，就会自动清除之前已产生的日志，如图6所示。图6  设置自动清除日志消息 
##### 一键采集日志 
摘要 :本节介绍在iDeploy工具一键采集日志的操作。 
步骤 :在部署页面，单击（报告采集）按钮一键自动采集日志，如[图7]所示。
图7  部署实施

采集完成后，弹出日志采集完成对话框提示单击下载按钮将日志下载保存，如[图8]所示。
图8  日志采集完成

#### 报告查看 

#### 报告查看 



iDeploy支持当前部署报告和历史报告的查看。 





##### 查看当前部署报告 




摘要 :本节介绍在iDeploy工具查看当前部署报告的操作。 


步骤 :

部署完成后会在部署页面的日志下方生成当前部署报告链接，单击iDeploy Report链接查看当前部署报告，如[图1]所示。
图1  查看当前部署报告












##### 查看历史报告 




摘要 :本节介绍在iDeploy工具查看历史报告的操作。 


步骤 :

在部署页面，单击（查看报告）按钮打开历史报告列表，如[图2]所示。
图2  部署实施






在历史报告列表页面，单击所需查看的时间段，打开历史报告，如[图3]所示。
图3  历史报告列表










#### 设置iDeploy工具语言 
摘要 :iDeploy支持语言设置。本节介绍使用iDeploy工具设置语言的操作。 
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中设置语言，如[图1]所示。
图1  设置语言

#### 检查LLD 
摘要 :iDeploy支持LLD检查。本节介绍在iDeploy工具进行LLD检查的操作。
步骤 :单击iDeploy窗口右上角的小齿轮按钮，在打开的对话框中打开是否进行LLD检查开关，如[图1]所示。
图1  设置LLD检查

在导入LLD文件时，iDeploy工具就会对LLD中的关键参数进行合法性检查。如检查不通过会给出提示信息，如[图2]所示。
图2  LLD检查失败信息

## 缩略语 
## 缩略语 
3GPP :3rd Generation Partnership Project第三代合作伙伴计划
5GC :5G Core Network5G核心网
### AIC 
Automatic Integration Center自动化集成中心
### CDU 
Cloud Database Unit云数据库单元
### CGSL 
Carrier Grade Server Linux电信级服务器Linux
### CGW 
CDB GatewayCDB接入网关
### CIDR 
Classless Inter-Domain Routing无类别域间路由
### CMCC 
China Mobile Communications Corporation中国移动通信集团公司
### CN 
Core Network核心网
### CPU 
Central Processing Unit中央处理器
### DC 
Data Center数据中心
### DVS 
Distributed Virtual Switch分布式虚拟交换机
EM :Element Management网元管理
EMS :Element Management System网元管理系统
ETSI :European Telecommunications Standards Institute欧洲电信标准化协会
FTP :File Transfer Protocol文件传输协议
GSU :General Service Unit通用业务单元
### HLD 
High Level Design高层次设计
HTTP :Hypertext Transfer Protocol超文本传输协议
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
### IOPS 
Input/Output Operations Per Second每秒输入/输出操作
IP :Internet Protocol因特网协议
### IPU 
Interface Process Unit接口处理单元
IPv4 :Internet Protocol Version 4互联网通信协议第四版
IPv6 :Internet Protocol Version 6互联网通信协议第六版
### IaaS 
Infrastructure as a Service基础设施即服务
### LB 
Load Balance负载均衡
### LLD 
Low Level Design详细设计
MANO :Management and Orchestration管理和编排
### MTU 
Maximum Transmission Unit最大传输单元
NF :Network Function网络功能
NFS :Network Function Service网络功能服务
NFV :Network Functions Virtualization网络功能虚拟化
### NFVI 
Network Functions Virtualization Infrastructure网络功能虚拟化基础设施
NFVO :Network Functions Virtualization Orchestrator网络功能虚拟化编排器
### NS 
Network Service网络服务
Network Slice网络切片
### NTP 
Network Time Protocol网络时间协议
OAM :Operation, Administration and Maintenance操作管理维护
OMU :Operation & Management Unit操作管理单元
### OSP 
OpenStack PlatformOpenStack平台
### OVS 
Open VSwitch虚拟交换机
### PC 
Personal Computer个人电脑
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
QoS :Quality of Service服务质量
### SBI 
Service Based Interface基于服务的接口
SC :Service Component服务组件
### SDN 
Software Defined Network软件定义网络
SFTP :Secure File Transfer Protocol安全文件传输协议
### SIG 
Signal信令
SMS :Short Message Service短消息业务
### SR-IOV 
Single-Root I/O Virtualization单根I/O虚拟化
Single-Root Input/Output Virtualization单根I/O虚拟化
### SSH 
Secure Shell安全外壳协议
### TEC 
Thermoelectric Cooler热电制冷器
### TECS 
Tulip Elastic Cloud System郁金香弹性云系统
### TELNET 
Telecommunication Network Protocol远程登录协议
UDSF :Unstructured Data Storage Function非结构化数据存储功能
VIM :Virtualized Infrastructure Manager虚拟化基础设施管理系统
### VLAN 
Virtual Local Area Network虚拟局域网
VM :Virtual Machine虚拟机
VNF :Virtualized Network Function虚拟化网络功能
### VNFD 
Virtualized Network Function Descriptor虚拟化网络功能描述符
VNFM :Virtualized Network Function Manager虚拟化网络功能管理器
### VPC 
Virtual Private Cloud虚拟私有云
### VRF 
Virtual Route Forwarding虚拟路由转发
VPN Routing and ForwardingVPN路由转发
ZTE :Zhongxing Telecommunications Equipment中兴通讯
### uMAC 
unified Mobile Access Controller统一的移动性接入控制器
## 软件安装（手工部署） 
### 安装概述 
#### 虚拟化系统的组网架构 
概述 :在部署中兴通讯虚拟化核心网设备ZXUN RCP的运行环境之前，需要先了解虚拟化系统相关概念，包括组网架构及各部分的功能。
##### 组网架构 
虚拟化又称为云化，云是网络的一种比喻说法，是对电信网、互联网和底层基础设施的抽象描述。 
 说明： 
底层基础设施指的是主机、内存、CPU、接口、网络等硬件设施或网络资源。
云化就是指通过虚拟化技术NFV，将核心网网元的基础架构从专用硬件向通用硬件进行演进，从而实现软硬件的解耦。
对核心网进行云化后，其硬件设备和网元不再是一一对应的关系，由于底层的硬件设施和上层应用是解耦的，底层的硬件资源通过NFV可以被上层的多种应用共享。
NFV是云化核心网的关键技术。通过基于行业标准的x86服务器、存储和交换设备及虚拟化技术，使网络设备功能不再依赖于专用硬件，从而降低网络昂贵的设备成本，资源可以充分灵活共享，帮助运营商获得更多、更灵活的网络能力，实现新业务的快速开发和部署。
ETSI制定的NFV架构由NFVI、VNF以及MANO三个部分组成。
NFVI：基础硬件设施NFVI包括通用的硬件设施及其虚拟化。 
MANO：云管理及调度平台在NFV架构中，MANO负责对整个NFVI资源的管理和编排，负责业务网络和NFVI资源的映射和关联。MANO包括VIM、VNFM和NFVO三个部分，分别完成对NFVI、VNF和NS三个层次的管理。 
VNF：上层业务应用VNF使用软件实现虚拟化网络功能。 
根据核心网云化的三层结构，NFV架构中各个节点的关系如[图1]所示。
图1  NFV三层架构

各节点的功能说明参见[表1]。
架构|节点|描述
---|---|---
NFVI（基础硬件设施）|服务器|NFVI是网络功能虚拟化基础设施，通常指的是物理资源，包括主机、内存、CPU、接口等硬件设施。
磁阵|NFVI（基础硬件设施）|用于数据存储的设备，运营商可以根据实际运营状况决定是否需要配置磁阵，在交接局业务量较小的情况下，无需配置。
外部交接机|NFVI（基础硬件设施）|外部交换机指的是在实际组网环境中，用于将NFVI和磁阵接入运营商维护网络的交换机。
MANO（云管理及调度平台）|VIM|VIM是虚拟化基础设施管理系统，是NFVI的管理者。VIM主要负责基础设施层硬件资源、虚拟化资源的管理、监控和故障上报，面向上层业务应用提供虚拟化资源池。VIM为NFVO和VNFM提供VNF相关虚拟资源的操作接口。
VNFM和NFVO|MANO（云管理及调度平台）|NFVO负责全网的网络服务、虚拟资源以及物理资源的编排和管理功能。VNFM对核心网所有网元提供生命周期管理以及弹性伸缩相关的虚拟机操作管理功能。
VNF（上层业务应用）|VNF|一个VNF对应于在传统非虚拟化网络中的一个物理网络功能，即对应核心网的各种网元，如：PCF。
 说明： 
本文档仅涉及承担虚拟化架构中的一种VNF（ZXUN RCP）的软件安装过程。
#### 安装导读 
在进行ZXUN RCP软件安装前，确保已经完成硬件设备安装、VIM云平台管理软件和MANO安装，本文只涉及ZXUN RCP的版本软件的安装过程。安装全流程参见[表1]。
安装步骤|安装内容|安装参考文档
---|---|---
1|VIM|安装云平台软件|参考ZTE TECS OpenStack用户手册文档包中的“软件安装”内容进行安装。
2|MANO|安装CloudStudio|参考CloudStudio用户手册文档包中的“安装与调测”内容进行安装。
安装ElasticNet UME R50s|2|MANO|参考ElasticNet UME R50s成套用户手册中的“软件安装指导”内容进行安装。
3|VNF|安装ZXUN RCP|详细信息请参考本文档后续内容。
#### 安装说明 
##### 部署场景 
商用规格|适用运营商|应用场景
---|---|---
商用大规格(cmcc)|中国移动数据局|有报表功能无热备容灾
中国移动语音局|商用大规格(cmcc)|无报表功能无热备容灾
中国移动物联网局点|商用大规格(cmcc)|有报表功能无热备容灾
商用大规格|中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF
中国电信非UDSF局|商用大规格|无报表功能有热备容灾，外置UDSF
国际通用局点|商用大规格|无报表功能无热备容灾
部分国际局|商用大规格|无报表功能有EDR功能无热备容灾
商用小规格|部分测试局|无报表功能无热备容灾
部分测试局|商用小规格|无报表功能有EDR功能无热备容灾
 说明： 
商用大规格(hg)场景目前仅用于测试，无商用场景。 
商用大规格和商用大规格(cmcc)的区别：商用大规格中OMU/AMU虚机的规格：内存为24
G，硬盘为110 G。商用大规格(cmcc)中OMU/AMU虚机的规格：内存为32 G，硬盘为410 G。 
##### 安装方式 
ZXUN RCP部署支持MANO手工部署和iDeploy自动部署两种方式。现场部署时可参考下表，选择合适的部署方式完成RCP的实例化部署。
产品和功能|MANO手工部署|iDeploy自动部署
---|---|---
TECS+中兴通讯MANO（R50s、CloudStudio）|√|√
第三方VIM或MANO|√|×
#### 安装流程 
ZXUN RCP软件安装流程参见[表1]。
步骤|操作|说明|参考
---|---|---|---
1|安装前准备|安装前的准备工作。|安装准备
2|创建虚拟资源|创建实例化VNF所需的虚拟资源。|创建虚拟资源
3|部署VNF|上传、注册VNF版本包以及实例化VNF。|部署VNF
4|（可选）去激活服务或激活预埋服务|部分局点需要根据规划激活预埋服务或者去激活服务。|激活预埋服务（可选）去激活服务（可选）
5|配置虚机弹扩|要根据商务合同，将各个虚机的数量弹扩到要求的数量。|配置虚机弹扩
6|安装后检查|部署VNF后，为确保部署成功，需进行相应的检查。|安装后检查
### 安装准备 
#### 软件准备 
##### 简介 
软件准备包括ZXUN RCP的版本安装软件和调试机上需要安装的软件。
##### 版本软件 
安装ZXUN RCP需要准备相关的软件包参见“[上传版本包]”。
##### 调试机的软件配置要求 
调试机的功能参见[表1]。
类别|描述
---|---
与VIM通信|作为VIM客户端。在本文档中，作为客户端，访问中兴通讯自研的云平台管理软件TECS OpenStack。
与VNFM和NFVO通信|作为VNFM和NFVO的客户端。在本文档中，作为客户端，访问中兴通讯自研的NFVI资源编排和管理软件NFVO。
与NFVI通信|以SSH方式访问作为控制节点或计算节点的硬件服务器。
存放版本文件|将ZXUN RCP的版本安装软件从客户端上传到NFVI。
调试机中需要安装的软件参见[表2]。
软件类型|备注
---|---
操作系统|建议安装Windows 7或更高级的版本。
浏览器|只支持Google Chrome，操作员需要通过Google Chrome浏览器登录到TECS OpenStack和NFVO的图形化操作页面。
FTP或SFTP工具|将ZXUN RCP的版本文件从客户端上传到NFVI上。
远程访问工具|访问作为控制节点或计算节点的硬件服务器。
#### 默认用户名和密码 
在安装过程中涉及到系统默认的用户名及密码参见[表1]。
 小心！ 
部署完成后，请立即登录并修改所有帐号的默认密码。 
建议定期修改密码，防止密码被盗窃和破解。 
系统|用户名及密码
---|---
NFVO/VNFM客户端（CloudStudio）|用户名：admin密码：Zenap_123
NFVO/VNFM操作系统（CloudStudio）|用户名：root密码：CloudStudio__123（此处为双下划线）
NFVO/VNFM客户端（ElasticNet UME R50s）|用户名：admin密码：Zenap_123
PaaS操作系统（ElasticNet UME R50s）|用户名：ubuntu密码：UbuntU1!2@3#4$
安全加固后的PaaS操作系统（ElasticNet UME R50s）|用户名：pict密码：PicT1!2@3#4$
TECS OpenStack|登录TECS OpenStack客户端的默认用户名及密码如下：TECS OpenStack V3.17.14版本以上用户名：admin密码：KeystoneTECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123
登录主机的操作系统的默认用户名及密码如下：用户名：通过tecs用户登录，使用sudo -i命令切换到root用户密码：ossdbg1|TECS OpenStack
### 网络数据规划 
#### 基础数据规划 
##### 虚拟环境资源规划 
ZXUN RCP的虚拟环境资源规划参见[表1]。
资源规划|作用|示例
---|---|---
项目|项目又称为租户。TECS OpenStack以项目的方式实现各个虚拟VNF之间虚拟资源的隔离。同一个VNF内的主机、网络等资源归属到同一项目。|项目名称：admin（系统默认的项目，无需创建）。项目名称：PROJ-RCP-1。ZXUN RCP需要创建一个项目。例如，PROJ-RCP-1项目。此项目主要是部署与ZXUN RCP相关的一些网络平面和VM，操作参见“创建项目”。
用户|登录VIM云平台管理软件TECS OpenStack的账号，需要为用户指定其所属的项目。|ZTE TECS OpenStack默认的用户，无需创建。TECS OpenStack V3.17.14版本以上用户名：admin密码：KeystoneTECS OpenStack V6.10.10版本以上用户名：SysAdmin密码：SysAdmin_123用户名称：ZXUN RCP。通常情况下，除了TECSOpenStack默认的用户之外，还需要为每个项目都创建一个用户。例如，为PROJ-RCP-1项目创建一个用户为ZXUN RCP，操作参见“创建用户”。该ZXUN RCP用户仅可管理PROJ-RCP-1项目，而admin用户可以管理所有的项目。
##### VM类型 
ZXUN RCP的VM类型参见[表2]。
虚机类型|功能描述
---|---
OMU|对接CN-OAM（核心网集中网管），管理整局上电、版本加载、配置同步、网管命令执行、告警和性能统计汇总、各服务弹缩控制等功能。
IPU|IP接口虚拟机，收发IP承载的控制面信令和用户面报文。
GSU（HTTP LB）|HTTP负荷分担服务，实现HTTP协议消息分发。
GSU（SIG LB）|信令负荷分担服务，实现Diameter和SMS消息分发。
GSU（PolicyControl）|处理PCF和PCRF业务逻辑，提供AMPolicyControl、UEPolicyControl、SMPolicyControl和PolicyAuthorization服务。
GSU（GW）|UDSF统一接入网关。
CDU|UDSF数据存储单元。
LOG|策略日志单元，产生策略日志并存入云盘或LSU，并可通过SFTP上传给外部服务器。
LSU|策略日志存储单元，用于策略日志分析。
各业务模块VM支持的工作模式参见[表3]。
VM类型|工作模式
---|---
OMU|1+1+1冗余备份
IPU|N+1
GSU|N+1
CDU|1+1
LOG|N+1
LSU|N+1
#### 组网数据规划 
##### SDN组网数据规划 
概述 :SDN组网架构，需要配置如下数据： 
操作员需要事先在VIM云平台（本文档指中兴通讯的TECS OpenStack）创建所有的网络平面，且每个网络平面的属性需要设置为VXLAN，参见“创建网络平面”。 
ZXUN RCP的外部网络平面需要启用VLAN TRUNK功能。 
###### 网络平面规划 
网络平面是指各个VM通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN RCP规划的网络平面分为三类，参见[表1]。
网络平面|描述|部署原则
---|---|---
网管平面|ZXUN RCP的OMU虚机和VIM、NFVO进行通信的网络平面。|部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。
内部网络平面|内部网络平面是指ZXUN RCP中的各个虚机之间进行数据通信的网络平面。|规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。|SDN组网架构，在启用VLAN Trunk功能的情况下，规划一个parent（父）网络平面和N个child（子）网络平面，将所有child（子）网络平面都配置在parent（父）网络平面的VLAN Trunk子接口中，具体操作参见“VLAN Trunk功能配置示例”。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。 
网络平面示例|描述
---|---
网管平面|ZTE_EMS_NET|网管平面|NFVO服务器、NFVO客户端、ZXUN RCP的OMU虚机和VIM进行通信的网络平面。
内部网络平面|内部控制平面|ZTE_PCF_x_MGT_INT_NET|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面。
内部媒体平面|内部网络平面|ZTE_PCF_x_SERVICE_INT_NET|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面。
外部网络平面|parent（父）网络平面|ZTE_PCF_x_EXT_NET|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
child（子）网络平面|外部网络平面|ZTE_PCF_x_SBI_EXT_NET|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
ZTE_PCF_x_SIG_EXT_NET|child（子）网络平面|外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
ZTE_PCF_x_DATA_EXT_NET|child（子）网络平面|外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
ZTE_PCF_x_SMS_EXT_NET|child（子）网络平面|外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
ZTE_PCF_x_LOG_EXT_NET|child（子）网络平面|外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
###### VM对应的网络平面 
ZXUN RCP的各个VM关联的网络平面参见[表3]。
VM|网络平面
---|---
OMU|ZTE_EMS_NET
ZTE_PCF_x_MGT_INT_NET|OMU
ZTE_PCF_x_SERVICE_INT_NET|OMU
CDUGSULOGLSU|ZTE_PCF_x_MGT_INT_NET
ZTE_PCF_x_SERVICE_INT_NET|CDUGSULOGLSU
IPU|ZTE_PCF_x_MGT_INT_NET
ZTE_PCF_x_SERVICE_INT_NET|IPU
ZTE_PCF_x_EXT_NET|IPU
ZTE_PCF_x_SBI_EXT_NET|IPU
ZTE_PCF_x_SIG_EXT_NET|IPU
ZTE_PCF_x_DATA_EXT_NET|IPU
ZTE_PCF_x_SMS_EXT_NET|IPU
ZTE_PCF_x_LOG_EXT_NET|IPU
##### 非SDN组网数据规划 
概述 :非SDN组网架构，需要配置如下数据： 
操作员需要事先在VIM云平台（本文档指中兴通讯的TECS OpenStack）创建所有的网络平面，且每个网络平面的属性需要设置为VLAN，参见“创建网络平面”。 
ZXUN RCP的外部网络平面不需要启用VLAN TRUNK功能，启用VLAN透传。 
###### 网络平面规划 
网络平面是指各个VM通讯时所采用的逻辑网络，其目的是为了实现网络隔离，ZXUN RCP规划的网络平面分为三类，参见[表1]。
网络平面|描述|部署原则
---|---|---
网管平面|ZXUN RCP的OMU虚机和VIM、NFVO进行通信的网络平面。|部署在同一个VIM上的所有的NF可以共用一个网管平面，每个NF也可以规划自己单独的网管平面，需要根据运营商的实际要求要规划。
内部网络平面|内部网络平面是指ZXUN RCP中的各个虚机之间进行数据通信的网络平面。|规划两个内部网络平面，包括内部控制平面和内部媒体平面。
外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。|在运营商的实际组网环境中，对外通信网络平面可以只规划一个，也可以根据ZXUN RCP对外通信接口的类型细分为N个。
 说明： 
本文档中的各项资源名称仅为示例，当运营商对资源名称有特殊要求时，需要根据其定义的规范来进行命名。 
在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。 
网络平面示例|描述
---|---
网管平面|ZTE_EMS_NET|网管平面|NFVO服务器、NFVO客户端、ZXUN RCP的OMU虚机和VIM进行通信的网络平面。
内部网络平面|内部控制平面|ZTE_PCF_x_MGT_INT_NET|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面。
内部媒体平面|内部网络平面|ZTE_PCF_x_SERVICE_INT_NET|内部网络平面是指PROJ-RCP-1项目（即ZXUN RCP）中的各个VM之间进行数据通信的网络平面，通常规划两个内部网络平面，包括内部控制面和内部媒体面。
外部网络平面|ZTE_PCF_x_EXT_NET|外部网络平面|外部网络平面是指ZXUN RCP与外部接口进行通信的网络平面。外部网络平面可以规划多个。
###### VM对应的网络平面 
ZXUN RCP的各个VM关联的网络平面参见[表3]。
VM|网络平面
---|---
OMU|ZTE_EMS_NET
ZTE_PCF_x_MGT_INT_NET|OMU
ZTE_PCF_x_SERVICE_INT_NET|OMU
CDUGSULOGLSU|ZTE_PCF_x_MGT_INT_NET
ZTE_PCF_x_SERVICE_INT_NET|CDUGSULOGLSU
IPU|ZTE_PCF_x_MGT_INT_NET
ZTE_PCF_x_SERVICE_INT_NET|IPU
ZTE_PCF_x_EXT_NET|IPU
### 创建虚拟资源 


ZXUN RCP的软件是运行在云平台管理系统TECS OpenStack的虚拟机环境中。虚拟机指通过软件模拟的具有完整硬件系统功能的、运行在一个完全隔离环境中的完整计算机系统。


ZXUN RCP所运行的虚拟环境包括了各种虚拟资源，如：主机、内存、CPU、网口。管理员可通过WEB方式登录TECS
OpenStack，创建并启动虚拟资源。


#### 登录TECS OpenStack 
摘要 :本节介绍如何使用Google Chrome浏览器登录TECS OpenStack管理系统，以便配置相关数据，进行实例化VNF的操作。
相关信息 :ZXUN RCP的软件可以运行在中兴通讯的VIM（TECS OpenStack云平台）中，也可以在第三方厂商提供的VIM中运行。
管理员可通过WEB方式登录TECS OpenStack管理系统，创建并启动虚拟资源。
TECS OpenStack提供的基于WEB方式的图形化操作界面，原理与OpenStack的dashboard组件类似。OpenStack是一种开源标准接口，包括了很多标准组件，dashboard是其中的一种组件，功能主要是提供WEB方式与外界进行交互。操作员能够使用WEB页面与OpenStack提供的各种服务进行交互。
步骤 :在PC客户端，打开Google Chrome浏览器，在地址栏输入https://IP地址/ngportal/login
。
地址填写说明参见[表1]。
参数|说明
---|---
IP地址|TECS OpenStack客户端通过此地址可以使用浏览器访问TECS OpenStack，例如10.255.200.17。
按Enter键，页面自动转到登录页面，如[图1]所示。
图1  TECS OpenStack登录页面

输入用户名和密码，单击登录按钮，进入TECS OpenStack，默认显示为总览页面，如[图2]所示。
 说明： 
TECS OpenStack默认的用户名和密码参见“[默认用户名和密码]”。
图2  TECS OpenStack总览页面

#### 创建用户 
摘要 :本节介绍如何创建用户，操作员可以通过创建的用户接入TECS OpenStack云平台。 
当一个VIM云平台同时管理运营商的多个VNF时，为隔离不同运营商的VNF，需要使用不同的用户来接入。
TECS OpenStack支持多用户接入。不同的用户，在TECS OpenStack上可以拥有不同的操作权限和资源访问范围，可以为每一个项目创建一个用户。 
 说明： 
系统默认的用户和密码参见[默认用户名和密码]，默认用户无需创建。
本文档中的ZXUN RCP用户、用户权限及该用户密码仅为示例，现场需要根据实际规划创建。 
相关信息 :一个TECS OpenStack可以管理不同运营商的多个VNF。为了区别各个运营商的VNF，TECS OpenStack以项目的方式实现各个VNF之间虚拟资源的隔离，将同一个NFVO或同一个VNF内的主机、网络等资源归属到同一项目。
步骤 :在TECS OpenStack的客户端，切换到系统管理页面，在左侧的导航栏中选择系统安全管理→用户
，出现用户页面，如[图1]所示。
图1  用户管理页面

 说明： 
admin用户是TECS OpenStack默认的用户，无须创建。 
单击创建用户按钮，如[图2]所示。
图2  基本信息区域框

基本信息区域框中的参数说明参见[表1]。
参数名称|参数说明
---|---
域|根据项目进行选择，默认为Default。
用户名|该参数用于设置接入TECS OpenStack的用户名称，根据规划的数据进行设置，本文档规划创建一个名称为ZXUN RCP的用户，供PROJ-RCP-1项目使用。
密码|用户登录时使用的密码。密码必须包含大写字母、小写字母和数字中的至少两种字符。
确认密码|再次输入用户的密码，确认密码必须与密码一致。
邮箱|非必选参数，操作员可根据实际情况设置。
下次登录修改密码|下次登录是是否修改密码。不建议勾选该参数。
项目|选择创建的用户归属于哪个项目。
角色|该参数用于设置用户的角色。prj_manager如果此用户对应的操作权限和资源访问范围为各个项目，则需要勾选prj_manager。SystemObserverAlarmObserverReadOnlyPmObserverHardwareObserverHardwareManageradmin建议项目的用户权限设置为勾选prj_manager或根据需要选择。
描述|对用户的补充说明，非必选参数，操作员可根据实际情况设置。
用户知情|勾选该参数。
单击确定按钮，用户创建成功，结果如[图3]所示。
图3  用户创建成功

#### 创建项目 
摘要 :项目又称为租户，TECS OpenStack以项目的方式来隔离各个VNF所占用虚拟资源，同一个VNF内的主机、端口等虚拟资源归属到同一项目。
TECS OpenStack安装成功后，TECS OpenStack自动生成的默认项目，名称为admin和service，这两个项目无须操作员创建。根据规划数据，操作员还需要创建一个属于ZXUN RCP的项目，为PROJ-RCP-1。
 说明： 
PROJ-RCP-1仅为示例，实际环境中的名称请以运营商规划为准。 
相关信息 :TECS OpenStack从运维的角度出发，为了更合理的管理虚拟资源，定义了项目和用户的概念，在进行本节的操作前，需要了解以下相关信息。 
项目一个TECS OpenStack可以管理不同运营商的多个NFVO或VNF。为了运维的安全性，TECS OpenStack以项目的方式实现各个NFVO或VNF所占有的虚拟资源的隔离，通常情况下，规划将同一个NFVO或同一个VNF内的主机、网络等资源归属到同一项目。 
用户在实际操作环境中，操作员通过各个用户接入TECS OpenStack。不同的用户，在TECS OpenStack上可以拥有不同的操作权限和资源访问范围。这些用户预先已定义好分别属于各个项目，拥有各个项目对应的操作权限和资源访问范围。 说明：系统默认的用户和密码参见“默认用户名和密码”，默认用户无需操作员创建，该用户同时拥有云管理和项目管理两大类权限。 
项目和用户的关系在TECS OpenStack创建一个用户，设置此用户对应的权限。在后续创建项目时，可以根据实际情况，将某个用户加入到项目中（将用户加入到项目的过程即为将此用户对应的权限赋予项目，表示使用此用户登录后，可以管理此项目的资源）。通常情况下可以为每一个项目创建项目本身所属的用户。TECS OpenStack默认的系统默认的用户admin，可以供所有的项目使用。本文档规划ZXUN RCP的项目PROJ-RCP-1使用该项目的用户ZXUN RCP进行管理，即在创建PROJ-RCP-1项目后，再将admin用户和ZXUN
RCP的权限赋予PROJ-RCP-1项目。 
步骤 :创建ZXUN RCP的项目PROJ-RCP-1
在TECS OpenStack的主页面，切换到云管理页面，在云管理页面左侧的导航栏中选择资源管理→项目列表
，出现项目页面，如[图1]所示。
图1  项目页面

名称为admin的项目是TECS OpenStack自动生成的默认项目，此项目无须操作员创建。 
单击添加项目按钮，弹出添加项目对话框，如[图2]所示。
图2  添加项目对话框

配额参数说明参见[表1]。
 说明： 
本节设置的配额是ZXUN RCP对应的项目PROJ-RCP-1使用的配额。
参数|配置说明
---|---
名称|项目的名称，取值范围：0~245个字符，根据示例设置为PROJ-RCP-1。
域|该项目所属的可用域。可用域（Availability Zones）可以简单理解为一组主机的集合，这组主机具有独立的电力供应设备。比如一个独立供电的机房中的所有主机可以被划分成一个可用域（AvailabilityZones），一个独立供电的机架上的所有主机也可以被划分成一个可用域（Availability Zones）。可用域是通过VIM云平台管理系统（如中兴通讯的TECS OpenStack）设置的。域是一个用户可见的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。
描述|对项目名称的补充说明，非必选参数，操作员可根据实际情况设置。
实例|为ZXUN RCP对应的项目PROJ-RCP-1分配的虚拟主机数量。该项目中启动的虚拟主机的个数总和不得超过该参数值。需要根据实际情况来配置，默认值为10，建议设置的数量=ZXUN RCP虚机的总数×2。
VCPU|为ZXUN RCP对应的项目PROJ-RCP-1分配的虚拟内核数量。该项目中启动的虚拟主机的内核数总和不得超过该参数值。需要根据实际情况来配置，默认值为20，建议设置的数量=40×ZXUN RCP物理刀片个数（计算节点）×2。
内存(GB)|为ZXUN RCP对应的项目PROJ-RCP-1分配的虚拟内存数量。需要根据实际情况来配置，默认值为50，ZXUN RCP的建议设置值为5120。
云硬盘|为ZXUN RCP对应的项目PROJ-RCP-1分配的虚拟硬盘数量。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
云硬盘快照|为ZXUN RCP对应的项目PROJ-RCP-1分配的云硬盘快照数量。硬盘快照保存硬盘的状态，不保存硬盘内容。创建快照后，可以把硬盘回复到创建快照时的状态。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
存储|为ZXUN RCP对应的项目PROJ-RCP-1分配的卷和快照的总大小。将虚拟硬盘划分不同的存储区域，这些存储区域就是卷。卷快照保存卷的状态，不保存卷内容。创建快照后，可以把卷回复到创建快照时的状态。卷与其快照空间大小的总和，单位：GB。需要根据实际情况来配置，默认值为1000，建议设置的数量=600×ZXUN RCP物理刀片个数（计算节点）×2。
元数据条目|为ZXUN RCP对应的项目PROJ-RCP-1分配的元数据条目数。需要根据实际情况来配置，默认值为128，建议放大10倍，设置为1280。
密钥对|为ZXUN RCP对应的项目PROJ-RCP-1分配的密钥对。
可注入的文件|为ZXUN RCP对应的项目PROJ-RCP-1可注入的文件的数量。需要根据实际情况来配置，默认值为5，建议放大10倍，设置为50。
注入文件路径最大长度|为ZXUN RCP对应的项目PROJ-RCP-1可注入的注入文件路径最大长度。
可注入文件大小（Bytes）|为ZXUN RCP对应的项目PROJ-RCP-1可注入文件的大小。单位：字节。需要根据实际情况来配置，默认值为10240，建议放大10倍，设置为102400。
浮动IP|ZXUN RCP对应的项目PROJ-RCP-1可配置的浮动IP个数。需要根据实际情况来配置，默认值为50，建议放大10倍，设置为500。
网络|ZXUN RCP对应的项目PROJ-RCP-1可配置的逻辑网络个数。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
端口|为该项目分配的虚拟端口个数。需要根据实际情况来配置，默认值为50，建议放大10倍，设置为500。
路由|ZXUN RCP对应的项目PROJ-RCP-1可配置的路由个数。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
子网|ZXUN RCP对应的项目PROJ-RCP-1分配的子网个数。需要根据实际情况来配置，默认值为10，建议放大10倍，设置为100。
防火墙|为该项目分配的防火墙个数。默认值：10。建议放大10倍，设置为100。
防火墙策略|为该项目分配的防火墙策略个数。默认值：10。建议放大10倍，设置为100。ZXUN RCP对应的项目PROJ-RCP-1可分配的防火墙策略个数。防火墙策略是多个iptables规则的集合，这些规则用来限制对虚拟机的访问流量，其目的是为了让TCP、UDP和ICMP三种协议报文可以正常通信。
防火墙规则|ZXUN RCP对应的项目PROJ-RCP-1可分配防火墙规则个数。防火墙规则就是iptables规则。可以定义n个防火墙策略，每个防火墙策略可以有m个防火墙规则，可以给每个项目绑定n个防火墙策略。默认值：100。建议放大10倍，设置为1000。
负载均衡|为该项目分配的负载均衡个数。默认值：10。建议放大10倍，设置为100。
虚机组|为该项目分配的虚机互斥组个数。该参数通常情况下使用10倍于默认值的数值即可。默认值为10，ZXUN RCP的建议设置值为100。
虚机组成员|为该项目分配的虚机互斥组成员个数。该参数通常情况下使用10倍于默认值的数值即可。默认值为10，ZXUN RCP的建议设置值为100。
RBAC策略|基于角色的权限访问控制策略。
子网池|默认值为-1。-1代表无限大。
单击创建按钮，项目PROJ-RCP-1创建成功，如[图3]所示。
图3  项目PROJ-RCP-1创建成功

将admin、ZXUN RCP和MANO这几个用户的权限赋予PROJ-RCP-1项目
在项目列表中，单击PROJ-RCP-1项目后面的编辑成员按钮，弹出编辑成员对话框，如[图4]所示。
图4  编辑项目成员对话框

项目创建成功，需要将admin用户、此项目对应的用户，及管理NFVO和VNFM的用户（本文档示例为MANO）加入到此项目中，作为此项目的成员。将用户加入成为某个项目的成员后，操作员使用该用户登录TECS
OpenStack后，可对该项目进行管理。 
 说明： 
admin用户是TECS OpenStack云平台管理系统默认的用户，无须创建。 
在编辑项目成员对话框左侧对应的可选用户列表框中，选择admin、MANO和ZXUN RCP，将其加入到编辑项目成员对话框右侧的项目成员列表中，结果如[图5]所示。
图5  为项目增加成员

单击确定按钮，为项目增加成员成功。
#### 添加网络QoS 
摘要本节描述配置云环境使用的QoS策略的操作步骤。网络QoS为预定义网络平面提供QoS控制策略。 
步骤 :添加网络QoS
在TECS OpenStack管理系统中单击云管理，在左侧节点树中单击网络→网络QoS
节点，打开网络QoS页面，如[图1]所示。
图1  QoS页面

单击添加QoS按钮，打开添加QoS页面，如[图2]所示。
图2  添加QoS

设置网络QoS参数，参数说明参见[表1]。
参数名|参数说明
---|---
名称|用户自定义的POLICY名称，不可与现有的POLICY名称相同。
描述|自定义对POLICY名称的描述。
共享|表示是否共享POLICY。勾选本选项，所有虚机都可见该POLICY。
项目|在下拉列表中选择目标项目的名称。添加项目的具体操作参见"创建项目"。
单击添加按钮。
添加QoS带宽
在网络QoS页面单击需要添加QoS带宽的QoS名称，打开网络QoS详情页面，如[图3]所示。
图3  网络QoS详情页面

单击添加QoS带宽按钮，打开添加QoS带宽页面，如[图4]所示。
图4  添加QoS带宽页面

设置QoS带宽参数，参数说明参见[表2]。
参数名|参数说明
---|---
方向|单击添加QoS带宽后显示该参数。egress：报文流出虚机的方向。ingress：报文流向虚机的方向。
最大带宽(kbps)|单击添加QoS带宽后显示该参数。该参数表示带宽限制值。
最大突发带宽(kbps)|单击添加QoS带宽后显示该参数。该参数表示允许高于最大带宽的数值。
单击添加按钮。
添加DSCP规则
在网络QoS页面单击需要添加DSCP规则的QoS名称，打开网络QoS详情页面，如[图5]所示。
图5  网络QoS详情页面

单击DSCP规则按钮，打开DSCP规则创建页面，如[图6]所示。
图6  DSCP规则页面

设置DSCP值，参数说明参见[表3]。
参数名|参数说明
---|---
DSCP|DSCP优先级取值范围：0，8~56之间的偶数（不包括42、44、50、52、54）。数字越小，则表示优先级越高。
单击创建按钮。
##### 相关操作 
添加网络QoS完成后，可执行如下操作。 
如果...|那么...
---|---
删除网络QoS|在网络QoS页面中，勾选待删除的网络QoS名称，单击删除按钮。
编辑网络QoS|在网络QoS页面的操作列中，单击编辑按钮，对已添加的网络QoS进行编辑。
#### 创建网络平面 
摘要 :本节介绍如何创建PROJ-RCP-1项目的网络平面及其子网。 
步骤 :创建网络平面
在TECS OpenStack的客户端上，切换到云管理页面，在左侧导航栏中选择资源管理→网络
，右侧出现网络区域框，如[图1]所示。
图1  网络区域框

单击添加网络按钮，弹出添加网络对话框，如[图2]所示。
图2  创建网络对话框

创建网络对话框中的参数说明参见[表1]。
参数名称|参数说明
---|---
基本信息|项目|该参数用于设置该网络平面属于的项目。根据规划的数据进行创建。从下拉列表中选择，其中PROJ-RCP-1项目是通过“创建项目”操作创建的。
名称|基本信息|该参数用于设置网络平面的名称。根据规划的数据进行创建。
网络类型|基本信息|该参数用于设置网络平面的网络类型，需要根据运营商的实际网络环境进行设置，包括以下选项。flat：FLAT网络是指扁平网络，即云平台不对业务网络进行VLAN隔离，只能依赖外部交换机过滤VLAN报文。从安全的角度考虑，在商用环境中，一般不建议使用flat网络类型。vlan：如果运营商的组网环境为非SDN，选择vlan。设置为此选项时，还需要设置物理网络和透传VLAN两个参数。vxlan：如果运营商组网环境为SDN，建议选择vxlan。VXLAN是一种网络虚似化技术，是对VLAN技术的进一步优化，VXLAN提供和VLAN相同的二层网络服务，但相比VLAN有更大的扩展性和灵活性，用于解决在部署大型云计算设备时的数量扩展问题。
物理网络|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面对应的物理网络名称，根据规划数据，PROJ-RCP-1项目所有网络平面对应的物理网络名称都规划为physnet1。
VLAN透传|基本信息|当网络类型设置为vlan时，必须设置该参数。该参数用于设置此网络平面是否支持VLAN透传功能。根据规划数据，PROJ-RCP-1项目的外部网络平面，建议勾选此参数。
段ID|基本信息|该参数用于设置设置VLAN ID。如果该网络平面支持VLAN透传功能，必须设置VLAN子接口范围。即段ID的格式需要设置为××:××:××，三个值分别表示为起始VLAN、终止VLAN和Native VLAN（PVID）。
高级属性|MTU|该参数表示VNF的MTU数值。如果运营商没有特殊要求，则内部控制网络平面和内部媒体网络平面的MTU固定配置为1800，其他网络平面固定设置为1500。如果运营商对MTU有特殊要求，则需要根据运营商的规范进行设置。
网络QoS|高级属性|该参数用于设置是否启用网络QoS控制策略，网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。
管理状态|高级属性|该参数建议保持默认值。
共享|高级属性|表示此网络平面属性是否为共享网络。在非SDN组网架构下，建议所有的网络平面都设置为shared（共享）类型。在SDN组网架构下，建议外部业务网络都需要设置为shared（共享）类型，建议将内部二层互通的网络平面设置为no_shared（不共享）类型。
外部网络|高级属性|默认情况下，建议不需要勾选。
参数设置完成后，单击创建按钮，完成网络平面的设置。
重复执行[步骤2]~[步骤3]，创建所有的网络平面。
创建子网
在TECS OpenStack的客户端，切换到云管理页面，在左侧的导航栏中选择网络
→网络
，出现网络页面，可以看到已经创建成功的网络平面。
在网络平面对应的操作下拉列表中，单击选择创建子网，弹出创建子网对话框，如[图3]所示。
图3  创建子网对话框

创建子网对话框的参数说明参见[表2]。
参数名称|描述
---|---
基本信息|名称|表示网络平面对应的子网名称，根据规划的数据进行设置。
CIDR|基本信息|表示子网的地址，根据规划的数据进行设置。
项目|基本信息|从下拉列表中选择网络平面对应的项目。
激活DHCP|基本信息|勾选此选项，开启DHCP功能后，在TECS OpenStack创建虚机时，会自动为虚机分配此网络平面的IP地址。需要根据实际情况决定是否开启此功能。
禁用网关|基本信息|该参数表示子网是否需要设置网关地址。对于ZXUN RCP网元内部通讯的网络平面，勾选本参数。对于ZXUN RCP网元外部通讯的网络平面，如果采用非SDN的VLAN组网，勾选本参数。对于ZXUN RCP网元外部通讯的网络平面，如果采用SDN+VxLAN组网，不勾选本参数。采用SDN+VxLAN组网时，需要在SDN中配置路由，因此必须配置网关IP地址，该网关地址会通过TECS传递给SDN控制器。
网关IP|基本信息|该参数表示网关地址，勾选禁用网关后，无需设置该参数。
高级属性|地址池|暂不涉及此参数，无需配置。
域名服务器|高级属性|暂不涉及此参数，无需配置。
主机路由|高级属性|暂不涉及此参数，无需配置。
设置完参数后，单击创建按钮，完成网络平面对应子网的创建。
重复执行[步骤6]~[步骤7]，创建所有的子网。
### 部署VNF 


完成网络平面的创建后就可以进行VNF的部署。


#### 登录NFVO客户端 
摘要 :NFVO泛指以下三种产品：
CloudStudio(NFVO) 
CloudStudio(GSO) 
ElasticNet UME R50s 
登录NFVO客户端后，可以在NFVO客户端上完成ZXUN RCP的VNF部署操作。
步骤 :打开浏览器，在地址栏中选择输入以下地址，登录NFVO客户端。 
如果…|那么…
---|---
登录CloudStudio(NFVO)客户端|输入https://<NFVO服务端IP>:28808/nfvo-mano-portal地址。
登录CloudStudio(GSO)客户端|输入https://<EMS网络平面浮动IP>:28808/nfvo-mano-portal地址。
登录ElasticNet UME R50s客户端|输入https://<EM服务端IP>:28808/em-portal地址。
按Enter键，在登录对话框中输入用户名和密码。
 说明： 
NFVO客户端默认的用户名和密码参见“[默认用户名和密码]”。
单击登录按钮，进入NFVO主页面。
#### 上传版本包 
摘要 :本节介绍VNF版本包的准备过程，主要过程如下：
上传基础包 
上传并注册镜像包 
上传业务软件包 
相关信息 :实例化ZXUN RCP前，需要事先获取ZXUN RCP的版本包，参见[表1]。
版本包类型|说明|版本包名称|获取路径
---|---|---|---
基础包|基础包也称部署插件包，包含了虚机部署info.xml文件、policy.xml文件等，该插件包描述了需要部署的虚机、虚机规格大小、部署的业务容器、容器实例个数等信息。|pcf_vnfd.VXXX.csar|/RCPVXXX/versions/IAAS/pcf/vnfd
镜像包|镜像包是创建虚机时使用的CGSL操作系统镜像文件包（通常包含操作系统和双机软件）。|cgsl.YYY.zip|/RCPVXXX/versions/IAAS/images
业务软件包|业务软件包是ZXUN RCP完成公共服务及特定业务的软件包。|PCF_VXXX.zip|/RCPVXXX/versions/IAAS/pcf/version
XXX表示ZXUN RCP具体的版本号，以实际版本为准。
YYY代表对应VIM云平台管理系统（如TECS OpenStack）版本号，以实际版本为准。 
步骤 :上传基础包
（可选）采用FTP方式或SFTP方式将基础包导入NFVO时，需要提前通过FTP工具将ZXUN RCP的基础包文件以二进制方式上传至NFVO服务器指定路径下，例如：NFVO服务器的/home/ngomm/nfvo_<网元编号>/ftp/VmVersion/vCN
路径。
 说明： 
通过FTP工具上传文件时，登录服务器的用户名和密码参见“默认用户名和密码”。 
如果现场MANO做了安全加固，请将基础包上传到能与NFVO服务器正常通讯的版本服务器上。 
在现场网络质量良好的情况下，可以参考“NFVO打开版本包本地上传选项”，打开本地上传选项，通过本地方式导入基础包。 
选择执行以下步骤，进入软件仓库页面。
如果…|那么…
---|---
使用ElasticNet UME R50s客户端|执行步骤3
使用CloudStudio(GSO)/CloudStudio(NFVO)客户端|执行步骤4
在ElasticNet UME R50s客户端，选择菜单端到端编排→设计中心
，在界面右侧默认显示软件仓库页面，如[图1]所示。
图1  软件仓库

在CloudStudio(GSO)/CloudStudio(NFVO)客户端，选择菜单编排→设计→软件仓库
， 在界面右侧显示软件仓库页面，如[图2]所示。
图2  软件仓库

单击导入按钮，弹出导入对话框，如[图3]所示。
图3  导入对话框

导入基础包的参数说明参见[表2]。
参数名称|参数说明
---|---
导入方式|该参数表示导入版本文件包的方式，支持FTP、SFTP及本地文件导入。
IP和端口|ZXUN RCP的基础包所存放的设备（作为FTP服务器，提供FTP服务）的IP地址，一般为NFVO服务器的IP地址。使用ftp时，端口号默认为21。使用sftp时，端口号默认为22。
用户名|访问FTP服务器的用户名。如果使用NFVO服务器作为FTP服务器，则默认用户名为root。
密码|访问FTP服务器的密码。如果使用NFVO服务器作为FTP服务器，则默认的密码为CloudStudio__123，其中__为两个下划线。
文件路径|FTP服务器上存放ZXUN RCP的基础包路径，此处需要设置为绝对路径。可设置为基础包的具体文件所在路径或上一级目录。设置为目录时，可上传该目录下的所有包。
本地文件|当导入方式选择本地文件时，显示本参数。单击选择文件选中本地的版本文件。
输入相关参数后，单击提交按钮。
NFVO系统开始从指定路径中下载基础包，下载进度显示在对话框的下方，当导入进度为100%时表示导入完成。 
基础包导入完成后，单击完成按钮。
基础包显示在VNF页面中，如[图4]所示。
图4  基础包状态

上传镜像包
（可选）采用FTP方式或SFTP方式将基础包导入NFVO时，需要提前通过FTP工具将ZXUN RCP的基础包文件以二进制方式上传至NFVO服务器指定路径下，例如：NFVO服务器的/home/ngomm/nfvo_<网元编号>/ftp/VmVersion/vCN
路径。
在NFVO客户端的软件仓库页面中，切换到虚机镜像页面，如[图5]所示。
图5  虚机镜像页面

重复步骤[5]~[6]，在虚机镜像页面导入镜像文件cgsl.YYY.zip
。
镜像包导入完成后，单击完成按钮。
镜像包显示在虚机镜像页面中，对应的状态为未注册，是否注册显示为否，如[图6]所示。
图6  导入镜像包

选择要注册的镜像包，在镜像包对应该操作栏中，单击注册按钮，弹出注册对话框，如[图7]所示。
图7  注册镜像包

 说明： 
在NFVO客户端的菜单栏中选择系统→NFVO→接入管理
，单击左侧导航树中的接入管理→VIM
节点，可以查看所有的VIM信息。
勾选需要注册的VIM，单击注册按钮，NFVO系统解压镜像包，并将镜像文件上载到VIM云平台。当进度为100%时表示镜像包注册成功，如[图8]所示。
图8  注册镜像包

镜像包注册成功后，单击返回按钮，回到虚机镜像页面，镜像包的状态由未注册变为正常，如[图9]所示。
图9  镜像包注册成功

上传业务软件包
（可选）采用FTP方式或SFTP方式将基础包导入NFVO时，需要提前通过FTP工具将ZXUN RCP的基础包文件以二进制方式上传至NFVO服务器指定路径下，例如：NFVO服务器的/home/ngomm/nfvo_<网元编号>/ftp/VmVersion/vCN
路径。
在NFVO客户端的软件仓库页面中，切换到软件页面，如[图10]所示。
图10  软件页面

重复步骤[5]~[6]，在软件页面导入业务软件包。
业务软件包导入完成后，单击完成按钮。
业务软件包显示在软件页面中，对应的状态为正常，如[图11]所示。
图11  导入业务软件包

#### 快速创建VNF部署包 
摘要 :本节介绍基于基础包、业务软件包、镜像包，快速创建满足运营商需求的VNF部署包的过程。
步骤 :在NFVO客户端中，切换到设计页面，单击左侧导航树中的蓝图中心，页面右侧默认显示VNF页面，如[图1]所示。
图1  VNF列表

单击快速创建按钮，打开快速创建页面，如[图2]所示。
图2  快速创建对话框

快速创建VNF部署包的参数说明参见[表1]。
参数名称|参数说明
---|---
创建方式|选择核心网方式。
新包名称|设置版本部署包的名称，根据实际情况，由操作员进行设置，如vPCF。
新包版本号|本部署包的版本号，根据实际情况，由操作员进行设置，如V7。
新包提供商|提供版本部署包的厂商的名称，根据实际情况设置。由操作员进行设置，如zte。
基础包|从下拉列表中选择通过“上传版本包”操作中已经上传的基础包。
场景|从下拉列表中选择部署NF的规格。商用局的场景参见表2。
引用镜像包|从下拉列表中选择通过“上传版本包”操作中已经注册的镜像包。
引用业务软件包|从下拉列表中选择通过“上传版本包”操作中已经上传的业务软件包。
商用规格|适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活/去激活预埋服务
---|---|---|---|---|---|---|---
商用大规格(cmcc)|中国移动数据局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务激活Npcf_LogStoreUnit服务
中国移动语音局|商用大规格(cmcc)|无报表功能无热备容灾|有|无|无|无|无
中国移动物联网局点|商用大规格(cmcc)|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务激活Npcf_LogStoreUnit服务
商用大规格|中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF|有|有|无|无|激活Ncudr_Access服务
中国电信非UDSF局|商用大规格|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务去激活Ncudr_SystemManagement服务回收CDU虚机激活Ncudr_AccessManagement服务激活Ncudr_Access服务
国际通用局点|商用大规格|无报表功能无热备容灾|有|无|无|无|无
部分国际局|商用大规格|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务
商用小规格|部分测试局|无报表功能无热备容灾|有|无|无|无|无
部分测试局|商用小规格|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务
 说明： 
商用大规格(hg)场景目前仅用于测试，无商用场景。
 说明： 
ZXUN RCP产品V7.21.30版本后启用了“服务预埋”功能，即部署VNF时预埋Npcf_LOG服务、Npcf_LogStoreUnit服务和Ncudr_Access服务，默认不实例化，在需要该服务时再激活服务，具体操作参见“[激活预埋服务（可选）]”。
对于无UDSF的场景，需要去激活UDSF相关服务，具体操作参见“[去激活服务（可选）]”。
单击下一步，出现参数设置页面，在参数设置区域框中，会出现对应的参数页面列表，如[图3]所示。
图3  参数设置

 说明： 
可单击导入按钮，在弹出的对话框中导入已按规划修改后的info文件的zip包，统一修改参数；或双击各参数右侧的取值，根据实际规划编辑参数值，参数说明参见“[Info文件参数说明]”
。
单击提交按钮，NFVO系统开始快速创建VNF部署包，进度为100%表示创建成功，如[图4]所示。
图4  VNF部署包创建成功

单击返回列表按钮，返回蓝图中心。
此时VNF部署包对应的状态为草稿，如[图5]所示。
图5  草稿状态

#### 注册VNF部署包 
摘要 :本节介绍如何在NFVO上注册快速创建的VNF部署包。
注册版本部署包分为两步操作： 
发布版本部署包。 
注册已经成功发布的版本部署包。 
步骤 :发布版本部署包
在NFVO客户端，切换到设计页面，单击左侧导航树中蓝图中心节点，默认显示VNF页面。VNF页面中显示已经快速创建的版本部署包，蓝图状态显示为草稿状态，如[图1]所示。
图1  版本部署包的蓝图状态为草稿状态

单击版本部署包对应的图标，进入蓝图页面，可以查看部署包的编排信息，如[图2]所示。
图2  部署包信息

（可选）单击参数按钮，弹出参数设置对话框，默认显示属性页面。切换到输入参数页面，设置网元的配置信息，输入参数与info参数含义相同，参数说明参见“[Info文件参数说明]”
。
当ZXUN RCP启用vnf向vnfm获取token功能时，需要执行步骤[4]~步骤[9]。
 说明： 
在配置启用vnf向vnfm获取token功能前，操作员需要预先在VNFM上创建一个非默认admin用户的其它用户。具体操作参见“[在VNFM上创建用户]”。
单击输入参数页面的参数设计按钮。在参数设计页面中，在左侧目录树中选择全局配置→vnf和vnfm的会话认证信息
，如[图3]所示。
图3  参数设计

单击左侧目录树中的vnf和vnfm间会话协议类型，设置会话协议类型默认值为https，是否必填选择是，如[图4]所示。
图4  vnf和vnfm间会话协议类型

单击左侧目录树中的vnf向vnfm获取token，设置vnf向vnfm获取token默认值为enable、是否必填选择是，如[图5]所示。
图5  vnf向vnfm获取token

单击左侧目录树中的vnf向vnfm获取token的密码，是否显示选择显示，是否必填选择是，如[图6]所示。
图6  vnf向vnfm获取token的密码

单击左侧目录树中的vnf向vnfm获取token的用户名，是否必填选择是，如[图7]所示。
图7  vnf向vnfm获取token的用户名

单击应用和确定按钮，在输入参数页面选择全局配置→vnf和vnfm的会话认证信息
节点，如[图8]所示。填写vnf向vnfm获取token的密码和vnf向vnfm获取token的用户名参数值，用户名和密码为VNFM上已创建的非默认admin用户和密码。
图8  输入新用户的用户名和密码

单击保存。
单击发布按钮，等待版本部署包发布结束后，发布按钮变成灰色。
单击返回按钮，回到VNF页面，版本部署包的蓝图状态显示为已发布状态，如[图9]所示。
图9  版本部署包发布成功

注册已经成功发布的版本部署包
在左侧导航树中，单击软件仓库节点，切换到VNF页面，可以看到已经发布成功的版本部署包状态显示为未注册，如[图10]所示。
图10  软件仓库

选择未注册的快速部署包对应的操作栏中的注册按钮，弹出提示框。
单击确定按钮后，系统开始注册VNF部署包。当进度为100%时表示注册成功，如[图11]所示。
图11  VNF版本包注册成功

单击返回按钮。
此时[图10]所示的VNF部署包的状态栏的状态变为正常，如[图12]所示。
图12  VNF版本包注册成功

#### 实例化VNF 
摘要 :本节介绍如何实例化ZXUN RCP的VNF。
步骤 :在NFVO客户端的左侧导航树中，切换到设计页面，单击蓝图中心节点，默认显示VNF页面。VNF页面显示所有VNF版本包列表（包含已注册的快速部署包），如[图1]所示。
图1  VNF版本包列表

单击快速部署包后的部署按钮，出现新建页面，如[图2]所示。
图2  填写部署信息页面

部署页面参数说明参见[表1]。
参数名称|参数说明
---|---
实例名称|实例化后生成的VNF的名称，根据实际情况，由操作员进行设置。实例名称中不能包含“.”。
VNFDID|该参数不可设置，由系统自动读取数据设定。
VIM|选择对应的VIM。
租户|选择已通过云平台管理软件（本文档指TECSOpenStack）已经创建的项目，参见“创建项目”。
VNFM|用于在NFVO上唯一标识一个VNFM实例。从下拉列表中选择，必须关联已部署的VNFM实例编号。
在页面下方的Inputs参数框中，确认所有的参数都设置正确后，单击下一步按钮，进入沙箱测试页面，如[图3]所示页面。
图3  沙箱测试页面

（可选）沙箱测试操作的目的是为了检测资源是否满足部署要求。选择测试项目，单击测试按钮。如果系统资源不足，请联系VIM云平台管理人员解决，等待测试通过后，再进行部署。
沙箱测试通过后，单击直接部署按钮，NFVO系统开始实例化VNF，并显示VNF的进度。
VNF实例化完成后，单击返回按钮，在菜单栏中选择编排→应用
页面，在左侧的导航栏中选择VNF，VNF实例的状态显示为active，表示部署成功，如[图4]所示。
图4  VNF实例化成功

### 去激活服务（可选） 
摘要 :服务去激活（删除）是服务预埋反向过程。当不需要某个服务时，删除该服务可以节省资源。 
相关信息 :对于部分运营商场景，需要在完成VNF部署后进行去激活服务操作，相关信息参见[表1]。
适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活/去激活预埋服务
---|---|---|---|---|---|---
中国电信非UDSF局|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务。去激活Ncudr_SystemManagement服务。回收CDU虚机。激活Ncudr_AccessManagement服务。激活Ncudr_Access服务。
非UDSF局是指没有部署Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
 说明： 
如果Ncudr_Access服务已激活，则需要先去激活Ncudr_Access服务和Nudsf_UnstructuredDataManagement服务，再去激活Ncudr_SystemManagement服务。 
如果Ncudr_Access服务未激活，则需要先去激活Nudsf_UnstructuredDataManagement服务，再去激活Ncudr_SystemManagement服务。 
本节介绍去激活Nudsf_UnstructuredDataManagement服务和Ncudr_SystemManagement服务的操作，激活Ncudr_AccessManagement服务和Ncudr_Access服务参见“[激活预埋服务（可选）]”。
步骤 :打开自动扩缩容开关
打开浏览器，在地址栏输入NFVO客户端地址https://IP地址:28808/nfvo-mano-portal，在登录页面中输入用户名和密码，登录NFVO客户端，如[图1]所示。
图1  登录NFVO客户端

选择编排→VNF
，打开VNF页面，如[图2]所示。
图2  VNF页面

在VNF页面中选择更多→自动扩缩容开关
，打开自动扩缩容开关页面，如[图3]所示。
图3  自动扩缩容界面

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择开启。单击提交按钮，打开自动扩容开关，如[图4]所示。
图4  打开自动扩容开关

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择开启，打开自动缩容开关，如[图5]所示。
图5  打开自动缩容开关

去激活Nudsf_UnstructuredDataManagement_0和Ncudr_SystemManagement_0服务
打开浏览器，在地址栏输入https://IP地址:28808/em-portal，输入用户名和密码，登录EM客户端，如[图6]所示。
图6  登录EM客户端

在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
去激活Nudsf_UnstructuredDataManagement_0和Ncudr_SystemManagement_0服务。 
 说明： 
必须先去激活Nudsf_UnstructuredDataManagement_0服务，再去激活Ncudr_SystemManagement_0服务。 
执行[DEACTIVATE NFS]:NFSNAME="Nudsf_UnstructuredDataManagement_0"命令，去激活Nudsf_UnstructuredDataManagement_0服务。
执行[DEACTIVATE NFS]:NFSNAME="Ncudr_SystemManagement_0"命令，去激活Ncudr_SystemManagement_0服务。
 说明： 
去激活服务后需要等待1-3分钟，MANO才会建立起自动扩缩容的任务。 
检查自动扩缩容任务
登录NFVO客户端，单击页面右上角的图标，在显示的任务页面中查看自动扩缩容任务状态为已完成，如[图7]所示。
图7  检查自动扩缩容任务

检查去激活服务状态
去激活服务后执行命令检查，确保服务被成功去激活。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|两个服务的部署状态为False，如图8所示。
实例类型|SHOW SCTYPE:NFSNAME="Ncudr_SystemManagement_0"SHOW SCTYPE:NFSNAME="Nudsf_UnstructuredDataManagement_0"|检查服务对应的当前SC已被删除，如图9所示。
容器|SHOW VRU:NFSNAME="Ncudr_SystemManagement_0"SHOW VRU:NFSNAME="Nudsf_UnstructuredDataManagement_0"|检查服务对应的容器已被删除，查询结果为空，如图10所示。
图8  检查服务

图9  检查实例类型

图10  检查容器

回收所有的CDU虚机。 
执行[SHOW VM]命令，查询CDU虚机的虚机内部名称，如[图11]所示。
图11  查询CDU虚机

执行[RECYCLE VM]命令，回收所有CDU虚机。
VMNAME参数填写步骤[a]中查询到的CDU虚机内部名称。
关闭自动扩缩容开关
在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择关闭，关闭自动扩容开关，如[图12]所示。
图12  关闭自动扩容开关

在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择关闭，关闭自动缩容开关，如[图13]所示。
图13  关闭自动缩容开关

### 激活预埋服务（可选） 
摘要 :ZXUN RCP网元提供了Ncudr_Access、Npcf_LOG和Npcf_LogStoreUnit可选服务。这些服务在不同场景可能不部署、也可能部署其中的一种或多种。并且还存在某个服务原本不部署，后期由于需求变化又要求部署的情况。
因此ZXUN RCP启用了“服务预埋”功能，即预埋以上服务，默认不实例化。在需要时再激活该预埋的服务，根据需要进行实例化部署。
相关信息 :对于部分运营商场景，需要在完成VNF部署后进行激活预埋服务操作，相关信息参见[表1]。
适用运营商|应用场景|CDU虚机|GSU(CGW)虚机|LOG虚机|LSU虚机|部署后激活预埋服务
---|---|---|---|---|---|---
中国移动数据局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务，默认弹出2个LOG虚机。激活Npcf_LogStoreUnit服务，默认弹出3个LSU虚机。
中国移动物联网局|有报表功能无热备容灾|有|无|有|有|激活Npcf_LOG服务，默认弹出2个LOG虚机。激活Npcf_LogStoreUnit服务，默认弹出3个LSU虚机。
中国电信主备UDSF局中国联通|无报表功能有热备容灾，内置UDSF|有|有|无|无|激活Ncudr_Access服务，默认弹出2个带有CGW标签的GSU虚机。
中国电信非UDSF局|无报表功能有热备容灾，外置UDSF|无|有|无|无|按以下顺序去激活和激活服务：去激活Nudsf_UnstructuredDataManagement服务。去激活Ncudr_SystemManagement服务。回收CDU虚机。激活Ncudr_AccessManagement服务。激活Ncudr_Access服务，默认弹出2个带有CGW标签的GSU虚机。
中国移动语音局国际通用局部分测试局|无报表功能无热备容灾|有|无|无|无|无。
部分国际局部分测试局|无报表功能有EDR功能无热备容灾|有|无|有|无|激活Npcf_LOG服务，默认弹出2个LOG虚机。
UDSF局是指部署了Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
非UDSF局是指没有部署Ncudr_SystemManagement服务和Nudsf_UnstructuredDataManagement服务的局点。 
本节介绍激活各个服务的操作，去激活Ncudr_AccessManagement服务、去激活Ncudr_Access服务和回收CDU虚机的操作参见“[去激活服务（可选）]”。
步骤 :检查ZXUN RCP和MANO版本
检查ZXUN RCP版本，需要等于或高于V7.21.20.B3版本，以支持服务预埋功能。
检查使用的MANO版本，如果是V5.21.11.P4.B2，则需要进一步确认是否执行过补丁V5.21.11.P4.B2SP01，检查方法如下：
使用SSH方式登录VNFM主节点，执行docker stats sm命令，查询SM容器内存LIMIT值。
如果…|那么…
---|---
LIMIT值是550 MiB|表示未扩过内存，未执行补丁技术通知单，需要联系中兴通讯技术支持执行补丁技术通知单。
LIMIT值大于550 MiB|表示已扩过内存。
检查完成后，执行ctrl c停止命令。
（可选）检查VNF应用配额
 说明： 
若运营商资源池启用了VNF三级租户，则需要检查VNF应用配额是否满足服务激活的需求。 
打开浏览器，在地址栏输入NFVO客户端地址https://IP地址:28808/nfvo-mano-portal，在登录页面中输入用户名和密码，登录NFVO客户端，如[图1]所示。
图1  登录NFVO客户端

选择系统→NFVO→配置管理→租户
，默认显示一级租户页面。
切换至应用配额页面，查看VNF的应用配额，如[图2]所示。
图2  查看VNF配额

打开自动扩缩容开关
在NFVO客户端页面选择编排→VNF
，打开VNF页面，如[图3]所示。
图3  VNF页面

在VNF页面中选择更多→自动扩缩容开关
，打开自动扩缩容开关页面，如[图4]所示。
图4  自动扩缩容界面

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择开启。单击提交按钮，打开自动扩容开关，如[图5]所示。
图5  打开自动扩容开关

在自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择开启，打开自动缩容开关，如[图6]所示。
图6  打开自动缩容开关

激活预埋服务Ncudr_AccessManagement
打开浏览器，在地址栏输入https://IP地址:28808/em-portal，输入用户名和密码，登录EM客户端，如[图7]所示。
图7  登录EM客户端

在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW NFS]命令，查询部署状态为False的Ncudr_AccessManagement服务的实例名称，如[图8]所示。
图8  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Ncudr_AccessManagement_0"命令（以步骤[12]中查询到的Ncudr_AccessManagement_0实例名称为例），激活预埋服务Ncudr_AccessManagement。
激活预埋服务Ncudr_Access
执行[SHOW NFS]命令，查询部署状态为False的Ncudr_Access服务的实例名称，如[图9]所示。
图9  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Ncudr_Access_0"命令（以步骤[14]中查询到的Ncudr_Access_0实例名称为例），激活预埋服务Ncudr_Access。
激活预埋服务Npcf_LOG
执行[SHOW NFS]命令，查询部署状态为False的Npcf_LOG服务的实例名称，如[图10]所示。
图10  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Npcf_LOG_0"命令（以步骤[16]中查询到的Npcf_LOG_0实例名称为例），激活预埋服务Npcf_LOG。
激活预埋服务Npcf_LogStoreUnit
执行[SHOW NFS]命令，查询部署状态为False的Npcf_LogStoreUnit服务的实例名称，如[图11]所示。
图11  查询未部署的NFS信息

执行[ACTIVATE NFS]:NFSNAME="Npcf_LogStoreUnit_0"命令（以步骤[18]中查询到的Npcf_LogStoreUnit_0实例名称为例），激活预埋服务Npcf_LogStoreUnit。
 说明： 
激活预埋服务后需要等待1-3分钟，MANO才会建立起自动扩缩容的任务。 
检查自动扩缩容任务
登录NFVO客户端，单击页面右上角的图标，在显示的任务页面中查看自动扩缩容任务状态为已完成，如[图12]所示。
图12  检查自动扩缩容任务

检查Ncudr_AccessManagement服务和Ncudr_Access服务激活状态
执行命令检查Ncudr_Access服务相关信息，确保Ncudr_Access服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Ncudr_Access服务的部署状态为TRUE。
虚机|SHOW VM|Ncudr_Access服务激活后弹出2个带CGW标签的GSU虚机，如图13所示。
实例类型|SHOW SCTYPE:NFSNAME="Ncudr_Access_0"SHOW SCTYPE:NFSNAME="Ncudr_AccessManagement_0"|检查Ncudr_Access服务对应的SC类型和SC当前实例数，如图14所示。SC类型sc-cudr-access-cgw对应的当前实例数是2（与弹出GSU虚机个数一致）。SC类型sc-tmsp-nff对应的当前实例数是2（与弹出GSU虚机个数一致）。SC类型sc-cudr-access-mp对应的当前实例数是2（1+1主备OMU虚机）。检查Ncudr_AccessManagement服务对应的SC类型和SC当前实例数。SC类型sc-cudr-accessmgt-mp对应的当前实例数是2，如图15所示。
容器|SHOW VRU:NFSNAME="Ncudr_Access_0"SHOW VRU:NFSNAME="Ncudr_AccessManagement_0"|检查Ncudr_Access服务对应的SC类型包含2个sc-cudr-access-cgw、2个sc-tmsp-nff和2个sc-cudr-access-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图16所示。检查Ncudr_AccessManagement服务对应的SC类型包含2个sc-cudr-accessmgt-mp。SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图17所示。
图13  检查虚机

图14  检查Ncudr_Access服务的实例类型

图15  检查Ncudr_AccessManagement服务的实例类型

图16  检查Ncudr_Access服务的容器

图17  检查Ncudr_AccessManagement服务的容器

检查Npcf_LOG服务激活状态
执行命令检查Npcf_LOG服务相关信息，确保Npcf_LOG服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Npcf_LOG服务的部署状态为TRUE。
虚机|SHOW VM|Npcf_LOG服务激活后弹出2个LOG虚机，如图18所示。
实例类型|SHOW SCTYPE:NFSNAME="Npcf_LOG_0"|检查Npcf_LOG服务对应的当前SC类型和SC当前实例数，如图19所示。SC类型sc-pcf-log对应的当前实例数是2（与弹出LOG虚机个数一致）。SC类型sc-pcf-log-mp对应的当前实例数是2（1+1主备OMU虚机）。
容器|SHOW VRU:NFSNAME="Npcf_LOG_0"|检查Npcf_LOG服务对应的SC类型包含2个sc-pcf-log和2个sc-pcf-log-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图20所示。
图18  检查虚机

图19  检查实例类型

图20  检查容器

检查Npcf_LogStoreUnit服务激活状态
执行命令检查Npcf_LogStoreUnit服务相关信息，确保Npcf_LogStoreUnit服务被成功激活，具体检查内容参见下表。 
检查点|命令|检查标准
---|---|---
服务|SHOW NFS|Npcf_LogStoreUnit服务的部署状态为TRUE。
虚机|SHOW VM|Npcf_LogStoreUnit服务激活后弹出3个LSU虚机，如图21所示。
实例类型|SHOW SCTYPE:NFSNAME="Npcf_LogStoreUnit_0"|检查Npcf_LogStoreUnit服务对应的当前SC类型和SC当前实例数，如图22所示。SC类型sc-pcf-lsu对应的当前实例数是3（与弹出LSU虚机个数一致）。SC类型sc-pcf-lsu-mp对应的当前实例数是2（1+1主备OMU虚机）。
容器|SHOW VRU:NFSNAME="Npcf_LogStoreUnit_0"|检查Npcf_LogStoreUnit服务对应的SC类型包含3个sc-pcf-lsu和2个sc-pcf-lsu-mp。各SC实例对应VRU的部署状态为已部署、运行状态为运行中、是否已生效为是，如图23所示。
图21  检查虚机

图22  检查实例类型

图23  检查容器

关闭自动扩缩容开关
在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择扩容，开关选择关闭，关闭自动扩容开关，如[图24]所示。
图24  关闭自动扩容开关

在NFVO客户端的自动扩缩容开关页面中，粒度选择VNF，VNF信息中勾选对应的PCF，操作类型选择缩容，开关选择关闭，关闭自动缩容开关，如[图25]所示。
图25  关闭自动缩容开关

### 配置虚机弹扩 
摘要 :在ZXUN RCP实例化成功后，各个虚机都是最少个数，商用场景需要的虚机个数一般都比实例化时的个数多，操作员需要根据商务合同，将各个虚机的数量，弹扩到要求的数量。
本节介绍弹扩ZXUN RCP虚机的操作。
相关信息 :弹性是通过弹扩（增加资源）或弹缩（减少资源）来协调系统的资源占用与系统性能间的平衡，弹性功能包括弹扩和弹缩。 
弹扩（Scale Out）即申请所占用的虚拟资源。 
弹缩（Scale In）即释放所占用的虚拟资源。 
一个NF由多个类型的虚机组成，一种类型的虚机包含多个NFS，NFS是一种可独立开发、测试、部署的单元，每个NFS包含多个SC。
每个虚机可运行不同的SC数量，根据HLD中虚机数量计算需要增加的SC数量，将每种SC类型的虚机扩容到HLD配置数量，满足商用容量要求。
以商用大规格场景为例，ZXUN RCP涉及到弹性伸缩的虚机类型参见[表1]。
虚机类型|规格|SC类型名称|单虚机SC数量（最小弹性步长）|建议每次扩容最大SC个数
---|---|---|---|---
CDU|C-C4M32|sc-cudr-cdn-l-001/sc-cudr-cdn-l|3|15
sc-cudr-cdn-r-001/sc-cudr-cdn-r|CDU|C-C4M32|3|15
GSU (Policy Control)|Common-C8M32|sc-pcf-pcm|1|5
GSU (HTTP LB)|Common-C8|sc-http-lb|1|5
GSU (SIG LB)|Common-C8|sc-sig|1|5
sc-pcf-siglb|GSU (SIG LB)|Common-C8|1|5
GSU (CGW)|Common-C8|sc-cudr-access-cgw|1|4
sc-tmsp-nff|GSU (CGW)|Common-C8|1|4
IPU|C8|sc-ips|1|5
LOG|Common-C8M24|sc-pcf-log|1|5
LSU|C12|sc-pcf-lsu|1|5
合入UDSF插件实例化后的CDU虚机的SC类型为sc-cudr-cdn-l-001和sc-cudr-cdn-r-001。
未合入UDSF插件实例化后的CDU虚机的SC类型为sc-cudr-cdn-l和sc-cudr-cdn-r。
 说明： 
首次扩容的SC数量固定设置为最小弹性步长，等单个虚机扩容成功后，后续扩容可以将SC数量设置为需要扩容的数量，最大不能超过建议每次扩容最大SC个数。
步骤 :打开自动扩缩容开关
登录NFVO客户端，选择菜单编排→应用→VNF
，在界面右侧默认显示VNF页面，如[图1]所示。
图1  VNF页面

选择更多→自动扩缩容开关
，进入自动扩缩容开关设置页面，如[图2]所示。
图2  自动扩缩容开关

在自动扩缩容开关页面中，粒度选择VNF，查看网元的自动缩容开关状态和自动扩容开关状态。
如果…|那么…
---|---
自动缩容开关状态和自动扩容开关状态为关|转至步骤4
自动缩容开关状态和自动扩容开关状态为开|转至步骤5
将操作类型分别设置为缩容和扩容，开关设置为开启。设置完成后，单击提交按钮，如[图3]所示。
图3  打开自动扩缩容开关

配置自愈功能总开关、弹性模式和检查开关
在EM客户端，切换到配置页面，在配置页面的左侧命令树中，展开需要进行手工弹性操作的PCF节点。
在命令输入框中执行[SHOW AUTOHEALINGGLB]命令，查询自愈功能总开关状态。
如果…|那么…
---|---
自愈功能总开关状态为启用|转至步骤7
自愈功能总开关状态为禁用|转至步骤8
在命令输入框中执行[SET AUTOHEALINGGLB]:HEALINGSWITCH="DISABLE"命令，禁用自愈功能总开关。
在命令输入框中执行[SHOW SCALEGLBBASECFG]命令，查询弹性模式。
如果…|那么…
---|---
弹性模式为手动|转至步骤9
弹性模式为自动|通常弹性模式需要设为手工，请联系中兴通讯技术支持。
在命令输入框中执行[SHOW CONSISTENCECHECK]命令，查询检查开关状态。
如果…|那么…
---|---
检查开关状态为启用|转至步骤10
检查开关状态为禁用|转至步骤11
在命令输入框中执行[SET CONSISTENCECHECK]:CHECKSWITCH="DISABLE"命令，禁用检查开关。
CDU虚机扩容SC
 说明： 
CDU虚机扩容SC时需要分别对sc-cudr-cdn-l-001/sc-cudr-cdn-l和sc-cudr-cdn-r-001/sc-cudr-cdn-r进行弹扩操作，才会创建新的CDU虚机。两种SC类型的需要扩容的虚机数量分别为CDU需要扩容总虚机数的一半。例如现场需要扩容4个CDU，即扩容6个sc-cudr-cdn-l-001/sc-cudr-cdn-l和6个sc-cudr-cdn-r-001/sc-cudr-cdn-r。 
首次扩容SC_NUM步长固定设置为3，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过15。 
在命令输入框中执行如下命令，查询当前CDU虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Nudsf_UnstructuredDataManagement_0"
SC类型的名称以实际查询结果为准，sc-cudr-cdn-l-001和sc-cudr-cdn-r-001，或者sc-cudr-cdn-l和sc-cudr-cdn-r。 
例如现场需要扩容2个CDU，由于CDU虚机的最小弹性步长为3，需扩容3个sc-cudr-cdn-l-001和3个sc-cudr-cdn-r-001。 
在命令输入框中执行如下命令，对sc-cudr-cdn-l-001进行弹扩操作。 
[INC SC]:NFSNAME="Nudsf_UnstructuredDataManagement_0",SCTYPE="sc-cudr-cdn-l-001",SC_NUM=3
执行同样的操作，在命令输入框中执行如下命令，对sc-cudr-cdn-r-001进行弹扩操作。 
[INC SC]:NFSNAME="Nudsf_UnstructuredDataManagement_0",SC_TYPE="sc-cudr-cdn-r-001",SC_NUM=3
GSU (Policy Control)虚机扩容SC
 说明： 
GSU (Policy Control)虚机扩容将会导致用户在业务虚机上重新分布。 
冷备场景：性能统计过程中可能会出现会话数骤降，后逐步恢复的现象。 
热备场景：性能统计过程中可能会出现会话数骤降，等待30分钟后逐步恢复的现象。 
恢复时间受1102全局参数配置值影响，恢复完毕后对业务无影响。 
在命令输入框中执行如下命令，查询当前GSU (Policy Control)虚机的SC类型名称和SC个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_SMPolicyControl_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Npcf_SMPolicyControl_0",SCTYPE="sc-pcf-pcm",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-pcf-pcm的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
GSU (HTTP LB)虚机扩容SC
在命令输入框中执行如下命令，查询当前GSU (HTTP LB)虚机的SC类型名称和SC个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_HTTP_LB_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_HTTP_LB_0",SCTYPE="sc-http-lb",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-http-lb的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
GSU (SIG LB)虚机扩容SC
 说明： 
扩容GSU (SIG LB)虚机需要扩容sc-sig和sc-pcf-siglb两种类型SC。先扩容sc-pcf-siglb类型SC，再扩容sc-sig类型SC。
sc-pcf-siglb类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
sc-sig类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
在命令输入框中执行如下命令，查询当前GSU (SIG LB)虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_SIGLB_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Npcf_SIGLB_0",SCTYPE="sc-pcf-siglb",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-pcf-siglb的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
在命令输入框中执行如下命令，查询当前GSU（SIG LB）虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_SIG_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_SIG_0",SCTYPE="sc-sig",SCNUM=6
本示例中需要新增的GSU虚机个数为1。sc-sig的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
GSU (CGW)虚机扩容SC
激活Ncudr_Access服务，默认弹出2个sc-cudr-access-cgw、2个sc-tmsp-nff和2个sc-cudr-access-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容GSU (CGW)虚机仅需扩容sc-cudr-access-cgw和sc-tmsp-nf两种类型SC，2个sc-cudr-access-mp用于1+1主备OMU虚机。sc-tmsp-nff类型的SC个数要与sc-cudr-access-cgw类型的SC个数一致。
sc-cudr-access-cgw类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过4。 
sc-tmsp-nf类型SC：首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过4。 
扩容顺序：先扩容sc-cudr-access-cgw类型SC，再扩容sc-tmsp-nff类型SC。 
在命令输入框中执行如下命令，查询当前GSU (CGW)虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Ncudr_Access_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Ncudr_Access_0",SCTYPE="sc-cudr-access-cgw",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-cudr-access-cgw的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="Ncudr_Access_0",SCTYPE="sc-tmsp-nff",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-tmsp-nff的弹扩最小步长为1，即增加1个SC就增加一个GSU。如果要弹扩2个GSU，需要进行弹性的SC数量需要设置为2，以此类推。
IPU虚机扩容SC
在命令输入框中执行如下命令，查询当前IPU虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="CommonS_IPS_0"
在命令输入框中执行如下命令： 
[INC SC]:NFSNAME="CommonS_IPS_0",SCTYPE="sc-ips",SCNUM=1
本示例中需要新增的GSU虚机个数为1。sc-ips的弹扩最小步长为1，即增加1个SC就增加一个IPU，如果要弹扩2个IPU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
LOG虚机扩容SC
激活Npcf_LOG_0服务，默认弹出2个sc-pcf-log和2个sc-pcf-log-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容LOG虚机仅需扩容sc-pcf-log，2个sc-pcf-log-mp用于1+1主备OMU虚机。
在命令输入框中执行如下命令，查询当前LOG虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_LOG_0"
在命令输入框中执行如下命令，对sc-pcf-log进行弹扩操作。 
[INC SC]:NFSNAME="Npcf_LOG_0",SCTYPE="sc-pcf-log",SCNUM=1
本示例中需要新增的LOG虚机个数为1。sc-pcf-log的弹扩最小步长为1，即增加1个SC就增加一个LOG，如果要弹扩2个LOG，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
LSU虚机扩容SC
激活Npcf_LogStoreUnit_0服务，默认弹出2个sc-pcf-lsu和2个sc-pcf-lsu-mpSC实例，激活操作参见“[激活预埋服务（可选）]”。
 说明： 
扩容LOG虚机仅需扩容sc-pcf-lsu，2个sc-pcf-lsu-mp用于1+1主备OMU虚机。
在命令输入框中执行如下命令，查询当前LSG虚机的SC类型名称和个数。 
[SHOW SCTYPE]:NFSNAME="Npcf_LogStoreUnit_0"
在命令输入框中执行如下命令，对sc-pcf-lsu进行弹扩操作。 
[INC SC]:NFSNAME="Npcf_LogStoreUnit_0",SCTYPE="sc-pcf-lsu",SCNUM=1
本示例中需要新增的LSU虚机个数为1。sc-pcf-lsu的弹扩最小步长为1，即增加1个SC就增加一个LSU，如果要弹扩2个LSU，需要进行弹性的SC数量需要设置为2，以此类推。
 说明： 
首次扩容SC_NUM步长固定设置为1，等单个虚机扩容成功后，后续扩容可以将SC_NUM步长设置为需要扩容的数量，SC_NUM最大不能超过5。 
（可选）恢复自愈功能总开关和检查开关
如果步骤[6]中查询到的自愈功能总开关状态为启用，那么需要在命令输入框中执行如下命令，恢复自愈功能总开关。
[SET AUTOHEALINGGLB]:HEALINGSWITCH="ENABLE"
如果步骤[9]中查询到的检查开关状态为启用，那么需要在命令输入框中执行如下命令，恢复检查开关。
[SET CONSISTENCECHECK]:CHECKSWITCH="ENABLE"
（可选）恢复自动扩缩容开关
如果步骤[3]中查询到的自动缩容开关状态和自动扩容开关状态为关，那么需要参考步骤[4]，将操作类型分别设置为缩容和扩容，开关设置为关闭，关闭自动扩缩容开关。
### 安装后检查 
#### 检查虚机 
摘要 :ZXUN RCP实例化完成后，需要检查虚机是否为运行状态。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VM]命令，检查虚机信息，如[图1]所示。
图1  查询虚机信息

检查标准 :检查虚机内部名称前缀部分是否符合规范，虚机内部名称中的前缀如果不符合运营商规范，请根据规划修改，重新实例化虚机。 
检查虚机规格及数量是否和HLD一致。 
检查虚机运行状态是否正常，所有虚机运行状态需为running。 
#### 检查SC状态 
摘要 :ZXUN RCP实例化完成后，需要检查虚机SC状态。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VRU]命令，检查SC运行状态，如[图1]所示。
图1  查询SC运行状态

检查标准 :所有SC运行状态为running。
#### 检查网元名称 
摘要 :ZXUN RCP实例化完成后，需要检查网元是否符合运营商网元名称规范。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0节点。
执行[SHOW VNF]命令，检查网元名称，如[图1]所示。
图1  查询网元名称

检查标准 :VNF部署实例名称符合运营商网元名称规范要求。
### 参考 
#### Info文件参数说明 
##### 通用配置 
###### 全局配置 
全局配置如[图1]所示。
图1  全局配置

全局配置参数说明参见[表1]。
参数名称|参数含义
---|---
云平台类型|VNF所适用的VIM云平台管理系统，包括三个选项。TECS中兴通讯自研的TECS OpenStack云平台管理系统OpenStack基于OpenStack架构的第三方云平面管理系统VMware
网元资源名称前缀|该参数根据各运营商的命名规范进行配置，以便网元资源的统一管理。如某运营商要求网元资源名称前缀由所辖业务省标识、网元标识、网元序号、网元属性、厂家标识五部分组成。
资源池名称前缀|该参数在某些运营商的特殊场景下才需要配置。某些运营商的虚拟化环境可能涉及到多个厂商的产品，各个厂商对于虚拟资源的命名都采用各自的规则，导致呈现的各种虚拟资源的相关信息参差不齐，不利于运营商对各种虚拟资源进行监控和管理。运营商可以通过设置资源池名称前缀对VNF使用的虚拟资源进行严格规范的命名，以便资源的统一管理。定义了命名规则后，对于需要在VNF实例化过程中创建的各种虚拟资源，系统都会按照规定进行命名。资源池名称前缀由编码类型、地理位置、硬件资源池编号、VIM厂商标识、资源池系统编码、安全分区类型码、安全分区编号、资源类型码、资源实例编号，共9个部分组成，每个部分之间用短横线-连接。示例如：NFV-R-ZBBF-01A-ZX-VIM01-TUR-001-VM-00001000，详细描述参见表2。
启用虚机规格别名|该参数用于设置ZXUN RCP是否启用虚机规格的别名。
局号|该参数用于配置ZXUN RCP的局号。取值范围：0~255之间的整数，需要根据运营商的规划来设置。规划原则：在同一个NFVO之内的各个NF的局号不能相同。
实例化模式|保持默认值标准。
VNF网管语言环境|该参数用于设置ZXUN RCP的OMM网管的语言环境，包括英文和中文，根据实际情况选择。
OAM Telnet功能|该参数用于设置OAM的Telnet功能。建议设置为不启用。
镜像可视性|该参数用于设置ZXUN RCP的虚机操作系统镜像的属性，建议使用默认值。若NFVO+使用HW的VIM资源池，则需要将该参数设置为public。
启用网络QoS|该参数用于设置是否启用网络QoS控制策略。网络QoS控制策略是用于配置对硬件服务器的网卡进行限速的策略。建议设置为启用。
启用存储QoS|该参数用于设置是否启用存储QoS控制策略。存储QoS策略是用于在VIM云管理平台上创建的云硬盘的读写策略。建议设置为启用。
是否启用云盘保护|该参数在如下场景才涉及配置：ZXUN RCP的虚机使用VIM云管理平台（例如中兴通讯公司的ZTE TECS OpenStack 或其它的厂商的云平台软件，例如VMware等）上创建的云硬盘（例如部署的磁阵设备）来存储数据。该参数用于设置当ZXUN RCP与云硬盘的通信链路中断，重新恢复正常后的数据读写情况。启用该选项表示，当ZXUN RCP与云硬盘的通信链路中断，重新恢复正常后，ZXUN RCP的虚机与云硬盘之间恢复正常的数据读写操作。不启用该选项表示，当ZXUN RCP与云平台的通信链路中断，重新恢复正常后，虚机所分配的云硬盘处于只读状态，只能进行查询操作，需要重启虚机才能恢复正常。该参数建议设置为启用。
分权网元类型|该参数用于设置ZXUN RCP的分权网元类型，需要根据实际情况设置。默认设置为PCF/PCRF。
启用密文传输敏感数据|本参数通常情况下，建议设置为启用，启用此功能后，VNFD版本包插件的内容中不会有明文密码等敏感信息，系统会进行加密处理。
自定义flavor|该参数用于设置ZXUN RCP的自定义flavor，需要根据实际情况设置。
对接VNFM的IP地址版本|本参数用于配置ZXUN RCP与VNFM对接的IP地址类型，根据实际情况设置为IPv4或者IPv6。
启用虚机别名|该参数用于设置ZXUN RCP是否启用虚机别名，需要根据实际情况设置。启用：虚机类型使用info文件相应虚机配置中设置的虚机外部类型。不启用：直接使用info文件相应虚机的虚机逻辑类型名。
启用子接口VLAN Trunk|VLAN trunk是OpenStack社区发布的功能，标准叫法是VLAN-aware-VMs。VLAN Trunk是OpenStack社区提供的一种用于解决虚拟机接收/发送携带VLAN Tag的报文问题的技术方案。中兴通讯的VIM平台（TECS OpenStack）支持VLAN Trunk后，可以实现如下功能。减少虚拟机内部的虚拟机网卡数量为虚拟机提供接收/发送携带VLAN Tag报文的功能。对于ZXUN RCP来说，主要应用场景是在NFVI层面上采用中兴通讯的VIM平台（TECS OpenStack）+SDN组网时，ZXUN RCP通过该功能实现动态增加外部网络平面的子接口的能力。若该参数建议设置为启用，则表示会启用IPU虚机的外部网络平面的VLAN Trunk功能。
仲裁服务节点数目|该参数用于设置仲裁服务节点数目，默认配置为1，表示由一个AMU虚机为两个OMU虚机提供主备仲裁服务。建议保持默认值。
虚机规格调整时的重建方式|该参数用于设置调整虚机规格时采用的重建方式。先删再建：先删除原有规格的虚机，再创建新规格的虚机。使用resize接口：调用resize接口，使MANO对资源池中的虚机进行操作，调整虚机规格。
启用加速资源控制|该参数用于控制是否启用TECS OpnenStack平台Train版本的加速资源调度。TECS OpenStack支持对GPU，VGPU，智能网卡等加速资源进行统一管理。创建带硬件加速器的实例，可以获取高处理能力。该参数设置为启用时，TECS OpnenStack平台可以为ZXUN RCP虚机提供加速资源策略配置。
启用弹性资源控制|该参数用于控制是否启用TECS OpnenStack平台Train版本的弹性资源调度。该参数设置为启用时，TECS OpnenStack平台以QoS和流表为基础，生成不同虚机规格的弹性资源策略配置。
开启容器selinux功能|该参数用于设置是否启用容器的SELinux安全组件。该参数设置为启用时，容器在SELinux系统下运行，进程只能访问任务中所需要的文件，从而提高系统安全性。
项目|设置说明
---|---
编码类型|固定为NFV-R，必选。
地理位置|由4-5位数字或字母组成，必选。示例：ZBBF。
硬件资源池编号|由2位数字+1位字母组成，其中1位字母代表资源池等级，取值范围有三种。A：全国集中B：省内集中C：边缘示例：01A。
VIM厂商标识|由2-3位英文字母组成，必选。示例：ZX。
资源池系统编码|由VIM+2位数字组成。示例：VIM01。
安全分区类型码|由3-4位英文字母组成，必选。示例：TUR。
安全分区编号|由3位数字组成，必选。示例：001。
资源类型码|资源类型码由2-4位英文字母组成，必选，选项说明如下：SRV：X86物理服务器资源VM：虚拟机资源FLA：FlavorMIR：镜像VOL：卷VOLS：卷快照VOLT：卷类型SQOS：存储QoS策略VNET：虚拟网络VSNT：虚拟子网VPRT：虚拟端口VRT：虚拟路由器VFW：虚拟防火墙NQOS：网络QoSHSTK：heat stack
资源实例编号|对于虚机：采用VNFM中生成的网元模块名+ID的形式。对于其他虚拟资源类型：采用VIM生成的模块名+ID形式。
###### vnf和vnfm的会话认证信息配置 
vnf和vnfm的会话认证信息配置如[图2]所示。
图2  vnf和vnfm的会话认证信息配置

vnf和vnfm的会话认证信息配置参数说明参见[表3]。
参数名称|参数含义
---|---
vnf向vnfm获取token|该参数用于设置VNF是否可以向VNFM获取token。token是计算机术语，表示令牌的意思，令牌是一种能够控制站点占有媒体的特殊帧，以区别数据帧及其它的控制帧。通俗的说法，token可以称为暗号，在一些数据传输之前，服务端和客户端之间要先进行暗号的核对，不同的暗号会被授权不同的数据操作权限。Token是在服务端产生的。如果客户端使用用户名/密码向服务端请求认证，服务端认证成功，那么服务端会给客户端返回一个Token。客户端可以在每次发起请求消息时，携带Token证明自己的合法地位。该参数的配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为不启用。如果运营商的部署环境，开启了安全加固功能，则此参数配置为启用。
vnf和vnfm间会话协议类型|该参数用于配置VNF和VNFM之间的会话协议类型，VNF和VNFM之间支持双向认证，配置原则如下：如果运营商的部署环境，没有开启安全加固功能，则此参数配置为http。如果运营商的部署环境，开启了安全加固功能，则此参数配置为https。
 说明： 
当vnf向vnfm获取token设置为启用时，vnf和vnfm间会话协议类型需要配置为https。此外，还需要设置两个参数：vnf向vnfm获取token的密码和vnf向vnfm获取token的用户名。
该参数用于配置VNF向VNFM获取token时，使用的VNFM的用户名和密码。 
VNFM默认的用户名是admin，默认的密码是Zenap_123，通常情况下，不建议操作员使用默认的admin用户，需要新建一个用户，此处配置的用户名和密码是操作员已经预先在VNFM上创建的非默认admin用户的其它的用户，具体操作参见“[在VNFM上创建用户]”。
在发布VNF部署包之前，在部署包编排信息页面的参数→输入参数
页面，设置VNFM上已新建的用户名和密码，具体操作参见“[注册VNF部署包]”。
###### 资源命名规则 
资源命名规则如[图3]所示。
图3  资源命名规则

资源命名规则参数说明参见[表4]。
参数名称|参数含义
---|---
虚机名称命名规则|资源命名规则根据各运营商的命名规范进行配置，以便虚拟资源的统一管理。
虚机Flavor命名规则|资源命名规则根据各运营商的命名规范进行配置，以便虚拟资源的统一管理。
卷命名规则|资源命名规则根据各运营商的命名规范进行配置，以便虚拟资源的统一管理。
端口命名规则|资源命名规则根据各运营商的命名规范进行配置，以便虚拟资源的统一管理。
子端口命名规则|资源命名规则根据各运营商的命名规范进行配置，以便虚拟资源的统一管理。
虚机组命名规则|资源命名规则根据各运营商的命名规范进行配置，以便虚拟资源的统一管理。
###### 看门狗配置 
看门狗配置如[图4]所示，建议使用默认值。
图4  看门狗配置

看门狗配置参数说明参见[表5]。
参数名称|参数含义
---|---
镜像看门狗超时措施|本参数用于设置启用镜像watchdog功能后，自动触发的动作（watchdog_action）。ZXUN RCP定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。
虚机看门狗超时措施|本参数用于设置启用虚机watchdog功能后，自动触发的动作（watchdog_action）。ZXUN RCP定期执行相应的喂狗动作。如果在规定时间内没触发watchdog读写操作，则会触发watchdog_action中的动作。reset，表示重启虚拟机。如果本参数（即watchdog_action）配置为reset，则在达到最大停止喂狗时长之后仍未喂狗，VIM会主动复位虚机。none，表示不执行任何操作。如果本参数（即watchdog_action）配置为none，则在达到最大停止喂狗时长之后仍未喂狗，VIM不会执行复位虚机的操作。
虚机看门狗监控时长（分钟）|该功能用于设置虚机看门狗超时（watchdog_enabledelay）时长，默认值为600000毫秒，即10分钟。通常情况下建议使用默认值。该时长是VM启动后，到首次喂狗动作之间的时间间隔，如果超过这个间隔没有进行喂狗操作，则会触发watchdog_action的动作。如果虚机看门狗触发动作（watchdog_action）配置为reset，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM会主动复位虚机。如果虚机看门狗触发动作（watchdog_action）配置为none，则在达到watchdog_enabledelay时长之后仍未喂狗，VIM不会执行复位虚机的操作。
###### 网络QoS配置 
网络QoS配置如[图5]所示。
图5  网络QoS配置

网络QoS配置参数说明参见[表6]。
参数名称|参数含义
---|---
网络QoS策略名|该参数用于设置网络QoS策略的名称，网络QoS策略用于配置对硬件服务器的网卡进行限速的策略。运营商可以定义多个网络QoS策略模板，每个网络QoS策略模板都设置一个对应的名称，每个虚机都可以配置一个对应的网络QoS策略模板，该网络QoS策略可以对虚机中的各个网卡进行限制。|网络QoS策略名
出口|双向最大带宽|该参数用于配置硬件服务器网卡出口的双向最大带宽。
双向最大突发带宽|出口|该参数用于配置硬件服务器网卡出口的双向最大突发带宽。
入口|双向最大带宽|该参数用于配置硬件服务器网卡入口的双向最大带宽。
双向最大突发带宽|入口|该参数用于配置硬件服务器网卡入口的双向最大突发带宽。
 说明： 
用于OAM通信的EMS网络平面需要使用出口/入口的双向最大带宽、双向最大突发带宽值为500的网络QoS策略，其余网络平面使用的是设置值均为1000的网络QoS策略。
 说明： 
若info文件中的网络QoS策略个数不符合现场需求，需要增加或删除网络QoS模板，则建议在“[快速创建]”页面单击导出按钮，导出info文件，并使用可编辑.xml格式的软件（如Notepad++）打开对应的info.xml文件进行修改。修改完成后，单击导入按钮导入文件。
###### 存储QoS配置 
存储QoS配置如[图6]所示。
图6  存储QoS配置

存储QoS配置参数说明参见[表7]。
参数名称|参数含义
---|---
存储QoS模板1|可通过单击图标实现存储QoS策略拷贝，在弹出的拷贝节点对话框中填写参数。ID：存储QoS策略编号，使程序识别不同的存储QoS策略。节点描述：可自定义节点描述，用于区分不同的存储QoS策略。
存储QoS策略名|该参数用于设置存储QoS策略的名称，存储QoS策略用于配置VIM云管理平台上创建的云硬盘的读写策略。运营商可以定义多个存储QoS策略模板，每个存储QoS策略模板都设置一个对应的名称，每个虚机都可以配置一个对应的存储QoS策略模板，该存储QoS策略可以对虚机对应的在VIM云管理平台上创建的云硬盘的读写策略进行限制。每种类型的虚机的参数磁盘类型必须设置为云硬盘时，即为在运营商的实际组网环境使用云硬盘（即部署了磁阵设备）进行数据存储的情况下，才涉及到该参数的配置，如果运营商不使用磁阵，使用服务器主机的硬盘作为数据存储的设备的情况下，请忽略此配置。
云盘类型|运营商操作员可以预先在VIM云管理平台（例如中兴通讯的TECS OpenStack或其他厂商的云平台软件，例如VMware）上创建云硬盘对应的名称，用于给虚拟机分配数据存储空间。该参数的值与VIM上预定义的云硬盘类型相同，则使用对应的云硬盘类型。该参数的值与VIM上预定义的云硬盘类型不同，实例化时，MANO会根据该参数值自动创建相应的云硬盘类型。该参数也可以不设置，如果不设置，系统会随机选择一个VIM云管理平台上预定义的云硬盘类型。
总读写速度（字节/秒）|该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写速度。建议保持默认值。
总读写IOPS（次/秒）|该参数用于设置在VIM云管理平台上创建的云硬盘对应的总读写IOPS。建议设置为500。
###### 弹性资源配置 
弹性资源配置如[图7]所示。
图7  弹性资源配置

弹性资源配置参数说明参见[表8]。
参数名称|参数含义
---|---
弹性资源模板1|可通过单击图标实现弹性资源模板拷贝，在弹出的拷贝节点对话框中填写参数。ID：弹性资源策略编号，使程序识别不同的弹性资源策略。节点描述：可自定义节点描述，用于区分不同的弹性资源策略。
弹性资源策略1|该参数用于设置弹性资源策略的名称，弹性资源策略用于配置对虚机资源弹性控制的策略。运营商可以定义多个弹性资源策略模板，每个弹性资源策略模板都设置一个对应的名称，每个虚机都可以配置一个对应的弹性资源策略模板，该弹性资源策略可以对虚机资源进行弹性控制。
启用入向带宽控制|该参数用于配置是否控制硬件服务器网卡的入向带宽。当该参数设置为启用时，需要配置入向带宽信息相关参数。
启用出向带宽控制|该参数用于配置是否控制硬件服务器网卡的出向带宽。当该参数设置为启用时，需要配置出向带宽信息相关参数。
启用总存储读写速率控制|该参数用于配置是否控制VIM云管理平台上云硬盘的总存储读写速率。当该参数设置为启用时，需要配置总存储读写速率信息相关参数。
启用总存储读写IOPS控制|该参数用于配置是否控制VIM云管理平台上云硬盘的总存储读写IOPS。当该参数设置为启用时，需要配置总存储读写iops信息相关参数。
启用总流数量控制|该参数用于配置是否控制VIM云管理平台上云硬盘的总流数量。当该参数设置为启用时，需要配置总流数量信息相关参数。
入向带宽信息|入向带宽信息
设备类型|该参数用于设置VIM云管理平台创建的网络平面的类型。当网络平面的属性为VLAN（即运营商组网环境为非SDN架构）时，配置该参数为physnet。当网络平面的属性为VxLAN（即运营商组网环境为SDN架构）时，无需配置该参数。
设备ID|该参数用于设置VIM云管理平台创建的物理网络平面的名称。
入向带宽(Mbps)|该参数用于配置硬件服务器网卡入向带宽的QoS值。
出向带宽信息|出向带宽信息
设备类型|该参数用于设置VIM云管理平台创建的网络平面的类型。当网络平面的属性为VLAN（即运营商组网环境为非SDN架构）时，配置该参数为physnet。当网络平面的属性为VxLAN（即运营商组网环境为SDN架构）时，无需配置该参数。
设备ID|该参数用于设置VIM云管理平台创建的物理网络平面的名称。
出向带宽(Mbps)|该参数用于配置硬件服务器网卡出向带宽的QoS值。
总存储读写速率信息|总存储读写速率信息
设备类型|该参数用于设置数据存储设备的类型，固定配置为host。
设备ID|该参数用于设置数据存储设备的标识，固定配置为null。
总存储读写速率(MB/s)|该参数用于设置VIM云管理平台上云硬盘的总存储读写速率。
总存储读写iops信息|总存储读写iops信息
设备类型|该参数用于设置数据存储设备的类型，固定配置为host。
设备ID|该参数用于设置数据存储设备的标识，固定配置为null。
总存储读写IOPS|该参数用于设置VIM云管理平台上云硬盘的总存储读写IOPS。
总流数量信息|总流数量信息
设备类型|该参数用于设置数据存储设备的类型，固定配置为host。
设备ID|该参数用于设置数据存储设备的标识，固定配置为null。
总流数量|该参数用于设置VIM云管理平台上云硬盘的总流数量。
###### 加速资源配置 
加速资源配置如[图8]所示。
图8  加速资源配置

加速资源配置参数说明参见[表9]。
参数名称|参数含义
---|---
加速资源模板1|可通过单击图标实现加速资源模板拷贝，在弹出的拷贝节点对话框中填写参数。ID：加速资源策略编号，使程序识别不同的加速资源策略。节点描述：可自定义节点描述，用于区分不同的加速资源策略。
加速资源策略1|该参数用于设置加速资源策略的名称，加速资源策略用于配置对虚机处理性能进行提升的策略。运营商可以定义多个加速资源策略模板，每个加速资源策略模板都设置一个对应的名称，每个虚机都可以配置一个对应的加速资源策略模板，该加速资源策略可以提高虚机处理性能。
启用NEO加速特性|该参数用于控制虚机是否启用NEO加速。
启用INIC加速特性|该参数用于控制虚机是否启用INIC加速。
###### 虚机扩展参数配置 
虚机扩展参数配置如[图9]所示。
图9  虚机扩展参数配置

虚机扩展参数配置参数说明参见[表10]。
参数名称|参数含义
---|---
虚机扩展参数模板1|虚机扩展参数模板1
模板名称|该参数用于配置虚机扩展参数模板的名称。
HA参数列表|该参数需要根据实际规划配置。该参数用于设置是否启用与主机集合（Host Aggregates）相关的功能。主机集合（Host Aggregates）是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是制定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。
vCPU规格|该参数需要根据实际规划配置。该参数用于指定要创建的虚拟机所使用的具体的CPU型号。通常应用于异地迁移虚拟机的场景，比如把虚拟机从新型号CPU的服务器往旧型号CPU的服务器上迁移时，需要通过本参数来指定虚拟机所使用的CPU类型。
启用扩展参数|该参数建议设置为启用。
hw:numa_nodes|该参数建议采用默认值。在使用SR-IOV网卡部署虚机的场景才涉及到该参数的配置。hw:numa_nodes是用于指定虚机使用的NUMA节点数。hw:numa_nodes的取值表示不大于计算节点的NUMA节点个数的整数。hw:numa_nodes取值为null：表示不使用该参数功能。hw:numa_nodes取值为1：表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。
hw:mem_page_size|该参数建议采用默认值。该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。配置原则如下：null：表示不使用该参数功能。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：选择使用巨页。small：选择使用小页。1G页面：选择使用1G的页面。1GB页面：选择使用1GB的页面。
hw:cpu_policy|该参数建议采用默认值。该参数用于在虚拟机部署时指定其绑核策略，从而使虚拟机进行NUMA亲和绑定。配置原则如下：null：表示不使用该参数功能。shared：表示虚拟机分配在同一NUMA节点上的多个虚拟CPU共享该NUMA节点上主机的所有可用物理CPU。dedicated：精确绑核，表示虚拟机的虚拟CPU与主机的物理CPU进行一对一绑定。虚拟CPU使用本节点上的内存仅仅提升了虚拟CPU访问内存的速度，而虚拟机的虚拟CPU在主机的各个物理CPU上运行，要达到更好的性能，需要将虚拟机的虚拟CPU与主机的物理CPU进行绑定。
hw:cpu_max_sockets|该参数建议采用默认值。该参数用于设置虚拟机最大可使用的socket数。某个虚机需要的核数过多时，会同时占用多个socket上的虚拟CPU资源，该参数可以限制虚机最大可使用的socket数量。
HA trait请求参数列表|该参数提供给虚拟层平台自定义扩展使用，实际部署时与平台协商约定。例如，平台可以定义使用某个字符串代表本虚机必须部署在哪些主机上。如平台无要求，该参数可以保持默认值空。
HA trait禁用参数列表|该参数提供给虚拟层平台自定义扩展使用，实际部署时与平台协商约定。例如，平台可以定义使用某个字符串代表本虚机禁止部署在哪些主机上。如平台无要求，该参数可以保持默认值空。
TECS私有参数|TECS私有参数
启用TECS私有参数|如果VIM云管理平台使用中兴通讯的TECS OpenStack，则该参数建议设置为启用。如果VIM云管理平台使用第三方厂家的系统，则该参数建议设置为不启用。
hw:numa_pci|当启用TECS私有参数设置为启用，本参数的配置值才会生效。使用SR-IOV网卡的虚机会默认使用物理服务器的PCI设备，且在这个虚机中配置NUMA亲和功能时，默认要求使用的PCI设备需要和CPU及内存在同一NUMA节点上。此时可以根据实际需求，通过hw:numa_pci的值决定PCI设备是否与CPU及内存分配在同一NUMA节点，包括如下选项。null：表示不使用该参数功能。TRUE：表示虚机使用跟CPU及内存在同一NUMA节点上的PCI设备，不使用各个NUMA节点共有的PCI设备。计算节点的PCI设备，一般都有明确的NUMA位置，即属于某个具体的NUMA节点。一些较老的计算节点服务器，可能会出现PCI资源不属于某个NUMA节点，此时认为这些PCI设备为各个NUMA节点共有。FALSE：表示虚机优先使用跟CPU及内存在同一NUMA节点上的PCI设备和各个NUMA节点公共的PCI设备，当这些PCI设备不足时，使用其他NUMA节点上的PCI设备。
hw:high_performance|当启用TECS私有参数设置为启用，本参数的配置值才会生效。该参数用于设置虚拟机需要的DVS高性能属性，详细描述如下：null：表示不使用该参数功能。dvs_high_prefer：优先选择DVS高性能网卡所在的节点，无相应资源时选择其他NUMA节点。dvs_low_prefer：优先选择不存在DVS高性能网卡的节点，无相应资源时选择DVS高性能网卡所在的NUMA节点。
capabilities:flows|当启用TECS私有参数设置为启用，本参数的配置值才会生效。建议保持默认值。
启用网口多队列(true/false)|当启用TECS私有参数设置为启用，本参数的配置值才会生效，用于配置是否启用网口多队列功能。传统网卡的DMA队列有多个，网卡有基于多个DMA队列的分配机制。
网口队列数|当启用网口多队列参数设置为true时，本参数的配置值才会生效，建议保持默认值4。
###### 网络组配置 
网络组配置如[图10]所示。
图10  网络组配置

网络组配置参数说明参见[表11]。
参数名称|参数含义
---|---
网络组1|可通过单击图标实现网络组拷贝，在弹出的拷贝节点对话框中填写参数。ID：网络组的编号，使程序识别不同的网络组。节点描述：可自定义节点描述，用于区分不同的网络组。
网络组名称|网络组是指两个逻辑网络平面的集合，一个网络组中包括有两个逻辑网络平面，这两个网络平面可以相同也可以不同，可以归属相同的物理网络，也可以归属于不同的物理网络。此处创建的网络组，用于被虚机的vNIC（虚拟网卡）关联使用。当某个虚机的虚拟网卡关联了一个网络组后，在此虚机实例化成功，并创建vNIC（虚拟网卡）时，VIM平台则会按照网络组中的两个逻辑网络平面，分别创建对应的虚拟网卡，即一个虚机会创建两个vNIC（虚拟网卡）。该参数用于设置此网络组的名称，如网络平面_Group。
网卡亲和/反亲和策略|该参数用于设置虚机实例化后成后生成的vNIC具体关联哪个物理网卡。策略不开启设置为此选项，表示ZXUN RCP对此没有特定的限制，虚机实例化后成后生成的vNIC具体关联哪个物理网卡由VIM云平台的配置策略决定。网卡亲和设置为此选项，表示某个虚机实例化后成后生成的两个vNIC，ZXUN RCP会将两者关联到同一个物理网卡。网卡反亲和设置为此选项，表示某个虚机实例化后成后生成的两个vNIC，ZXUN RCP会将两者分别关联到不同的物理网卡。
网络名称|该参数用于配置一个网络组里包括的网络平面，该参数是在VIM云平台预先定义好的逻辑网络平面名称，此处配置的两个网络名称可以相同，也可以不同。如果启用了VIM层面的虚拟网卡SR-IOV bond功能，则要求此处配置的两个网络平面必须相同。
网络名称|该参数用于配置一个网络组里包括的网络平面，该参数是在VIM云平台预先定义好的逻辑网络平面名称，此处配置的两个网络名称可以相同，也可以不同。如果启用了VIM层面的虚拟网卡SR-IOV bond功能，则要求此处配置的两个网络平面必须相同。
###### 网络配置 
网络配置如[图11]所示。
图11  网络配置

此参数的值需要关联ZXUN RCP对应的项目所包括的网络平面，网络平面是在VIM云平台管理系统（如中兴通讯的TECS
OpenStack）中创建的。
本页面需要配置的网络平面的详细描述参见[表12]。
项目|网络平面名称|子网名称
---|---|---
admin|ZTE_EMS_NET|ZTE_EMS_NET_SUBNET
PROJ-RCP-1|ZTE_PCF_x_SERVICE_NET|ZTE_PCF_x_SERVICE_NET_SUBNET
ZTE_PCF_x_MGT_NET|PROJ-RCP-1|ZTE_PCF_x_MGT_NET_SUBNET
ZTE_PCF_x_EXT_NET|PROJ-RCP-1|ZTE_PCF_x_EXT_NET_SUBNET
 说明： 
若info文件中的网络个数不符合现场需求，需要增加或删除网络配置，则建议在“[快速创建]”页面单击导出按钮，导出info文件，并使用可编辑.xml格式的软件（如Notepad++）打开对应的info.xml文件进行修改。修改完成后，单击导入按钮导入文件。
网络配置参数说明参见[表13]。
参数名称|参数含义
---|---
网络1~8|网络名称|该参数用于设置此网络平面对应的名称，根据表12中的规划数据，ZXUN RCP使用了4个网络平面。ZTE_EMS_NETZTE_PCF_x_SERVICE_NETZTE_PCF_x_MGT_NETZTE_PCF_x_EXT_NET
网络用途|网络1~8|各个网络平面的网络用途规定如下：ZTE_EMS_NET需要设置为OAM通信。ZTE_PCF_x_SERVICE_NET需要设置为内部服务通信。ZTE_PCF_x_MGT_NET需要设置为内部管理通信。ZTE_PCF_x_EXT_NET需要设置为外部业务通信。
是否预定义网络|网络1~8|如果此网络平面是通过创建网络平面操作创建的，则该网络平面为预定义网络平面，需要设置为启用。如果此网络平面规划是在实例化过程中，由系统自动创建的，则该网络平面不是预定义网络平面，需要设置为不启用。本文档规划所有的网络平面都是预先在VIM云平台中创建的，该参数建议设置为默认值启用。
虚机端口最大传输单元（MTU）|网络1~8|该参数表示虚机端口的MTU数值，建议保持默认值。
VIM虚拟网络最大传输单元（MTU）|网络1~8|若NFVO+使用HW的VIM资源池，则需要将该参数设置为0，其余情况下建议保持默认值。
qos policy|网络1~8|本参数当全局配置中的启用网络QoS为启用时有效。若是否预定义网络配置为启用，则可直接引用在该平台云管理→网络→网络QoS中已配置的策略名称。若是否预定义网络配置为不启用，则此处可指定策略名称，也可以由系统自动生成策略名称。
安全组名称|网络1~8|安全组用来实现安全组内和组间虚拟机的访问控制，加强虚拟机的安全保护。安全组创建后，操作员可以在安全组中定义各种访问规则，当虚拟机网络加入该安全组后，即受到这些访问规则的保护。安全组是端口级别的安全手段，具体来说是作用在虚拟机的端口而不是网络上，可以定义哪些进入的网络流量能被转发给虚机。安全组包含一组防火墙策略，称为安全组规则（SecurityGroup Rule）。配置该参数，需要事先在VIM虚拟机云平台管理系统（如中兴通讯的TECS OpenStack）上启用了安全组。建议保持默认值，无需配置。
网络类型|网络1~8|该参数用于设置网络平面的网络类型，需要根据运营商的实际网络环境进行设置，包括以下两个选项。vlan设置为此选项时，还需要设置物理网络名称和是否启用VLAN透传两个参数。vxlanVXLAN是一种网络虚似化技术，是对VLAN技术的进一步优化，VXLAN 提供和VLAN相同的二层网络服务，但相比VLAN有更大的扩展性和灵活性，用于解决在部署大型云计算设备时的数量扩展问题。
物理网络名称|网络1~8|当网络类型设置为vlan时，需要根据现场规划设置物理网络名称。
是否启用VLAN透传|网络1~8|该参数用于设置此网络平面是否支持VLAN透传功能，建议使用默认值。
挂载子网|子网名称|该参数用于设置此网络平面的子网对应的名称。
子网描述|挂载子网|该参数用于设置此网络平面的子网的描述信息。非必选参数，操作员可根据实际情况设置。
网络地址|挂载子网|表示网络平面对应的子网的地址，根据规划的数据进行设置。在为各个网络平面规划IP地址时，内部控制面不能使用172.17.0.0/16地址段中的IP地址。
EMS网络地址|挂载子网|表示EMS网络平面对应的子网的地址，在ZTE_EMS_NET网络中需要配置该参数，根据规划数据进行设置。
IP地址类型|挂载子网|根据运营商的实际场景，选择为IPv4或者IPv6。当ZXUN RCP使用IPv4/IPv6双栈时，此IP地址类型需要配置为IPv4，双栈网络参数中的IP地址类型即为IPv6。
网关地址|挂载子网|根据实际情况配置。
双栈子网名称|挂载子网|当ZXUN RCP支持IPv4/IPv6双栈时，子网名称与双栈子网名称分别为IPv4与IPv6子网的名称。
双栈网络地址|挂载子网|当ZXUN RCP支持IPv4/IPv6双栈时，网络地址与双栈网络地址分别为IPv4与IPv6子网的地址。
双栈网关地址|挂载子网|当ZXUN RCP支持IPv4/IPv6双栈时，网关地址与双栈网关地址分别为IPv4与IPv6子网网关的地址。
##### 网元配置 
###### 网元配置 
网元配置参数如[图1]所示。
图1  网元配置

网元配置参数说明参见[表1]。
参数名称|参数含义
---|---
VNF实例类型|固定配置为RCP。
网元子类型|保持默认值。
VNF业务场景|自动关联“快速创建VNF部署包”的步骤2中选择的场景。建议不要修改本参数。
key_xx|该参数暂不涉及。
###### UDSF配置信息 
UDSF配置参数如[图2]所示。
图2  UDSF配置参数说明

UDSF配置参数说明参见[表2]。
参数名称|参数含义
---|---
租户ID|该参数用于唯一标识一个租户，不可重复。通常保持默认值即可。如果不需要创建该租户，则配置为0。
租户名称|该参数用于配置租户名称，不可重复。通常保持默认值即可。
虚机规格|该参数用于配置CDU虚机的规格。该参数需要和规划保持一致。
初始数量|该参数用于配置初始启动的CDU虚机数。该参数需要和规划保持一致。
最大数量|该参数用于配置最大的CDU虚机数。该参数需要和规划保持一致。
主用NF|该参数用于配置租户对应的主用NF标识。该参数需要和规划保持一致。
容灾NF|该参数用于配置租户对应的备用NF标识。无备用NF时，默认为0。
##### OMU虚机配置 
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

虚机配置参数说明参见[表1]。
参数名称|参数含义
---|---
虚机配置|虚机逻辑类型|OMU虚机的逻辑类型固定设置为OMU。
虚机优先级|虚机配置|保持默认值。
虚机启动优先级|虚机配置|该参数用于设置虚拟机启动上电的优先级。取值范围为1~10，数值1表示优先级最高，数值10表示优先级最低，虚拟机启用时，每个主机根据虚拟机对应的优先级进行处理，优先级高的虚拟机先上电，优先级低的虚拟机后上电。一般情况下，建议将OMU和AMU的优先级设置为1。
虚机可用域|虚机配置|该参数用于配置OMU虚机所属的域，域是通过VIM云平台管理系统（如中兴通讯的TECS OpenStack）设置的。域是一个用户可见的概念，用于实现各个项目的资源独立，可以提高系统的容灾性和为系统中的各个项目资源提供简便的隔离服务。如果VIM云平台管理系统（如中兴通讯的TECS OpenStack）没有启用域功能，该参数暂时不涉及，无需配置。在配置此项参数前，需要先通过TECS OpenStack云平台管理系统查询已经配置成功的域名。操作员使用SSH方式登录到控制节点的操作系统。在keystonerc_admin配置模式下，使用nova aggregate-list，查看TECS OpenStack上已经配置的域名。通常情况下，TECSOpenStack上配置的域有如下四类：控制域：云平台（例如TECS OpenStack）使用MANO域：MANO（例如CloudStudio）使用转发域（媒体面）：提供转发消息功能的虚机使用计算域：其他所有网元的虚机共用
虚机规格数量信息|QoS策略名列表|当“通用配置”中的启用网络QoS参数配置为启用时，需要配置该参数。该参数用于设置OMU虚机网卡的QoS策略名称列表，与虚机网卡一一对应，使用逗号分割。
单批次允许下电的虚机数/比例|虚机规格数量信息|该参数用于设置同一批次允许下电的OMU虚机个数或者虚机比例。若该参数配置为比例值，则取值为单批次允许下电的OMU虚机数占用当前OMU虚机数的比例。
内存回收水线(KB)|虚机规格数量信息|保持默认值。
虚机最大虚拟内存空间|虚机规格数量信息|保持默认值。
虚机规格|虚机规格数量信息|表示单个OMU虚机的规格，OMU虚机有多种规格，以OMU-C4 (4 vCPU/24GRAM/110G HD)为例进行说明，设置为该选项，表示在实例化ZXUN RCP的过程中，单个OMU虚机占用的vCPU个数为4，占用的内存为24GB，占用的硬盘容量为110 GB。
虚机规格别名|虚机规格数量信息|该参数用于配置OMU虚机规格的别名，若通用配置中启用虚机规格别名参数配置为“不启用”，则此处不需要配置。
虚机初始个数|虚机规格数量信息|虚机初始个数决定实例化ZXUN RCP时，系统生成的初始OMU虚机个数。虚机最大个数决定实例化ZXUN RCP时，系统生成的最大可弹性伸缩的OMU虚机个数。OMU不支持弹性伸缩，这两个参数固定设置为2。
虚机最大个数|虚机规格数量信息|虚机初始个数决定实例化ZXUN RCP时，系统生成的初始OMU虚机个数。虚机最大个数决定实例化ZXUN RCP时，系统生成的最大可弹性伸缩的OMU虚机个数。OMU不支持弹性伸缩，这两个参数固定设置为2。
虚机外部类型|虚机规格数量信息|该参数用于设置ZXUN RCP的虚机外部类型。若“通用配置”中的启用虚机别名参数设置为启用，则ZXUN RCP的虚机类型为此处设置的参数值。
主机列表|虚机规格数量信息|建议使用默认值。
增加存储大小(GB)|虚机规格数量信息|当OMU虚机内存不够用时，增加OMU虚机的内存。不增加：OMU虚机不增加内存。增加100G：OMU虚机增加100G。增加300G：OMU虚机增加300G。
加速资源策略|虚机规格数量信息|该参数仅在启用加速资源控制参数配置为启用时才生效，用于配置虚机使用的加速资源策略，选择“通用配置”中已配置的加速资源策略。
弹性资源策略|虚机规格数量信息|该参数仅在启用弹性资源控制参数配置为启用时才生效，用于配置虚机使用的弹性资源策略，选择“通用配置”中已配置的弹性资源策略。
关联的扩展参数模版|虚机规格数量信息|当该参数配置为“通用配置”中虚机扩展参数模板名称时，OMU虚机使用通用配置中配置的虚机扩展参数。当不配置该参数时，OMU虚机使用虚机参数配置中配置的虚机扩展参数。
亲和策略|亲和类型|在虚拟化环境中，将硬件物理服务器称为主机（HOST），运行在主机上的虚拟机称为VM。对ZXUN RCP网元进行实例化后，每种类型的虚机个数根据实际情况会部署为N个，为了系统的安全性考虑，需要将一种类型中的N个虚机分别部署在ZXUN RCP网元所在域中的主机（此处指计算节点）上。对ZXUN RCP进行实例化后，会生成多种类型的虚机（如OMU、CDU等），每种类型的虚机可能会部署为多个，将同一种类型的多个虚机的集合称为反亲和组，同一个反亲和组内的虚机需要满足亲和/反亲和的策略限制，反亲和组也叫作互斥组。该参数用于控制是否将实例化的多个OMU虚机分别部署在不同的主机上。包括如下选项：不限制表示系统不对OMU虚机部署进行限制，即OMU虚机可以随意部署在任意的主机上（即可以全部部署在一台主机上）。对于OMU虚机，不建议配置为该选项。反亲和设置为该参数后，还需要设置反亲和组名，位于同一个互斥组之内的主备VM不能部署在同一个主机（即硬件物理服务器）上，不同互斥组之间的虚机没有互斥关系。软反亲和规则同反亲和策略，但互斥组内虚机数大于主机数时，云平台将继续创建虚机而不是失败。NUMA反亲和设置为该参数后，位于同一个互斥组之内的主备VM不能部署在同一个NUMA节点的主机上，不同互斥组之间的虚机没有互斥关系。主机反亲和+HA软反亲和设置为该参数后，位于同一个互斥组之内的主备VM不能部署在同一HA。但是当互斥组内虚机数大于HA数，只能部署在同一HA时，同一个互斥组之内的主备VM不能部署在同一个主机上。建议设置为反亲和。
反亲和组内最大虚机个数|亲和策略|当亲和类型参数设置为反亲和时，才会涉及到该参数的配置。该参数设置为1，表示所有的虚机都在一个互斥组中，即这个互斥组中的每个虚机都必须分散部署在不同的主机上。在这种情况下，实际环境中的主机个数必须大于等于虚机的个数，否则就会部署失败，实例化不成功。该参数设置为2，表示所有的虚机平均分布在两个互斥组中，即每个互斥组中的虚机都必须分散部署在不同的主机上，但是组间的虚机无需互斥部署。示例：如果部署了10个虚机，则1~5在一个互斥组中，6~10在一个互斥组中，其中1~5必须部署在不同的主机上，6~10必须部署在不同的主机上，但是5和7、3和8...，分别属于两个互斥组的虚机可以部署在同一个主机上。这种情况下，实际环境中的主机个数必须大于等于5个，否则就会部署失败，实例化不成功。建议设置为1。
反亲和组名|亲和策略|当亲和类型参数设置为反亲和时，才会涉及到该参数的配置。该参数的设置原则如下：使用ZXUN RCP定义的虚拟机互斥策略此处不需要设置该参数的值（保留为空），在实例化过程中，ZXUN RCP会自动创建一个互斥组的名称，且名字会根据系统默认的规则自动编号。使用VIM云平台管理系统定义的虚拟机互斥策略需要预先在VIM云平台管理系统（如中兴通讯的ZTE TECSOpenStack）中，配置一个虚拟机组（Server-group），且此虚拟机组的部署策略必须配置为互斥策略，此处配置的参数值就是VIM云平台管理系统配置的Server-group的名称，如果此处配置的参数值与VIM中配置的Server-group的名称不相同，或者Server-group的策略不是互斥，则会导致虚拟部署失败，实例化不成功。所以建议不需要使用此种方式。即当部署策略设置为反亲和时，该参数不需要设置，直接填空。
全局反亲和组名|亲和策略|通常，当亲和类型参数设置为反亲和时，平台插件会自动生成反亲和组名称。若用户不想使用插件生成的反亲和组名称，则可以通过设置该参数，使用全局反亲和组名替换插件自动生成的反亲和组名称。
亲和组规则|亲和策略|当亲和类型参数设置为反亲和时，才会涉及到亲和组规则配置，即使用同组每主机部署虚机上限参数约束配置规则。
同组每主机部署虚机上限|亲和策略|该参数用于设置每个主机上允许部署的当前反亲和组内虚机个数最大值。假设某反亲和组内虚机个数为15，主机个数为10，同组每主机部署虚机上限配置为2。该场景下，将有5个主机上部署1个该组的虚机，另外5个主机上部署2个该组内虚机。该参数用于在主机数量不足以实现虚机全互斥分布的情况下，能让多余的虚机尽量分散在现有主机上。
节能降耗|CPU休眠设置|该参数用于设置虚机是否使用CPU休眠功能，建议保持默认值null。
CPU调频设置|节能降耗|该参数用于设置虚机是否使用CPU调频功能。当打开该功能时，表示虚机在低负荷状态下，CPU会进行降频。建议保持默认值null。
硬盘配置|磁盘类型|该参数用于设置ZXUN RCP是否使用磁阵作为数据存储的设备，包括三个选项：本地硬盘不使用磁阵，使用服务器主机的硬盘作为数据存储的设备的情况下，需要设置为该选项。云硬盘在运营商的实际组网环境使用云硬盘（即部署了磁阵设备）进行数据存储的情况下，需要设置为该选项，通常情况下，该参数需要设置为云硬盘。设置为该选项时，还需要设置云硬盘类型和云盘可用域。系统盘本地盘，数据盘云硬盘
云硬盘类型|硬盘配置|当磁盘类型为云硬盘时，该参数有效。该参数是指运营商操作员预先在VIM云管理平台（例如中兴通讯公司的TECSOpenStack或其他厂商的云平台软件，例如VMware等）上创建的云硬盘对应的名称，用于给虚拟机分配数据存储空间。该参数的值与VIM上预定义的云硬盘类型相同，则使用对应的云硬盘类型。该参数的值与VIM上预定义的云硬盘类型不同，实例化时，NFVO会根据该参数值自动创建相应的云硬盘类型。此时可以设置vim上cinder.conf中设定的后端存储名称。该参数也可以不设置，如果不设置，系统会随机选择一个VIM云管理平台上预定义的云硬盘类型。
云盘可用域|硬盘配置|当磁盘类型为云硬盘时，该参数有效。该参数表示云硬盘归属的可用域。若不配置，则默认与虚机可用域值相同。
vim上cinder.conf中设定的后端存储名称|硬盘配置|当磁盘类型为云硬盘时，该参数有效。当云硬盘类型的值与VIM上预定义值不同时，可以设置后端的存储名称；否则创建volumetype时VIM会自动使用cinder默认的后端名称。
是否启用删除虚拟机不删除数据盘|硬盘配置|保持默认值。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

OMU虚机网卡配置参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示OMU虚机关联的网络平面，不同类型的虚机关联的逻辑网络平面不相同，可以设置为逻辑网络平面的名称，也可以设置为网络组的名称，当OMU虚机关联单个平面时，需要关联的网络平面如下。ZTE_PCF_x_MGT_NETZTE_PCF_x_SERVICE_NETZTE_EMS_NET若某个虚机网卡关联了一个网络组，则实例化后，生成的两个虚拟网卡，这两个虚机网卡之间可以通过双端口工作模式设置两者之间的关系。
双端口工作模式|当某个虚机关联了一个网络组后，在此虚机实例化成功，并创建vNIC（虚拟网卡）时，则会按照网络组中的两个逻辑网络平面，分别创建对应的vNIC（虚拟网卡）。即一个虚机会创建两个vNIC。这两个vNIC可以通过本参数设置两者之间的关系，包括以下类型：单网口表示这两个vNIC不启用SR-IOV bond。TECS双端口绑定表示这两个vNIC可以在VIM平台（如中兴通讯自研的TECS OpenStack）启用SR-IOVbond。此选项只适用于内部媒体面和外部业务网络平面。APP层绑定表示这两个vNIC可以在VNF层面（即ZXUN RCP）启用SR-IOVbond。此选项只适用于除了外部业务网络平面之外的其他网络平面。VIM层绑定（3rd VIM）此选项只适用于第三方厂商的VIM云平台产品。路由负荷分担表示两个vNIC之间的关系为负荷分担。路由负荷分担可以理解为两个独立的通信链路，互相之间没有影响，设置为此选项后，虚机网卡中的SR-IOV网卡备份模式必须设置为单网口。此选项只适用于内部媒体面和外部网络平面。TECS四端口绑定表示这四个vNIC可以在VIM平台（如中兴通讯自研的TECS OpenStack）启用SR-IOV bond。此选项只适用于内部媒体面和外部业务网络平面。
网卡类型|表示此网络平面对应的网卡类型：virtio：表示启用OVS/DVS。SR-IOV：表示启用SR-IOV。当设置为此参数时，还需要设置双端口工作模式和SRIOV网卡备份模式两个参数。e1000：表示启用E1000。vmxnet2：表示启用VMXNET2。vmxnet3：表示启用VMXNET3。
SRIOV网卡备份模式|当网卡类型为SR-IOV时，需要根据实际情况设置本参数。
网卡带宽|根据实际情况设置，单位为Kbps。
主机IP地址列表|根据实际情况设置。IP地址的个数一定要和虚机最大个数保持一致，举例：虚机最大个数是8，则IP地址要填8个。
浮动IP地址|根据规划设置CIDR格式的浮动IP地址，例如192.168.0.0/24。
双栈主机IP地址列表|当ZXUN RCP支持IPv4/IPv6双栈时，主机IP地址列表与双栈主机IP地址列表分别需要配置为IPv4与IPv6地址。IP地址的个数一定要和虚机最大个数保持一致，举例：虚机最大个数是2，则IP地址要填2个。
双栈浮动IP地址|当ZXUN RCP支持IPv4/IPv6双栈时，浮动IP地址与双栈浮动IP地址分别需要配置为IPv4与IPv6地址。
是否启用端口安全组|在VIM云管理平台（如中兴通讯的TECS OpenStack）没有开启安全组配置数据的情况下，该参数需要设置为不启用。在VIM云管理平台（如中兴通讯的TECS OpenStack）开启安全组配置数据的情况下，该参数需要设置为启用。该参数建议保持默认值。
qos policy|本参数当“通用配置”中的启用网络QoS为启用时有效。若该网卡关联的网络是预定义网络，可直接引用在该平台云管理→网络→网络QoS中已配置的策略名称。若该网卡关联的网络不是预定义网络，则此处可指定策略名称，也可以由系统自动生成策略名称。
###### 虚机参数配置 
虚机参数配置如[图3]所示。
图3  虚机参数配置

虚机参数配置参数说明参见[表3]。
参数名称|参数含义
---|---
虚机扩展参数|HA参数列表|该参数需要根据实际规划配置。该参数用于设置是否启用与主机集合（Host Aggregates）相关的功能。主机集合（Host Aggregates）是一组节点，即主机（host）的组合，是指具有共同属性的多个主机的集合。比如：CPU都是制定类型的一组主机的集合，磁阵类型都是SSD的一组主机的集合，操作系统都是Linux或Windows的一组主机的集合等。
vCPU规格|虚机扩展参数|该参数需要根据实际规划配置。该参数用于指定要创建的虚拟机所使用的具体的CPU型号。通常应用于异地迁移虚拟机的场景，比如把虚拟机从新型号CPU的服务器往旧型号CPU的服务器上迁移时，需要通过本参数来指定虚拟机所使用的CPU类型。
启用扩展参数|虚机扩展参数|该参数建议设置为启用。
hw:numa_nodes|虚机扩展参数|该参数建议采用默认值。在使用SR-IOV网卡部署虚机的场景才涉及到该参数的配置。hw:numa_nodes是用于指定虚机使用的NUMA节点数。hw:numa_nodes的取值表示不大于计算节点的NUMA节点个数的整数。hw:numa_nodes取值为null：表示不使用该参数功能。hw:numa_nodes取值为1：表示虚机使用的CPU及内存分配在同一NUMA节点上。hw:numa_nodes取值为2：表示虚机使用的CPU及内存分配在2个不同的NUMA节点上。
hw:mem_page_size|虚机扩展参数|该参数建议采用默认值。该参数用于设置虚机使用的巨页内存的内存页大小，使用巨页内存的后，由于内存连续，不存在碎片，虚机使用时，会在性能上有所提高。null：表示不使用该参数功能。any：优先使用巨页，虚机可以使用所有类型的页面，按照页面大小由大到小选择，如果巨页页面不满足，则选择小页。large：选择使用巨页。small：选择使用小页。1G页面：选择使用1G的页面。1GB页面：选择使用1GB的页面。
hw:cpu_policy|虚机扩展参数|该参数建议采用默认值。该参数用于在虚拟机部署时指定其绑核策略，从而使虚拟机进行NUMA亲和绑定。配置原则如下：null：表示不使用该参数功能。shared：表示虚拟机分配在同一NUMA节点上的多个虚拟CPU共享该NUMA节点上主机的所有可用物理CPU。dedicated：精确绑核，表示虚拟机的虚拟CPU与主机的物理CPU进行一对一绑定。虚拟CPU使用本节点上的内存仅仅提升了虚拟CPU访问内存的速度，而虚拟机的虚拟CPU在主机的各个物理CPU上运行，要达到更好的性能，需要将虚拟机的虚拟CPU与主机的物理CPU进行绑定。
hw:cpu_max_sockets|虚机扩展参数|该参数建议采用默认值。该参数用于设置虚拟机最大可使用的socket数。某个虚机需要的核数过多时，会同时占用多个socket上的虚拟CPU资源，该参数可以限制虚机最大可使用的socket数量。
HA trait请求参数列表|虚机扩展参数|该参数用于设置HA的特征参数列表，填写资源池设置的HA特征信息，以便资源池为虚机调度到适合的主机。
HA trait禁用参数列表|虚机扩展参数|
TECS私有参数|启用TECS私有参数|如果VIM云管理平台使用中兴通讯的TECS OpenStack，则该参数建议设置为启用。如果VIM云管理平台使用第三方厂家的系统，则该参数建议设置为不启用。
hw:numa_pci|TECS私有参数|当启用TECS私有参数设置为启用，本参数的配置值才会生效。使用SR-IOV网卡的虚机会默认使用物理服务器的PCI设备，且在这个虚机中配置NUMA亲和功能时，默认要求使用的PCI设备需要和CPU及内存在同一NUMA节点上。此时可以根据实际需求，通过hw:numa_pci的值决定PCI设备是否与CPU及内存分配在同一NUMA节点，包括如下选项。取值为null：表示不使用该参数功能。取值为TRUE：表示虚机使用跟CPU及内存在同一NUMA节点上的PCI设备，不使用各个NUMA节点共有的PCI设备。计算节点的PCI设备，一般都有明确的NUMA位置，即属于某个具体的NUMA节点。一些较老的计算节点服务器，可能会出现PCI资源不属于某个NUMA节点，此时认为这些PCI设备为各个NUMA节点共有。取值为FALSE：表示虚机优先使用跟CPU及内存在同一NUMA节点上的PCI设备和各个NUMA节点公共的PCI设备，当这些PCI设备不足时，使用其他NUMA节点上的PCI设备。
hw:high_performance|TECS私有参数|当启用TECS私有参数设置为启用，本参数的配置值才会生效。该参数用于设置虚拟机需要的DVS高性能属性，详细描述如下：null：表示不使用该参数功能。dvs_high_prefer：优先选择DVS高性能网卡所在的节点，无相应资源时选择其他NUMA节点。dvs_low_prefer：优先选择不存在DVS高性能网卡的节点，无相应资源时选择DVS高性能网卡所在的NUMA节点。
capabilities:flows|TECS私有参数|当启用TECS私有参数设置为启用，本参数的配置值才会生效。建议保持默认值。
##### CDU虚机配置 
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

亲和策略参数配置参见[表1]。
参数名称|参数含义
---|---
虚机初始个数|该参数建议保持默认值。
亲和类型|该参数建议设置为反亲和。
反亲和组个数|该参数建议设置为1。
其余参数说明参见“[OMU虚机配置]”。
 说明： 
如果ZXUN RCP在后续使用过程中不再需要已部署的CDU虚机，则参见“[去激活服务（可选）]”，去激活Ncudr_Access服务和Nudsf_UnstructuredDataManagement服务，回收CDU虚机。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

虚机网卡配置参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示CDU虚机关联的网络平面名称，CDU虚机需要关联的网络平面如下。ZTE_PCF_x_MGT_NETZTE_PCF_x_SERVICE_NET
其他参数说明参见“[OMU虚机配置]”。
###### 虚机参数配置 
参数说明参见“[OMU虚机配置]”。
##### GSU虚机配置 
概述 :GSU虚机需要分别配置GSU (HTTP LB)、GSU (Policy Control)、GSU (SIG LB)和GSU (GW)虚机类型的规格及虚机数量信息。
以商用大规格场景为例，GSU各个虚机类型配置的规格和默认虚机个数参见下表。 
虚机类型|虚机规格|虚机初始个数|虚机最大个数
---|---|---|---
GSU (HTTP LB)|GSU-Common-C8|2|16
GSU (Policy Control)|GSU-Common-C8M32|2|128
GSU (SIG LB)|GSU-C8-N|2|16
GSU (GW)|GSU-CGW-C8|0|16
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

亲和策略参数配置参见[表1]。
参数名称|参数含义
---|---
虚机配置|虚机逻辑类型|GSU虚机的逻辑类型固定设置为GSU。
虚机规格数量信息|虚机规格|配置GSU (HTTP LB)虚机类型对应的虚机规格。虚机规格与“快速创建VNF部署包”的步骤2中选择的场景关联，建议保持默认值。
虚机初始个数|虚机规格数量信息|虚机初始个数决定实例化ZXUN RCP时，系统生成的初始GSU虚机个数。虚机最大个数决定实例化ZXUN RCP时，系统生成的最大可弹性伸缩的GSU虚机个数。建议保持默认值。
虚机最大个数|虚机规格数量信息|虚机初始个数决定实例化ZXUN RCP时，系统生成的初始GSU虚机个数。虚机最大个数决定实例化ZXUN RCP时，系统生成的最大可弹性伸缩的GSU虚机个数。建议保持默认值。
亲和策略|虚机规格数量信息|亲和类型：该参数建议设置为软反亲和。
反亲和组个数：该参数建议设置为1。|亲和策略|虚机规格数量信息
虚机规格数量信息|虚机规格|配置GSU (PolicyControl)虚机类型对应的虚机规格。建议保持默认值。
虚机初始个数|虚机规格数量信息|建议保持默认值。
虚机最大个数|虚机规格数量信息|建议保持默认值。
亲和策略|虚机规格数量信息|亲和类型：该参数建议设置为软反亲和。
反亲和组个数：该参数建议设置为1。|亲和策略|虚机规格数量信息
虚机规格数量信息|虚机规格|配置GSU (SIG LB)虚机类型对应的虚机规格。建议保持默认值。
虚机初始个数|虚机规格数量信息|建议保持默认值。
虚机最大个数|虚机规格数量信息|建议保持默认值。
亲和策略|虚机规格数量信息|亲和类型：该参数建议设置为软反亲和。
反亲和组个数：该参数建议设置为1。|亲和策略|虚机规格数量信息
虚机规格数量信息|虚机规格|配置GSU (GW)虚机类型对应的虚机规格。建议保持默认值。
虚机初始个数|虚机规格数量信息|建议保持默认值。如果运营商有热备容灾功能，且内置UDSF，则需要参见“激活预埋服务（可选）”，在实例化后激活预埋的Ncudr_Access服务。
虚机最大个数|虚机规格数量信息|建议保持默认值。如果运营商有热备容灾功能，且内置UDSF，则需要参见“激活预埋服务（可选）”，在实例化后激活预埋的Ncudr_Access服务。
亲和策略|虚机规格数量信息|亲和类型：该参数建议设置为软反亲和。
反亲和组个数：该参数建议设置为1。|亲和策略|虚机规格数量信息
其余参数说明参见“[OMU虚机配置]”。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

虚机网卡配置参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示GSU虚机关联的网络平面名称，GSU虚机需要关联的网络平面如下。ZTE_PCF_x_MGT_NETZTE_PCF_x_SERVICE_NET
其他参数说明参见“[OMU虚机配置]”。
###### 虚机参数配置 
参数说明参见“[OMU虚机配置]”。
##### IPU虚机配置 
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

亲和策略参数配置参见[表1]。
参数名称|参数含义
---|---
亲和类型|该参数建议设置为反亲和。
反亲和组个数|该参数建议设置为1。
其余参数说明参见“[OMU虚机配置]”。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

虚机网卡配置参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示IPU虚机关联的网络平面名称，IPU虚机需要关联的网络平面如下。ZTE_PCF_x_MGT_NETZTE_PCF_x_SERVICE_NETZTE_PCF_x_EXT_NET
VLAN Trunk子接口1|当“通用配置”中的启用子接口VLAN Trunk参数设置为启用时，需要配置该参数。可通过单击图标实现VLAN Trunk子接口拷贝，在弹出的拷贝节点对话框中填写参数。ID：VLAN Trunk子接口编号，使程序识别不同的VLAN Trunk子接口。节点描述：可自定义节点描述，用于区分不同的VLAN Trunk子接口。
子接口关联网络名称|此参数表示该VLAN Trunk子接口关联的网络名称，需要根据运营商的规划来设置。
子接口vlan id|此参数表示该VLAN Trunk子接口的VLAN ID标识，需要根据运营商的规划来设置。
子端口IP地址列表|根据实际情况设置。子端口IP地址的个数一定要和IPU虚机最大个数保持一致，举例：IPU虚机最大个数是8，则IP地址要填8个。
双栈子端口IP地址列表|当ZXUN RCP支持IPv4/IPv6双栈时，子端口IP地址列表与双栈子端口IP地址列表分别需要配置为IPv4与IPv6地址。子端口IP地址的个数一定要和IPU虚机最大个数保持一致，举例：IPU虚机最大个数是2，则IP地址要填2个。
 说明： 
若info文件中的虚机网卡个数不符合现场需求，需要增加或删除网卡配置，则建议在“[快速创建]”页面单击导出按钮，导出info文件，并使用可编辑.xml格式的软件（如Notepad++）打开对应的info.xml文件进行修改。修改完成后，单击导入按钮导入文件。
其他参数说明参见“[OMU虚机配置]”。
###### 虚机参数配置 
参数说明参见“[OMU虚机配置]”。
##### LOG虚机配置 
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

 说明： 
若运营商选择的部署场景涉及LOG虚机，则虚机初始个数配置为0，且在ZXUN RCP实例化后参见“[激活预埋服务（可选）]”，激活预埋的Npcf_LOG服务。
虚机配置参数说明参见[表1]。
参数名称|参数含义
---|---
虚机初始个数|若该参数设置为0，则表示不启用该虚机。
亲和类型|该参数建议设置为软反亲和。
反亲和组个数|该参数建议设置为1。
其他参数说明参见“[OMU虚机配置]”。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

虚机网卡配置参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示LOG虚机关联的网络平面名称，LOG需要关联的网络平面如下。ZTE_PCF_x_MGT_NETZTE_PCF_x_SERVICE_NET
其他参数说明参见“[OMU虚机配置]”。
###### 虚机参数配置 
虚机参数配置说明参见“[OMU虚机配置]”。
##### LSU虚机配置 
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

 说明： 
若运营商选择的部署场景涉及LSU虚机，则虚机初始个数配置为0，且在ZXUN RCP实例化后参见“[激活预埋服务（可选）]”，激活预埋的Npcf_LogStoreUnit服务。
虚机配置参数说明参见[表1]。
参数名称|参数含义
---|---
虚机初始个数|若该参数建议设置为0，则表示不启用该虚机。
亲和类型|该参数建议设置为软反亲和。
反亲和组个数|该参数建议设置为1。
其他参数说明参见“[OMU虚机配置]”。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

虚机网卡配置参数说明参见[表2]。
参数名称|参数含义
---|---
关联网络名称|此参数表示LSU虚机关联的网络平面名称，LSU需要关联的网络平面如下。ZTE_PCF_x_MGT_NETZTE_PCF_x_SERVICE_NET
其他参数说明参见“[OMU虚机配置]”。
###### 虚机参数配置 
虚机参数说明参见“[OMU虚机配置]”。
##### AMU虚机配置 
###### 虚机配置 
虚机配置如[图1]所示。
图1  虚机配置

参数说明参见“[OMU虚机配置]”。
###### 虚机网卡配置 
虚机网卡配置如[图2]所示。
图2  虚机网卡配置

虚机网卡配置参数说明参见[表1]。
参数名称|参数含义
---|---
关联网络名称|此参数表示AMU虚机关联的网络平面名称，AMU需要关联的网络平面：ZTE_PCF_x_MGT_NET。
其他参数说明参见“[OMU虚机配置]”。
###### 虚机参数配置 
参数说明参见“[OMU虚机配置]”。
#### 在VNFM上创建用户 
摘要 :ZXUN RCP支持HTTPS认证功能时，VNF需要向VNFM获取token。由于安全原因，禁止使用admin用户，需要新建用户。本节介绍在VNFM上创建用户的操作过程。
步骤 :在VNFM上新建账户规则
在VNFM客户端，选择菜单系统→安全→账户规则
，进入账户规则页面，如[图1]所示。
图1  账户规则页面

单击新建账户规则，进入新建账户规则页面。
在规则名称与密码策略区域，设置规则名称与密码相关策略，如[图2]所示。
图2  新建账户规则

参数名|参数说明
---|---
规则名称|根据规划填写账户规则名称。在创建用户时将会引用本规则名称。
首次登录|不勾选该选项。
密码最大有效期|设置为0。
在账号策略区域，设置账号允许登录的方式和有效期等参数，如[图3]所示。
图3  账号策略

参数名|参数说明
---|---
账号登录方式|选中Web和API。
单击新建按钮，完成账户规则的创建。
在VNFM上新建用户
在VNFM客户端，选择菜单系统→安全→用户管理
，进入用户管理页面，如[图4]所示。
图4  用户管理页面

单击新建用户，进入基本信息页面，如[图5]所示。
图5  基本信息页面

基本信息页面的参数说明参见[表3]。
参数名|参数说明
---|---
用户名|根据规划填写用户的用户名，即该用户的登录名称。用户名不区分大小写，不允许重复，最长30个字符。
密码|用户登录时输入的口令。在用户账户规则中，可以定制密码的长度范围。
确认密码|再次输入密码，必须和用户密码一致。
账户规则|在下拉菜单中选择在“在VNFM上新建账户规则”中创建的账户规则。
同时登录数限制|选中不限制。各选项含义如下：全局：同一个用户名只允许1个人同时登录。不限制：同一个用户名允许多人同时登录。自定义：自定义同一个用户名的同时登录人数。
单击下一步，进入权限分配页面，选中所有角色，如[图6]所示。
图6  权限分配

单击新建按钮，完成用户的创建。
#### VLAN Trunk功能配置示例 
背景知识 :VLAN trunk是OpenStack社区发布的功能，标准叫法是VLAN-aware-VMs。 
VLAN Trunk是OpenStack社区提供的一种用于解决虚拟机接收/发送携带VLAN Tag的报文问题的技术方案。 
中兴通讯的VIM平台（TECS OpenStack）支持VLAN Trunk后，可以实现如下功能。 
减少虚拟机内部的虚拟机网卡数量。 
为虚拟机提供接收/发送携带VLAN Tag报文的功能。 
应用场景 :对于ZXUN RCP来说，主要应用场景是在NFVI层面上采用中兴通讯的VIM平台（TECS
OpenStack）+SDN组网时，ZXUN RCP通过该功能实现动态增加外部网络平面的子接口的能力。
##### 规划数据 
本节示例ZXUN RCP的SDN组网网络平面规划数据，参见[表1]。
网络平面名称|子网名称|VxLAN ID|子网地址|子网网关|VLAN Trunk ID
---|---|---|---|---|---
ZTE_EMS_NET|ZTE_EMS_NET_SUBNET_IPv4|12208|100.0.0.0/24|100.0.0.1|-
ZTE_EMS_NET_SUBNET_IPv6|ZTE_EMS_NET|aaaa::/64|12208|aaaa::ffff|-
ZTE_PCF_33_SERVICE_INT_NET|ZTE_PCF_33_SERVICE_INT_NET_SUBNET|12209|2409:8086:8411:2fb1::/64|-|-
ZTE_PCF_33_MGT_INT_NET|ZTE_PCF_33_MGT_INT_NET_SUBNET|12200|2409:8086:841f:2fb0::/64|-|-
ZTE_PCF_33_EXT_NET|ZTE_PCF_33_EXT_NET_SUBNET|12201|0::/64|0::1|-
ZTE_PCF_33_SBI_EXT_NET|ZTE_PCF_33_SBI_EXT_NET_SUBNET_IPv4|12211|10.84.11.0/24|10.84.11.1|3211
ZTE_PCF_33_SBI_EXT_NET_SUBNET_IPv6|ZTE_PCF_33_SBI_EXT_NET|2409:8086:8411:2fb3::/64|12211|2409:8086:8411:2fb3::1|3211
ZTE_PCF_33_SIG_EXT_NET|ZTE_PCF_33_SIG_EXT_NET_SUBNET_IPv4|12212|10.84.12.0/24|10.84.12.1|3212
ZTE_PCF_33_SIG_EXT_NET_SUBNET_IPv6|ZTE_PCF_33_SIG_EXT_NET|2409:8086:8411:2fb4::/64|12212|2409:8086:8411:2fb4::1|3212
ZTE_PCF_33_DATA_EXT_NET|ZTE_PCF_33_DATA_EXT_NET_SUBNET_IPv4|12213|10.84.13.0/24|10.84.13.1|3213
ZTE_PCF_33_DATA_EXT_NET_SUBNET_IPv6|ZTE_PCF_33_DATA_EXT_NET|2409:8086:8411:2fb5::/64|12213|2409:8086:8411:2fb5::1|3213
ZTE_PCF_33_SMS_EXT_NET|ZTE_PCF_33_SMS_EXT_NET_SUBNET_IPv4|12214|10.84.14.0/24|10.84.14.1|3214
ZTE_PCF_33_SMS_EXT_NET_SUBNET_IPv6|ZTE_PCF_33_SMS_EXT_NET|2409:8086:8411:2fb6::/64|12214|2409:8086:8411:2fb6::1|3214
ZTE_PCF_33_LOG_EXT_NET|ZTE_PCF_33_LOG_EXT_NET_SUBNET_IPv4|12215|10.84.15.224/28|10.84.15.225|3215
ZTE_PCF_33_LOG_EXT_NET_SUBNET_IPv6|ZTE_PCF_33_LOG_EXT_NET|2409:8086:8411:::/64|12215|2409:8086:8411:::1|3215
网络平面名称以EXT_NET为结尾的表示这些网络平面是外部网络平面。
VLAN Trunk功能只涉及到外部网络平面，其他网络平面不涉及，由于ZXUN RCP的外部网络平面只会与IPU虚机关联，所以VLAN
Trunk功能只针对IPU虚机的外部网络平面。
所有的外部网络平面分为两类： 
parent（父）网络平面ZXUN RCP只需要创建一个parent网络平面，将ZTE_PCF_x_EXT_NET划为外部网络平面的parent网络平面。 说明：parent（父）网络平面对应的子网网段，一般不需要配置网关地址。 
child（子）网络平面ZXUN RCP需要创建多个child网络平面，除ZTE_PCF_x_EXT_NET外的其他外部网络平面都是child网络平面。 说明：child（子）网络平面对应的子网网段，一般需要配置网关地址。 
两种类型的网络平面，包括parent网络平面和child网络平面，建议每个网络平面只配置一个对应的子网，VLAN Trunk功能，只支持一个网络平面引用一个子网平面。 
配置步骤 :概述
VLAN Trunk功能在配置操作上，体现为将所有child（子）网络平面对应的子网平面都加入到parent（父）网络平面中，并将parent（父）网络平面关联到IPU虚机。 
TECS OpenStack中的操作
在VIM云平台管理系统（本文档示例为中兴通讯的TECS OpenStack）中创建[表1]中所有规划的外部网络平面及其子网。
 说明： 
在创建网络平面的操作中，根据运营商的实际需要将这些外部网络平面网络类型设置为vxlan或者vlan。
MANO中的操作
在MANO客户端，执行实例化ZXUN RCP操作时，在通用配置页面的全局配置区域框中，将启用子接口VLAN Trunk配置为启用，如[图1]所示。
图1  启用VLAN Trunk功能

在通用配置页面的网络配置区域框中，创建parent网络平面ZTE_PCF_33_EXT_NET，如[图2]所示。
图2  创建parent网络平面ZTE_PCF_33_EXT_NET

在通用配置页面的网络配置区域框中，创建所有的child网络平面，本文档仅以ZTE_PCF_33_SBI_EXT_NET示例说明，如[图3]所示。其他网络平面的数据参见[表1]进行创建。
图3  创建所有的child网络平面

 说明： 
每一个child网络平面都需要配置网关地址。 
在IPU虚机配置页面中，将parent网络平面ZTE_PCF_33_EXT_NET关联IPU虚机，并在parent网络平面ZTE_PCF_33_EXT_NET中，将所有的child网络平面配置到VLAN
Trunk子接口中，如[图4]所示。
图4  创建所有的child网络平面

 说明： 
每个VLAN Trunk子接口都需要配置VLAN ID。 
EM中的操作
登录到EM客户端，进行分层接入操作，将ZXUN RCP接入EM。
在EM客户端，切换到配置页面，在配置页面的左侧命令树中，展开需要进行操作的ZXUN RCP节点。
在ZXUN RCP节点的CommonS_TMSP_0下，选择Rosng配置管理
→Rosng配置管理
，进入ROSNG配置模式，如[图5]所示。
图5  进入ROSNG配置模式

在ROSNG配置模式下，配置各个接口的子接口、VLAN、IP地址，这些数据都需要和TECS OpenStack分配的数据一致。 
实例化后，IPU虚机的实接口（物理接口）对应父网络，实接口（物理接口）上一般不需要配置IP地址，IP地址都配置在子接口上。 
#### NFVO打开版本包本地上传选项 
摘要本节介绍NFVO打开版本包本地上传选项的操作。 说明：只有网络质量良好的场景下才能使用本地上传，否则当版本包文件较大时（超过50
MB）有可能出现版本上传中断或者失败。 
步骤 :登录NFVO客户端，选择菜单系统→配置中心→系统配置
，进入系统配置页面。
在左侧导航树中，选择菜单系统配置→蓝图配置→编排配置
，进入编排配置页面，如[图1]所示。
图1  编排配置页面

在“文件上传方式配置”的下拉列表中勾选本地上传后，单击确定按钮。
切换到软件仓库，选择导入后，导入方式中出现了“本地文件”的选项。如[图2]所示。
图2  本地上传选项

## 缩略语 
## 缩略语 
### AMU 
Arbitration Management Unit仲裁管理单元
### CDU 
Cloud Database Unit云数据库单元
### CGSL 
Carrier Grade Server Linux电信级服务器Linux
### CGW 
CDB GatewayCDB接入网关
### CIDR 
Classless Inter-Domain Routing无类别域间路由
### CN 
Core Network核心网
### CPU 
Central Processing Unit中央处理器
### DHCP 
Dynamic Host Configuration Protocol动态主机配置协议
### DSCP 
Differentiated Services Code Point差分服务编码点
### DVS 
Distributed Virtual Switch分布式虚拟交换机
EM :Element Management网元管理
ETSI :European Telecommunications Standards Institute欧洲电信标准化协会
FTP :File Transfer Protocol文件传输协议
GSU :General Service Unit通用业务单元
HTTP :Hypertext Transfer Protocol超文本传输协议
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
### ICMP 
Internet Control Message ProtocolInternet控制报文协议
### IOPS 
Input/Output Operations Per Second每秒输入/输出操作
### IPU 
Interface Process Unit接口处理单元
IPv4 :Internet Protocol Version 4互联网通信协议第四版
IPv6 :Internet Protocol Version 6互联网通信协议第六版
### LB 
Load Balance负载均衡
MANO :Management and Orchestration管理和编排
### MTU 
Maximum Transmission Unit最大传输单元
NF :Network Function网络功能
NFS :Network Function Service网络功能服务
NFV :Network Functions Virtualization网络功能虚拟化
### NFVI 
Network Functions Virtualization Infrastructure网络功能虚拟化基础设施
NFVO :Network Functions Virtualization Orchestrator网络功能虚拟化编排器
### NS 
Network Service网络服务
OAM :Operation, Administration and Maintenance操作管理维护
OMU :Operation & Management Unit操作管理单元
### OVS 
Open VSwitch虚拟交换机
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
### PVID 
Port VLAN ID端口虚拟局域网标识
QoS :Quality of Service服务质量
SC :Service Component服务组件
### SDN 
Software Defined Network软件所界定网络
SFTP :Secure File Transfer Protocol安全文件传输协议
SMS :Short Message Service短消息业务
### SR-IOV 
Single-Root I/O Virtualization单根I/O虚拟化
### SSH 
Secure Shell安全外壳协议
TCP :Transmission Control Protocol传输控制协议
### TECS 
Tulip Elastic Cloud System郁金香弹性云系统
### TELNET 
Telecommunication Network Protocol远程登录协议
### UDP 
User Datagram Protocol用户数据报协议
UDSF :Unstructured Data Storage Function非结构化数据存储功能
VIM :Virtualized Infrastructure Manager虚拟化基础设施管理系统
### VLAN 
Virtual Local Area Network虚拟局域网
VM :Virtual Machine虚拟机
VNF :Virtualized Network Function虚拟化网络功能
VNFM :Virtualized Network Function Manager虚拟化网络功能管理器
### VXLAN 
Virtual Extensible Local Area Network虚拟可扩展局域网
### WEB 
Web环球网
## 初始配置（AIC部署） 
### iConfig简介 
功能说明 :ZXUN AIC（以下简称AIC）主要用于5GC网元的自动化设计和部署，实现核心网网元功能的自动化交付，提升运营商大区资源池建设的安装部署效率。iConfig是AIC平台提供的一个功能组件，用于5GC网元局数据配置，高效、规范地完成局数据自动化配置和部署工作。 
iConfig专用的LLD设计模板，支持VNF网元Rosng配置命令、业务配置命令参数填写和生成。模板本身提供输出xlsx格式LLD文件，用于导入AIC-iDeploy工具执行配置操作。 
iConfig支持直接自动连接网元OAM或者连接EM两种方式进行局数据配置命令下发。可识别重复配置，捕捉配置过程异常。 说明：EM方式：目前由于EM提供的Rosng相关API接口不满足自动化需求，Rosng配置仍需手工执行，只支持业务配置命令自动化。OAM方式：支持Rosng配置和业务配置命令自动化。 
iConfig支持在局数据配置操作前或局数据配置操作后，自动进行数据备份。支持备份数据的恢复。 
应用场景 :在VNF网元实例化完成之后，使用iConfig进行Firstcall或者商用局数据配置。 
支持与网元部署的LLD同时导入iDeploy，完成网元部署后，继续进行局数据配置。 
可扩充LLD支持的配置场景，使iConfig用于运维阶段的扩容。 
### 配置简介 
#### 配置工具 
自动化配置工具参见[表1]。
工具|说明|获取方式
---|---|---
AIC-iDeploy|在AIC-iDeploy中导入iConfig LLD Template生成的LLD文件和aic-plugin插件包，自动执行配置操作，实现网元局数据的自动配置。|联系中兴通讯技术支持。
iConfig LLD Template|iConfig LLD Template支持VNF网元Rosng配置命令、业务配置命令参数填写，生成并输出LLD文件（.xlsx格式），用于导入AIC-iDeploy工具执行配置操作。|随ZXUN RCP产品版本包发布，下载路径：\versions\tools\AIC。
aic-plugin|插件负责调用AIC平台的接口，支持iConfig功能。|随ZXUN RCP产品版本包发布，下载路径：\versions\tools\AIC。
#### 配置流程 
自动化配置流程如[图1]所示。
图1  配置流程

步骤说明： 
填写：工程人员填写VNF网元提供的iConfig LLD Template，生成Rosng和业务配置脚本。 
输出：使用iConfig LLD Template提供的输出功能，输出iConfig LLD文件。 
导入：将iConfig LLD文件和aic-pluging包导入AIC-iDeploy部署工具。 
执行：根据部署页面呈现局数据配置的相关步骤，完成局数据配置。 
### 配置准备 
#### NF接入EM 
摘要 :EM为NF提供统一的配置入口，每个NF实例化完成之后，都需要接入EM，完成后续的开通和配置操作。
对于多个NF组网场景，每个NF需要分别执行接入EM的操作。 
步骤 :在EM客户端，选择菜单拓扑→分层接入
，进入分层接入页面， 如[图1]所示。
图1  分层接入

单击新建按钮，进入新建代理页面。
在公共信息区域，选择代理类型为OAM，并输入其它参数，如[图2]所示。
图2  新建OAM代理-公共信息

参数|说明
---|---
代理类型|选择OAM。
代理名称|输入接入的网元名称。
描述|接入网元简单信息描述。
启动|选择在创建网元代理后，是否立即启动该代理。是：表示创建网元代理后，自动启动该代理并连接下级网元。否：表示创建网元代理后，不启动该代理。维护人员可手工启动该代理。建议保持默认值是。
在基本属性区域，设置网元的相关连接参数，如[图3]所示。
图3  新建OAM代理-基本属性

参数|说明
---|---
网络地址|网元代理的IP地址。
端口|选择网元接入的协议类型及其对应的端口号。当采用HTTP方式接入时，默认端口号为7778。当采用HTTPS（单向认证）方式接入时，默认端口号为8777。当采用HTTPS（双向认证）方式接入时，默认端口号为8778。说明：协议类型和端口号需要与网元上的配置保持一致。
协议|选择网元接入的协议类型及其对应的端口号。当采用HTTP方式接入时，默认端口号为7778。当采用HTTPS（单向认证）方式接入时，默认端口号为8777。当采用HTTPS（双向认证）方式接入时，默认端口号为8778。说明：协议类型和端口号需要与网元上的配置保持一致。
位置|代理的位置。
EMS网络地址|当EM需要通过NAT穿越方式接入网元代理时，需要填写EM经过代理防火墙映射后的地址。一般情况下无需填写。
在安全参数区域，选择与网元之间的安全参数，如[图4]所示。
图4  安全参数

参数|说明
---|---
认证方式|当EM与代理之间采用HTTPS协议交互时，选择的认证方式。单向认证：客户端对服务端进行认证。双向认证：客户端对服务端进行认证，同时，服务端对客户端也需要进行认证。
根证书|当采用双向认证方式时，单击上传，上传网元提供的根证书文件（例如：ca.cert）。
客户端证书 / 客户端密钥|当采用双向认证方式时，单击上传，上传网元提供的客户端证书文件（例如：oam.srv.cli.crt）和客户端私钥文件（例如：oam.srv.cli.key）。
Token 用户名 / Token 密码|输入网元侧提供的用户名和密码信息。
支持集中安全|选择是否启用集中安全管理：是：启用集中安全。否：不启用集中安全。需要选是，启用集中安全。
 说明： 
网元接入启用集中安全，需EM已开启集中安全管理功能。 
（可选）如果网元侧修改了告警SNMP上报时的默认参数，在网元告警参数区域，选择版本为v3，并设置相关的认证参数。
图5  网元告警参数

参数|说明
---|---
版本|选择下级网元告警上报时SNMP V3的参数。NA：表示EM采用默认SNMP参数与下级网元进行对接。v3：表示EM采用定制的SNMP参数与下级网元进行对接，需进一步输入相关的用户名及安全级别。
用户名|当网元采用自定义的SNMP参数时，输入网元侧设置的SNMP V3用户名。
安全级别|当网元采用自定义的SNMP参数时，选择与网元对应的安全级别及其相关参数。非鉴权，非私有：SNMP无需鉴权。鉴权，非私有：需进一步输入鉴权密码和鉴权协议。鉴权，私有：需进一步输入鉴权密码和鉴权协议，以及私有密码和私有协议。
输入相关参数后，单击新建按钮，完成OAM代理的创建。
（可选）对应多NF组网，重复步骤1~7，将其它NF局接入EM。 
##### 验证 
在EM客户端拓扑页面的左侧命令树中，单击分层接入节点，进入分层接入页面， 如[图1]所示。查看到新建代理的管理状态为已启动，连接状态为正常，表示该NF接入EM成功。
#### License管理 
##### 申请License 
摘要 :业务License与实例化ZXUN RCP时生成的序列号一一对应，需要根据序列号申请License文件。
由于不同版本License的选项不一样，License申请模板必须和使用的软件版本配套。 
 说明： 
为了杜绝版本和模板错配问题，申请前要核实现网版本或者指定开局版本。 
相关信息 :由于制作License使用自动化审核和制作工具，因此License申请文件必须按照如下要求填写。 
每个License申请文件只能包含“填写说明”，“OAM-License模板”、“application-information”三个页签。 
禁止修改“填写说明”和“OAM-License模板”页签的内容和名称。 
实际申请的License信息请填写在页签“application-information”中。 
每个局点对应一个License 申请单，每个申请单只能有一个申请文件。文件名以网元的NF名称保存，必须保存为.xls的文件。 说明：文件名不能超过75字符，否则工具会读取失败。 
步骤 :填写License申请模板
从版本文件的license目录下获取license申请模板/versions/tools/license/License_application_template_5GC.xls
。
在application-information页签中按照实际情况填写网元信息和容量信息。
网元信息网元信息填写规范参见表1。表1  网元信息填写规范项目填写说明网元标识NF实例名称，例如：APP-HDBNJahAMF001BZX-03AZX011。设备序列号填写ZXUN RCP网元的序列号。注意：填写时前后不能有空格。获取序列号方法：使用admin用户登录EM客户端。在配置页面，展开PCF→PCF_x节点。在PCF_x下执行SHOW NFSN命令查询ZXUN RCP网元的序列号。网元产品名称NF名称，例如：APP-HDBNJahAMF001BZX-03AZX011。网元版本号网元版本号，例如：V7.20.21.B5。有效期填写格式必须为：yyyy/mm/dd。如果没有特殊要求，固定填写2099/12/31。网元位置填写实际的省份和城市。网元类型保持模板中的内容不变。 
容量信息License申请模板中网元的功能和容量必须按合同规定值填写。 说明：如果填写人员不清楚合同规定，需与售前技术人员确认或联系中兴通讯技术支持进行确认。容量填写规范如下：模板中容量控制项是纯数字格式，填写时必须是准确的数字，没有单位。容量值必须在模板注明的容量范围内，不允许超过容量值的最小和最大范围。 
填写完成后保存文件。 
申请License文件
登录CSC系统（[http://csc.zte.com.cn]）。
选择菜单软件许可证→流程处理→核心网license申请
，弹出新建申请单页面，如[图1]所示。
 说明： 
每个PCF网元都要填写一个申请单。一个申请单中不能包含多个网元。 
图1  新建申请单页面

填写申请信息，填写说明参见[表2]。
申请信息|填写说明
---|---
申请类型|根据实际选择。
合同号|填写实际的合同号。
产品线（PDM)|选择核心网（CN）
产品大类（PDM)|选择融合分组核心网/核心网（CN）
客户单位|选择实际的客户单位名称。
版本|选择实际的版本号。PCF网元的版本号可通过如下方法查询：登录EM客户端，在配置页面选择需要查询的PCF网元，执行SHOW VERSION DETAIL命令查询PCF运行实例对应的版本号。例如查询到Npcf_SMPolicyControl_0对应的版本号为V7.21.30.B2，则此处选择ZXUN-RCPV7.21.30.B2。
申请原因|根据实际填写。
单击附加说明栏的上传按钮，上传已填写完成的License申请模板License_application_template_5GC.xls
选择相关的审核和审批人员，单击提交。
审批通过后，CSC系统将在15分钟内自动制作License，并将License文件（命名为LCS单号_licensefile.zip）上传到CSC系统中。只有申请人才能查看和下载License文件。如果CSC系统制作License失败，则会显示失败信息。
##### 安装License 
摘要 :本节介绍License文件的安装过程，包括以下步骤： 
上传License：上传已申请到的License文件。 
发布License：生效License文件中的资源控制项和功能控制项。 
查询License：查询已加载的License文件的详细信息，确认其符合现场需求。 
前提 :已使用admin用户登录EM客户端。
相关信息 :ZXUN RCP的业务功能及业务资源受License控制，因此在以下场景中需要加载License。
新建局维护人员需要加载License，运营商才能使用ZXUN RCP的业务功能及业务资源。 
扩容或新增业务功能如果运营商申请了新的License，维护人员需要重新加载新的License。 
当前License过期运营商重新申请新的License后，维护人员需要重新加载新的License。 
License加载完成后，需要对现网业务进行测试。如果由于License加载影响到现网业务，需回滚到升级前的License。 
步骤 :将License文件保存在EM客户端所在的PC机上。
登录EM客户端，选择菜单维护→CN NF维护→网元许可证管理
，打开网元许可证管理窗口。选择需要发布License的网元，如[图1]所示。
图1  选择需要发布License的网元

单击操作列的发布按钮，进入许可证发布页面，如[图2]所示。
图2  许可证发布页面

单击操作列的上传按钮，在弹出的文件夹对话框中，选择需要上传的License文件。上传成功示例如[图3]所示。
图3  许可证上传成功示例

单击发布按钮。发布成功示例如[图4]所示。
图4  License发布成功示例

（可选）单击操作列的查看按钮，可以看到License的详细信息，检查页面信息与申请表格中的信息是否一致。
### LLD制作 
#### iConfig使用注意事项 
iConfig配置过程的所有操作，请打开VNF iConfig Template PCF.xlsm模板填写，请勿修改Templates目录下的其他模板文件。 
通过iConfig生成LLD后，如果后续需要修改数据，不能直接修改已生成的LLD文件，需要通过修改VNF iConfig Template NRF.xlsm模板相关配置内容后重新导出生成LLD文件。 
如需要跨单元格拷贝粘贴数据时，请选择粘贴为数值的方式进行粘贴，以免破坏表中的单元格格式。 
当多行拷贝时，如果中间存在隐藏行，不允许多行拷贝。 
严禁删除VNF iConfig Template PCF.xlsm模板里的表格。 
填写VNF iConfig Template PCF.xlsm模板表的VersionFile页签时，如果FileName默认值与实际使用的版本文件名称不一致，请修改该页签中FileName与实际版本名称一致，不能修改实际使用的版本文件名称与LLD中FileName默认值一致。 
#### 工作表配置流程 
工作表配置设计流程参见[表1]。
序号|工作表|说明
---|---|---
1|Global Setting|Global Setting表配置全局参数。
2|VNF ID|VNF ID表配置网元ID。
3|Basic_Info|Basic_Info表配置网元基本信息。
4|Dangerous_Command_config|Dangerous_Command_config表配置高危命令提醒。
5|Rosng|Rosng表配置接口IP参数。
6|NF Service IP|NF Service IP表配置单双栈和端口。
7|NRF_Info|NRF_Info表配置对接NRF的相关信息。
8|SMF_Info|SMF_Info表配置对接SMF的相关信息。
9|DRA_Info|DRA_Info表配置对接DRA的相关信息
10|BSF_Info|若对接BSF，则需对BSF_Info表进行对接BSF的相关信息配置。
11|PUDR_Info|若对接PUDR，则需对PUDR_Info表进行PUDR相关信息的配置。
12|OCS_Info|若对接OCS，则需对OCS_Info表进行OCS相关信息的配置。
13|CHF_Info|若对接静态CHF，则需对CHF_Info表进行静态CHF相关信息的配置。
14|EMS+_Info|若对接EMS+，则需对EMS+_Info表进行EMS+相关信息的配置。
15|SMS|SMS表配置短信网关相关参数。
16|North_Info|North_Info表配置北向相关信息。
17|Common VoNR|若为通用语音场景，则需对Common VoNR表进行语音场景下的一些动作参数配置。
18|N_M(Pool)|若为N_M容灾的场景，则需对N_M(Pool)表进行pool容灾相关信息的配置。
19|VersionFile|VersionFile表设置所使用的插件包名称。
20|Exist_MMLExist_MML_Type|如果需要比较现网中的MML命令，则将Global Setting表中的参数使用现网MML设置为YES，Exist_MML表中粘贴现网导出的命令。Exist_MML_Type表中填写需要与现网命令进行比对的MML命令。
21|Run|Run表用来生成PCF_Rosng_config、PCF_Service_config工作表，以及用于导入iDeploy中的LLD文件，当填完上述的工作表后，才使用到该表，无需修改。
22|PCF_Rosng_config|PCF_Rosng_config表是通过Run表单击生成Rosng配置命令生成的，表中数据就是最终iDeploy执行的配置命令数据，若生成的数据存在问题，可手动再进行修改，基本无需配置。
23|PCF_Service_config|PCF_Service_config表是通过Run表单击生成业务配置命令生成的，表中数据就是最终iDeploy执行的配置命令数据，若生成的数据存在问题，可手动再进行修改，基本无需配置。
#### 查看LLD模板使用说明 
摘要 :本节介绍打开LLD模板后，查看LLD模板使用说明和注意事项。 
步骤 :双击“VNF iConfig Template PCF.xlsm”文件，出现如[图1]所示的提示页面。
图1  打开LDD模板

选择启用宏，进入iConfig首页面，包含修订记录、LLD使用说明两个灰底色的工作表，以及其他红底色的工作表。具体工作表如[图2]所示。
图2  工作表

选择LLD使用说明页，查看LLD使用说明和注意事项，如[图3]所示。
图3  LLD使用说明

#### 配置LLD 
##### Global Setting 
Global Setting表用于进行全局参数的配置，根据实际LLD规划及EM相关信息修改全局配置，页面如[图1]所示。
图1  Global Setting

全局参数配置说明参见[表1]。
参数名称|参数说明
---|---
局数据配置场景|commercial：用于正式商用的配置。 商用场景会增加北向性能统计配置。firstcall：用于开局阶段打通Firstcall的配置。暂未区分场景，选用默认值commercial。
NF Name|MANO上看到的VNF网元名称，查询路径：应用→VNF。
NFID|VNF网元局号。范围：1-255。注意：此处填写的是VNF网元的局号，不是网元序号。
局数据配置方式|EM方式：VNF已对接EM，AIC通过EM的REST接口下发配置。本地网管方式：无EM网管，AIC通过SSH登录到VNF本地网管OAM下发配置。此处EM方式暂未使用，选用默认值本地网管方式。
VNF OAM Floating IP|VNF的OAM管理口浮动地址。VNF和EM的地址同时为IPv4或者IPv6类型。
VNF OAM 密码|VNF的OAM管理口密码。首次登录时，使用系统默认初始密码登录，并修改系统默认密码。注意：密码不能包含“admin”字符。非首次登录时，请填写当前密码。
存放备份数据的SFTP服务器IP|执行配置前先备份VNF当前业务数据到SFTP服务器。此处填写SFTP服务器的IP地址。如果用EM自带的SFTP服务器，需要填写EM第三个虚机节点的OAM IP，不能用EM的浮动地址。
SFTP服务器用户名|存放备份数据的SFTP服务器的用户名。
SFTP服务器密码|存放备份数据的SFTP服务器的密码。
备份文件的名称前缀|只允许大小写字母、数字、下划线和横杠，不能有其他特殊字符。备份时完整的文件名为此处填写的名称前缀加上时间，格式为：“名称前缀_yyyymmddhhmiss.zip”，其中yyyymmddhhmiss代表年月日时分秒。
备份文件的路径示例|备份文件的完整路径示例。 根据网元名称前缀变化，按备份时间生成文件。自动生成，不可修改。
使用现网MML|iConfig用于配置开局的基本配置，此开关打开，可以从现网配置中筛选高级配置提升iConfig配置能力。YES：Exist_MML表显示，表的A列粘贴现网配置命令。Exist_MML_Type表显示，用于粘贴需要比对的命令。NO：不使用现网MML命令，Exist_MML表和Exist_MML_Type表隐藏。默认关闭。
##### VNF ID 
VNF ID表用于配置网元序号，根据实际LLD规划修改网元序号，页面如[图1]所示。
图1  VNF ID

参数配置说明参见[表1]。
参数名称|参数说明
---|---
VNF Type|只能选择PCF网元。保持默认即可。
ID|用于资源名称，一般填写数字形式的字符串，如： 80、080等。根据实际规划填写。
VNF Brief Name|自动赋值字段，用于LLD内部索引，无需填写。
##### Basic_Info 
Basic_Info表分为五部分：网元基本信息配置、NTP配置、服务号段配置、DNN配置、切片配置。 
###### 网元基本配置 
Basic_Info表用于网元基本信息的配置，页面如[图1]所示。
图1  Basic_Info

网元基本信息配置的参数参见[表1]。
参数名称|参数说明
---|---
Application scenarios *|Common：通用场景。CMCC：中国移动。CUCC：中国联通。CTCC：中国电信。
TimeZone|时区。
NFID|局号。取自Global Setting表中的NFID。
nfid*|实际注册的nfid，通过SHOW REGISTER INFO命令获取，前后不能带空格且为全小写。
NFIDNODE|该参数用于设置NF ID Node。如果运营商有规范，参考规范配置。如果运营商没有要求，此处可置空，不填任何值。
NAME|网元名。取自Global Setting表中的NF NAME，此处无需修改。
FQDN *|FQDN。域名是5GC格式，非EPC格式。
TENANTNAME|租户名称。固定值tenant_1，不可修改。
PUBTENANTNAME|公共租户名称。固定值tenant_1，不可修改。
GROUPID|网元组编号，向NRF注册的groupId。默认不配置，此处可置空，不填任何值。
LOCALITY|网元组位置，向NRF注册的locality，按实际规划配置。
用户标识首选优先级 *|用户标识首选优先级。默认保持MSISDN优先。
用户标识次选优先级|用户标识次选优先级。此处与用户标识首选优先级关联，无需修改。
Diameter本地主机名 *|本局的Diameter主机名。主机名格式要采用EPC格式，非5GC格式。
Diameter本地域名 *|本局的Diameter域名。域名格式要采用EPC格式，非5GC格式。
服务区|该参数用于配置PCF的服务区域。默认不配置，此处置空，不填任何值。中国移动纯语音PCF，需要配置，例如：heQS。数据PCF，无需配置。中国电信/中国联通纯语音PCF POOL，需要配置。
是否对接BSF *|Y：对接BSF，显示BSF_Info表。N：不对接BSF，不显示BSF_Info表。中国移动选择N，中国电信和中国联通选择Y。
BSF对接方式 *|Dynamic：动态。Static：静态。中国电信和中国联通选择动态。
是否对接PUDR(SPR) *|Y：显示PUDR_Info表。N：不显示PUDR_Info表。数据PCF选择Y，语音PCF选择N。
是否对接OCS *|Y：显示表OCS_Info表。N：不显示OCS_Info表。默认值为N，根据现场实际情况选择。
是否对接CHF *|Y：显示CHF_Info表。N：不显示CHF_Info表。中国移动和中国联通选择N，中国电信部分省份开启了N28接口的局点选择Y。
CHF对接方式 *|Dynamic：动态。动态配置时隐藏CHF_Info表。Static：静态。默认是静态。
是否对接EMS+ *|Y：显示表EMS+_Info表。N：不显示EMS+_Info表。默认值为N，根据现场实际情况选择。
Network Type *|网络模式，按实际规划填写。VxLAN：SDN组网。VLAN： 非SDN组网。中国移动选择VxLAN，中国电信和中国联通选择VLAN。
语音配置 *|No_VoNR：无语音。适用于纯数据PCF。Common：通用语音配置。适用于国际局点。CMCC：中国移动。CUCC：中国联通。CTCC：中国电信。
容灾配置 *|NO_DR：不容灾。不启用热备是选择。N_M：POOL容灾。启用热备时选择。中国移动选择NO_DR，中国电信和中国联通场景选择N_M。
是否加载LICENSE|开局时部分配置需要License权限，仅支持内置了临时License的PCF版本。Y：配置前不需要手动加载License。N：配置前需要手动加载License。默认选择Y。
短信配置*|Y：提供短信配置。N：不提供短信配置。
带*项，必须填写，否则影响PCF_Rosng_config表、PCF_Service_config表和LLD文件的生成。 
###### NTP配置 
NTP配置用于配置NTP服务器，页面如[图2]所示。
图2  NTP配置

参数配置说明参见[表2]。
参数名称|参数说明
---|---
PRIMARYADD|主服务器IP地址。根据实际规划填写。
SECADD|次服务器IP地址。根据实际规划填写。
POLL|轮询间隔。若无特殊需求可使用表中默认值。
MAXCHANGE|最大误差阈值。若无特殊需求可使用表中默认值。
###### 服务号段配置 
服务号段配置用于配置向NRF注册的服务号码，页面如[图3]所示。为了避免现场配置大号段注册，影响商用局，本次仅提供配置单个测试号码。禁止配置全号码通配。若为纯语音局此处可将记录数置为0。
图3  服务号段配置

###### DNN配置 
DNN配置用于配置向NRF注册的DNN，页面如[图4]所示。根据运营商规划填写。
图4  DNN配置

###### 切片配置 
切片配置用于配置向NRF注册的切片信息，页面如[图5]所示。根据运营商规划填写。
图5  切片配置

##### Dangerous_Command_config 
Dangerous_Command_config表用于配置高危命令提醒，页面如[图1]所示。当这些命令在AIC-iDeploy中执行的时候，会提示为高危命令。如无特殊要求，保持默认即可。
图1  Dangerous_Command_config

##### Rosng 
Rosng工作表分为三个部分：VRF配置、IPU接口IP地址及关联配置、环回地址配置。 
###### VRF配置 
VRF配置用于配置对外接口参数，页面如[图1]所示。VRF Name和VPNID可根据现场自行规划。
 说明： 
中国电信通常会为CHF单独规划一个网络平面，此处为CHF固定预留一行，与[Basic_Info]表中的CHF对接方式 项关联，若要添加其他VRF请从下一行开始添加。
图1  VRF配置

###### IPU网络规划 
IPU的网络规划需要分不同的网络平面，两个以上对外的接口在不同的网络平面，或在同一个网络平面的不同子网，其配置不一样。
 说明： 
建议IPU对外的接口启用不同的网络平面。 
IPU接口配置页面如[图2]所示。
图2  IPU接口配置

根据现场规划设定虚机数量、主接口数量和子接口数量填入如[图2]所示的表中，单击点击生成接口列表链接按钮，系统会生成对应的信息表，页面如[图3]所示。根据现场规划将对应信息填入表中。
图3  IPU网络规划

###### 环回地址配置 
环回地址配置页面如[图4]所示。Loopback ID为必填参数，若未填入信息，则将导致生成的LLD文件在AIC-iDeploy中运行出错。
IP地址根据实际局点的IP规范修改。 
 说明： 
中国电信通常会为CHF单独规划一个网络平面，此处为CHF固定预留一行，与[Basic_Info]表中的CHF(OCS）对接方式 项关联，若要添加其他VRF Loopback地址，请从下一行开始添加。
图4  环回地址配置

##### NF Service IP 
NF Service IP表用于配置HTTP客户端模板和服务端模板的单/双栈地址和端口，主要是引用[Rosng]表中配置的相关数据，IP地址类型可以选择。页面如[图1]所示。
 说明： 
在Run表页面，单击生成业务配置命令时，只有本表中SBI和CHF两行数据会生成配置命令。其他行不生成配置命令，仅用于展示。
图1  NF Service IP表参数

参数说明参见[表1]。
参数名称|参数说明
---|---
IP Type|根据实际情况选择。如果IP类型选择Ipv4时，IPv6下的数据将自动变为“/”。
IPv4/IPv6|工作表中的IPv4/IPv6地址、VPNID信息，引用Rosng的环回地址相关配置数据。
VPNID|工作表中的IPv4/IPv6地址、VPNID信息，引用Rosng的环回地址相关配置数据。
PORT|根据实际情况配置。
##### NRF_Info 
NRF_Info表用于配置对接NRF相关信息，包括NRF服务器分组配置、服务发现配置、NRF接入配置、服务基础配置、关联HTTP客户端模板、NRF服务器策略配置、服务发现方式配置、NRF策略配置。 
###### NRF服务器分组配置 
NRF服务器分组配置，用于区分主备NRF，页面如[图1]所示。若只有一个NRF，此处记录数置为1。
图1  NRF服务器分组配置

###### 服务发现配置 
服务发现配置用于配置服务发现相关参数，页面如[图2]所示。
图2  服务发现配置

服务发现参数说明参见[表1]。
参数名称|参数说明
---|---
RECACHETHRESHOLD|续缓存时间阈值（秒）。若无特殊需求，使用表中默认值300 。
SUBREQNFTYPE|订阅者NF类型，固定为PCF_TYPE，不可修改。
SUBREQFQDN|订阅者FQDN为PCF的FQDN，取自Basic_Info表中FQDN值，无特殊需求无需修改。
###### NRF接入配置 
NRF接入配置页面如[图3]所示。用于填写NRF地址、端口、优先级及主备等信息。GROUPID的值对应[NRF服务器分组配置]中的ID。端口：中国移动默认80，中国电信和中国联通默认8080。
图3  NRF接入配置

###### 服务基础配置 
服务基础配置用于配置PCF支持的服务，页面如[图4]所示。必须配置NPCF、NPCF_SMPOLICYCONTROL服务，其他服务根据运营商的规划选择。
 说明： 
中国电信暂不开启NPCF_AMPOLICYCONTROL服务。 
当[Basic_Info]表中Application scenarios的值选择CTCC，即配置场景为中国电信时，NPCF_AMPOLICYCONTROL服务会被隐藏，不配置此服务，但服务记录数仍显示为3，若要新添加其它服务请从4开始。
图4  服务基础配置

###### 关联HTTP客户端模板 
关联HTTP客户端模板设置页面如[图5]所示。
当PCF动态查询NRF得到相关接口服务记录后，动态路由寻址时使用该命令。 
设置成功后，PCF会根据对端的服务类型、FQDN等信息匹配该配置，获取客户端模板ID，供PCF动态路由寻址时选择链路使用。 
 说明： 
当NPCF_AMPOLICYCONTROL、NBSF_MGT、NCHF_SPENDLMTCONTROL三个服务被隐藏时，记录数仍为5，若新添加其它服务请从6开始。 
图5  关联HTTP客户端模板

###### NRF服务器策略配置 
NRF服务器策略配置页面如[图6]所示，用于配置NRF模式，根据现场实际情况配置。
图6  NRF服务器策略配置

###### 服务发现方式配置 
服务发现方式配置页面如[图7]所示，用于配置动态NF服务发现时的地址选择方式。无特殊要求，保持默认值RANDOM，无需修改。
图7  服务发现方式配置

###### NRF策略配置 
NRF策略配置页面如[图8]所示，用于配置无号段时是否允许向NRF注册。纯数据局或者数据语音混合局，保持默认值NO，纯语音局需要设置为YES。
图8  NRF策略配置

##### SMF_Info 
SMF_Info用于配置对接SMF时的相关信息，包括SMF邻接主机组配置、SMF邻接主机IP配置。 
###### SMF邻接主机组配置 
SMF邻接主机组配置如[图1]所示。
通常配置3个邻接主机组： 
通配SMF邻接主机组10：FQDN为*的通配。 
本省SMF邻接主机组11：省内，对应ADJHOSTIP中的省内精确或省内通配IP地址的SMF。 
外省SMF邻接主机组12：省外，对应ADJHOSTIP中的省外的通配IP地址的SMF。 
图1  SMF邻接主机组配置

###### SMF邻接主机IP配置 
SMF邻接主机IP配置如[图2]所示。现场根据实际SMF数量和地址修改。
图2  SMF邻接主机IP配置

##### DRA_Info 
DRA_Info表用于配置对接DRA的相关信息。DRA作为中间网元，连接ZXUN RCP与AF或者PCEF。
###### PGW邻接主机组配置 
PGW邻接主机组配置如[图1]所示。
通常配置2个邻接主机组： 
省内PGW邻接主机组21。 
省外PGW邻接主机组22。 
图1  PGW邻接主机组配置

###### PGW邻接主机配置 
PGW邻接主机配置如[图2]所示。根据现场实际邻接主机名配置。
图2  PGW邻接主机配置

###### PGW邻接主机通配配置 
PGW邻接主机通配如[图3]所示。保持默认即可，无需修改。
图3  PGW邻接主机通配配置

###### AF邻接主机配置 
AF邻接主机配置如[图4]所示。根据现场实际邻接主机名配置。
图4  AF邻接主机配置

###### AF邻接主机通配配置 
AF邻接主机通配配置如[图5]所示。保持默认即可，无需修改。
图5  AF邻接主机通配配置

###### SCTP配置 
SCTP配置如[图6]所示，用于配置对接DRA的SCTP偶联。
图6  SCTP配置

###### Diameter链路配置 
Diameter链路配置如[图7]所示，用于配置对接DRA的Diameter链路。每套DRA至少配置4条Diameter链路。
图7  Diameter链路配置

###### Diameter路由组配置 
Diameter路由组配置如[图8]所示，用于配置到DRA的路由组。多套DRA相同域名的应用类型共用1个路由组。分别配置Gx、Rx、Sy等应用类型（根据现场组网）的路由组，其中，Rx如果有多个域名也仅配置1个路由组，URL取后缀公共部分。路由组属性：负荷分担。
 说明： 
DRA和BSF不能用同一个Diameter路由组。 
图8  Diameter路由组配置

###### Diameter路由配置 
Diameter路由配置如[图9]所示，用于配置到DRA的路由。每个应用类型+URL只有一种（Gx、Rx、Sy，根据现场组网），所有DRA链路均需配置，归属DRA的Diameter路由组。
例如：DRA1链路号为1~4，DRA2链路号为51~54，则路由配置中链路号1~4、51~54均配置Gx路由（路由组1）和Rx路由（路由组2），共配置16条Diameter路由、2个路由组。 
图9  Diameter路由配置

##### BSF_Info 
BSF_Info表用于配置对接BSF的相关信息。当需要对接BSF，[Basic_Info]表中的是否对接BSF选择Y时，配置此表，否则此表被隐藏无需配置。
###### BSF动态接入 
BSF动态接入时，需要配置的项包括DNN启用BSF配置、SCTP配置、Diameter链路配置、Diameter路由组配置和Diameter路由配置。 
####### DNN启用BSF配置 
DNN启用BSF配置如[图1]所示，配置相应的DNN启用BSF。
图1  DNN启用BSF配置

####### SCTP配置 
SCTP配置如[图2]所示，用于配置到BSF的SCTP偶联。
图2  SCTP配置

####### Diameter链路配置 
Diameter链路配置如[图3]所示，用于配置到BSF的Diameter链路。每套BSF至少配置2条Diameter链路。
图3  Diameter链路配置

####### Diameter路由组配置 
Diameter路由组配置如[图4]所示，用于配置到BSF的Diameter路由组。多套BSF相同URL的应用类型共用1个路由组。配置Rx应用类型的路由组，Rx如果有多个域名，也仅配置1个路由组，URL取后缀公共部分。路由组属性：负荷分担。
 说明： 
BSF和DRA不能用同一个Diameter路由组。 
图4  Diameter路由组配置

####### Diameter路由配置 
Diameter路由配置如[图5]所示，用于配置到BSF的Diameter路由。每个应用类型+URL只有一种（Rx），所有BSF链路均需配置，归属BSF的Diameter路由组。
例如：BSF1链路号为201~202，BSF2链路号为251~252，则路由配置中链路号201~202、251~252均配置Rx路由，共配置4条Diameter路由、1个路由组。 
图5  Diameter路由配置

###### BSF静态接入 
BSF静态接入时，需要配置如下所有配置项。 
####### 服务发现方式配置 
服务发现方式配置如[图1]所示，用于配置到静态BSF的地址选择方式。无特殊要求保持默认值RANDOM，无需修改。
图1  服务发现方式配置

####### 地址范围配置 
地址范围配置如[图2]所示，用于配置IPv4/IPv6地址范围。如果不需要通过终端的IPv4地址区分BSF，可以不配IPv4地址范围；如果不需要通过终端的IPv6地址区分BSF，可以不配IPv6地址范围。
图2  地址范围配置

####### BSF接入配置 
BSF接入配置如[图3]所示，用于配置静态BSF的IP地址和端口。若只有一个BSF，可将记录数置为1。若为单栈地址，可将不需要的地址类型对应的地址置空。
图3  BSF接入配置

####### 服务版本组配置 
服务版本组配置如[图4]所示，用于配置API版本。若API版本无变化，保持默认值，无需修改。
图4  服务版本组配置

####### 对端NF基本信息配置 
对端NF基本信息配置如[图5]所示，用于配置BSF基本信息。优先级默认为1，其他参数若无特殊需求，可保持默认值，无需修改。
图5  对端NF基本信息配置

####### DNN启用BSF配置 
DNN启用BSF配置如[图6]所示，配置相应的DNN启用BSF。
图6  DNN启用BSF配置

####### DNN组配置 
DNN组配置如[图7]所示，用于配置终端的DNN。如果不需要通过终端的DNN区分BSF，可以将记录数置为0。
图7  DNN组配置

####### SCTP配置 
SCTP配置如[图8]所示，用于配置到BSF的SCTP偶联。
图8  SCTP配置

####### Diameter链路配置 
Diameter链路配置如[图9]所示，用于配置到BSF的Diameter链路。每套BSF至少配置2条Diameter链路。
图9  Diameter链路配置

####### Diameter路由组配置 
Diameter路由组配置如[图10]所示，用于配置到BSF的Diameter路由组。多套BSF相同URL的应用类型共用1个路由组。配置Rx应用类型的路由组，Rx如果有多个域名，也仅配置1个路由组，URL取后缀公共部分。路由组属性：负荷分担。
 说明： 
BSF和DRA不能用同一个Diameter路由组。 
图10  Diameter路由组配置

####### Diameter路由配置 
Diameter路由配置如[图11]所示，用于配置到BSF的Diameter路由。每个应用类型+URL只有一种（Rx），所有BSF链路均需配置，归属BSF的Diameter路由组。
例如：BSF1链路号为201~202，BSF2链路号为251~252，则路由配置中链路号201~202、251~252号均配置Rx路由，共配置4条Diameter路由、1个路由组。 
图11  Diameter路由配置

##### PUDR_Info 
PUDR_Info表用于配置对接PUDR时的相关信息。 
###### PUDR邻接主机配置 
PUDR邻接主机配置如[图1]所示，用于配置PUDR邻接主机。根据现场实际邻接主机名配置。
图1  PUDR邻接主机配置

###### SCTP配置 
SCTP配置如[图2]所示，用于配置对接PUDR的SCTP偶联。
图2  SCTP配置

###### Diameter链路配置 
Diameter链路配置如[图3]所示，用于配置到PUDR的Diameter链路。每套PUDR至少配置4条Diameter链路。
图3  Diameter链路配置

###### Diameter路由组配置 
Diameter路由组配置如[图4]所示，用于配置到PUDR的路由组。到每套PUDR配置2个路由组，分别对应Sp和Sp'。路由组属性：负荷分担。
图4  Diameter路由组配置

###### Diameter路由配置 
Diameter路由配置如[图5]所示，用于配置到PUDR的路由。
到主用PUDR链路的优先级为中，到主用PUDR每条链路都配Sp和Sp'路由，路由组为主用PUDR的Sp和Sp'路由组。例如：PUDR1链路号为101~104，则链路号101~104配置支持应用为Sp的路由（路由组11）和支持应用为Sp'的路由（路由组12），共配置8条Diameter路由、2个路由组。路由优先级配置为中。 
到备用PUDR链路为优先级为低，到备用PUDR每条链路都配Sp和Sp'路由，路由组为备用PUDR的Sp和Sp'路由组。例如：PUDR1链路号为151~154，则链路号151~154配置支持应用为Sp的路由（路由组16）和支持应用为Sp'的路由（路由组17），共配置8条Diameter路由、2个路由组。路由优先级配置为低。 
图5  Diameter路由配置

##### OCS_Info 
当[Basic_Info]表中的是否对接OCS选择N时，此表被隐藏无需配置。
当[Basic_Info]表中的是否对接OCS选择Y时，此表显示，用于配置对接OCS的相关信息。
###### OCS邻接主机配置 
OCS邻接主机配置如[图1]所示。根据现场实际邻接主机名配置。
图1  OCS邻接主机配置

###### SCTP配置 
SCTP配置如[图2]所示，用于配置对接OCS的SCTP偶联。
图2  SCTP配置

###### Diameter链路配置 
Diameter链路配置如[图3]所示，用于配置对接OCS的Diameter链路。每套OCS至少配置4条Diameter链路。
图3  Diameter链路配置

###### Diameter路由组配置 
Diameter路由组配置如[图4]所示，用于配置到OCS的路由组。到每套OCS配置1个路由组。路由组属性：负荷分担。
图4  Diameter路由组配置

###### Diameter路由配置 
Diameter路由配置如[图5]所示，用于配置到OCS的路由。
到主用OCS链路的优先级为中，到主用OCS每条链路都配置Sy路由，路由组为主用OCS的Sy路由组。例如：OCS1链路号为401~404，则链路号401~404配置支持应用为Sy的路由，共4条Diameter路由配置，1个路由组，路由优先级配置为中。 
到备用OCS链路优先级为低，到备用OCS每条链路都配置Sy路由，路由组为备用OCS的Sy路由组。例如：OCS2链路号为451~454，则链路号451~454配置支持应用为Sy的路由，共4条Diameter路由配置，1个路由组，路由优先级配置为低。 
图5  Diameter路由配置

##### CHF_Info 
当[Basic_Info]表中的是否对接CHF选择N时，此表被隐藏无需配置。
当[Basic_Info]表中的是否对接CHF选择Y时，且CHF对接方式选择Dynamic时，此表被隐藏无需配置。
当[Basic_Info]表中的是否对接CHF选择Y时，且CHF对接方式选择Static时，此表显示，用于配置对接静态CHF的相关信息。
###### 服务发现方式配置 
服务发现方式配置如[图1]所示，用于配置到静态CHF的地址选择方式。无特殊要求保持默认值RANDOM，无需修改。
图1  服务发现方式配置

###### CHF接入配置 
CHF接入配置如[图2]所示，用于配置静态CHF的IP地址和端口。若只有一个CHF，可将记录数置为1。若为单栈地址，可将不需要的地址类型对应的地址置空。
图2  CHF接入配置

###### 服务版本组配置 
服务版本组配置如[图3]所示，用于配置API版本。若API版本无变化，保持默认值，无需修改。
图3  服务版本组配置

###### 对端NF基本信息配置 
对端NF基本信息配置如[图4]所示，用于配置CHF基本信息。主用CHF优先级默认为1，备用CHF默认为2，其他参数若无特殊需求，保持默认值，无需修改。
图4  对端NF基本信息配置

##### EMS+_Info 
当[Basic_Info]表中的是否对接EMS+选择N时，此表被隐藏无需配置。
当[Basic_Info]表中的是否对接EMS+选择Y时，此表显示，用于配置对接EMS+的相关信息。
###### EMS+链路配置 
EMS+链路配置如[图1]所示。根据现场实际情况配置EMS+服务器地址及端口、RCP本端地址及端口和网络VPN。
图1  EMS+链路配置

###### EMS+日志上报配置 
EMS+日志上报配置如[图2]所示。根据现场实际情况配置EMS+上报开关、上报最大速率和失败链信息。
图2  EMS+日志上报配置

###### EMS+日志开关配置 
EMS+日志开关配置如[图3]所示。根据现场实际情况配置EMS+日志开关。若无特殊要求，此处保持默认无需修改。
图3  EMS+日志开关配置

SMS :SMS表用于配置短信SMS的相关信息，页面如[图1]所示。当需要短信功能，[Basic_Info]表中的短信配置选择Y时，配置此表，否则此表被隐藏无需配置。
图1  SMS参数配置

参数说明参见[表1]。
参数名称|参数说明
---|---
本端端口个数|PCF与短信中心对接采用负荷分担方式，通常需配置两条链路组，每个链路组下各主备两条链路，因此需要配置4个端口。
本端IP|通常配置为RCP的环回接口地址。必须与对端协商一致。
本端起始端口|根据规划配置。必须与对端协商一致。
远端IP|短信中心的IP地址。根据规划配置。必须与对端协商一致
远端端口|根据规划配置。必须与对端协商一致。
VPN|用于配置链路所属的VPN编号，根据规划配置。
协议类型|配置短信中心的使用的协议类型。本参数需要与短信中心之间协商一致。SMPP：短信标协议CMPP：中国移动定制短信协议SMGP：中国电信定制短信协议SGIP：中国联通定制短信协议CNGP：中国网通定制短信协议
用户账号|配置用于验证的用户账号。本参数需要与短信中心之间协商一致。
密码|配置用于验证的用户密码，为PASSWORD型字符（密文输入）。本参数需要与短信中心之间协商一致。
短信源地址|配置用户端所显示的发送方地址。编码时该地址按照配置短信发送方地址编码类型和方案进行编码。
短信中心类型|配置短信中心类型。SMS：短信网关POP-D：POP-D平台
短信业务标识|用来表明短信应用服务的一个字符串。本参数需要与短信中心之间协商一致。
企业代码|用来表明服务提供商身份的一个字符串。本参数需要与短信中心之间协商一致。
##### North_Info 
North_Info表用于配置北向信息，仅需修改省份信息，页面如[图1]所示。
图1  North_Info参数配置

##### Common VoNR 
Common VoNR表用于配置通用语音场景下部分可修改的动作参数值，页面如[图1]所示。
图1  Common VoNR参数配置

##### N_M(Pool) 
N_M(Pool)表用于配置POOL容灾时本局的相关信息。当[Basic_Info]中的容灾配置选择N_M时，配置此表，否则此表被隐藏，无需配置。
###### POOL容灾各局信息配置 
POOL容灾各局信息配置如[图1]所示，用于配置POOL容灾时各局的相关信息。第一行为带UDSF主局信息，第二行为带UDSF备局信息，其它行为不带UDSF局信息。
CGW节点个数默认32，无需修改。 
图1  POOL容灾各局信息配置

###### 局间SCTP配置 
局间SCTP配置如[图2]所示，用于配置本局到各容灾局的SCTP偶联。各局间的SCTP链路要相互对应。
例如：PCF01与PCF02间的链路，配置PCF01时，本端地址为PCF01的地址，端口为8121，对端地址为PCF02的地址，端口为18121；配置PCF02时，本端地址为PCF02的地址，端口为18121，对端地址为PCF01的地址，端口为8121。 
图2  局间SCTP配置

###### 局间Diameter链路配置 
局间Diameter链路配置如[图3]所示，用于配置本局到各容灾局的Diameter链路。本局到每个局需要分别配置4条Diameter链路。
图3  局间Diameter链路配置

###### Diameter路由组配置 
Diameter路由组配置如[图4]所示，用于配置本局到各容灾局的Diameter路由组。本局到每个局需要分别配置Gx、Rx、Sy等应用类型（根据现场组网）的路由组，其中，Rx如果有多个域名，也仅配置1个路由组，URL取后缀公共部分。路由组属性：负荷分担。
图4  Diameter路由组配置

###### Diameter路由配置 
Diameter路由配置如[图5]所示，用于配置本局到各容灾局的Diameter路由。每个应用类型+URL只有一种（Gx、Rx、Sy，根据现场组网），所有容灾链路均需配置，归属容灾的Diameter路由组。
例如： 
PCF01-PCF02的容灾链路号为261~264，则路由配置中链路号261~264均配置Gx路由（路由组261）和Rx路由（路由组262），共配置8条Diameter路由、2个路由组。 
PCF01-PCF03的容灾链路号为271~274，则路由配置中链路号271~274均配置Gx路由（路由组271）和Rx路由（路由组272），共配置8条Diameter路由、2个路由组。 
PCF01-PCF04的容灾链路号为281~284，则路由配置中链路号281~284均配置Gx路由（路由组281）和Rx路由（路由组282），共配置8条Diameter路由、2个路由组。 
PCF01-PCF05的容灾链路号为291~294，则路由配置中链路号291~294均配置Gx路由（路由组291）和Rx路由（路由组292），共配置8条Diameter路由、2个路由组。 
PCF01-PCF06的容灾链路号为301~304，则路由配置中链路号301~304均配置Gx路由（路由组301）和Rx路由（路由组302），共配置8条Diameter路由、2个路由组。 
PCF01-PCF07的容灾链路号为311~314，则路由配置中链路号311~314均配置Gx路由（路由组311）和Rx路由（路由组312），共配置8条Diameter路由、2个路由组。 
PCF01-PCF08的容灾链路号为321~324，则路由配置中链路号321~324均配置Gx路由（路由组321）和Rx路由（路由组322），共配置8条Diameter路由、2个路由组。 
图5  Diameter路由配置

##### VersionFile 
VersionFile表用于设置导入AIC-iDeploy中的插件包，只需填写插件包名称，页面如[图1]所示。
图1  VersionFile工作表参数配置

如果插件包导入AIC-iDeploy，出现名称不一致问题，则可能是此处填写的插件包名称与实际插件包名称不一致导致的。 
插件包存放路径为：versions/tools/AIC/aic-plugin-pcf-V3.21.10.06-PCF.zip。
 说明： 
版本不同，插件包名称会有变化，需要根据发布的插件包名称填写。 
##### Exist_MML 
 说明： 
如果某些局点的配置数据有特殊需求，可通过Exist_MML表和Exist_MML_Type表实现对齐这些特殊配置。 
如无特殊配置，此页面不用配置。 
如果需要配置Exist_MML表，则将[Global Setting]表中的参数使用现网MML设置为YES，Exist_MML表显示，页面如[图1]所示。
将现网配置通过执行[EXPT MML]命令导出，并将导出的配置命令复制到该表A列。
图1  Exist_MML

##### Exist_MML_Type 
 说明： 
如果某些局点的配置数据有特殊需求，可通过Exist_MML表和Exist_MML_Type表实现对齐这些特殊配置。 
如无特殊配置，此页面不用配置。 
如果需要配置Exist_MML_Type表，则将[Global Setting]表中的参数使用现网MML设置为YES，Exist_MML_Type表显示，页面如[图1]所示。
Exist_MML_Type表用于填写需要比对的MML命令。如果表Exist_MML中有Exist_MML_Type表字段的命令，那么会在最后生成的命令脚本中添加这些命令。 
图1  Exist_MML_Type

##### Run 
Run表页面如[图1]所示，不需要运维人员做任何改动，只需要单击相关按钮生成相关表格和文件即可。输出LLD文件参见“[导出LLD]”。
图1  Run表

###### 生成Rosng配置命令 
单击生成Rosng配置命令，出现如[图2]所示的提示信息。
图2  提示信息

单击是或者直接敲击键盘上的Enter键，系统将会自动更新[PCF_Rosng_config]表中的数据，并显示运行的进度，如[图3]所示。当进度达到100%以后，会自动跳转到[PCF_Rosng_config]工作表。
图3  更新完成提示

###### 生成业务配置命令 
单击生成业务配置命令，出现如[图4]所示的提示信息。
图4  生成提示信息

单击是或者直接敲击键盘上的Enter键，系统将会自动更新[PCF_Service_config]表中的数据，并显示运行的进度，如[图5]所示。当进度达到100%以后，会自动跳转到[PCF_Service_config]工作表。
图5  数据更新完成

当存在必配参数没有配置，赋值为空值时，会报如[图6]所示的类似错误，需要根据提示信息，检查生成的脚本对应的错误行，进行修改。
图6  错误提示

##### PCF_Rosng_config 
PCF_Rosng_config表中的脚本是由LLD自动生成，即在[Run]表中，单击生成Rosng配置命令，系统基于[Rosng]表进行内部处理后最终生成该表中的内容。页面如[图1]所示。
图1  PCF_Rosng_config工作表

##### PCF_Service_config 
PCF_Service_config表中脚本是由LLD自动生成，即在[Run]表中单击生成业务配置命令，系统基于各表依次进行内部处理后，最终生成该表中的内容。页面如[图1]所示。
图1  PCF_Service_config工作表

 说明： 
检查LLD模板生成的内容是否正确，若与实际需求不一致，可手动修改或删除后，在[Run]表中单击输出LLD文件，确保最终导入AIC-iDeploy中的文件是正确的。
#### 导出LLD 
摘要 :本节介绍导出LLD的操作过程。 
步骤 :当VNF iConfig Template PCF.xlsm中的所有的页签配置完成，并且通过Run表生成的[PCF_Rosng_config]表和[PCF_Service_config]表内容经检查确认无误后，单击输出LLD文件，出现如[图1]所示页面。
图1  生成提示信息

单击是或者直接敲击键盘上的Enter键，当进度达到100%以后，会自动生成LLD文件（例如，ZTE VNF iConfig LLD(PCF_232).xlsx），如[图2]所示。导出的LLD文件存放在VNF iConfig Template PCF.xlsm文件所在的路径，用于导入AIC-iDeploy进行局数据自动化配置。
图2  数据更新完成

### 自动部署配置 
摘要 :LLD文件生成后， 需要将LLD文件和aic-plugin包导入AIC-iDeploy部署工具进行自动配置部署。 
前提 :AIC-iDeploy版本：V3.22.07及以后版本。 
当Basic_Info表中是否加载LICENSE为N时，部署前确保网元已手动加载过License。如果出现加载失败的情况，检查临时License的有效期，临时License的有效期是从制作日期开始，之后的90天有效。如果过期可以通过网管手动加载新的License。临时License加载方式参见加载临时License。 
相关信息 :AIC-iDeploy工具使用注意事项： 
运行AIC-iDeploy的PC机，需去除PC机休眠设置。 
AIC-iDeploy工具所在路径，不宜层级过深。因Windows系统对文件路径有最大200字节的限制，当路径过长时，无法正常运行。 
AIC-iDeploy工具不支持运行该工具的PC机的计算机名带中文字符。 
AIC-iDeploy工具要求运行该工具的PC机语言设置为：中文（简体，中国）。 
步骤 :进入iDeploy.exe所在的iDeploy目录，双击iDeploy.exe，打开iDeploy工具，页面如[图1]所示。
图1   iDeploy-LLD导入

单击点击这里导入LLD文件按钮，弹出文件选择会话框，选择[导出LLD]中导出的LLD文件（例如，ZTE VNF iConfig LLD(PCF_232).xlsx）。导入成功后，页面如[图2]所示。
图2  导入成功

切换到版本导入页面，导入插件文件，页面如[图3]所示。
图3  版本导入

在选择导入列，单击待导入文件对应的按钮，选择导入插件文件（例如，aic-plugin-pcf-V3.21.10.06-PCF2132.zip）。
文件选择完毕后，回到iDeploy页面，单击上传按钮，开始导入文件，页面[图4]所示。
图4  导入文件

进度达到100%后，文件导入成功，对应的状态显示为，页面如[图5]所示。
图5  导入文件成功

切换到部署页面，勾选需要部署的领域，单击开始，启动部署，如[图6]所示。
图6  启动部署

开始部署后，右侧日志栏中会实时显示运行的结果，勾选的各个选项成功部署后，会在选项名称后面显示对应的状态（或者）。
（可选）配置完成后，如果需要回退或配置失败后回退，请参考“[使用iDeploy恢复局数据]”。
### 参考 
#### 加载临时License 
摘要 :开局时，部分配置需要License权限，如果没有选择系统自动加载，则需要手动加载临时License。 
临时License获取路径：versions/tools/License/PCF_20210729042959182.lic（此处为举例，License名称以版本包内License实际名称为准）。
 说明： 
现场加载使用临时License完成测试后，在正式商用前务必更换成正式License。 
步骤 :将License文件保存在EM客户端所在的PC机上。
登录EM客户端，选择菜单维护→CN NF维护→网元许可证管理
，打开网元许可证管理窗口。选择需要发布License的网元，如[图1]所示。
图1  选择需要发布License的网元

单击操作列的发布按钮，进入许可证发布页面，如[图2]所示。
图2  许可证发布页面

单击操作列的上传按钮，在弹出的文件夹对话框中，选择需要上传的License文件。上传成功示例如[图3]所示。
图3  许可证上传成功示例

单击发布按钮。发布成功示例如[图4]所示。
图4  License发布成功示例

（可选）单击操作列的查看按钮，可以看到License的详细信息。
#### 使用iDeploy恢复局数据 
摘要 :
iDeploy支持选择指定的备份数据文件进行局数据恢复。 
前提 :LLD中指定的SFTP服务器可正常连接。 
已导入VNF网元的iConfig LLD模板和插件包。 
已经执行过局数据配置，SFTP服务器或iDeploy本地存在已备份的局数据配置文件。 
步骤 :在iDeploy页面，单击设置按钮，进入设置页面，如[图1]所示。
图1  设置页面

选择通用设置页面，打开显示网元清除按钮开关，页面如[图2]所示。
图2  VNF设置

选择VNF设置页面，选择用于恢复的备份数据来源，页面如[图3]所示。用于数据恢复的备份文件来源参数，系统默认是使用SFTP服务器中的备份文件，可以根据实际情况修改为使用本地备份文件。
图3  通用设置

切换到部署页面，选择需要进行数据恢复的配置节点，单击按钮，如[图4]所示。
图4  选择恢复数据配置节点

iDeploy会根据设置，连接SFTP服务器或搜索本地路径，获取到当前存在的备份文件列表，弹出对话框，选择一个备份文件，页面如[图5]所示。
图5  恢复数据

输入确认字符串后，单击确定，开始使用指定的文件进行数据恢复。
## 缩略语 
## 缩略语 
EM :Element Management网元管理
HTTP :Hypertext Transfer Protocol超文本传输协议
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
### NAT 
Network Address Translation网络地址转换
NF :Network Function网络功能
### SNMP 
Simple Network Management Protocol简单网络管理协议
## 初始配置（手工部署） 
### 配置流程 
在ZXUN RCP的实例化完成后，需要按照配置流程进行数据配置，使ZXUN RCP正常运行并提供相应的业务功能。ZXUN RCP的初始配置流程参见[表1]。
操作|说明
---|---
配置准备|将ZXUN RCP接入EM，加载业务License，同步NF实例化后系统生成的全部表数据。
Rosng配置|配置IP协议栈相关数据，包括VRF配置、接口地址配置、环回接口地址配置、封装VLAN、静态路由配置。
公共基础数据配置|配置ZXUN RCP的NF基础数据，包括时区配置、NTP服务器配置、NF信息配置、用户标识优先级配置、VM资产采集管理策略配置。
通用对接数据配置|配置ZXUN RCP与PUDR、SMSC的对接数据。
PCRF对接数据配置|配置ZXUN RCP与PCEF、AF、OCS的对接数据。
PCF对接数据配置|配置基础服务、HTTP客户端、服务端模板，以及与NRF、SMF、BSF、CHF的对接数据。
同步变化表|将相关配置数据同步到网元。
### 配置准备 
#### NF接入EM 
摘要 :EM为NF提供统一的配置入口，每个NF实例化完成之后，都需要接入EM，完成后续的开通和配置操作。
对于多个NF组网场景，每个NF需要分别执行接入EM的操作。 
步骤 :在EM客户端，选择菜单拓扑→分层接入
，进入分层接入页面， 如[图1]所示。
图1  分层接入

单击新建按钮，进入新建代理页面。
在公共信息区域，选择代理类型为OAM，并输入其他参数，如[图2]所示。
图2  新建OAM代理-公共信息

参数|说明
---|---
代理类型|选择OAM。
代理名称|输入接入的网元名称。
描述|接入网元简单信息描述。
启动|选择在创建网元代理后，是否立即启动该代理。是：表示创建网元代理后，自动启动该代理并连接下级网元。否：表示创建网元代理后，不启动该代理。维护人员可手工启动该代理。建议保持默认值是。
在基本属性区域，设置网元的相关连接参数，如[图3]所示。
图3  新建OAM代理-基本属性

参数|说明
---|---
网络地址|网元代理的IP地址。
端口|选择网元接入的协议类型及其对应的端口号。协议类型和端口号需要与网元上的配置保持一致。当采用HTTP方式接入时，默认端口号为7778。当采用HTTPS（单向认证）方式接入时，默认端口号为8777。当采用HTTPS（双向认证）方式接入时，默认端口号为8778。
协议|选择网元接入的协议类型及其对应的端口号。协议类型和端口号需要与网元上的配置保持一致。当采用HTTP方式接入时，默认端口号为7778。当采用HTTPS（单向认证）方式接入时，默认端口号为8777。当采用HTTPS（双向认证）方式接入时，默认端口号为8778。
位置|代理的位置。
EMS网络地址|当EM需要通过NAT穿越方式接入网元代理时，需要填写EM经过代理防火墙映射后的地址。一般情况下无需填写。
在安全参数区域，选择与网元之间的安全参数，如[图4]所示。
图4  安全参数

参数|说明
---|---
认证方式|当EM与代理之间采用HTTPS协议交互时，选择的认证方式。单向认证：客户端对服务端进行认证。双向认证：客户端对服务端进行认证，同时，服务端对客户端也需要进行认证。
根证书|当采用双向认证方式时，单击上传，上传网元提供的根证书文件（例如：ca.cert）。
客户端证书 / 客户端密钥|当采用双向认证方式时，单击上传，上传网元提供的客户端证书文件（例如：oam.srv.cli.crt）和客户端私钥文件（例如：oam.srv.cli.key）。
Token 用户名 / Token 密码|输入网元侧提供的用户名和密码信息。
支持集中安全|选择是否启用集中安全管理：是：启用集中安全。否：不启用集中安全。需要选是，启用集中安全。
 说明： 
网元接入时启用集中安全，需EM已开启集中安全管理功能。 
（可选）如果网元侧修改了告警SNMP上报时的默认参数，在网元告警参数区域，选择版本为v3，并设置相关的认证参数。
图5  网元告警参数

参数|说明
---|---
版本|选择下级网元告警上报时SNMP V3的参数。NA：表示EM采用默认SNMP参数与下级网元进行对接。v3：表示EM采用定制的SNMP参数与下级网元进行对接，需进一步输入相关的用户名及安全级别。
用户名|当网元采用自定义的SNMP参数时，输入网元侧设置的SNMP V3用户名。
安全级别|当网元采用自定义的SNMP参数时，选择与网元对应的安全级别及其相关参数。非鉴权，非私有：SNMP无需鉴权。鉴权，非私有：需进一步输入鉴权密码和鉴权协议。鉴权，私有：需进一步输入鉴权密码和鉴权协议，以及私有密码和私有协议。
输入相关参数后，单击新建按钮，完成OAM代理的创建。
（可选）对应多NF组网，重复步骤1~7，将其它NF局接入EM。 
##### 验证 
在EM客户端拓扑页面的左侧命令树中，单击分层接入节点，进入分层接入页面， 如[图1]所示。查看到新建代理的管理状态为已启动，连接状态为正常，表示该NF接入EM成功。
#### 配置模式说明 
维护人员在EM中进行数据配置之前，需要进入相应的配置页面。
初始数据配置中涉及到的命令分为两种，分别为Rosng命令和MML命令。
Rosng命令Rosng命令需要在命令处理页面的命令输入区中手动输入完整的命令及所要配置的数据（例如ip address 195.166.88.11 255.255.255.0），输入完成后按回车键运行命令，命令结果会出现在结果输出区。 
MML命令在EM客户端配置页面的左侧命令树中，单击命令处理节点，进入命令处理页面（如图1所示）。MML命令需要在命令处理页面中，通过GUI对命令参数进行选择和配置，输入完成后按回车键或单击执行按钮运行命令，命令结果会出现在文本结果区域。图1  命令处理页面 
#### License管理 
##### 申请License 
摘要 :业务License与实例化ZXUN RCP时生成的序列号一一对应，需要根据序列号申请License文件。
由于不同版本License的选项不一样，License申请模板必须和使用的软件版本配套。 
 说明： 
为了杜绝版本和模板错配问题，申请前要核实现网版本或者指定开局版本。 
相关信息 :由于制作License使用自动化审核和制作工具，因此License申请文件必须按照如下要求填写。 
每个License申请文件只能包含“填写说明”，“OAM-License模板”、“application-information”三个页签。 
禁止修改“填写说明”和“OAM-License模板”页签的内容和名称。 
实际申请的License信息请填写在页签“application-information”中。 
每个局点对应一个License 申请单，每个申请单只能有一个申请文件。文件名以网元的NF名称保存，必须保存为.xls的文件。 说明：文件名不能超过75字符，否则工具会读取失败。 
步骤 :填写License申请模板
从版本文件的license目录下获取license申请模板/versions/tools/license/License_application_template_5GC.xls
。
在application-information页签中按照实际情况填写网元信息和容量信息。
网元信息网元信息填写规范参见表1。表1  网元信息填写规范项目填写说明网元标识NF实例名称，例如：APP-HDBNJahAMF001BZX-03AZX011。设备序列号填写ZXUN RCP网元的序列号。注意：填写时前后不能有空格。获取序列号方法：使用admin用户登录EM客户端。在配置页面，展开PCF→PCF_x节点。在PCF_x下执行SHOW NFSN命令查询ZXUN RCP网元的序列号。网元产品名称NF名称，例如：APP-HDBNJahAMF001BZX-03AZX011。网元版本号网元版本号，例如：V7.20.21.B5。有效期填写格式必须为：yyyy/mm/dd。如果没有特殊要求，固定填写2099/12/31。网元位置填写实际的省份和城市。网元类型保持模板中的内容不变。 
容量信息License申请模板中网元的功能和容量必须按合同规定值填写。 说明：如果填写人员不清楚合同规定，需与售前技术人员确认或联系中兴通讯技术支持进行确认。容量填写规范如下：模板中容量控制项是纯数字格式，填写时必须是准确的数字，没有单位。容量值必须在模板注明的容量范围内，不允许超过容量值的最小和最大范围。 
填写完成后保存文件。 
申请License文件
登录CSC系统（[http://csc.zte.com.cn]）。
选择菜单软件许可证→流程处理→核心网license申请
，弹出新建申请单页面，如[图1]所示。
 说明： 
每个PCF网元都要填写一个申请单。一个申请单中不能包含多个网元。 
图1  新建申请单页面

填写申请信息，填写说明参见[表2]。
申请信息|填写说明
---|---
申请类型|根据实际选择。
合同号|填写实际的合同号。
产品线（PDM)|选择核心网（CN）
产品大类（PDM)|选择融合分组核心网/核心网（CN）
客户单位|选择实际的客户单位名称。
版本|选择实际的版本号。PCF网元的版本号可通过如下方法查询：登录EM客户端，在配置页面选择需要查询的PCF网元，执行SHOW VERSION DETAIL命令查询PCF运行实例对应的版本号。例如查询到Npcf_SMPolicyControl_0对应的版本号为V7.21.30.B2，则此处选择ZXUN-RCPV7.21.30.B2。
申请原因|根据实际填写。
单击附加说明栏的上传按钮，上传已填写完成的License申请模板License_application_template_5GC.xls
选择相关的审核和审批人员，单击提交。
审批通过后，CSC系统将在15分钟内自动制作License，并将License文件（命名为LCS单号_licensefile.zip）上传到CSC系统中。只有申请人才能查看和下载License文件。如果CSC系统制作License失败，则会显示失败信息。
##### 安装License 
摘要 :本节介绍License文件的安装过程，包括以下步骤： 
上传License：上传已申请到的License文件。 
发布License：生效License文件中的资源控制项和功能控制项。 
查询License：查询已加载的License文件的详细信息，确认其符合现场需求。 
前提 :已使用admin用户登录EM客户端。
相关信息 :ZXUN RCP的业务功能及业务资源受License控制，因此在以下场景中需要加载License。
新建局维护人员需要加载License，运营商才能使用ZXUN RCP的业务功能及业务资源。 
扩容或新增业务功能如果运营商申请了新的License，维护人员需要重新加载新的License。 
当前License过期运营商重新申请新的License后，维护人员需要重新加载新的License。 
License加载完成后，需要对现网业务进行测试。如果由于License加载影响到现网业务，需回滚到升级前的License。 
步骤 :将License文件保存在EM客户端所在的PC机上。
登录EM客户端，选择菜单维护→CN NF维护→网元许可证管理
，打开网元许可证管理窗口。选择需要发布License的网元，如[图1]所示。
图1  选择需要发布License的网元

单击操作列的发布按钮，进入许可证发布页面，如[图2]所示。
图2  许可证发布页面

单击操作列的上传按钮，在弹出的文件夹对话框中，选择需要上传的License文件。上传成功示例如[图3]所示。
图3  许可证上传成功示例

单击发布按钮。发布成功示例如[图4]所示。
图4  License发布成功示例

（可选）单击操作列的查看按钮，可以看到License的详细信息，检查页面信息与申请表格中的信息是否一致。
##### 备份License（可选） 
摘要 :通过导出License文件的方法，可以进行License文件的备份。 
前提 :已使用admin用户登录EM客户端。
步骤 :登录EM客户端，选择菜单维护→CN NF维护→网元许可证管理
，打开网元许可证管理窗口。选择需要备份License的网元，如[图1]所示。
图1  选择要导出License的网元

根据实际情况，选择执行如下操作。 
如果...|那么...
---|---
需要导出多个网元的License文件|选中需要导出的多个网元，单击页面上方的批量导出按钮。
需要导出一个网元的License文件|选中需要导出的单个网元，选择更多→导出按钮。
图2  导出选择

在弹出的对话框中单击确定按钮，将License文件导出到本地。
##### 回滚License（可选） 
摘要 :在进行License升级等操作时，如果加载的License影响到现网业务，则需执行回滚操作，将License回滚到升级前业务正常时使用的License。 
前提 :已使用admin用户登录EM客户端。 
已经准备了回滚License文件。 
步骤 :登录EM客户端，选择菜单维护→CN NF维护→网元许可证管理
，打开网元许可证管理窗口。选择需要回滚License的网元，如[图1]所示。
图1  选择需要回滚License的网元

根据实际情况，选择执行如下操作。 
如果...|那么...
---|---
需要回滚多个网元的License文件|单击页面上方的批量回滚按钮，进入许可证回滚页面，如图2所示。
需要回滚一个网元的License文件|单击回滚按钮，进入许可证回滚页面，如图2所示。
图2  许可证回滚

单击回滚按钮，在弹出的对话框单击确定按钮，完成回滚操作。
#### 同步全部表 
摘要 :在NF接入EM之后，需要执行同步全部表操作。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，单击其下的PCF局点，如PCF61
→PCF61
。
 说明： 
创建网元代理后，命令处理导航树中，才会出现对应的节点（如本例中的PCF61节点）。
执行如下命令传送全部表。 
[SYNA]:STYPE="ALL"
（可选）如果有多个NF，重复[步骤1]~[步骤2]，分别执行传送全表操作。
### Rosng配置 
#### 配置VRF 
摘要 :在ZXUN RCP上，可以创建多个VPN以对应和不同网元进行通信，每个VPN通过VRF进行标识。
将ZXUN RCP与各网元通信的接口地址、环回接口地址、路由分别与对应的VRF绑定，可以实现ZXUN RCP与各网元间信令面的流量隔离。
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip-address network-segment conflict-check] disable命令，关闭子接口冲突检查。
配置VRF信息。 
执行[ip vrf] <vrf-name> vpnid <vpnid-value>命令，创建VRF实例，执行成功后进入VRF模式。
执行[rd]命令，为VRF配置RD。
 说明： 
一个VRF下只能配置一个RD。 
执行[address-family ipv4]或[address-family ipv6]命令，激活VRF的IPv4/IPv6地址族能力。
 说明： 
VRF功能支持对两种地址族类型生效，包括IPv4和IPv6，必须使能至少一个地址族类型才能使VRF功能生效。 
执行[exit]命令，退出当前配置模式。
执行[exit]命令，退出全局配置模式
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见[表1]。
VRF名称|VPN ID|RD|IPv4地址|IPv6地址|用途
---|---|---|---|---|---
SBI|9|9:9|支持|支持|用于ZXUN RCP与5GC网络中其他NF的SBI接口通信。
SIG|11|11:11|支持|支持|用于ZXUN RCP与不同业务域网元间信令互通。
LOG|19|19:19|支持|支持|用于ZXUN RCP与策略日志服务器通信。
SMS|20|20:20|支持|支持|用于ZXUN RCP与短信中心通信。
EDGE|21|21:21|支持|支持|用于ZXUN RCP与物联网平面对接。
根据规划，进行如下配置。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
关闭子接口冲突检查。 
ZXROSNG(config)#[ip-address network-segment conflict-check] disable
配置相关的VRF。 
配置VRF SBI的相关信息。ZXROSNG(config)#ip vrf SBI vpnid 9ZXROSNG(config-vrf-SBI)#rd 9:9ZXROSNG(config-vrf-SBI)#address-family ipv4ZXROSNG(config-vrf-SBI-af-ipv4)#exitZXROSNG(config-vrf-SBI)#address-family ipv6ZXROSNG(config-vrf-SBI-af-ipv6)#exitZXROSNG(config-vrf-SBI)#exit 
配置VRF SIG的相关信息。ZXROSNG(config)#ip vrf SIG vpnid 11ZXROSNG(config-vrf-SIG)#rd 11:11ZXROSNG(config-vrf-SIG)#address-family ipv4ZXROSNG(config-vrf-SIG-af-ipv4)#exitZXROSNG(config-vrf-SIG)#address-family ipv6ZXROSNG(config-vrf-SIG-af-ipv6)#exitZXROSNG(config-vrf-SIG)#exit 
配置VRF LOG的相关信息。ZXROSNG(config)#ip vrf LOG vpnid 19ZXROSNG(config-vrf-LOG)#rd 19:19ZXROSNG(config-vrf-LOG)#address-family ipv4ZXROSNG(config-vrf-LOG-af-ipv4)#exitZXROSNG(config-vrf-LOG)#address-family ipv6ZXROSNG(config-vrf-LOG-af-ipv6)#exitZXROSNG(config-vrf-LOG)#exit 
配置VRF SMS的相关信息。ZXROSNG(config)#ip vrf SMS vpnid 20ZXROSNG(config-vrf-SMS)#rd 20:20ZXROSNG(config-vrf-SMS)#address-family ipv4ZXROSNG(config-vrf-SMS-af-ipv4)#exitZXROSNG(config-vrf-SMS)#address-family ipv6ZXROSNG(config-vrf-SMS-af-ipv6)#exitZXROSNG(config-vrf-SMS)#exit 
配置VRF EDGE的相关信息。ZXROSNG(config)#ip vrf EDGE vpnid 21ZXROSNG(config-vrf-EDGE)#rd 21:21ZXROSNG(config-vrf-EDGE)#address-family ipv4ZXROSNG(config-vrf-EDGE-af-ipv4)#exitZXROSNG(config-vrf-EDGE)#address-family ipv6ZXROSNG(config-vrf-EDGE-af-ipv6)#exitZXROSNG(config-vrf-EDGE)#exit 
退出全局配置模式 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行[show ip vrf brief]命令查看相关信息。
#### 配置接口地址 
摘要 :ZXUN RCP使用接口地址与其他NF通信，实现路由寻址。
接口规划要求： 
同一VRF的各个子接口必须配置相同网段的接口IP地址，必须配置相同的VLAN。 
各个接口的MTU、速率必须一致，一般保持默认值即可。 
每个子接口必须配置描述信息。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[interface] xgei-命令，进入接口配置模式，配置接口。
执行no [shutdown]命令，开启物理端口。
 说明： 
初始状态下，端口都处于关闭状态，必须开启后才能通信。 
执行[exit]命令，退出接口配置模式。
执行[interface] xgei-命令，进入子接口配置模式，配置子接口。
执行[description]命令，配置子接口的描述信息。
执行[ip vrf forwarding]命令，将子接口与对应的VRF绑定。
配置接口的地址。根据地址类型为IPv4或IPv6，执行不同的操作。
如果...|那么...
---|---
配置接口的IPv4地址|执行ip address命令。
配置接口的IPv6地址|执行ipv6 enable命令，使能接口IPv6协议功能。执行ipv6 address命令。
执行[exit]命令，退出子接口配置模式。
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见[表1]。
接口|子接口|VRF|IPv4地址|IPv6地址
---|---|---|---|---
xgei-1/0/1/1|xgei-1/0/1/1.1|SBI|192.168.18.1/28|2409:8086:8115:2b05::1/64
xgei-1/0/1/1.2|xgei-1/0/1/1|SIG|192.168.18.17/28|2409:8086:8115:2b06::1/64
xgei-1/0/1/1.3|xgei-1/0/1/1|LOG|192.168.18.33/28|2409:8086:8115:2b07::1/64
xgei-1/0/1/1.4|xgei-1/0/1/1|SMS|192.168.18.49/28|2409:8086:8115:2b08::1/64
xgei-1/0/1/1.5|xgei-1/0/1/1|EDGE|192.168.18.65/28|2409:8086:8715:2b27::1/64
xgei-1/0/2/1|xgei-1/0/2/1.1|SBI|192.168.18.2/28|2409:8086:8115:2b05::2/64
xgei-1/0/2/1.2|xgei-1/0/2/1|SIG|192.168.18.18/28|2409:8086:8115:2b06::2/64
xgei-1/0/2/1.3|xgei-1/0/2/1|LOG|192.168.18.34/28|2409:8086:8115:2b07::2/64
xgei-1/0/2/1.4|xgei-1/0/2/1|SMS|192.168.18.50/28|2409:8086:8115:2b08::2/64
xgei-1/0/2/1.5|xgei-1/0/2/1|EDGE|192.168.18.66/28|2409:8086:8715:2b27::2/64
根据规划，进行如下配置。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
配置xgei-1/0/1/1接口的相关信息。 
ZXROSNG(config)# [interface] xgei-1/0/1/1
ZXROSNG(config-if-xgei-1/0/1/1)#no [shutdown]
ZXROSNG(config-if-xgei-1/0/1/1)#[exit]
配置xgei-1/0/1/1接口的相关子接口，并绑定到VRF。 
配置xgei-1/0/1/1.1子接口，并将子接口绑定到SBI。ZXROSNG(config)#interface xgei-1/0/1/1.1ZXROSNG(config-if-xgei-1/0/1/1.1)#description SBI1ZXROSNG(config-if-xgei-1/0/1/1.1)#ip vrf forwarding SBIZXROSNG(config-if-xgei-1/0/1/1.1)#ip address 192.168.18.1 255.255.255.240ZXROSNG(config-if-xgei-1/0/1/1.1)#ipv6 enableZXROSNG(config-if-xgei-1/0/1/1.1)#ipv6 address 2409:8086:8115:2b05::1/64ZXROSNG(config-if-xgei-1/0/1/1.1)#exit 
配置xgei-1/0/1/1.2子接口，并将子接口绑定到SIG。ZXROSNG(config)#interface xgei-1/0/1/1.2ZXROSNG(config-if-xgei-1/0/1/1.2)#description SIG1ZXROSNG(config-if-xgei-1/0/1/1.2)#ip vrf forwarding SIGZXROSNG(config-if-xgei-1/0/1/1.2)#ip address 192.168.18.17 255.255.255.240ZXROSNG(config-if-xgei-1/0/1/1.2)#ipv6 enableZXROSNG(config-if-xgei-1/0/1/1.2)#ipv6 address 2409:8086:8115:2b06::1/64ZXROSNG(config-if-xgei-1/0/1/1.2)#exit 
配置xgei-1/0/1/1.3子接口，并将子接口绑定到LOG。ZXROSNG(config)#interface xgei-1/0/1/1.3ZXROSNG(config-if-xgei-1/0/1/1.3)#description LOG1ZXROSNG(config-if-xgei-1/0/1/1.3)#ip vrf forwarding LOGZXROSNG(config-if-xgei-1/0/1/1.3)#ip address 192.168.18.33 255.255.255.240ZXROSNG(config-if-xgei-1/0/1/1.3)#ipv6 enableZXROSNG(config-if-xgei-1/0/1/1.3)#ipv6 address 2409:8086:8115:2b07::1/64ZXROSNG(config-if-xgei-1/0/1/1.3)#exit 
配置xgei-1/0/1/1.4子接口，并将子接口绑定到SMS。ZXROSNG(config)#interface xgei-1/0/1/1.4ZXROSNG(config-if-xgei-1/0/1/1.4)#description SMS1ZXROSNG(config-if-xgei-1/0/1/1.4)#ip vrf forwarding SMSZXROSNG(config-if-xgei-1/0/1/1.4)#ip address 192.168.18.49 255.255.255.240ZXROSNG(config-if-xgei-1/0/1/1.4)#ipv6 enableZXROSNG(config-if-xgei-1/0/1/1.4)#ipv6 address 2409:8086:8115:2b08::1/64ZXROSNG(config-if-xgei-1/0/1/1.4)#exit 
配置xgei-1/0/1/1.5子接口，并将子接口绑定到EDGE。ZXROSNG(config)#interface xgei-1/0/1/1.5ZXROSNG(config-if-xgei-1/0/1/1.5)#description EDGE1ZXROSNG(config-if-xgei-1/0/1/1.5)#ip vrf forwarding EDGEZXROSNG(config-if-xgei-1/0/1/1.5)#ip address 192.168.18.65 255.255.255.240ZXROSNG(config-if-xgei-1/0/1/1.5)#ipv6 enableZXROSNG(config-if-xgei-1/0/1/1.5)#ipv6 address 2409:8086:8715:2b27::1/64ZXROSNG(config-if-xgei-1/0/1/1.5)#exit 
配置xgei-1/0/2/1接口的相关信息。 
ZXROSNG(config)#[interface] xgei-1/0/2/1
ZXROSNG(config-if-xgei-1/0/2/1)#no [shutdown]
ZXROSNG(config-if-xgei-1/0/2/1)#[exit]
配置xgei-1/0/2/1接口的相关子接口，并绑定到VRF。 
配置xgei-1/0/2/1.1子接口，并将子接口绑定到SBI。ZXROSNG(config)#interface xgei-1/0/2/1.1ZXROSNG(config-if-xgei-1/0/2/1.1)#description SBI2ZXROSNG(config-if-xgei-1/0/2/1.1)#ip vrf forwarding SBIZXROSNG(config-if-xgei-1/0/2/1.1)#ip address 192.168.18.2 255.255.255.240ZXROSNG(config-if-xgei-1/0/2/1.1)#ipv6 enableZXROSNG(config-if-xgei-1/0/2/1.1)#ipv6 address 2409:8086:8115:2b05::2/64ZXROSNG(config-if-xgei-1/0/2/1.1)#exit 
配置xgei-1/0/2/1.2子接口，并将子接口绑定到SIG。ZXROSNG(config)#interface xgei-1/0/2/1.2ZXROSNG(config-if-xgei-1/0/2/1.2)#description SIG2ZXROSNG(config-if-xgei-1/0/2/1.2)#ip vrf forwarding SIGZXROSNG(config-if-xgei-1/0/2/1.2)#ip address 192.168.18.18 255.255.255.240ZXROSNG(config-if-xgei-1/0/2/1.2)#ipv6 enableZXROSNG(config-if-xgei-1/0/2/1.2)#ipv6 address 2409:8086:8115:2b06::2/64ZXROSNG(config-if-xgei-1/0/2/1.2)#exit 
配置xgei-1/0/2/1.3子接口，并将子接口绑定到LOG。ZXROSNG(config)#interface xgei-1/0/2/1.3ZXROSNG(config-if-xgei-1/0/2/1.3)#description LOG2ZXROSNG(config-if-xgei-1/0/2/1.3)#ip vrf forwarding LOGZXROSNG(config-if-xgei-1/0/2/1.3)#ip address 192.168.18.34 255.255.255.240ZXROSNG(config-if-xgei-1/0/2/1.3)#ipv6 enableZXROSNG(config-if-xgei-1/0/2/1.3)#ipv6 address 2409:8086:8115:2b07::2/64ZXROSNG(config-if-xgei-1/0/2/1.3)#exit 
配置xgei-1/0/2/1.4子接口，并将子接口绑定到SMS。ZXROSNG(config)#interface xgei-1/0/2/1.4ZXROSNG(config-if-xgei-1/0/2/1.4)#description SMS2ZXROSNG(config-if-xgei-1/0/2/1.4)#ip vrf forwarding SMSZXROSNG(config-if-xgei-1/0/2/1.4)#ip address 192.168.18.50 255.255.255.240ZXROSNG(config-if-xgei-1/0/2/1.4)#ipv6 enableZXROSNG(config-if-xgei-1/0/2/1.4)#ipv6 address 2409:8086:8115:2b08::2/64ZXROSNG(config-if-xgei-1/0/2/1.4)#exit 
配置xgei-1/0/2/1.5子接口，并将子接口绑定到EDGE。ZXROSNG(config)#interface xgei-1/0/2/1.5ZXROSNG(config-if-xgei-1/0/2/1.5)#description EDGE2ZXROSNG(config-if-xgei-1/0/2/1.5)#ip vrf forwarding EDGEZXROSNG(config-if-xgei-1/0/2/1.5)#ip address 192.168.18.66 255.255.255.240ZXROSNG(config-if-xgei-1/0/2/1.5)#ipv6 enableZXROSNG(config-if-xgei-1/0/2/1.5)#ipv6 address 2409:8086:8715:2b27::2/64ZXROSNG(config-if-xgei-1/0/2/1.5)#exit 
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行[show ip interface
brief]命令或[show ipv6 interface brief]命令查看接口配置的相关信息。
#### 配置环回接口地址 
摘要 :环回接口地址作为业务地址，用于ZXUN RCP与其它NF进行业务对接。
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[interface] loopback 命令，进入环回接口配置模式。
执行[description]命令，设置环回接口描述信息。
执行[ip vrf forwarding]命令，将环回接口与对应的VRF绑定。
配置环回接口的地址。根据地址类型为IPv4或IPv6，执行不同的操作。
如果...|那么...
---|---
配置接口的IPv4地址|执行ip address命令。
配置接口的IPv6地址|执行ipv6 enable命令，使能环回接口IPv6协议功能。执行ipv6 address命令。
执行[exit]命令，退出接口配置模式。
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见[表1]。
环回接口|接口描述信息|VRF|IPv4地址|IPv6地址
---|---|---|---|---
loopback1|SBI|SBI|10.124.74.134/32|2409:8069:5003:1805::0128:1101/128
loopback2|to DRA|SIG|10.124.74.135/32|2409:8069:5003:1805::0128:1102/128
loopback3|to DRA|SIG|10.124.74.136/32|2409:8069:5003:1805::0128:1103/128
loopback4|to PUDR|SIG|10.124.74.137/32|2409:8069:5003:1805::0128:1104/128
loopback5|to PUDR|SIG|10.124.74.138/32|2409:8069:5003:1805::0128:1105/128
loopback6|to LOG|LOG|10.245.161.105/32|2409:8069:5A06:1805::0128:1100/128
loopback7|to SMS|SMS|10.124.135.193/32|2409:8069:500D:1805::0128:1002/128
loopback8|to EDGE|EDGE|10.124.136.196/32|2409:8069:500D:1805::0128:1102/128
根据规划，进行如下配置。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
配置环回接口1的相关信息。 
ZXROSNG(config)#[interface] loopback1
ZXROSNG(config-if-loopback1)#[description]  SBI
ZXROSNG(config-if-loopback1)#[ip vrf forwarding] SBI
ZXROSNG(config-if-loopback1)#[ip address] 10.124.74.134 255.255.255.255
ZXROSNG(config-if-loopback1)#[ipv6 enable]
ZXROSNG(config-if-loopback1)#[ipv6 address] 2409:8069:5003:1805::0128:1101/128
ZXROSNG(config-if-loopback1)#[exit]
配置环回接口2的相关信息。 
ZXROSNG(config)#[interface] loopback2
ZXROSNG(config-if-loopback2)#[description]  to DRA
ZXROSNG(config-if-loopback2)#[ip vrf forwarding] SIG
ZXROSNG(config-if-loopback2)#[ip address] 10.124.74.135 255.255.255.255
ZXROSNG(config-if-loopback2)#[ipv6 enable]
ZXROSNG(config-if-loopback2)#[ipv6 address] 2409:8069:5003:1805::0128:1102/128
ZXROSNG(config-if-loopback2)#[exit]
配置环回接口3的相关信息。 
ZXROSNG(config)#[interface] loopback3
ZXROSNG(config-if-loopback3)#[description] to DRA
ZXROSNG(config-if-loopback3)#[ip vrf forwarding]  SIG
ZXROSNG(config-if-loopback3)#[ip address] 10.124.74.136 255.255.255.255
ZXROSNG(config-if-loopback3)#[ipv6 enable]
ZXROSNG(config-if-loopback3)#[ipv6 address] 2409:8069:5003:1805::0128:1103/128
ZXROSNG(config-if-loopback3)#[exit]
配置环回接口4的相关信息。 
ZXROSNG(config)#[interface] loopback4
ZXROSNG(config-if-loopback4)#[description]  to PUDR
ZXROSNG(config-if-loopback4)#[ip vrf forwarding] SIG
ZXROSNG(config-if-loopback4)#[ip address] 10.124.74.137 255.255.255.255
ZXROSNG(config-if-loopback4)#[ipv6 enable]
ZXROSNG(config-if-loopback4)#[ipv6 address] 2409:8069:5003:1805::0128:1104/128
ZXROSNG(config-if-loopback4)#[exit]
配置环回接口5的相关信息。 
ZXROSNG(config)#[interface] loopback5
ZXROSNG(config-if-loopback5)#[description]  to PUDR
ZXROSNG(config-if-loopback5)#[ip vrf forwarding] SIG
ZXROSNG(config-if-loopback5)#[ip address] 10.124.74.138 255.255.255.255
ZXROSNG(config-if-loopback5)#[ipv6 enable]
ZXROSNG(config-if-loopback5)#[ipv6 address] 2409:8069:5003:1805::0128:1105/128
ZXROSNG(config-if-loopback5)#[exit]
配置环回接口6的相关信息。 
ZXROSNG(config)#[interface] loopback6
ZXROSNG(config-if-loopback6)#[description]  to LOG
ZXROSNG(config-if-loopback6)#[ip vrf forwarding]  LOG
ZXROSNG(config-if-loopback6)#[ip address] 10.245.161.105 255.255.255.255
ZXROSNG(config-if-loopback6)#[ipv6 enable]
ZXROSNG(config-if-loopback6)#[ipv6 address] 2409:8069:5A06:1805::0128:1100/128
ZXROSNG(config-if-loopback6)#[exit]
配置环回接口7的相关信息。 
ZXROSNG(config)#[interface] loopback7
ZXROSNG(config-if-loopback7)#[description] to SMS
ZXROSNG(config-if-loopback7)#[ip vrf forwarding] SMS
ZXROSNG(config-if-loopback7)#[ip address] 10.124.135.193 255.255.255.255
ZXROSNG(config-if-loopback7)#[ipv6 enable]
ZXROSNG(config-if-loopback7)#[ipv6 address] 2409:8069:500D:1805::0128:1002/128
ZXROSNG(config-if-loopback7)#[exit]
配置环回接口8的相关信息。 
ZXROSNG(config)#[interface] loopback8
ZXROSNG(config-if-loopback8)#[description] to EDGE
ZXROSNG(config-if-loopback8)#[ip vrf forwarding] EDGE
ZXROSNG(config-if-loopback8)#[ip address] 10.124.136.196 255.255.255.255
ZXROSNG(config-if-loopback8)#[ipv6 enable]
ZXROSNG(config-if-loopback8)#[ipv6 address] 2409:8069:500D:1805::0128:1102/128
ZXROSNG(config-if-loopback8)#[exit]
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行[show ip interface
brief]命令或[show ipv6 interface brief]命令查看接口配置的相关信息。
#### 配置VLAN 
摘要 :本节介绍为新创建的子接口封装VLAN-ID号和关闭接口的源地址过滤功能的配置过程。新创建的子接口必须封装VLAN-ID号，否则该子接口不能收发报文。同一VRF的各个子接口必须配置相同的VLAN。 
开启ARP源过滤的情况下，当系统收到ARP报文时，会先进行报文内容检测。如果查找不到报文中源地址的路由，则会丢弃报文。关闭ARP源过滤的情况下，不会进行该项报文内容检测，进行正常流程处理。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行configure terminal命令，进入全局配置模式。 
为子接口封装VLAN-ID号。 
执行[vlan-configuration]命令，进入VLAN配置模式。
执行[interface]命令，进入到VLAN子接口业务配置模式。可对多个VLAN子接口进行配置。
执行[encapsulation-dot1q]命令，新创建的子接口封装VLAN-ID号。
执行[exit]命令，退出VLAN子接口业务配置模式。
执行[exit]命令，退出VLAN配置模式。
关闭接口和子接口的源地址过滤功能。 
执行[arp]命令，进入ARP配置模式。
执行[interface]命令，进入ARP接口配置模式。可对多个ARP接口进行配置。
执行[source-filtered] disable命令，关闭接口和子接口的源地址过滤功能。所有的接口及其子接口都要执行。
执行[exit]命令，退出ARP接口配置模式。
执行[exit]命令，退出ARP配置模式。
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见[表1]。
VRF|接口|子接口|VLAN ID
---|---|---|---
SBI|1/0/1/11/0/2/1|1/0/1/1.11/0/2/1.1|2001
SIG|1/0/1/11/0/2/1|1/0/1/1.21/0/2/1.2|2002
LOG|1/0/1/11/0/2/1|1/0/1/1.31/0/2/1.3|2003
SMS|1/0/1/11/0/2/1|1/0/1/1.41/0/2/1.4|2004
EDGE|1/0/1/11/0/2/1|1/0/1/1.51/0/2/1.5|2005
根据规划，进行如下配置。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
为子接口封装VLAN-ID号。 
进入VLAN配置模式。
ZXROSNG(config)#[vlan-configuration]
为VRF SBI的子接口封装VLAN ID。 
ZXROSNG(config-vlan)#[interface]  xgei-1/0/1/1.1
ZXROSNG(config-vlan-if-xgei-1/0/1/1.1)#[encapsulation-dot1q] 2001
ZXROSNG(config-vlan-if-xgei-1/0/1/1.1)#[exit]
ZXROSNG(config-vlan)#[interface] xgei-1/0/2/1.1
ZXROSNG(config-vlan-if-xgei-1/0/2/1.1)#[encapsulation-dot1q] 2001
ZXROSNG(config-vlan-if-xgei-1/0/2/1.1)#[exit]
为VRF SIG的子接口封装VLAN ID。 
ZXROSNG(config-vlan)#[interface]  xgei-1/0/1/1.2
ZXROSNG(config-vlan-if-xgei-1/0/1/1.2)#[encapsulation-dot1q] 2002
ZXROSNG(config-vlan-if-xgei-1/0/1/1.2)#[exit]
ZXROSNG(config-vlan)#[interface] xgei-1/0/2/1.2
ZXROSNG(config-vlan-if-xgei-1/0/2/1.2)#[encapsulation-dot1q] 2002
ZXROSNG(config-vlan-if-xgei-1/0/2/1.2)#[exit]
为VRF LOG的子接口封装VLAN ID。 
ZXROSNG(config-vlan)#[interface]  xgei-1/0/1/1.3
ZXROSNG(config-vlan-if-xgei-1/0/1/1.3)#[encapsulation-dot1q] 2003
ZXROSNG(config-vlan-if-xgei-1/0/1/1.3)#[exit]
ZXROSNG(config-vlan)#[interface] xgei-1/0/2/1.3
ZXROSNG(config-vlan-if-xgei-1/0/2/1.3)#[encapsulation-dot1q] 2003
ZXROSNG(config-vlan-if-xgei-1/0/2/1.3)#[exit]
为VRF SMS的子接口封装VLAN ID。 
ZXROSNG(config-vlan)#[interface]  xgei-1/0/1/1.4
ZXROSNG(config-vlan-if-xgei-1/0/1/1.4)#[encapsulation-dot1q] 2004
ZXROSNG(config-vlan-if-xgei-1/0/1/1.4)#[exit]
ZXROSNG(config-vlan)#[interface] xgei-1/0/2/1.4
ZXROSNG(config-vlan-if-xgei-1/0/2/1.4)#[encapsulation-dot1q] 2004
ZXROSNG(config-vlan-if-xgei-1/0/2/1.4)#[exit]
为VRF EDGE的子接口封装VLAN ID。 
ZXROSNG(config-vlan)#[interface] xgei-1/0/1/1.5
ZXROSNG(config-vlan-if-xgei-1/0/1/1.5)#[encapsulation-dot1q] 2005
ZXROSNG(config-vlan-if-xgei-1/0/1/1.5)#[exit]
ZXROSNG(config-vlan)#[interface] xgei-1/0/2/1.5
ZXROSNG(config-vlan-if-xgei-1/0/2/1.5)#[encapsulation-dot1q] 2005
ZXROSNG(config-vlan-if-xgei-1/0/2/1.5)#[exit]
退出VLAN配置模式。 
ZXROSNG(config-vlan)#[exit]
关闭接口和子接口源地址过滤功能。 
进入ARP配置模式。 
ZXROSNG(config)#[arp]
关闭接口1/0/1/1以及相关子接口的源地址过滤功能。 
ZXROSNG(config-arp)#[interface]  xgei-1/0/1/1
ZXROSNG(config-arp-if-xgei-1/0/1/1)#[source-filtered]  disable
ZXROSNG(config-arp-if-xgei-1/0/1/1)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/1/1.1
ZXROSNG(config-arp-if-xgei-1/0/1/1.1)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/1/1.1)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/1/1.2
ZXROSNG(config-arp-if-xgei-1/0/1/1.2)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/1/1.2)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/1/1.3
ZXROSNG(config-arp-if-xgei-1/0/1/1.3)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/1/1.3)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/1/1.4
ZXROSNG(config-arp-if-xgei-1/0/1/1.4)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/1/1.4)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/1/1.5  
ZXROSNG(config-arp-if-xgei-1/0/1/1.5)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/1/1.5)#[exit]
关闭接口1/0/2/1以及相关子接口的源地址过滤功能。 
ZXROSNG(config-arp)#[interface]  xgei-1/0/2/1
ZXROSNG(config-arp-if-xgei-1/0/2/1)#[source-filtered]  disable
ZXROSNG(config-arp-if-xgei-1/0/2/1)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/2/1.1
ZXROSNG(config-arp-if-xgei-1/0/2/1.1)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/2/1.1)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/2/1.2
ZXROSNG(config-arp-if-xgei-1/0/2/1.2)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/2/1.2)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/2/1.3
ZXROSNG(config-arp-if-xgei-1/0/2/1.3)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/2/1.3)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/2/1.4
ZXROSNG(config-arp-if-xgei-1/0/2/1.4)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/2/1.4)#[exit]
ZXROSNG(config-arp)#[interface] xgei-1/0/2/1.5  
ZXROSNG(config-arp-if-xgei-1/0/2/1.5)#[source-filtered] disable
ZXROSNG(config-arp-if-xgei-1/0/2/1.5)#[exit]
退出ARP配置模式。 
ZXROSNG(config-arp)#[exit]
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行[show interface-vlan]命令查看VLAN配置的相关信息。
#### 静态路由和BFD配置 
网络侧的组网方式不同，ZXUN RCP的路由对接配置也相应不同。主要包括以下几种场景，参见[表1]。
资源池组网方式|PCF对接网关设备数量|静态路由BFD检测方式|场景说明
---|---|---|---
非SDN+DCGW MLAG|2|DCGW和PCF各自使用单臂BFD。|Spine/DCGW合一时采用该组网方式
非SDN+DCGW双活|2|双向直连BFD。|Spine/DCGW分离时采用该组网方式
SDN+DCGW双活|2|有如下两种方式：DCGW使用单臂BFD，PCF不使用BFD。DCGW和PCF各自使用单臂BFD。|SDN标准组网
##### 非SDN+DCGW MLAG场景下的配置 
摘要 :非SDN+DCGW MLAG场景下，DCGW和PCF都使用单臂BFD。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
为每个子接口配置BFD相关信息。 
执行[bfd]命令，进入BFD配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[time-negotiation]命令，配置BFD检测参数，包括BFD会话发送检测报文的时间间隔、接收检测报文的最小时间间隔和检测倍数。
执行[single-arm-echo] enable命令，开启单臂回声IPv4功能。
执行[single-arm-echo-ipv6] enable命令，开启单臂回声IPv6功能。
执行[min-echo-rx-interval]命令，配置单臂回声功能的BFD报文的最小接收间隔。
执行[exit]命令，退出子接口配置模式。
执行[gr] enable命令，开启BFD的GR功能。
执行[gr-time]命令，配置GR超时的时间。
执行[exit]命令，退出BFD配置模式。
执行[ip route]命令或[ipv6 route]命令，配置静态路由，必须指定出接口，且需要设置bfd enable。
ip route命令中，如果此条静态路由的prefix of destination IP address和network mask都为0.0.0.0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
ipv6 route命令中，如果此条静态路由的prefix of destination IPv6 address/<mask len>为::/0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
参数|取值
---|---
BFD会话发送检测报文的时间间隔|400毫秒
BFD接收检测报文的最小时间间隔|400毫秒
BFD检测倍数|5倍
单臂回声IPv4功能|开启
单臂回声IPv6功能|开启
单臂回声功能的BFD报文的最小接收间隔|400
GR超时的时间|360秒
VRF|Prefix of destination IPv4 address|Network mask|Interface|Next hop address|BFD
---|---|---|---|---|---
SBI|0.0.0.0|0.0.0.0|xgei-1/0/1/1.1xgei-1/0/2/1.1|192.168.13.78|enable
SIG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.2xgei-1/0/2/1.2|192.168.13.94|enable
LOG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.3xgei-1/0/2/1.3|192.168.13.110|enable
SMS|0.0.0.0|0.0.0.0|xgei-1/0/1/1.4xgei-1/0/2/1.4|192.168.13.126|enable
EDGE|0.0.0.0|0.0.0.0|xgei-1/0/1/1.5xgei-1/0/2/1.5|192.168.13.142|enable
VRF|Prefix/prefix-length of destination IPv6 address|Interface|Nexthop IPv6 address|BFD
---|---|---|---|---
SBI|::/0|xgei-1/0/1/1.1xgei-1/0/2/1.1|2409:8086:8715:2b23::ffff|enable
SIG|::/0|xgei-1/0/1/1.2xgei-1/0/2/1.2|2409:8086:8715:2b24::ffff|enable
LOG|::/0|xgei-1/0/1/1.3xgei-1/0/2/1.3|2409:8086:8715:2b25::ffff|enable
SMS|::/0|xgei-1/0/1/1.4xgei-1/0/2/1.4|2409:8086:8715:2b26::ffff|enable
EDGE|::/0|xgei-1/0/1/1.5xgei-1/0/2/1.5|2409:8086:8715:2b27::ffff|enable
根据规划进行如下配置： 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
配置子接口的BFD相关信息，命令如下： 
ZXROSNG(config)#[bfd]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.1
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.1
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.2
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.2
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.3
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.3
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.4
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.4
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.5 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[exit]
ZXROSNG(config-bfd)#[gr] enable
ZXROSNG(config-bfd)#[gr-time] 360
ZXROSNG(config-bfd)#[exit]
配置IPv4静态路由。 
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.13.78 bfd enable
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.13.78 bfd enable
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.13.94 bfd enable
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.13.94 bfd enable
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.13.110 bfd enable
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.13.110 bfd enable
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.13.126 bfd enable
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.13.126 bfd enable
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.13.142 bfd enable 
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.13.142 bfd enable
配置IPv6静态路由。 
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8715:2b23::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8715:2b23::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/1/1.2 2409:8086:8715:2b24::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/2/1.2 2409:8086:8715:2b24::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/1/1.3 2409:8086:8715:2b25::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/2/1.3 2409:8086:8715:2b25::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/1/1.4 2409:8086:8715:2b26::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/2/1.4 2409:8086:8715:2b26::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/1/1.5 2409:8086:8715:2b27::ffff bfd enable 
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/2/1.5 2409:8086:8715:2b27::ffff bfd enable
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行如下命令查看相关信息。 
show running-config static：查询已配置的IPv4静态路由。 
show running-config ipv6-static-route：查询已配置的IPv6静态路由。 
##### 非SDN+DCGW双活场景下的配置 
摘要 :非SDN+DCGW双活场景下，PCF使用双向直连BFD。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
为每个子接口配置BFD相关信息。 
执行[bfd]命令，进入BFD配置模式。
执行[interface]命令，进入子接口配置模式。
执行[time-negotiation]命令，配置BFD检测参数，包括BFD会话发送检测报文的时间间隔、接收检测报文的最小时间间隔和检测倍数。
执行[exit]命令，退出子接口配置模式。
执行[gr] enable命令，开启BFD的GR功能。
执行[gr-time]命令，配置GR超时的时间。
执行[exit]命令，退出BFD配置模式。
执行[ip route]命令或[ipv6 route]命令，配置静态路由，必须指定出接口，且需要设置bfd enable。
ip route命令中，如果此条静态路由的prefix of destination IP address和network mask都为0.0.0.0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
ipv6 route命令中，如果此条静态路由的prefix of destination IPv6 address/<mask len>为::/0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
举例 :在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
参数|取值
---|---
BFD会话发送检测报文的时间间隔|400毫秒
BFD接收检测报文的最小时间间隔|400毫秒
BFD检测倍数|5倍
GR超时的时间|360秒
VRF|Prefix of destination IPv4 address|Network mask|Interface|Next hop address|BFD
---|---|---|---|---|---
SBI|0.0.0.0|0.0.0.0|xgei-1/0/1/1.1xgei-1/0/2/1.1|192.168.13.78|enable
SIG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.2xgei-1/0/2/1.2|192.168.13.94|enable
LOG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.3xgei-1/0/2/1.3|192.168.13.110|enable
SMS|0.0.0.0|0.0.0.0|xgei-1/0/1/1.4xgei-1/0/2/1.4|192.168.13.126|enable
EDGE|0.0.0.0|0.0.0.0|xgei-1/0/1/1.5xgei-1/0/2/1.5|192.168.13.142|enable
VRF|Prefix/prefix-length of destination IPv6 address|Interface|Nexthop IPv6 address|BFD
---|---|---|---|---
SBI|::/0|xgei-1/0/1/1.1xgei-1/0/2/1.1|2409:8086:8715:2b23::ffff|enable
SIG|::/0|xgei-1/0/1/1.2xgei-1/0/2/1.2|2409:8086:8715:2b24::ffff|enable
LOG|::/0|xgei-1/0/1/1.3xgei-1/0/2/1.3|2409:8086:8715:2b25::ffff|enable
SMS|::/0|xgei-1/0/1/1.4xgei-1/0/2/1.4|2409:8086:8715:2b26::ffff|enable
EDGE|::/0|xgei-1/0/1/1.5xgei-1/0/2/1.5|2409:8086:8715:2b27::ffff|enable
根据规划，进行如下配置。 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
配置子接口的BFD相关信息。 
ZXROSNG(config)#[bfd]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.1
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.1
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.2
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.2
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.3
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.3
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.4
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.4
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.5 
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[exit]
ZXROSNG(config-bfd)#[gr] enable
ZXROSNG(config-bfd)#[gr-time] 360
ZXROSNG(config-bfd)#[exit]
配置IPv4静态路由。 
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.13.78 bfd enable
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.13.78 bfd enable
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.13.94 bfd enable
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.13.94 bfd enable
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.13.110 bfd enable
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.13.110 bfd enable
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.13.126 bfd enable
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.13.126 bfd enable
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.13.142 bfd enable   
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.13.142 bfd enable
配置IPv6静态路由。 
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8715:2b23::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8715:2b23::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/1/1.2 2409:8086:8715:2b24::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/2/1.2 2409:8086:8715:2b24::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/1/1.3 2409:8086:8715:2b25::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/2/1.3 2409:8086:8715:2b25::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/1/1.4 2409:8086:8715:2b26::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/2/1.4 2409:8086:8715:2b26::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/1/1.5 2409:8086:8715:2b27::ffff bfd enable  
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/2/1.5 2409:8086:8715:2b27::ffff bfd enable
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行如下命令查看相关信息。 
show running-config static：查询已配置的IPv4静态路由。 
show running-config ipv6-static-route：查询已配置的IPv6静态路由。 
##### SDN+DCGW双活场景下的配置 
摘要 :SDN+DCGW双活场景下，有如下两种配置方法。 
DCGW使用单臂BFD，PCF不使用BFD。 
DCGW和PCF各自使用单臂BFD。 
步骤 :配置方法一：DCGW使用单臂BFD，PCF不使用BFD。
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
执行[ip route]命令或[ipv6 route]命令，配置静态路由，必须指定出接口。
ip route命令中，如果此条静态路由的prefix of destination IP address和network mask都为0.0.0.0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
ipv6 route命令中，如果此条静态路由的prefix of destination IPv6 address/<mask len>为::/0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
配置方法二：DCGW和PCF各自使用单臂BFD。
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[configure terminal]命令，进入全局配置模式。
为每个子接口配置BFD相关信息。 
执行[bfd]命令，进入BFD配置模式。
执行[interface] xgei-命令，进入子接口配置模式。
执行[time-negotiation]命令，配置BFD检测参数，包括BFD会话发送检测报文的时间间隔、接收检测报文的最小时间间隔和检测倍数。
执行[single-arm-echo] enable命令，开启单臂回声IPv4功能。
执行[single-arm-echo-ipv6] enable命令，开启单臂回声IPv6功能。
执行[min-echo-rx-interval]命令，配置单臂回声功能的BFD报文的最小接收间隔。
执行[exit]命令，退出子接口配置模式。
执行[exit]命令，退出BFD配置模式。
执行[ip route]命令或[ipv6 route]命令，配置静态路由，必须指定出接口，且需要设置bfd enable。
ip route命令中，如果此条静态路由的prefix of destination IP address和network mask都为0.0.0.0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
ipv6 route命令中，如果此条静态路由的prefix of destination IPv6 address/<mask len>为::/0，则表示此条静态路由是缺省路由，否则就是非缺省路由。 
执行[exit]命令，退出全局配置模式。
执行[write]命令，保存配置数据。
举例 :举例一：DCGW使用单臂BFD，PCF不使用BFD。
在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
VRF|Prefix of destination IPv4 address|Network mask|Interface|Next hop address
---|---|---|---|---
SBI|0.0.0.0|0.0.0.0|xgei-1/0/1/1.1xgei-1/0/2/1.1|192.168.13.78
SIG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.2xgei-1/0/2/1.2|192.168.13.94
LOG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.3xgei-1/0/2/1.3|192.168.13.110
SMS|0.0.0.0|0.0.0.0|xgei-1/0/1/1.4xgei-1/0/2/1.4|192.168.13.126
EDGE|0.0.0.0|0.0.0.0|xgei-1/0/1/1.5xgei-1/0/2/1.5|192.168.13.142
VRF|Prefix/prefix-length of destination IPv6 address|Interface|Nexthop IPv6 address
---|---|---|---
SBI|::/0|xgei-1/0/1/1.1xgei-1/0/2/1.1|2409:8086:8715:2b23::ffff
SIG|::/0|xgei-1/0/1/1.2xgei-1/0/2/1.2|2409:8086:8715:2b24::ffff
LOG|::/0|xgei-1/0/1/1.3xgei-1/0/2/1.3|2409:8086:8715:2b25::ffff
SMS|::/0|xgei-1/0/1/1.4xgei-1/0/2/1.4|2409:8086:8715:2b26::ffff
EDGE|::/0|xgei-1/0/1/1.5xgei-1/0/2/1.5|2409:8086:8715:2b27::ffff
根据规划进行如下配置： 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
配置IPv4静态路由。 
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.13.78
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.13.78
ZXROSNG(config)#i[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.13.94
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.13.94
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.13.110
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.13.110
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.13.126
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.13.126
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.13.142  
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.13.142
配置IPv6静态路由。 
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8715:2b23::ffff
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8715:2b23::ffff
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/1/1.2 2409:8086:8715:2b24::ffff
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/2/1.2 2409:8086:8715:2b24::ffff
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/1/1.3 2409:8086:8715:2b25::ffff
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/2/1.3 2409:8086:8715:2b25::ffff
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/1/1.4 2409:8086:8715:2b26::ffff
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/2/1.4 2409:8086:8715:2b26::ffff
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/1/1.5 2409:8086:8715:2b27::ffff  
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/2/1.5 2409:8086:8715:2b27::ffff
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
举例二：DCGW和PCF各自使用单臂BFD。
在配置数据之前，应当完成相关数据规划，数据规划示例参见下表。 
参数|取值
---|---
BFD会话发送检测报文的时间间隔|400毫秒
BFD接收检测报文的最小时间间隔|400毫秒
BFD检测倍数|5倍
单臂回声IPv4功能|开启
单臂回声IPv6功能|开启
单臂回声功能的BFD报文的最小接收间隔|400
VRF|Prefix of destination IPv4 address|Network mask|Interface|Next hop address|BFD
---|---|---|---|---|---
SBI|0.0.0.0|0.0.0.0|xgei-1/0/1/1.1xgei-1/0/2/1.1|192.168.13.78|enable
SIG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.2xgei-1/0/2/1.2|192.168.13.94|enable
LOG|0.0.0.0|0.0.0.0|xgei-1/0/1/1.3xgei-1/0/2/1.3|192.168.13.110|enable
SMS|0.0.0.0|0.0.0.0|xgei-1/0/1/1.4xgei-1/0/2/1.4|192.168.13.126|enable
EDGE|0.0.0.0|0.0.0.0|xgei-1/0/1/1.5xgei-1/0/2/1.5|192.168.13.142|enable
VRF|Prefix/prefix-length of destination IPv6 address|Interface|Nexthop IPv6 address|BFD
---|---|---|---|---
SBI|::/0|xgei-1/0/1/1.1xgei-1/0/2/1.1|2409:8086:8715:2b23::ffff|enable
SIG|::/0|xgei-1/0/1/1.2xgei-1/0/2/1.2|2409:8086:8715:2b24::ffff|enable
LOG|::/0|xgei-1/0/1/1.3xgei-1/0/2/1.3|2409:8086:8715:2b25::ffff|enable
SMS|::/0|xgei-1/0/1/1.4xgei-1/0/2/1.4|2409:8086:8715:2b26::ffff|enable
EDGE|::/0|xgei-1/0/1/1.5xgei-1/0/2/1.5|2409:8086:8715:2b27::ffff|enable
根据规划进行如下配置： 
在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
进入全局配置模式。 
ZXROSNG#[configure terminal]
配置子接口的BFD相关信息。 
ZXROSNG(config)#[bfd]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.1
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.1)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.1
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.1)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.2
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.2)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.2
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.2)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.3
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.3)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.3
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.3)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.4
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.4)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.4
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.4)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/1/1.5   
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/1/1.5)#[exit]
ZXROSNG(config-bfd)#[interface] xgei-1/0/2/1.5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[time-negotiation] interval 400 min-rx 400 multiplier 5
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[single-arm-echo] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[single-arm-echo-ipv6] enable
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[min-echo-rx-interval] 400
ZXROSNG(config-bfd-if-xgei-1/0/2/1.5)#[exit]
ZXROSNG(config-bfd)#[exit]
配置IPv4静态路由。 
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/1/1.1 192.168.13.78 bfd enable
ZXROSNG(config)#[ip route] vrf SBI 0.0.0.0 0.0.0.0 xgei-1/0/2/1.1 192.168.13.78 bfd enable
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.2 192.168.13.94 bfd enable
ZXROSNG(config)#[ip route] vrf SIG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.2 192.168.13.94 bfd enable
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/1/1.3 192.168.13.110 bfd enable
ZXROSNG(config)#[ip route] vrf LOG 0.0.0.0 0.0.0.0 xgei-1/0/2/1.3 192.168.13.110 bfd enable
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/1/1.4 192.168.13.126 bfd enable
ZXROSNG(config)#[ip route] vrf SMS 0.0.0.0 0.0.0.0 xgei-1/0/2/1.4 192.168.13.126 bfd enable
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/1/1.5 192.168.13.142 bfd enable   
ZXROSNG(config)#[ip route] vrf EDGE 0.0.0.0 0.0.0.0 xgei-1/0/2/1.5 192.168.13.142 bfd enable
配置IPv6静态路由。 
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/1/1.1 2409:8086:8715:2b23::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SBI ::/0 xgei-1/0/2/1.1 2409:8086:8715:2b23::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/1/1.2 2409:8086:8715:2b24::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SIG ::/0 xgei-1/0/2/1.2 2409:8086:8715:2b24::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/1/1.3 2409:8086:8715:2b25::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf LOG ::/0 xgei-1/0/2/1.3 2409:8086:8715:2b25::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/1/1.4 2409:8086:8715:2b26::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf SMS ::/0 xgei-1/0/2/1.4 2409:8086:8715:2b26::ffff bfd enable
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/1/1.5 2409:8086:8715:2b27::ffff bfd enable  
ZXROSNG(config)#[ipv6 route] vrf EDGE ::/0 xgei-1/0/2/1.5 2409:8086:8715:2b27::ffff bfd enable
退出全局配置模式。 
ZXROSNG(config)#[exit]
保存配置数据。 
ZXROSNG#[write]
相关任务 :配置完成后，可以执行如下命令查看相关信息。 
show running-config static：查询已配置的IPv4静态路由。 
show running-config ipv6-static-route：查询已配置的IPv6静态路由。 
### 公共基础数据配置 
#### 配置时区 
摘要 :本节介绍如何配置设备所在的时区。时区是本地时间与GMT（Greenwich Mean Time，格林尼治标准时间）时间的偏移。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_CommonS_TMSP_0节点。
执行[SET TIMEZONE]命令，设置时区。
举例 :设置本地时区为GMT+08:00。 
[SET TIMEZONE]:TIMEZONE="GMTE0800"
#### 配置NTP服务器 
摘要 :本节介绍如何配置NTP服务器。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_CommonS_TMSP_0节点。
执行[SET NTP]命令，启动NTP及设置参数。
参数说明参见[表1]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ENABLE|是否启用|配置为是。
PRIMARYADD|主服务器IP|配置主用NTP服务器的IP地址，支持IPv4或IPv6地址。
SECADD|备服务器IP|配置备用NTP服务器的IP地址，支持IPv4或IPv6地址。
POLL|轮询间隔|配置为10，即间隔1024秒同步一次NTP服务器。
MAXCHANGE|最大误差阈值(毫秒)|阈值保护设置为3000 ms。
举例 :启动NTP并设置相关参数。 
[SET NTP]:ENABLE="YES",PRIMARYADD="180.3.6.5",SECADD="180.3.6.6",POLL=10,MAXCHANGE=3000
#### 配置NF信息 
摘要 :PCF向NRF注册时，会在Nnrf_NFManagement_NFRegister Request消息的pcfInfo中携带配置的服务信息，如rxDiamHost、rxDiamRealm信息等。 
NF信息必须配置，否则PCF不会向NRF注册。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD NFINFO]命令，新增本局配置。
新增本局配置参数说明参见[表1]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
NFID|PCF本局局向号|PCF本局局向号，注意请填写当前PCF局号。局号查询方法：[root@localhost admin]# docker exec -it vru-oam-main-0 env | grep bureau_idbureau_id=124     //局号所在行
HOSTNAME|Diameter主机名|本局的Diameter主机名，国内采用4G主机名格式。根据规划配置。
REALM|Diameter域名|本局的Diameter域名，国内采用4G主机名格式。根据规划配置。
TENANTNAME|租户名称|配置为tenant_1。
PUBTENANTNAME|公共租户名称|配置为tenant_1。
GROUPID|网元组编号|向NRF注册的groupId，根据规划配置。
LOCALITY|网元位置|向NRF注册的Locality，根据规划配置。
举例 :新增本局配置，数据规划示例参见[表2]。
项目|参数名称|取值举例
---|---|---
本局配置|本局局向号|74
Diameter主机名|本局配置|APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org
Diameter域名|本局配置|epc.mnc000.mcc460.3gppnetwork.org
租户名称|本局配置|tenant_1
公共租户名称|本局配置|tenant_1
网元组编号|本局配置|PCFHBsNRFhebad01
网元位置|本局配置|hb.bad01.01
配置命令： 
[ADD NFINFO]:NFID=74,HOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",TENANTNAME="tenant_1",PUBTENANTNAME="tenant_1",GROUPID="PCFHBsNRFhebad01",LOCALITY="hb.bad01.01"
#### 配置用户标识优先级（可选） 
摘要 :系统以用户标识作为关键字，将会话分发到不同的业务模块进行处理。设置用户标识类型的优先级， 可以让分发处理模块能按照一定的顺序规则解析用户标识，保证用户的所有会话都可以被正确处理。 
根据运营商要求设置IMSI或MSISDN优先，要和PUDR保持一致。一般是设置为MSISDN，默认为MSISDN优先。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[SET USERKEYPRI]命令，设置用户标识优先级。
[SET USERKEYPRI]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
USERKEYTYPE|首选用户标识类型|系统分发处理中首选使用的用户标识类型。
USERKEYTYPE1|次选用户标识类型|系统分发处理中次选使用的用户标识类型。
举例 :配置示例如下。 
[SET USERKEYPRI]:USERKEYTYPE="MSISDN",USERKEYTYPE1="IMSI"
#### 配置VM资产采集管理策略（可选） 
摘要 :VM资产采集功能是对网元内的各个虚机的资产信息进行采集，采集内容包括：IT资产、资产账号、资产运行状态、安全基线核查信息。设置系统资产信息采集功能策略，包括：定时采集开关、定时采集时间、每批采集虚机数。 
 说明： 
VM资产采集管理策略的定时采集开关默认关闭，仅在中国电信局点开启。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_TMSP_0。
执行[SET VMASSETMANPOLICY]命令，开启资产信息定时采集功能。
[SET VMASSETMANPOLICY]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
COLLECTIONSWITCH|定时采集开关|该参数用于设置当前系统是否开启资产信息定时采集功能。关闭：表示关闭资产信息定时采集。开启：表示开启资产信息定时采集。
COLLECTIONTIME|采集时间|该参数用于设置当前系统资产信息定时采集时间，当定时采集开关设置为开启时，到达该时间会自动采集各个虚机的资产信息。根据运营商规划填写。
COLLECTIONVMSBATCH|每批采集虚机数|资产采集为分批采集，该参数用于设置当前系统设置的资产信息采集时，每批采集的虚机数量。根据运营商规划填写。
举例 :配置示例如下。 
[SET VMASSETMANPOLICY]:COLLECTIONSWITCH="ENABLE"
#### 配置过负荷控制 
摘要 :过负荷控制配置用于修改系统过负荷类型（CPU、数据区、License容量、业务内存、事务数据区、License基础容量和配置表容量）的告警门限值。 
当某种系统资源占用率高于相应的告警门限时，会上报告警。当某种系统资源占用率低于相应的告警门限时，会恢复告警。 
其中当CPU、业务内存、事务数据区上报1级告警的时候，同时会拒绝其他网元发送的会话建立请求，对会话更新和会话释放请求无影响。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[SET LOADCFG]命令，修改不同过负荷控制类型相应的各级告警门限值。
配置参数说明参见[表1]。
参数|参数名称|参数配置
---|---|---
LOADTYPE|过负荷类型|本参数用于配置过负荷控制类型。License容量：过负荷控制类型为License容量，可以通过命令SHOW LICENSE查询。业务内存：过负荷控制类型为业务内存
UPTH1|1级告警门限（%）|本参数用于设置各种负荷控制类型对应的1级告警门限值。
UPTH2|2级告警门限（%）|本参数用于设置各种负荷控制类型对应的2级告警门限值。
UPTH3|3级告警门限（%）|本参数用于设置各种负荷控制类型对应的3级告警门限值。
UPTH4|4级告警门限（%）|本参数用于设置各种负荷控制类型对应的4级告警门限值。
DTH|告警恢复门限（%）|本参数用于设置各种负荷控制类型对应的恢复告警门限值。
举例 :配置示例如下。 
过负荷类型：license容量 说明：仅在中国移动局点配置。SET LOADCFG:LOADTYPE="LICENSE",UPTH1=100,UPTH2=85,UPTH3=40,UPTH4=35,DTH=30 
过负荷类型：事务数据区SET LOADCFG:LOADTYPE="TRANSDATA",UPTH1=90,UPTH2=85,UPTH3=55,UPTH4=50,DTH=45 
#### 设置系统全局变量 
摘要 :系统全局变量即提供了一系列的功能开关，来实现各种业务场景，满足各种业务需求。当需要对全局变量进行特定修改时，使用该配置根据具体需求对各个全局变量进行设置。如果不设置某个全局变量，则使用默认值。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[SET SYS GLOBPARA]命令，修改系统全局变量。
配置参数说明参见[表1]。
参数|参数名称|参数配置
---|---|---
IDX|参数编号|该参数用于表示待设置的某个全局变量编号。
CURVAL|参数值|该参数用于设置指定全局变量的参数值。
EXTFLAG|外部参数标识|外部开关标志。
举例 :配置示例如下。 
仅中国移动修改SET SYS GLOBPARA:IDX=1102,CURVAL="100",EXTFLAG="ADVANCED"SET SYS GLOBPARA:IDX=1351,CURVAL="0",EXTFLAG="ADVANCED"SET SYS GLOBPARA:IDX=1114,CURVAL="0",EXTFLAG="ADVANCED" 说明：全局变量1114只有中国移动的语音场景修改为0，数据场景不需要修改。 
所有运营商都修改SET SYS GLOBPARA:IDX=1052,CURVAL="20",EXTFLAG="BASIC"SET SYS GLOBPARA:IDX=308,CURVAL="1",EXTFLAG=ADVANCED 
### 通用对接数据配置 
#### 配置PUDR对接数据 
摘要 :Sp/Sp'接口是ZXUN RCP与PUDR之间的接口，用于PUDR和ZXUN RCP之间的消息交互。ZXUN RCP可以通过Sp/Sp'接口向PUDR请求策略签约信息或获取业务用量数据。
本节介绍ZXUN RCP和采用1+1主备的PUDR对接数据的配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD ADJHOST]命令，增加邻接主机。
[ADD ADJHOST]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|根据规划配置。
HOSTNAME|主机名|根据规划配置邻接主机的主机名。必须与实际的网元主机名保持一致。多个邻接局主机的主机名不能重复。
REALM|域名|根据规划配置邻接主机对应的域名，必须与实际的网元主机域名保持一致。
HOSTTYPE|邻接主机类型|选择SPR。
ADJHOSTGRPID|邻接主机组编号|取默认值0。
执行[ADD USERACC]命令，增加用户（组）资料接入局。
[ADD USERACC]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
ID|用户（组）资料接入局配置编号|本参数用于标识用户（组）资料接入局配置，全局唯一。
ADJHOSTID|邻接主机编号|引用ADD ADJHOST命令中已配置的主用PUDR的邻接主机编号。只需要增加主用局配置，不需要增加备用局。主用PUDR异常时，PCF根据路由切换至备用PUDR。
执行[ADD NUMANA]命令，增加号码段分析配置。
[ADD NUMANA]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
ID|号码段分析配置编号|用于标识一个号码段分析配置，全局唯一。
ANATYPE|号码段分析类型|根据实际情况选择用户资料接入局IMSI分析（USERACC_IMSI）或用户资料接入局MSISDN分析（USERACC_MSISDN）。
NUMBEGIN|起始号码|配置号码段分析的起始号码。
NUMEND|结束号码|配置号码段分析的结束号码。
RESULTID|号码段分析结果|引用ADD USERACC命令配置的用户（组）资料接入局编号。所有号段都指向主用PUDR局。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_SIG_0。
执行[ADD SCTP]命令，增加SCTP偶联。
[ADD SCTP]命令的参数填写说明参见[表4]。
参数|参数名称|填写说明
---|---|---
ID|SCTP标识|唯一标识一个SCTP。本参数全局唯一。
NAME|别名|偶联的别名。
LOCPORT|本端端口|偶联的本端端口号。根据规划配置。
REMPORT|对端端口|根据规划配置。必须与对端协商一致。
VPNID1|VPNID1|偶联第一对地址VPNID。
LOCADDR1|本端IP地址1|偶联第一对地址本端IP。根据规划配置。通常配置为环回接口地址。
REMADDR1|对端IP地址1|偶联第一对地址对端IP，动态偶联服务端不需要配置。根据规划配置。必须与对端协商一致。
VPNID2|VPNID2|偶联第二对地址VPNID。
LOCADDR2|本端IP地址2|偶联第二对地址本端IP。
REMADDR2|对端IP地址2|偶联第二对地址对端IP，动态偶联服务端不需要配置。
ROLE|应用属性|偶联应用属性。选择客户端。
PROTOCALTYPE|应用协议类型|偶联的归属上层协议类型，根据业务情况选择协议类型。选择DIAMETER。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD DIM RCPLINK]命令，增加Diameter链路。
[ADD DIM
RCPLINK]命令的参数填写说明参见[表5]。
参数|参数名称|填写说明
---|---|---
LINKNO|链路号|唯一标识一条Diameter链路。
LOCALHOSTNAME|本端主机名称|根据规划配置。
LOCALREALM|本端域名|根据规划配置本端主机所属的域名。
DSTHOSTNAME|对端主机名称|根据规划配置。本参数需要与对端协商一致。
DSTREALM|对端域名|根据规划配置对端主机所属的域名。本参数需要与对端协商一致。
ADJTYPE|邻接局类型|选择SPR。
CONNID|SCTP/TCP承载链路|Diameter链路使用的SCTP承载编号。该参数使用ADD SCTP命令配置的“SCTP标识”。
PROTOCOL|承载协议类型|选择SCTP。
NAME|链路名称|配置自定义的Diameter链路名称，便于识别。
执行[ADD DIM ROUTEGRPPTY]命令，增加Diameter路由组。
[ADD DIM ROUTEGRPPTY]命令的参数填写说明参见[表6]。
参数|参数名称|填写说明
---|---|---
GROUPNO|路由组编号|根据规划配置。本参数全局唯一。
GROUPNAME|路由组名称|配置自定义的Diameter路由组名称，便于识别。
执行[ADD DIM ROUTE]命令，增加Diameter路由。
[ADD DIM ROUTE]命令的参数填写说明参见[表7]。
参数|参数名称|填写说明
---|---|---
ROUTENO|路由编号|唯一标识一条Diameter路由。
LOCALPROCESSID|本地动作|用于标识Diameter消息处理类型。只能选择中继处理：表示消息发往下一跳路由器，无需修改消息中任何与路由无关的属性。
MASTERLINKNO|主用链路|用于指定本路由关联的信令链路的编号。该链路的“链路号”要求必须在ADD DIM RCPLINK中已配置。
ROUTEPRIORITY|路由优先级|主用链路的优先级为中，备用链路为优先级为低。
ROUTEAPPID|支持应用|配置两个应用，分别选择E4/Sp和Sp'。
DESTURI|目的URI|填写邻接主机的域名。使用命令SHOW ADJHOST查询邻接主机的域名。
ROUTEGROUPNO|路由组编号|标识该DIAMETER路由归属于哪个路由组。如果不归属于任何路由组，配置为0。或者直接使用默认配置。如果归属于某路由组，则“路由组编号”需要通过ADD DIM ROUTEGRPPTY在路由组属性配置中提前配置。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增PUDR主备邻接主机。 
[ADD ADJHOST]:ADJHOSTID=301,HOSTNAME="APP-HBBADhePCF001PUDR001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="SPR",CONNECTDRA="NO",REMARK="主用PUDR"
[ADD ADJHOST]:ADJHOSTID=302,HOSTNAME="APP-DBHBhePCF001PUDR002BZX-04AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="SPR",CONNECTDRA="NO",REMARK="备用PUDR"
增加主用局用户（组）资料接入局配置。 
[ADD USERACC]:ID=1,ADJHOSTID=301
增加号码段分析配置，将所有号段指向主用局。 
[ADD NUMANA]:ID=1,ANATYPE="USERACC_MSISDN",NUMBEGIN="0000000000000",NUMEND="9999999999999",RESULTID=1
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_SIG_0。
增加SCTP偶联配置。
 说明： 
PUDR采用主备方式组网，每套PUDR至少配置4条偶联。 
到主用PUDR001配置4条SCTP偶联ADD SCTP:ID=201,NAME="PUDR001-1",LOCPORT=4101,REMPORT=4101,VPNID1=11,LOCADDR1=10.119.173.145,REMADDR1=183.26.2.36,VPNID2=11,LOCADDR2=10.119.173.146,REMADDR2=183.26.2.37,PROTOCALTYPE="DIAMETER",ROLE="CLT"ADD SCTP:ID=202,NAME="PUDR001-2",LOCPORT=4102,REMPORT=4102,VPNID1=11,LOCADDR1=10.119.173.146,REMADDR1=183.26.2.37,VPNID2=11,LOCADDR2=10.119.173.145,REMADDR2=183.26.2.36,PROTOCALTYPE="DIAMETER",ROLE="CLT"ADD SCTP:ID=203,NAME="PUDR001-3",LOCPORT=4103,REMPORT=4103,VPNID1=11,LOCADDR1=10.119.173.145,REMADDR1=183.26.2.36,VPNID2=11,LOCADDR2=10.119.173.146,REMADDR2=183.26.2.37,PROTOCALTYPE="DIAMETER",ROLE="CLT"ADD SCTP:ID=204,NAME="PUDR001-4",LOCPORT=4104,REMPORT=4104,VPNID1=11,LOCADDR1=10.119.173.146,REMADDR1=183.26.2.37,VPNID2=11,LOCADDR2=10.119.173.145,REMADDR2=183.26.2.36,PROTOCALTYPE="DIAMETER",ROLE="CLT" 
到备用PUDR002配置4条SCTP偶联ADD SCTP:ID=251,NAME="PUDR002-1",LOCPORT=4105,REMPORT=4105,VPNID1=11,LOCADDR1=10.119.173.145,REMADDR1=183.26.2.38,VPNID2=11,LOCADDR2=10.119.173.146,REMADDR2=183.26.2.39,PROTOCALTYPE="DIAMETER",ROLE="CLT"ADD SCTP:ID=252,NAME="PUDR002-2",LOCPORT=4106,REMPORT=4106,VPNID1=11,LOCADDR1=10.119.173.146,REMADDR1=183.26.2.39,VPNID2=11,LOCADDR2=10.119.173.145,REMADDR2=183.26.2.38,PROTOCALTYPE="DIAMETER",ROLE="CLT"ADD SCTP:ID=253,NAME="PUDR002-3",LOCPORT=4107,REMPORT=4107,VPNID1=11,LOCADDR1=10.119.173.145,REMADDR1=183.26.2.38,VPNID2=11,LOCADDR2=10.119.173.146,REMADDR2=183.26.2.39,PROTOCALTYPE="DIAMETER",ROLE="CLT"ADD SCTP:ID=254,NAME="PUDR002-4",LOCPORT=4108,REMPORT=4108,VPNID1=11,LOCADDR1=10.119.173.146,REMADDR1=183.26.2.39,VPNID2=11,LOCADDR2=10.119.173.145,REMADDR2=183.26.2.38,PROTOCALTYPE="DIAMETER",ROLE="CLT" 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
增加Diameter链路。 
到主用PUDR001配置4条Diameter链路ADD DIM RCPLINK:LINKNO=201,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR001BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=201,PROTOCOL="SCTP",NAME="PUDR001-1"ADD DIM RCPLINK:LINKNO=202,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR001BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=202,PROTOCOL="SCTP",NAME="PUDR001-2"ADD DIM RCPLINK:LINKNO=203,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR001BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=203,PROTOCOL="SCTP",NAME="PUDR001-3"ADD DIM RCPLINK:LINKNO=204,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR001BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=204,PROTOCOL="SCTP",NAME="PUDR001-4" 
到备用PUDR002配置4条Diameter链路ADD DIM RCPLINK:LINKNO=251,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR002BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=251,PROTOCOL="SCTP",NAME="PUDR002-1"ADD DIM RCPLINK:LINKNO=252,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR002BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=252,PROTOCOL="SCTP",NAME="PUDR002-2"ADD DIM RCPLINK:LINKNO=253,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR002BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=253,PROTOCOL="SCTP",NAME="PUDR002-3"ADD DIM RCPLINK:LINKNO=254,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="APP-HBBADhePCF001PUDR002BZX-05AZX011.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="SPR",CONNID=254,PROTOCOL="SCTP",NAME="PUDR002-4" 
增加Diameter路由组。 
到主用PUDR001配置2个路由组，分别对应Sp和Sp’ADD DIM ROUTEGRPPTY:GROUPNO=21,GROUPNAME="PUDR1-Sp",GROUPPTY="LOADBALANCE"ADD DIM ROUTEGRPPTY:GROUPNO=31,GROUPNAME="PUDR1-Sp'",GROUPPTY="LOADBALANCE" 
到备用PUDR002配置2个路由组，分别对应Sp和Sp’ADD DIM ROUTEGRPPTY:GROUPNO=22,GROUPNAME="PUDR2-Sp",GROUPPTY="LOADBALANCE"ADD DIM ROUTEGRPPTY:GROUPNO=32,GROUPNAME="PUDR2-Sp'",GROUPPTY="LOADBALANCE" 
增加Diameter路由。 
到主用PUDR001，Sp接口，路由优先级设置为MIDDLE，归属路由组21，DESTURI为PUDR001的域名ADD DIM ROUTE:ROUTENO=201,MASTERLINKNO=201,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=21ADD DIM ROUTE:ROUTENO=202,MASTERLINKNO=202,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=21ADD DIM ROUTE:ROUTENO=203,MASTERLINKNO=203,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=21ADD DIM ROUTE:ROUTENO=204,MASTERLINKNO=204,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=21 
到主用PUDR001，Sp’接口，路由优先级设置为MIDDLE，归属路由组31，DESTURI为PUDR001域名ADD DIM ROUTE:ROUTENO=301,MASTERLINKNO=201,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=31ADD DIM ROUTE:ROUTENO=302,MASTERLINKNO=202,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=31ADD DIM ROUTE:ROUTENO=303,MASTERLINKNO=203,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=31ADD DIM ROUTE:ROUTENO=304,MASTERLINKNO=204,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=31 
到备用PUDR002，Sp接口，路由优先级设置为LOW，归属路由组22，DESTURI为PUDR002域名ADD DIM ROUTE:ROUTENO=251,MASTERLINKNO=251,ROUTEPRIORITY="LOW",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=22ADD DIM ROUTE:ROUTENO=252,MASTERLINKNO=252,ROUTEPRIORITY="LOW",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=22ADD DIM ROUTE:ROUTENO=253,MASTERLINKNO=253,ROUTEPRIORITY="LOW",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=22ADD DIM ROUTE:ROUTENO=254,MASTERLINKNO=254,ROUTEPRIORITY="LOW",ROUTEAPPID="E4/Sp",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=22 
到备用PUDR002，Sp’ 接口，路由优先级设置为LOW，归属路由组32，DESTURI为PUDR002域名ADD DIM ROUTE:ROUTENO=351,MASTERLINKNO=251,ROUTEPRIORITY="LOW",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=32ADD DIM ROUTE:ROUTENO=352,MASTERLINKNO=252,ROUTEPRIORITY="LOW",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=32ADD DIM ROUTE:ROUTENO=353,MASTERLINKNO=253,ROUTEPRIORITY="LOW",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=32ADD DIM ROUTE:ROUTENO=354,MASTERLINKNO=254,ROUTEPRIORITY="LOW",ROUTEAPPID="Sp'",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=32 
#### 配置SMSC对接数据（可选） 
摘要 :ZXUN RCP作为PCRF/PCF时，可以作为短消息组网中的SP，与短信中心进行交互。当用户使用量接近或超出额定使用量时，ZXUN RCP检测到符合预置的发送短信条件时，构造出相应的短消息发送给短信中心，再由短信中心将短信内容发送给用户，从而完成短信通知用户的流程。
本节介绍ZXUN RCP与SMSC对接数据的配置。通常ZXUN RCP到短信中心配置两个链路组，两个链路组间采用负荷分担。每个链路组配置主备两条链路。
前提 :已加载支持短信通知功能的License。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD SMCSNODE]命令增加短信中心。
[ADD SMCSNODE]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
SMCSID|短信中心标识|配置短信中心的编号，该编号全局唯一。
NAME|短信中心名称|配置自定义的短信中心的名称，便于识别。
PROTOCOLTYPE|协议类型|配置短信中心的使用的协议类型。本参数需要与短信中心之间协商一致。
CLIENTID|用户账号|配置用于验证的用户账号。本参数需要与短信中心之间协商一致。
PWD|用户密码|配置用于验证的用户密码，为PASSWORD型字符（密文输入）。本参数需要与短信中心之间协商一致。
SRCADDR|短信发送方地址|配置用户端所显示的发送方地址。编码时该地址按照配置短信发送方地址编码类型和方案进行编码。
SMSCTYPE|短信中心类型|配置短信中心类型。短信网关POP-D平台
SVCID|短信业务标识|用来表明短信应用服务的一个字符串。本参数需要与短信中心之间协商一致。
SPID|企业代码|用来表明服务提供商身份的一个字符串。本参数需要与短信中心之间协商一致。
执行[ADD TCPCONN]命令增加TCP承载。
[ADD TCPCONN]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
ID|TCP承载编号|唯一标识一个TCP承载。本参数全局唯一。
NAME|TCP承载名称|配置TCP承载的名称，便于识别。本参数全局唯一。
LOCIP|本端IP地址|根据规划配置。通常配置为环回接口地址。必须与对端协商一致。
LOCPORT|本端端口|根据规划配置。必须与对端协商一致。
RMTIP|对端IP地址|根据规划配置。必须与对端协商一致。
RMTPORT|对端端口|根据规划配置。必须与对端协商一致。
ROLE|本端角色|选择CLIENT（客户端）。
VPN|VPN号|通常填写为Rosng中配置的短信的VPN ID。
执行[ADD SMLINK]命令增加短信链路。
[ADD SMLINK]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
SMLINKID|短信链路标识|配置短信链路的编号，该编号全局唯一。
NAME|短信链路名称|配置自定义的短信链路的名称，便于识别。
TCPCONID|TCP承载编号|引用ADD TCPCONN已配置的TCP承载编号，且必须是客户端角色类型。
CONNECTMODE|连接方式|配置该短信链路的连接方式。本参数需要与短信中心之间协商一致。如果短信中心为SMPP协议类型，则只能使用长连接方式。如果短信中心为SGIP协议类型，则只能使用短连接方式。如果短信中心为其他协议类型时，可以采用两种连接方式中的任意一种。
SMCSID|连接的短信中心标识|引用ADD SMCSNODE命令中已配置的短信中心标识。
CHKTIME|链路检测时长(秒)|发送链路检测请求的时间间隔。链路检测时长应该大于链路检测等待响应的时长。仅在长连接方式时生效。
CHKACKTIME|链路检测等待响应的时长(秒)|等待链路检测响应的最大时长。链路检测等待响应的时长应该小于链路检测时长。仅在长连接方式时生效。
CHKRETRANSMIT|链路检测超时重发次数|如果本次链路检测超时，后续发送链路检测请求的最大次数。仅在长连接方式时生效。
SM_ACK_TIME|短信等待响应时长(秒)|发送短信内容之后，等待响应消息的最大时长。
SM_FAIL_TIMEOUT|短信发送失败重发间隔(秒)|如果本次发送短信内容失败，后续发送相同短信内容的时间间隔。
SM_FAIL_ATTEMPT|短信发送失败重发次数|如果本次发送短信内容失败，后续发送相同短信内容的最大次数。
SLIDEWINSIZE|滑动窗口大小|已发送成功，正在等待响应消息的短消息的最大条数。
执行[ADD SMLINKGRP]命令增加短信链路组。
[ADD SMLINKGRP]命令的参数填写说明参见[表4]。
参数|参数名称|填写说明
---|---|---
SMLINKGRPID|短信链路组标识|配置短信链路组的编号，该标识全局唯一。
MSTLINKID|主用链路标识|引用ADD SMLINK中已配置的的短信链路标识。
SLVLINKID1|备用链路标识1|引用ADD SMLINK中已配置的的短信链路标识。
举例 :在配置数据之前，应当完成采集和协商短信中心对接相关数据，数据采集参见[表5]。其中参数值为举例值，在实际数据制作过程中根据实际情况填写。
配置项|配置参数|参数举例
---|---|---
短信中心|短信中心标识|1
短信中心名称|短信中心|SMC
协议类型|短信中心|SMPP协议V3.3版本
用户账号|短信中心|rcp
用户密码|短信中心|rcp
短信发送方地址|短信中心|123456
短信中心类型|短信中心|短信网关
短信业务标识|短信中心|PCF
企业代码|短信中心|999999
TCP承载1|TCP承载编号|1
TCP承载名称|TCP承载1|toSMS_1
本端IP地址|TCP承载1|10.119.28.128
本端端口|TCP承载1|7890
对端IP地址|TCP承载1|10.120.213.9
对端端口|TCP承载1|7890
本端角色|TCP承载1|客户端
VPN号|TCP承载1|20
TCP承载2|TCP承载编号|2
TCP承载名称|TCP承载2|toSMS_2
本端IP地址|TCP承载2|10.119.28.128
本端端口|TCP承载2|7891
对端IP地址|TCP承载2|10.120.213.9
对端端口|TCP承载2|7890
本端角色|TCP承载2|客户端
VPN号|TCP承载2|20
TCP承载3|TCP承载编号|3
TCP承载名称|TCP承载3|toSMS_3
本端IP地址|TCP承载3|10.119.28.128
本端端口|TCP承载3|7892
对端IP地址|TCP承载3|10.120.213.9
对端端口|TCP承载3|7890
本端角色|TCP承载3|客户端
VPN号|TCP承载3|20
TCP承载4|TCP承载编号|4
TCP承载名称|TCP承载4|toSMS_4
本端IP地址|TCP承载4|10.119.28.128
本端端口|TCP承载4|7893
对端IP地址|TCP承载4|10.120.213.9
对端端口|TCP承载4|7890
本端角色|TCP承载4|客户端
VPN号|TCP承载4|20
短信链路1|短信链路标识|1
短信链路名称|短信链路1|toSMS_1
TCP承载编号|短信链路1|1
连接方式|短信链路1|长连接
连接的短信中心标识|短信链路1|1
短信链路2|短信链路标识|2
短信链路名称|短信链路2|toSMS_2
TCP承载编号|短信链路2|2
连接方式|短信链路2|长连接
连接的短信中心标识|短信链路2|1
短信链路3|短信链路标识|3
短信链路名称|短信链路3|toSMS_3
TCP承载编号|短信链路3|3
连接方式|短信链路3|长连接
连接的短信中心标识|短信链路3|1
短信链路4|短信链路标识|4
短信链路名称|短信链路4|toSMS_4
TCP承载编号|短信链路4|4
连接方式|短信链路4|长连接
连接的短信中心标识|短信链路4|1
短信链路组1|短信链路组标识|1
主用链路标识|短信链路组1|1
备用链路标识1|短信链路组1|2
短信链路组2|短信链路组标识|2
主用链路标识|短信链路组2|3
备用链路标识1|短信链路组2|4
增加短信中心。 
[ADD SMCSNODE]:SMCSID=1,NAME="SMC",PROTOCOLTYPE="SMPP_V3.3",CLIENTID="rcp",PWD="***********",SRCADDR="123456",SMSCTYPE="SMS",SVCID="PCF",SPID="999999"
增加TCP承载。 
[ADD TCPCONN]:ID=1,NAME="toSMS_1",LOCIP="10.119.28.128",LOCPORT=7890,RMTIP="10.120.213.9",RMTPORT=7890,ROLE="CLIENT",VPN=20
[ADD TCPCONN]:ID=2,NAME="toSMS_2",LOCIP="10.119.28.128",LOCPORT=7891,RMTIP="10.120.213.9",RMTPORT=7890,ROLE="CLIENT",VPN=20
[ADD TCPCONN]:ID=3,NAME="toSMS_3",LOCIP="10.119.28.128",LOCPORT=7892,RMTIP="10.120.213.9",RMTPORT=7890,ROLE="CLIENT",VPN=20
[ADD TCPCONN]:ID=4,NAME="toSMS_4",LOCIP="10.119.28.128",LOCPORT=7893,RMTIP="10.120.213.9",RMTPORT=7890,ROLE="CLIENT",VPN=20
增加短信链路。 
[ADD SMLINK]:SMLINKID=1,NAME="toSMS_1",TCPCONID=1,CONNECTMODE="LONGLIVED",SMCSID=1,CHKTIME=180,CHKACKTIME=60,CHKRETRANSMIT=2,SM_ACK_TIME=60,SM_FAIL_TIMEOUT=60,SM_FAIL_ATTEMPT=2,SLIDEWINSIZE=32
[ADD SMLINK]:SMLINKID=2,NAME="toSMS_2",TCPCONID=2,CONNECTMODE="LONGLIVED",SMCSID=1,CHKTIME=180,CHKACKTIME=60,CHKRETRANSMIT=2,SM_ACK_TIME=60,SM_FAIL_TIMEOUT=60,SM_FAIL_ATTEMPT=2,SLIDEWINSIZE=32
[ADD SMLINK]:SMLINKID=3,NAME="toSMS_3",TCPCONID=3,CONNECTMODE="LONGLIVED",SMCSID=1,CHKTIME=180,CHKACKTIME=60,CHKRETRANSMIT=2,SM_ACK_TIME=60,SM_FAIL_TIMEOUT=60,SM_FAIL_ATTEMPT=2,SLIDEWINSIZE=32
[ADD SMLINK]:SMLINKID=4,NAME="toSMS_4",TCPCONID=4,CONNECTMODE="LONGLIVED",SMCSID=1,CHKTIME=180,CHKACKTIME=60,CHKRETRANSMIT=2,SM_ACK_TIME=60,SM_FAIL_TIMEOUT=60,SM_FAIL_ATTEMPT=2,SLIDEWINSIZE=32
增加短信链路组。 
[ADD SMLINKGRP]:SMLINKGRPID=1,MSTLINKID=1,SLVLINKID1=2
[ADD SMLINKGRP]:SMLINKGRPID=2,MSTLINKID=3,SLVLINKID1=4
### PCRF对接数据配置 
#### 配置DRA对接数据 
##### 配置PCEF对接数据 
摘要 :Gx接口是ZXUN RCP与PCEF之间的接口。ZXUN RCP可以通过DRA转接与PCEF对接。
本节介绍ZXUN RCP和PCEF对接数据的配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD ADJHOSTGRP]命令，增加邻接主机组。
[ADD ADJHOSTGRP]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
ADJHOSTGRPID|邻接主机组编号|根据规划配置。
HOSTTYPE|邻接主机组类型|选择PCEF。
执行[ADD ADJHOST]命令，增加邻接主机配置。
[ADD ADJHOST]命令参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|根据规划配置。
HOSTNAME|主机名|根据规划配置邻接主机的主机名。必须与实际的网元主机名保持一致。多个邻接局主机的主机名不能重复。
REALM|域名|根据规划配置邻接主机对应的域名，必须与实际的网元主机域名保持一致。
HOSTTYPE|邻接主机类型|选择PCEF。
ADJHOSTGRPID|邻接主机组编号|引用ADD ADJHOSTGRP命令中配置的“邻接主机组编号”。
CONNECTDRA|连接DRA设备|该参数表示邻接主机是否连接DRA设备。是：RCP与邻接主机会通过DRA设备进行连接，消息交互需要通过DRA进行中转。否：RCP与邻接主机直接连接，消息直接进行交互。
执行[ADD ADJHOSTWD]命令，增加邻接主机通配。
 说明： 
PCEF邻接主机通配，如有需要，分别增加PGW省内、省外主机通配。 
[ADD ADJHOSTWD]命令的参数填写说明参见[表3]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|标识一个邻接主机，全局唯一。
HOSTNAME|主机名|邻接主机在网络中的唯一主机名称标识，必须与实际的网元主机名保持一致。
HOSTTYPE|邻接主机类型|选择PCEF。
ADJHOSTGRPID|邻接主机组编号|标识一个邻接主机组，全局唯一。引用ADD ADJHOSTGRP命令中配置的“邻接主机组编号”。
PRIOR|优先级|数字越大优先级越高。
执行[ADD BEARABILITY]命令，增加承载能力。
[ADD BEARABILITY]命令的参数填写说明参见[表4]。
参数|参数名称|参数说明
---|---|---
ADJHOSTGRPID|邻接主机组编号|引用ADD ADJHOSTGRP命令中已配置的邻接主机组编号。
INTERFACE|接口能力|选择PGW。
SERVMODE|业务标识方式|选择应用标识（APPID），使用应用标识来标识业务。
EXTENDBW|支持扩展带宽AVP|该参数用于配置RCP是否支持向承载网元下发扩展带宽参数。在Gx会话中，为了支持5G应用下的高带宽，标准协议扩展了新的带宽属性，其单位为kbps。NO（否）：当RCP对接的承载网元不支持5G应用的高带宽参数处理时，配置为该值。此时RCP不会向承载网元下发扩展带宽参数。YES（是）：当RCP对接的承载网元支持5G应用的高带宽参数处理时，配置为该值。此时RCP会根据和PGW进行能力协商的结果，来决定在策略QoS里是否向承载网元下发扩展带宽参数。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
增加PGW邻接主机组。 
省内PGW邻接主机组配置为21，省外PGW邻接主机组配置为22。 
[ADD ADJHOSTGRP]:ADJHOSTGRPID=21,HOSTTYPE="PCEF"
[ADD ADJHOSTGRP]:ADJHOSTGRPID=22,HOSTTYPE="PCEF"
增加PGW邻接主机。 
[ADD ADJHOST]:ADJHOSTID=101,HOSTNAME="APP-HBBADheSAEGWC1BZX-01AZX011.laf.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="PCEF",ADJHOSTGRPID=21,CONNECTDRA="YES",REMARK="vGW1"
[ADD ADJHOST]:ADJHOSTID=102,HOSTNAME="APP-DBHBheSAEGWC2BZX-02AZX011.laf.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="PCEF",ADJHOSTGRPID=21,CONNECTDRA="YES",REMARK="vGW2"
增加PGW邻接主机通配。 
省内PGW主机名长于省外PGW主机名，例如广东的省内为*.gd.node.epc.xxx，省外为*.node.epc.xxx，各省的标识需要根据规范进行修改。 
[ADD ADJHOSTWD]:ADJHOSTID=191,HOSTNAME="*.he.node.epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="PCEF",ADJHOSTGRPID=21,PRIOR=10,REMARK="省内PGW通配"
[ADD ADJHOSTWD]:ADJHOSTID=192,HOSTNAME="*.node.epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="PCEF",ADJHOSTGRPID=22,PRIOR=1,REMARK="省外PGW通配"
配置PGW承载能力。 
[ADD BEARABILITY]:ADJHOSTGRPID=21,INTERFACE="PGW",SERVMODE="APPID",EXTENDBW="YES"
[ADD BEARABILITY]:ADJHOSTGRPID=22,INTERFACE="PGW",SERVMODE="APPID",EXTENDBW="YES"
##### 配置AF对接数据 
摘要 :Rx接口是ZXUN RCP与AF之间的接口。ZXUN RCP可以通过DRA转接与AF对接。
本节介绍ZXUN RCP和AF对接数据的配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD ADJHOST]命令，增加邻接主机配置。
[ADD ADJHOST]命令参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|根据规划配置。
HOSTNAME|主机名|根据规划配置邻接主机的主机名。必须与实际的网元主机名保持一致。多个邻接局主机的主机名不能重复。
REALM|域名|根据规划配置邻接主机对应的域名，必须与实际的网元主机域名保持一致。
HOSTTYPE|邻接主机类型|选择AF。
ADJHOSTGRPID|邻接主机组编号|取默认值0。
CONNECTDRA|连接DRA设备|该参数表示邻接主机是否连接DRA设备。是：RCP与邻接主机会通过DRA设备进行连接，消息交互需要通过DRA进行中转。否：RCP与邻接主机直接连接，消息直接进行交互。
执行[ADD ADJHOSTWD]命令，增加邻接主机通配。
[ADD ADJHOSTWD]命令的参数填写说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|标识一个邻接主机，全局唯一。
HOSTNAME|主机名|邻接主机在网络中的唯一主机名称标识，必须与AF侧主机名保持一致，与AF侧确认后配置。
HOSTTYPE|邻接主机类型|选择AF。
ADJHOSTGRPID|邻接主机组编号|取默认值0。
PRIOR|优先级|数字越大优先级越高。
执行[ADD AFABILITY]命令，增加AF能力。
[ADD AFABILITY]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|引用ADD ADJHOST命令中配置的AF的“邻接主机编号”。
AAAMODE|授权响应方式|选择仅IMS AF会话建立请求等承载确认后响应。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
增加精确SBC邻接主机名。 
[ADD ADJHOST]:ADJHOSTID=201,HOSTNAME="APP-HBBADhepsbcc1BZX-01AZX012.laf.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="AF",CONNECTDRA="YES",REMARK="vSBC1"
[ADD ADJHOST]:ADJHOSTID=202,HOSTNAME="APP-DBHBhepsbcc2BZX-02AZX012.laf.he.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="AF",CONNECTDRA="YES",REMARK="vSBC2"
增加精确AAC邻接主机名。 
[ADD ADJHOST]:ADJHOSTID=251,HOSTNAME="APP-HDNJIHqgAACEF1AZX-03AHW011.jih.zj.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="AF",CONNECTDRA="YES",REMARK="JIH AAC"
[ADD ADJHOST]:ADJHOSTID=252,HOSTNAME="APP-HNGZqgAACEF1AZX-02AHW011.gz.gd.node.epc.mnc000.mcc460.3gppnetwork.org",REALM="epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="AF",CONNECTDRA="YES",REMARK="GZ AAC"
增加AF邻接主机通配。 
 说明： 
配置示例中ims和epc仅供参考，实际以AF侧提供为准。 
[ADD ADJHOSTWD]:ADJHOSTID=291,HOSTNAME="*.ims.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="AF",PRIOR=1,REMARK="ims AF通配"
[ADD ADJHOSTWD]:ADJHOSTID=292,HOSTNAME="*.epc.mnc000.mcc460.3gppnetwork.org",HOSTTYPE="AF",PRIOR=1,REMARK="epc AF通配"
增加AF承载能力 
[ADD AFABILITY]:ADJHOSTID=201,AAAMODE="WAITBEARACK4CALLAF"
[ADD AFABILITY]:ADJHOSTID=202,AAAMODE="WAITBEARACK4CALLAF" 
[ADD AFABILITY]:ADJHOSTID=251,AAAMODE="WAITBEARACK4CALLAF"
[ADD AFABILITY]:ADJHOSTID=252,AAAMODE="WAITBEARACK4CALLAF" 
[ADD AFABILITY]:ADJHOSTID=291,AAAMODE="WAITBEARACK4CALLAF"
[ADD AFABILITY]:ADJHOSTID=292,AAAMODE="WAITBEARACK4CALLAF"
##### 配置DRA对接（GX和Rx接口使用） 
摘要 :本节介绍DRA的对接配置。Gx接口和Rx接口，都通过DRA和ZXUN RCP对接。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD DIM RCPLINK]命令，增加Diameter链路。
[ADD DIM RCPLINK]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
LINKNO|链路号|唯一标识一条Diameter链路。
LOCALHOSTNAME|本端主机名称|根据规划配置。
LOCALREALM|本端域名|根据规划配置本端主机所属的域名。
DSTHOSTNAME|对端主机名称|根据规划配置。本参数需要与对端协商一致。对端主机名与DRA保持一致。
DSTREALM|对端域名|根据规划配置对端主机所属的域名。本参数需要与对端协商一致。对端域名与DRA保持一致。
ADJTYPE|邻接局类型|选择DRA。
CONNID|SCTP/TCP承载链路|Diameter链路使用的SCTP承载编号。该参数使用ADD SCTP命令配置的“SCTP标识”。
PROTOCOL|承载协议类型|选择SCTP。
NAME|链路名称|配置自定义的Diameter链路名称，便于识别。
执行[ADD DIM ROUTEGRPPTY]命令，增加Diameter路由组。
[ADD DIM ROUTEGRPPTY]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
GROUPNO|路由组编号|根据规划配置。本参数全局唯一。
GROUPNAME|路由组名称|配置自定义的Diameter路由组名称，便于识别。
GROUPPTY|路由组属性|根据实际配置为负荷分担。
执行[ADD DIM ROUTE]命令，增加Diameter路由。
[ADD DIM ROUTE]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
ROUTENO|路由编号|用于唯一标识一条Diameter路由。
LOCALPROCESSID|本地动作|用于标识Diameter消息处理类型。只能选择中继处理：表示消息发往下一跳路由器，无需修改消息中任何与路由无关的属性。
MASTERLINKNO|主用链路|用于指定信令路由关联的信令链路的编号。该链路的链路号要求必须在ADD DIM RCPLINK中已配置。
ROUTEPRIORITY|路由优先级|负荷分担链路，优先级一致，通常选择低。
ROUTEAPPID|支持应用|选择Gx和Rx。
DESTURI|目的URI|填写邻接主机的域名。使用命令SHOW ADJHOST查询邻接主机的域名。
ROUTEGROUPNO|路由组编号|填写ADD DIM ROUTEGRPPTY命令中已配置的路由组编号。
举例 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_SIG_0。
增加SCTP偶联。 
 说明： 
通常DRA采用负荷分担方式组网，每套DRA 至少配置4条偶联。对端IP和端口号与DRA保持一致。 
配置到DRA1的SCTP偶联ADD SCTP:ID=1,NAME="KMDRA01BHW-SCTP01",LOCPORT=5304,REMPORT=5354,VPNID1=11,LOCADDR1=10.124.56.129,REMADDR1=10.33.251.198,VPNID2=11,LOCADDR2=10.124.56.130,REMADDR2=10.33.251.230,ROLE="CLT",PROTOCALTYPE="DIAMETER"ADD SCTP:ID=2,NAME="KMDRA01BHW-SCTP02",LOCPORT=5305,REMPORT=5355,VPNID1=11,LOCADDR1=10.124.56.130,REMADDR1=10.33.251.230,VPNID2=11,LOCADDR2=10.124.56.129,REMADDR2=10.33.251.198,ROLE="CLT",PROTOCALTYPE="DIAMETER"ADD SCTP:ID=3,NAME="KMDRA01BHW-SCTP03",LOCPORT=5306,REMPORT=5356,VPNID1=11,LOCADDR1=10.124.56.129,REMADDR1=10.33.251.199,VPNID2=11,LOCADDR2=10.124.56.130,REMADDR2=10.33.251.231,ROLE="CLT",PROTOCALTYPE="DIAMETER"ADD SCTP:ID=4,NAME="KMDRA01BHW-SCTP04",LOCPORT=5307,REMPORT=5357,VPNID1=11,LOCADDR1=10.124.56.130,REMADDR1=10.33.251.231,VPNID2=11,LOCADDR2=10.124.56.129,REMADDR2=10.33.251.199,ROLE="CLT",PROTOCALTYPE="DIAMETER" 
配置到DRA2的SCTP偶联ADD SCTP:ID=51,NAME="KMDRA02BHW-SCTP01",LOCPORT=5304,REMPORT=5354,VPNID1=11,LOCADDR1=10.124.56.129,REMADDR1=10.33.253.198,VPNID2=11,LOCADDR2=10.124.56.130,REMADDR2=10.33.253.230,ROLE="CLT",PROTOCALTYPE="DIAMETER"ADD SCTP:ID=52,NAME="KMDRA02BHW-SCTP02",LOCPORT=5305,REMPORT=5355,VPNID1=11,LOCADDR1=10.124.56.130,REMADDR1=10.33.253.230,VPNID2=11,LOCADDR2=10.124.56.129,REMADDR2=10.33.253.198,ROLE="CLT",PROTOCALTYPE="DIAMETER"ADD SCTP:ID=53,NAME="KMDRA02BHW-SCTP03",LOCPORT=5306,REMPORT=5356,VPNID1=11,LOCADDR1=10.124.56.129,REMADDR1=10.33.253.199,VPNID2=11,LOCADDR2=10.124.56.130,REMADDR2=10.33.253.231,ROLE="CLT",PROTOCALTYPE="DIAMETER"ADD SCTP:ID=54,NAME="KMDRA02BHW-SCTP04",LOCPORT=5307,REMPORT=5357,VPNID1=11,LOCADDR1=10.124.56.130,REMADDR1=10.33.253.231,VPNID2=11,LOCADDR2=10.124.56.129,REMADDR2=10.33.253.199,ROLE="CLT",PROTOCALTYPE="DIAMETER" 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
增加Diameter链路。 
 说明： 
对端主机名、对端域名与DRA保持一致，邻接局类型选择DRA。
增加到DRA1的链路ADD DIM RCPLINK:LINKNO=1,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA01BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=1,PROTOCOL="SCTP",NAME="DRA1-1"ADD DIM RCPLINK:LINKNO=2,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA01BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=2,PROTOCOL="SCTP",NAME="DRA1-2"ADD DIM RCPLINK:LINKNO=3,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA01BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=3,PROTOCOL="SCTP",NAME="DRA1-3"ADD DIM RCPLINK:LINKNO=4,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA01BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=4,PROTOCOL="SCTP",NAME="DRA1-4" 
增加到DRA2的链路ADD DIM RCPLINK:LINKNO=51,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA02BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=51,PROTOCOL="SCTP",NAME="DRA2-1"ADD DIM RCPLINK:LINKNO=52,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA02BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=52,PROTOCOL="SCTP",NAME="DRA2-2"ADD DIM RCPLINK:LINKNO=53,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA02BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=53,PROTOCOL="SCTP",NAME="DRA2-3"ADD DIM RCPLINK:LINKNO=54,LOCALHOSTNAME="APP-XBXAynPCF001PCRF002BZX-03AZX012.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="KMDRA02BHW.km.yn.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="DRA",CONNID=54,PROTOCOL="SCTP",NAME="DRA2-4" 
增加Diameter路由组。 
 说明： 
配置两个路由组，对应Gx接口和Rx接口。 
如果现场需要对接OCS，采用负荷分担模式，参考本节同步增加Sy接口的路由组和相应路由。 
如果现场需要对接OCS，采用主备模式，参考“[配置OCS对接数据]”增加Sy接口的路由组和相应路由。
[ADD DIM ROUTEGRPPTY]:GROUPNO=1,GROUPNAME="DRA-Gx",GROUPPTY="LOADBALANCE"
[ADD DIM ROUTEGRPPTY]:GROUPNO=2,GROUPNAME="DRA-Rx",GROUPPTY="LOADBALANCE"
增加Diameter路由。 
Gx接口Diameter路由配置
[ADD DIM ROUTE]:ROUTENO=1,MASTERLINKNO=1,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=2,MASTERLINKNO=2,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=3,MASTERLINKNO=3,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=4,MASTERLINKNO=4,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=51,MASTERLINKNO=51,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=52,MASTERLINKNO=52,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=53,MASTERLINKNO=53,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
[ADD DIM ROUTE]:ROUTENO=54,MASTERLINKNO=54,ROUTEPRIORITY="LOW",ROUTEAPPID="Gx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=1
Rx接口Diameter路由配置
[ADD DIM ROUTE]:ROUTENO=101,MASTERLINKNO=1,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=102,MASTERLINKNO=2,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=103,MASTERLINKNO=3,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=104,MASTERLINKNO=4,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=151,MASTERLINKNO=51,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=152,MASTERLINKNO=52,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=153,MASTERLINKNO=53,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
[ADD DIM ROUTE]:ROUTENO=154,MASTERLINKNO=54,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=2
#### 配置OCS对接数据 
摘要 :Sy接口用于ZXUN RCP从OCS获取消费门限信息。本节介绍ZXUN RCP和1+1主备的OCS对接数据的配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD ADJHOST]命令，增加邻接主机。
[ADD ADJHOST]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|根据规划配置。
HOSTNAME|主机名|根据规划配置邻接主机的主机名。必须与实际的网元主机名保持一致。多个邻接局主机的主机名不能重复。
REALM|域名|根据规划配置邻接主机对应的域名，必须与实际的网元主机域名保持一致。
HOSTTYPE|邻接主机类型|选择OCS。
ADJHOSTGRPID|邻接主机组编号|取默认值0。
执行[ADD OCSACC]命令，增加主用OCS接入局的配置。
[ADD OCSACC]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
ID|OCS接入局配置编号|本参数用于标识OCS接入局配置。
ADJHOSTID|邻接主机编号|引用ADD ADJHOST命令中已配置的主用OCS的邻接主机编号。只需要增加主用局配置，不需要增加备用局。主用OCS异常时，ZXUN RCP根据路由切换至备用OCS。
执行[ADD NUMANA]命令，增加号码段分析配置。
[ADD NUMANA]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
ID|号码段分析配置编号|用于标识一个号码段分析配置，全局唯一。
ANATYPE|号码段分析类型|根据实际情况选择OCS接入局IMSI分析（OCSACC_IMSI）或OCS接入局MSISDN分析（OCSACC_MSISDN）。
NUMBEGIN|起始号码|配置号码段分析的起始号码。
NUMEND|结束号码|配置号码段分析的结束号码。
RESULTID|号码段分析结果|当号码段分析类型是OCS接入局分析时，号码段分析结果关联OCS接入局配置（SHOW OCSACC）中的OCS接入局配置编号。所有号段都指向主用OCS局。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_SIG_0。
执行[ADD SCTP]命令，增加SCTP偶联。
[ADD SCTP]命令的参数填写说明参见[表4]。
参数|参数名称|填写说明
---|---|---
ID|SCTP标识|唯一标识一个SCTP。本参数全局唯一。
NAME|别名|偶联的别名。
LOCPORT|本端端口|偶联的本端端口号。根据规划配置。
REMPORT|对端端口|根据规划配置。必须与对端协商一致。
VPNID1|VPNID1|偶联第一对地址VPNID。
LOCADDR1|本端IP地址1|偶联第一对地址本端IP。根据规划配置。通常配置为环回接口地址。
REMADDR1|对端IP地址1|偶联第一对地址对端IP，动态偶联服务端不需要配置。根据规划配置。必须与对端协商一致。
VPNID2|VPNID2|偶联第二对地址VPNID。
LOCADDR2|本端IP地址2|偶联第二对地址本端IP。
REMADDR2|对端IP地址2|偶联第二对地址对端IP，动态偶联服务端不需要配置。
ROLE|应用属性|偶联应用属性。选择客户端。
PROTOCALTYPE|应用协议类型|偶联的归属上层协议类型，根据业务情况选择协议类型。选择DIAMETER。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD DIM RCPLINK]命令，增加Diameter链路。
[ADD DIM
RCPLINK]命令的参数填写说明参见[表5]。
参数|参数名称|填写说明
---|---|---
LINKNO|链路号|唯一标识一条Diameter链路。
LOCALHOSTNAME|本端主机名称|根据规划配置。
LOCALREALM|本端域名|根据规划配置本端主机所属的域名。
DSTHOSTNAME|对端主机名称|根据规划配置。本参数需要与对端协商一致。
DSTREALM|对端域名|根据规划配置对端主机所属的域名。本参数需要与对端协商一致。
ADJTYPE|邻接局类型|选择OCS。
CONNID|SCTP/TCP承载链路|Diameter链路使用的SCTP承载编号。该参数使用ADD SCTP命令配置的“SCTP标识”。
PROTOCOL|承载协议类型|选择SCTP。
NAME|链路名称|配置自定义的Diameter链路名称，便于识别。
执行[ADD DIM ROUTEGRPPTY]命令，增加Diameter路由组。
[ADD DIM ROUTEGRPPTY]命令的参数填写说明参见[表6]。
参数|参数名称|填写说明
---|---|---
GROUPNO|路由组编号|根据规划配置。本参数全局唯一。
GROUPNAME|路由组名称|配置自定义的Diameter路由组名称，便于识别。
执行[ADD DIM ROUTE]命令，增加Diameter路由。
[ADD DIM ROUTE]命令的参数填写说明参见[表7]。
参数|参数名称|填写说明
---|---|---
ROUTENO|路由编号|唯一标识一条Diameter路由。
LOCALPROCESSID|本地动作|用于标识Diameter消息处理类型。只能选择中继处理：表示消息发往下一跳路由器，无需修改消息中任何与路由无关的属性。
MASTERLINKNO|主用链路|用于指定本路由关联的信令链路的编号。该链路的“链路号”要求必须在ADD DIM RCPLINK中已配置。
ROUTEPRIORITY|路由优先级|主用链路的优先级为中，备用链路为优先级为低。
ROUTEAPPID|支持应用|选择Sy。
DESTURI|目的URI|填写邻接主机的域名。使用命令SHOW ADJHOST查询邻接主机的域名。
ROUTEGROUPNO|路由组编号|标识该DIAMETER路由归属于哪个路由组。如果不归属于任何路由组，配置为0。或者直接使用默认配置。如果归属于某路由组，则“路由组编号”需要通过ADD DIM ROUTEGRPPTY在路由组属性配置中提前配置。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增OCS主备邻接主机。 
[ADD ADJHOST]:ADJHOSTID=401,HOSTNAME="dmtsrv001.cc.com",REALM="cc.com",HOSTTYPE="OCS",CONNECTDRA="NO",REMARK="主用OCS"
[ADD ADJHOST]:ADJHOSTID=402,HOSTNAME="dmtsrv002.cc.com",REALM="cc.com",HOSTTYPE="OCS",CONNECTDRA="NO",REMARK="备用OCS"
增加主用OCS接入局配置。 
[ADD OCSACC]:ID=1,ADJHOSTID=401
增加号码段分析配置，将所有号段指向主用局。 
[ADD NUMANA]:ID=11,ANATYPE="OCSACC_MSISDN",NUMBEGIN="0000000000000",NUMEND="9999999999999",RESULTID=1
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_SIG_0。
增加SCTP偶联配置。
 说明： 
OCS采用主备方式组网，每套OCS至少配置4条偶联。 
到主用OCS1配置4条SCTP偶联ADD SCTP:ID=401,NAME="OCS1-SCTP1",LOCPORT=3878,REMPORT=3878,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::104",REMADDR1="2409:800B:5003:1705:0015::3001",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::105",REMADDR2="2409:800B:5003:1705:0015::3002",ROLE="CLT",PROTOCALTYPE="DIAMETER";ADD SCTP:ID=402,NAME="OCS1-SCTP2",LOCPORT=3879,REMPORT=3879,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::105",REMADDR1="2409:800B:5003:1705:0015::3002",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::104",REMADDR2="2409:800B:5003:1705:0015::3001",ROLE="CLT",PROTOCALTYPE="DIAMETER";ADD SCTP:ID=403,NAME="OCS1-SCTP3",LOCPORT=3880,REMPORT=3880,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::104",REMADDR1="2409:800B:5003:1705:0015::3001",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::105",REMADDR2="2409:800B:5003:1705:0015::3002",ROLE="CLT",PROTOCALTYPE="DIAMETER";ADD SCTP:ID=404,NAME="OCS1-SCTP4",LOCPORT=3881,REMPORT=3881,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::105",REMADDR1="2409:800B:5003:1705:0015::3002",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::104",REMADDR2="2409:800B:5003:1705:0015::3001",ROLE="CLT",PROTOCALTYPE="DIAMETER"; 
到备用OCS2配置4条SCTP偶联ADD SCTP:ID=451,NAME="OCS2-SCTP1",LOCPORT=4878,REMPORT=4878,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::104",REMADDR1="2409:801D:5003:1704:25::3101",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::105",REMADDR2="2409:801D:5003:1704:25::3102",ROLE="CLT",PROTOCALTYPE="DIAMETER";ADD SCTP:ID=452,NAME=OCS2-SCTP2",LOCPORT=4879,REMPORT=4879,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::105",REMADDR1="2409:801D:5003:1704:25::3102",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::104",REMADDR2="2409:801D:5003:1704:25::3101",ROLE="CLT",PROTOCALTYPE="DIAMETER";ADD SCTP:ID=453,NAME="OCS2-SCTP3",LOCPORT=4880,REMPORT=4880,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::104",REMADDR1="2409:801D:5003:1704:25::3101",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::105",REMADDR2="2409:801D:5003:1704:25::3102",ROLE="CLT",PROTOCALTYPE="DIAMETER";ADD SCTP:ID=454,NAME="OCS2-SCTP4",LOCPORT=4881,REMPORT=4881,VPNID1=11,LOCADDR1="2409:800B:5003:1705:0004::105",REMADDR1="2409:801D:5003:1704:25::3102",VPNID2=11,LOCADDR2="2409:800B:5003:1705:0004::104",REMADDR2="2409:801D:5003:1704:25::3101",ROLE="CLT",PROTOCALTYPE="DIAMETER"; 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
增加Diameter链路。 
到主用OCS1配置4条Diameter链路ADD DIM RCPLINK:LINKNO=401,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv001.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=401,PROTOCOL="SCTP",NAME="OCS1-1"ADD DIM RCPLINK:LINKNO=402,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv001.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=402,PROTOCOL="SCTP",NAME="OCS1-2"ADD DIM RCPLINK:LINKNO=403,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv001.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=403,PROTOCOL="SCTP",NAME="OCS1-3"ADD DIM RCPLINK:LINKNO=404,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv001.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=404,PROTOCOL="SCTP",NAME="OCS1-4" 
到备用OCS2配置4条Diameter链路ADD DIM RCPLINK:LINKNO=451,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv002.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=451,PROTOCOL="SCTP",NAME="OCS2-1"ADD DIM RCPLINK:LINKNO=452,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv002.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=452,PROTOCOL="SCTP",NAME="OCS2-2"ADD DIM RCPLINK:LINKNO=453,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv002.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=453,PROTOCOL="SCTP",NAME="OCS2-3"ADD DIM RCPLINK:LINKNO=454,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="dmtsrv002.cc.com",DSTREALM="cc.com",ADJTYPE="OCS",CONNID=454,PROTOCOL="SCTP",NAME="OCS2-4" 
增加Diameter路由组。 
到主用OCS1配置1个路由组ADD DIM ROUTEGRPPTY:GROUPNO=41,GROUPNAME="OCS1-Sy",GROUPPTY="LOADBALANCE" 
到备用OCS2配置1个路由组ADD DIM ROUTEGRPPTY:GROUPNO=42,GROUPNAME="OCS2-Sy",GROUPPTY="LOADBALANCE" 
增加Diameter路由。 
到主用OCS1，Sy接口，路由优先级设置为MIDDLE，归属路由组41，DESTURI为OCS1的域名ADD DIM ROUTE:ROUTENO=401,MASTERLINKNO=401,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=41ADD DIM ROUTE:ROUTENO=402,MASTERLINKNO=402,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=41ADD DIM ROUTE:ROUTENO=403,MASTERLINKNO=403,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=41ADD DIM ROUTE:ROUTENO=404,MASTERLINKNO=404,ROUTEPRIORITY="MIDDLE",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=41 
到备用OCS2，Sy接口，路由优先级设置为LOW，归属路由组42，DESTURI为OCS2域名ADD DIM ROUTE:ROUTENO=451,MASTERLINKNO=451,ROUTEPRIORITY="LOW",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=42ADD DIM ROUTE:ROUTENO=452,MASTERLINKNO=452,ROUTEPRIORITY="LOW",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=42ADD DIM ROUTE:ROUTENO=453,MASTERLINKNO=453,ROUTEPRIORITY="LOW",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=42ADD DIM ROUTE:ROUTENO=454,MASTERLINKNO=454,ROUTEPRIORITY="LOW",ROUTEAPPID="Sy",DESTURI="cc.com",ROUTEGROUPNO=42 
### PCF对接数据配置 
#### 服务配置 
##### 服务发现方式 
运营商发现PCF的方式参见[表1]。
发现类型|中国移动|中国电信|中国联通
---|---|---|---
AMF发现数据PCF|GPSI|SUPI|SUPI
SMF发现数据PCF|GPSI+NSSAIS|SUPI|SUPI+DNN
SMF发现语音PCF|DNN+ServiceScope|DNN+ServiceScope|DNN+ServiceScope
##### 配置服务号段 
摘要 :ZXUN RCP支持根据服务号段向NRF注册，当SMF/AMF需要根据服务号码选择PCF时，使用该命令新增服务号段配置。
根据[配置用户标识优先级（可选）]中配置的用户标识优先级，确定号码段类型是GPSI还是SUPI。
目前，ZXUN RCP支持向NRF注册10000个号码段，对于相邻的号段需要合并。
对于数据PCF或语音数据混合PCF，该配置必配。请根据运营商规划的号段配置。 
对于纯语音PCF，该配置通常配置兜底号段（无效单号码）。 
运营商服务号段配置参见[表1]。
运营商|局点类型|服务号码配置
---|---|---
中国移动|2C纯数据|GPSI必配，SUPI选配
2B物联网|中国移动|GPSI必配，SUPI选配
2C纯语音|中国移动|兜底号段（无效单号码）
中国电信|数据语音混合|SUPI必配，GPSI选配
纯数据|中国电信|SUPI必配，GPSI选配
纯语音|中国电信|兜底号段（无效单号码）
中国联通|数据语音混合|SUPI必配，GPSI选配
纯数据|中国联通|SUPI必配，GPSI选配
纯语音|中国联通|兜底号段（无效单号码）
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD SERVNUM]命令，增加PCF支持的号段信息。
增加服务号段配置参数说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|服务号段配置编号|服务号段配置的编号。
ANATYPE|号码段类型|服务号段的号码段类型。SUPI：表示使用SUPI号段作为号码段类型。GPSI：表示使用GPSI号段作为号码段类型。
NUMBEGIN|起始号码|该号码段的起始号码。
NUMEND|结束号码|该号码段的结束号码。
NOTE|备注|记录号段所属省份地市信息。
举例 :配置示例如下。 
[ADD SERVNUM]:ID=1,ANATYPE="GPSI",NUMBEGIN="1111111111111",NUMEND="1111111111111",NOTE="兜底GPSI";
[ADD SERVNUM]:ID=2,ANATYPE="SUPI",NUMBEGIN="111111111111111",NUMEND="111111111111111",NOTE="兜底SUPI";
 说明： 
商用开局割接前配置为测试字段，GPSI和SUPI同时都需要配置，且禁止删除。 
##### 配置DNN 
摘要 :本节介绍如何增加ZXUN RCP支持的DNN信息。
当有多个PCF实例对外提供能力时，PCF实例可以通过[ADD DNN]命令配置各自支持的DNN列表。其他NF可以通过NRF发现支持该DNN的所有PCF实例。
通常语音PCF只配置IMS和紧急呼叫DNN，数据PCF根据运营商DNN规划配置。如果PCF服务所有的DNN，可以不配置，即支持所有DNN。 
运营商规划的DNN列表参见[表1]。
运营商|局点|DNN配置
---|---|---
中国移动|2C纯数据|ADD DNN:ID=1,DNN="cmnet"ADD DNN:ID=2,DNN="cmwap"
2B物联网|中国移动|不配，支持所有DNN。
2C纯语音|中国移动|ADD DNN:ID=3,DNN="ims"ADD DNN:ID=4,DNN="sos"ADD DNN:ID=5,DNN="emergency"
中国电信|数据语音混合|不配，支持所有DNN。
纯数据|中国电信|ADD DNN:ID=1,DNN="ctnet";
纯语音|中国电信|ADD DNN:ID=2,DNN="ims"ADD DNN:ID=3,DNN="sos"ADD DNN:ID=4,DNN="emergency"
中国联通|数据语音混合|ADD DNN:ID=1,DNN="3gnet"ADD DNN:ID=2,DNN="3gwap"ADD DNN:ID=10,DNN="ims"ADD DNN:ID=11,DNN="ims.mnc001.mcc460.gprs"ADD DNN:ID=13,DNN="3gnet.mnc001.mcc460.gprs"ADD DNN:ID=14,DNN="3gwap.mnc001.mcc460.gprs"ADD DNN:ID=21,DNN="ims.mnc006.mcc460.gprs"ADD DNN:ID=23,DNN="3gnet.mnc006.mcc460.gprs"ADD DNN:ID=24,DNN="3gwap.mnc006.mcc460.gprs"ADD DNN:ID=31,DNN="ims.mnc009.mcc460.gprs"ADD DNN:ID=33,DNN="3gnet.mnc009.mcc460.gprs"ADD DNN:ID=34,DNN="3gwap.mnc009.mcc460.gprs"
纯数据|中国联通|ADD DNN:ID=3,DNN="3gnet"ADD DNN:ID=4,DNN="3gwap"ADD DNN:ID=13,DNN="3gnet.mnc001.mcc460.gprs"ADD DNN:ID=14,DNN="3gwap.mnc001.mcc460.gprs"ADD DNN:ID=23,DNN="3gnet.mnc006.mcc460.gprs"ADD DNN:ID=24,DNN="3gwap.mnc006.mcc460.gprs"ADD DNN:ID=33,DNN="3gnet.mnc009.mcc460.gprs"ADD DNN:ID=34,DNN="3gwap.mnc009.mcc460.gprs"
纯语音|中国联通|ADD DNN:ID=1,DNN="ims"ADD DNN:ID=11,DNN="ims.mnc001.mcc460.gprs"ADD DNN:ID=21,DNN="ims.mnc006.mcc460.gprs"ADD DNN:ID=31,DNN="ims.mnc009.mcc460.gprs"
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD DNN]命令，新增PCF支持的DNN信息。参数说明参见[表2]。
参数|参数名称|参数配置
---|---|---
ID|编号|用于设置DNN配置的编号，该编号唯一标识一条DNN信息。
DNN|DNN|设置PCF支持DNN名称。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增DNN配置。 
[ADD DNN]:ID=1,DNN="cmnet";
[ADD DNN]:ID=2,DNN="cmwap";
[ADD DNN]:ID=3,DNN="ims";
[ADD DNN]:ID=4,DNN="sos";
 说明： 
商用开局割接前配置为测试字段。 
##### 配置服务区 
摘要 :本节介绍如何增加ZXUN RCP支持的服务区信息。
当有多个PCF对外提供能力时，PCF可以通过[ADD SERVEDAREAS]命令配置各自支持的服务区列表。其他NF就可以通过NRF发现支持该服务区的所有PCF。
语音PCF或语音数据混合PCF必须配置。 
数据PCF可以不配。 
运营商规划的服务区列表配置要求参见[表1]。
运营商|局点|服务区配置
---|---|---
中国移动|2C纯数据|不配
2B物联网|中国移动|不配
2C纯语音|中国移动|必配
中国电信|数据语音混合|必配
纯数据|中国电信|不配
纯语音|中国电信|必配
中国联通|数据语音混合|必配
纯数据|中国联通|不配
纯语音|中国联通|必配
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD SERVEDAREAS]命令，新增服务区配置。
参数说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
SERVEDAREA|服务区域|用于配置PCF的服务区域，参数范围为：1~19个字符。按实际规划配置。注：中国移动服务区域由“服务省份标识（2位字母）”+“服务省内区域标识（2-3位字母）”组成。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增服务区配置。 
[ADD SERVEDAREAS]:SERVEDAREA="heQS"
 说明： 
商用开局割接前配置为测试字段。 
##### 配置PLMN（可选） 
摘要 :PCF支持的运营商PLMN标识，用于配置运营商的移动国家码和移动网络码。 
按照运营商规划的PLMN进行配置。运营商规划的PLMN参见[表1]。
运营商|局点|PLMN配置
---|---|---
中国移动|2C纯数据|ADD NFPLMN:ID=1,MCC="460",MNC="00"ADD NFPLMN:ID=2,MCC="460",MNC="02"ADD NFPLMN:ID=3,MCC="460",MNC="04"ADD NFPLMN:ID=4,MCC="460",MNC="07"ADD NFPLMN:ID=5,MCC="460",MNC="13"
2B物联网|中国移动|ADD NFPLMN:ID=1,MCC="460",MNC="00"ADD NFPLMN:ID=2,MCC="460",MNC="02"ADD NFPLMN:ID=3,MCC="460",MNC="04"ADD NFPLMN:ID=4,MCC="460",MNC="07"ADD NFPLMN:ID=5,MCC="460",MNC="13"
2C纯语音|中国移动|ADD NFPLMN:ID=1,MCC="460",MNC="00"ADD NFPLMN:ID=2,MCC="460",MNC="02"ADD NFPLMN:ID=3,MCC="460",MNC="04"ADD NFPLMN:ID=4,MCC="460",MNC="07"ADD NFPLMN:ID=5,MCC="460",MNC="13"
中国电信|数据语音混合|不配
纯数据|中国电信|不配
纯语音|中国电信|不配
中国联通|数据语音混合|ADD NFPLMN:ID=1,MCC="460",MNC="01"ADD NFPLMN:ID=2,MCC="460",MNC="06"ADD NFPLMN:ID=3,MCC="460",MNC="09"
|纯数据|ADD NFPLMN:ID=1,MCC="460",MNC="01"ADD NFPLMN:ID=2,MCC="460",MNC="06"ADD NFPLMN:ID=3,MCC="460",MNC="09"
|纯语音|ADD NFPLMN:ID=1,MCC="460",MNC="01"ADD NFPLMN:ID=2,MCC="460",MNC="06"ADD NFPLMN:ID=3,MCC="460",MNC="09"
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD NFPLMN]命令，新增PLMN配置。
参数说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|ID|用于指定PLMN配置的编号。
MCC|MCC|用于指定PCF支持的运营商的移动国家码。
MNC|MNC|用于指定PCF支持的运营商的移动网络码。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增PLMN配置。 
[ADD NFPLMN]:ID=1,MCC="460",MNC="00"
##### 配置切片（可选） 
摘要 :S-NSSAI（Single Network Slice Selection Assistance Information，单个网络切片选择辅助信息） 可用于标识网络切片，由SST（Slice/Service Type，切片/服务类型）和SD（Slice Differentiator，切片区分信息）组成。 
PCF在向NRF注册时，会携带此信息，其他NF在通过NRF发现PCF时，可以通过S-NSSAI对PCF进行匹配选择。 
运营商规划的切片参见[表1]。
运营商|局点|切片配置
---|---|---
中国移动|2C纯数据|ADD NSSAIS:SST=1,SD="NULL"
2B物联网|中国移动|不配
2C纯语音|中国移动|ADD NSSAIS:SST=1,SD="NULL"
中国电信|数据语音混合|ADD NSSAIS:SST=1,SD="000000"
|纯数据|ADD NSSAIS:SST=1,SD="000000"
|纯语音|ADD NSSAIS:SST=1,SD="000000"
中国联通|数据语音混合|不配
纯数据|中国联通|不配
纯语音|中国联通|不配
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD NSSAIS]命令，新增切片配置。
参数说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
SST|Sst|用于配置SST（Slice/Service Type，切片/服务类型），目前协议明确的标准SST有四种。1-eMBB：提供高带宽、大数据量的服务。2-uRLLC：提供超高可靠低时延服务。3-mIoT：提供海量的连接数，但是数据量比较小，且对时延要求不高。4-V2X：提供车联网服务。
SD|Sd|用于配置SD（Slice Differentiator，切片区分信息）。SD用于区分同一种SST之内不同的S-NSSAI，当SD设置为NULL时，PCF向NRF注册时不会携带SD参数。参数范围：4~6个字符。默认值：NULL。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增切片配置。 
[ADD NSSAIS]:SST=1,SD="NULL"
##### 配置NF Instance ID 
摘要 :PCF向NRF注册时，会在Nnrf_NFManagement_NFRegister Request消息的NfInstanceId中携带本配置中配置的NF实例ID。 
根据运营商的规范设置NF Instance ID，如果运营商对NF Instance ID的node编码有明确的规范定义，那么增加的NF需要满足运营商对于NF Instance ID节点的要求。如果运营商没有要求，可不修改。 
国内一般都有规划，需要修改。 
相关信息 :中国移动规范如下： 
NF Instance ID（网元实例标识）采用UUID版本4格式（RFC 4122）共128个bit，以32个16进制数，并以"-"分为5段标识，具体为：time-low "-" time-mid "-" time-high-and-version "-" clock-seq-and-reserved clock-seq-low "-" node。 
其中：node为48个bit，由6个字节（8位组）组成，编码规则如[图1]所示。
图1  编码规则

NF type：标识网元类型，取值参见表1。表1  NF type取值规则取值（16进制）对应的NF type00保留015G-EIR02AF03AMF04AUSF05BSF06CHF07GMLC08LMF09N3IWF0ANEF0BNRF0CNSSF0DNWDAF0EPCF0FSEPP10SMF11SMSF12UDM13UDR14UDSF15UPF16CUSTOM_OCS17～FF保留 
Region：标识网元负责业务所在的大区（业务归属大区，非设备所在地理位置），编码规则参见表2。表2  Region 取值规则取值（16进制）对应大区00预留01预留02预留03华北大区04预留05预留06东北大区07预留08预留09华东北大区0A预留0B预留0C华东南大区0D预留0E预留0F预留10华中大区11预留12预留13华南大区14预留15预留16西北大区17预留18预留19预留2A预留2B西南大区2C预留2D预留2E预留2F预留30～FE预留FF全国 
Province：标识网元所服务的省份，编码规则参见表3。表3  Province取值规则取值（16进制）对应省份00“Region”范围内的全部省份01北京02天津03河北04山西05内蒙06黑龙江07吉林08辽宁09江苏0A山东0B安徽0C浙江0D上海0E福建0F江西10河南11湖北12湖南13广东14广西15海南16陕西17甘肃18宁夏19青海1A新疆1B四川1C重庆1D云南1E贵州1F西藏20～FE预留FF预留 
Instance sequence number：网元实例标号。各省可结合本省的实际情况，进一步按照NF负责的地市进行编号。对于综合设置的NF，Instance sequence number的取值应相同。例如：综合设置的同一AUSF/UDM设备，其AUSF和UDM的Instance sequence number的取值应完全相同。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_CommonS_TMSP_0。
执行[SET NF]命令，修改NF实例ID。
配置参数说明参见[表4]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
NFTYPE|NF类型|该参数用于设置NF类型，配置为PCF。
NFIDNODE|NFID Node|该参数用于设置NF ID Node，根据现场实际规划填写。
举例 :例如，设置12位的node，“0E”代表PCF，“03”代表华北大区，“03”代表河北，“312”代表保定的电话区号、“001”代表PCF的序号。 
[SET NF]:NFTYPE="PCF",NFIDNODE="0E0303312001"
#### 配置NRF对接数据 
##### 配置HTTP 
摘要 :5G核心网网元之间通过服务化接口（SBI平面）进行交互，5G服务化接口基础协议采用HTTP/2，即HTTP 2.0版本。服务化接口传输层协议仅采用TCP协议。当要求启用传输层安全时，通过TLS进行传输层保护。 
PCF作为HTTP客户端向其他NF发起HTTP连接，需要配置基于IPv4和/或IPv6客户端模板。 
PCF作为HTTP服务端接收其他NF发起的HTTP连接，需要配置基于IPv4和/或IPv6服务端模板。 
PCF向NRF注册时，会在Nnrf_NFManagement_NFRegister Request消息的NFService中携带配置的服务信息，如FQDN、服务端IPv4/IPv6地址、优先级、容量信息等。 
优先级配置参见[表1]，值越小优先级越高。如果运营商有具体要求，按运营商要求配置。
 说明： 
开局时，建议先将优先级设置为65535（最低）。如果设置的优先级高于现网设备的优先级，用户可能会注册到该局，从而导致业务失败。调试完成后，再按照按运营商要求设置。 
局点类型|优先级
---|---
商用局|主用|1
备用|商用局|31
负荷分担|商用局|15
调测局|主用|100
备用|调测局|300
负荷分担|调测局|50
配置PCF支持的服务，可根据运营商的需求选择配置，参考[表2]。
运营商|局点|配置的服务
---|---|---
中国移动|2C纯数据|NpcfNpcf_SMPolicyControlNpcf_AMPolicyControl
2B物联网|中国移动|NpcfNpcf_SMPolicyControlNpcf_AMPolicyControl
2C纯语音|中国移动|NpcfNpcf_SMPolicyControl
中国电信|数据语音混合|NpcfNpcf_SMPolicyControl
中国联通|数据语音混合|NpcfNpcf_SMPolicyControlNpcf_AMPolicyControl
纯数据|中国联通|NpcfNpcf_SMPolicyControlNpcf_AMPolicyControl
纯语音|中国联通|NpcfNpcf_SMPolicyControl
 说明： 
通常情况下，必须配置Npcf、Npcf_SMPolicyControl服务，其他服务一般不配置。如果运营商有需求，可根据实际需求配置，例如，联通的N5测试或UE策略测试等。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0。
执行[ADD CLIENTPROFILE]命令，配置客户端模板，用于PCF作为HTTP客户端向其他NF发起HTTP连接。
SBI平面新增客户端模板配置参数说明参见[表3]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|编号|客户端模板ID。
IPADDR|IP地址|客户端地址和服务端地址合一。根据规划使用已配置的SBI环回接口地址。SBI平面需要配置IPv4/IPv6双栈地址。
STARTPORT|起始端口|保持默认配置10000。
ENDPORT|终止端口|保持默认配置60000。
VPNID|VPN ID|SBI接口的VPNID，根据规划配置。
CONNNUM|链路数量|配置2，当弹性链路开关打开时，会根据链路负荷自行弹缩。
CONNELASTIC|弹性链路开关|保持默认配置打开。
RESPBODYMAXLENGTH|接收响应消息体最大长度（字节）|保持默认配置2097152。
KEEPALIVESWITCH|链路保活开关|保持默认配置打开。
HTTPVERSION|HTTP版本|SBI平面保持默认配置HTTP2。
执行[ADD SERVERPROFILE]命令，配置服务端模板，用于PCF作为HTTP服务端接收其他NF发起的HTTP连接。
SBI平面新增服务端模板配置参数说明参见[表4]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|编号|服务端模板ID。
IPADDR|IP地址|客户端地址和服务端地址合一。根据规划使用已配置的SBI环回接口地址。SBI平面需要配置IPv4/IPv6双栈地址。
PORT|端口|服务端端口号，默认8080。根据运营商规范配置。中国移动要求端口号80。
VPNID|VPN ID|SBI接口的VPNID，根据规划配置。
KEEPALIVESWITCH|链路保活开关|保持默认配置打开。
REQBODYMAXLENGTH|接收请求消息体最大长度（字节）|保持默认配置2097152。
HTTPVERSION|HTTP版本|SBI平面保持默认配置HTTP2。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD PCFSERVICE]命令，增加PCF支持的服务。
增加服务的参数说明参见[表5]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
SERVICETYPE|服务类型|设置服务类型。Npcf：表示通配服务类型。Npcf_SMPolicyControl：表示使用Npcf_SMPolicyControl服务作为服务类型。Npcf_AMPolicyControl：表示使用Npcf_AMPolicyControl服务作为服务类型。Npcf_UEPolicyControl：表示使用Npcf_UEPolicyControl服务作为服务类型。Npcf_PolicyAuthorization：表示使用Npcf_PolicyAuthorization服务作为服务类型。
VERSION|版本|指定该服务的版本。
FQDN|FQDN|标识一个FQDN。FQDN是全限定域名，该参数为字符型，字符长度1~100。
PRIORITY|优先级|指定该服务的优先级。取值范围为0~65535，数值越小代表优先级越高。优先级配置建议参考表1。
CAPACITY|容量|指定该服务的容量，保持默认值0。
SERVERID|HTTP服务端模板ID|指定该服务的服务端模板。服务端模板ID已在步骤3中进行配置，供PCF向NRF注册时关联使用。如果采用IPv4/IPv6双栈，则SERVERID需关联HTTP服务端模板配置中配置的IPv4和IPv6模板；如果采用单栈，则关联其中一个即可。注：中国移动采用双栈配置；中国电信采用单栈配置。
SCHEMA|模式|指定该服务的模式。HTTP：表示使用HTTP协议。HTTPS：表示使用HTTPS协议。
执行[ADD SVCHTTPCLTPROF]命令，新增关联HTTP客户端模板配置。
当PCF作为客户端动态查询NRF，得到相关接口服务记录后，会根据对端的服务类型、FQDN等信息匹配该配置，获取客户端模板ID，并在后续创建动态链路时使用。 
参数说明参见[表6]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|记录标识|唯一标识一条关联HTTP客户端模板配置信息。
SERVICETYPE|服务类型|选择服务类型。
FQDN|对端FQDN|该服务的FQDN。FQDN是全限定域名，默认值*，表示通配。
HTTP4CLTID|HTTP IPv4模板ID|填写HTTP IPv4模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTP6CLTID|HTTP IPv6模板ID|填写HTTP IPv6模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTPS4CLTID|HTTPS IPv4模板ID|填写HTTPS IPv4模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTTPS6CLTID|HTTPS IPv6模板ID|填写HTTPS IPv6模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTURI|URI中主机类型|选择URI中主机类型。IP：表示主机类型为IP类型。FQDN：表示主机类型为FQDN。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0。
配置客户端模板。 
[ADD CLIENTPROFILE]:ID=1,IPADDR=2409:8069:5003:1805::0128:1101,STARTPORT=10000,ENDPORT=60000,CONNNUM=2,VPNID=9
[ADD CLIENTPROFILE]:ID=2,IPADDR=10.124.74.134,STARTPORT=10000,ENDPORT=60000,CONNNUM=2,VPNID=9
配置服务端模板。 
[ADD SERVERPROFILE]:ID=1,IPADDR=2409:8069:5003:1805::0128:1101,PORT=80,VPNID=9
[ADD SERVERPROFILE]:ID=2,IPADDR="10.124.74.134",PORT=80,VPNID=9
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
配置服务。 
通配服务ADD PCFSERVICE:SERVICETYPE="NPCF",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2" 
N7接口服务用于PCF向SMF提供PDU会话管理的策略，如会话QoS控制策略及计费策略。ADD PCFSERVICE:SERVICETYPE="NPCF_SMPOLICYCONTROL",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2" 
N15接口服务（可选）用于PCF向AMF提供接入及移动性管理策略。ADD PCFSERVICE:SERVICETYPE="NPCF_AMPOLICYCONTROL",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2" 
UE策略服务（可选）用于PCF向AMF提供UE路由选择策略。ADD PCFSERVICE:SERVICETYPE="NPCF_UEPOLICYCONTROL",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2" 
N5接口服务（可选）用于PCF向AF/NEF提供承载QoS保障、赞助业务及AF影响业务路由策略。ADD PCFSERVICE:SERVICETYPE="NPCF_POLICYAUTHORIZATION",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2"ADD PCFSERVICE:SERVICETYPE="NPCF_EVENTEXPOSURE",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2"ADD PCFSERVICE:SERVICETYPE="NPCF_BDTPOLICYCONTROL",VERSION="v1",FQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",PRIORITY=100,SERVERID="1"&"2" 
关联HTTP客户端模板 
如果采用双栈，则关联已配置的IPv4和IPv6客户端模板。 
如果采用单栈，则关联一个即可。如果仅使用IPv6单栈，则HTTP4CLTID=0；如果仅使用IPv4单栈，则HTTP6CLTID=0。 
 说明： 
中国移动采用双栈配置。中国电信采用IPv6单栈配置。 
通配服务ADD SVCHTTPCLTPROF:ID=1,SERVICETYPE="NPCF",HTTP4CLTID=2,HTTP6CLTID=1 
SMP服务ADD SVCHTTPCLTPROF:ID=2,SERVICETYPE="NPCF_SMPOLICYCONTROL",HTTP4CLTID=2,HTTP6CLTID=1 
AMF服务（可选）ADD SVCHTTPCLTPROF:ID=3,SERVICETYPE="NPCF_AMPOLICYCONTROL",HTTP4CLTID=2,HTTP6CLTID=1 
CHF服务（可选）ADD SVCHTTPCLTPROF:ID=4,SERVICETYPE="NCHF_SPENDLMTCONTROL",HTTP4CLTID=2,HTTP6CLTID=1 
BSF服务（可选）Nbsf是BSF提供的服务化接口，PCF调用该接口，注册、更新、去注册绑定信息。绑定信息包含UE标识、DNN、UE IP地址及PDU会话所选PCF信息。 说明：BSF融合部署：例如，中移的SMF内置BSF功能，则不需要配置。PCF不需要和BSF交互，由融合部署网元SMF自行注册、更新、去注册绑定信息。BSF独立部署：例如，电信、联通，则需要配置该服务使用的HTTP客户端模板。ADD SVCHTTPCLTPROF:ID=5,SERVICETYPE="NBSF_MGT",HTTP4CLTID=2,HTTP6CLTID=1 
##### 配置NRF服务器 
摘要 :NRF用于接收服务提供者的注册信息，供服务使用者发现服务提供者。
本节介绍如何配置PCF对接的NRF信息。当PCF部署成功后，需要配置NRF的地址和端口号。配置成功后，PCF会向NRF注册，并在用户业务流程中通过NRF发现其他合适的NF实例。 
PCF通常对接主备2个NRF，如果NRF地址为IPv6，则关联IPv6的HTTP客户端模板；如果NRF的地址为IPv4，则关联IPv4的HTTP客户端模板。 
PCF向NRF注册服务，便于AMF、SMF、AF等NF发现PCF服务。 
PCF通过NRF发现并订阅CHF、UDR、AMF、SMF、BSF等服务，获得用户签约、计费等信息，及业务相关信息。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0。
执行[ADD SBINRFGROUP]命令，新增NRF服务器分组配置。
配置参数说明参见[表1]。
参数|参数名称|参数配置
---|---|---
ID|NRF服务器组编号|该参数用于设置NRF服务器组编号。
DESC|描述信息|该参数用于设置NRF服务器组的描述信息。
执行[ADD SBINRFNODE]命令，新增NRF服务器节点配置。
配置参数说明参见[表2]。
参数|参数名称|参数配置
---|---|---
ID|NRF服务器节点编号|该参数用于设置NRF服务器节点编号。
SERVERIPADDR|NRF服务器IP地址|该参数用于设置NRF服务器IP地址，支持IPv4和IPv6。
SERVERPORT|NRF服务器端口|该参数用于设置NRF服务器端口。
SERVERFQDN|NRF服务器FQDN|该参数用于设置NRF服务器FQDN，暂时空置，不设置。
SCHEME|URI scheme|该参数用于设置NRF服务器支持的URI scheme，默认值为HTTP。
APIVERSION|API版本|该参数用于设置NRF的API版本，比如v1或v2，默认值为v1。
CLIENTPROFILEID|HTTP客户端模板编号|该参数用于设置向NRF服务器发送请求时使用的HTTP客户端模板编号。
NOTIFYSVRPROFILEID|通知时使用的HTTP服务端模板编号|该参数用于设置接收NRF服务器的通知时使用的HTTP服务端模板编号。
PRIORITY|NRF服务器节点优先级|该参数用于设置NRF服务器节点优先级。默认值为0，优先级最高。值越小优先级越高。
GROUPID|归属的NRF服务器组编号|该参数用于设置NRF服务器节点归属的NRF服务器组编号。
执行[ADD SBINRFPOLICY]命令，新增NRF服务器策略配置。
配置参数说明参见[表3]。
参数|参数名称|参数配置
---|---|---
ID|NRF服务器策略编号|该参数用于设置NRF服务器策略编号。
NRFPATTERN|NRF模式|该参数用于设置NRF模式，包括主备模式和互备双活模式，默认值为互备双活模式。
NRFENABLEMODE|主用恢复后启用方式|该参数用于设置主用NRF恢复后的启用方式。缺省为自动倒回，即主用NRF恢复后将自动倒回。手动倒回启用时，需要手动执行动态命令进行倒回。仅当NRF模式为互备双活模式时，自动倒回主用NRF才会生效。中国移动设置为手动倒回，其余运营商保持默认值自动倒回。
REDIRECTTIMES|临时重定向次数|该参数用于设置NRF返回307时临时重定向最大次数，默认值为2。超过此值，则返回失败。
ALLNRFOFFRSPCODE|主备不可用响应码|该参数用于设置主备NRF都不可用时，SBI-GW给NF的响应码，缺省为420。
SPAREOFFLINERSPCODE|主备间永久重定向响应码|该参数用于设置永久重定向响应的响应码，默认值为308。当锚定节点（首选NRF服务节点）收到配置指定的永久性重定向响应时，则将锚定节点切换到相反节点上，即若当前锚定节点为主用，则切换到备用节点，若当前锚定节点为备用，则切换到主用节点。
TRAFFICCONTROLFLAG|是否启用流控功能|该参数用于设置是否启用流控功能，默认值为启用。流量控制值固定：大规格：5000个请求每秒。中规格：2000个请求每秒。小规格：1000个请求每秒。中国移动设置为不启用，其他运营商保持默认值启用。
HEARTBEATINTERVAL|心跳间隔(秒)|该参数用于设置与NRF之间的心跳间隔。建议配置为10。
LOADREPORTTHRESHOLD|负载上报变化量阈值(%)|该参数用于配置SBI-GW向NRF服务端发送心跳消息的负载变化量阈值。SBI-GW向NRF服务端发送心跳消息时，若当前负载相比已上报的负载，变化量超过该配置，则带负载字段；否则不带。若配置为0，表示不判断，心跳均带负载。建议配置为20。
执行[ADD SBINRFPROFILE]命令，新增NRF服务器模板配置。
配置参数说明参见[表4]。
参数|参数名称|参数配置
---|---|---
ID|NRF服务器模板编号|该参数用于设置NRF服务器模板编号。
POLICYID|NRF服务器策略编号|该参数用于设置NRF服务器策略编号。
ACTIVESRVGRPID|主用NRF服务器组编号|该参数用于设置主用NRF服务器组编号。
BAKSRVGRPID|备用NRF服务器组编号|该参数用于设置备用NRF服务器组编号。
DETECTNFINSTID|检测使用的NF实例标识|该参数用于设置检测使用的NF实例标识。需配置为实际注册的NF实例ID，通过SHOW REGISTER INFO获取，前后不能带空格且为全小写。
ISSELFDETECTID|检测使用自身NF实例标识|该参数用于设置节点检测是否使用网元自身的NF实例标识。需配置为启用。
执行[ADD SBIRESELECT]命令，新增失败重选策略配置。
配置参数说明参见[表5]。
参数|参数名称|参数配置
---|---|---
TARGETNFTYPE|目的NF类型|该参数用于设置重选的目的NF类型。
LINKRESELTIMES|链路重选次数|该参数用于设置同一个目的IP的不同链路重选次数，默认值为0，默认不进行重选。
IPRESELECTIMES|IP重选次数|该参数用于设置同一个NF的不同IP重选次数，默认值为1。
NFRESELECTIMES|NF重选次数|该参数用于设置不同NF的重选次数，默认值为1。
RESELECTTIME|重选等待时长(秒)|该参数用于设置重选等待时长，单位：秒。默认值为2。
执行[ADD SBIRESELECTSTATUSCODE]命令，新增重选状态码配置。
配置参数说明参见[表6]。
参数|参数名称|参数配置
---|---|---
ID|标识|该参数用于设置重选状态码配置的标识。
TARGETNFTYPE|目的NF类型|该参数用于设置目的NF类型。若本网元向此类型的目的NF发送消息失败，根据目的NF回的状态码与配置的状态码是否一致，来决定是否进行重选。
STATUSCODE|状态码|该参数用于设置触发重选的HTTP状态码。若本网元向此类型的目的NF发送消息失败，根据目的NF回的状态码与配置的状态码是否一致，来决定是否进行重选。
执行[SET SBISRVDISCOVERY]命令，修改服务发现配置。
配置参数说明参见[表7]。
参数|参数名称|参数配置
---|---|---
RECACHETHRESHOLD|续缓存时间阈值（秒）|该参数用于设置续缓存时间阈值，默认值为60，0表示不支持续缓存功能。建议配置为300。
SUBREQNFTYPE|订阅者NF类型|该参数用于设置订阅者NF类型。无效值表示不配置订阅者NF类型。固定配置PCF_TYPE。
SUBREQFQDN|订阅者FQDN|该参数用于设置订阅者FQDN类型。N/A表示取消订阅者FQDN设置。执行SHOW PCFSERVICE命令，查询服务类型为NPcf的FQDN。
DELAYTIMES|续缓存失败延时次数|该参数用于SBIGW的服务发现功能向NRF续缓存失败时延长缓存有效期的次数。固定配置为96。
DELAYTIMELEN|续缓存失败延时时长（秒）|该参数用于服务发现向NRF续缓失败时延长缓存有效期的时长。固定配置为1800。
AGEDDELAY|老化延时（秒）|该参数用于设置服务发现缓存有效期到期后的延时老化时间。固定配置为86400。
REFRESHINTERVAL|无可用NF缓存最小刷新间隔（秒）|该参数为服务发现缓存中NF注册状态均不可用时，为避免刷新失败时频繁刷新的间隔时间。固定配置为10。
执行[ADD SBISRVDISCOVERYMODE]命令，新增服务发现方式配置。
配置参数说明参见[表8]。
参数|参数名称|参数配置
---|---|---
TARGETNFTYPE|目标NF类型|该参数用于设置目的NF类型。固定配置ALL。
DISCOVERYMODE|发现方式|该参数用于设置服务发现方式，默认为动态，同时存在all和网元配置时，单独网元的优先级高。固定配置一个发现方式为动态，目标NF类型为ALL的记录。如果有静态CHF、BSF、UDR，需要再配置1个发现方式为静态的特定目标NF类型的记录。例如，中国电信部分省份需要配置静态CHF。
IPSELECTMODE|地址选择方式|该参数用于设置地址选择方式，默认为随机。可以配置随机、IPv4优先、IPv6优先，以实际业务为准。
DEFAULTPORTFORHTTP|http默认端口|该参数用于设置http默认端口，默认值为80。配置为0时，表示不支持http默认端口。配置修改需要等缓存老化或者手工删除缓存后再次重新服务发现生效。
DEFAULTPORTFORHTTPS|https默认端口|该参数用于设置https默认端口，默认值为443。配置为0时，表示不支持https默认端口。配置修改需要等缓存老化或者手工删除缓存后再次重新服务发现生效。
执行[ADD SBIROUTEPOLICY]命令，新增路由策略配置。
配置参数说明参见[表9]。
参数|参数名称|参数配置
---|---|---
TARGETNFTYPE|目标NF类型|该参数用于设置目的NF类型。固定配置ALL。
NFTYPE|NF类型|该参数用于设置本端NF类型。固定配置PCF_TYPE。
NEEDTOKEN|是否需要令牌|该参数用于设置是否需要令牌。向目的NF发送请求消息时，是否需要鉴权处理。默认否。否：不需要令牌。是：需要令牌。
INNERAUTOBACK|后续请求自动倒回|该参数用于设置后续请求自动倒回配置。包括三种类型：不自动倒回。自动倒回到高优先级NF。收到后续请求时，从路由集中选择比当前路由信息中携带的NF优先级更高且最高的可用的NF，如果失败则继续使用当前NF。自动倒回到初始锚定NF。收到后续请求时，如果当前路由信息中携带的NF不是初始锚定的NF，且路由集中初始锚定NF可用，则倒回到初始请求时选择的NF，如果失败则继续使用当前NF。配置为自动倒回到高优先级NF。
FQDNINTARGETURI|目标URI内是否优先携带FQDN|该参数用于设置目标URI内是否优先携带FQDN。默认否。否：不优先携带FQDN。是：优先携带FQDN，如果没有FQDN则携带IP地址和端口。
INNERDISASTERSWITCH|后续请求容灾倒换开关|该参数用于设置后续请求（非初始请求）是否支持容灾倒换。默认是。否：不支持后续请求容灾倒换，只能在初始请求锚定NF内进行重选。当业务希望初始请求消息锚定NF后，后续请求消息都发送到该NF，则配置为否。是：支持后续请求容灾倒换，和后续请求自动倒回配置配合使用。业务不关心后续请求消息发送到哪个NF，只要求消息可以正常发送，则配置为是。
INNERNOTIFYREROUTE|变更通知后后续请求是否重路由|该参数用于设置在NRF通知SBI-GW订阅的NF变更后，SBI-GW在收到后续请求（非初始请求）时的重路由方式。默认重路由。固定配置为锚定NF注册状态不可用时重路由。
IGNOREREGSTATUS|全不可用时忽略注册状态|该参数用于设置在直连和非直连两种组网场景中，是否支持当服务发现结果中的NF都不是已注册态时忽略注册状态。默认否。固定配置为是。
执行[ADD SBINRFPROFILESEL]命令，新增NRF服务器模板选择配置。
配置参数说明参见[表9]。
参数|参数名称|参数配置
---|---|---
NFTYPE|NF类型|该参数用于设置选择NRF服务器模板的NF类型。如果是NF注册，则该参数设置为需要注册的NF类型，其他情况设置为目的NF类型。
NRFPROFILEID|NRF服务器模板编号|该参数用于设置被选择的NRF服务器模板编号。
执行[ADD GLOBALPARAMETER]命令，新增全局参数配置。
配置参数说明参见[表11]。
参数|参数名称|参数配置
---|---|---
ID|编号|该参数用于表示待设置的某个全局参数编号。该命令需要配合动态命令SHOW GLOBAL PARAMETER使用，先查询出ID对应的全局参数的描述。
VALUE|参数值|该参数用于设置全局参数值。该命令需要配合动态命令SHOW GLOBAL PARAMETER使用，设置的值范围需要在SHOW GLOBAL PARAMETER命令查询结果定义的范围内。
切换到Npcf_PolicyManagement_0节点，执行[SET NRFPATTERN]命令，设置NRF策略配置，即PCF未配置服务号段时是否允许向NRF进行注册。
配置参数说明参见[表12]。
参数|参数名称|参数配置
---|---|---
NOSEGREG|无号段时允许注册|该参数用于表示PCF未配置服务号段时是否允许向NRF进行注册。纯数据PCF或者数据语音混合PCF，保持默认值否。纯语音PCF需要设置为是。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0。
新增NRF服务器分组配置。 
[ADD SBINRFGROUP]:ID=1,DESC=NRF Master
[ADD SBINRFGROUP]:ID=2,DESC=NRF Slave
新增NRF服务器节点配置。 
需要双栈则全部配置，需要单栈则仅配置IPv4或IPv6。中国移动的NRF服务器端口设置为80，中国电信/中国联通的NRF服务器端口设置为8080。
[ADD SBINRFNODE]:ID=1,SERVERIPADDR="2409:800B:5003:1103:0000:0000:000F:0101",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=1,GROUPID=1
[ADD SBINRFNODE]:ID=2,SERVERIPADDR="10.119.159.48",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=2,NOTIFYSVRPROFILEID=2,PRIORITY=2,GROUPID=1
[ADD SBINRFNODE]:ID=3,SERVERIPADDR="2409:801D:5003:1103:0000:0000:000F:0201",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=1,GROUPID=2
[ADD SBINRFNODE]:ID=4,SERVERIPADDR="10.119.175.112",SERVERPORT=80,SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=2,NOTIFYSVRPROFILEID=2,PRIORITY=2,GROUPID=2
新增NRF服务器策略配置。 
中国电信/中国联通： 
[ADD SBINRFPOLICY]:ID=1,NRFPATTERN="DUAL_ACTIVE",NRFENABLEMODE=AUTO_SWITCH,TRAFFICCONTROLFLAG="true",HEARTBEATINTERVAL=10,LOADREPORTTHRESHOLD=20
中国移动： 
[ADD SBINRFPOLICY]:ID=1,NRFPATTERN="DUAL_ACTIVE",NRFENABLEMODE=MANUAL_SWITCH,TRAFFICCONTROLFLAG="false",HEARTBEATINTERVAL=10,LOADREPORTTHRESHOLD=20
新增NRF服务器模板配置。 
[ADD SBINRFPROFILE]:ID=1,POLICYID=1,ACTIVESRVGRPID=1,BAKSRVGRPID=2,DETECTNFINSTID="00000000-0000-0000-0000-000000000000",ISSELFDETECTID="true"
新增失败重选策略。 
目的NF类型为CHF、BSF时，重选参数按默认值配置：LINKRESELTIMES=0,IPRESELECTIMES=1,NFRESELECTIMES=1。 
[ADD SBIRESELECT]:TARGETNFTYPE="ALL",LINKRESELTIMES=0,IPRESELECTIMES=1,NFRESELECTIMES=1,RESELECTTIME=2
目的NF类型为NRF时，重选参数配置：LINKRESELTIMES=0,IPRESELECTIMES=0,NFRESELECTIMES=1。 
[ADD SBIRESELECT]:TARGETNFTYPE="NRF_TYPE",LINKRESELTIMES=0,IPRESELECTIMES=0,NFRESELECTIMES=1,RESELECTTIME=2
新增重选状态码。 
[ADD SBIRESELECTSTATUSCODE]:ID=1,TARGETNFTYPE="NRF_TYPE",STATUSCODE=429
[ADD SBIRESELECTSTATUSCODE]:ID=2,TARGETNFTYPE="NRF_TYPE",STATUSCODE=500
[ADD SBIRESELECTSTATUSCODE]:ID=3,TARGETNFTYPE="NRF_TYPE",STATUSCODE=501
[ADD SBIRESELECTSTATUSCODE]:ID=4,TARGETNFTYPE="NRF_TYPE",STATUSCODE=503
设置服务发现配置。 
[SET SBISRVDISCOVERY]:RECACHETHRESHOLD=300,SUBREQNFTYPE="PCF_TYPE",SUBREQFQDN="APP-HBBADhePCF001PCF001BZX-05AZX011.bad.he.node.5gc.mnc000.mcc460.3gppnetwork.org",DELAYTIMES=96,DELAYTIMELEN=1800,AGEDDELAY=86400,REFRESHINTERVAL=10
新增服务发现方式配置。 
固定配置一个发现方式为动态，目标NF类型为ALL的记录。
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="ALL",DISCOVERYMODE="DYNAMIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=80,DEFAULTPORTFORHTTPS=443
如果有静态CHF、BSF、UDR，需要再配置一个静态的特定目标NF类型的记录，如中国电信部分省份需要配置静态CHF。 
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="CHF_TYPE",DISCOVERYMODE="STATIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=80,DEFAULTPORTFORHTTPS=443
新增路由策略配置 
[ADD SBIROUTEPOLICY]:TARGETNFTYPE="ALL",NFTYPE="PCF_TYPE",NEEDTOKEN="NO",INNERAUTOBACK="AUTOBACK_INITANCHOR",FQDNINTARGETURI="NO",INNERDISASTERSWITCH="YES",INNERNOTIFYREROUTE="REROUTE_WHEN_TARGETNF_UNAVAILABLE",IGNOREREGSTATUS="YES"
新增NRF服务器模板选择配置。 
[ADD SBINRFPROFILESEL]:NFTYPE="ALL",NRFPROFILEID=1
新增全局参数配置。 
[ADD GLOBALPARAMETER]:ID=53,VALUE=1500
[ADD GLOBALPARAMETER]:ID=61,VALUE=1
[ADD GLOBALPARAMETER]:ID=270,VALUE=2160
切换到Npcf_PolicyManagement_0节点，设置NRF策略配置。
纯数据PCF或者数据语音混合PCF： 
[SET NRFPATTERN]:NOSEGREG="NO"
纯语音PCF： 
[SET NRFPATTERN]:NOSEGREG="YES"
#### 配置SMF对接数据 
摘要 :ZXUN RCP对接SMF，实现5GC中PDU会话的策略控制。本节介绍ZXUN RCP与SMF对接数据的配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD ADJHOSTGRP]命令，增加邻接主机组。
[ADD ADJHOSTGRP]命令的参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
ADJHOSTGRPID|邻接主机组编号|根据规划配置。
HOSTTYPE|邻接主机组类型|PCF和SMF对接时，选择SMF。
执行[ADD ADJHOSTWD]命令，增加邻接主机通配。
[ADD ADJHOSTWD]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|标识一个邻接主机，全局唯一。
HOSTNAME|主机名|配置为*，表示通配的主机名。
HOSTTYPE|邻接主机类型|PCF和SMF对接时，选择SMF。
ADJHOSTGRPID|邻接主机组编号|标识一个邻接主机组，全局唯一。引用ADD ADJHOSTGRP命令中配置的“邻接主机组编号”。
PRIOR|优先级|数字越大优先级越高。
执行[ADD ADJHOSTIP]命令，增加邻接主机IP配置。
根据目前服务化的接口协议，N5、N7、N15（含UE策略）等接口，notificationUri在初始请求消息的消息体中都是必选项，示例如下：notificationUri:  "http://[2409:805b:5003:1640::b:202]:80/npcf-smpolicycontrol/notification/v1/sm-policies/08c1a018120d089210120802da0000b9a70006"。
PCF收到AM策略关联、UE策略关联、SM策略关联建立请求时，首先分析出归属邻接主机（归属邻接主机组）： 
notificationUri主机部分为IP，则匹配邻接主机IP配置，分析出归属邻接主机（归属邻接主机组）。 
notificationUri主机部分为FQDN，则匹配邻接主机配置（若无法精确匹配，继续匹配邻接主机通配配置），分析出归属邻接主机（归属邻接主机组）。 
[ADD ADJHOSTIP]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
ADJHOSTID|邻接主机编号|标识一个邻接主机。不能和步骤3中已配置的邻接主机编号重复。
HOSTIPADDRESS|主机IP地址|配置邻接主机的IP地址，区分IPv4和IPv6。邻接主机IP地址不能配置成全0。
MASKLEN|掩码长度|配置邻接主机IP地址的掩码长度。
OSTTYPE|邻接主机类型|PCF和SMF对接时，选择SMF。
ADJHOSTGRPID|邻接主机组编号|引用步骤1中已配置的邻接主机组编号。
执行[ADD BEARABILITY]命令，增加承载能力。
当PCEF/SMF融合网元接入时，使用该命令。命令执行成功后，在IP-CAN会话建立时，RCP将根据用户接入的PCEF主机查询本配置，获取对端设备能力。 
[ADD BEARABILITY]命令的参数填写说明参见[表4]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数说明
---|---|---
ADJHOSTGRPID|邻接主机组编号|引用ADD ADJHOSTGRP命令中配置的“邻接主机组编号”。
INTERFACE|接口能力|PCF和SMF对接时，选择PGW。
SERVMODE|业务标识方式|选择应用标识。
PREDIST|支持业务决策预下发|配置ZXUN RCP是否支持业务预下发的能力。是：用户上线时就下发的预定义规则。
TIMERULENUM|每业务时段规则数量|时段规则数目。
REVALIDTIME|支持Revalidation-Time AVP|是否支持Revalidation-Time AVP下发。
SVCREDIRECT|支持私有重定向|是否支持业务重定向。不支持重定向功能时，即使决策输出了重定向也不下发重定向规则。
BEARCTRMODE|承载控制模式|模式选择由网络部署决定。UE_NW：该模式下，用户或网络侧都可以发起资源建立请求。UE_ONLY：该模式下，由用户发起资源建立请求。
SESSCCTIME|支持会话级时长上报|是否支持会话级时长上报。
SVCCCTIME|支持业务级时长上报|是否支持业务级时长上报。
SESSCHARGE|支持会话级计费决策参数|是否支持会话级计费决策参数。
ROAMCOND|漫游判断条件|配置漫游判断条件，包含MCC-MNC、SGSN IP/AN-GW Address、BSID、ULI四种方式。ZXUN RCP根据漫游条件，使用相应的信息分析用户的漫游情况。
RELRGCHG|支持RG变化则释放会话|是否支持RG变化时释放会话。
ACC3GPPQRY|支持3GPP接入信息查询|3GPP接入方式下，是否支持AF通过ZXUN RCP查询接入网类型为3GPP接入的接入网的位置。
TRUSTWLANQRY|支持授信WLAN接入信息查询|配置授信WLAN接入方式下，是否支持AF通过ZXUN RCP查询接入网类型为授信WLAN接入的接入网的位置。授信指3GPP AAA Server对3GPP接入网络进行过授权认证，对3GPP接入网络信任。
UNTRUSTWLANQRY|支持非授信WLAN接入信息查询|配置非授信WLAN接入方式下，是否支持AF通过ZXUN RCP查询接入网类型为非授信WLAN接入的接入网的位置。非授信指3GPPAAA Server对3GPP接入网络未进行过授权认证，对3GPP接入网络不信任。是：支持AF通过PCRF查询接入网类型为非授信WLAN接入的接入网位置。否：不支持AF通过PCRF查询接入网类型为非授信WLAN接入的接入网位置。兼容：支持AF通过PCRF查询接入网类型为非授信WLAN接入时，PCRF将PCEF已上报的UE本地IP地址上报给AF。
EXTENDBW|支持扩展带宽AVP|配置是否支持扩展带宽AVP。是：是否支持扩展AVP由协商能力决定。否：对端不支持扩展AVP。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
增加邻接主机组。 
增加通配SMF邻接主机组10、本省SMF邻接主机组11、外省SMF邻接主机组12。 
[ADD ADJHOSTGRP]:ADJHOSTGRPID=10,HOSTTYPE="SMF"
[ADD ADJHOSTGRP]:ADJHOSTGRPID=11,HOSTTYPE="SMF"
[ADD ADJHOSTGRP]:ADJHOSTGRPID=12,HOSTTYPE="SMF"
增加邻接主机通配。 
[ADD ADJHOSTWD]:ADJHOSTID=10,HOSTNAME="*",HOSTTYPE="SMF",ADJHOSTGRPID=10,PRIOR=1,REMARK="SMF通配"
增加邻接主机IP配置。 
精确配置ADD ADJHOSTIP:ADJHOSTID=1001,HOSTIPADDRESS="10.119.173.208",MASKLEN=32,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1002,HOSTIPADDRESS="10.119.189.208",MASKLEN=32,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1003,HOSTIPADDRESS="10.119.173.210",MASKLEN=32,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1004,HOSTIPADDRESS="10.119.189.210",MASKLEN=32,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1005,HOSTIPADDRESS="10.119.173.212",MASKLEN=32,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1006,HOSTIPADDRESS="10.119.189.212",MASKLEN=32,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1051,HOSTIPADDRESS="2409:800b:5003:1705:1::101",MASKLEN=128,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1052,HOSTIPADDRESS="2409:801d:5003:1704:5::5201",MASKLEN=128,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1053,HOSTIPADDRESS="2409:800b:5003:1705:1::301",MASKLEN=128,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1054,HOSTIPADDRESS="2409:801d:5003:1704:5::5401",MASKLEN=128,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1055,HOSTIPADDRESS="2409:800b:5003:1705:1::501",MASKLEN=128,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1056,HOSTIPADDRESS="2409:801d:5003:1704:5::5601",MASKLEN=128,HOSTTYPE="SMF",ADJHOSTGRPID=11 
省内通配ADD ADJHOSTIP:ADJHOSTID=1101,HOSTIPADDRESS="10.124.74.192",MASKLEN=28,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1102,HOSTIPADDRESS="10.124.56.176",MASKLEN=28,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1103,HOSTIPADDRESS="2409:8069:5003:1805:0000:0000:0122:0000",MASKLEN=112,HOSTTYPE="SMF",ADJHOSTGRPID=11ADD ADJHOSTIP:ADJHOSTID=1104,HOSTIPADDRESS="2409:8073:5003:1803:0000:0000:0122:0000",MASKLEN=112,HOSTTYPE="SMF",ADJHOSTGRPID=11 
省外通配ADD ADJHOSTIP:ADJHOSTID=1201,HOSTIPADDRESS="10.0.0.0",MASKLEN=8,HOSTTYPE="SMF",ADJHOSTGRPID=12ADD ADJHOSTIP:ADJHOSTID=1202,HOSTIPADDRESS="2409::0",MASKLEN=16,HOSTTYPE="SMF",ADJHOSTGRPID=12 
增加承载能力。 
[ADD BEARABILITY]:ADJHOSTGRPID=10,INTERFACE="PGW",SERVMODE="APPID",EXTENDBW="YES"
[ADD BEARABILITY]:ADJHOSTGRPID=11,INTERFACE="PGW",SERVMODE="APPID",EXTENDBW="YES"
[ADD BEARABILITY]:ADJHOSTGRPID=12,INTERFACE="PGW",SERVMODE="APPID",EXTENDBW="YES"
#### 配置BSF对接数据 
Nbsf是BSF提供的服务化接口，PCF调用该接口，注册、更新、去注册绑定信息。绑定信息包含UE标识、DNN、UE IP地址及PDU会话所选PCF信息。 
PCF支持动态发现BSF或者静态配置BSF。2种配置方式2选1即可，优先选择动态发现BSF配置方式。 
运营商|配置策略|配置说明
---|---|---
中国移动|无需配置|BSF融合部署，SMF内置BSF功能。PCF不需要和BSF交互，由融合部署网元SMF注册、更新、去注册绑定信息。
中国联通|需要配置|BSF独立部署。PCF调用Nbsf接口（BSF提供的服务化接口）注册、更新、去注册绑定信息。动态发现BSF网络中有NRF，PCF通过NRF动态发现BSF。静态配置BSF网络中无NRF，通过静态配置对接BSF。
中国电信|需要配置|BSF独立部署。PCF调用Nbsf接口（BSF提供的服务化接口）注册、更新、去注册绑定信息。动态发现BSF网络中有NRF，PCF通过NRF动态发现BSF。静态配置BSF网络中无NRF，通过静态配置对接BSF。
##### 配置动态发现BSF 
摘要 :本节介绍动态发现BSF的对接数据配置。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD SVCHTTPCLTPROF]命令，新增关联HTTP客户端模板配置。
参数说明参见[表1]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|记录标识|唯一标识一条关联HTTP客户端模板配置信息。
SERVICETYPE|服务类型|选择服务类型NBSF_MGT。
HTTP4CLTID|HTTP IPv4模板ID|填写HTTP IPv4模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTP6CLTID|HTTP IPv6模板ID|填写HTTP IPv6模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTPS4CLTID|HTTPS IPv4模板ID|填写HTTPS IPv4模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTTPS6CLTID|HTTPS IPv6模板ID|填写HTTPS IPv6模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTURI|URI中主机类型|选择URI中主机类型。IP：表示主机类型为IP类型。FQDN：表示主机类型为FQDN。
执行[ADD DNNBSF]命令，新增DNN启用BSF配置。
[ADD DNNBSF]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
DNN|DNN|配置需要开启向BSF注册绑定信息的DNN。带语音业务的局点需要配置相应的DNN启用BSF，正常要包含SHOW EMERGAPN中配置的所有APN。
BSF|启用BSF|配置为启用，表示PCF需要向BSF注册N7会话绑定信息（即建立来自该DNN的N7会话和PCF的关联关系）。
配置服务发现方式。 
[配置NRF服务器]步骤8中已经配置了ALL的配置，此处无需再配置。
执行[ADD SBISUBCOND]命令，新增订阅条件配置。
[ADD SBISUBCOND]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
ID|ID|该参数用于设置订阅条件编号。
TARGETNFTYPE|目的NF类型|该参数用于设置目的NF类型。
CONDTYPE|条件类型|该参数用于设置订阅条件类型。
CONDVALUE|条件值|该参数用于设置订阅条件值。
EVENTTYPE|事件类型|该参数用于设置订阅事件类型。
配置Diameter链路。 
 说明： 
AF/NEF选择Rx接口和PCF交互时，PCF需要配置到BSF的Diameter链路。 
AF/NEF选择N5服务化接口和PCF交互时，PCF无需配置到BSF的Diameter链路。 
执行[ADD SCTP]命令，新增到BSF的SCTP偶联。每套BSF建议2条偶联。
执行[ADD DIM RCPLINK]命令，新增到BSF的Diameter链路。每套BSF建议2条链路。
执行[ADD DIM ROUTEGRPPTY]命令，新增Diameter路由组。
执行[ADD DIM ROUTE]命令，新增Diameter路由。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增关联HTTP客户端模板配置。 
[ADD SVCHTTPCLTPROF]:ID=5,SERVICETYPE="NBSF_MGT",HTTP4CLTID=2,HTTP6CLTID=1,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
新增DNN启用BSF配置。 
[ADD DNNBSF]:DNN="ims",BSF="ENABLE"
[ADD DNNBSF]:DNN="sos",BSF="ENABLE"
[ADD DNNBSF]:DNN="emergency",BSF="ENABLE"
新增订阅条件配置。 
[ADD SBISUBCOND]:ID=1,TARGETNFTYPE="BSF_TYPE",CONDTYPE="COND_SERVNAME",CONDVALUE="\"nbsf-anagement\"",EVENTTYPE="EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"
Diameter配置。 
新增SCTP偶联。 
 说明： 
BSF采用负荷分担方式组网，每套BSF建议配置2条偶联。 
配置到BSF1的SCTP偶联： 
[ADD SCTP]:ID=501,NAME="SJBSF01BAL-SCTP01",LOCPORT=4161,REMPORT=6354,VPNID1=11,LOCADDR1="10.119.173.145",REMADDR1="10.120.246.171",VPNID2=11,LOCADDR2="10.119.173.146",REMADDR2="10.120.246.43",ROLE="CLT",PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=502,NAME="SJBSF01BAL-SCTP02",LOCPORT=4162,REMPORT=6355,VPNID1=11,LOCADDR1="10.119.173.146",REMADDR1="10.120.246.99",VPNID2=11,LOCADDR2="10.119.173.145",REMADDR2="10.120.246.227",ROLE="CLT",PROTOCALTYPE="DIAMETER"
配置到BSF2的SCTP偶联： 
[ADD SCTP]:ID=551,NAME="SJBSF02BAL-SCTP01",LOCPORT=4161,REMPORT=6354,VPNID1=11,LOCADDR1="10.119.173.145",REMADDR1="10.120.245.203",VPNID2=11,LOCADDR2="10.119.173.146",REMADDR2="10.120.245.75",ROLE="CLT",PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=552,NAME="SJBSF02BAL-SCTP02",LOCPORT=4162,REMPORT=6355,VPNID1=11,LOCADDR1="10.119.173.146",REMADDR1="10.120.245.99",VPNID2=11,LOCADDR2="10.119.173.145",REMADDR2="10.120.245.227",ROLE="CLT",PROTOCALTYPE="DIAMETER"
新增Diameter链路。 
配置到BSF1的Diameter链路： 
[ADD DIM RCPLINK]:LINKNO=501,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF01BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=501,PROTOCOL="SCTP",NAME="BSF1-1"
[ADD DIM RCPLINK]:LINKNO=502,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF01BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=502,PROTOCOL="SCTP",NAME="BSF1-2"
配置到BSF2的Diameter链路： 
[ADD DIM RCPLINK]:LINKNO=551,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF02BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=551,PROTOCOL="SCTP",NAME="BSF2-1"
[ADD DIM RCPLINK]:LINKNO=552,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF02BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=552,PROTOCOL="SCTP",NAME="BSF2-2"
新增Diameter路由组。 
 说明： 
AF有几个域名配置几个路由组。 
[ADD DIM ROUTEGRPPTY]:GROUPNO=51,GROUPNAME="BSF-Rx",GROUPPTY="LOADBALANCE"
新增Diameter路由。 
[ADD DIM ROUTE]:ROUTENO=501,MASTERLINKNO=501,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
[ADD DIM ROUTE]:ROUTENO=502,MASTERLINKNO=502,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
[ADD DIM ROUTE]:ROUTENO=551,MASTERLINKNO=551,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
[ADD DIM ROUTE]:ROUTENO=552,MASTERLINKNO=552,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
##### 配置静态BSF对接数据 
摘要 :本节介绍ZXUN RCP与和静态BSF对接数据的配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD SVCHTTPCLTPROF]命令，新增关联HTTP客户端模板配置。
参数说明参见[表1]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|记录标识|唯一标识一条关联HTTP客户端模板配置信息。
SERVICETYPE|服务类型|选择服务类型NBSF_MGT。
HTTP4CLTID|HTTP IPv4模板ID|填写HTTP IPv4模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTP6CLTID|HTTP IPv6模板ID|填写HTTP IPv6模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTPS4CLTID|HTTPS IPv4模板ID|填写HTTPS IPv4模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTPS6CLTID|HTTPS IPv6模板ID|填写HTTPS IPv6模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTURI|URI中主机类型|选择URI中主机类型。IP：表示主机类型为IP类型。FQDN：表示主机类型为FQDN。
执行[ADD DNNBSF]命令，新增DNN启用BSF配置。
[ADD DNNBSF]命令的参数填写说明参见[表2]。
参数|参数名称|填写说明
---|---|---
DNN|DNN|配置需要开启向BSF注册绑定信息的DNN。带语音业务的局点需要配置相应的DNN启用BSF，正常要包含SHOW EMERGAPN中配置的所有APN。
BSF|启用BSF|配置为启用，表示PCF需要向BSF注册N7会话绑定信息（即建立来自该DNN的N7会话和PCF的关联关系）。
执行[ADD SBISRVDISCOVERYMODE]配置服务发现方式。
[ADD SBISRVDISCOVERYMODE]命令的参数填写说明参见[表3]。
参数|参数名称|填写说明
---|---|---
TARGETNFTYPE|目标NF类型|该参数用于设置目标NF类型。
DISCOVERYMODE|发现方式|该参数用于设置服务发现方式。需要配置1个发现方式为静态的BSF的记录。
IPSELECTMODE|地址选择方式|该参数用于设置地址选择方式，默认为随机。
配置BSF服务信息。 
（可选）配置IPv4地址范围组。 
 说明： 
如果不需要通过终端的IPv4地址区分BSF，可以不配。 
执行[ADD SBIIPV4ADDRRANGEARRID]命令，新增终端IPv4地址范围组编号。
执行[ADD SBIIPV4ADDRRANGEARRPARAM]命令，新增终端IPv4地址范围组参数，设置IPv4起止地址。
（可选）配置IPv6地址范围组。 
 说明： 
如果不需要通过终端的IPv6地址区分BSF，可以不配。 
执行[ADD SBIIPV6PREFIXRANGEARRID]命令，新增终端IPv6前缀范围组编号。
执行[ADD SBIIPV6PREFIXRANGEARRPARAM]命令，新增终端IPv6前缀范围组参数，设置IPv6起止前缀。
（可选）配置IPv4域组。 
 说明： 
如果不配置，则BSF可以服务于任何IP域。 
执行[ADD SBIDOMAINARRID]命令，新增域组编号。
执行[ADD SBIDOMAINARRPARAM]命令，新增域组编号参数。
（可选）配置DNN组。 
 说明： 
如果不需要通过终端的DNN区分BSF，可以不配。 
执行[ADD SBIDNNARRID]命令，新增终端DNN组编号。
执行[ADD SBIDNNARRPARAM]命令，新增终端DNN组编号参数。
执行[ADD SBIBSFINFO]命令，新增BSF信息配置。
[ADD SBIBSFINFO]命令的参数填写说明参见[表4]。
参数|参数名称|填写说明
---|---|---
ID|BSF信息编号|该参数用于设置BSF信息编号。
IPV4RNGARRAY|IPv4 地址范围组编号|IPv4 地址范围组编号，指BSF处理的IPv4地址范围的列表。该编号可以通过SHOW SBIIPV4ADDRRANGEARRID命令查询。
IPDOMAINARRAY|IPv4 域名组编号|IPv4 域名组编号，指由BSF处理的IPv4地址域列表。该编号可以通过SHOW SBIDOMAINARRID命令查询。 如果未配置，则BSF可以服务于任何IP域。
IPV6PREFIXRNGARRAY|IPv6 前缀范围组编号|IPv6 前缀范围组编号，指BSF可以处理的IPv6前缀范围的列表。该编号通过SHOW SBIIPV6PREFIXRANGEARRID命令查询。
DNNARRAY|DNN组编号|DNN组编号，指BSF处理的DNN列表。 DNN必须包含网络标识符，并且可以另外包含一个运营商标识符。如果不包括运营商标识符，则NF配置文件的plmnList中的所有PLMN都支持DNN。 该编号通过SHOW SBIDNNARRID命令查询。如果未配置，则BSF可以服务于任何DNN。
配置BSF网元信息。 
（可选）执行[ADD SBIIPV4ADDR]命令，新增BSF的IPv4地址。
（可选）执行[ADD SBIIPV6ADDR]命令，新增BSF的IPv6地址。
执行[ADD SBIIPENDPOINT]命令，新增BSF的IP端点配置。
[ADD SBIIPENDPOINT]命令的参数填写说明参见[表5]。
参数|参数名称|填写说明
---|---|---
INDEX|IP端点编号|该参数用于设置IP端点编号。
IPV4|IPv4地址编号|该参数用于设置BSF的IPv4地址编号，IPv4地址编号通过SHOW SBIIPV4ADDR命令查询。
IPV6|IPv6地址编号|该参数用于设置BSF的IPv6地址编号，IPv6地址编号通过SHOW SBIIPV6ADDR命令查询。
PORT|端口|该参数用于设置端口号。
执行[ADD SBIIPENDPOINTARRID]命令，新增IP端点组编号配置。
执行[ADD SBIIPENDPOINTARRPARAM]命令。新增IP端点组参数配置。
[ADD SBIIPENDPOINTARRPARAM]命令的参数填写说明参见[表6]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
ARRAYID|IP端点组编号|该参数用于设置IP端点组编号，IP端点组编号通过SHOW SBIIPENDPOINTARRID命令查询。
IPENDPOINT|IP端点编号|该参数用于设置IP端点编号，IP端点编号通过SHOW SBIIPENDPOINT命令查询。
执行[ADD SBINFSVERSIONARRID]命令，新增NF服务版本组编号配置。
执行[ADD SBINFSVERSIONARRPARAM]命令，新增NF服务版本组参数配置。
[ADD SBINFSVERSIONARRPARAM]命令的参数填写说明参见[表7]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
ARRAYID|NF服务版本组编号|该参数用于设置NF服务版本组编号，NF服务版本组编号通过SHOW SBINFSVERSIONARRID命令查询。
APIVERSIONINURI|API URI版本号|该参数用于设置API URI版本号，即访问API的URI中使用的服务实例的版本号。
APIFULLVERSION|API完整版本号|该参数用于设置API的完整版本号，建议格式为以“.”分隔、至少分为3段的字符串。
执行[ADD SBIPEERNFBASEINFO]命令，新增NF基本信息配置。
[ADD SBIPEERNFBASEINFO]命令的参数填写说明参见[表8]。
参数|参数名称|填写说明
---|---|---
ID|对端NF信息编号|该参数用于设置NF基本信息编号，该编号是NF基本信息配置的唯一标识。
NFINSTANCEID|NF实例标识|该参数用于设置NF实例的唯一标识。必须全局范围内唯一。
NFTYPE|NF类型|该参数用于设置NF类型。选择BSF。
NFSTATUS|NF状态|该参数用于设置NF实例的状态。INVALID：NF实例的状态为INVALID。REGISTERED：NF实例的状态为REGISTERED。表示NF实例已在NRF中注册，并且可以被其他NF发现。SUSPENDED：NF实例的状态为SUSPENDED。表示NF实例已在NRF中注册，但无法运行，无法被其他NF发现。UNDISCOVERABLE：NF实例的状态为UNDISCOVERABLE。表示NF实例已在NRF中注册，可以运行，但是无法被其他NF发现。
NFINSTANCENAME|NF实例名称|该参数用于设置NF实例的可读名称，方便操作人员识别。
PLMNLARRAY|PLMN ID组编号|该参数用于设置PLMN ID组编号，表示可用于该NF的公共陆地移动网（PLMN）。PLMN ID组编号通过SHOW SBIPLMNIDARRID命令查询。
PLMNNIDARRAY|PLMN NID组编号|该参数用于设置PLMN NID组编号，表示可用于该NF的独立非公共网络（SNPN）。PLMN NID组编号通过SHOW SBIPLMNNIDARRID命令查询。
SNSSAIARRAY|S-NSSAI组编号|该参数用于设置S-NSSAI组编号，表示可用于该NF的单个网络切片选择协助信息（S-NSSAI）。如果未设置，则NF可以服务于任何S-NSSAI。S-NSSAI组编号通过SHOW SBISNSSAIARRID命令查询。
PLMNSNSSAIARRAY|PLMN S-NSSAI组编号|该参数用于设置PLMN S-NSSAI组编号，表示NF所支持的每个公共陆地移动网（PLMN）支持的单个网络切片选择协助信息（S-NSSAI）。如果设置了该参数，则将覆盖S-NSSAI组数据，这是用于NF（例如AMF）支持多个PLMN并且每个PLMN中支持的切片不同的场景。PLMN S-NSSAI组编号通过SHOW SBIPIMNSNSSAIARRID命令查询。
NSIARRAY|NSI组编号|该参数用于设置NSI组编号，表示NF可以服务的网络切片实例（NSI）。如果未设置，则NF可以服务任何NSI。NSI组编号通过SHOW SBINSIARRID命令查询。
FQDN|域名|该参数用于设置完全合格的域名（FQDN），表示该PLMN的FQDN。
INTERPLMNFQDN|PLMN间域名|该参数用于设置可用于公共陆地移动网（PLMN）间路由的域名，如果NF需要由不同PLMN中的其他NF发现，则必须将用于PLMN间路由的完全合格的域名（FQDN）注册到NRF。
IPV4ARRAY|IPv4地址组编号|该参数用于设置IPv4地址组编号，表示该NF的IPv4地址。IPv4地址组编号通过SHOW SBIIPV4ADDRARRID命令查询。
IPV6ARRAY|IPv6地址组编号|该参数用于设置IPv6地址组编号，表示该NF的IPv6地址。IPv6地址组编号通过SHOW SBIIPV6ADDRARRID命令查询。
ALLOWPLMN|允许的PLMN ID组编号|该参数用于设置允许的PLMN ID组编号，表示允许访问NF实例的公共陆地移动网（PLMN）。如果未设置，则允许任何PLMN访问NF。允许的PLMN ID组编号通过SHOW SBIPLMNIDARRID命令查询。
ALLOWPLMNNID|允许的PLMN NID组编号|该参数用于设置允许的PLMN NID组编号，表示允许访问NF实例的独立非公共网络（SNPN）。如果NF服务（NFService）和NF配置文件（NFProfile）中存在此属性，则以NFService中的属性为准。NFService和NFProfile中均缺少此属性，表示除NFProfile的SNPN列表属性中注册的SNPN之外，不允许任何SNPN访问服务实例。允许的PLMN NID组编号通过SHOW SBIPLMNNIDARRID命令查询。
ALLOWNFTYPE|允许的NF类型组编号|该参数用于设置允许的NF类型组编号，表示允许访问NF实例的NF类型。如果未设置，则允许任何NF类型访问NF。允许的NF类型组编号通过SHOW SBINFTYPEARRID命令查询。
ALLOWNDOMAIN|允许的域组编号|该参数用于设置允许的域组编号，表示允许访问NF实例的NF域名。如果未设置，则允许任何NF域访问NF。允许的域组编号通过SHOW SBIDOMAINARRID命令查询。
ALLOWSNSSAI|允许的S-NSSAI组编号|该参数用于设置允许的S-NSSAI组编号，表示允许访问NF实例的单个网络切片选择协助信息（S-NSSAI）。如果未设置，则允许任何切片访问NF。允许的S-NSSAI组编号通过SHOW SBISNSSAIARRID命令查询。
CAPACITY|容量|该参数用于设置静态容量信息，表示为相对于其他相同类型NF实例的权重。如果有多个不同的NF配置文件（NFProfile）都携带了该参数，则服务使用者应该按照权重来负荷分担地访问NF服务提供者。如果NF服务列表（NFServiceList）参数中也存在容量参数，则NF服务的容量将优先于该值。
PRIORITY|优先级|该参数用于设置优先级，用于NF选择；较低的值表示较高的优先级。 如果有多个不同的NF配置文件（NFProfile）都携带了该参数，则服务使用者始终选择优先级最高的NFProfile。如果NF服务列表（NFServiceList）参数中也存在优先级参数，则NF服务的优先级将优先于该值。
LOCALITY|地区|该参数用于设置运营商定义的有关NF实例位置的信息。
NFSETIDARRAY|NF集标识组编号|该参数用于设置NF集标识组编号，表示NF集标识（NF Set ID）。每个NF的公共陆地移动网（PLMN）最多指示一个NF Set ID。NF集标识组编号通过SHOW SBINFSETIDARRID命令查询。
NFSERVPERSISTENCE|是否支持资源在NF服务实例间共享|该参数用于设置是否支持资源在NF服务实例间共享，如果设置为是，则表示该NF实例中支持相同API版本的同一NF服务（NFService）的不同服务实例能够将其资源状态保持在共享存储中，因此这些资源可用在NF服务使用者选择了支持相同API版本的新NF服务实例之后。如果设置为否，它表示同一NF服务的NF服务实例无法共享NF实例内部的资源状态。
LCHSUPPORTIND|是否支持基于LCI头域的负荷控制|该参数用于设置是否支持基于负载控制信息（LCI）头域的负载控制。
OLCHSUPPORTIND|是否支持基于OCI头域的过载控制|该参数用于设置是否支持基于过载控制信息（OCI）头域的过载控制。
DLFTNOTIFICATIONARR|缺省通知端点组编号|该参数用于设置缺省通知端点组编号，表示不同通知类型的通知端点。缺省通知端点组编号通过SHOW SBIDLFTNOTEENDPOINTARRID命令查询。
SERVSCOPEARRAY|服务范围组编号|该参数用于设置服务范围组编号，表示NF实例的服务区域。注意，该参数若不设置并不意味着NF实例可以服务公共陆地移动网（PLMN）中的每个区域。服务范围组编号通过SHOW SBISERVSCOPEARRID命令查询。
执行[ADD SBIPEERNFEXTINFO]命令，新增NF扩展信息配置。
[ADD SBIPEERNFEXTINFO]命令的参数填写说明参见[表9]。
参数|参数名称|填写说明
---|---|---
ID|对端NF信息编号|该参数用于设置对端NF扩展信息关联的对端NF信息编号，该编号通过SHOW SBIPEERNFBASEINFO命令查询。
BSFINFO|BSF信息编号|该参数用于设置BSF信息编号，BSF信息编号通过SHOW SBIBSFINFO命令查询。
执行[ADD SBIPEERNFSERVICEINSTANCE]命令，新增对端NF服务实例配置。
[ADD SBIPEERNFSERVICEINSTANCE]命令的参数填写说明参见[表10]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
NFINDEX|归属NF编号|该参数用于设置归属NF编号，NF编号通过SHOW SBIPEERNFBASEINFO命令查询。
SRVINSTANCEID|服务实例标识|该参数用于设置服务实例标识，是给定NF实例中服务实例的唯一ID。
SERVICENAME|服务名称|该参数用于设置服务实例的名称。
SERVICEVERSIONARRAY|服务版本组编号|该参数用于设置服务版本组编号，该编号通过SHOW SBINFSVERSIONARRID命令查询。
SCHEME|协议模式|该参数用于设置协议模式，（例如，“http”，“https”）。
NFSERVICESTATUS|服务实例状态|该参数用于设置服务实例的状态。
FQDN|域名|该参数用于设置NF实例的FQDN。
INTERPLMNFQDN|PLMN间域名|该参数用于设置PLMN间的FQDN，如果NF服务需要由不同PLMN中的其他NF发现，则可以将用于PLMN间路由的FQDN注册到NRF。
IPENDPOINTARRAY|IP端点组编号|该参数用于设置IP端点组编号，该编号通过SHOW SBIIPENDPOINTARRID命令查询。
APIPREFIX|API路径前缀|该参数用于设置API路径前缀，为可选路径段，用于构建不同API URI的{apiRoot}变量。
DLFTNOTIFICATEARRAY|缺省通知端点组编号|该参数用于设置缺省通知端点组编号，该编号通过SHOW SBIDLFTNOTEENDPOINTARRID命令查询。
ALLOWPLMN|允许的PLMN组编号|该参数用于设置允许的PLMN组编号，该编号通过SHOW SBIPLMNIDARRID命令查询。
ALLOWPLMNNID|允许的PLMN NID组编号|该参数用于设置允许的PLMN NID组编号，该编号通过SHOW SBIPLMNNIDARRID命令查询。
ALLOWNFTYPE|允许的NF类型组编号|该参数用于设置允许的NF类型组编号，该编号通过SHOW SBINFTYPEARRID命令查询。
ALLOWNDOMAIN|允许的域组编号|该参数用于设置允许的域组编号，该编号通过SHOW SBIDOMAINARRID命令查询。
ALLOWSNSSAI|允许的S-NSSAI组编号|该参数用于设置允许的S-NSSAI组编号，该编号通过SHOW SBISNSSAIARRID命令查询。
CAPACITY|容量|该参数用于设置静态容量信息，表示为相对于相同类型其他服务的权重。
PRIORITY|优先级|该参数用于设置优先级（相对于其他相同类型的服务），用于NF服务选择。较低的值表示较高的优先级。
SUPPORTEDFEATURES|支持的特性|该参数用于设置服务实例支持的特性。
PRIMARYCHFSRVINST|首选CHF服务实例|该参数用于设置首选CHF服务实例。
SECONDCHFSRVINST|次选CHF服务实例|该参数用于设置次选CHF服务实例。
NFSERVICESETARRAY|NF服务集组编号|该参数用于设置NF服务集组编号，该编号通过SHOW SBINFSSETIDARRID命令查询。
SNSSAIARRAY|S-NSSAI组编号|该参数用于设置S-NSSAI组编号，该编号通过SHOW SBISNSSAIARRID命令查询。
PLMNSNSSAIARRAY|PLMN S-NSSAI组编号|该参数用于设置PLMN S-NSSAI组编号，该编号通过SHOW SBIPIMNSNSSAIARRID命令查询。
配置Diameter。 
 说明： 
AF/NEF选择Rx接口和PCF交互时，PCF需要配置到BSF的Diameter链路。 
AF/NEF选择N5服务化接口和PCF交互时，PCF无需配置到BSF的Diameter链路。 
执行[ADD SCTP]命令，新增到BSF的SCTP偶联。每套BSF建议配置2条偶联。
执行[ADD DIM RCPLINK]命令，新增到BSF的Diameter链路。每套BSF建议配置2条链路。
执行[ADD DIM ROUTEGRPPTY]命令，新增Diameter路由组。
执行[ADD DIM ROUTE]命令，新增Diameter路由。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增关联HTTP客户端模板配置。 
[ADD SVCHTTPCLTPROF]:ID=5,SERVICETYPE="NBSF_MGT",HTTP4CLTID=2,HTTP6CLTID=1,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
新增DNN启用BSF配置。 
[ADD DNNBSF]:DNN="ims",BSF="ENABLE"
[ADD DNNBSF]:DNN="sos",BSF="ENABLE"
[ADD DNNBSF]:DNN="emergency",BSF="ENABLE"
新增服务发现方式配置。 
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="BSF_TYPE",DISCOVERYMODE="STATIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=80,DEFAULTPORTFORHTTPS=443
新增BSF服务信息配置。 
[ADD SBIIPV4ADDRRANGEARRID]:ARRAYID=1
[ADD SBIIPV4ADDRRANGEARRPARAM]:INDEX=1,ARRAYID=1,START="192.168.0.1",END="192.168.0.254"
[ADD SBIIPV6PREFIXRANGEARRID]:ARRAYID=1
[ADD SBIIPV6PREFIXRANGEARRPARAM]:INDEX=1,ARRAYID=1,START="240e:6a:cf4a:24::/64",END="240e:6a:cf4a:24:ffff:ffff:ffff:ffff/64"
[ADD SBIDNNARRID]:ARRAYID=1
[ADD SBIDNNARRPARAM]:INDEX=1,ARRAYID=1,DNN="ims"
[ADD SBIDNNARRPARAM]:INDEX=2,ARRAYID=1,DNN="sos"
[ADD SBIDNNARRPARAM]:INDEX=3,ARRAYID=1,DNN="emergency"
[ADD SBIBSFINFO]:ID=1,IPV4RNGARRAY=1,IPV6PREFIXRNGARRAY=1,DNNARRAY=1
新增BSF网元信息配置。 
[ADD SBIIPV4ADDR]:ID=1,IP="10.251.68.196"
[ADD SBIIPV6ADDR]:ID=1,IP="240e:180:2e1:ff00::37"
[ADD SBIIPENDPOINT]:INDEX=1,IPV4=1,PORT=80
[ADD SBIIPENDPOINT]:INDEX=2,IPV6=1,PORT=80
[ADD SBIIPENDPOINTARRID]:ARRAYID=1
[ADD SBIIPENDPOINTARRPARAM]:INDEX=1,ARRAYID=1,IPENDPOINT=1 
[ADD SBIIPENDPOINTARRPARAM]:INDEX=2,ARRAYID=1,IPENDPOINT=2 
[ADD SBINFSVERSIONARRID]:ARRAYID=100
[ADD SBINFSVERSIONARRPARAM]:INDEX=100,ARRAYID=100,APIVERSIONINURI="v1",APIFULLVERSION="1.1.0.alpha-1"
[ADD SBIPEERNFBASEINFO]:ID=1,NFINSTANCEID="1",NFTYPE="BSF_TYPE",NFSTATUS="REGISTERED",PRIORITY=10
[ADD SBIPEERNFEXTINFO]:ID=1,BSFINFO=1
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=1,NFINDEX=1,SRVINSTANCEID="1",SERVICENAME="NBSF_MANAGEMENT",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",IPENDPOINTARRAY=1,PRIORITY=10
Diameter配置。 
新增SCTP偶联。 
 说明： 
BSF采用负荷分担方式组网，每套BSF建议配置2条偶联。 
配置到BSF1的SCTP偶联： 
[ADD SCTP]:ID=201,NAME="SJBSF01BAL-SCTP01",LOCPORT=4161,REMPORT=6354,VPNID1=11,LOCADDR1="10.119.173.145",REMADDR1="10.120.246.171",VPNID2=11,LOCADDR2="10.119.173.146",REMADDR2="10.120.246.43",ROLE="CLT",PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=202,NAME="SJBSF01BAL-SCTP02",LOCPORT=4162,REMPORT=6355,VPNID1=11,LOCADDR1="10.119.173.146",REMADDR1="10.120.246.99",VPNID2=11,LOCADDR2="10.119.173.145",REMADDR2="10.120.246.227",ROLE="CLT",PROTOCALTYPE="DIAMETER"
配置到BSF2的SCTP偶联： 
[ADD SCTP]:ID=251,NAME="SJBSF02BAL-SCTP01",LOCPORT=4161,REMPORT=6354,VPNID1=11,LOCADDR1="10.119.173.145",REMADDR1="10.120.245.203",VPNID2=11,LOCADDR2="10.119.173.146",REMADDR2="10.120.245.75",ROLE="CLT",PROTOCALTYPE="DIAMETER"
[ADD SCTP]:ID=252,NAME="SJBSF02BAL-SCTP02",LOCPORT=4162,REMPORT=6355,VPNID1=11,LOCADDR1="10.119.173.146",REMADDR1="10.120.245.99",VPNID2=11,LOCADDR2="10.119.173.145",REMADDR2="10.120.245.227",ROLE="CLT",PROTOCALTYPE="DIAMETER"
新增Diameter链路。 
配置到BSF1的Diameter链路： 
[ADD DIM RCPLINK]:LINKNO=501,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF01BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=501,PROTOCOL="SCTP",NAME="BSF1-1"
[ADD DIM RCPLINK]:LINKNO=502,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF01BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=502,PROTOCOL="SCTP",NAME="BSF1-2"
配置到BSF2的Diameter链路： 
[ADD DIM RCPLINK]:LINKNO=551,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF02BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=551,PROTOCOL="SCTP",NAME="BSF2-1"
[ADD DIM RCPLINK]:LINKNO=552,LOCALHOSTNAME="APP-HBBADhePCF001PCRF001BZX-05AZX011.bad.he.node.epc.mnc000.mcc460.3gppnetwork.org",LOCALREALM="epc.mnc000.mcc460.3gppnetwork.org",DSTHOSTNAME="SJBSF02BAL.sj.he.node.epc.mnc000.mcc460.3gppnetwork.org",DSTREALM="epc.mnc000.mcc460.3gppnetwork.org",ADJTYPE="AF",CONNID=552,PROTOCOL="SCTP",NAME="BSF2-2"
新增Diameter路由组。 
 说明： 
AF有几个域名配置几个路由组。 
[ADD DIM ROUTEGRPPTY]:GROUPNO=51,GROUPNAME="BSF-Rx",GROUPPTY="LOADBALANCE"
新增Diameter路由。 
[ADD DIM ROUTE]:ROUTENO=501,MASTERLINKNO=501,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
[ADD DIM ROUTE]:ROUTENO=502,MASTERLINKNO=502,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
[ADD DIM ROUTE]:ROUTENO=551,MASTERLINKNO=551,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
[ADD DIM ROUTE]:ROUTENO=552,MASTERLINKNO=552,ROUTEPRIORITY="LOW",ROUTEAPPID="Rx",DESTURI="epc.mnc000.mcc460.3gppnetwork.org",ROUTEGROUPNO=51
#### 配置CHF对接数据 
ZXUN RCP通过N28接口从CHF获取消费门限信息。
动态CHF配置通常PCF通过NRF发现CHF。使用NRF动态发现CHF时，PCF需订阅条件配置，PCF向NRF订阅CHF变更通知，以便在CHF信息变更或故障时NRF能及时通知PCF。 
静态CHF配置如果不支持动态发现，则通过静态配置对接信息。中国电信使用静态配置方式。 
 说明： 
目前仅中国电信部分省份开启PCF和CHF之间的N28接口。中国联通及中国移动均不使用N28接口。 
##### 配置动态发现CHF 
摘要 :本节介绍PCF通过NRF动态发现CHF的对接数据配置。
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD SBISUBCOND]命令，新增订阅条件配置。
参数填写说明参见[表1]。
参数|参数名称|填写说明
---|---|---
ID|ID|该参数用于设置订阅条件编号。
TARGETNFTYPE|目的NF类型|该参数用于设置目的NF类型。
CONDTYPE|条件类型|该参数用于设置订阅条件类型。
CONDVALUE|条件值|该参数用于设置订阅条件值
EVENTTYPE|事件类型|该参数用于设置订阅事件类型。
执行[ADD SVCHTTPCLTPROF]命令，新增关联HTTP客户端模板配置。
参数说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|记录标识|唯一标识一条关联HTTP客户端模板配置信息。
SERVICETYPE|服务类型|选择服务类型NCHF_SPENDLMTCONTROL。
HTTP4CLTID|HTTP IPv4模板ID|填写HTTP IPv4模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTP6CLTID|HTTP IPv6模板ID|填写HTTP IPv6模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTPS4CLTID|HTTPS IPv4模板ID|填写HTTPS IPv4模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTTPS6CLTID|HTTPS IPv6模板ID|填写HTTPS IPv6模板ID，关联“配置HTTP”中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTURI|URI中主机类型|选择URI中主机类型。IP：表示主机类型为IP类型。FQDN：表示主机类型为FQDN。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增订阅条件配置。 
[ADD SBISUBCOND]:ID=2,TARGETNFTYPE="CHF_TYPE",CONDTYPE="COND_NFTYPE",CONDVALUE="\"CHF\"",EVENTTYPE="EVENT_REGISTERED"&"EVENT_DEREGISTERED"&"EVENT_CHANGED"
关联客户端模板配置。 
[ADD SVCHTTPCLTPROF]:ID=4,SERVICETYPE="NCHF_SPENDLMTCONTROL",HTTP4CLTID=2,HTTP6CLTID=1
##### 配置静态CHF对接数据 
摘要 :本节介绍PCF与静态CHF对接数据的配置。
中国电信的CHF通常不在5GC的SBI网络平面，需要在CHF网络平面新增客户端模板、新增服务端模板、新增通知URI服务端模板配置。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
执行[ADD CLIENTPROFILE]命令，新增客户端模板配置。
CHF平面新增客户端模板配置参数说明参见[表1]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|编号|客户端模板ID。
IPADDR|IP地址|客户端地址和服务端地址合一。
STARTPORT|起始端口|保持默认配置：10000。
ENDPORT|终止端口|保持默认配置：60000。
VPNID|VPN ID|CHF平面的VPNID。
CONNNUM|链路数量|保持默认配置：1，当弹性链路开关打开时，会根据链路负荷自行弹缩。
CONNELASTIC|弹性链路开关|保持默认配置：打开。
KEEPALIVESWITCH|链路保活开关|保持默认配置：打开。
RESPBODYMAXLENGTH|接收响应消息体最大长度(字节）|保持默认配置：2097152。
HTTPVERSION|HTTP版本|保持默认配置：HTTP2。
执行[ADD SERVERPROFILE]命令，新增服务端模板配置。
CHF平面新增服务端模板配置参数说明参见[表2]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|编号|服务端模板ID。
IPADDR|IP地址|客户端地址和服务端地址合一。
PORT|端口|服务端端口号，默认8080。根据运营商规划填写。
VPNID|VPN ID|CHF平面的VPNID。
KEEPALIVESWITCH|链路保活开关|保持默认配置打开。
REQBODYMAXLENGTH|接收请求消息体最大长度(字节）|保持默认配置2097152。
HTTPVERSION|HTTP版本|保持默认配置HTTP2。
执行[ADD SVCHTTPCLTPROF]命令，新增关联HTTP客户端模板配置。
参数说明参见[表3]。其他参数如无特殊要求，保持默认即可。
参数|参数名称|参数配置
---|---|---
ID|记录标识|唯一标识一条关联HTTP客户端模板配置信息。
SERVICETYPE|服务类型|选择服务类型。
HTTP4CLTID|HTTP IPv4模板ID|填写HTTP IPv4模板ID，关联中步骤2已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTP6CLTID|HTTP IPv6模板ID|填写HTTP IPv6模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTP模板进行建链。
HTTPS4CLTID|HTTPS IPv4模板ID|填写HTTPS IPv4模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTTPS6CLTID|HTTPS IPv6模板ID|填写HTTPS IPv6模板ID，关联步骤2中已配置的模板ID，用于指定PCF选用哪个HTTPS模板进行建链。
HTURI|URI中主机类型|选择URI中主机类型。IP：表示主机类型为IP类型。FQDN：表示主机类型为FQDN。
执行[ADD NOTIURISVRTPROF]命令，新增通知URI服务端模板配置。
 说明： 
中国电信CHF通常不在5GC的SBI网络平面，需要在CHF网络平面新增通知URI服务端模板配置，用于反向通知URL。 
参数填写说明参见[表4]。
参数|参数名称|填写说明
---|---|---
SERVICETYPE|服务类型|该参数用于设置与PCF交互的对端服务类型。Nchf_SpendingLimitControl：表示使用Nchf_SpendingLimitControl服务作为服务类型。Nudr_DataRepository：表示使用Nudr_DataRepository服务作为服务类型。
SVRID1|服务端模板ID1|配置第一个服务端模板ID。该参数必填。引用步骤3中配置的服务端模板ID。
SVRID2|服务端模板ID2|配置第二个服务端模板ID。默认是0，若配置两个服务端时可以填写该ID。
执行[ADD SBISRVDISCOVERYMODE]命令，新增服务发现方式配置。
配置参数说明参见[表5]。
参数|参数名称|参数配置
---|---|---
TARGETNFTYPE|目标NF类型|该参数用于设置目的NF类型。选择CHF。
DISCOVERYMODE|发现方式|该参数用于设置服务发现方式。静态CHF需要配置1条静态的特定目标NF类型的记录。
IPSELECTMODE|地址选择方式|该参数用于设置地址选择方式，默认为随机。可以配置随机、IPv4优先、IPv6优先，以实际业务为准。
新增GPSI范围组配置。 
执行[ADD SBIGPSIRANGEARRID]命令，新增GPSI范围组编号配置。
执行[ADD SBIGPSIRANGEARRPARAM]命令，新增GPSI范围组参数配置。
参数填写说明参见[表6]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
ARRAYID|GPSI范围组编号|该参数用于设置GPSI范围组编号，该编号通过SHOW SBIGPSIRANGEARRID命令查询。
START|开始|该参数用于设置GPSI范围开始的第一个值，当GPSI的范围可以表示为数字范围（例如MSISDN范围）时使用。该字符串应仅由数字组成。
END|结束|该参数用于设置GPSI范围结束的最后一个值，当GPSI的范围可以表示为数字范围（例如MSISDN范围）时使用。该字符串应仅由数字组成。
执行[ADD SBICHFINFO]命令，新增CHF服务信息配置。
参数填写说明参见[表7]。
参数|参数名称|填写说明
---|---|---
ID|CHF信息编号|该参数用于设置CHF信息编号。
GROUPID|NF组标识|该参数用于设置NF组标识，即CHF实例提供服务的CHF组的标识。如果未提供，则CHF实例不属于任何CHF组。
SUPIRANGEARRAY|SUPI范围组编号|该参数用于设置SUPI范围组编号，用于指定CHF实例可以服务的GPSI范围列表。如果未提供，则CHF可以服务于任何SUPI。该编号通过SHOW SBISUPIRANGEARRID命令查询。
GPSIRANGEARRAY|GPSI范围组编号|该参数用于设置GPSI范围组编号，用于指定CHF实例可以服务的GPSI范围列表。如果未提供，则CHF可以服务于任何GPSI。该编号通过SHOW SBIGPSIRANGEARRID命令查询。
PLMNRNGARRAY|PLMN范围组编号|该参数用于设置PLMN范围组编号，用于指定CHF实例可以服务的PLMN范围列表（包括CHF实例的PLMN ID）。如果未提供，则CHF可以为任何PLMN服务。该编号通过SHOW SBIPLMNRANGEARRID命令查询。
新增CHF网元信息配置。 
 说明： 
如果主、备CHF是集群模式，对PCF只有1个地址，则只配置1条记录；如有2个地址，则配置2条记录。 
执行[ADD SBIIPV4ADDR]命令，新增IPv4地址配置。
执行[ADD SBIIPV6ADDR]命令，新增IPv6地址配置。
执行[ADD SBIIPENDPOINT]命令，新增IP端点配置。
[ADD SBIIPENDPOINT]命令的参数填写说明参见[表8]。
参数|参数名称|填写说明
---|---|---
INDEX|IP端点编号|该参数用于设置IP端点编号。
IPV4|IPv4地址编号|该参数用于设置IPv4地址编号，IPv4地址编号通过SHOW SBIIPV4ADDR命令查询。
IPV6|IPv6地址编号|该参数用于设置IPv6地址编号，IPv6地址编号通过SHOW SBIIPV6ADDR命令查询。
PORT|端口|该参数用于设置端口号。
执行[ADD SBIIPENDPOINTARRID]命令，新增IP端点组编号配置。
执行[ADD SBIIPENDPOINTARRPARAM]命令。新增IP端点组参数配置。
[ADD SBIIPENDPOINTARRPARAM]命令的参数填写说明参见[表9]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
ARRAYID|IP端点组编号|该参数用于设置IP端点组编号，IP端点组编号通过SHOW SBIIPENDPOINTARRID命令查询。
IPENDPOINT|IP端点编号|该参数用于设置IP端点编号，IP端点编号通过SHOW SBIIPENDPOINT命令查询。
执行[ADD SBINFSVERSIONARRID]命令，新增NF服务版本组编号配置。
执行[ADD SBINFSVERSIONARRPARAM]命令，新增NF服务版本组参数配置。
[ADD SBINFSVERSIONARRPARAM]命令的参数填写说明参见[表10]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
ARRAYID|NF服务版本组编号|该参数用于设置NF服务版本组编号，NF服务版本组编号通过SHOW SBINFSVERSIONARRID命令查询。
APIVERSIONINURI|API URI版本号|该参数用于设置API URI版本号，即访问API的URI中使用的服务实例的版本号。
APIFULLVERSION|API完整版本号|该参数用于设置API的完整版本号，建议格式为以“.”分隔、至少分为3段的字符串。
执行[ADD SBIPEERNFBASEINFO]命令，新增对端NF基本信息配置。
[ADD SBIPEERNFBASEINFO]命令的参数填写说明参见[表11]。
参数|参数名称|填写说明
---|---|---
ID|对端NF信息编号|该参数用于设置对端NF基本信息编号，该编号是对端NF基本信息配置的唯一标识。
NFINSTANCEID|NF实例标识|该参数用于设置NF实例的唯一标识。必须全局范围内唯一。
NFTYPE|NF类型|选择CHF。
NFSTATUS|NF状态|该参数用于设置NF实例的状态。INVALID：NF实例的状态为INVALID。REGISTERED：NF实例的状态为REGISTERED。表示NF实例已在NRF中注册，并且可以被其他NF发现。SUSPENDED：NF实例的状态为SUSPENDED。表示NF实例已在NRF中注册，但无法运行，无法被其他NF发现。UNDISCOVERABLE：NF实例的状态为UNDISCOVERABLE。表示NF实例已在NRF中注册，可以运行，但是无法被其他NF发现。
NFINSTANCENAME|NF实例名称|该参数用于设置NF实例的可读名称，方便操作人员识别。
PLMNLARRAY|PLMN ID组编号|该参数用于设置PLMN ID组编号，表示可用于该NF的公共陆地移动网（PLMN）。PLMN ID组编号通过SHOW SBIPLMNIDARRID命令查询。
PLMNNIDARRAY|PLMN NID组编号|该参数用于设置PLMN NID组编号，表示可用于该NF的独立非公共网络（SNPN）。PLMN NID组编号通过SHOW SBIPLMNNIDARRID命令查询。
SNSSAIARRAY|S-NSSAI组编号|该参数用于设置S-NSSAI组编号，表示可用于该NF的单个网络切片选择协助信息（S-NSSAI）。如果未设置，则NF可以服务于任何S-NSSAI。S-NSSAI组编号通过SHOW SBISNSSAIARRID命令查询。
PLMNSNSSAIARRAY|PLMN S-NSSAI组编号|该参数用于设置PLMN S-NSSAI组编号，表示NF所支持的每个公共陆地移动网（PLMN）支持的单个网络切片选择协助信息（S-NSSAI）。如果设置了该参数，则将覆盖S-NSSAI组数据，这是用于NF（例如AMF）支持多个PLMN并且每个PLMN中支持的切片不同的场景。PLMN S-NSSAI组编号通过SHOW SBIPIMNSNSSAIARRID命令查询。
NSIARRAY|NSI组编号|该参数用于设置NSI组编号，表示NF可以服务的网络切片实例（NSI）。如果未设置，则NF可以服务任何NSI。NSI组编号通过SHOW SBINSIARRID命令查询。
FQDN|域名|该参数用于设置完全合格的域名（FQDN），表示该PLMN的FQDN。
INTERPLMNFQDN|PLMN间域名|该参数用于设置可用于公共陆地移动网（PLMN）间路由的域名，如果NF需要由不同PLMN中的其他NF发现，则必须将用于PLMN间路由的完全合格的域名（FQDN）注册到NRF。
IPV4ARRAY|IPv4地址组编号|该参数用于设置IPv4地址组编号，表示该NF的IPv4地址。IPv4地址组编号通过SHOW SBIIPV4ADDRARRID命令查询。
IPV6ARRAY|IPv6地址组编号|该参数用于设置IPv6地址组编号，表示该NF的IPv6地址。IPv6地址组编号通过SHOW SBIIPV6ADDRARRID命令查询。
ALLOWPLMN|允许的PLMN ID组编号|该参数用于设置允许的PLMN ID组编号，表示允许访问NF实例的公共陆地移动网（PLMN）。如果未设置，则允许任何PLMN访问NF。允许的PLMN ID组编号通过SHOW SBIPLMNIDARRID命令查询。
ALLOWPLMNNID|允许的PLMN NID组编号|该参数用于设置允许的PLMN NID组编号，表示允许访问NF实例的独立非公共网络（SNPN）。如果NF服务（NFService）和NF配置文件（NFProfile）中存在此属性，则以NFService中的属性为准。NFService和NFProfile中均缺少此属性，表示除NFProfile的SNPN列表属性中注册的SNPN之外，不允许任何SNPN访问服务实例。允许的PLMN NID组编号通过SHOW SBIPLMNNIDARRID命令查询。
ALLOWNFTYPE|允许的NF类型组编号|该参数用于设置允许的NF类型组编号，表示允许访问NF实例的NF类型。如果未设置，则允许任何NF类型访问NF。允许的NF类型组编号通过SHOW SBINFTYPEARRID命令查询。
ALLOWNDOMAIN|允许的域组编号|该参数用于设置允许的域组编号，表示允许访问NF实例的NF域名。如果未设置，则允许任何NF域访问NF。允许的域组编号通过SHOW SBIDOMAINARRID命令查询。
ALLOWSNSSAI|允许的S-NSSAI组编号|该参数用于设置允许的S-NSSAI组编号，表示允许访问NF实例的单个网络切片选择协助信息（S-NSSAI）。如果未设置，则允许任何切片访问NF。允许的S-NSSAI组编号通过SHOW SBISNSSAIARRID命令查询。
CAPACITY|容量|该参数用于设置静态容量信息，表示为相对于其他相同类型NF实例的权重。如果有多个不同的NF配置文件（NFProfile）都携带了该参数，则服务使用者应该按照权重来负荷分担地访问NF服务提供者。如果NF服务列表（NFServiceList）参数中也存在容量参数，则NF服务的容量将优先于该值。
PRIORITY|优先级|该参数用于设置优先级，用于NF选择；较低的值表示较高的优先级。 如果有多个不同的NF配置文件（NFProfile）都携带了该参数，则服务使用者始终选择优先级最高的NFProfile。如果NF服务列表（NFServiceList）参数中也存在优先级参数，则NF服务的优先级将优先于该值。
LOCALITY|地区|该参数用于设置运营商定义的有关NF实例位置的信息。
NFSETIDARRAY|NF集标识组编号|该参数用于设置NF集标识组编号，表示NF集标识（NF Set ID）。每个NF的公共陆地移动网（PLMN）最多指示一个NF Set ID。NF集标识组编号通过SHOW SBINFSETIDARRID命令查询。
NFSERVPERSISTENCE|是否支持资源在NF服务实例间共享|该参数用于设置是否支持资源在NF服务实例间共享。如果设置为是，则表示该NF实例中支持相同API版本的同一NF服务（NFService）的不同服务实例能够将其资源状态保持在共享存储中，因此这些资源可用在NF服务使用者选择了支持相同API版本的新NF服务实例之后。如果设置为否，它表示同一NF服务的NF服务实例无法共享NF实例内部的资源状态。
LCHSUPPORTIND|是否支持基于LCI头域的负荷控制|该参数用于设置是否支持基于负载控制信息（LCI）头域的负载控制。
OLCHSUPPORTIND|是否支持基于OCI头域的过载控制|该参数用于设置是否支持基于过载控制信息（OCI）头域的过载控制。
DLFTNOTIFICATIONARR|缺省通知端点组编号|该参数用于设置缺省通知端点组编号，表示不同通知类型的通知端点。缺省通知端点组编号通过SHOW SBIDLFTNOTEENDPOINTARRID命令查询。
SERVSCOPEARRAY|服务范围组编号|该参数用于设置服务范围组编号，表示NF实例的服务区域。注意，该参数若不设置并不意味着NF实例可以服务公共陆地移动网（PLMN）中的每个区域。服务范围组编号通过SHOW SBISERVSCOPEARRID命令查询。
执行[ADD SBIPEERNFEXTINFO]命令，新增对端NF扩展信息配置。
[ADD SBIPEERNFEXTINFO]命令的参数填写说明参见[表12]。
参数|参数名称|填写说明
---|---|---
ID|对端NF信息编号|该参数用于设置对端NF扩展信息关联的对端NF信息编号，该编号通过SHOW SBIPEERNFBASEINFO命令查询。
CHFINFO|CHF信息编号|该参数用于设置CHF信息编号，CHF信息编号通过SHOW SBICHFINFO命令查询。
执行[ADD SBIPEERNFSERVICEINSTANCE]命令，新增对端NF服务实例配置。
[ADD SBIPEERNFSERVICEINSTANCE]命令的参数填写说明参见[表13]。
参数|参数名称|填写说明
---|---|---
INDEX|配置索引|该参数用于设置配置索引。
NFINDEX|归属NF编号|该参数用于设置归属NF编号，NF编号通过SHOW SBIPEERNFBASEINFO命令查询。
SRVINSTANCEID|服务实例标识|该参数用于设置服务实例标识，是给定NF实例中服务实例的唯一ID。
SERVICENAME|服务名称|该参数用于设置服务实例的名称。
SERVICEVERSIONARRAY|服务版本组编号|该参数用于设置服务版本组编号，该编号通过SHOW SBINFSVERSIONARRID命令查询。
SCHEME|协议模式|该参数用于设置协议模式（例如，“http”或“https”）。
NFSERVICESTATUS|服务实例状态|该参数用于设置服务实例的状态。
FQDN|域名|该参数用于设置NF实例的FQDN。
INTERPLMNFQDN|PLMN间域名|该参数用于设置PLMN间的FQDN，如果NF服务需要由不同PLMN中的其他NF发现，则可以将用于PLMN间路由的FQDN注册到NRF。
IPENDPOINTARRAY|IP端点组编号|该参数用于设置IP端点组编号，该编号通过SHOW SBIIPENDPOINTARRID命令查询。
APIPREFIX|API路径前缀|该参数用于设置API路径前缀，为可选路径段，用于构建不同API URI的{apiRoot}变量。
DLFTNOTIFICATEARRAY|缺省通知端点组编号|该参数用于设置缺省通知端点组编号，该编号通过SHOW SBIDLFTNOTEENDPOINTARRID命令查询。
ALLOWPLMN|允许的PLMN组编号|该参数用于设置允许的PLMN组编号，该编号通过SHOW SBIPLMNIDARRID命令查询。
ALLOWPLMNNID|允许的PLMN NID组编号|该参数用于设置允许的PLMN NID组编号，该编号通过SHOW SBIPLMNNIDARRID命令查询。
ALLOWNFTYPE|允许的NF类型组编号|该参数用于设置允许的NF类型组编号，该编号通过SHOW SBINFTYPEARRID命令查询。
ALLOWNDOMAIN|允许的域组编号|该参数用于设置允许的域组编号，该编号通过SHOW SBIDOMAINARRID命令查询。
ALLOWSNSSAI|允许的S-NSSAI组编号|该参数用于设置允许的S-NSSAI组编号，该编号通过SHOW SBISNSSAIARRID命令查询。
CAPACITY|容量|该参数用于设置静态容量信息，表示为相对于相同类型其他服务的权重。
PRIORITY|优先级|该参数用于设置优先级（相对于其他相同类型的服务），用于NF服务选择。较低的值表示较高的优先级。
SUPPORTEDFEATURES|支持的特性|该参数用于设置服务实例支持的特性。
PRIMARYCHFSRVINST|首选CHF服务实例|该参数用于设置首选CHF服务实例。
SECONDCHFSRVINST|次选CHF服务实例|该参数用于设置次选CHF服务实例。
NFSERVICESETARRAY|NF服务集组编号|该参数用于设置NF服务集组编号，该编号通过SHOW SBINFSSETIDARRID命令查询。
SNSSAIARRAY|S-NSSAI组编号|该参数用于设置S-NSSAI组编号，该编号通过SHOW SBISNSSAIARRID命令查询。
PLMNSNSSAIARRAY|PLMN S-NSSAI组编号|该参数用于设置PLMN S-NSSAI组编号，该编号通过SHOW SBIPIMNSNSSAIARRID命令查询。
举例 :配置示例如下。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0。
新增HTTP客户端模板配置。 
[ADD CLIENTPROFILE]:ID=11,IPADDR="17.128.3.213",STARTPORT=10000,ENDPORT=60000,VPNID=13
新增HTTP服务端模板配置。 
[ADD SERVERPROFILE]:ID=11,IPADDR="17.128.3.213",PORT=8080,VPNID=13
新增关联HTTP客户端模板配置。 
[ADD SVCHTTPCLTPROF]:ID=6,SERVICETYPE="NCHF_SPENDLMTCONTROL",HTTP4CLTID=11,HTTP6CLTID=0
新增通知URI服务端模板配置。 
[ADD NOTIURISVRTPROF]:SERVICETYPE="NCHF_SPENDLMTCONTROL",SVRID1=11,SVRID2=0
新增服务发现方式配置。 
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="CHF_TYPE",DISCOVERYMODE="STATIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=80,DEFAULTPORTFORHTTPS=443
新增GPSI范围组配置。 
[ADD SBIGPSIRANGEARRID]:ARRAYID=100
[ADD SBIGPSIRANGEARRPARAM]:INDEX=100,ARRAYID=100,START="0000000000000",END="9999999999999"
新增CHF服务信息配置。 
[ADD SBICHFINFO]:ID=100,GPSIRANGEARRAY=100
新增CHF网元信息配置。 
新增IPv4地址配置 
[ADD SBIIPV4ADDR]:ID=100,IP="17.128.68.196"
[ADD SBIIPV4ADDR]:ID=101,IP="17.128.68.197"
新增IP端点配置 
[ADD SBIIPENDPOINT]:INDEX=100,IPV4=100,PORT=14301
[ADD SBIIPENDPOINT]:INDEX=101,IPV4=101,PORT=14301
新增IP端点组编号配置 
[ADD SBIIPENDPOINTARRID]:ARRAYID=100
[ADD SBIIPENDPOINTARRID]:ARRAYID=101
新增IP端点组参数配置 
[ADD SBIIPENDPOINTARRPARAM]:INDEX=100,ARRAYID=100,IPENDPOINT=100
[ADD SBIIPENDPOINTARRPARAM]:INDEX=101,ARRAYID=101,IPENDPOINT=101
新增NF服务版本组编号配置 
[ADD SBINFSVERSIONARRID]:ARRAYID=100
新增NF服务版本组参数配置 
[ADD SBINFSVERSIONARRPARAM]:INDEX=100,ARRAYID=100,APIVERSIONINURI="v1",APIFULLVERSION="1.1.0.alpha-1"
新增对端NF基本信息配置 
[ADD SBIPEERNFBASEINFO]:ID=100,NFINSTANCEID="100",NFTYPE="CHF_TYPE",NFSTATUS="REGISTERED",PRIORITY=10
[ADD SBIPEERNFBASEINFO]:ID=101,NFINSTANCEID="101",NFTYPE="CHF_TYPE",NFSTATUS="REGISTERED",PRIORITY=10
新增对端NF扩展信息配置 
[ADD SBIPEERNFEXTINFO]:ID=100,CHFINFO=100
[ADD SBIPEERNFEXTINFO]:ID=101,CHFINFO=100
新增对端NF服务实例配置 
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=100,NFINDEX=100,SRVINSTANCEID="100",SERVICENAME="NCHF_SPENDINGLIMITCONTROL",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",IPENDPOINTARRAY=100,PRIORITY=10
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=101,NFINDEX=101,SRVINSTANCEID="101",SERVICENAME="NCHF_SPENDINGLIMITCONTROL",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",IPENDPOINTARRAY=101,PRIORITY=20
### 同步变化表 
摘要 :Npcf_PolicyManagement服务相关数据配置完成后，需要执行同步变化表操作。 
步骤 :在EM客户端配置页面的左侧命令树中，展开PCF节点，单击其下的PCF局点，如PCF61
→PCF61
。
执行[SYNA]命令，传送变化表。
## 缩略语 
## 缩略语 
3GPP :3rd Generation Partnership Project第三代合作伙伴计划
AAA :Authentication, Authorization and Accounting鉴权、授权及计费
AF :Application Function应用功能
AMF :Access and Mobility Management Function接入和移动管理功能
### AVP 
Attribute Value Pair属性值对
BSF :Binding Support Function绑定支持功能
CHF :Charging Function计费功能
DNN :Data Network Name数据网名称
### EDGE 
Enhanced Data rates for GSM EvolutionGSM用的增强型数据速率
EM :Element Management网元管理
FQDN :Fully Qualified Domain Name完全限定域名
GPSI :Generic Public Subscription Identifier一般公共用户标识
### GUI 
Graphical User Interface图形用户界面
HTTP :Hypertext Transfer Protocol超文本传输协议
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
### ID 
Identification识别
IP :Internet Protocol因特网协议
IPv4 :Internet Protocol Version 4互联网通信协议第四版
IPv6 :Internet Protocol Version 6互联网通信协议第六版
### MML 
Man Machine Language人机语言
### NAT 
Network Address Translation网络地址转换
NF :Network Function网络功能
NRF :NF Repository Function网络仓储功能
### OCS 
Online Charging System在线计费系统
PCEF :Policy and Charging Enforcement Function计费和策略控制实施功能
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
PDU :Packet Data Unit分组数据单元
### PUDR 
Policy UDR统一的策略数据存储库
### RD 
Route Distinguisher路由标识符
### RG 
Rating Group费率组
### ROSng 
Realtime OS Next Generation下一代实时操作系统
SCTP :Stream Control Transmission Protocol流控制传输协议
### SMC 
Short Message Center短消息中心
SMF :Session Management Function会话管理功能
### SMPP 
Short Message Peer to Peer Protocol短消息点对点协议
### SMSC 
Short Message Service Center短消息中心
### SNMP 
Simple Network Management Protocol简单网络管理协议
### SP 
Service Provider服务提供商
SUPI :Subscriber Permanent Identifier用户永久标识
URI :Uniform Resource Identifier统一资源标识符
### VLAN 
Virtual Local Area Network虚拟局域网
### VPN 
Virtual Private Network虚拟专用网
### VRF 
Virtual Route Forwarding虚拟路由转发
### WLAN 
Wireless Local Area Network无线局域网
## 规则配置 
### 业务分解指导 
### 业务分解指导 
#### 总体原则 
概述 :本节介绍从业务策略需求拆解分析出业务策略配置方案时应遵守的基本原则。 
##### 条件 
条件一般由策略对象、参考值及运算符组成。在RCP中可以配置：用量条件、金额条件、时间条件、用户签约信息类条件、接入信息类条件、会话信息类条件、IP-CAN承载信息类条件、组信息类条件、系统类条件、流信息类条件、AF信息类条件、自定义策略变量类条件、表达式策略变量类条件、映射策略变量类条件。在EM客户端的配置→RCP策略管理
页面中通过条件
完成配置。
将用户发起的请求中携带的信息或RCP感知到的用户相关信息与RCP上配置的相应策略规则中相应条件的参考值进行比较，以此确定条件的匹配结果。 
若干个条件可以通过逻辑符号组成条件表达式。条件和条件表达式的结果都只能是真或假。每个策略规则关联一个条件表达式。只有当条件表达式的结果为真时，策略规则才会被RCP下发给相关网元。 
条件表达式下所有条件之间可以配置的关系，按照执行优先级由高至低的顺序为：“（）”、“非”、“与”、“或”。使用“（）”可以优先对其中所包含的条件组合进行判断。当关系设置为“非”时，需要先对条件结果取反，再确定条件表达式的结果。当关系设置为“与”时，只有条件表达式下的所有条件结果都为真，该条件表达式结果才为真。当关系设置为“或”时，只要条件表达式下的任意一个条件结果为真，该条件表达式结果就为真。当条件表达式中没有条件时，表示条件表达式结果恒为真。 
对一个具体的业务策略需求，其中每个策略规则的匹配时机都可以用一个条件表达式来表示。匹配时机中的每个时机控制点都可以用一个条件来表示。例如，业务策略要求为：每天20:00~22:00，当用户使用4G从区域A上线时，下发策略规则1。进行业务分解后，条件1为每天20:00~22:00，条件2为用户使用4G接入，条件3为用户从区域A接入。条件表达式为条件1&条件2&条件3。 
一个场景下所有策略规则的条件表达式定义的范围之间尽量没有交集。如果有交集，那么条件表达式结果为真时，高优先级的策略规则会被触发。例如，策略规则1的优先级为2，条件表达式1为“用户在8:00~10：00上线”；策略规则2的优先级为1，条件表达式2为“用户在6:00~20：00上线”。则某用户9:00上线时，由于策略规则1的优先级高，因此会触发策略规则1。 
所有条件表达式的并集要覆盖所有场景，否则会导致没有被覆盖的用户无法获取正确的规则。 
如果几个条件的动作一样，则可以考虑将这几个条件合并成关系为“或”的条件表达式。确定无法合并的，设置成独立的条件表达式。 
##### 动作 
动作，即在策略规则的条件表达式结果为真时，该策略规则的可执行的操作。 
动作中可能包含QoS参数、计费参数、用量监控参数、通知参数和重定向参数等。 
QoS参数：包含带宽决策方式、具体的带宽参数等。不同类型的参数集中的QoS参数指示接口中不同层次上的带宽，一般是会话层带宽、承载层带宽、业务层带宽。 
计费参数：包含计费方式、计费地址等参数。 
用量监控参数：包含门限控制方式、用量监控门限参数等。用量监控参数用于指示PCEF/SMF在用量达到监控门限值时向RCP上报用量，使RCP能够作出新的策略下发给PCEF/SMF执行。 
通知参数：使用短信、邮件或SOAP消息将用户的使用状态通知给用户。使用时需要单独配置通知内容模板。在RCP策略管理页面中通过通知进行配置。 
重定向参数：分为一次重定向和永久重定向两种。当用户使用量达到某个阈值时，将用户访问页面重定向到某个地址。 
RCP把上述参数划分为以下的动作参数类型，在RCP策略管理页面中通过动作参数
完成配置。
套餐动态属性参数集：此类动作参数可以指定套餐的优先级或将指定套餐置为无效状态，即动态调整套餐的优先级属性。在RCP为用户选择套餐时使用。 
承载参数集：此类动作参数用于指定IP-CAN承载层的QoS参数。 
会话参数集：此类动作参数用于指定会话层的QoS参数、计费参数。 
会话用量监控参数集：此类动作参数用于指定会话层的用量监控参数。 
通知参数集：此类动作参数用于指定通知类型、通知内容模板、通知防骚扰参数等。通知类型即通知的具体发送形式，包括短信、邮件或SOAP消息。通知内容模板确定了通知内容。通知防骚扰参数可控制通知发送的频率及次数。 
预下发业务参数集：此类动作参数可以指定需要进行决策的受控业务列表。可根据用户签约进行预下发或直接指定受控业务ID。 
PCC规则参数集：分为预定义规则和动态规则。此类动作参数用于指定Gx接口上业务层的QoS参数、重定向参数、计费参数等。 
ADC规则参数集：分为预定义规则和动态规则。此类动作参数用于指定Sd接口上业务层的QoS参数、重定向参数、计费参数等。 
PCC预定义规则组参数集：此类动作参数用于指定Gx接口上业务层的预定义规则组。 
ADC预定义规则组参数集：此类动作参数用于指定Sd接口上业务层的预定义规则组。 
业务用量监控参数集：此类动作参数用于指定业务层的用量监控参数。 
套餐预定义规则参数集：此类动作参数用于对指定套餐直接下发PCC规则，一般应用在物联网中。 
接入移动策略参数集：此类动作参数用于指定N15接口上的RFSP索引和区域参数。 
N15限制服务区域参数集：此类动作参数用于指定限制服务区域的参数。 
UE路由选择策略参数集：此类动作参数用于为N15会话下发一组UE路由选择参数。 
URSP规则参数集：此类动作参数用于下发URSP规则参数。 
UE业务流描述参数集：此类动作参数用于下发业务流描述参数。 
UE路由选择描述参数集：此类动作参数用于下发UE路由选择参数。 
N7会话参数集：此类动作参数用于指定N7接口上的会话层的QoS参数、计费参数。 
5QI参数集：此类动作参数用于指定QoS参数，5QI值和N7会话参数集下引用。 
N7 PCC规则参数集：分为预定义规则和动态规则。此类动作参数用于指定N7接口上业务层的QoS参数、计费参数、流量控制参数等。 
QoS参数集：此类动作参数用于指定QoS参数，被N7 PCC规则参数集中的QoS控制策略ID所引用。 
Charging参数集：此类动作参数用于指定计费参数，被N7 PCC规则参数集中的计费控制策略ID所引用。 
TC参数集：此类动作参数用于指定流量控制参数，被N7 PCC规则参数集中的流量控制策略ID所引用。 
路由目的地参数集：此类动作参数用于指定路由参数，被TC参数集中的路由目的地所引用。 
从上述动作参数类型中可以看到，PCC规则参数集、ADC规则参数集非常类似。在实际组网中，需要根据邻接网元的类型进行区分。与RCP邻接的PCEF/SMF/TDF网元需要分别配置PCC规则参数集、N7 PCC规则参数集、ADC规则参数集。 
##### 规则 
一个策略规则中包含一个条件表达式和一个动作参数集，并且策略规则具有优先级属性。策略规则表示当条件表达式为真时，需要执行其动作参数集中指定的动作参数。 
策略场景与规则关联。当一个或几个策略场景同时发生时，将这些场景引用的同一策略类型下的规则按照优先级由高至低的顺序进行排序，按照排序结果依次根据条件表达式结果匹配规则。高优先级的规则匹配后，将规则的动作执行。后续低优先级的规则不再进行匹配。但通知类型的规则除外，策略场景下所有通知类型的规则不区分优先级，一旦匹配都将被执行。 
一个通知参数集只能被唯一一个通知策略类型的规则使用。 
一个业务控制策略类型的规则可以关联PCC规则参数集、ADC规则参数集中的一个或多个，并且规则参数集类型必须互不相同。 
如果一个场景下同种策略类型的规则有多个，那么需要根据具体应用设置优先级。优先级数值越大，则规则的优先级越高。例如，业务策略要求为：当用户日流量>100M时，将用户带宽降为512 kbps；当用户日流量>200M时，将用户带宽降为128 kbps。进行业务分解，条件1为用户日流量>100M，条件2为用户日流量>200M。会话参数集1中配置带宽为512
kbps，会话参数集2中配置带宽为128 kbps。配置策略规则1，条件表达式1为条件1，触发会话参数集1；策略规则2，条件表达式2为条件2，触发会话参数集2。考虑到当条件2为真时，条件1也为真。因此，策略规则2的优先级应该高于策略规则1。 
##### 场景 
场景由入口条件和策略规则组成。一个场景最多可使用三个入口条件，可以关联不同策略类型的规则。使用场景的入口条件，可以确定该场景关联的规则的使用范围。 
根据业务策略需求，可分解出一个或多个场景。每个场景需要分析入口条件及该场景关联的策略类型。 
例如，业务策略要求为：对于金牌用户做如下策略控制：当用户使用HTTP业务时，初始带宽为512
kbps，如果HTTP业务的使用流量>200M，则降低带宽为128  kbps并且发短信通知用户当前的使用量。业务分解过程如下： 
确定场景的入口条件。进行业务分析可以了解到：所有的策略控制都是针对金牌用户的HTTP业务。因此，金牌用户是一个入口条件，HTTP业务是第二个入口条件。 
确定该场景需要做哪些类型的策略。假定用户已经先签约HTTP业务且可以使用。要对HTTP业务做决策，需要配置预下发业务策略，使RCP感知到该业务发生。其次，基于HTTP业务的使用量进行控制，需要配置业务策略和业务用量监控策略。业务用量监控策略用于PCEF/SMF上报用量，在累计用量达到200M时能够根据业务策略触发新的策略动作。
检查该场景下每个策略类型的规则配置要求。业务策略中要求HTTP业务的使用流量>200M后，降低带宽，该带宽值与初始带宽不同。那么，在业务策略中需要配置2条业务规则，并且业务规则2的优先级高于业务规则1。 
业务规则1，无条件执行，带宽为512 kbps。 
业务规则2，条件表达式为：HTTP业务的使用流量>200 M，带宽为128 kbps。 
配置确定后需要按照业务策略要求检查是否满足策略要求。HTTP业务的使用量从0M开始，从高优先级的规则开始匹配。不满足业务规则2，因此使用量不足200M时，匹配业务规则1，RCP下发带宽512
kbps。随着使用量的逐渐增加，达到200M后，再次进行策略匹配。依然从高优先级规则开始。此时可以匹配业务规则2，RCP下发带宽128
kbps。满足业务策略要求，则配置完成。 
#### 业务分解方法 
#### 业务分解方法 
##### 策略分解 
概述 :一个业务可以有一到多个策略。策略由场景和规则组成。在特定场景下，如果匹配某个条件，则RCP将规则相应的动作下发给相应网元（PCEF、SMF、TDF、SMSC等）。RCP的策略机制如[图1]所示。
图1  RCP策略机制

###### 条件 
规则的条件参见[表1]。
条件分类|说明
---|---
用量|基于流量/时长/业务访问次数的累计使用量的条件。
金额|基于金额的累计使用量的条件。
其他|基于系统信息类、流信息类、AF信息类、用户信息类、接入信息类、IPCAN承载信息类、会话信息类、组信息类、表达式策略变量、自定义策略变量的条件。
基于用量的策略控制，是指根据流量/时长/点击次数的累计使用量采取不同的控制策略。 
基于金额的策略控制，是指根据金额的累计使用量采取不同的控制策略。 
基于系统信息类的策略控制，是指基于时间、忙闲时属性、系统状态（紧急、普通）进行控制。每天的某些时间段：比如每天22:00~23:00，限制P2P带宽。每周的某些天：比如每周的周六、周日，限制P2P带宽。每月某些天：比如每个月的28号，限制FTP带宽。某年的某段时间：比如2016年10月1日~2016年10月7日，限制FTP带宽。用户自定义的忙闲时段：比如周一至周五每天的8:00~21:00以及周六周日每天的16:00~22:00为忙时，其余为闲时段。在忙时段限制FTP带宽。系统状态：比如系统紧急状态下拒绝会话使用户下线。 
基于流信息类的策略控制，是指根据流用途、上/下行流的地址/端口信息、流的协议类型、流请求的上行带宽、流请求的下行带宽、流方向进行策略控制。 
基于AF信息类的策略控制，是指根据AF媒体相关信息和AF会话相关信息进行策略控制。AF媒体相关信息主要包括：媒体类型、媒体资源预留优先级、媒体上行最大带宽、媒体下行最大带宽、AF应用标识。比如，可以对音频流进行带宽限制。AF会话相关信息主要包括：AF计费标识、Service URN、用户资源预留优先级、用户多媒体优先级服务标识、会话资源预留优先级、会话多媒体优先级服务标识、紧急Service-URN指示。 
基于用户信息类的策略控制，是指对于不同用户信息可以采取不同的控制策略。用户信息主要包括：用户类型、卡类型、付费类型、用户套餐、签约业务标识、业务计费方式、用户设备信息、MSISDN、IMEISV、IMSI等。 
基于接入信息类的策略控制，是指根据不同的接入信息采取不同的控制策略。接入信息主要包括：SGSN信息、路由区标识RAI、用户位置信息ULI、BSID、AN GW IPv4地址、AN GW IPv6地址、无线接入技术（UTRAN/GERAN/WLAN/GAN等）、IP-CAN类型（3GPP、3GPP2、WiMAX等）等。 
基于IP-CAN承载信息类的策略控制，是指基于不同的承载信息作不同的控制策略。承载信息主要包括：承载标识、承载用途、承载QCI、承载类型等。 
基于会话信息类的策略控制，是指基于不同的会话信息作不同的控制策略。会话信息主要包括：基于接入网计费IPv4地址、接入网计费IPv6地址、NAI、子网类型、GX应用标识、Monitoring
Key、APN、是否是紧急APN、会话建立时间、CCR类型等。 
基于组信息类的策略控制，是指基于用户所属的组ID、用户作为组成员的类型（主用户或从用户）等组相关信息作不同的策略控制。 
基于映射策略变量的策略控制，是指基于IP地址段或号码段进行策略控制。主要包括：IMSI号段、SGSN_MCC_MNC号段、SGSN/AN-GW_IPv4地址段等。 
基于自定义策略变量的策略控制，是指基于携带属性参数的变量进行策略控制。自定义策略变量主要包括：套餐有效期剩余时间、接入属性、套餐HomeZone状态标识、套餐忙闲时段状态标识、用户套餐切换事件等。比如，配置自定义策略变量“套餐有效期剩余时间”，属性参数“套餐标识”设置为1。在此基础上可以配置基于“套餐1的有效期剩余时间”等于0时进行业务重定向。 
###### 动作 
根据策略类型把规则的动作划分为以下几类： 
策略类型|说明
---|---
套餐动态属性参数集|配置动态调整套餐的优先级和有效性。
预下发业务参数集|配置预下发业务的应用标识。
承载参数集|配置承载的QoS参数。
会话参数集|配置会话的QoS参数、计费参数、授权时长以及承载控制模式。
通知参数集|配置通知内容、通知发送的周期频度。
PCC规则参数集|配置PCC规则类型、规则名称、应用标识、MonitoringKey等参数。若PCC规则为动态规则，则参数集还可配置业务的QoS参数、重定向信息、计费信息等。
PCC预定义规则组参数集|配置PCC预定义规则名、PCC预定义规则组名。
ADC规则参数集|配置ADC规则类型、规则名称、应用标识、MonitoringKey、TDF应用标识输出指示等参数。若ADC规则为动态规则，则参数集还可配置业务的QoS参数、重定向信息、计费信息等。
ADC预定义规则组参数集|配置ADC预定义规则名、ADC预定义规则组名。
外置业务PCC规则参数集|配置外置业务PCC规则类型、规则名称、应用标识等参数。若外置业务PCC规则为动态规则，则参数集还可配置业务的QoS参数、重定向信息、计费信息等。
外置业务PCC预定义规则组参数集|配置外置业务PCC预定义规则名、外置业务PCC预定义规则组名。
业务用量监控参数集|配置流量门限控制方式、总流量门限、上行流量门限、下行流量门限等参数。
会话用量监控参数集|配置Monitoring Key、流量门限控制方式、总流量门限、上行流量门限、下行流量门限等参数。
黑白名单参数集|配置黑白名单。
套餐预定义规则参数集|配置PCC预定义规则名、PCC预定义规则组名。
接入移动策略参数集|配置RFSP索引、允许区域最大TA数等。
N15限制服务区域参数集|配置区域码、TAC。
UE路由选择策略参数集|配置URSP规则参数集名称。
URSP规则参数集|配置UPSC、优先级等。
UE业务流描述参数集|配置IP地址、服务端口等。
UE路由选择描述参数集|配置优先级、SSC模式等。
N7会话参数集|配置N7会话的QoS参数、计费信息、授权时长等。
5QI参数集|配置会话层的5QI、误报率等。
N7 PCC规则参数集|配置N7 PCC规则类型、规则ID、优先级、N7 MonitoringKey等。
QoS参数集|配置带宽、丢包率、QNC等。
Charging参数集|配置计费、计费上报等级等。
TC参数集|配置流状态、重定向信息等。
路由目的地参数集|配置DNAI、IP地址、端口等。
###### 场景和规则 
根据具体应用需求，进行策略分析，设定场景，分析需要的策略类型，并拆解出满足应用需求的条件和动作。在场景下根据分析出的策略类型选择配置一种或多种规则，在规则时引用相关的条件和动作。 
###### 业务拆解图 
业务拆解图如[图2]所示。
图2  业务拆解图

业务拆解图中条件的类别划分示意如[图3]所示。
图3  条件

##### 业务分解流程 
业务分解流程如[图1]所示。
图1  业务分解流程

策略规划时，需要根据业务的具体要求进行规划，选择采用预定义规则还是动态规则来提供策略控制。 
预定义规则（组）：在PCEF/SMF上定义规则名称和具体规则内容，在RCP上定义与PCEF/SMF上一致的规则名称。激活规则时，RCP只下发规则名称，PCEF/SMF根据规则名称匹配具体的规则内容并执行策略。对于预定义规则和预定义规则组，必须先在PCEF/SMF上预先定义规则名称和规则内容，RCP上定义触发该规则或规则组的控制条件和规则名称。 
动态规则：在RCP上定义规则名称和具体的规则内容。激活规则时，RCP下发规则名称和具体的规则内容给PCEF/SMF执行策略。对于动态规则，RCP上定义触发该规则的控制条件、规则名称、规则内容。RCP配置架构如图2所示。图2  RCP配置架构图 
### 典型场景 
#### 接口类 
##### 配置N5接口 
##### 配置N5接口 
配置说明 :N5接口特性配置主要是实现AF/NEF通过N5接口向PCF请求关联的PDU会话策略授权，PCF下发规划的PCC规则。但是如果网络中部署有多个PCF，AF/NEF则需要通过查询BSF，确定访问哪个PCF。
 说明： 
如果AF/NEF使用N5接口前要通过独立BSF查询PCF绑定信息，则需要在PCF配置DNN启用BSF，否则无需配置。 
目前中移、电信、联通均无需配置。 
配置前提 :N5接口特性是PCF、SMF以及AF配合共同完成的，如果网络中部署有多个PCF，还需要与BSF网元进行交互，因此在配置此特性之前保证四个网元的功能及交互正常。
配置过程 :配置过程包含如下步骤： 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。

执行[ADD CLIENTPROFILE]命令，配置HTTP客户端模板。
执行[ADD SERVERPROFILE]命令，配置HTTP服务端模板。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD SVCHTTPCLTPROF]命令，配置服务类型为NBSF_MGT、NPCF_POLICYAUTHORIZATION的关联HTTP客户端模板配置。
执行[ADD PCFSERVICE]命令，配置服务类型为NBSF_MGT、NPCF_POLICYAUTHORIZATION的服务基础信息。
（可选）NRF服务器相关配置。 
 说明： 
如果已有NRF相关配置，可以忽略此配置。 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD SBINRFGROUP]命令，配置NRF服务器分组。
执行[ADD SBINRFNODE]命令，配置NRF服务器节点。
执行[ADD SBINRFPOLICY]命令，配置NRF服务器策略。
执行[ADD SBINRFPROFILE]命令，配置NRF服务器模板。
执行[ADD SBINRFPROFILESEL]命令，配置NRF服务器模板选择。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
（可选）执行[ADD DNNBSF]命令，配置DNN启用外置BSF。
 说明： 
如果AF/NEF使用N5接口前要通过独立BSF查询PCF绑定信息，则需要在PCF上配置DNN启用BSF，否则无需配置。目前中移、电信、联通均无需配置。 
执行[ADD ADJHOSTIP]命令，配置邻接主机类型为AF/NEF的邻接主机IP地址。
执行[ADD APPSUBS]命令，配置进行应用标识。
执行[ADD AFAPPMEDIA]命令，配置AF应用标识映射。
在策略元素配置中自定义策略变量、条件、动作参数、场景和规则配置。
配置实例 :场景说明 :AF/NEF通过N5接口向PCF请求业务策略授权控制，包括：
对特定业务提供保障带宽。 
业务影响路由控制。 
数据规划 :NF类型|IP地址
---|---
PCF|4003::19:5
AF|4003::19:17
NRF（互备双活模式）|4003::19:3
4003::19:4|NRF（互备双活模式）
类别|参数|取值
---|---|---
HTTP客户端模板配置1|编号|1
IP地址|HTTP客户端模板配置1|4003::19:5
起始端口|HTTP客户端模板配置1|20000
终止端口|HTTP客户端模板配置1|30000
HTTP客户端模板配置2|编号|2
IP地址|HTTP客户端模板配置2|4003::19:5
起始端口|HTTP客户端模板配置2|30001
终止端口|HTTP客户端模板配置2|40000
HTTP服务端模板配置|IP地址|4003::19:5
编号|HTTP服务端模板配置|1
端口|HTTP服务端模板配置|8080
关联HTTP客户端模板配置1|服务类型|NPCF_POLICYAUTHORIZATION
HTTP IPv6模板ID|关联HTTP客户端模板配置1|1
关联HTTP客户端模板配置2|服务类型|NBSF_MGT
HTTP IPv6模板ID|关联HTTP客户端模板配置2|2
服务基础配置1|服务类型|NPCF
Fqdn|服务基础配置1|pcf.zte.com.cn
版本|服务基础配置1|v1
优先级|服务基础配置1|1
服务基础配置2|服务类型|NPCF_POLICYAUTHORIZATION
Fqdn|服务基础配置2|pcf.zte.com.cn
版本|服务基础配置2|v1
优先级|服务基础配置2|1
（可选）NRF服务器分组配置1|NRF服务器组编号|1
描述信息|（可选）NRF服务器分组配置1|NrfMaster
（可选）NRF服务器分组配置2|NRF服务器组编号|2
描述信息|（可选）NRF服务器分组配置2|NrfSlave
（可选）NRF服务器节点配置1|NRF服务器节点编号|1
NRF服务器IP地址|（可选）NRF服务器节点配置1|4004::19:3
NRF服务器端口|（可选）NRF服务器节点配置1|8080
NRF服务器FQDN|（可选）NRF服务器节点配置1|nrf1.hatt.zte.com.cn
URI scheme|（可选）NRF服务器节点配置1|http
HTTP客户端模板编号|（可选）NRF服务器节点配置1|1
通知时使用的HTTP服务端模板编号|（可选）NRF服务器节点配置1|1
NRF服务器节点优先级|（可选）NRF服务器节点配置1|1
归属的NRF服务器组编号|（可选）NRF服务器节点配置1|1
（可选）NRF服务器节点配置2|NRF服务器节点编号|2
NRF服务器IP地址|（可选）NRF服务器节点配置2|4004::19:4
NRF服务器端口|（可选）NRF服务器节点配置2|8080
NRF服务器FQDN|（可选）NRF服务器节点配置2|nrf2.hatt.zte.com.cn
URI scheme|（可选）NRF服务器节点配置2|http
HTTP客户端模板编号|（可选）NRF服务器节点配置2|2
通知时使用的HTTP服务端模板编号|（可选）NRF服务器节点配置2|2
NRF服务器节点优先级|（可选）NRF服务器节点配置2|2
归属的NRF服务器组编号|（可选）NRF服务器节点配置2|2
（可选）NRF服务器策略配置|NRF服务器策略编号|1
NRF模式|（可选）NRF服务器策略配置|NRFPATTERN="DUAL_ACTIVE"
（可选）NRF服务器模板配置|NRF服务器模板编号|1
NRF服务器策略编号|（可选）NRF服务器模板配置|1
主用NRF服务器组编号|（可选）NRF服务器模板配置|1
备用NRF服务器组编号|（可选）NRF服务器模板配置|2
（可选）NRF服务器模板选择配置|NF类型|BSF_TYPE
NRF服务器模板编号|（可选）NRF服务器模板选择配置|1
（可选）DNN启用BSF配置|DNN|ims
启用BSF|（可选）DNN启用BSF配置|ENABLE
邻接主机IP配置|邻接主机编号|7
主机IP地址|邻接主机IP配置|4003::19:17
掩码长度|邻接主机IP配置|128
邻接主机类型|邻接主机IP配置|AF/NEF
邻接主机组编号|邻接主机IP配置|0
应用标识配置1|应用标识|1001
应用标识描述|应用标识配置1|1001
签约业务标识|应用标识配置1|1
签约业务标识描述|应用标识配置1|1
应用标识配置2|应用标识|1002
应用标识描述|应用标识配置2|1002
签约业务标识|应用标识配置2|2
签约业务标识描述|应用标识配置2|2
AF应用标识映射配置1|AFAI|3
应用标识|AF应用标识映射配置1|1001
AF应用标识映射配置2|AFAI|4
应用标识|AF应用标识映射配置2|1002
策略类型|控制条件|决策参数
---|---|---
N7业务策略|Gx应用标识1001|N7 PCC规则参数集1
Gx应用标识1002|N7业务策略|N7 PCC规则参数集2
配置步骤 :配置基础数据
配置HTTP客户端模板 
[ADD CLIENTPROFILE]:ID=1,IPADDR=4003::19:5,STARTPORT=20000,ENDPORT=30000,VPNID=0,CONNNUM=2,CONNELASTIC="SWITCH_ON",RESPBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2"
[ADD CLIENTPROFILE]:ID=2,IPADDR=4003::19:5,STARTPORT=30001,ENDPORT=40000,VPNID=0,CONNNUM=2,CONNELASTIC="SWITCH_ON",RESPBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2"
配置HTTP服务端模板 
[ADD SERVERPROFILE]:ID=1,IPADDR=4003::19:5,PORT=8080,VPNID=0,REQBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2",VERIFYCLI="SWITCH_OFF"
配置关联HTTP客户端模板 
[ADD SVCHTTPCLTPROF]:ID=1,SERVICETYPE="NPCF_POLICYAUTHORIZATION",HTTP4CLTID=0,HTTP6CLTID=1,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
[ADD SVCHTTPCLTPROF]:ID=2,SERVICETYPE="NBSF_MGT",HTTP4CLTID=0,HTTP6CLTID=2,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
配置服务基础 
[ADD PCFSERVICE]:SERVICETYPE="NPCF_POLICYAUTHORIZATION",VERSION="v1",FQDN="pcf.zte.com.cn",PRIORITY=1,TOPHIDE="NOTHIDE",SCHEMA="HTTP"
[ADD PCFSERVICE]:SERVICETYPE="NPCF",VERSION="v1",FQDN="pcf.zte.com.cn",PRIORITY=1,SERVERID="1",TOPHIDE="NOTHIDE",SCHEMA="HTTP"
（可选）NRF服务器相关配置。 
配置NRF服务器分组 
[ADD SBINRFGROUP]:ID=1,DESC=NrfMaster
[ADD SBINRFGROUP]:ID=2,DESC=NrfSlave
配置NRF服务器节点 
[ADD SBINRFNODE]:ID=1,SERVERIPADDR="4004::19:3",SERVERPORT=8080,SERVERFQDN="nrf1.hatt.zte.com.cn",SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=1,GROUPID=1
[ADD SBINRFNODE]:ID=2,SERVERIPADDR="4004::19:4",SERVERPORT=8080,SERVERFQDN="nrf2.hatt.zte.com.cn",SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=2,NOTIFYSVRPROFILEID=1,PRIORITY=1,GROUPID=1
配置NRF服务器策略 
[ADD SBINRFPOLICY]:ID=1,NRFPATTERN="DUAL_ACTIVE"
配置NRF服务器模板 
[ADD SBINRFPROFILE]:ID=1,POLICYID=1,ACTIVESRVGRPID=1,BAKSRVGRPID=2
配置NRF服务器模板选择 
[ADD SBINRFPROFILESEL]:NFTYPE="BSF_TYPE",NRFPROFILEID=1
（可选）配置DNN启用BSF 
[ADD DNNBSF]:DNN="ims",BSF="ENABLE"
配置邻接主机IP 
[ADD ADJHOSTIP]:ADJHOSTID="7",HOSTIPADDRESS="4003::19:17",MASKLEN="128",HOSTTYPE="AF"
配置应用标识 
[ADD APPSUBS]:APPID=1001,APPDESC="1001",SUBSID="1",SUBSDESC="1",BEARCTRMODE="UE_NW",PREPROV="YES",DATABWLSTIND="WHITELIST"
[ADD APPSUBS]:APPID=1002,APPDESC="1002",SUBSID="2",SUBSDESC="2",BEARCTRMODE="UE_NW",PREPROV="YES",DATABWLSTIND="WHITELIST"
配置AF应用标识映射 
[ADD AFAPPMEDIA]:ID=1,AFAI="3",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1001
[ADD AFAPPMEDIA]:ID=2,AFAI="3",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1001
[ADD AFAPPMEDIA]:ID=3,AFAI="4",MEDIATYPE="VIDEO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1002
[ADD AFAPPMEDIA]:ID=4,AFAI="4",MEDIATYPE="VIDEO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1002
配置规则条件
Gx标识条件 
条件名称|参数|取值
---|---|---
Gx应用标识1001|选择策略变量|其他
策略变量类别|Gx应用标识1001|会话信息类
策略变量|Gx应用标识1001|Gx应用标识
操作符|Gx应用标识1001|=
值类型|Gx应用标识1001|值
值|Gx应用标识1001|1001
Gx应用标识1002|选择策略变量|其他
策略变量类别|Gx应用标识1002|会话信息类
策略变量|Gx应用标识1002|Gx应用标识
操作符|Gx应用标识1002|=
值类型|Gx应用标识1002|值
值|Gx应用标识1002|1002
配置规则动作参数
N7业务决策动作参数 
动作参数名称|参数名称|取值
---|---|---
action_N7pcc1|动作参数类型|N7 PCC规则参数集
PCC规则名称|action_N7pcc1|N7pcc1
PCC规则类型|action_N7pcc1|动态规则
QoS控制策略ID|action_N7pcc1|N7QoS1
流量控制策略ID|action_N7pcc1|N7RouteTC1
计费控制策略ID|action_N7pcc1|N7Chg1
Monitoring Key|action_N7pcc1|1
action_N7pcc2|动作参数类型|N7 PCC规则参数集
PCC规则名称|action_N7pcc2|N7pcc2
PCC规则类型|action_N7pcc2|动态规则
QoS控制策略ID|action_N7pcc2|N7QoS2
流量控制策略ID|action_N7pcc2|N7RouteTC2
计费控制策略ID|action_N7pcc2|N7Chg2
Monitoring Key|action_N7pcc2|2
动作参数名称|参数名称|取值
---|---|---
N7QoS1|动作参数类型|QoS参数集
动作参数名称|N7QoS1|N7QoS1
QoS控制策略ID|N7QoS1|QoS1
5QI|N7QoS1|5
ARP优先级|N7QoS1|10
ARP抢占能力|N7QoS1|可以抢占
ARP被抢占能力|N7QoS1|可以被抢
N7QoS2|动作参数类型|QoS参数集
动作参数名称|N7QoS2|N7QoS2
QoS控制策略ID|N7QoS2|QoS2
5QI|N7QoS2|6
ARP优先级|N7QoS2|20
ARP抢占能力|N7QoS2|可以抢占
ARP被抢占能力|N7QoS2|可以被抢占
动作参数名称|参数名称|取值
---|---|---
N7RouteTC1|动作参数类型|TC参数集
动作参数名称|N7RouteTC1|N7RouteTC1
流量控制策略ID|N7RouteTC1|TC1
路由目的地|N7RouteTC1|N7Route1
N7RouteTC2|动作参数类型|TC参数集
动作参数名称|N7RouteTC2|N7RouteTC2
流量控制策略ID|N7RouteTC2|TC2
路由目的地|N7RouteTC2|N7Route2
动作参数名称|参数名称|取值
---|---|---
N7Route1|动作参数类型|路由目的地参数集
动作参数名称|N7Route1|N7Route1
DNAI|N7Route1|dnai1
N7Route2|动作参数类型|路由目的地参数集
动作参数名称|N7Route2|N7Route2
DNAI|N7Route2|dnai2
动作参数名称|参数名称|取值
---|---|---
N7Chg1|动作参数类型|Charging参数集
动作参数名称|N7Chg1|N7Chg1
计费控制策略ID|N7Chg1|1
费率组|N7Chg1|1
AF计费标识|N7Chg1|1
计费上报等级|N7Chg1|赞助支付等级
动作参数名称|参数名称|取值
---|---|---
N7Chg2|动作参数类型|Charging参数集
动作参数名称|N7Chg2|N7Chg2
计费控制策略ID|N7Chg2|2
费率组|N7Chg2|2
AF计费标识|N7Chg2|2
计费上报等级|N7Chg2|赞助支付等级
配置场景
场景规则关联 
场景名称|参数|取值
---|---|---
TrafficInfluRole|入口1|入口类型|接入信息类
已选入口|TrafficInfluRole|入口1|接入类型
取值|TrafficInfluRole|入口1|3GPP接入
N7业务策略规则 
规则名称|规则参数|参数取值
---|---|---
rule_serv1|优先级|10
动作类型|rule_serv1|参数填充
日志开关|rule_serv1|关闭
条件表达式|rule_serv1|Gx应用标识 = 1001
选中动作参数名称|rule_serv1|action_N7pcc1
规则名称|规则参数|参数取值
---|---|---
rule_serv2|优先级|10
动作类型|rule_serv2|参数填充
日志开关|rule_serv2|关闭
条件表达式|rule_serv2|Gx应用标识 = 1002
选中动作参数名称|rule_serv2|action_N7pcc2
配置脚本 ://配置Gx标识条件 
[ADD DM COND]:NAME="Gx应用标识1001",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1001";
[ADD DM COND]:NAME="Gx应用标识1002",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1002";
//配置规则动作参数 
[ADD DM ACTION]:NAME="N7Chg1",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"3"&"SYS.CHG_RATING_GROUP"-"0"-"1"&"SYS.CHG_REPORTING_LEVEL"-"0"-"SERVICE_IDENTIFIER_LEVEL"&"SYS.CHG_AF_CHARGING_ID"-"0"-"1";
[ADD DM ACTION]:NAME="N7Chg2",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"4"&"SYS.CHG_RATING_GROUP"-"0"-"2"&"SYS.CHG_REPORTING_LEVEL"-"0"-"SERVICE_IDENTIFIER_LEVEL"&"SYS.CHG_AF_CHARGING_ID"-"0"-"2";
[ADD DM ACTION]:NAME="N7QoS1",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"QoS1"&"SYS.QOS_5QI"-"0"-"5"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"10"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
[ADD DM ACTION]:NAME="N7QoS2",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"QoS2"&"SYS.QOS_5QI"-"0"-"6"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"20"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
[ADD DM ACTION]:NAME="N7Route1",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"0"-"dnai1";
[ADD DM ACTION]:NAME="N7Route2",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"0"-"dnai2";
[ADD DM ACTION]:NAME="N7RouteTC1",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"TC1"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"N7Route1";
[ADD DM ACTION]:NAME="N7RouteTC2",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"TC2"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"N7Route2";
[ADD DM ACTION]:NAME="action_N7pcc1",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"N7pcc1"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_QoS_ID"-"0"-"N7QoS1"&"SYS.N7_PCC_TC_ID"-"0"-"N7RouteTC1"&"SYS.N7_PCC_CHARGING_ID"-"0"-"N7Chg1"&"SYS.N7_MONITOR_KEY"-"0"-"1";
[ADD DM ACTION]:NAME="action_N7pcc2",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"N7pcc2"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_QoS_ID"-"0"-"N7QoS2"&"SYS.N7_PCC_TC_ID"-"0"-"N7RouteTC2"&"SYS.N7_PCC_CHARGING_ID"-"0"-"N7Chg2"&"SYS.N7_MONITOR_KEY"-"0"-"2";
//配置场景规则关联 
[ADD DM RULE]:NAME="rule_serv1",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=10,CONDEXP="{Gx应用标识1001}",ACTTYPE="PARAM",ACTNAME="action_N7pcc1",LOGFLAG="OFF",RULENO=0;
[ADD DM RULE]:NAME="rule_serv2",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=10,CONDEXP="{Gx应用标识1002}",ACTTYPE="PARAM",ACTNAME="action_N7pcc2",LOGFLAG="OFF",RULENO=0;
[ADD DM ROLE]:NAME="TrafficInfluRole",ENTRANCE="SYS.ACCESS_TYPE"-"3GPP_ACCESS",RULENAME="rule_serv1"&"rule_serv2",VALIDFLAG="ENABLE";
##### 配置N7接口 
N7接口的配置参见“[配置PDU会话策略控制]”。
##### 配置N15接口 
N15接口的配置参见“[配置PDU会话策略控制]”和“[配置URSP策略控制]”。
##### 配置N28接口 
###### 配置本地CHF 
配置说明 :本地配置主备CHF，PCF通过N28接口向CHF查询策略计数器，注册、更新或去注册指定用户的策略计费信息及状态，并根据实时的策略计数器状态，进行用户的消费限额控制，例如达量限速。
配置前提 :PCF与CHF之间的HTTP2链路配置完成。
配置过程 :图1  配置流程

配置过程包含如下步骤： 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD CLIENTPROFILE]命令，配置HTTP客户端模板。
执行[ADD SERVERPROFILE]命令，配置HTTP服务端模板。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD SVCHTTPCLTPROF]命令，配置关联的HTTP客户端模板。
执行[ADD PCFSERVICE]命令，配置服务基础信息。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
根据用户关键字配置对应的SUPI或者GPSI号段，两种方式二选一。
配置GPSI范围组执行ADD SBIGPSIRANGEARRID命令，配置GPSI范围组编号。执行ADD SBIGPSIRANGEARRPARAM命令，配置GPSI范围组参数。 
配置SUPI范围组执行ADD SBISUPIRANGEARRID命令，配置SUPI范围组编号。执行ADD SBISUPIRANGEARRPARAM命令，配置SUPI范围 
执行[ADD SBICHFINFO]命令，配置CHF信息。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD SBIIPV6ADDR]命令，配置IPv6地址。
执行[ADD SBIIPENDPOINT]命令，配置IP端点。
执行[ADD SBIIPENDPOINTARRID]命令，配置IP端点组编号。
执行[ADD SBIIPENDPOINTARRPARAM]命令，配置IP端点组参数。
执行[ADD SBINFSVERSIONARRID]命令，配置NF服务版本组编号。
执行[ADD SBIIPENDPOINTARRPARAM]命令，配置NF服务版本组参数。
执行[ADD SBIPEERNFBASEINFO]命令，配置对端NF基本信息。
执行[ADD SBIPEERNFEXTINFO]命令，配置对端NF扩展信息。
执行[ADD SBIPEERNFSERVICEINSTANCE]命令，配置对端NF实例。
执行[ADD SBISRVDISCOVERYMODE]命令，配置服务发现。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD PKGINFO]命令，配置套餐基本信息。
执行[ADD PCID]命令，配置套餐级策略计数器标识。
在策略元素配置中自定义策略变量、条件、动作参数、场景和规则配置。 
配置实例 :场景说明 :PCF携带套餐级策略计数器标识PCID向CHF订阅策略计数器状态，CHF根据PCID查询对应的策略计数器状态并返回给PCF，PCF根据策略计数器状态实行消费限额控制。假设PCS包含四个策略计数器状态，对应不同的限速策略，参见下表。
PCS|限速策略
---|---
0|不限速
1|限速3M
2|限速1M
3|限速128K
数据规划 :类别|参数|取值
---|---|---
HTTP客户端模板配置|编号|1
IP地址|HTTP客户端模板配置|4003::19:5
起始端口|HTTP客户端模板配置|20000
终止端口|HTTP客户端模板配置|30000
HTTP服务端模板配置|编号|1
IP地址|HTTP服务端模板配置|4003::19:5
端口|HTTP服务端模板配置|8080
关联HTTP客户端模板配置|服务类型|NCHF_SPENDLMTCONTROL
HTTP IPv6模板ID|关联HTTP客户端模板配置|1
服务基础配置|服务类型|NPCF
Fqdn|服务基础配置|pcf.zte.com.cn
版本|服务基础配置|v1
优先级|服务基础配置|1
（可选）通知URI服务端模板配置|服务类型|NCHF_SPENDLMTCONTROL
服务端模板ID1|（可选）通知URI服务端模板配置|1
GPSI范围组编号配置|GPSI范围组编号|100
GPSI范围组参数配置|配置索引|100
GPSI范围组编号|GPSI范围组参数配置|100
开始|GPSI范围组参数配置|0000000000000
结束|GPSI范围组参数配置|9999999999999
CHF信息配置|CHF信息编号|100
GPSI范围组编号|CHF信息配置|100
IPv6地址配置1|IPv6地址编号|100
IP地址|IPv6地址配置1|4004::19:3
IPv6地址配置2|IPv6地址编号|101
IP地址|IPv6地址配置2|4004::19:4
IP端点配置1|IP端点编号|100
端口|IP端点配置1|8080
IPv6地址编号|IP端点配置1|100
IP端点配置2|IP端点编号|101
端口|IP端点配置2|8080
IPv6地址编号|IP端点配置2|101
IP端点组编号配置1|IP端点组编号|100
IP端点组编号配置2|IP端点组编号|101
IP端点组参数配置1|配置索引|100
IP端点组编号|IP端点组参数配置1|100
IP端点编号|IP端点组参数配置1|100
IP端点组参数配置2|配置索引|101
IP端点组编号|IP端点组参数配置2|101
IP端点编号|IP端点组参数配置2|101
NF服务版本组编号配置|NF服务版本组编号|100
NF服务版本组参数配置|配置索引|100
NF服务版本组编号|NF服务版本组参数配置|100
API URI版本号|NF服务版本组参数配置|v1
API完整版本号|NF服务版本组参数配置|v1
对端NF基本信息配置1|对端NF信息编号|100
NF实例标识|对端NF基本信息配置1|100
NF类型|对端NF基本信息配置1|CHF_TYPE
NF状态|对端NF基本信息配置1|REGISTERED
NF实例名称|对端NF基本信息配置1|260e6cfe-5eea-4036-8566-77744b5e7101
对端NF基本信息配置2|对端NF信息编号|101
NF实例标识|对端NF基本信息配置2|101
NF类型|对端NF基本信息配置2|CHF_TYPE
NF状态|对端NF基本信息配置2|REGISTERED
NF实例名称|对端NF基本信息配置2|260e6cfe-5eea-4036-8566-77744b5e7199
对端NF扩展信息配置1|对端NF信息编号|100
CHF信息编号|对端NF扩展信息配置1|100
对端NF扩展信息配置2|对端NF信息编号|101
CHF信息编号|对端NF扩展信息配置2|100
对端NF实例配置1|配置索引|100
归属NF编号|对端NF实例配置1|100
服务实例标识|对端NF实例配置1|100
服务名称|对端NF实例配置1|NCHF_SPENDINGLIMITCONTROL
服务版本组编号|对端NF实例配置1|100
协议模式|对端NF实例配置1|HTTP
服务实例状态|对端NF实例配置1|REGISTERED
域名|对端NF实例配置1|chf1.zte.com.cn
IP端点组编号|对端NF实例配置1|100
优先级|对端NF实例配置1|1
对端NF实例配置2|配置索引|101
归属NF编号|对端NF实例配置2|101
服务实例标识|对端NF实例配置2|101
服务名称|对端NF实例配置2|NCHF_SPENDINGLIMITCONTROL
服务版本组编号|对端NF实例配置2|100
协议模式|对端NF实例配置2|HTTP
服务实例状态|对端NF实例配置2|REGISTERED
域名|对端NF实例配置2|chf2.zte.com.cn
IP端点组编号|对端NF实例配置2|101
优先级|对端NF实例配置2|2
服务发现方式配置|目的NF类型|CHF_TYPE
发现方式|服务发现方式配置|STATIC_ONLY
地址选择方式|服务发现方式配置|RANDOM
http默认端口|服务发现方式配置|8080
https默认端口|服务发现方式配置|443
用户套餐配置|套餐编号|1
优先级|用户套餐配置|10
套餐级策略计数器标识配置|套餐级策略计数器标识配置编号|1
套餐编号|套餐级策略计数器标识配置|1
策略计数器标识1|套餐级策略计数器标识配置|1
策略类型|控制条件|决策参数
---|---|---
N7会话策略|pcid1=0|N7 会话规则参数集1
pcid1=1|N7会话策略|N7 会话规则参数集2
pcid1=2|N7会话策略|N7 会话规则参数集3
pcid1=3|N7会话策略|N7 会话规则参数集4
业务配置关系 :图1  业务配置关系

配置步骤 :配置基础数据
配置HTTP客户端模板 
[ADD CLIENTPROFILE]:ID=1,IPADDR=4003::19:5,STARTPORT=20000,ENDPORT=30000,VPNID=0,CONNNUM=2,CONNELASTIC="SWITCH_ON",RESPBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2"
配置HTTP服务端模板 
[ADD SERVERPROFILE]:ID=1,IPADDR=4003::19:5,PORT=8080,VPNID=0,REQBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2",VERIFYCLI="SWITCH_OFF"
配置关联HTTP客户端模板 
[ADD SVCHTTPCLTPROF]:ID=2,SERVICETYPE="NCHF_SPENDLMTCONTROL",HTTP4CLTID=0,HTTP6CLTID=1,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
配置服务基础 
[ADD PCFSERVICE]:SERVICETYPE="NPCF",VERSION="v1",FQDN="pcf.zte.com.cn",PRIORITY=1,SERVERID="1",TOPHIDE="NOTHIDE",SCHEMA="HTTP"
（可选）配置通知URI服务端模板 
[ADD NOTIURISVRTPROF]:SERVICETYPE="NCHF_SPENDLMTCONTROL",SVRID1=1
配置GPSI范围组编号 
[ADD SBIGPSIRANGEARRID]:ARRAYID=100
配置GPSI范围组参数 
[ADD SBIGPSIRANGEARRPARAM]:INDEX=100,ARRAYID=100,START="0000000000000",END="9999999999999"
配置CHF信息 
[ADD SBICHFINFO]:ID=100,GPSIRANGEARRAY=100
配置IPv6地址1 
[ADD SBIIPV6ADDR]:ID=100,IP="4004::19:3"
配置IPv6地址2 
[ADD SBIIPV6ADDR]:ID=101,IP="4004::19:4"
配置IP端点1 
[ADD SBIIPENDPOINT]:INDEX=100,IPV6=100,PORT=8080
配置IP端点2 
[ADD SBIIPENDPOINT]:INDEX=101,IPV6=101,PORT=8080
配置IP端点组编号1 
[ADD SBIIPENDPOINTARRID]:ARRAYID=100
配置IP端点组编号2 
[ADD SBIIPENDPOINTARRID]:ARRAYID=101
配置IP端点组参数1 
[ADD SBIIPENDPOINTARRPARAM]:INDEX=100,ARRAYID=100,IPENDPOINT=100
配置IP端点组参数2 
[ADD SBIIPENDPOINTARRPARAM]:INDEX=101,ARRAYID=101,IPENDPOINT=101
配置NF服务版本组编号 
[ADD SBINFSVERSIONARRID]:ARRAYID=100
配置NF服务版本组参数 
[ADD SBINFSVERSIONARRPARAM]:INDEX=100,ARRAYID=100,APIVERSIONINURI="v1",APIFULLVERSION="v1"
配置对端NF基本信息1 
[ADD SBIPEERNFBASEINFO]:ID=100,NFINSTANCEID="100",NFTYPE="CHF_TYPE",NFSTATUS="REGISTERED",NFINSTANCENAME="260e6cfe-5eea-4036-8566-77744b5e7101",PRIORITY=1
配置对端NF基本信息2 
[ADD SBIPEERNFBASEINFO]:ID=101,NFINSTANCEID="101",NFTYPE="CHF_TYPE",NFSTATUS="REGISTERED",NFINSTANCENAME="260e6cfe-5eea-4036-8566-77744b5e7199",PRIORITY=2
配置对端NF扩展信息1 
[ADD SBIPEERNFEXTINFO]:ID=100,CHFINFO=100
配置对端NF扩展信息2 
[ADD SBIPEERNFEXTINFO]:ID=101,CHFINFO=100
配置对端NF实例1 
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=100,NFINDEX=100,SRVINSTANCEID="100",SERVICENAME="NCHF_SPENDINGLIMITCONTROL",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",FQDN="chf1.zte.com.cn",IPENDPOINTARRAY=100,PRIORITY=1
配置对端NF实例2 
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=101,NFINDEX=101,SRVINSTANCEID="101",SERVICENAME="NCHF_SPENDINGLIMITCONTROL",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",FQDN="chf2.zte.com.cn",IPENDPOINTARRAY=101,PRIORITY=2
配置服务发现方式 
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="CHF_TYPE",DISCOVERYMODE="STATIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=8080,DEFAULTPORTFORHTTPS=443
配置套餐基本 
[ADD PKGINFO]:PKGID="1",PRIORITY=10;
配置套餐级策略计数器标识 
[ADD PCID]:ID=1,PKGID="1",GENMODE="SPECIFIC",CHARGTYPE=4294967295,PCID1="1"
配置策略
配置自定义策略变量 
自定义变量名称|策略变量|策略变量属性
---|---|---
pcid1|策略变量|字符型策略计数器状态(Sy)
策略计数器标识生成方式|pcid1|指定
策略计数器标识|pcid1|1
日志开关|pcid1|关闭
配置条件1 
条件名称|参数|取值
---|---|---
PCS=0|选择策略变量|其他
策略变量类别|PCS=0|自定义策略变量
策略变量|PCS=0|pcid1
操作符|PCS=0|=
值类型|PCS=0|值
值|PCS=0|0
配置条件2 
条件名称|参数|取值
---|---|---
PCS=1|选择策略变量|其他
策略变量类别|PCS=1|自定义策略变量
策略变量|PCS=1|pcid1
操作符|PCS=1|=
值类型|PCS=1|值
值|PCS=1|1
配置条件3 
条件名称|参数|取值
---|---|---
PCS=2|选择策略变量|其他
策略变量类别|PCS=2|自定义策略变量
策略变量|PCS=2|pcid1
操作符|PCS=2|=
值类型|PCS=2|值
值|PCS=2|2
配置条件4 
条件名称|参数|取值
---|---|---
PCS=3|选择策略变量|其他
策略变量类别|PCS=3|自定义策略变量
策略变量|PCS=3|pcid1
操作符|PCS=3|=
值类型|PCS=3|值
值|PCS=3|3
配置动作参数1 
动作参数名称|参数名称|取值
---|---|---
action_N7sess1|动作参数类型|N7会话参数集
会话规则名称|action_N7sess1|N7sess1
会话汇聚带宽决策方式|action_N7sess1|签约的APN带宽
配置动作参数2 
动作参数名称|参数名称|取值
---|---|---
action_N7sess2|动作参数类型|N7会话参数集
会话规则名称|action_N7sess2|N7sess2
会话AMBR上行速率(kbps)|action_N7sess2|2048
会话AMBR下行速率(kbps)|action_N7sess2|2048
配置动作参数3 
动作参数名称|参数名称|取值
---|---|---
action_N7sess3|动作参数类型|N7会话参数集
会话规则名称|action_N7sess3|N7sess3
会话AMBR上行速率(kbps)|action_N7sess3|1024
会话AMBR下行速率(kbps)|action_N7sess3|1024
配置动作参数4 
动作参数名称|参数名称|取值
---|---|---
action_N7sess4|动作参数类型|N7会话参数集
会话规则名称|action_N7sess4|N7sess4
会话AMBR上行速率(kbps)|action_N7sess4|128
会话AMBR下行速率(kbps)|action_N7sess4|128
配置N7会话规则1 
规则名称|规则参数|参数取值
---|---|---
rule_sess1|优先级|10
动作类型|rule_sess1|参数填充
日志开关|rule_sess1|关闭
条件表达式|rule_sess1|PCS=0
选中动作参数名称|rule_sess1|action_N7sess1
配置N7会话规则2 
规则名称|规则参数|参数取值
---|---|---
rule_sess2|优先级|10
动作类型|rule_sess2|参数填充
日志开关|rule_sess2|关闭
条件表达式|rule_sess2|PCS=1
选中动作参数名称|rule_sess2|action_N7sess2
配置N7会话规则3 
规则名称|规则参数|参数取值
---|---|---
rule_sess3|优先级|10
动作类型|rule_sess3|参数填充
日志开关|rule_sess3|关闭
条件表达式|rule_sess3|PCS=2
选中动作参数名称|rule_sess3|action_N7sess3
配置N7会话规则4 
规则名称|规则参数|参数取值
---|---|---
rule_sess4|优先级|10
动作类型|rule_sess4|参数填充
日志开关|rule_sess4|关闭
条件表达式|rule_sess4|PCS=3
选中动作参数名称|rule_sess4|action_N7sess4
配置场景 
场景名称|参数|取值
---|---|---
Scenario 3GPP|入口1|入口类型|用户信息类
已选入口|Scenario 3GPP|入口1|用户套餐
取值|Scenario 3GPP|入口1|1
策略类型|Scenario 3GPP|N7会话控制策略|rule_sess1
rule_sess2|策略类型|Scenario 3GPP|N7会话控制策略
rule_sess3|策略类型|Scenario 3GPP|N7会话控制策略
rule_sess4|策略类型|Scenario 3GPP|N7会话控制策略
配置脚本 ://配置自定义策略变量 
[ADD DM CUSTOMVAR]:NAME="pcid1",SVCKEY="SYS.STR_PCID_STATUS",SVCKEYATTR="PCID"-"1"&"PCIDMOD"-"SPECIFIC"&"LOGFLAG"-"OFF";
//配置条件1 
[ADD DM COND]:NAME="PCS=0",SVCKEY="pcid1",OPERATOR="=",VALTYPE="VALUE",VALUE="0"
//配置条件2 
[ADD DM COND]:NAME="PCS=1",SVCKEY="pcid1",OPERATOR="=",VALTYPE="VALUE",VALUE="1"
//配置条件3 
[ADD DM COND]:NAME="PCS=2",SVCKEY="pcid1",OPERATOR="=",VALTYPE="VALUE",VALUE="2"
//配置条件4 
[ADD DM COND]:NAME="PCS=3",SVCKEY="pcid1",OPERATOR="=",VALTYPE="VALUE",VALUE="3"
//配置动作参数1 
[ADD DM ACTION]:NAME="action_N7sess1",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"N7sess1"&"SYS.SESS_AGG_BW_ACTION"-"VALUE"-"PROFILE_APN_BW"
//配置动作参数2 
[ADD DM ACTION]:NAME="action_N7sess2",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"N7sess2"&"SYS.SESS_AMBR_UL"-"VALUE"-"3072"&"SYS.SESS_AMBR_DL"-"VALUE"-"3072"
//配置动作参数3 
[ADD DM ACTION]:NAME="action_N7sess3",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"N7sess3"&"SYS.SESS_AMBR_UL"-"VALUE"-"1024"&"SYS.SESS_AMBR_DL"-"VALUE"-"1024"
//配置动作参数4 
[ADD DM ACTION]:NAME="action_N7sess4",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"N7sess4"&"SYS.SESS_AMBR_UL"-"VALUE"-"128"&"SYS.SESS_AMBR_DL"-"VALUE"-"128"
//配置N7会话规则1 
[ADD DM RULE]:NAME="rule_sess1",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=10,CONDEXP="{PCS=0}",ACTTYPE="PARAM",ACTNAME="action_N7sess1",LOGFLAG="OFF",RULENO=0
//配置N7会话规则2 
[ADD DM RULE]:NAME="rule_sess2",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=10,CONDEXP="{PCS=1}",ACTTYPE="PARAM",ACTNAME="action_N7sess2",LOGFLAG="OFF",RULENO=0
//配置N7会话规则3 
[ADD DM RULE]:NAME="rule_sess3",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=10,CONDEXP="{PCS=2}",ACTTYPE="PARAM",ACTNAME="action_N7sess3",LOGFLAG="OFF",RULENO=0
//配置N7会话规则4 
[ADD DM RULE]:NAME="rule_sess4",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=10,CONDEXP="{PCS=3}",ACTTYPE="PARAM",ACTNAME="action_N7sess4",LOGFLAG="OFF",RULENO=0
//配置场景 
[ADD DM ROLE]:NAME="Scenario 3GPP",ENTRANCE="SYS.USER_PAK_ID"-"1",RULENAME="rule_sess1"&"rule_sess2"&"rule_sess3"&"rule_sess4",VALIDFLAG="ENABLE";
###### 配置动态发现CHF 
配置说明 :动态发现CHF配置只呈现通过NRF发现CHF的对接配置（步骤[1]-步骤[14]），其余基本套餐、策略计数器标识和策略配置请参考“[配置本地CHF]”章节的对应部分数据。
配置前提 :PCF与NRF之间的HTTP2链路配置完成。
配置过程 :图1  配置流程

配置过程包含如下步骤： 
 说明： 
如果已有NRF相关配置，则步骤[7]-步骤[14]配置可忽略。
步骤[15]-步骤[18]参见“[配置本地CHF]”对应配置部分。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD CLIENTPROFILE]命令，配置HTTP客户端模板。
执行[ADD SERVERPROFILE]命令，配置HTTP服务端模板。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD SVCHTTPCLTPROF]命令，配置关联的HTTP客户端模板。
执行[ADD PCFSERVICE]命令，配置服务基础信息。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD SBINRFGROUP]命令，配置NRF服务器分组。
执行[ADD SBINRFNODE]命令，配置NRF服务器节点。
执行[ADD SBINRFPOLICY]命令，配置NRF服务器策略。
执行[ADD SBINRFPROFILE]命令，配置NRF服务器模板。
执行[ADD SBINRFPROFILESEL]命令，配置NRF服务器模板选择。
执行[SET SBISRVDISCOVERY]命令，配置服务发现。
执行[ADD SBISRVDISCOVERYMODE]命令，配置服务发现方式。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD PKGINFO]命令，配置套餐基本信息。
执行[ADD PCID]命令，配置套餐级策略计数器标识。
在策略元素配置中自定义策略变量、条件、动作参数、场景和规则配置。 
配置实例 :场景说明 :通过NRF发现CHF的对接配置。
数据规划 :假设： 
RCP网元地址：4003::19:5。 
NRF网元地址：4003::19:3和4003::19:4，互备双活模式。 说明：NRF模式默认是互备双活模式DUAL_ACTIVE，如需要配置成主备模式选择MAIN_STANDBY。 
关联的HTTP客户端模板配置：服务类型NCHF_SPENDLMTCONTROL，关联HTTP客户端IPv6模板1。 
服务基础配置：服务类型NPCF的版本为v1、FQDN为pcf.zte.com.cn、优先级为1。 
类别|参数|取值
---|---|---
HTTP客户端模板配置|编号|1
IP地址|HTTP客户端模板配置|4003::19:5
起始端口|HTTP客户端模板配置|20000
终止端口|HTTP客户端模板配置|30000
HTTP服务端模板配置|编号|1
IP地址|HTTP服务端模板配置|4003::19:5
端口|HTTP服务端模板配置|8080
关联HTTP客户端模板配置|服务类型|NCHF_SPENDLMTCONTROL
HTTP IPv6模板ID|关联HTTP客户端模板配置|1
服务基础配置|服务类型|NPCF
Fqdn|服务基础配置|pcf.zte.com.cn
版本|服务基础配置|v1
优先级|服务基础配置|1
NRF服务器分组配置1|NRF服务器组编号|1
描述信息|NRF服务器分组配置1|NrfMaster
NRF服务器分组配置1|NRF服务器组编号|2
描述信息|NRF服务器分组配置1|NrfSlave
NRF服务器节点配置1|NRF服务器节点编号|1
NRF服务器IP地址|NRF服务器节点配置1|4004::19:3
NRF服务器端口|NRF服务器节点配置1|8080
NRF服务器FQDN|NRF服务器节点配置1|nrf1.hatt.zte.com.cn
URI scheme|NRF服务器节点配置1|http
HTTP客户端模板编号|NRF服务器节点配置1|1
通知时使用的HTTP服务端模板编号|NRF服务器节点配置1|1
NRF服务器节点优先级|NRF服务器节点配置1|1
归属的NRF服务器组编号|NRF服务器节点配置1|1
NRF服务器节点配置1|NRF服务器节点编号|2
NRF服务器IP地址|NRF服务器节点配置1|4004::19:4
NRF服务器端口|NRF服务器节点配置1|8080
NRF服务器FQDN|NRF服务器节点配置1|nrf2.hatt.zte.com.cn
URI scheme|NRF服务器节点配置1|http
HTTP客户端模板编号|NRF服务器节点配置1|1
通知时使用的HTTP服务端模板编号|NRF服务器节点配置1|1
NRF服务器节点优先级|NRF服务器节点配置1|2
归属的NRF服务器组编号|NRF服务器节点配置1|2
NRF服务器策略配置|NRF服务器策略编号|1
NRF模式|NRF服务器策略配置|DUAL_ACTIVE
NRF服务器模板配置|NRF服务器模板编号|1
NRF服务器策略编号|NRF服务器模板配置|1
主用NRF服务器组编号|NRF服务器模板配置|1
备用NRF服务器组编号|NRF服务器模板配置|2
NRF服务器模板选择配置|NF类型|CHF_TYPE
NRF服务器模板编号|NRF服务器模板选择配置|1
修改服务发现配置|订阅者NF类型|PCF_TYPE
订阅者FQDN|修改服务发现配置|pcf.zte.com.cn
服务发现方式配置|目的NF类型|CHF_TYPE
发现方式|服务发现方式配置|DYNAMIC_ONLY
地址选择方式|服务发现方式配置|RANDOM
http默认端口|服务发现方式配置|8080
https默认端口|服务发现方式配置|443
配置步骤 :配置HTTP客户端模板 
[ADD CLIENTPROFILE]:ID=1,IPADDR=4003::19:5,STARTPORT=20000,ENDPORT=30000,VPNID=0,CONNNUM=2,CONNELASTIC="SWITCH_ON",RESPBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2"
配置HTTP服务端模板 
[ADD SERVERPROFILE]:ID=1,IPADDR=4003::19:5,PORT=8080,VPNID=0,REQBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2",VERIFYCLI="SWITCH_OFF"
配置关联HTTP客户端模板 
[ADD SVCHTTPCLTPROF]:ID=2,SERVICETYPE="NCHF_SPENDLMTCONTROL",HTTP4CLTID=0,HTTP6CLTID=1,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
配置服务基础 
[ADD PCFSERVICE]:SERVICETYPE="NPCF",VERSION="v1",FQDN="pcf.zte.com.cn",PRIORITY=1,SERVERID="1",TOPHIDE="NOTHIDE",SCHEMA="HTTP"
配置NRF服务器分组1 
[ADD SBINRFGROUP]:ID=1,DESC=NrfMaster
配置NRF服务器分组2 
[ADD SBINRFGROUP]:ID=2,DESC=NrfSlave
配置NRF服务器节点1 
[ADD SBINRFNODE]:ID=1,SERVERIPADDR="4004::19:3",SERVERPORT=8080,SERVERFQDN="nrf1.hatt.zte.com.cn",SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=1,GROUPID=1
配置NRF服务器节点2 
[ADD SBINRFNODE]:ID=2,SERVERIPADDR="4004::19:4",SERVERPORT=8080,SERVERFQDN="nrf2.hatt.zte.com.cn",SCHEME="HTTP",APIVERSION="V1",CLIENTPROFILEID=1,NOTIFYSVRPROFILEID=1,PRIORITY=2,GROUPID=2
配置NRF服务器策略 
[ADD SBINRFPOLICY]:ID=1,NRFPATTERN="DUAL_ACTIVE"
配置NRF服务器模板 
[ADD SBINRFPROFILE]:ID=1,POLICYID=1,ACTIVESRVGRPID=1,BAKSRVGRPID=2
配置NRF服务器模板选择 
[ADD SBINRFPROFILESEL]:NFTYPE="CHF_TYPE",NRFPROFILEID=1
配置修改服务发现，其中订阅者NF类型为必选 
[SET SBISRVDISCOVERY]:SUBREQNFTYPE="PCF_TYPE",SUBREQFQDN="pcf.zte.com.cn"
配置服务发现方式 
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="CHF_TYPE",DISCOVERYMODE="DYNAMIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=8080,DEFAULTPORTFORHTTPS=443
#### 策略动作类 
##### 配置PDU会话策略控制 
##### 配置PDU会话策略控制 
配置说明 :本节将介绍PDU会话策略控制的几个典型配置实例，包括漫游时限速、内容计费套餐仅本地生效、园区业务本地分流。 


配置前提 :



PDU会话策略控制特性是RCP和SMF以及SPR配合共同完成的，因此在配置此特性之前保证三个网元的功能及交互正常。 




配置过程 :图1  配置流程

配置过程包含如下几个步骤： 
在EM客户端配置页面的左侧命令树中，展开PCF节点，在Npcf_PolicyManagement_0服务下执行[ADD PKGINFO]命令新增基本的套餐信息。
执行[SET BEARABILITY]命令，配置承载能力，设置漫游判断条件。
执行[ADD ACCMAP]命令，配置漫游属性。
在Npcf_PolicyManagement_0服务下配置漫游条件、动作参数、规则和场景配置。 
###### 配置实例-运营商根据用户是否漫游采取不同的会话控制策略 
场景说明 :用户非漫游时按请求Session-AMBR和Default-QoS授权，漫游（订阅PLMN_CHG事件，按PLMN
ID判断漫游）时Session-AMBR限速，Default-QoS中ARP-Level降级（例如按漫游协议限速和降级，以适应漫游地接入网要求）。 
数据规划 :类别|参数|取值
---|---|---
套餐|编号|1
套餐类型|套餐|用户套餐
接入配置1|MCCMNC|46001
接入属性|接入配置1|本地
接入配置2|MCCMNC|46002
接入属性|接入配置2|漫游
策略类型|控制条件|决策参数
---|---|---
N7会话决策|漫游|会话AMBR上行速率=200kbps会话AMBR下行速率=200kbpsARP优先级=3
非漫游|N7会话决策|会话汇聚带宽决策方式=请求中的APN带宽ARP优先级决策方式=请求中的值
业务配置关系 :图2  业务配置关系

配置步骤 :配置基础信息。 
配置套餐。 
[ADD PKGINFO]:PKGID="1",PRIORITY=1;
配置承载能力。 
[SET BEARABILITY]:ADJHOSTGRPID=10,ROAMCOND="MCCMNC";
配置上报事件。 
[ADD PCEFEVENT]:ID=1,PKGID="1",PLMN="YES";
配置MCC-MNC接入。 
[ADD MCCMNCACC]:ID=1,ADJHOSTGRPID=0,MCC="460",MNC="01",ACCATTR="1";
[ADD MCCMNCACC]:ID=2,ADJHOSTGRPID=0,MCC="460",MNC="02",ACCATTR="2";
配置漫游属性。 
[ADD ACCMAP]:ACCATTR="1",ROAMFLAG="NO",ACCTYPE="MCCMNC";
[ADD ACCMAP]:ACCATTR="2",ROAMFLAG="YES",ACCTYPE="MCCMNC";
配置规则条件。 
条件名称|参数|取值
---|---|---
IsLocal|选择策略变量|其他
策略变量类别|IsLocal|接入信息类
策略变量|IsLocal|漫游标识
操作符|IsLocal|=
值类型|IsLocal|值
值|IsLocal|本地
配置规则动作参数。 
动作参数名称|参数名称|取值
---|---|---
action_roam|动作参数类型|N7会话参数集
会话规则名称|action_roam|roam
会话AMBR上行速率（kbps）|action_roam|200
会话AMBR下行速率（kbps）|action_roam|200
ARP优先级|action_roam|3
ARP抢占能力|action_roam|开启
ARP被抢占能力|action_roam|开启
动作参数名称|参数名称|取值
---|---|---
action_local|动作参数类型|N7会话参数集
会话规则名称|action_local|local
会话汇聚带宽决策方式|action_local|请求中的APN带宽
ARP优先级决策方式|action_local|请求中的值
配置场景。 
场景名称|参数|取值
---|---|---
PolicyByRoamFlag|入口1|入口类型|用户信息类
已选入口|PolicyByRoamFlag|入口1|用户套餐
取值|PolicyByRoamFlag|入口1|1
策略类型|PolicyByRoamFlag|N7会话策略|rule_roam
rule_local|策略类型|PolicyByRoamFlag|N7会话策略
规则名称|规则参数|参数取值
---|---|---
rule_roam|优先级|1
动作类型|rule_roam|参数填充
日志开关|rule_roam|关闭
条件表达式|rule_roam|~{漫游标识 = 本地}
选中动作参数名称|rule_roam|action_roam
规则名称|规则参数|参数取值
---|---|---
rule_local|优先级|1
动作类型|rule_local|参数填充
日志开关|rule_local|关闭
条件表达式|rule_local|{漫游标识 = 本地}
选中动作参数名称|rule_local|action_local
配置脚本 ://套餐配置 
ADD PKGINFO:PKGID="1",PRIORITY=1; 
//承载能力配置 
SET BEARABILITY:ADJHOSTGRPID=10,ROAMCOND="MCCMNC"; 
//上报事件配置 
ADD PCEFEVENT:ID=1,PKGID="1",PLMN="YES"; 
//SGSN MCC-MNC接入配置 
ADD MCCMNCACC:ID=1,ADJHOSTGRPID=0,MCC="460",MNC="01",ACCATTR="1"; 
ADD MCCMNCACC:ID=2,ADJHOSTGRPID=0,MCC="460",MNC="02",ACCATTR="2"; 
//漫游属性配置 
ADD ACCMAP:ACCATTR="1",ROAMFLAG="NO",ACCTYPE="MCCMNC"; 
ADD ACCMAP:ACCATTR="2",ROAMFLAG="YES",ACCTYPE="MCCMNC"; 
//漫游条件 
ADD DM COND:NAME="IsLocal",SVCKEY="SYS.GX_ROAM_FLAG",OPERATOR="=",VALTYPE="VALUE",VALUE="GX_ROAM_FLAG_LOCAL";
//N7会话决策动作参数（漫游） 
ADD DM ACTION:NAME="action_roam",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"roam"&"SYS.SESS_AMBR_UL"-"0"-"200"&"SYS.SESS_AMBR_DL"-"0"-"200"&"SYS.DEF_QOS_ARP_PRIORITY_LEVEL"-"0"-"3"&"SYS.DEF_QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.DEF_QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
//N7会话决策动作参数（非漫游） 
ADD DM ACTION:NAME="action_local",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"local"&"SYS.SESS_AGG_BW_ACTION"-"0"-"REQ_APN_BW"&"SYS.DEF_ARP_PRI_LEVEL_ACTION"-"0"-"REQ_PRIORITY";
//N7会话策略规则（漫游） 
ADD DM RULE:NAME="rule_roam",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=1,CONDEXP="~{IsLocal}",ACTTYPE="PARAM",ACTNAME="action_roam",LOGFLAG="OFF",RULENO=0;
//N7会话策略规则（非漫游） 
ADD DM RULE:NAME="rule_local",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=1,CONDEXP="{IsLocal}",ACTTYPE="PARAM",ACTNAME="action_local",LOGFLAG="OFF",RULENO=0;
//场景规则关联配置 
ADD DM ROLE:NAME="PolicyByRoamFlag",ENTRANCE="SYS.USER_PAK_ID"-"1",RULENAME="rule_roam"&"rule_local",VALIDFLAG="ENABLE";
###### 配置实例-运营商根据用户是否漫游采取不同的内容计费策略 
场景说明 :当用户非漫游时（按PLMN ID判断），内容计费套餐生效，PCF下发内容计费预定义PCC规则。当用户漫游时，内容计费套餐失效，PCF去除相关PCC规则。 
数据规划 :类别|参数|取值
---|---|---
套餐|编号|2
套餐类型|套餐|用户套餐
业务|业务标识|1
应用标识|业务|1001
接入配置1|MCCMNC|46001
接入配置2|MCCMNC|46002
策略类型|控制条件|决策参数
---|---|---
套餐动态优先级策略|漫游|套餐失效
N7业务控制策略|非漫游&应用标识=1001|内容计费预定义PCC规则
业务配置关系 :图3  业务配置关系图

配置步骤 :配置基础信息。 
配置套餐。 
[ADD PKGINFO]:PKGID="2",PRIORITY=1;
配置套餐业务基本配置。 
[ADD PKGSVC]:ID=1,PKGID="2",SUBSID="1";
应用标识配置 
[ADD APPSUBS]:APPID=1001,APPDESC="业务1",SUBSID="1",SUBSDESC="1";
配置上报事件。 
[ADD PCEFEVENT]:ID=1,PKGID="2",PLMN="YES";
配置SGSN MCC-MNC接入。 
[ADD MCCMNCACC]:ID=1,ADJHOSTGRPID=0,MCC="460",MNC="01",ACCATTR="1";
[ADD MCCMNCACC]:ID=2,ADJHOSTGRPID=0,MCC="460",MNC="02",ACCATTR="2";
配置规则条件。 
自定义变量名称|参数|取值
---|---|---
plmn|选择策略变量|接入属性
接入类型|plmn|SGSN_MCC_MNC
条件名称|参数|取值
---|---|---
plmn_local|选择策略变量|其他
策略变量类别|plmn_local|自定义策略变量
策略变量|plmn_local|plmn
操作符|plmn_local|=
值类型|plmn_local|值
值|plmn_local|1
条件名称|参数|取值
---|---|---
plmn_roam|选择策略变量|其他
策略变量类别|plmn_roam|自定义策略变量
策略变量|plmn_roam|plmn
操作符|plmn_roam|=
值类型|plmn_roam|值
值|plmn_roam|2
条件名称|参数|取值
---|---|---
cond_appid_1001|选择策略变量|其他
策略变量类别|cond_appid_1001|IP-CAN会话信息类
策略变量|cond_appid_1001|Gx应用标识
操作符|cond_appid_1001|=
值类型|cond_appid_1001|值
值|cond_appid_1001|1001
配置规则动作参数。 
动作参数名称|参数名称|取值
---|---|---
action_invalid|动作参数类型|套餐动态属性参数集
套餐有效标识|action_invalid|无效
动作参数名称|参数名称|取值
---|---|---
action_svc_1001|动作参数类型|N7 PCC规则参数集
PCC规则类型|action_svc_1001|预定义规则
规则名|action_svc_1001|svc_1001
业务标识|action_svc_1001|1001
配置场景。 
场景名称|参数|取值
---|---|---
PolicyByPLMNID|入口1|入口类型|用户信息类
已选入口|PolicyByPLMNID|入口1|用户套餐
取值|PolicyByPLMNID|入口1|2
策略类型|PolicyByPLMNID|N7业务控制策略|rule_svc_1001
套餐动态优先级策略|策略类型|PolicyByPLMNID|rule_invalid
规则名称|规则参数|参数取值
---|---|---
rule_svc_1001|优先级|1
动作类型|rule_svc_1001|参数填充
日志开关|rule_svc_1001|关闭
条件表达式|rule_svc_1001|{cond_appid_1001}&{plmn_local}
选中动作参数名称|rule_svc_1001|action_svc_1001
规则名称|规则参数|参数取值
---|---|---
rule_invalid|优先级|1
动作类型|rule_invalid|参数填充
日志开关|rule_invalid|关闭
条件表达式|rule_invalid|{plmn_roam}
选中动作参数名称|rule_invalid|action_invalid
配置脚本 ://套餐配置 
ADD PKGINFO:PKGID="2",PRIORITY=1; 
//套餐业务基本配置 
ADD PKGSVC:ID=1,PKGID="2",SUBSID="1"; 
//应用标识配置 
ADD APPSUBS:APPID=1001,APPDESC="业务1",SUBSID="1",SUBSDESC="1"; 
//上报事件配置 
ADD PCEFEVENT:ID=1,PKGID="2",PLMN="YES"; 
//SGSN MCC-MNC接入配置 
ADD MCCMNCACC:ID=1,ADJHOSTGRPID=0,MCC="460",MNC="01",ACCATTR="1"; 
ADD MCCMNCACC:ID=2,ADJHOSTGRPID=0,MCC="460",MNC="02",ACCATTR="2"; 
//自定义策略变量配置 
ADD DM CUSTOMVAR:NAME="plmn",SVCKEY="SYS.GX_SGSN_ATTR_ID",SVCKEYATTR="ACCTYPE"-"SGSN_MCC_MNC";
//PLMN条件配置（非漫游） 
ADD DM COND:NAME="plmn_local",SVCKEY="plmn",OPERATOR="=",VALTYPE="VALUE",VALUE="1"; 
//PLMN条件配置（漫游） 
ADD DM COND:NAME="plmn_roam",SVCKEY="plmn",OPERATOR="=",VALTYPE="VALUE",VALUE="2"; 
//应用标识条件配置 
ADD DM COND:NAME="cond_appid_1001",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1001";
//套餐动态属性动作参数（漫游） 
ADD DM ACTION:NAME="action_invalid",TYPE="PKG_PRIOR",PARAMS="SYS.PKG_VALID_INDIC"-"0"-"INVALID";
//N7业务决策动作参数（非漫游） 
ADD DM ACTION:NAME="action_svc_1001",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"svc_1001"&"SYS.N7_PCC_RULE_TYPE"-"0"-"PRE_RULE"&"SYS.N7_PCC_APPID"-"0"-"1001";
//套餐动态优先级策略规则 
ADD DM RULE:NAME="rule_invalid",PLCTYPE="PKG_PRIOR",PRIOR=1,CONDEXP="{plmn_roam}",ACTTYPE="PARAM",ACTNAME="action_invalid",LOGFLAG="OFF",RULENO=0;
//N7业务控制策略规则 
ADD DM RULE:NAME="rule_svc_1001",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=1,CONDEXP="{cond_appid_1001}&{plmn_local}",ACTTYPE="PARAM",ACTNAME="action_svc_1001",LOGFLAG="ON",RULENO=0;
//场景规则关联配置 
ADD DM ROLE:NAME="PolicyByPLMNID",ENTRANCE="SYS.USER_PAK_ID"-"2",RULENAME="rule_invalid"&"rule_svc_1001",VALIDFLAG="ENABLE";
###### 配置实例-运营商根据用户是否在区域内采取不同的业务控制策略 
场景说明 :当用户在某园区内（以TA映射策略变量判断），PCF下发动态PCC规则，携带五元组、DNAI、QoS，指示SMF将指定业务分流到园区专用UPF。当用户离开园区时，取消该分流PCC规则。 
数据规划 :类别|参数|取值
---|---|---
套餐|编号|3
套餐类型|套餐|用户套餐
业务|业务标识|1
应用标识|业务|1002
接入配置|ULI_TAC|00020095
策略类型|控制条件|决策参数
---|---|---
套餐动态优先级策略|园区外|套餐失效
N7业务控制策略|园区内&应用标识=1002|动态PCC规则
业务配置关系 :图4  业务配置关系图

配置步骤 :配置基础信息。 
配置套餐。 
[ADD PKGINFO]:PKGID="3",PRIORITY=1;
配置套餐业务基本配置。 
[ADD PKGSVC]:ID=1,PKGID="3",SUBSID="1";
配置应用标识。 
[ADD APPSUBS]:APPID=1002,APPDESC="业务1",SUBSID="1",SUBSDESC="1";
配置上报事件。 
[ADD PCEFEVENT]:ID=1,PKGID="3",USERLOC="YES";
配置业务特征流。 
[ADD SVCFLOWCHR]:ID=1,PROTOCOL=255,SERVERIPADDR="0.0.0.0",MASK="0.0.0.0",SERVERPORT=0,SERVERPORTMAX=0,DIRECT="BOTH",CLTIPADDRSRC="ANY",APPID=1002
配置号码映射策略变量（BEGINVALUE和ENDVALUE取值需为8位的字符串，配置中取值为10进制，对应消息中字段tac取值为16进制） 
[ADD NUMABS]:ID=1,SVCKEY="ULI_TAC",BEGINVALUE="00020095",ENDVALUE="00020095",ABSATTRID=100,REMARK="";
配置规则条件。 
条件名称|参数|取值
---|---|---
ULI_TAC_100|选择策略变量|其他
策略变量类别|ULI_TAC_100|映射策略变量
策略变量|ULI_TAC_100|ULI TAC映射标识
操作符|ULI_TAC_100|IFHave
值类型|ULI_TAC_100|值
值|ULI_TAC_100|100
条件名称|参数|取值
---|---|---
cond_appid_1002|选择策略变量|其他
策略变量类别|cond_appid_1002|IP-CAN会话信息类
策略变量|cond_appid_1002|Gx应用标识
操作符|cond_appid_1002|=
值类型|cond_appid_1002|值
值|cond_appid_1002|1002
配置规则动作参数。 
动作参数名称|参数名称|取值
---|---|---
action_invalid|动作参数类型|套餐动态属性参数集
套餐有效标识|action_invalid|无效
动作参数名称|参数名称|取值
---|---|---
action_qos|动作参数类型|QoS参数集
QoS控制策略ID|action_qos|qos1
5QI|action_qos|9
最大上行带宽(kbps)|action_qos|300
最大下行带宽(kbps)|action_qos|500
保障上行带宽(kbps)|action_qos|300
保障下行带宽(kbps)|action_qos|500
ARP优先级|action_qos|1
ARP抢占能力|action_qos|不允许抢占
ARP被抢占能力|action_qos|不允许被抢占
动作参数名称|参数名称|取值
---|---|---
action_chg|动作参数类型|Charging参数集
计费控制策略ID|action_chg|chg1
计费度量方式|action_chg|时长
离线计费|action_chg|关闭
在线计费|action_chg|关闭
费率组|action_chg|1
计费上报等级|action_chg|业务标识等级
计费业务标识|action_chg|1
动作参数名称|参数名称|取值
---|---|---
action_dnai_1|动作参数类型|路由目的地参数集
DNAI|action_dnai_1|1
动作参数名称|参数名称|取值
---|---|---
action_tc|动作参数类型|TC参数集
流量控制策略ID|action_tc|1
路由目的地|action_tc|action_dnai_1
动作参数名称|参数名称|取值
---|---|---
action_pcc|动作参数类型|N7 PCC规则参数集
PCC规则类型|action_pcc|动态规则
规则名|action_pcc|DNAI1
业务标识|action_pcc|1002
优先级|action_pcc|10（取值范围：[0,255]）
QoS控制策略ID|action_pcc|action_qos
流量控制策略ID|action_pcc|action_tc
计费控制策略ID|action_pcc|action_chg
配置场景。 
场景名称|参数|取值
---|---|---
PolicyByTac|入口1|入口类型|用户信息类
已选入口|PolicyByTac|入口1|用户套餐
取值|PolicyByTac|入口1|3
策略类型|PolicyByTac|N7业务控制策略|rule_pcc
套餐动态优先级策略|策略类型|PolicyByTac|rule_invalid
规则名称|规则参数|参数取值
---|---|---
rule_pcc|优先级|1
动作类型|rule_pcc|参数填充
日志开关|rule_pcc|关闭
条件表达式|rule_pcc|{ULI_TAC_100}&{cond_appid_1002}
选中动作参数名称|rule_pcc|action_pcc
规则名称|规则参数|参数取值
---|---|---
rule_invalid|优先级|1
动作类型|rule_invalid|参数填充
日志开关|rule_invalid|关闭
条件表达式|rule_invalid|~{ULI_TAC_100}
选中动作参数名称|rule_invalid|action_invalid
配置脚本 ://套餐配置 
ADD PKGINFO:PKGID="3",PRIORITY=1; 
//套餐业务基本配置 
ADD PKGSVC:ID=1,PKGID="3",SUBSID="1"; 
//应用标识配置 
ADD APPSUBS:APPID=1002,APPDESC="业务1",SUBSID="1",SUBSDESC="1"; 
//上报事件配置 
ADD PCEFEVENT:ID=1,PKGID="3",USERLOC="YES"; 
//业务特征流配置 
ADD SVCFLOWCHR:ID=1,PROTOCOL=255,SERVERIPADDR="0.0.0.0",MASK="0.0.0.0",SERVERPORT=0,SERVERPORTMAX=0,DIRECT="BOTH",CLTIPADDRSRC="ANY",APPID=1002
//号码映射策略变量配置 
ADD NUMABS:ID=1,SVCKEY="ULI_TAC",BEGINVALUE="00020095",ENDVALUE="00020095",ABSATTRID=100,REMARK="";
//PLMN条件配置（园区内） 
ADD DM COND:NAME="ULI_TAC_100",SVCKEY="SYS.GX_ULI_TAC_ATTR_ID",OPERATOR="IfHave",VALTYPE="VALUE",VALUE="100";
//应用标识条件配置 
ADD DM COND:NAME="cond_appid_1002",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1002";
//套餐动态属性动作参数（园区外） 
ADD DM ACTION:NAME="action_invalid",TYPE="PKG_PRIOR",PARAMS="SYS.PKG_VALID_INDIC"-"0"-"INVALID";
//QoS动作参数 
ADD DM ACTION:NAME="action_qos",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"qos1"&"SYS.QOS_5QI"-"0"-"9"&"SYS.QOS_MBR_UL"-"0"-"300"&"SYS.QOS_MBR_DL"-"0"-"500"&"SYS.QOS_GBR_UL"-"0"-"300"&"SYS.QOS_GBR_DL"-"0"-"500"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"NOT_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
//Charging动作参数 
ADD DM ACTION:NAME="action_chg",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"chg1"&"SYS.CHG_METERING_METHOD"-"0"-"DURATION"&"SYS.CHG_OFFLINE"-"0"-"DISABLE"&"SYS.CHG_ONLINE"-"0"-"DISABLE"&"SYS.CHG_RATING_GROUP"-"0"-"1"&"SYS.CHG_REPORTING_LEVEL"-"0"-"SERVICE_IDENTIFIER_LEVEL"&"SYS.CHG_SERVICE_ID"-"0"-"1";
//路由目的地动作参数 
ADD DM ACTION:NAME="action_dnai_1",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"0"-"1";
//TC动作参数 
ADD DM ACTION:NAME="action_tc",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"1"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"action_dnai_1";
//N7业务决策动作参数（园区内） 
ADD DM ACTION:NAME="action_pcc",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"DNAI1"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_APPID"-"0"-"1002"&"SYS.N7_PCC_PRECEDENCE"-"0"-"10"&"SYS.N7_PCC_QoS_ID"-"0"-"action_qos"&"SYS.N7_PCC_TC_ID"-"0"-"action_tc"&"SYS.N7_PCC_CHARGING_ID"-"0"-"action_chg";
//套餐动态优先级策略规则 
ADD DM RULE:NAME="rule_invalid",PLCTYPE="PKG_PRIOR",PRIOR=1,CONDEXP="~{ULI_TAC_100}",ACTTYPE="PARAM",ACTNAME="action_invalid",LOGFLAG="OFF",RULENO=0;
//N7业务控制策略规则 
ADD DM RULE:NAME="rule_pcc",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=1,CONDEXP="{ULI_TAC_100}&{cond_appid_1002}",ACTTYPE="PARAM",ACTNAME="action_pcc",LOGFLAG="OFF",RULENO=0;
//场景规则关联配置 
ADD DM ROLE:NAME="PolicyByTac",ENTRANCE="SYS.USER_PAK_ID"-"3",RULENAME="rule_invalid"&"rule_pcc",VALIDFLAG="ENABLE";
##### 配置接入和移动性策略控制 
##### 配置接入和移动性策略控制 
配置说明 :ZXUN RCP的接入和移动性策略控制特性主要是通过配置不同的接入移动策略动作参数，设置不同条件下使用不同的RFSP Index和业务区域限制，达到对接入和移动下性策略进行控制的目的。
配置前提 :接入和移动策略控制特性是RCP和AMF配合共同完成的，因此在配置此特性之前保证两个网元的功能及交互正常。
配置过程 :图1  配置过程

配置过程包含如下几个步骤： 
在EM客户端配置页面的Npcf_PolicyManagement_0服务下，执行[ADD PKGINFO]命令新增基本的套餐信息。
在EM客户端配置页面的Npcf_PolicyManagement_0服务下，配置条件、动作参数、规则和场景配置。
###### 配置实例-用户注册时的接入和移动策略控制 
配置场景 :用户接入时，根据签约信息下发相应的接入移动策略规则。 
数据规划 :类别|参数|取值
---|---|---
套餐|编号|1
套餐类型|套餐|用户套餐
策略类型|控制条件|决策参数
---|---|---
AMF接入移动策略|无|RFSP索引=2允许区域=1111
业务配置关系 :图2  业务配置关系

配置步骤 :配置套餐。 
[ADD PKGINFO]:PKGID="1",PRIORITY=1;
配置动作参数。 
动作参数名称|参数名称|取值
---|---|---
allowed_tac1|动作参数类型|N15限制服务区域参数集
服务区域类型|allowed_tac1|TAC
TAC|allowed_tac1|1111
动作参数名称|参数名称|取值
---|---|---
action_amf|动作参数类型|接入移动策略参数集
RFSP索引|action_amf|2
服务区域限制决策方式|action_amf|配置
服务区域限制类型|action_amf|允许
限制服务区域操作集ID|action_amf|allowed_tac1
配置场景。 
场景名称|参数|取值
---|---|---
PolicyAMF|入 口1|入口类型|用户信息类
已选入口|PolicyAMF|入 口1|用户套餐
取值|PolicyAMF|入 口1|1
策略类型|PolicyAMF|AMF 接入移动策略|rule_amf
规则名称|规则参数|参数取值
---|---|---
rule_amf|优先级|10
动作类型|rule_amf|参数填充
日志开关|rule_amf|关闭
条件表达式|rule_amf|无
选中动作参数名称|rule_amf|action_amf
配置脚本 :/*Role:PolicyAMF---Start*/ 
[ADD DM ACTION]:NAME="allowed_tac1",TYPE="N15_SERV_AREA_RESTRICT",PARAMS="SYS.N15_SERVICE_AREA_TYPE"-"0"-"TAC"&"SYS.N15_SERVICE_AREA_TAC"-"0"-"1111";
[ADD DM ACTION]:NAME="action_amf",TYPE="ACCESS_POLICY_PARA",PARAMS="SYS.RFSP_INDEX"-"0"-"2"&"SYS.SERVICE_AREA_RESTRICTION_DEC_METHOD"-"0"-"CONFIG"&"SYS.SERVICE_AREA_RESTRICTION_TYPE"-"0"-"ALLOW"&"SYS.SERVICE_AREA_RESTRICTION_ACT_ID"-"0"-"allowed_tac1";
[ADD DM RULE]:NAME="rule_amf",PLCTYPE="DM_RULE_TYPE_N15_DEC",PRIOR=10,CONDEXP="",ACTTYPE="PARAM",ACTNAME="action_amf",LOGFLAG="OFF",RULENO=0;
[ADD DM ROLE]:NAME="PolicyAMF",ENTRANCE="SYS.USER_PAK_ID"-"1",RULENAME="rule_amf",VALIDFLAG="ENABLE";
/*Role:PolicyAMF--End*/ 
###### 配置实例-移动性限制 
场景说明 :对签约了特定套餐（例如移动固网套餐）的用户，限制其在特定允许区域内使用业务，允许区域在UDM签约，PCF按AMF请求值下发就可以，如果套餐用量超限，PCF将允许区域置空，表示全部区域都不允许。
数据规划 :类别|参数|取值
---|---|---
套餐|编号|1
套餐类型|套餐|用户套餐
策略类型|控制条件|决策参数
---|---|---
AMF接入移动策略|用量未超限|按请求值下发允许区域
用量超限|AMF接入移动策略|将允许区域置空
######## 业务关系 
图3  业务关系

配置步骤 :配置套餐。 
[ADD PKGINFO]:PKGID="1",PRIORITY=1;
配置策略的条件。 
条件属性参数|取值
---|---
条件名称|userstatus=1
选择策略变量|其他
策略变量类别|用户信息类
策略变量|用户状态
操作符|=
值类型|值
值|1
配置策略的动作参数。 
动作参数名称|参数名称|取值
---|---|---
allowed_area|动作参数类型|N15限制服务区域参数集
服务区域类型|allowed_area|TAC
动作参数名称|参数名称|取值
---|---|---
act_limit|动作参数类型|接入移动策略参数集
服务区域限制决策方式|act_limit|配置
服务区域限制类型|act_limit|允许
限制服务区域操作集ID|act_limit|allowed_area
动作参数名称|参数名称|取值
---|---|---
act_req|动作参数类型|接入移动策略参数集
服务区域限制决策方式|act_req|请求
配置策略的控制规则。 
规则名称|规则参数|参数取值
---|---|---
rule_request|优先级|10
动作类型|rule_request|参数填充
日志开关|rule_request|关闭
条件表达式|rule_request|{用户状态 = 1}
选中动作参数名称|rule_request|act_req
规则名称|规则参数|参数取值
---|---|---
rule_limit|优先级|10
动作类型|rule_limit|参数填充
日志开关|rule_limit|关闭
条件表达式|rule_limit|~{用户状态 = 1}
选中动作参数名称|rule_limit|act_limit
配置场景。 
场景名称|参数|取值
---|---|---
role_amf|入口1|入口类型|用户信息类
已选入口|role_amf|入口1|用户套餐
取值|role_amf|入口1|1
策略类型|role_amf|AMF接入移动策略|rule_request
rule_limit|策略类型|role_amf|AMF接入移动策略
配置脚本 :/*Role:role_amf---Start*/ 
[ADD DM COND]:NAME="userstsus=1",SVCKEY="SYS.USER_STATUS",OPERATOR="=",VALTYPE="VALUE",VALUE="1";
[ADD DM ACTION]:NAME="act_req",TYPE="ACCESS_POLICY_PARA",PARAMS="SYS.SERVICE_AREA_RESTRICTION_DEC_METHOD"-"0"-"REQUEST";
[ADD DM ACTION]:NAME="allowed_area",TYPE="N15_SERV_AREA_RESTRICT",PARAMS="SYS.N15_SERVICE_AREA_TYPE"-"0"-"TAC";
[ADD DM ACTION]:NAME="act_limit",TYPE="ACCESS_POLICY_PARA",PARAMS="SYS.SERVICE_AREA_RESTRICTION_DEC_METHOD"-"0"-"CONFIG"&"SYS.SERVICE_AREA_RESTRICTION_TYPE"-"0"-"ALLOW"&"SYS.SERVICE_AREA_RESTRICTION_ACT_ID"-"0"-"allowed_area";
[ADD DM RULE]:NAME="rule_request",PLCTYPE="DM_RULE_TYPE_N15_DEC",PRIOR=10,CONDEXP="{userstsus=1}",ACTTYPE="PARAM",ACTNAME="act_req",LOGFLAG="OFF",RULENO=0;
[ADD DM RULE]:NAME="rule_limit",PLCTYPE="DM_RULE_TYPE_N15_DEC",PRIOR=10,CONDEXP="~{userstsus=1}",ACTTYPE="PARAM",ACTNAME="act_limit",LOGFLAG="OFF",RULENO=0;
[ADD DM ROLE]:NAME="role_amf",ENTRANCE="SYS.USER_PAK_ID"-"1",RULENAME="rule_request"&"rule_limit",VALIDFLAG="ENABLE";
/*Role:role_amf--End*/ 
##### 配置URSP策略控制 
##### 配置URSP策略控制 
配置说明 :配置URSP策略，实现PCF根据用户签约、接入网等信息为UE下发URSP策略，用于UE决定如何路由出局业务流。 
配置前提 :URSP策略需要RCP、AMF、PUDR配合共同完成的，需保证三个网元的功能及交互正常。 
配置过程 :URSP策略配置流程如[图1]所示。
图1  URSP配置流程

配置步骤： 
在EM-配置页面，Npcf_PolicyManagement_0 服务，进行UE策略业务流及路由基本元素配置。 
执行[ADD UEOSAPPID]命令，配置操作系统应用标识，用于UE策略下发流量描述符。
执行[ADD UESNSSAI]命令，配置单网络切片，用于UE策略下发网络切片信息。
在EM-配置页面，Npcf_PolicyManagement_0 服务，进行策略配置，包括配置条件、动作参数、规则和场景。 
执行[ADD DM COND]命令，配置条件。
执行[ADD DM ACTION]命令，配置动作。
执行[ADD DM RULE]命令，配置规则。
执行[ADD DM ROLE]命令，配置场景。
配置实例 :场景说明 :PCF下发NSSP策略，为应用提供切片选择。 
数据规划 :基本数据规划类别参数取值操作系统应用标识配置名称osid1操作系统标识01234567890123456789012345678901应用标识os1单网络切片配置名称NS1SST10SD111111 
UE路由选择策略规划策略类型控制条件决策参数UE路由选择策略用户套餐=1UE路由选择策略参数集 
业务配置关系 :业务配置关系如[图2]所示。
图2  业务配置关系图

配置步骤 :配置基础数据。 
配置操作系统应用标识。 
[ADD UEOSAPPID]:NAME="osid1",OSID="01234567890123456789012345678901",APPID="os1"
配置单网络切片。 
[ADD UESNSSAI]:NAME="NS1",SST=10,SD=111111
配置UE策略。 
配置接入条件。 
条件名称|参数|取值
---|---|---
接入类型3GPP|选择策略变量|其他
策略变量类别|接入类型3GPP|接入信息类
策略变量|接入类型3GPP|接入类型
操作符|接入类型3GPP|=
值类型|接入类型3GPP|值
值|接入类型3GPP|3GPP接入
配置动作参数。 
动作参数名称|参数|取值
---|---|---
UE路由选择参数|动作参数类型|UE路由选择策略参数集
URSP规则参数集ID|UE路由选择参数|URSP
动作参数名称|参数|取值
---|---|---
URSP规则参数|动作参数类型|URSP规则参数集
URSP规则名|URSP规则参数|URSP
业务流描述参数集ID|URSP规则参数|UE业务流参数
路由选择描述参数集ID|URSP规则参数|UE路由选择描述
动作参数名称|参数|取值
---|---|---
UE业务流参数|动作参数类型|UE业务流描述参数集
业务流类型|UE业务流参数|OS Id + OS App ID
操作系统应用标识|UE业务流参数|osid1
动作参数名称|参数|取值
---|---|---
UE路由选择描述|动作参数类型|UE路由选择描述参数集
SNSSAI|UE路由选择描述|NS1
配置规则。 
规则名称|参数|取值
---|---|---
UERule|优先级|1
动作类型|UERule|参数填充
日志开关|UERule|关闭
选中动作参数名称|UERule|UE路由选择参数
选中条件名称|UERule|接入类型3GPP
配置场景。 
场景名称|参数|取值
---|---|---
UERoute|入口1|入口类型|用户信息类
已选入口|UERoute|入口1|用户套餐
取值|UERoute|入口1|1
配置脚本 ://配置基础数据 
ADD UEOSAPPID:NAME="osid1",OSID="01234567890123456789012345678901",APPID="os1"
ADD UESNSSAI:NAME="NS1",SST=10,SD=100
//配置UE策略 
ADD DM COND:NAME="接入类型3GPP",SVCKEY="SYS.ACCESS_TYPE",OPERATOR="=",VALTYPE="VALUE",VALUE="3GPP_ACCESS";
ADD DM ACTION:NAME="UE业务流参数",TYPE="UE_TRAFFIC",PARAMS="SYS.URSP_TRAF_TYPE"-"VALUE"-"OSAPPID"&"SYS.URSP_TRAF_OS_APPID"-"VALUE"-"osid1";
ADD DM ACTION:NAME="UE路由选择描述",TYPE="UE_ROUTE_DESC",PARAMS="SYS.URSD_PRECEDENCE"-"VALUE"-"1"&"SYS.URSD_SNSSAI"-"VALUE"-"NS1";
ADD DM ACTION:NAME="URSP规则参数",TYPE="URSP_RULE_DESC",PARAMS="SYS.URSP_RULE_NAME"-"VALUE"-"URSP"&"SYS.URSP_RULE_UPSC"-"VALUE"-"1"&"SYS.URSP_RULE_PRECEDENCE"-"VALUE"-"1"&"SYS.URSP_RULE_TRAF_DESC_ACT_ID"-"VALUE"-"UE业务流参数"&"SYS.URSP_RULE_URSD_ACT_ID"-"VALUE"-"UE路由选择描述";
ADD DM ACTION:NAME="UE路由选择参数",TYPE="UE_ROUTE_POLICY",PARAMS="SYS.URSP_RULE_ACT_ID"-"VALUE"-"URSP规则参数";
ADD DM RULE:NAME="UERule",PLCTYPE="DM_RULE_TYPE_UE_URSP_DEC",PRIOR=1,CONDEXP="{接入类型3GPP}",ACTTYPE="PARAM",ACTNAME="UE路由选择参数",LOGFLAG="OFF",RULENO=0;
ADD DM ROLE:NAME="UERoute",ENTRANCE="SYS.USER_PAK_ID"-"1",RULENAME="UERule",VALIDFLAG="ENABLE";
#### 套餐业务类 
##### 配置VoNR 
##### 配置VoNR 
配置说明 :ZXUN RCP的VoNR特性主要是通过配置不同的PCC规则，设置不同媒体映射不同的PCC规则，建立语音、视频专载，达到对用户通话进行保障的目的。
配置前提 :VoNR特性是RCP和SMF以及AF配合共同完成的，因此在配置此特性之前保证三个网元的功能及交互正常。
对于N7接口，RCP与SMF之间的链路配置，SMF邻接局配置以及承载能力配置。 
对于Rx接口，RCP与AF之间的链路配置，AF邻接局配置。 
配置过程 :图1  配置流程

在EM→配置
页面中，执行如下配置过程：
配置AF能力。
在Npcf_PolicyManagement_0服务下，执行[ADD
AFABILITY]命令，配置AF授权响应方式。
在Npcf_PolicyManagement_0服务下，执行[ADD
DEFAFAPP]命令，配置默认AF应用标识。
在Npcf_PolicyManagement_0服务下，执行[ADD
EMERGAPN]命令，配置IMS域APN的类型。
配置业务映射。 
在Npcf_PolicyManagement_0服务下，执行[ADD
AFAPPMEDIA]命令，配置AF业务应用标识映射。
在Npcf_PolicyManagement_0服务下，执行[ADD
APPSUBS]命令，配置应用标识属性。
在Npcf_PolicyManagement_0服务下，进入策略管理页面，配置基于VoLTE业务的控制策略。
在Npcf_PolicyManagement_0服务下，进入策略管理页面，提交配置的策略数据。
###### 配置实例1-用户使用VoNR视频呼叫 
配置场景 :用户从ims APN接入使用VoNR视频呼叫业务（AF应用标识为ims）。AF发送请求RCP进行资源预留，RCP为该视频呼叫下发策略，指示SMF为音频媒体建立QCI为1的专有承载，为视频媒体建立QCI为2专有承载，保障用户的语音和视频通话质量。语音和视频的QoS带宽参数由AF网元提供。
数据规划 :数据规划参见下表： 
类别|参数|取值
---|---|---
APN|APN值|ims
类型|APN|VoLTE_APN
AF应用标识|AF请求|ims
默认参数|AF应用标识|10001
Gx应用标识|音频媒体RTP流|1050000004
音频媒体RTCP流|Gx应用标识|1050000006
视频媒体RTP流|Gx应用标识|1050000005
视频媒体RTCP流|Gx应用标识|1050000007
AF信令|Gx应用标识|1050000003
业务标识|音频业务标识|1
视频业务标识|业务标识|2
AF信令|业务标识|3
策略规划参见下表： 
类别|条件|动作参数
---|---|---
业务规则|Gx应用标识=1050000004|规则名=volte_audio，QCI=1
Gx应用标识=1050000006|业务规则|规则名=volte_audio_rtcp，QCI=1
Gx应用标识=1050000005|业务规则|规则名=volte_video，QCI=2
Gx应用标识=1050000007|业务规则|规则名=volte_video_rtcp，QCI=2
Gx应用标识=1050000003|业务规则|规则名=volte_afsignalling，QCI=5
业务配置关系图 :业务配置关系如[图2]所示。
图2  业务配置关系图

配置步骤 :配置基础信息。
配置邻接主机组。 
[ADD ADJHOSTGRP]:ADJHOSTGRPID=10,HOSTTYPE="SMF"
配置邻接主机通配配置。 
现场根据实际信息配置，如AF有具体的主机名，优先配置具体的主机名称。 
[ADD ADJHOSTWD]:ADJHOSTID=10,HOSTNAME="*",HOSTTYPE="SMF",ADJHOSTGRPID=11,PRIOR=1
[ADD ADJHOSTWD]:ADJHOSTID=11,HOSTNAME="*.ims.mnc011.mcc460.3gppnetwork.org",HOSTTYPE="3GPP-AF",ADJHOSTGRPID=0
[ADD ADJHOSTWD]:ADJHOSTID=12,HOSTNAME="*.epc.mnc011.mcc460.3gppnetwork.org",HOSTTYPE="3GPP-AF",ADJHOSTGRPID=0
配置承载能力。 
[ADD BEARABILITY]:ADJHOSTGRPID=10,INTERFACE="PGW",SERVMODE="SERVICEID",PREDIST="YES",TIMERULENUM=0,REVALIDTIME="NO",SVCREDIRECT="NO",BEARCTRMODE="UE_NW",SESSCCTIME="YES",SVCCCTIME="YES",SESSCHARGE="NO",ROAMCOND="MCCMNC",RELRGCHG="NO",ACC3GPPQRY="YES",TRUSTWLANQRY="YES",UNTRUSTWLANQRY="YES",EXTENDBW="YES"
配置AF能力。 
[ADD AFABILITY]:ADJHOSTID=11
[ADD AFABILITY]:ADJHOSTID=12
配置默认AF应用标识。 
[ADD DEFAFAPP]:INTERFACETYPE="Rx",AFAI="10001";
配置IMS域APN。 
[ADD EMERGAPN]:APN="IMS_APN",TYPE="VOLTE_APN";
配置AF应用标识映射配置。 
AFAI根据现场实际情况配置。 
[ADD AFAPPMEDIA]:ID=12,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=13,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=14,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="UP",APPID=1050000006;
[ADD AFAPPMEDIA]:ID=15,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="DOWN",APPID=1050000006;
[ADD AFAPPMEDIA]:ID=16,AFAI="ims",MEDIATYPE="VIDEO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1050000005;
[ADD AFAPPMEDIA]:ID=17,AFAI="ims",MEDIATYPE="VIDEO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1050000005;
[ADD AFAPPMEDIA]:ID=18,AFAI="ims",MEDIATYPE="VIDEO",FLOWUSE="RTCP",FLOWDIRECT="UP",APPID=1050000007;
[ADD AFAPPMEDIA]:ID=19,AFAI="ims",MEDIATYPE="VIDEO",FLOWUSE="RTCP",FLOWDIRECT="DOWN",APPID=1050000007;
[ADD AFAPPMEDIA]:ID=20,AFAI="ims",MEDIATYPE="OTHER",FLOWUSE="AFSIGNAL",FLOWDIRECT="UP",APPID=1050000003;
[ADD AFAPPMEDIA]:ID=21,AFAI="ims",MEDIATYPE="OTHER",FLOWUSE="AFSIGNAL",FLOWDIRECT="DOWN",APPID=1050000003;
若AF请求中不携带AF-Application-Identifier，则上述配置中的AFAI需要替换为“默认AF应用标识配置”中的内容，其他不变。 
[ADD AFAPPMEDIA]:ID=1,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=2,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=3,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="UP",APPID=1050000006;
[ADD AFAPPMEDIA]:ID=4,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="DOWN",APPID=1050000006;
[ADD AFAPPMEDIA]:ID=5,AFAI="10001",MEDIATYPE="VIDEO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1050000005;
[ADD AFAPPMEDIA]:ID=6,AFAI="10001",MEDIATYPE="VIDEO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1050000005;
[ADD AFAPPMEDIA]:ID=7,AFAI="10001",MEDIATYPE="VIDEO",FLOWUSE="RTCP",FLOWDIRECT="UP",APPID=1050000007;
[ADD AFAPPMEDIA]:ID=8,AFAI="10001",MEDIATYPE="VIDEO",FLOWUSE="RTCP",FLOWDIRECT="DOWN",APPID=1050000007;
[ADD AFAPPMEDIA]:ID=9,AFAI="10001",MEDIATYPE="OTHER",FLOWUSE="AFSIGNAL",FLOWDIRECT="UP",APPID=1050000003;
[ADD AFAPPMEDIA]:ID=10,AFAI="10001",MEDIATYPE="OTHER",FLOWUSE="AFSIGNAL",FLOWDIRECT="DOWN",APPID=1050000003;
配置应用标识。 
[ADD APPSUBS]:APPID=1050000004,APPDESC="audio",SUBSID="1",SUBSDESC="audio",PREPROV="NO";
[ADD APPSUBS]:APPID=1050000006,APPDESC="audio_rtcp",SUBSID="1",SUBSDESC="audio_rtcp",PREPROV="NO";
[ADD APPSUBS]:APPID=1050000005,APPDESC="video",SUBSID="2",SUBSDESC="video",PREPROV="NO";
[ADD APPSUBS]:APPID=1050000007,APPDESC="video_rtcp",SUBSID="2",SUBSDESC="video_rtcp",PREPROV="NO";
[ADD APPSUBS]:APPID=1050000003,APPDESC="af-signal",SUBSID="3",SUBSDESC="af-signal",PREPROV="NO";
配置系统全局变量。 
[SET SYS GLOBPARA]:IDX=1081,CURVAL="1",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1082,CURVAL="1",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1006,CURVAL="0",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1116,CURVAL="2",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1135,CURVAL="1",EXTFLAG=0
配置规则条件。
条件名称|参数|取值
---|---|---
ims apn|选择策略变量|其他
策略变量类别|ims apn|会话信息类
策略变量|ims apn|APN
操作符|ims apn|In
参考值|ims apn|ims
1050000004_audio|选择策略变量|其他
策略变量类别|1050000004_audio|会话信息类
策略变量|1050000004_audio|Gx应用标识
操作符|1050000004_audio|=
参考值|1050000004_audio|1050000004
1050000006_audio_rtcp|选择策略变量|其他
策略变量类别|1050000006_audio_rtcp|会话信息类
策略变量|1050000006_audio_rtcp|Gx应用标识
操作符|1050000006_audio_rtcp|=
参考值|1050000006_audio_rtcp|1050000006
1050000005_video|选择策略变量|其他
策略变量类别|1050000005_video|会话信息类
策略变量|1050000005_video|Gx应用标识
操作符|1050000005_video|=
参考值|1050000005_video|1050000005
1050000007_video_rtcp|选择策略变量|其他
策略变量类别|1050000007_video_rtcp|会话信息类
策略变量|1050000007_video_rtcp|Gx应用标识
操作符|1050000007_video_rtcp|=
参考值|1050000007_video_rtcp|1050000007
1050000003_afsignalling|选择策略变量|其他
策略变量类别|1050000003_afsignalling|会话信息类
策略变量|1050000003_afsignalling|Gx应用标识
操作符|1050000003_afsignalling|=
参考值|1050000003_afsignalling|1050000003
配置规则动作参数。
业务控制策略动作参数 
动作参数名称|参数名称|取值
---|---|---
VOLTE_N7_default_5QI|参数类型|N7会话参数集
会话规则ID|VOLTE_N7_default_5QI|volte_session
5QI|VOLTE_N7_default_5QI|5
ARP优先级|VOLTE_N7_default_5QI|1
ARP抢占能力|VOLTE_N7_default_5QI|可以抢占
ARP被抢占能力|VOLTE_N7_default_5QI|不允许被抢占
VOLTE_N7_RG_1050000004|参数类型|Charging参数集
计费控制策略ID|VOLTE_N7_RG_1050000004|audio
费率组|VOLTE_N7_RG_1050000004|1050000004
VOLTE_N7_qci1_arp2|参数类型|QoS参数集
QoS控制策略ID|VOLTE_N7_qci1_arp2|audio_rtp
5QI|VOLTE_N7_qci1_arp2|1
ARP优先级|VOLTE_N7_qci1_arp2|2
ARP抢占能力|VOLTE_N7_qci1_arp2|可以抢占
ARP被抢占能力|VOLTE_N7_qci1_arp2|不允许被抢占
VOLTE_N7_qci1_arp2_2|参数类型|QoS参数集
QoS控制策略ID|VOLTE_N7_qci1_arp2_2|audio_rtcp
5QI|VOLTE_N7_qci1_arp2_2|1
ARP优先级|VOLTE_N7_qci1_arp2_2|2
ARP抢占能力|VOLTE_N7_qci1_arp2_2|可以抢占
ARP被抢占能力|VOLTE_N7_qci1_arp2_2|不允许被抢占
VOLTE_N7_audio|参数类型|N7 PCC规则参数集
PCC规则ID|VOLTE_N7_audio|volte_audio
PCC规则类型|VOLTE_N7_audio|动态规则
优先级|VOLTE_N7_audio|0
QoS控制策略ID|VOLTE_N7_audio|VOLTE_N7_qci1_arp2
计费控制策略ID|VOLTE_N7_audio|VOLTE_N7_RG_1050000004
VOLTE_N7_audio_rtcp|参数类型|N7 PCC规则参数集
PCC规则ID|VOLTE_N7_audio_rtcp|volte_audio_rtcp
PCC规则类型|VOLTE_N7_audio_rtcp|动态规则
优先级|VOLTE_N7_audio_rtcp|1
QoS控制策略ID|VOLTE_N7_audio_rtcp|VOLTE_N7_qci1_arp2_2
计费控制策略ID|VOLTE_N7_audio_rtcp|VOLTE_N7_RG_1050000004
VOLTE_N7_RG_1050000005|参数类型|Charging参数集
计费控制策略ID|VOLTE_N7_RG_1050000005|video
费率组|VOLTE_N7_RG_1050000005|1050000005
VOLTE_N7_qci2_arp4|参数类型|QoS参数集
QoS控制策略ID|VOLTE_N7_qci2_arp4|video_rtp
5QI|VOLTE_N7_qci2_arp4|2
ARP优先级|VOLTE_N7_qci2_arp4|4
ARP抢占能力|VOLTE_N7_qci2_arp4|可以抢占
ARP被抢占能力|VOLTE_N7_qci2_arp4|不允许被抢占
VOLTE_N7_qci2_arp4_2|参数类型|QoS参数集
QoS控制策略ID|VOLTE_N7_qci2_arp4_2|video_rtcp
5QI|VOLTE_N7_qci2_arp4_2|2
ARP优先级|VOLTE_N7_qci2_arp4_2|4
ARP抢占能力|VOLTE_N7_qci2_arp4_2|可以抢占
ARP被抢占能力|VOLTE_N7_qci2_arp4_2|不允许被抢占
VOLTE_N7_video|参数类型|N7 PCC规则参数集
PCC规则ID|VOLTE_N7_video|volte_video
PCC规则类型|VOLTE_N7_video|动态规则
优先级|VOLTE_N7_video|2
QoS控制策略ID|VOLTE_N7_video|VOLTE_N7_qci2_arp4
计费控制策略ID|VOLTE_N7_video|VOLTE_N7_RG_1050000005
VOLTE_N7_video_rtcp|参数类型|N7 PCC规则参数集
PCC规则ID|VOLTE_N7_video_rtcp|volte_video_rtcp
PCC规则类型|VOLTE_N7_video_rtcp|动态规则
优先级|VOLTE_N7_video_rtcp|3
QoS控制策略ID|VOLTE_N7_video_rtcp|VOLTE_N7_qci2_arp4_2
计费控制策略ID|VOLTE_N7_video_rtcp|VOLTE_N7_RG_1050000005
VOLTE_N7_RG_1050000003|参数类型|Charging参数集
计费控制策略ID|VOLTE_N7_RG_1050000003|afsignalling
费率组|VOLTE_N7_RG_1050000003|1050000003
VOLTE_N7_qci5|参数类型|QoS参数集
QoS控制策略ID|VOLTE_N7_qci5|afsignalling
5QI|VOLTE_N7_qci5|5
最大上行带宽(kbps)|VOLTE_N7_qci5|10
最大下行带宽(kbps)|VOLTE_N7_qci5|10
保障上行带宽(kbps)|VOLTE_N7_qci5|10
保障下行带宽(kbps)|VOLTE_N7_qci5|10
ARP优先级|VOLTE_N7_qci5|1
ARP抢占能力|VOLTE_N7_qci5|可以抢占
ARP被抢占能力|VOLTE_N7_qci5|不允许被抢占
VOLTE_N7_afsignalling|参数类型|N7 PCC规则参数集
PCC规则ID|VOLTE_N7_afsignalling|volte_afsignalling
PCC规则类型|VOLTE_N7_afsignalling|动态规则
优先级|VOLTE_N7_afsignalling|4
QoS控制策略ID|VOLTE_N7_afsignalling|VOLTE_N7_qci5
计费控制策略ID|VOLTE_N7_afsignalling|VOLTE_N7_RG_1050000003
配置场景。
场景规则关联配置。 
场景名称|参数|取值
---|---|---
VOLTE_ims|入口1|入口类型|会话信息类
已选入口|VOLTE_ims|入口1|APN
取值|VOLTE_ims|入口1|ims
策略类型|VOLTE_ims|N7会话决策|VOLTE_N7_Default_5QI
N7业务决策|策略类型|VOLTE_ims|VOLTE_N7_audio
VOLTE_N7_audio_rtcp|N7业务决策|策略类型|VOLTE_ims
VOLTE_N7_video|N7业务决策|策略类型|VOLTE_ims
VOLTE_N7_video_rtcp|N7业务决策|策略类型|VOLTE_ims
VOLTE_N7_afsignalling|N7业务决策|策略类型|VOLTE_ims
业务控制策略规则。 
规则名称|参数|取值
---|---|---
VOLTE_N7_Default_5QI|优先级|55
动作类型|VOLTE_N7_Default_5QI|参数填充
日志开关|VOLTE_N7_Default_5QI|关
条件表达式|VOLTE_N7_Default_5QI|{APN In ims}
动作参数名称|VOLTE_N7_Default_5QI|VOLTE_N7_default_5QI
VOLTE_N7_audio|优先级|55
动作类型|VOLTE_N7_audio|参数填充
日志开关|VOLTE_N7_audio|关
条件表达式|VOLTE_N7_audio|{Gx应用标识 = 1050000004}
动作参数名称|VOLTE_N7_audio|VOLTE_N7_audio
VOLTE_N7_audio_rtcp|优先级|55
动作类型|VOLTE_N7_audio_rtcp|参数填充
日志开关|VOLTE_N7_audio_rtcp|关
条件表达式|VOLTE_N7_audio_rtcp|{Gx应用标识 = 1050000006}
动作参数名称|VOLTE_N7_audio_rtcp|VOLTE_N7_audio_rtcp
VOLTE_N7_video|优先级|55
动作类型|VOLTE_N7_video|参数填充
日志开关|VOLTE_N7_video|关
条件表达式|VOLTE_N7_video|{Gx应用标识 = 1050000005}
动作参数名称|VOLTE_N7_video|VOLTE_N7_video
VOLTE_N7_video_rtcp|优先级|55
动作类型|VOLTE_N7_video_rtcp|参数填充
日志开关|VOLTE_N7_video_rtcp|关
条件表达式|VOLTE_N7_video_rtcp|{Gx应用标识 = 1050000007}
动作参数名称|VOLTE_N7_video_rtcp|VOLTE_N7_video_rtcp
VOLTE_N7_afsignalling|优先级|55
动作类型|VOLTE_N7_afsignalling|参数填充
日志开关|VOLTE_N7_afsignalling|关
条件表达式|VOLTE_N7_afsignalling|{Gx应用标识 = 1050000003}
动作参数名称|VOLTE_N7_afsignalling|VOLTE_N7_afsignalling
配置脚本 :/*Role:VOLTE_ims---Start*/ 
ADD DM COND:NAME="ims apn",SVCKEY="SYS.GX_APN",OPERATOR="In",VALTYPE="VALUE",VALUE="ims"&"ims1";
ADD DM COND:NAME="1050000004_audio",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000004";
ADD DM COND:NAME="1050000006_audio_rtcp",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000006";
ADD DM COND:NAME="1050000005_video",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000005";
ADD DM COND:NAME="1050000007_video_rtcp",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000007";
ADD DM COND:NAME="1050000003_afsignalling",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000003";
ADD DM ACTION:NAME="VOLTE_default_QCI",TYPE="BEARER_CTRL",PARAMS="SYS.BEAR_QCI"-"0"-"5"&"SYS.BEAR_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.BEAR_ARP_PRE_EMPTION_CAP"-"0"-"PRE-EMPTION_CAPABILITY_ENABLED"&"SYS.BEAR_ARP_PRE_EMPTION_VULNERABILITY"-"0"-"PRE-EMPTION_VULNERABILITY_DISABLED";
ADD DM ACTION:NAME="volte_audio",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"2"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000004"&"SYS.QOS_CLASS"-"0"-"1"&"SYS.PRE_PRECEDENCE"-"0"-"0"&"SYS.PRE_RATING_GROUP"-"0"-"1050000004"&"SYS.SERVICE_ID"-"0"-"1050000004"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_audio";
ADD DM ACTION:NAME="volte_audio_rtcp",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"2"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000006"&"SYS.QOS_CLASS"-"0"-"1"&"SYS.PRE_PRECEDENCE"-"0"-"1"&"SYS.PRE_RATING_GROUP"-"0"-"1050000004"&"SYS.SERVICE_ID"-"0"-"1050000004"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_audio_rtcp";
ADD DM ACTION:NAME="volte_video",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"4"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000005"&"SYS.QOS_CLASS"-"0"-"2"&"SYS.PRE_PRECEDENCE"-"0"-"2"&"SYS.PRE_RATING_GROUP"-"0"-"1050000005"&"SYS.SERVICE_ID"-"0"-"1050000005"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_video";
ADD DM ACTION:NAME="volte_video_rtcp",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"4"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000007"&"SYS.QOS_CLASS"-"0"-"2"&"SYS.PRE_PRECEDENCE"-"0"-"3"&"SYS.PRE_RATING_GROUP"-"0"-"1050000005"&"SYS.SERVICE_ID"-"0"-"1050000005"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_video_rtcp";
ADD DM ACTION:NAME="volte_afsignalling",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"1"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000003"&"SYS.QOS_CLASS"-"0"-"5"&"SYS.MAX_BR_UL"-"0"-"10"&"SYS.MAX_BR_DL"-"0"-"10"&"SYS.GBR_UL"-"0"-"10"&"SYS.GBR_DL"-"0"-"10"&"SYS.PRE_PRECEDENCE"-"0"-"4"&"SYS.PRE_RATING_GROUP"-"0"-"1050000003"&"SYS.SERVICE_ID"-"0"-"1050000003"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_afsignalling";
ADD DM ACTION:NAME="VOLTE_N7_default_5QI",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"volte_session"&"SYS.DEF_QOS_5QI"-"0"-"5"&"SYS.DEF_QOS_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.DEF_QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.DEF_QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_RG_1050000004",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"audio"&"SYS.CHG_RATING_GROUP"-"0"-"1050000004"&"SYS.CHG_SERVICE_ID"-"0"-"1050000004";
ADD DM ACTION:NAME="VOLTE_N7_qci1_arp2",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"audio_rtp"&"SYS.QOS_5QI"-"0"-"1"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"2"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_audio",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_audio"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"0"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_qci1_arp2"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000004";
ADD DM ACTION:NAME="VOLTE_N7_qci1_arp2_2",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"audio_rtcp"&"SYS.QOS_5QI"-"0"-"1"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"2"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_audio_rtcp",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_audio_rtcp"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"1"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_qci1_arp2_2"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000004";
ADD DM ACTION:NAME="VOLTE_N7_RG_1050000005",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"video"&"SYS.CHG_RATING_GROUP"-"0"-"1050000005"&"SYS.CHG_SERVICE_ID"-"0"-"1050000005";
ADD DM ACTION:NAME="VOLTE_N7_qci2_arp4",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"video_rtp"&"SYS.QOS_5QI"-"0"-"2"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"4"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_video",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_video"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"2"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_qci2_arp4"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000005";
ADD DM ACTION:NAME="VOLTE_N7_qci2_arp4_2",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"video_rtcp"&"SYS.QOS_5QI"-"0"-"2"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"4"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_video_rtcp",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_video_rtcp"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"3"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_qci2_arp4_2"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000005";
ADD DM ACTION:NAME="VOLTE_N7_RG_1050000003",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"afsignalling"&"SYS.CHG_RATING_GROUP"-"0"-"1050000003"&"SYS.CHG_SERVICE_ID"-"0"-"1050000003";
ADD DM ACTION:NAME="VOLTE_N7_qci5",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"afsignalling"&"SYS.QOS_5QI"-"0"-"5"&"SYS.QOS_MBR_UL"-"0"-"10"&"SYS.QOS_MBR_DL"-"0"-"10"&"SYS.QOS_GBR_UL"-"0"-"10"&"SYS.QOS_GBR_DL"-"0"-"10"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_afsignalling",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_afsignalling"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"4"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_qci5"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000003";
ADD DM RULE:NAME="VOLTE_Default_QCI",PLCTYPE="BEARER_CTRL",PRIOR=1,CONDEXP="{ims apn}",ACTTYPE="PARAM",ACTNAME="VOLTE_default_QCI",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="volte_audio",PLCTYPE="SVC_CTRL",PRIOR=55,CONDEXP="{1050000004_audio}",ACTTYPE="PARAM",ACTNAME="volte_audio",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="volte_audio_rtcp",PLCTYPE="SVC_CTRL",PRIOR=55,CONDEXP="{1050000006_audio_rtcp}",ACTTYPE="PARAM",ACTNAME="volte_audio_rtcp",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="volte_video",PLCTYPE="SVC_CTRL",PRIOR=55,CONDEXP="{1050000005_video}",ACTTYPE="PARAM",ACTNAME="volte_video",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="volte_video_rctp",PLCTYPE="SVC_CTRL",PRIOR=55,CONDEXP="{1050000007_video_rtcp}",ACTTYPE="PARAM",ACTNAME="volte_video_rtcp",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="volte_afsignalling",PLCTYPE="SVC_CTRL",PRIOR=55,CONDEXP="{1050000003_afsignalling}",ACTTYPE="PARAM",ACTNAME="volte_afsignalling",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_Default_5QI",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=55,CONDEXP="{ims apn}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_default_5QI",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_audio",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=55,CONDEXP="{1050000004_audio}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_audio",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_audio_rtcp",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=55,CONDEXP="{1050000006_audio_rtcp}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_audio_rtcp",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_video",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=55,CONDEXP="{1050000005_video}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_video",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_video_rtcp",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=55,CONDEXP="{1050000007_video_rtcp}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_video_rtcp",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_afsignalling",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=55,CONDEXP="{1050000003_afsignalling}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_afsignalling",LOGFLAG="OFF",RULENO=0;
ADD DM ROLE:NAME="VOLTE_ims",ENTRANCE="SYS.GX_APN"-"ims",RULENAME="VOLTE_Default_QCI"&"volte_audio"&"volte_audio_rtcp"&"volte_video"&"volte_video_rctp"&"volte_afsignalling"&"VOLTE_N7_Default_5QI"&"VOLTE_N7_audio"&"VOLTE_N7_audio_rtcp"&"VOLTE_N7_video"&"VOLTE_N7_video_rtcp"&"VOLTE_N7_afsignalling",VALIDFLAG="ENABLE";
/*Role:VOLTE_ims--End*/ 
###### 配置实例2-用户使用VoNR紧急呼叫 
场景说明 :用户从sos APN接入使用VoNR紧急呼叫业务（AF应用标识为IMS_Call_AppID），紧急呼叫Service-URN为“sos”。AF从邻接局发送请求RCP进行资源预留，RCP为该紧急呼叫下发策略，指示SMF为音频媒体建立QCI为1的专有承载，并且其ARP抢占优先级为1，保障用户高优先级的语音通话质量。语音的QoS带宽参数由AF网元提供。
数据规划 :数据规则参见下表： 
类别|参数|取值
---|---|---
APN|APN值|sos
类型|APN|EMERG_APN
AF应用标识|AF请求|ims
默认参数|AF应用标识|10001
Gx应用标识|音频媒体RTP流|1050000004
音频媒体RTCP流|Gx应用标识|1050000006
业务标识|音频业务标识|1
策略规划参见下表： 
类别|条件|动作参数
---|---|---
业务规则|Gx应用标识=1050000004|规则名=volte_sos_audio，QCI=1
Gx应用标识=1050000006|业务规则|规则名=volte_sos_audio_rtcp，QCI=1
业务配置关系图 :业务配置关系如[图3]所示。
图3  业务配置关系图

配置步骤 :配置基础信息。
配置邻接主机组。 
[ADD ADJHOSTGRP]:ADJHOSTGRPID=10,HOSTTYPE="SMF"
配置邻接主机通配配置。 
现场根据实际信息配置，如AF有具体的主机名，优先配置具体的主机名。 
[ADD ADJHOSTWD]:ADJHOSTID=10,HOSTNAME="*",HOSTTYPE="SMF",ADJHOSTGRPID=11,PRIOR=1
[ADD ADJHOSTWD]:ADJHOSTID=11,HOSTNAME="*.ims.mnc011.mcc460.3gppnetwork.org",HOSTTYPE="3GPP-AF",ADJHOSTGRPID=0
[ADD ADJHOSTWD]:ADJHOSTID=12,HOSTNAME="*.epc.mnc011.mcc460.3gppnetwork.org",HOSTTYPE="3GPP-AF",ADJHOSTGRPID=0
配置承载能力。 
[ADD BEARABILITY]:ADJHOSTGRPID=10,INTERFACE="PGW",SERVMODE="SERVICEID",PREDIST="YES",TIMERULENUM=0,REVALIDTIME="NO",SVCREDIRECT="NO",BEARCTRMODE="UE_NW",SESSCCTIME="YES",SVCCCTIME="YES",SESSCHARGE="NO",ROAMCOND="MCCMNC",RELRGCHG="NO",ACC3GPPQRY="YES",TRUSTWLANQRY="YES",UNTRUSTWLANQRY="YES",EXTENDBW="YES"
配置AF能力。 
[ADD AFABILITY]:ADJHOSTID=11
[ADD AFABILITY]:ADJHOSTID=12
配置默认AF应用标识。 
[ADD DEFAFAPP]:INTERFACETYPE="Rx",AFAI="10001";
配置IMS域APN。 
[ADD EMERGAPN]:APN="sos",TYPE="EMERG_APN";
配置IMS紧急呼叫Service-URN。 
[ADD EMERGSVCURN]:SVCURNPREFIX="urn:service:sos.fire";
[ADD EMERGSVCURN]:SVCURNPREFIX="urn:service:sos.police";
[ADD EMERGSVCURN]:SVCURNPREFIX="urn:service:sos.ambulance";
[ADD EMERGSVCURN]:SVCURNPREFIX="urn:service:sos.traffic";
配置AF应用标识映射。 
AFAI根据现场实际情况配置。 
[ADD AFAPPMEDIA]:ID=12,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=13,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=14,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="UP",APPID=1050000006;
[ADD AFAPPMEDIA]:ID=15,AFAI="ims",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="DOWN",APPID=1050000006;
若AF请求中不携带AF-Application-Identifier，则上述配置中的AFAI需要替换为“默认AF应用标识配置”中的内容，其他不变。 
[ADD AFAPPMEDIA]:ID=1,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="UP",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=2,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="NOINFO",FLOWDIRECT="DOWN",APPID=1050000004;
[ADD AFAPPMEDIA]:ID=3,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="UP",APPID=1050000006;
[ADD AFAPPMEDIA]:ID=4,AFAI="10001",MEDIATYPE="AUDIO",FLOWUSE="RTCP",FLOWDIRECT="DOWN",APPID=1050000006;
配置应用标识。 
[ADD APPSUBS]:APPID=1050000004,APPDESC="audio",SUBSID="1",SUBSDESC="audio",PREPROV="NO";
[ADD APPSUBS]:APPID=1050000006,APPDESC="audio_rtcp",SUBSID="1",SUBSDESC="audio_rtcp",PREPROV="NO";
配置系统全局变量。 
[SET SYS GLOBPARA]:IDX=1081,CURVAL="1",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1082,CURVAL="1",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1006,CURVAL="0",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1116,CURVAL="2",EXTFLAG=0
[SET SYS GLOBPARA]:IDX=1135,CURVAL="1",EXTFLAG=0
配置规则条件。
条件名称|参数|取值
---|---|---
sos apn|选择策略变量|其他
策略变量类别|sos apn|会话信息类
策略变量|sos apn|APN
操作符|sos apn|In
参考值|sos apn|sos,emergency
1050000004_audio|选择策略变量|其他
策略变量类别|1050000004_audio|会话信息类
策略变量|1050000004_audio|Gx应用标识
操作符|1050000004_audio|=
参考值|1050000004_audio|1050000004
1050000006_audio_rtcp|选择策略变量|其他
策略变量类别|1050000006_audio_rtcp|会话信息类
策略变量|1050000006_audio_rtcp|Gx应用标识
操作符|1050000006_audio_rtcp|=
参考值|1050000006_audio_rtcp|1050000006
配置规则动作参数。
业务控制策略动作参数 
动作参数名称|参数名称|取值
---|---|---
VoLTE_N7_sos_default_5QI|参数类型|N7会话参数集
会话规则ID|VoLTE_N7_sos_default_5QI|volte_sos_session
5QI|VoLTE_N7_sos_default_5QI|5
ARP优先级|VoLTE_N7_sos_default_5QI|1
ARP抢占能力|VoLTE_N7_sos_default_5QI|可以抢占
ARP被抢占能力|VoLTE_N7_sos_default_5QI|不允许被抢占
VoLTE_N7_RG_1050000004|参数类型|Charging参数集
计费控制策略ID|VoLTE_N7_RG_1050000004|audio
费率组|VoLTE_N7_RG_1050000004|1050000004
VoLTE_N7_sos_qci1_arp1|参数类型|QoS参数集
QoS控制策略ID|VoLTE_N7_sos_qci1_arp1|sos_rtp
5QI|VoLTE_N7_sos_qci1_arp1|1
ARP优先级|VoLTE_N7_sos_qci1_arp1|1
ARP抢占能力|VoLTE_N7_sos_qci1_arp1|可以抢占
ARP被抢占能力|VoLTE_N7_sos_qci1_arp1|不允许被抢占
VoLTE_N7_sos_qci1_arp1_1|参数类型|QoS参数集
QoS控制策略ID|VoLTE_N7_sos_qci1_arp1_1|sos_rtcp
5QI|VoLTE_N7_sos_qci1_arp1_1|1
ARP优先级|VoLTE_N7_sos_qci1_arp1_1|1
ARP抢占能力|VoLTE_N7_sos_qci1_arp1_1|可以抢占
ARP被抢占能力|VoLTE_N7_sos_qci1_arp1_1|不允许被抢占
VoLTE_N7_sos_audio|参数类型|N7 PCC规则参数集
PCC规则ID|VoLTE_N7_sos_audio|volte_sos_audio
PCC规则类型|VoLTE_N7_sos_audio|动态规则
优先级|VoLTE_N7_sos_audio|0
QoS控制策略ID|VoLTE_N7_sos_audio|VoLTE_N7_sos_qci1_arp1
计费控制策略ID|VoLTE_N7_sos_audio|VoLTE_N7_RG_1050000004
VoLTE_N7_sos_audio_rtcp|参数类型|N7 PCC规则参数集
PCC规则ID|VoLTE_N7_sos_audio_rtcp|volte_sos_audio_rtcp
PCC规则类型|VoLTE_N7_sos_audio_rtcp|动态规则
优先级|VoLTE_N7_sos_audio_rtcp|1
QoS控制策略ID|VoLTE_N7_sos_audio_rtcp|VoLTE_N7_sos_qci1_arp1_1
计费控制策略ID|VoLTE_N7_sos_audio_rtcp|VoLTE_N7_RG_1050000004
配置场景。
场景规则关联配置 
场景名称|参数|取值
---|---|---
VoLTE_sos|入口1|入口类型|会话信息类
已选入口|VoLTE_sos|入口1|紧急APN指示
取值|VoLTE_sos|入口1|紧急APN
策略类型|VoLTE_sos|N7会话决策|VoLTE_N7_sos_Default_5QI
N7业务决策|策略类型|VoLTE_sos|VoLTE_N7_sos_audio
VoLTE_N7_sos_audio_rtcp|N7业务决策|策略类型|VoLTE_sos
业务控制策略规则 
规则名称|参数|取值
---|---|---
VoLTE_N7_sos_Default_5QI|优先级|60
动作类型|VoLTE_N7_sos_Default_5QI|参数填充
日志开关|VoLTE_N7_sos_Default_5QI|关
条件表达式|VoLTE_N7_sos_Default_5QI|{APN In sos,emergency}
动作参数名称|VoLTE_N7_sos_Default_5QI|VoLTE_N7_sos_Default_5QI
VoLTE_N7_sos_audio|优先级|66
动作类型|VoLTE_N7_sos_audio|参数填充
日志开关|VoLTE_N7_sos_audio|关
条件表达式|VoLTE_N7_sos_audio|{Gx应用标识 = 1050000004}
动作参数名称|VoLTE_N7_sos_audio|VoLTE_N7_sos_audio
VoLTE_N7_sos_audio_rtcp|优先级|60
动作类型|VoLTE_N7_sos_audio_rtcp|参数填充
日志开关|VoLTE_N7_sos_audio_rtcp|关
条件表达式|VoLTE_N7_sos_audio_rtcp|{Gx应用标识 = 1050000006}
动作参数名称|VoLTE_N7_sos_audio_rtcp|VoLTE_N7_sos_audio_rtcp
配置脚本 :/*Role:VOLTE_sos---Start*/ 
ADD DM COND:NAME="1050000004_audio",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000004";
ADD DM COND:NAME="1050000006_audio_rtcp",SVCKEY="SYS.GX_APP_ID",OPERATOR="=",VALTYPE="VALUE",VALUE="1050000006";
ADD DM COND:NAME="sos apn",SVCKEY="SYS.GX_APN",OPERATOR="In",VALTYPE="VALUE",VALUE="sos"&"emergency";
ADD DM ACTION:NAME="volte_sos_audio",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"1"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000004"&"SYS.QOS_CLASS"-"0"-"1"&"SYS.PRE_PRECEDENCE"-"0"-"0"&"SYS.PRE_RATING_GROUP"-"0"-"1050000004"&"SYS.SERVICE_ID"-"0"-"1050000004"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_sos_audio";
ADD DM ACTION:NAME="volte_sos_audio_rtcp",TYPE="PCC_RULE",PARAMS="SYS.ARP_PRI_LEVEL"-"0"-"1"&"SYS.ARP_PRE_EMP_CAP"-"0"-"ENABLE"&"SYS.ARP_PRE_EMP_VUL"-"0"-"DISABLE"&"SYS.SVC_RULE_TYPE"-"0"-"DYM_RULE"&"SYS.PRE_APPID"-"0"-"1050000006"&"SYS.QOS_CLASS"-"0"-"1"&"SYS.PRE_PRECEDENCE"-"0"-"1"&"SYS.PRE_RATING_GROUP"-"0"-"1050000004"&"SYS.SERVICE_ID"-"0"-"1050000004"&"SYS.CHARGING_CORRELATION_INDICATOR"-"0"-"CHARGING_IDENTIFIER_REQUIRED"&"SYS.CHARGING_RULE_NAME"-"0"-"volte_sos_audio_rtcp";
ADD DM ACTION:NAME="VOLTE_SOS_default_QCI",TYPE="BEARER_CTRL",PARAMS="SYS.BEAR_QCI"-"0"-"5"&"SYS.BEAR_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.BEAR_ARP_PRE_EMPTION_CAP"-"0"-"PRE-EMPTION_CAPABILITY_ENABLED"&"SYS.BEAR_ARP_PRE_EMPTION_VULNERABILITY"-"0"-"PRE-EMPTION_VULNERABILITY_DISABLED";
ADD DM ACTION:NAME="VOLTE_N7_sos_default_5QI",TYPE="SESSION_PARASET",PARAMS="SYS.SESS_RULE_ID"-"0"-"volte_sos_session"&"SYS.DEF_QOS_5QI"-"0"-"5"&"SYS.DEF_QOS_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.DEF_QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.DEF_QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_RG_1050000004",TYPE="CHARG_PARASET",PARAMS="SYS.CHARGING_ID"-"0"-"audio"&"SYS.CHG_RATING_GROUP"-"0"-"1050000004"&"SYS.CHG_SERVICE_ID"-"0"-"1050000004";
ADD DM ACTION:NAME="VOLTE_N7_sos_qci1_arp1",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"sos_rtp"&"SYS.QOS_5QI"-"0"-"1"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_sos_audio",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_sos_audio"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"0"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_sos_qci1_arp1"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000004";
ADD DM ACTION:NAME="VOLTE_N7_sos_qci1_arp1_1",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"sos_rtcp"&"SYS.QOS_5QI"-"0"-"1"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"1"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"NOT_PREEMPTABLE";
ADD DM ACTION:NAME="VOLTE_N7_sos_audio_rtcp",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"volte_sos_audio_rtcp"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_PRECEDENCE"-"0"-"1"&"SYS.N7_PCC_QoS_ID"-"0"-"VOLTE_N7_sos_qci1_arp1_1"&"SYS.N7_PCC_CHARGING_ID"-"0"-"VOLTE_N7_RG_1050000004";
ADD DM RULE:NAME="volte_sos",PLCTYPE="SVC_CTRL",PRIOR=60,CONDEXP="{1050000004_audio}",ACTTYPE="PARAM",ACTNAME="volte_sos_audio",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="volte_sos_audio_rtcp",PLCTYPE="SVC_CTRL",PRIOR=60,CONDEXP="{1050000006_audio_rtcp}",ACTTYPE="PARAM",ACTNAME="volte_sos_audio_rtcp",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_SOS_Default_QCI_ARP",PLCTYPE="BEARER_CTRL",PRIOR=1,CONDEXP="{sos apn}",ACTTYPE="PARAM",ACTNAME="VOLTE_SOS_default_QCI",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_sos_Default_5QI",PLCTYPE="DM_RULE_TYPE_N7_SESS",PRIOR=60,CONDEXP="{sos apn}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_sos_default_5QI",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_sos_audio",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=60,CONDEXP="{1050000004_audio}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_sos_audio",LOGFLAG="OFF",RULENO=0;
ADD DM RULE:NAME="VOLTE_N7_sos_audio_rtcp",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=60,CONDEXP="{1050000006_audio_rtcp}",ACTTYPE="PARAM",ACTNAME="VOLTE_N7_sos_audio_rtcp",LOGFLAG="OFF",RULENO=0;
ADD DM ROLE:NAME="VOLTE_sos",ENTRANCE="SYS.EMERGENCY_SESS_FLAG"-"EMERGENCY",RULENAME="volte_sos"&"volte_sos_audio_rtcp"&"VOLTE_SOS_Default_QCI_ARP"&"VOLTE_N7_sos_Default_5QI"&"VOLTE_N7_sos_audio"&"VOLTE_N7_sos_audio_rtcp",VALIDFLAG="ENABLE";
/*Role:VOLTE_sos--End*/ 
##### 配置AF影响业务路由 
###### 配置基于UE标识的流量引导申请 
###### 配置基于UE标识的流量引导申请 
配置说明 :AF影响业务路由特性通过配置实现用户业务流路由到本地数据网络，从而减少传输时延、提升用户体验。
配置前提 :AF影响业务路由特性是PCF、SMF以及UDR配合共同完成的，因此在配置此特性之前保证三个网元的功能及交互正常。
配置过程 :配置过程包含如下步骤： 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD ADJHOST]命令，配置SPR邻接主机。
执行[ADD USERACC]命令，配置用户（组）资料接入局。
执行[ADD NUMANA]命令，配置号码段分析。
执行[SET SYS GLOBPARA]命令，修改系统全局变量1002值为1（用户签约来源设置为SPR）。
执行[ADD APPSUBS]命令，配置应用标识。
执行[ADD AFAPPMEDIA]命令，配置AF应用标识映射。
在策略元素配置中自定义策略变量、条件、动作参数、场景和规则配置。 
配置实例 :场景说明 :基于UE标识的流量引导申请需要AF请求包含PDU会话的IP地址，AF直接发送业务影响路由请求给PCF或者通过NEF发送业务影响路由请求给PCF。请求内容包括受影响的业务，目标DNAI（数据网访问标识，该标识由AF提供或NEF通过AF提供目标位置信息产生），无需通过PCF与UDR之间的N36接口来传递业务影响路由信息，PCF构造PCC规则指示SMF选择/重新选择UPF，快速卸载用户业务流到本地数据网处理。
数据规划 :类别|参数|取值
---|---|---
1002全局变量|参数值|1
邻接主机配置|邻接主机编号|1
主机名|邻接主机配置|spr.hatt.zte.com.cn
域名|邻接主机配置|hatt.zte.com.cn
邻接主机类型|邻接主机配置|SPR
邻接主机组编号|邻接主机配置|0
用户（组）资料接入局配置|用户（组）资料接入局配置编号|1
邻接主机编号|用户（组）资料接入局配置|1
签约和用量接口交互模式|用户（组）资料接入局配置|签约和用量都有交互
号码段分析配置|号码段分析类型|用户资料接入局IMSI分析
起始号码|号码段分析配置|000000000000000
结束号码|号码段分析配置|999999999999999
号码段分析结果|号码段分析配置|1
AF应用标识映射配置1|AFAI|1
应用标识|AF应用标识映射配置1|1001
AF应用标识映射配置2|AFAI|2
应用标识|AF应用标识映射配置2|1002
策略类型|控制条件|决策参数
---|---|---
N7业务策略|Gx应用标识1001|N7 PCC规则参数集1
Gx应用标识1002|N7业务策略|N7 PCC规则参数集2
配置步骤 :配置基础信息
配置1002全局变量 
[SET SYS GLOBPARA]:IDX=1002,CURVAL="1",EXTFLAG=0
配置邻接主机 
[ADD ADJHOST]:ADJHOSTID=1,HOSTNAME=spr.hatt.zte.com.cn,REALM=hatt.zte.com.cn,HOSTTYPE=SPR,CONNECTDRA=NO
配置用户（组）资料接入局 
[ADD USERACC]:ID=1,ADJHOSTID=1,ACTMODE=SUBS_USG
配置号码段分析 
[ADD NUMANA]:ID=1,ANATYPE="USERACC_MSISDN",NUMBEGIN="0000000000000",NUMEND="9999999999999",RESULTID=1
配置Gx应用标识 
[ADD APPSUBS]:APPID=1001,APPDESC="1001",SUBSID="1001",SUBSDESC="1001"
[ADD APPSUBS]:APPID=1002,APPDESC="1002",SUBSID="1002",SUBSDESC="1002"
配置AF应用标识映射1 
[ADD AFAPPMEDIA]:ID=1,AFAI="1",MEDIATYPE="OTHER",FLOWUSE="OTHER",FLOWDIRECT="OTHER",FLOWSTATUS="ALL",SPID="N/A",ASPID="N/A",APPID=1001
配置AF应用标识映射2 
[ADD AFAPPMEDIA]:ID=2,AFAI="2",MEDIATYPE="OTHER",FLOWUSE="OTHER",FLOWDIRECT="OTHER",FLOWSTATUS="ALL",SPID="N/A",ASPID="N/A",APPID=1002
配置规则条件
配置Gx标识条件 
条件名称|参数|取值
---|---|---
GxAPPID1001|选择策略变量|其他
策略变量类别|GxAPPID1001|会话信息类
策略变量|GxAPPID1001|Gx应用标识
操作符|GxAPPID1001|=
值类型|GxAPPID1001|值
值|GxAPPID1001|1001
GxAPPID1002|选择策略变量|其他
策略变量类别|GxAPPID1002|会话信息类
策略变量|GxAPPID1002|Gx应用标识
操作符|GxAPPID1002|=
值类型|GxAPPID1002|值
值|GxAPPID1002|1002
配置规则动作参数
配置QoS参数集 
动作参数名称|参数名称|取值
---|---|---
N7QoS1|动作参数类型|QoS参数集
动作参数名称|N7QoS1|N7QoS1
QoS控制策略ID|N7QoS1|QoS1
5QI|N7QoS1|6
ARP优先级|N7QoS1|10
ARP抢占能力|N7QoS1|可以抢占
ARP被抢占能力|N7QoS1|可以被抢
N7QoS2|动作参数类型|QoS参数集
动作参数名称|N7QoS2|N7QoS2
QoS控制策略ID|N7QoS2|QoS2
5QI|N7QoS2|5
ARP优先级|N7QoS2|20
ARP抢占能力|N7QoS2|可以抢占
ARP被抢占能力|N7QoS2|可以被抢
配置路由目的地参数集 
动作参数名称|参数名称|取值
---|---|---
TCRoute1|动作参数类型|路由目的地参数集
动作参数名称|TCRoute1|TCRoute1
DNAI|TCRoute1|dnai1
路由配置标识|TCRoute1|1
IPV6地址|TCRoute1|4003::19:3
端口|TCRoute1|8080
TCRoute2|动作参数类型|路由目的地参数集
动作参数名称|TCRoute2|TCRoute2
DNAI|TCRoute2|dnai2
路由配置标识|TCRoute2|2
IPV6地址|TCRoute2|4004::19:3
端口|TCRoute2|8081
配置TC参数集 
动作参数名称|参数名称|取值
---|---|---
N7RouteTC1|动作参数类型|TC参数集
动作参数名称|N7RouteTC1|N7RouteTC1
流量控制策略ID|N7RouteTC1|TC1
路由目的地|N7RouteTC1|TCRoute1
N7RouteTC2|动作参数类型|TC参数集
动作参数名称|N7RouteTC2|N7RouteTC2
流量控制策略ID|N7RouteTC2|TC2
路由目的地|N7RouteTC2|TCRoute2
配置N7业务决策动作参数 
动作参数名称|参数名称|取值
---|---|---
action_N7pcc1|动作参数类型|N7业务参数集
PCC规则名称|action_N7pcc1|N7pcc1
PCC规则类型|action_N7pcc1|动态规则
QoS控制策略ID|action_N7pcc1|N7QoS1
流量控制策略ID|action_N7pcc1|N7RouteTC1
action_N7pcc2|动作参数类型|N7业务参数集
PCC规则名称|action_N7pcc2|N7pcc2
PCC规则类型|action_N7pcc2|动态规则
QoS控制策略ID|action_N7pcc2|N7QoS2
流量控制策略ID|action_N7pcc2|N7RouteTC2
配置场景
配置N7业务策略规则 
规则名称|规则参数|参数取值
---|---|---
rule_serv1|优先级|10
动作类型|rule_serv1|参数填充
日志开关|rule_serv1|关闭
条件表达式|rule_serv1|GxAPPID1001
选中动作参数名称|rule_serv1|action_N7pcc1
rule_serv2|优先级|10
动作类型|rule_serv2|参数填充
日志开关|rule_serv2|关闭
条件表达式|rule_serv2|GxAPPID1002
选中动作参数名称|rule_serv2|action_N7pcc2
配置场景规则关联 
场景名称|参数|取值
---|---|---
TrafficInfluRole|入口1|入口类型|接入信息类
已选入口|TrafficInfluRole|入口1|接入类型
取值|TrafficInfluRole|入口1|3GPP接入
配置脚本 ://配置Gx标识条件 
[ADD DM COND]:NAME="GxAPPID1001",SVCKEY="SYS.GX_APP_ID",OPERATOR=1,VALTYPE=0,VALUE="1001"
[ADD DM COND]:NAME="GxAPPID1002",SVCKEY="SYS.GX_APP_ID",OPERATOR=1,VALTYPE=0,VALUE="1002"
//配置QoS参数集 
[ADD DM ACTION]:NAME="N7QoS1",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"QoS1"&"SYS.QOS_5QI"-"0"-"6"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"10"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
[ADD DM ACTION]:NAME="N7QoS2",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"QoS2"&"SYS.QOS_5QI"-"0"-"5"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"20"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
//配置路由目的地参数集 
[ADD DM ACTION]:NAME="TCRoute1",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"VALUE"-"dnai1"&"SYS.ROUTE_PROF_ID"-"VALUE"-"1"&"SYS.DNAI_IPV6_ADDR"-"VALUE"-"4003::19:3"&"SYS.DNAI_PORT_NUMBER"-"VALUE"-"8080";
[ADD DM ACTION]:NAME="TCRoute2",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"VALUE"-"dnai2"&"SYS.ROUTE_PROF_ID"-"VALUE"-"2"&"SYS.DNAI_IPV6_ADDR"-"VALUE"-"4004::19:3"&"SYS.DNAI_PORT_NUMBER"-"VALUE"-"8081";
//配置TC参数集 
[ADD DM ACTION]:NAME="N7RouteTC1",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"TC1"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"TCRoute1"
[ADD DM ACTION]:NAME="N7RouteTC2",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"TC2"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"TCRoute2"
//配置N7业务决策动作参数 
[ADD DM ACTION]:NAME="action_N7pcc1",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"N7pcc1"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_TC_ID"-"0"-"N7RouteTC1"&"SYS.N7_PCC_QoS_ID"-"0"-"N7QoS1"
[ADD DM ACTION]:NAME="action_N7pcc2",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"N7pcc2"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_TC_ID"-"0"-"N7RouteTC2"&"SYS.N7_PCC_QoS_ID"-"0"-"N7QoS2"
//配置N7业务策略规则 
[ADD DM RULE]:NAME="rule_serv1",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=10,CONDEXP="{GxAPPID1001}",ACTTYPE="PARAM",ACTNAME="action_N7pcc1"
[ADD DM RULE]:NAME="rule_serv2",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=10,CONDEXP="{GxAPPID1002}",ACTTYPE="PARAM",ACTNAME="action_N7pcc2"
//配置场景规则关联 
[ADD DM ROLE]:NAME="TrafficInfluRole",ENTRANCE="SYS.ACCESS_TYPE"-"3GPP_ACCESS",RULENAME="rule_serv1"&"rule_serv2",VALIDFLAG="ENABLE";
###### 配置基于无UE标识的流量引导申请 
###### 配置基于无UE标识的流量引导申请 
配置说明 :AF影响业务路由特性通过配置实现用户业务流路由到本地数据网络，从而减少传输时延、提升用户体验。
配置前提 :AF影响业务路由特性是PCF、SMF以及UDR配合共同完成的，因此在配置此特性之前保证三个网元的功能及交互正常。
配置过程 :配置过程包含如下步骤： 
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD CLIENTPROFILE]命令，配置HTTP客户端模板。
执行[ADD SERVERPROFILE]命令，配置HTTP服务端模板。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[ADD SVCHTTPCLTPROF]命令，配置关联的HTTP客户端模板。
执行[ADD PCFSERVICE]命令，配置服务基础信息。
根据用户关键字配置对应的SUPI或者GPSI号段，两种方式二选一。
配置GPSI范围组执行ADD SBIGPSIRANGEARRID命令，配置GPSI范围组编号。执行ADD SBIGPSIRANGEARRPARAM命令，配置GPSI范围组参数。 
配置SUPI范围组执行ADD SBISUPIRANGEARRID命令，配置SUPI范围组编号。执行ADD SBISUPIRANGEARRPARAM命令，配置SUPI范围 
执行[ADD SBICHFINFO]命令，配置UDR信息。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择CommonS_HTTP_LB_0节点。
执行[ADD SBIIPV6ADDR]命令，配置IPv6地址。
执行[ADD SBIIPENDPOINT]命令，配置IP端点。
执行[ADD SBIIPENDPOINTARRID]命令，配置进行IP端点组编号。
执行[ADD SBIIPENDPOINTARRPARAM]命令，配置IP端点组参数。
执行[ADD SBINFSVERSIONARRID]命令，配置NF服务版本组编号。
执行[ADD SBINFSVERSIONARRPARAM]命令，配置NF服务版本组参数。
执行[ADD SBIPEERNFBASEINFO]命令，配置对端NF基本信息。
执行[ADD SBIPEERNFEXTINFO]命令，配置对端NF扩展信息。
执行[ADD SBIPEERNFSERVICEINSTANCE]命令，配置对端NF实例。
执行[ADD SBIRESELECT]命令，配置重选。
执行[ADD SBISRVDISCOVERYMODE]命令，配置服务发现方式。
执行[ADD SBIROUTEPOLICY]命令，配置路由策略。
在EM客户端配置页面的左侧命令树中，展开PCF节点，选择Npcf_PolicyManagement_0节点。
执行[SET SYS GLOBPARA]命令，修改系统全局变量1212值为1（用户级）。
执行[SET SYS GLOBPARA]命令，修改系统全局变量1002值为2（用户签约来源设置为UDR）。
执行[ADD APPSUBS]命令，配置应用标识。
执行[ADD AFAPPMEDIA]命令，配置AF应用标识映射。
在策略元素配置中自定义策略变量、条件、动作参数、场景和规则配置。 
配置实例 :场景说明 :UE无IP地址的业务影响路由是通过PCF与UDR之间的N36接口来传递业务影响路由策略，PCF下发业务影响路由策略给SMF。
数据规划 :类别|参数|取值
---|---|---
HTTP客户端模板配置|编号|1
IP地址|HTTP客户端模板配置|4003::19:5
起始端口|HTTP客户端模板配置|20000
终止端口|HTTP客户端模板配置|30000
HTTP服务端模板配置|编号|1
IP地址|HTTP服务端模板配置|4003::19:5
端口|HTTP服务端模板配置|8080
关联HTTP客户端模板配置|服务类型|Nudr_DataRepository
HTTP IPv6模板ID|关联HTTP客户端模板配置|1
服务基础配置|服务类型|NPCF
Fqdn|服务基础配置|pcf.zte.com.cn
版本|服务基础配置|v1
优先级|服务基础配置|1
通知URI服务端模板配置（可选）|服务类型|Nudr_DataRepository
服务端模板ID1|通知URI服务端模板配置（可选）|1
GPSI范围组编号配置|GPSI范围组编号|100
GPSI范围组参数配置|配置索引|100
GPSI范围组编号|GPSI范围组参数配置|100
开始|GPSI范围组参数配置|0000000000000
结束|GPSI范围组参数配置|9999999999999
UDR信息配置|CHF信息编号|100
GPSI范围组编号|UDR信息配置|100
IPv6地址配置1|IPv6地址编号|100
IP地址|IPv6地址配置1|4004::19:3
IPv6地址配置2|IPv6地址编号|101
IP地址|IPv6地址配置2|4004::19:4
IP端点配置1|IP端点编号|100
端口|IP端点配置1|8080
IPv6地址编号|IP端点配置1|100
IP端点配置2|IP端点编号|101
端口|IP端点配置2|8080
IPv6地址编号|IP端点配置2|101
IP端点组编号配置1|IP端点组编号|100
IP端点组编号配置2|IP端点组编号|101
IP端点组参数配置1|配置索引|100
IP端点组编号|IP端点组参数配置1|100
IP端点编号|IP端点组参数配置1|100
IP端点组参数配置2|配置索引|101
IP端点组编号|IP端点组参数配置2|101
IP端点编号|IP端点组参数配置2|101
NF服务版本组编号配置|NF服务版本组编号|100
NF服务版本组参数配置|配置索引|100
NF服务版本组编号|NF服务版本组参数配置|100
API URI版本号|NF服务版本组参数配置|v1
API完整版本号|NF服务版本组参数配置|v1
对端NF基本信息配置1|对端NF信息编号|100
NF实例标识|对端NF基本信息配置1|100
NF类型|对端NF基本信息配置1|UDR
NF状态|对端NF基本信息配置1|REGISTERED
NF实例名称|对端NF基本信息配置1|260e6cfe-5eea-4036-8566-77744b5e7101
对端NF基本信息配置2|对端NF信息编号|101
NF实例标识|对端NF基本信息配置2|101
NF类型|对端NF基本信息配置2|UDR
NF状态|对端NF基本信息配置2|REGISTERED
NF实例名称|对端NF基本信息配置2|260e6cfe-5eea-4036-8566-77744b5e7199
对端NF扩展信息配置1|对端NF信息编号|100
UDR信息编号|对端NF扩展信息配置1|100
对端NF扩展信息配置2|对端NF信息编号|101
UDR信息编号|对端NF扩展信息配置2|100
对端NF实例配置1|配置索引|100
归属NF编号|对端NF实例配置1|100
服务实例标识|对端NF实例配置1|100
服务名称|对端NF实例配置1|nudr_dr
服务版本组编号|对端NF实例配置1|100
协议模式|对端NF实例配置1|HTTP
服务实例状态|对端NF实例配置1|REGISTERED
域名|对端NF实例配置1|udr1.zte.com.cn
IP端点组编号|对端NF实例配置1|100
优先级|对端NF实例配置1|1
对端NF实例配置2|配置索引|101
归属NF编号|对端NF实例配置2|101
服务实例标识|对端NF实例配置2|101
服务名称|对端NF实例配置2|nudr_dr
服务版本组编号|对端NF实例配置2|100
协议模式|对端NF实例配置2|HTTP
服务实例状态|对端NF实例配置2|REGISTERED
域名|对端NF实例配置2|udr2.zte.com.cn
IP端点组编号|对端NF实例配置2|101
优先级|对端NF实例配置2|2
重选配置|目的NF类型|全部
服务发现方式配置|目的NF类型|UDR_TYPE
发现方式|服务发现方式配置|STATIC_ONLY
地址选择方式|服务发现方式配置|RANDOM
http默认端口|服务发现方式配置|8080
https默认端口|服务发现方式配置|443
路由策略配置|目的NF类型|全部
NF类型|路由策略配置|PCF_TYPE
全局变量配置|全局变量1212|1
全局变量1002|全局变量配置|2
应用标识配置1|应用标识|1001
应用标识描述|应用标识配置1|1001
签约业务标识|应用标识配置1|1
签约业务标识描述|应用标识配置1|1
应用标识配置2|应用标识|1002
应用标识描述|应用标识配置2|1002
签约业务标识|应用标识配置2|2
签约业务标识描述|应用标识配置2|2
AF应用标识映射配置1|AFAI|1
应用标识|AF应用标识映射配置1|1001
AF应用标识映射配置2|AFAI|2
应用标识|AF应用标识映射配置2|1002
策略类型|控制条件|决策参数
---|---|---
N7业务策略|Gx应用标识1001|N7 PCC规则参数集1
Gx应用标识1002|N7业务策略|N7 PCC规则参数集2
业务配置关系图 :
配置步骤 :配置基础数据
配置HTTP客户端版本 
[ADD CLIENTPROFILE]:ID=1,IPADDR=4003::19:5,STARTPORT=20000,ENDPORT=30000,VPNID=0,CONNNUM=2,CONNELASTIC="SWITCH_ON",RESPBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2"
配置HTTP服务端版本 
[ADD SERVERPROFILE]:ID=1,IPADDR=4003::19:5,PORT=8080,VPNID=0,REQBODYMAXLENGTH=204800,RESPTIMER=30,MAXCONCURRENTSTREAMS=1000,KEEPALIVECNT=3,KEEPALIVETIMER=30,KEEPALIVESWITCH="SWITCH_ON",HTTPVERSION="HTTP_2",VERIFYCLI="SWITCH_OFF"
配置关联HTTP客户端模板 
[ADD SVCHTTPCLTPROF]:ID=2,SERVICETYPE="NUDR_DR",HTTP4CLTID=0,HTTP6CLTID=1,HTTPS4CLTID=0,HTTPS6CLTID=0,HTURI="IP"
配置服务基础配置 
[ADD PCFSERVICE]:SERVICETYPE="NPCF",VERSION="v1",FQDN="pcf.zte.com.cn",PRIORITY=1,SERVERID="1",TOPHIDE="NOTHIDE",SCHEMA="HTTP"
（可选）配置通知URI服务端模板 
[ADD NOTIURISVRTPROF]:SERVICETYPE="NUDR_DR",SVRID1=1
配置GPSI范围组编号 
[ADD SBIGPSIRANGEARRID]:ARRAYID=100
配置GPSI范围组参数 
[ADD SBIGPSIRANGEARRPARAM]:INDEX=100,ARRAYID=100,START="0000000000000",END="9999999999999"
配置UDR信息 
[ADD SBIUDRINFO]:ID=100,GPSIRANGEARRAY=100
配置IPv6地址1 
[ADD SBIIPV6ADDR]:ID=100,IP="4004::19:3"
配置IPv6地址2 
[ADD SBIIPV6ADDR]:ID=101,IP="4004::19:4"
配置IP端点1 
[ADD SBIIPENDPOINT]:INDEX=100,IPV6=100,PORT=8080
配置IP端点2 
[ADD SBIIPENDPOINT]:INDEX=101,IPV6=101,PORT=8080
配置IP端点组编号1 
[ADD SBIIPENDPOINTARRID]:ARRAYID=100
配置IP端点组编号2 
[ADD SBIIPENDPOINTARRID]:ARRAYID=101
配置IP端点组参数1 
[ADD SBIIPENDPOINTARRPARAM]:INDEX=100,ARRAYID=100,IPENDPOINT=100
配置IP端点组参数2 
[ADD SBIIPENDPOINTARRPARAM]:INDEX=101,ARRAYID=101,IPENDPOINT=101
配置NF服务版本组编号 
[ADD SBINFSVERSIONARRID]:ARRAYID=100
配置NF服务版本组参数 
[ADD SBINFSVERSIONARRPARAM]:INDEX=100,ARRAYID=100,APIVERSIONINURI="v1",APIFULLVERSION="v1"
配置对端NF基本信息1 
[ADD SBIPEERNFBASEINFO]:ID=100,NFINSTANCEID="100",NFTYPE="UDR_TYPE",NFSTATUS="REGISTERED",NFINSTANCENAME="260e6cfe-5eea-4036-8566-77744b5e7101",PRIORITY=1
配置对端NF基本信息2 
[ADD SBIPEERNFBASEINFO]:ID=101,NFINSTANCEID="101",NFTYPE="UDR_TYPE",NFSTATUS="REGISTERED",NFINSTANCENAME="260e6cfe-5eea-4036-8566-77744b5e7199",PRIORITY=2
配置对端NF扩展信息1 
[ADD SBIPEERNFEXTINFO]:ID=100,UDRINFO=100
配置对端NF扩展信息2 
[ADD SBIPEERNFEXTINFO]:ID=101,UDRINFO=100
配置对端NF实例1 
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=100,NFINDEX=100,SRVINSTANCEID="100",SERVICENAME="NUDR_DR",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",FQDN="udr1.zte.com.cn",IPENDPOINTARRAY=100,PRIORITY=1
配置对端NF实例2 
[ADD SBIPEERNFSERVICEINSTANCE]:INDEX=101,NFINDEX=101,SRVINSTANCEID="101",SERVICENAME="NUDR_DR",SERVICEVERSIONARRAY=100,SCHEME="HTTP",NFSERVICESTATUS="REGISTERED",FQDN="udr2.zte.com.cn",IPENDPOINTARRAY=101,PRIORITY=2
配置重选 
[ADD SBIRESELECT]:TARGETNFTYPE="ALL"
配置服务发现方式 
[ADD SBISRVDISCOVERYMODE]:TARGETNFTYPE="UDR_TYPE",DISCOVERYMODE="STATIC_ONLY",IPSELECTMODE="RANDOM",DEFAULTPORTFORHTTP=8080,DEFAULTPORTFORHTTPS=443
配置路由策略 
[ADD SBIROUTEPOLICY]:TARGETNFTYPE="ALL",NFTYPE="PCF_TYPE"
配置1212全局变量 
[SET SYS GLOBPARA]:IDX=1212,CURVAL="1",EXTFLAG=0
配置1002全局变量 
[SET SYS GLOBPARA]:IDX=1002,CURVAL="2",EXTFLAG=0
配置应用标识 
[ADD APPSUBS]:APPID=1001,APPDESC="1001",SUBSID="1001",SUBSDESC="1001"
[ADD APPSUBS]:APPID=1002,APPDESC="1002",SUBSID="1002",SUBSDESC="1002"
配置AF应用标识映射1 
[ADD AFAPPMEDIA]:ID=1,AFAI="3",MEDIATYPE="OTHER",FLOWUSE="OTHER",FLOWDIRECT="OTHER",FLOWSTATUS="ALL",SPID="N/A",ASPID="N/A",APPID=1001
配置AF应用标识映射2 
[ADD AFAPPMEDIA]:ID=2,AFAI="4",MEDIATYPE="OTHER",FLOWUSE="OTHER",FLOWDIRECT="OTHER",FLOWSTATUS="ALL",SPID="N/A",ASPID="N/A",APPID=1002
配置规则条件
配置Gx标识条件 
条件名称|参数|取值
---|---|---
GxAPPID1001|选择策略变量|其他
策略变量类别|GxAPPID1001|会话信息类
策略变量|GxAPPID1001|Gx应用标识
操作符|GxAPPID1001|=
值类型|GxAPPID1001|值
值|GxAPPID1001|1001
GxAPPID1002|选择策略变量|其他
策略变量类别|GxAPPID1002|会话信息类
策略变量|GxAPPID1002|Gx应用标识
操作符|GxAPPID1002|=
值类型|GxAPPID1002|值
值|GxAPPID1002|1002
配置规则动作参数
配置QoS参数集 
动作参数名称|参数名称|取值
---|---|---
N7QoS1|动作参数类型|QoS参数集
动作参数名称|N7QoS1|N7QoS1
QoS控制策略ID|N7QoS1|QoS1
5QI|N7QoS1|6
ARP优先级|N7QoS1|10
ARP抢占能力|N7QoS1|可以抢占
ARP被抢占能力|N7QoS1|可以被抢
N7QoS2|动作参数类型|QoS参数集
动作参数名称|N7QoS2|N7QoS2
QoS控制策略ID|N7QoS2|QoS2
5QI|N7QoS2|5
ARP优先级|N7QoS2|20
ARP抢占能力|N7QoS2|可以抢占
ARP被抢占能力|N7QoS2|可以被抢占
配置路由目的地参数集 
动作参数名称|参数名称|取值
---|---|---
TCRoute1|动作参数类型|路由目的地参数集
动作参数名称|TCRoute1|TCRoute1
DNAI|TCRoute1|dnai1
TCRoute2|动作参数类型|路由目的地参数集
动作参数名称|TCRoute2|TCRoute2
DNAI|TCRoute2|dnai2
配置TC参数集 
动作参数名称|参数名称|取值
---|---|---
N7RouteTC1|动作参数类型|TC参数集
动作参数名称|N7RouteTC1|N7RouteTC1
流量控制策略ID|N7RouteTC1|TC1
路由目的地|N7RouteTC1|TCRoute1
N7RouteTC2|动作参数类型|TC参数集
动作参数名称|N7RouteTC2|N7RouteTC2
流量控制策略ID|N7RouteTC2|TC2
路由目的地|N7RouteTC2|TCRoute2
配置N7业务决策动作参数 
动作参数名称|参数名称|取值
---|---|---
action_N7pcc1|动作参数类型|N7业务参数集
PCC规则名称|action_N7pcc1|N7pcc1
PCC规则类型|action_N7pcc1|动态规则
QoS控制策略ID|action_N7pcc1|N7QoS1
流量控制策略ID|action_N7pcc1|N7RouteTC1
action_N7pcc2|动作参数类型|N7业务参数集
PCC规则名称|action_N7pcc2|N7pcc2
PCC规则类型|action_N7pcc2|动态规则
QoS控制策略ID|action_N7pcc2|N7QoS2
流量控制策略ID|action_N7pcc2|N7RouteTC2
配置场景
配置N7业务策略规则 
规则名称|规则参数|参数取值
---|---|---
rule_serv1|优先级|10
动作类型|rule_serv1|参数填充
日志开关|rule_serv1|关闭
条件表达式|rule_serv1|GxAPPID1001
选中动作参数名称|rule_serv1|action_N7pcc1
rule_serv2|优先级|10
动作类型|rule_serv2|参数填充
日志开关|rule_serv2|关闭
条件表达式|rule_serv2|GxAPPID1002
选中动作参数名称|rule_serv2|action_N7pcc2
配置场景规则关联 
场景名称|参数|取值
---|---|---
TrafficInfluRole|入口1|入口类型|接入信息类
已选入口|TrafficInfluRole|入口1|接入类型
取值|TrafficInfluRole|入口1|3GPP接入
配置脚本 ://配置Gx标识条件 
[ADD DM COND]:NAME="GxAPPID1001",SVCKEY="SYS.GX_APP_ID",OPERATOR=1,VALTYPE=0,VALUE="1001"
[ADD DM COND]:NAME="GxAPPID1002",SVCKEY="SYS.GX_APP_ID",OPERATOR=1,VALTYPE=0,VALUE="1002"
//配置QoS参数集 
[ADD DM ACTION]:NAME="N7QoS1",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"QoS1"&"SYS.QOS_5QI"-"0"-"6"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"10"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
[ADD DM ACTION]:NAME="N7QoS2",TYPE="QOS_PARASET",PARAMS="SYS.QOS_ID"-"0"-"QoS2"&"SYS.QOS_5QI"-"0"-"5"&"SYS.QOS_ARP_PRIORITY_LEVEL"-"0"-"20"&"SYS.QOS_ARP_PREEMPTION_CAP"-"0"-"MAY_PREEMPT"&"SYS.QOS_ARP_PREEMPTION_VULN"-"0"-"PREEMPTABLE";
//配置路由目的地参数集 
[ADD DM ACTION]:NAME="TCRoute1",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"VALUE"-"dnai1";
[ADD DM ACTION]:NAME="TCRoute2",TYPE="ROUTE_PARASET",PARAMS="SYS.DNAI"-"VALUE"-"dnai2";
//配置TC参数集 
[ADD DM ACTION]:NAME="N7RouteTC1",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"TC1"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"TCRoute1"
[ADD DM ACTION]:NAME="N7RouteTC2",TYPE="TC_PARASET",PARAMS="SYS.TC_ID"-"0"-"TC2"&"SYS.TC_ROUTE_TO_LOCATION"-"0"-"TCRoute2"
//配置N7业务决策动作参数 
[ADD DM ACTION]:NAME="action_N7pcc1",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"N7pcc1"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_TC_ID"-"0"-"N7RouteTC1"&"SYS.N7_PCC_QoS_ID"-"0"-"N7QoS1"
[ADD DM ACTION]:NAME="action_N7pcc2",TYPE="N7PCCRULE_PARASET",PARAMS="SYS.N7_PCC_RULE_ID"-"0"-"N7pcc2"&"SYS.N7_PCC_RULE_TYPE"-"0"-"DYNA_RULE"&"SYS.N7_PCC_TC_ID"-"0"-"N7RouteTC2"&"SYS.N7_PCC_QoS_ID"-"0"-"N7QoS2"
//配置N7业务策略规则 
[ADD DM RULE]:NAME="rule_serv1",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=10,CONDEXP="{GxAPPID1001}",ACTTYPE="PARAM",ACTNAME="action_N7pcc1"
[ADD DM RULE]:NAME="rule_serv2",PLCTYPE="DM_RULE_TYPE_N7_SERVICE",PRIOR=10,CONDEXP="{GxAPPID1002}",ACTTYPE="PARAM",ACTNAME="action_N7pcc2"
//配置场景规则关联 
[ADD DM ROLE]:NAME="TrafficInfluRole",ENTRANCE="SYS.ACCESS_TYPE"-"3GPP_ACCESS",RULENAME="rule_serv1"&"rule_serv2",VALIDFLAG="ENABLE";
### 策略管理界面说明 
功能说明 :RCP可以依据用户信息或网络使用情况，结合本地配置的策略，提供QoS控制、资源接纳控制以及计费控制等功能。
#### 概念介绍 
策略管理分为五部分：模板管理、基本数据配置、策略元素配置、策略数据查询和日志报表查询。 
模板管理：支持通过友好的配置界面快速新增套餐配置。模板可以分为预定义模板和定制模板。目前系统自带一些预定义模板，在预定义模板不满足需求的情况下中兴通讯可为运营商定制模板。 
基本数据配置：当RCP提供的预定义条件对象无法满足配置需要时，可以通过此部分配置基本数据，用于扩展条件对象。 
策略元素配置：本地策略由策略元素构成。策略元素包含条件、动作参数、场景。策略元素表达的含义是：在一定的场景下，如果满足预置条件，那么执行相应的动作参数。 
策略数据查询：在当前已配置的策略数据中根据查询条件进行查询。 
日志报表查询：日志报表查询提供报表本地查询和展示界面，支持基于用户或套餐的查询功能。 
#### 策略管理界面介绍 
登录EM客户端，选择配置→RCP策略管理
，如[图1]所示。
图1  RCP策略管理

选择网元实例，单击管理按钮，进入策略管理页面，如[图2]所示。
图2  策略管理页面

整个页面被分隔条划分为2大区域。左侧为配置导航区，右侧为留白区。 
配置导航区上方有2个操作按钮，说明参见[表1]。
操作按钮|作用|说明
---|---|---
|配置提交|在本地策略配置完成后，需要执行此按钮，使本地策略生效。
|配置导出|可以将本地策略导出成特定格式的文件。
单击模板管理下的任一节点，都会在右侧区域弹出节点对应的页面。 
单击基本数据配置和策略元素配置上的任一节点，都会在右侧区域弹出节点对应的查询配置页面。此页面又被分隔条划分为查询区和配置区。在没有新增或选中记录时，该页面呈现为查询状态，配置区灰化不可用。任一节点都提供了几种通用操作，说明参见表2。表2  按钮说明操作按钮作用说明新增单击按钮后，查询区记录末尾后出现一条高亮记录，同时配置区成为可用状态，可进行配置。删除先选中一条记录，单击按钮，则被选中记录被删除。复制先选中一条记录，单击按钮，在查询区记录末尾后出现一条高亮记录，此后可进行修改。保存新增或修改一条记录完成后，单击按钮，则记录内容被保存。刷新在执行上述操作之前，建议先执行刷新操作，以保证查询区内显示为最新记录。 说明：如果需要修改一条记录，单击该记录后配置区成为可修改状态，可进行配置修改。 
单击策略数据查询下的任一节点，都会在右侧区域弹出节点对应的查询页面。此页面又被划分为查询区、列表区和详细信息区。策略数据查询页面的操作按钮说明参见表3。表3  策略数据查按钮说明操作按钮说明查询根据设定的条件开始进行查询过滤。重置清除查询条件。 
单击日志报表查询下的任一节点，都会在右侧区域弹出节点对应的查询页面。 
#### 配置流程 
针对具体的策略需求要经过：策略分析、数据规划之后，才能进行本地策略配置。 
 说明： 
本文档仅对本地策略的配置方法进行说明。 
本地策略的配置流程如[图3]所示。
图3  本地策略配置流程图

 说明： 
图中虚框部分为可选配置节点，实框部分为必选配置节点。 
图中连线表示两节点间存在引用关系。箭头指向节点为引用节点；箭头背向节点为被引用节点。 
配置顺序由上到下。 
节点名称|作用说明
---|---
时段|用于定义一个时间段，可以作为条件参考值使用。例如：定义时段1为：2015–10–1~2015–12–31 8:00~10:00。
返还算法|在使用用量的返还功能时，需要先要配置返还算法。该参数用于定义在指定的条件下，哪种用量按照怎样的原则进行返还。
基本用量|通过多个维度定义出用户对网络的使用情况。当需要使用用量的返还功能时，基本用量需要关联一个已定义的返回算法。基本用量可在条件中使用。例如：用户日用量
表达式变量|对基本用量进行算术运算后的用量。表达式变量可在条件中使用。例如：每天8:00~10:00，用户日用量*80%（特定时间内，用户日用量打八折）。
自定义变量|通过定义属性值对变量增强说明。自定义变量可在条件中使用。例如：套餐1的有效期剩余时间
费率曲线|消费金额与消耗用量的比值称为费率，实时消耗的用量值与该消耗范围对应费率的乘积即消费金额。同一用量类型及单位的用量在不同消耗范围内的费率可绘制成一条费率曲线。在配置金额变量时需要关联费率曲线。
金额变量|RCP网元可以提供基本批价功能，基于用户消费金额做出策略决策。当用户的消费金额达到一定阀值时，RCP可以实时通知用户以避免出现高额话单，或使用消费金额作为某些策略的控制条件。定义的金额变量可用在条件中配置成金额条件，或者应用在通知内容模板中做动态参数使用。
条件|用在策略规则中，通过条件确定策略规则的执行时机。例如：当用户日用量>200M时；当套餐1的有效期剩余时间<180s时。
通知|通知的模板，用于定义通知的内容。可用在通知类型的动作参数中。例如：通知模板1：尊敬的用户你好，您本月已经使用流量500M，如有需要请充值！
动作参数|在策略规则中，用来确定满足条件后需要下发的参数。例如：当用户日用量>200M时，会话带宽限制为10M。
规则|在策略规则中包含一个条件表达式和一个动作参数集，并且策略规则具有优先级属性。策略规则表示当条件表达式为真时，需要执行其动作参数集中指定的动作参数。
场景|确定策略规则的使用范围。例如：在用户付费类型为预付费时，执行策略规则1和策略规则5。
#### 模板管理概述 
功能说明 :模板管理支持维护人员选择特定的模板，通过模板管理页面进行修改，生成所需的新套餐策略。
模板管理支持关键数据批量替换、修改业务基本配置、规则配置，修改之后支持预览，以及将数据提交生效。 
##### 概念介绍 
业务基本配置：包括套餐信息、套餐业务信息、业务信息、位置信息等配置。 
规则配置：包括策略规则、条件、动作等内容的配置。 
##### 模板管理 
概述 :本节介绍使用预定义模板快速新增套餐的操作过程。本节以配置“新达量降速套餐”为例进行介绍，其他套餐的配置过程类似。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

选择菜单模板管理
→模板管理
，弹出模板管理页面，如[图2]所示。
在模板管理页面，可以看到系统预定义的模板。
图2  模板管理页面

单击模板名称后的创建套餐按钮，弹出关键数据替换页面，如[图3]所示。
关键数据替换页面中的内容是该模板携带的可以批量替换的关键信息。填入新值之后，系统可以对模板中使用该参数地方进行批量替换，便于生成新的套餐配置。
图3  关键数据替换页面

内容修改完成之后单击确定按钮返回模板管理页面，如[图4]所示。
图4  模板管理页面

单击下一步，切换到业务基本配置页面，如[图5]所示。
业务基本配置页面的信息已经按照关键数据替换页面的信息进行了替换。
如果还有其他需要修改的字段，可以在此页面中进行修改。修改之后单击（保存）按钮。
图5  业务基本配置页面

单击下一步，切换到规则配置页面，如[图6]所示。
规则配置中的信息已经按照关键数据替换页面的信息进行了替换。 
如果还有其他需要修改的字段，可以在此页面中进行修改。修改之后单击（保存）按钮。
图6  规则配置页面

单击下一步，切换到预览与提交页面，如[图7]所示。
图7  预览与提交页面

单击执行按钮配置新的套餐。
#### 基本数据配置 
功能说明 :基本数据为策略元素中的条件及动作参数提供扩展，是可选配置。 
如果需要在策略规则中使用系统预定义以外的条件，则需要先在基本数据中配置出条件的基本元素。包含时段、返还算法、基本用量、表达式变量、自定义变量、费率曲线、金额变量。 
如果需要配置通知策略，则需要先在基本数据中配置出通知模板。 
##### 概念介绍 
目前基本数据中包含时段、返还算法、基本用量、表达式变量、自定义变量、费率曲线、金额变量、通知。 
时段用于定义出一个时间段，最小单位分钟，应用在条件中。 
返还算法用于定义返还用量的计算公式，应用在基本用量的返还属性中。 
基本用量即通过多个维度定义出用户对网络的使用情况，应用在条件中。 
表达式变量是将基本用量进行算术运算后产生的用量，应用在条件中。 
自定义变量是指具有属性说明的一类变量，应用在条件中。 
费率曲线用于在基本批价功能中提供费率配置，应用在金额变量中。 
金额变量是根据消耗用量和对应费率转换为消费金额，应用在条件或通知内容模板中。用于RCP实现基本批价功能，当用户的消费金额达到一定阈值时，RCP可以实时通知用户以避免出现高额话单，或使用消费金额作为某些策略的控制条件。 
通知模板用于定义通知的内容，被动作参数使用。 
##### 时段 
##### 时段 


概述 :RCP网元支持运营商基于时段进行策略控制。要实现这类策略控制，需要先在本界面中定义时段。在配置条件时才能引用已经定义的时段。最后，将时段条件应用在规则中。 


操作步骤 :

登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面






单击时段，弹出时段页面，如[图2]所示。
图2  时段页面






单击按钮，弹出基本属性页面，如[图3]所示。
图3  时段基本属性页面




时段参数说明参见[表1]。
参数名称|参数说明
---|---
时段名称|时段配置的名称，全局唯一，可修改。
时段属性|时段属性对时段的适用范围进行划分。基本划分为正常时段、忙时时段和闲时时段。其中，忙、闲时时段又分为系统级和套餐级。系统级的忙、闲时时段表示表示在RCP系统内都适用；套餐级忙、闲时时段表示仅对指定套餐适用，并且通过套餐标识来设置指定套餐。0–正常：表示此时段只作为一般的时段使用，不区分忙闲时。举例：业务策略需求为：每天的8:00~11:00和每天的12:00~16:00，在这两个时段内，用户使用BT业务时降低QoS带宽。分析说明：在这个策略需求中，只需要定义两个普通时段就可以了。时段属性都选择0–正常。1–系统忙时：表示此时段是系统级的忙时段。与条件中的策略变量系统忙闲时属性的参考值系统忙时关联。举例：运营者将2016年中的每个节假日都设定为系统忙时。业务策略需求为：每到节假日，所有在线用户都需要降低QoS参数。分析说明：把一年中的每个节假日都定义为一个系统忙时属性的时段，再在条件中选择“系统忙闲时属性”这个策略变量，同时条件的参考值选择“系统忙时”。最后，在规则中只包含这个条件即可实现业务策略需求。与基本用量->忙闲时状态中的系统忙时关联。举例：运营者将2016年中的每个节假日都设定为系统忙时。业务策略需求为：如果用户在系统忙时内的用量超过1G，那么降低QoS参数。分析说明：与上述举例类似，先定义出所有的“系统忙时”属性的时段，再配置基本用量。该基本用量的“忙闲时状态”属性选择“系统忙时”。最后，使用这个基本用量配置成为用量条件，并在规则中引用即可实现业务策略需求。2–系统闲时：表示此时段是系统的闲时段。与基本用量->忙闲时状态中的系统闲时关联。与条件中策略变量系统忙闲时属性的参考值系统闲时关联。3–套餐忙时：表示此时段是指定套餐的忙时段。指定套餐通过配置套餐标识实现。与基本用量->忙闲时状态中的套餐忙时关联。4–套餐闲时：表示此时段是指定套餐的闲时段。指定套餐通过配置套餐标识实现。与基本用量->忙闲时状态中的套餐闲时关联。举例：运营者设定套餐1的忙时段是每天的8:00~10:00，套餐2的忙时段是每天的9:00~11:00，套餐2的闲时段是12:00~14:00。业务策略需求为：根据用户在套餐忙闲时内的使用量提供不同的QoS参数。当用户在套餐1的忙时段内使用量超过100M时降低QoS带宽；当用户在套餐2的忙时段内使用量超过200M时降低QoS带宽；当用户在套餐2的闲时段内使用量超过100M时提高QoS带宽。分析说明：在这个策略需求中，三个忙、闲时段是与套餐有关的，必须关联套餐标识。因此，需要先定义这三个时段，时段属性和套餐标识应该分别配置为3–套餐忙时，套餐1；3–套餐忙时，套餐2；4–套餐闲时，套餐2。再定义3个基本用量，分别表示套餐1的忙时用量、套餐2的忙时用量、套餐2的闲时用量。3个基本用量中的忙闲时状态分别选择”套餐忙时“、”套餐忙时“、”套餐闲时“。最后，将3个基本用量配置成为用量条件，并分别在规则中使用即可。
套餐标识|当时段属性选择3–套餐忙时或者4–套餐闲时时，此字段必须配置。用来说明该套餐忙、闲时时段是针对哪个套餐的。套餐标识必须已经通过ADD PKGINFO配置。
起始时间/结束时间|用于定义时间段的起、止时间，最小单位分钟。结束时间必需大于起始时间，即不能配置跨天的时段。
起始日期/结束日期|用于定义时段生效的起、止日期。可选配置，必须成对配置且结束日期必需大于等于起始日期。不配置时表示时段不受日期约束。
星期|用于增强定义时段生效的具体日期。以周为周期，可多选配置。不配置时表示时段不受此项约束。例如，把每个周六和周日定义为系统忙时。具体配置：起始时间定义为00:00:00，结束时间定义为23:59:59，星期选择星期六和星期日，时段属性选择系统忙时。
月份|用于增强定义时段生效的具体月份。以年为周期，可多选配置。不配置时表示时段不受此项约束。例如，把每年的一月、二月定义为寒假。具体配置：起始时间定义为00:00:00，结束时间定义为23:59:59，月份选择一月和二月，时段属性选择正常。
第几天|用于增强定义时段生效的具体日期。以月为周期，可多选配置。不配置时表示时段不受此项约束。例如，把每月的第一天定义为话费出账日。具体配置：起始时间定义为00:00:00，结束时间定义为23:59:59，第几天选择1，时段属性选择正常。


配置完毕，单击按钮。




配置举例 :将2020年7月1日至2021年12月31日内每个10月和12月的每个周日的8:00~18:00作为系统忙时，且命名为时段1。 
配置完成如[图4]所示。
图4  时段1配置举例






注意 :
 
在执行操作步骤3之前和操作步骤4之后，必须按按钮刷新界面，以保证界面显示为最新记录。 

 
时段配置表示ZXUN RCP的决策时间。具体使用时，需要结合用户所在时区及夏令时信息或ZXUN RCP网元所在时区及夏令时信息综合考量。例如，定义时段1为每天的8:00~18:00，用户位于东2区，ZXUN RCP网元未启用夏令时。则表示时段1的生效时间为东2区的每天8:00~18:00。 

 
当规则执行的时间同时满足时段的各个配置项要求时，表示该时段条件匹配。 

 


界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 


[条件]


##### 返还算法 
概述 :随着数据业务在运营商业务中的比重不断增加，运营商更加关注用户在数据业务上的需求，并提供各种优惠服务来吸引用户，其中用量的返还功能成为运营商吸引用户的手段之一。 
RCP网元当前支持用户、套餐、业务层次的周期型基本用量的单账期的用量返还。单账期是指用量返还只涉及相邻一个账期内的返还。上一个刚结束的用量周期内，当用量的使用量满足预置的返还条件时，则按照返还算法计算返还用量，计入下个刚开始的用量周期使用。 
例如，运营商设定的返还策略为：当某个用量上一账期的总用量实际消耗量在500M~800M之间时，可以返还该用量剩余值的50%到当前账期。 
若把这个返还算法应用在套餐1月流量上，则表示当套餐1月流量在上一个账期的总用量实际消耗在500M~800M之间时，可以返还套餐1月流量在上个账期的剩余值的50%到当前账期使用。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击返还算法，弹出返还算法页面，如[图2]所示。
图2  返还算法页面

单击按钮，弹出基本属性页面，如[图3]所示。
图3  返还算法基本属性页面

返还算法参数说明参见[表1]。
参数名称|参数说明
---|---
返还名称|返还算法的名称，唯一描述一个返还算法，不可重复。返还算法可以在基本数据配置→基本用量→返还属性中的“返还算法名称”下拉框中关联，根据返还算法计算出基本用量的返还值。一个返还算法最多可被50个基本用量关联使用。
用量类型|表示可以使用该返还算法的基本用量的用量类型。确定后不可修改。
算法属性|在满足返还条件的情况下按照返还表达式，计算出返还值。至少包含一组，最多包含四组算法。每组算法由一个返还条件及一个返还表达式构成。每组算法的返还条件中的考量对象必须相同，并且每组算法的返还条件中的用量下限、用量上限不能交叉重叠。返还条件由考量对象、用量下限、用量上限构成。由用量下限、用量上限构成的区间为“左闭右开”区间。当考量对象的取值位于该区间内时，表示满足该返还条件。返还表达式由返还方式、计算对象、返还参数构成。
考量对象|根据考量对象的取值来判断是否进行返还。
用量下限|两个参数共同确定一个用量区间，表示考量对象取值的范围。当考量对象的取值在此范围内时可以使用相应的返还表达式计算返还量。
用量上限|两个参数共同确定一个用量区间，表示考量对象取值的范围。当考量对象的取值在此范围内时可以使用相应的返还表达式计算返还量。
返还方式|返还用量的计算方式百分比：采用百分比方式时，需要选择计算对象，并且通过返还参数配置要返还的百分比值。固定值：采用固定值方式时，需要通过返还参数配置要返还的用量值。
计算对象|仅当返还方式为“百分比”时需要配置。计算对象和考量对象可以不同。
返还参数|由返还方式决定返还参数的配置范围。返还方式为“百分比”时，返还参数表示返还计算对象的百分比值。返还参数范围0-100，单位为%。返还方式为“固定值”时，返还参数表示返还的用量值，返还参数的范围是0–4294967295，单位由用量类型决定。
返还表达式|用于显示计算返还值的表达式。系统会根据返还方式、计算对象、返还参数的取值自动显示返还值的计算表达式。返还方式为“百分比”时，返还表达式=（计算对象×返还参数）。返还方式为“固定值”时，返还表达式=（返还参数）。
算法属性下方空白区域是算法属性查询区。在算法属性下方单击增加算法属性，如[图4]所示。
图4  基本属性

配置完毕，单击按钮。
配置举例 :配置返还算法1： 
当1GB<总用量实际值<10GB时，返还总用量剩余值的30%。 
当10GB<总用量实际值<100GB时，返还固定值10GB。 
配置完成如[图5]所示。
图5  返还算法1配置举例

注意 :在执行操作步骤3之前和操作步骤5之后，必须刷新界面，用以保证界面显示为最新记录。 
每组算法属性的用量下限、用量上限不可交叉重叠，且需要按照从小到大的顺序配置。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
[基本用量]
##### 基本用量 
##### 基本用量 


概述 :基本用量是对用户使用网络的一种度量方式，通过多个维度描述了用户对网络的使用情况。 
基本用量可以配置成用量条件，并被规则引用。实现基于用量的使用情况进行策略控制。基本用量也可以在通知内容中作为动态参数，及时向通知用户用量消耗情况。 


操作步骤 :

登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面






单击基本用量，弹出基本用量页面，如[图2]所示。
图2  基本用量页面






单击按钮，弹出基本属性页面，如[图3]所示。
图3  基本属性页面




基本用量的基本属性页面下包含了基本用量常用的维度，参数说明参见[表1]。
参数名称|参数说明
---|---
策略变量编号|基本用量的编号。在工程内需要保证唯一。
策略变量名称|基本用量的名称。
用量层次|该参数将基本用量划分为不同的统计粒度。用户：表示统计用户的用量消耗量。套餐：表示统计用户指定套餐的用量消耗量。指定套餐通过配置套餐标识实现。业务：表示统计用户指定签约业务的用量消耗量。指定业务通过配置签约业务标识实现。用户组：表示统计指定用户组内成员消耗的总用量。指定用户组通过配置组类型实现。会话：表示统计当前会话的用量消耗量。应用标识：表示统计会话内指定受控业务的用量消耗量。指定受控业务通过配置应用标识实现。组套餐：表示统计指定组套餐被组内成员消耗的总用量。指定的组套餐通过配置组类型和套餐标识实现。组业务：表示统计指定组业务被组内成员消耗的总用量。指定的组业务通过配置组类型和签约业务标识实现。虚拟组：表示统计指定号码段内用户消耗的总用量。指定的号码段通过配置号码映射标识实现，号码映射标识对应的号码段内用户均为虚拟组成员。例如，定义所有IMSI号码以135开头的号段内的用户构成一个虚拟组。MK会话：表示统计当前会话中通过指定Monitoring Key上报的用量消耗总值，指定的Monitoring Key通过配置Monitoring Key 列表实现。MK用户：表示统计用户的通过指定Monitoring Key上报的用量消耗总值，指定的Monitoring Key通过配置Monitoring Key 列表实现。MK用户组：表示统计指定用户组内成员通过指定Monitoring Key上报的用量消耗总值，指定的MonitoringKey通过配置Monitoring Key 列表实现。
用量周期|该参数表示用量的清零周期。月：表示用量按月清零。天：表示用量按天清零。有效期：表示用量按套餐或签约业务的有效期清零。使用SHOW PKGINFO查询套餐或签约业务所属套餐的基本信息，当套餐有效期用量是否周期清空选择“是”并且套餐有效期用量清空周期（天）配置为非零值时，则该用量在套餐或签约业务的有效期内按每隔N天清零。周：表示用量按周清零。一次上下线：表示统计一次会话上下线期间的用量消耗量。一次会话上下线是指一次CCR-I~CCR-T之间的会话过程。会话下线则用量失效。周期N分钟：表示从会话上线或套餐生效时间开始之后每次N分钟内的用量，且用量按每N分钟清零。N分钟通过配置高级属性→N分钟实现。一次N分钟：表示从会话上线或套餐生效时间开始之后N分钟内的用量。N分钟到达后用量清零并且不再统计。N分钟通过配置高级属性→N分钟实现。交替N分钟：对用量层次是会话或应用标识的用量进行N/M分钟交替控制。分为累计周期和控制周期：累计周期：累积周期内，只累计用量，累计周期到达后用量不清零。累计周期的时长通过配置高级属性→N分钟实现。控制周期：控制周期内，不累积用量，但需要基于消耗用量进行策略控制。控制周期的时长通过配置高级属性→交替间隔实现。累计周期和控制周期的总时长到达后，用量被清零。
用量类型|用户使用网络的度量类型。流量时长业务访问次数上行流量下行流量
套餐标识|当用量层次与套餐或业务相关时，通过该参数指定套餐。该参数必须通过ADD PKGINFO预先配置。当用量层次为套餐、组套餐、组业务时，该参数必须配置。当用量层次为业务、MK用户、MK用户组时，该参数可选配置。
签约业务标识|当用量层次为业务、组业务时，通过该参数指定签约业务。
应用标识|当用量层次为应用标识时，通过该参数指定签约业务。该参数必须通过ADD APPSUBS或ADD AFAPPMEDIA预先配置。
组类型|当用量层次与组相关时，通过该参数指定组。由于RCP规定一个用户可以属于多个组，但每个组的类型必须互不相同。因此，通过指定组类型，就可以指定用户的组。
号码映射标识|当用量层次为虚拟组时，需要配置该参数。该参数用于指定虚拟组成员所对应的号码段。一个号码映射标识对应一个号码段。一个虚拟组最多包含4个号码映射标识，即4个号码段。这些号段内的用户组成一个虚拟组。号码映射标识必须通过ADD NUMABS预先配置。
用量签约阈值|表示用量对应的签约阈值。用户可以个性化签约用量的签约阈值，当用户没有个性化签约时，RCP使用此处配置的签约阈值参与计算剩余值或百分比。用户个性化签约用量的签约阈值在Sp接口的UDA消息或PNR消息的Usage-Limit-Record AVP（包含Usage-Type和Usage-Value）中获取。其中，Usage-Type表示“策略变量编号”，Usage-Value表示这个用量的“签约阈值”。
日志开关|开启license控制项后，RCP网元提供日志功能。该参数用于表示当编号1045的全局开关的取值为1时，用户在线期间与套餐或组套餐有关的用量（用量层次为套餐、业务、组套餐等）的变化情况（比如套餐用量跨周期被清零、用量累计等）是否需要记入系统日志。
Monitoring Key列表|当用量层次为MK会话、MK用户、MK用户组时，通过该参数指定Monitoring Key。该列表最多关联32个MonitoringKey。Monitoring Key必须在PCC规则参数集、ADC规则参数集或会话用量监控参数集中预先配置。
UDR用量键值|5G用UDR的MonitoringKey。


切换到高级属性页面，如[图4]所示。
图4  高级属性页面


高级属性页面下提供基本用量不常用的维度，只在基本属性无法满足用量定义时使用。基本用量高级属性参数说明参见[表2]。
参数名称|参数说明
---|---
流方向|表示用量根据流方向进行统计。*：表示不区分上行或下行流。上行：仅上行方向的流。下行：仅下行方向的流。
忙闲时状态|表示用量根据忙闲时状态进行统计。系统/套餐忙、闲时段通过时段→时段属性进行配置。*：表示不区分忙闲时。系统忙时：表示只统计系统忙时的用量消耗。系统闲时：表示只统计系统闲时的用量消耗。套餐忙时：表示只统计通过基本用量→基本属性→套餐标识指定的套餐的忙时的用量消耗。套餐闲时：表示只统计通过基本用量→基本属性→套餐标识指定的套餐的闲时的用量消耗。
漫游标识|表示用量根据用户的漫游状态进行统计。用户的漫游标识通过ADD ACCMAP进行配置。全部：统计用户在本地和漫游时所有用量消耗。本地：只统计用户在本地的用量消耗。漫游：只统计用户在漫游时的用量消耗。
接入类型|表示用量根据用户的接入类型进行统计。SGSN MCC-MNCSGSN IP/AN-GW AddressBSIDULIUE Local IP套餐级HomeZone：表示只统计用户在指定套餐的HomeZone区域内消耗的用量。指定套餐是通过基本用量→基本属性→套餐标识确定的套餐。套餐级非HomeZone：表示只统计用户不在指定套餐的HomeZone区域内消耗的用量。用户级HomeZone：表示只统计用户在用户HomeZone区域内消耗的用量。用户级非HomeZone：表示只统计用户不在用户HomeZone区域内消耗的用量。组套餐级HomeZone：表示只统计用户在组套餐HomeZone区域内消耗的用量。组套餐级非HomeZone：表示只统计用户不在组套餐HomeZone区域内消耗的用量。组级HomeZone：表示只统计用户在组HomeZone区域内消耗的用量。组级非HomeZone：表示只统计用户不在组HomeZone区域内消耗的用量。*：表示用量统计时不区分接入类型。套餐级HomeZone的来源：RCP从SPR发送的用户签约UDA或PNR消息中指定套餐的Package-Profile-Info中的HomeZone-Info中获取套餐级HomeZone区域。如果套餐的签约信息下没有携带，那么RCP从ADD PKGINFO配置中获取。用户级HomeZone来源：RCP从SPR发送的用户签约UDA或PNR消息的HomeZone-Info中获取用户级HomeZone区域。组套餐级HomeZone来源：RCP从SPR发送的组签约UDA或PNR消息中组套餐的Package-Profile-Info中的HomeZone-Info中获取套餐级HomeZone区域。如果组套餐的签约信息下没有携带，那么RCP从ADD PKGINFO配置中获取。组级HomeZone来源：RCP从SPR发送的组签约UDA或PNR消息的HomeZone-Info中获取组级HomeZone区域。
接入属性|该参数表示不同接入类型时对应的接入属性ID。不同接入类型的接入属性ID需要在如下配置中存在：接入类型为SGSN MCC-MNC时，接入属性取值与配置管理→承载业务配置→SGSN MCC-MNC接入配置中的接入属性关联。通过ADD MCCMNCACC预先配置。接入类型为SGSN IP/AN-GW Address时，接入属性取值与配置管理→承载业务配置→SGSN IP/AN-GWAddress接入配置中的接入属性关联。通过ADD SGSNIPACC预先配置。接入类型为BSID时，接入属性取值与配置管理→承载业务配置→BSID接入配置中的接入属性关联。通过ADD BSIDACC预先配置。接入类型为ULI时，接入属性取值与配置管理→承载业务配置→ULI接入配置中的接入属性关联。通过ADD ULIACC预先配置。接入类型为UE Local IP时，接入属性取值与配置管理→承载业务配置→UE本地IP接入配置中的接入属性关联。通过ADD UELOCIPACC预先配置。
NAI组|表示用量根据NAI组进行统计。当需要统计指定网络接入标识的用量消耗时，需设置此参数。该参数与配置管理→承载业务配置→NAI配置中的NAI组关联。通过ADD NAI预先配置。
RAT|表示用量根据终端接入的RAT进行统计。
N分钟|该参数用于指示：一次N分钟用量或周期N分钟用量的N的大小。交替N分钟用量的累计周期N的大小。
APN|表示用量根据终端的接入APN进行统计。当需要统计指定APN上的用量消耗时，需要设置此参数。
交替间隔（分）|该参数用于指示交替N分钟用量的控制周期时间M的大小，单位分钟。
Tethering|表示用量根据Tethering功能的状态进行统计。Tethering是一种网络共享技术，可以将便携机、台式机或其他智能终端等设备通过WiFi、蓝牙、USB物理连接等连接方式接入移动智能终端进行上网。用户可以开启智能终端的Tethering功能，提供Tethering功能的智能终端可以称之为Tethering用户。运营商可以对开启Tethering功能的用户使用的流量制定相应的策略控制。关闭：表示用量只统计Tethering功能关闭状态时PCEF/SMF上报的用量。开启：表示用量只统计Tethering功能开启状态时PCEF/SMF上报的用量。*：表示用量统计时不区分Tethering功能的状态。


切换到返还属性页面，如[图5]所示。
图5  返还属性页面




只有满足如下要求的基本用量，才可以配置返还属性： 

 
用量层次只能为：用户、套餐、业务。 

 
用量周期只能为：月、天、周、周期N分钟。 

 
用量类型只能为：流量、时长、点击次数。 

 
需要支持返还功能的基本用量才需要配置返还属性。在此页面中可以关联一个返还算法。 
基本用量返还属性参数说明参见[表3]。
参数名称|参数说明
---|---
返还算法名称|该基本用量使用的返还算法的名称，关联基本数据配置→返还算法中的返还名称参数。如果未配置该参数，则表示该基本用量不具有返还属性，不进行返还。
返还封顶|该参数表示返还的上限值。如果根据返还算法计算出的返还值大于返还封顶值，那么RCP使用返还封顶值作为最后的返还值。不填时表示返还不封顶。
总量封顶|该参数表示总用量的上限值，总用量值为签约值+返还值。如果根据返还算法计算出的返还值与签约值的总和大于总量封顶值，那么RCP使用总量封顶值与签约值的差值作为最后的返还值。不填时表示总量不封顶。例如：总量封顶配置为100M，签约值为60M，根据返还算法计算出的返还值为50M。返还算法计算出的返还值与签约值总和为110M，大于总量封顶值100M，因此最后的返还值为40M。当返还封顶和总量封顶参数同时填写时，RCP优先使用总量封顶。
使用优先级|表示用户使用用量签约值和返还值的优先级。基本优先：表示用户先使用签约值，在签约值耗尽后再使用返还值。返还优先：表示用户先使用返还值，在返还值耗尽后再使用签约值。


配置完毕，单击按钮。




配置举例 :配置基本用量1： 


套餐1的忙时月上行流量。 


需要在日志中记录该用量。 


需要使用返还功能。使用返还算法1计算返还用量，优先使用返还用量。 


配置完成如[图6]、[图7]和[图8]所示。
图6  基本用量1配置举例（基本属性）




图7  基本用量1配置举例（高级属性）




图8  基本用量1配置举例（返还属性）






注意 :在执行操作步骤3之前和操作步骤6之后，必须刷新界面，用以保证界面显示为最新记录。 


界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 



 
表达式变量 

 
自定义变量 

 
通知 

 
条件 

 


##### 表达式变量 
##### 表达式变量 


概述 :RCP网元可以提供用量核减功能。例如免计流量业务。当用户访问运营商充值网站，或用户配合运营商的调查时，此类业务的用量不应该被计入用户用量，需要从用户用量或者套餐用量中扣除。又例如一些用量折扣计算业务。在忙时或者闲时对用量进行加权计算等。这些新的用量需求，都是指在满足一定条件时，RCP对基本用量进行算术运算。使用这种方式计算得出的用量，称为表达式用量。 


操作步骤 :

登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面






单击表达式变量，弹出表达式变量页面，如[图2]所示。
图2  表达式变量页面






单击按钮，弹出基本属性页面，如[图3]所示。
图3  基本属性页面


表达式变量参数说明参见[表1]。
参数名称|参数说明
---|---
策略变量编号|表达式变量的编号。在工程内需要保证唯一，确定后不可修改。
策略变量名称|表达式用量的名称。可修改。
类型|表示需要进行算术运算的基本用量的用量类型。确定后不可修改。流量时长业务访问次数虚拟用量占比：算术表达式中只能使用虚拟组层次的基本用量，并且需要配置为：A/B的形式。
用量签约阀值|表达式变量的签约值。当类型为虚拟用量占比时，该参数不需要配置。
计算表达式|由条件表达式和算术表达式构成一组计算表达式。表示在满足条件表达式时，按照算术表达式进行计算。当类型为虚拟用量占比时，计算表达式只能配置一组。当类型为流量、时长、业务访问次数时，计算表达式至少配置一组，最多配置三组。计算表达式必须按序号1、2、3顺序配置。每组计算表达式中条件表达式为可选配置，但算术表达式必须配置。三组计算表达式中条件表达式不能都为空。
条件表达式|表示表达式变量计算的条件。只要当条件表达式结果为真时，才需要计算表达式变量的值。条件表达式可以为空，表示无条件计算表达式变量的值。条件表达式中的条件必须通过策略元素配置→条件预先配置。此处的条件表达式中可以使用时间条件和用量条件。
算术表达式|用于计算表达式变量的值。算术表达式可以对基本用量、已配置的表达式变量或常量进行加、减、乘、除运算。
计算表达式编辑框|通过以下步骤编辑一组计算表达式：从序号1开始选中一组计算表达式。编辑条件表达式。选中条件表达式页面，在条件列表中双击选择一个条件，则此条件会被加入到表达式编辑框中。在编辑框上方单击运算符，则此运算符会被追加到表达式编辑框中。重复步骤b.、c.，直至完成条件表达式的配置。编辑算术表达式。选中算术表达式页面，选择策略变量的类别，并且在用量列表中双击选择一个用量，则此用量会被加入到算术表达式编辑框中。在编辑框上方单击运算符，则此运算符会被追加到算术表达式编辑框中。重复步骤e.、f.，直至完成算术表达式的配置。算术表达式中可以使用常量。不能对两个用量进行乘法运算。


配置完毕，单击按钮。




配置举例 :配置表达式变量1：当基本用量1使用超过80%时，赠送1 GB。即：在基本用量1的剩余值基础上增加
1GB。 
配置完成如[图4]所示。
图4  表达式变量1配置举例






注意 :在执行操作步骤3之前和操作步骤4之后，必须刷新界面，用以保证界面显示为最新记录。 


界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 


[条件]


##### 自定义变量 
概述 :目前现网中需要用某些属性增强描述一个策略变量，以增加变量的含义。因此RCP网元提供了一种带有属性的策略变量的配置方法。这种带有属性的策略变量称为自定义变量。例如，当需要描述套餐的剩余时间时，可以通过套餐标识指定具体套餐。 
自定义变量可能带有多个属性，属性值由用户按实际需要进行配置，配置完成的自定义变量可用来配置条件或应用在通知内容模板中作为动态参数使用。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击自定义变量，弹出自定义变量页面，如[图2]所示。
图2  自定义变量页面

单击按钮，弹出基本属性页面，如[图3]所示。
图3  基本属性页面

自定义变量参数说明参见[表1]。
参数名称|参数说明
---|---
自定义变量名称|自定义变量的名称。唯一描述一个自定义策略变量。
策略变量|目前RCP网元支持的自定义策略变量列表，一旦自定义策略变量被定义保存后，该参数不可修改。套餐有效期剩余时间：该策略变量表示指定套餐的有效期剩余时间。该策略变量的取值为指定套餐的有效期结束时间与RCP网元的当前系统时间的差值。通过配置套餐标识进行指定套餐并且套餐必须通过ADD PKGINFO预先配置。接入属性：RCP网元将用户的接入位置按照不同的接入类型划分为不同的范围，每个范围使用一个接入属性编号表示。该策略变量表示用户当前的接入位置是否在接入类型的某个范围内。该策略变量的取值按照指定的接入类型分别关联ADD SGSNIPACC、ADD MCCMNCACC、ADD BSIDACC、ADD ULIACC、ADD UELOCIPACC中的接入属性。套餐级HomeZone状态标识：该策略变量表示用户是否在指定套餐的HomeZone区域内。通过配置套餐标识进行指定套餐并且套餐必须通过ADD PKGINFO预先配置。套餐忙闲时段状态标识：该策略变量表示RCP网元的当前系统时间是否在指定套餐的忙、闲时段内。通过配置套餐标识进行指定套餐并且套餐必须通过ADD PKGINFO预先配置，通过在基本数据配置→时段→时段属性中选择套餐忙时或套餐闲时实现指定套餐忙、闲时段的配置。速率：该策略变量表示会话或受控业务在单位时间内消耗的用量。RCP网元可以根据速率的消耗情况进行策略控制。归属组HomeZone状态标识：该策略变量表示用户是否在指定组的HomeZone区域内。由于用户所属的多个组必须组类型不同，因此通过配置组类型实现指定组。归属组套餐HomeZone状态标识：该策略变量表示用户是否在指定组的套餐HomeZone区域内。通过配置组类型实现指定组，通过配置套餐标识进行指定套餐并且套餐必须通过ADD PKGINFO预先配置。附加属性状态：当用户由于某些原因被限速后，RCP网元支持根据用户签约中携带的附加属性对用户执行临时提速策略。该策略变量表示指定附加属性标识的提速状态。通过配置附加属性标识进行指定，并通过ADD ADDATTR配置附加属性标识对应的临时提速时间。滑动窗口用量：该策略变量表示滑动窗口内的多个账期的用量之和。滑动窗口的取值表示周期型用量从当前账期开始的周期数量。字符型策略计数状态(Sy)：该策略变量表示Sy会话中指定策略计数器标识的状态，并将该策略计数器状态的值作为字符型数据使用。数值型策略计数状态(Sy)：该策略变量表示Sy会话中指定策略计数器标识的状态，并将该策略计数器状态的值作为数值型数据使用。用户接入区域状态标识：RCP网元支持将不同接入类型的接入属性划分到一个区域中，每个区域使用一个区域接入属性表示。该策略变量表示用户当前的接入位置是否在指定的区域接入属性内。区域接入属性通过ADD ACCAREA进行配置。应用归属业务套餐：该策略变量表示指定受控业务所归属的套餐。RCP网元使用应用标识表示指定受控业务，通过ADDAPPSUBS配置受控业务与签约业务的映射关系。字符型扩展属性类型：该策略变量表示用户签约中在用户层或套餐层对应扩展属性名称的扩展属性值，并将该扩展属性值作为字符型数据使用。数值型扩展属性类型：该策略变量表示用户签约中在用户层或套餐层对应扩展属性名称的扩展属性值，并将该扩展属性值作为数值型数据使用。用户套餐切换事件：该策略变量表示用户在当前会话中使用的套餐是否已切换成其它套餐或指定套餐。当用户套餐发生切换时，运营商可以踢用户下线并发短信通知用户。业务套餐切换事件：该策略变量表示指定受控业务所归属的套餐是否已切换成其它套餐或指定套餐。当业务套餐发生切换时，运营商可以踢用户下线并发短信通知用户。TDF业务状态：TDF网元和RCP网元间使用TDF应用标识来表示需要TDF网元探测的业务。当TDF网元检测到该TDF业务状态发生变化并上报给RCP网元后，RCP网元可以根据该TDF业务的状态进行策略决策。该策略变量表示指定的TDF业务是否处于开始或停止的状态。通过ADD TDFAPP指定TDF业务的应用标识。组成员属性：该策略变量表示用户在指定组内的角色是主用户或从用户。通过配置组类型实现指定组。当组内只有主、从两种角色时使用。用量阀值事件：该策略变量表示累计用量超过用量阀值的事件是否发生。业务配额状态：某些组网情况中需要由其他设备进行用量累计，RCP网元仅根据从SPR获取到的用量消耗量进行策略控制。该策略变量表示指定套餐的用量消耗量。通过配置套餐标识进行指定套餐并且套餐必须通过ADD PKGINFO预先配置。TDF业务实例个数：该策略变量表示指定TDF业务发生的实例个数。根据TDF业务发生的实例数，运营商可以调整该TDF业务的QoS参数。通过ADD TDFAPP指定TDF业务的应用标识。在线时套餐生效或失效：该策略变量表示用户在线期间，通过套餐标识指定的套餐是否在生效与失效状态间发生切换。套餐必须通过ADD PKGINFO预先配置。套餐首次激活事件：该策略变量通过从SPR获取激活标记来判断指定套餐是否为首次激活。当激活标记由“未激活”变更为“已激活”时，表示该事件发生。使用该策略变量作为条件，主要用于通知决策。通过配置套餐标识进行指定套餐并且套餐必须通过ADD PKGINFO预先配置。组成员自定义角色：该策略变量表示用户在指定组内的角色。通过配置组类型实现指定组。当组内有多种角色时使用。套餐终端类型绑定标识：该策略变量表示指定套餐中IMEI信息与当前会话中的IMEI信息的绑定结果。套餐终端类型TAC绑定标识：该策略变量表示指定套餐中IMEI_TAC信息与当前会话中的IMEI_TAC信息的绑定结果。套餐终端类型TAC&SNR绑定标识：该策略变量表示指定套餐中IMEI_TAC_SNR信息与当前会话中的IMEI_TAC_SNR信息的绑定结果。PRA状态：该策略变量表示用户当前位置是否在指定PRA标识的区域范围内。PRA标识的取值需要提前通过ADD PKGINFO命令增加，其中PRA类型和PRA标识参数需要设置具体的值。套餐起始日期：该策略变量表示指定套餐的有效期开始时间。套餐截止日期：该策略变量表示指定套餐的有效期结束时间。
策略变量属性|用于辅助描述自定义策略变量。
部分属性的取值列表与关联配置中参数取值有关，具体关联关系参见[表2]。
属性|关联配置|关联参数
---|---|---
套餐标识套餐A标识套餐B标识|在EM客户端配置页面的左侧命令树中，展开PCF→PCF_x节点，选择Npcf_PolicyManagement_0，选择配置管理→签约数据配置→套餐基本配置|套餐标识
附加属性标识|在EM客户端配置页面的左侧命令树中，展开PCF→PCF_x节点，选择Npcf_PolicyManagement_0，选择配置管理→签约数据配置→附加属性配置表|附加属性标识
应用标识|在EM客户端配置页面的左侧命令树中，展开PCF→PCF_x节点，选择Npcf_PolicyManagement_0，选择配置管理→承载业务配置→应用标识配置|应用标识
TDF应用标识|在EM客户端配置页面的左侧命令树中，展开PCF→PCF_x节点，选择Npcf_PolicyManagement_0，选择配置管理→承载业务配置→TDF应用标识映射配置|TDF应用标识
用量名称|登录RCP策略管理页面，选择基本数据配置→基本用量|策略变量名称
配置完毕，单击按钮。
配置举例 :配置自定义变量1：套餐1的有效期剩余时间。 
配置完成如[图4]所示。
图4  自定义变量1配置举例

注意 :在执行操作步骤3之前和操作步骤4之后，必须刷新界面，用以保证界面显示为最新记录。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
[条件]
##### 费率曲线 
##### 费率曲线 


概述 :RCP网元可以提供基本批价功能，基于用户消费金额做出策略决策。当用户的消费金额达到一定阀值时，RCP可以实时通知用户以避免出现高额话单，或使用消费金额作为某些策略的控制条件。 
消费金额与消耗用量的比值称为费率。实时消耗的用量值与该消耗范围对应费率的乘积即对应的消费金额。同一用量类型及单位的用量在不同消耗范围内的费率可绘制成一条费率曲线。本节配置的费率曲线只应用在金额变量配置中。本节介绍费率曲线的配置方法。 


操作步骤 :

登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面






单击费率曲线，弹出费率曲线页面，如[图2]所示。
图2  费率曲线页面






单击按钮，基本属性页面变更为可编辑状态，如[图3]所示。
图3  费率曲线基本属性页面


费率曲线参数说明参见[表1]。
参数名称|参数说明
---|---
费率曲线名称|用于唯一描述一条费率曲线。
用量类型|表示用量的所属类型。1–流量2–时长3–业务访问次数
单位|表示消耗用量的单位。当用量类型为流量时，可选单位如下：KByteMByteGByte当用量类型为时长时，可选单位如下：分钟小时当用量类型为业务访问次数时，可选单位如下：次数100次
起始固定费用|用于定义费率曲线的起点金额。在使用固定费用+费率换算批价模式时，需要配置该参数。举例，用户每天消耗流量小于10M时，固定费用5元；日消耗流量大于10M后，按照1元/M收费。在此例中，本参数应该配置为5。同时，配置消耗用量范围0~10M时的费率为0；配置消耗用量范围10~∞时的费率为1。
费率属性|用于定义该费率曲线中消耗用量的范围与费率的对应关系。费率属性包含的参数说明参见表2。
参数名称|参数说明
---|---
序号|每段消耗用量范围在这个费率曲线中的序号。一条费率曲线中最多包含16个费率。
用量范围|与用量类型和单位共同确定消耗用量的范围，支持小数后两位。
费率|表示消耗用量在某范围内时对应的费率，支持小数后两位。举例，用户每天消耗流量小于10MByte时，按照1元/M收费；日消耗流量大于10M后，按照2元/M收费。在此例中，用量类型选择流量，单位选择MByte，起始固定费用配置为0，并新增费率属性。序号1的费率属性中用量范围配置0~10，费率配置为1；序号2的费率属性中用量范围配置为10~∞，费率配置为2。


单击费率属性下方的按钮新增费率属性。配置用量范围起始值和用量范围对应的费率即完成一条费率属性的配置。若该费率曲线包含多个费率段，则重复此步骤。


配置完毕，单击按钮。




配置举例 :RCP提供以下四种基本批价模式，以下分别介绍并举例。 

 
固定费用批价模式。运营商对用户在账期内产生的消耗用量采取固定费用核算。用户支付固定费用且用户在账期内可消耗的用量不封顶。费率曲线如图4所示。图4  固定费用批价模式费率曲线
举例：采用固定费用批价模式。用户每月本地流量不限制使用，流量费用固定为50元。配置完成，如图5所示。图5  固定费用批价模式举例

 

 
免费用量批价模式。对用户的某一类的用量免费。可以全部免费，也可以免去一定额度的用量的费用。账期内全部免费的费率曲线如图6所示。账期内部分免费的费率曲线如图7所示。图6  免费用量批价模式费率曲线1–账期内全部免费
图7  免费用量批价模式费率曲线2–账期内部分免费

举例：采用免费用量批价模式。用户每月免费使用本地流量。配置完成，如图8所示。图8  免费用量批价模式举例1–账期内全部免费

举例：采用免费用量批价模式。用户每月免费使用本地流量100M，超出100M后，按照1元/M收费。配置完成，如图9所示。图9  免费用量批价模式举例2–账期内部分免费
 

 
费率转换批价模式。对用户在账期内产生的消耗用量按照固定的费率计算。费率曲线如图10所示。图10  费率转换批价模式费率曲线
举例：采用费率转换批价模式。用户每月使用本地流量按照1.5元/M收费。配置完成，如图11所示。图11  费率转换批价模式举例
 

 
费用封顶批价模式。对用户在账期内产生的消费金额进行封顶。即消耗用量达到一定额度前按照实际用量进行批价，而当消费金额达到一定的封顶值不再进行计费。费率曲线如图12所示。图12  费用封顶批价模式费率曲线
举例：采用费用封顶批价模式。用户每月使用本地流量按照1.5元/M收费，当消耗用量超过2G时，用户可免费使用后续流量。配置完成，如图13所示。图13  费用封顶批价模式举例
 

 


注意 :无。 


界面说明 :带有(*)标识的参数为必选配置，其他为可选配置。 


##### 金额变量 
概述 :RCP网元可以提供基本批价功能，基于用户消费金额进行策略决策。当用户的消费金额达到一定阈值时，RCP可以实时通知用户以避免出现高额话单，或使用消费金额作为某些策略的控制条件。 
本节配置的金额变量可用于在条件中使用，配置成金额条件。也可以作为动态参数在通知内容模板中使用。本节介绍金额的配置方法。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击金额变量，弹出金额变量页面，如[图2]所示。
图2  金额变量页面

单击按钮，基本属性页面变更为可编辑状态，如[图3]所示。
图3  金额变量基本属性页面

金额变量参数说明参见[表1]。
参数名称|参数说明
---|---
金额编号|金额变量的编号。保证全局唯一。
金额名称|金额变量的名称，用于唯一描述一个金额变量。
金额周期|表示金额的清零周期。月有效期
金额签约阀值|该参数用于表示该金额变量对应的本地签约阈值。在条件中配置金额条件时，可以使用本参数。
用量名称|金额中关联的用量的名称。
取整步长|用量对象的消耗用量值按照此参数向上取整。若运营商特别要求需要对消耗用量向上取整，则此参数按照运营商要求配置。若运营商无特殊要求，则此处建议配置为1。当用量对象类型分别为流量、时长、业务访问次数时，取整步长单位分别为Byte、秒、次。
费率曲线名称|表示用量对象使用的费率曲线的名称。与用量名称、取整步长作为一组配置参数，共同说明了一个金额变量中某个用量对象的消费金额的计算方法。举例，金额对象1表示用户每月的漫游用量对应的消费金额。漫游用量按照2元/M计费。配置过程如下：配置基本用量“用户月漫游流量”。配置费率曲线“rate_2”。其中，用量类型配置为流量；单位配置为MByte；起始固定费用配置为0；包含一个费率属性。该费率属性中序号为1；用量范围是0~∞，费率配置为2。配置金额变量“fee_month”。金额周期选择月；金额无签约阀值；该金额变量包含一个用量对象。用量名称为“用户月漫游流量”；取整步长配置为1Byte；费率曲线名称选择“rate_2”。
右击基本属性下方单击新增属性。配置用量名称、取整步长和费率曲线名称即完成一条金额属性的配置。若该金额变量包含多个属性，则重复此步骤。
配置完毕，单击按钮。
配置举例 :配置金额变量1：表示用户每月消费金额。包含两部分： 
用户每月本地流量消费的金额。本地流量按照1元/M计费。 
用户每月漫游流量消费的金额。漫游流量按照2元/M计费。 
根据上述要求，需要按照以下步骤进行配置： 
配置2个基本用量。分别表示用户本地月流量和用户漫游月流量。 
配置2个费率曲线。分别表示本地费率和漫游费率。 
配置1个金额变量。表示用户月消费金额。需要关联上述配置信息。 
配置完成如[图4]所示。
图4  金额变量1配置举例

注意 :一个金额变量中至少有一个用量对象，最多支持30个不同的用量对象组合，且用量对象不能重复。 
RCP系统中最多支持配置200个金额变量。 
RCP系统内金额变量没有单位。通知内容中使用金额变量作为动态参数时，单位需要由配置人员输入。 
界面说明 :带有(*)标识的参数为必选配置，其他为可选配置。 
##### 通知 
概述 :RCP在特定条件下可以向用户或第三方发送通知，通知形式包括短信、邮件及SOAP消息。本界面用于配置通知内容模板。
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击通知，弹出通知页面，如[图2]所示。
图2  通知页面

单击按钮，弹出基本属性页面，如[图3]所示。
图3  基本属性页面

通知参数说明参见[表1]。
参数名称|参数说明
---|---
通知名称|通知内容模板的名称。全局唯一，不可重复。
通知语言|通知主题或通知内容中引用的动态参数的取值别名的语言类型。正常配置时，动态参数的取值别名语言应该与通知主题、通知内容中语言的类型保持一致。若需要扩展通知语言类型，那么需要先通过ADD PARAMENUM扩展参数编号1的枚举值，即增加新的语言类型。刷新本界面后，本字段才能查看到新增的语言类型，用于配置通知内容模板。
通知主题|表示该通知内容模板的主题，仅在邮件中使用。由维护人员自行配置。配置通知主题时可以引用动态参数，最终发出的通知主题中，将根据动态参数的实际取值替换通知主题中对应的动态参数。举例：配置通知主题为：用户{IMSI}的本月账单通知。最终发出的邮件的主题中将使用用户的IMSI号码进行替换。
通知内容|表示该通知内容模板的内容，仅在邮件、短信中使用。由维护人员自行配置。配置通知内容时可以引用动态参数，最终发出的通知内容中，将根据动态参数的实际取值替换通知内容中对应的动态参数。举例：配置通知内容为：尊敬的客户，您好。您的移动号码{IMSI}余额不足，请及时充值。最终发出的邮件或短信的内容中将使用用户的IMSI号码进行替换。
策略变量类别|动态参数的策略类型。用户信息类接入信息类IPCAN会话信息类自定义策略变量普通用量日期信息
策略变量|可以在通知主题或通知内容中引用的动态参数。
单位|动态参数的单位。
单位别名|动态参数单位的别名。
日期类型|当策略变量类别选择“基本用量日期类型”时，本选项可使用。表示与用量账期有关的策略变量的日期类型。
日期格式|日期的显示格式。当策略变量类别选择“基本用量日期类型”时，本选项可使用。
通知主题可以使用的动态参数参见[表2]。
策略变量类别|策略变量|说明
---|---|---
用户信息类|IMSI|用户的IMSI
CUI|用户信息类|用户的CUI
MSISDN|用户信息类|用户的MSISDN
用户姓|用户信息类|用户的姓氏
用户名|用户信息类|用户的名字
用户类型|用户信息类|用户签约的用户类型
付费类型|用户信息类|用户签约的付费类型
接入信息类|ULI MCC|用户的ULI（User Location Information，用户位置信息）中的MCC（Mobile CountryCode，移动国家码）
ULI MNC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的MNC（Mobile NetworkCode，移动网络号码）
ULI LAC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的LAC（Location AreaCode ，位置区域码）
ULI RAC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的RAC（Routing AreaCode，路由区域码）
ULI CI|接入信息类|用户的ULI（User Location Information，用户位置信息）中的CI（Cell Identity，小区标识）
ULI SAC|接入信息类|ULI（User Location Information，用户位置信息）中的SAC（Service Area Code，服务区域码）
ULI TAC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的TAC（Tracking AreaCode，跟踪区域码）
ULI ECI|接入信息类|用户的ULI（User Location Information，用户位置信息）中的ECI（E-UTRAN CellIdentifier，小区标识）
BSID|接入信息类|用户使用的BSID（Base Station Identity Code，基站识别码）
IP-CAN Type|接入信息类|用户使用的IP-CAN（IP Connectivity Access Network，IP连接访问网络）类型
RAT|接入信息类|用户使用的RAT（Radio Access Technologies，无线接入技术）
3GPP RAT|接入信息类|用户使用的3GPP-RAT
通知内容可以使用的动态参数参见[表3]。
策略变量类别|策略变量|说明
---|---|---
用户信息类|IMSI|用户的IMSI（International Mobile Subscriber Identification Number，国际移动用户识别码）
CUI|用户信息类|用户的CUI（Charging User Identifier，计费用户标识）
MSISDN|用户信息类|用户的MSISDN（Mobile Station International Subscriber DirectoryNumber，移动台国际用户目录号）
IMEISV|用户信息类|用户的IMEISV（International Mobile Equipment  Identity SoftwareVersion，移动台识别码软件版本）
IMEI TAC|用户信息类|用户的IMEI（International Mobile Equipment  Identity ，国际移动台识别码）中的TAC（TypeAllocation Code，类型分配码）
IMEI SNR|用户信息类|用户的IMEI（International Mobile Equipment  Identity ，国际移动台识别码）中的SNR（SerialNumber，序列号）
套餐名称|用户信息类|当前场景入口的用户套餐或业务套餐的名称。
用户终端IPv4地址|用户信息类|用户终端IPv4地址，策略变量值取自CCR消息中的Framed-IP-Address。
用户终端IPv6地址|用户信息类|用户终端IPv6地址，策略变量值取自CCR消息中的Framed-IPv6-Prefix。
用户姓|用户信息类|用户的姓氏
用户名|用户信息类|用户的名字
用户类型|用户信息类|用户签约的用户类型
付费类型|用户信息类|用户签约的付费类型
接入信息类|ULI MCC|用户的ULI（User Location Information，用户位置信息）中的MCC（Mobile CountryCode，移动国家码）
ULI MNC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的MNC（Mobile NetworkCode，移动网络号码）
ULI LAC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的LAC（Location AreaCode ，位置区域码）
ULI RAC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的RAC（Routing AreaCode，路由区域码）
ULI CI|接入信息类|用户的ULI（User Location Information，用户位置信息）中的CI（Cell Identity，小区标识）
ULI SAC|接入信息类|ULI（User Location Information，用户位置信息）中的SAC（Service Area Code，服务区域码）
ULI TAC|接入信息类|用户的ULI（User Location Information，用户位置信息）中的TAC（Tracking AreaCode，跟踪区域码）
ULI ECI|接入信息类|用户的ULI（User Location Information，用户位置信息）中的ECI（E-UTRAN CellIdentifier，小区标识）
ULI NCI|接入信息类|用户的ULI（User LocationInformation，用户位置信息）中的NCI（nrCellId，NR小区标识）
BSID|接入信息类|用户使用的BSID（Base Station Identity Code，基站识别码）
IP-CAN Type|接入信息类|用户使用的IP-CAN（IP Connectivity Access Network，IP连接访问网络）类型
RAT|接入信息类|用户使用的RAT（Radio Access Technologies，无线接入技术）
3GPP RAT|接入信息类|用户使用的3GPP-RAT
会话信息类|APN|用户使用的APN（Access Point Name，接入点名称）
PGW IP地址|会话信息类|对端PCEF主机的IP地址
PCRF IP地址|会话信息类|本端PCRF主机的IP地址
会话Init-Time|会话信息类|当前IPCAN会话建立的时间，策略变量值为公元2000年到当前IPCAN会话建立时的秒数。
自定义策略变量|关联当前已配置的套餐有效期剩余时间类型的自定义策略变量的名称|表示用户的某个套餐距离套餐有效期结束的剩余时间。需要选择单位，单位别名可选填写。
关联当前已配置的滑窗用量类型的自定义策略变量的名称|自定义策略变量|表示用户在滑窗期内指定用量实际使用量的总和。需要选择单位，单位别名可选填写。
普通用量日期信息|关联当前已配置的周期型普通用量的名称|表示周期用量的账期信息。开始日、结束日、用量采集日。需要选择“日期格式”和“日期类型”。
普通用量策略变量|关联当前已配置的普通用量的名称|表示用户的用量信息。需要选择单位，单位别名可选填写。
在通知模板主题中增加动态参数的步骤如下。 
选中通知主题。
选择策略变量类别及策略变量。 
单击确定。
通知模板主题中支持的动态参数没有单位及单位别名，不需要选择。 
在通知模板内容中增加动态参数的步骤： 
选中通知内容。
选择策略变量类别及策略变量。 
对有单位的动态参数可以选择单位或填写单位别名，单击确定。
如果动态参数的值需要用别名代替，则需要通过[ADD PARAMALIAS]命令添加别名，并且通知内容模板中的通知语言类型要与[ADD PARAMALIAS]中的语言一致，使RCP能够选择对应语言类型的别名进行替换。
当策略变量类别选择“基本用量日期类型”时，同时选择策略变量、日期类型及日期格式。完成在通知内容中添加与用量有关的日期信息。 
 说明： 
最多可以使用30个动态参数。 
配置完毕，单击按钮。
配置举例 :配置通知1：无通知主题，通知内容为：尊敬的{用户类型}用户您好，根据系统记录，由{pkg1_mon_usg.账期开始日}(YYYY-MM-DD)起至{pkg1_mon_usg.用量采集日}(YYYY-MM-DD)，阁下流动电话号码{IMSI}使用之累计本地数据用量已达{pkg1_mon_usg.总用量实际值}(MByte),并已达到／超过阁下数据服务之公平使用数据用量上限。阁下之数据传输速度于4小时候将被限制不低于128kbps，直至{pkg1_mon_usg.账期结束日}(YYYY-MM-DD)为止。请注意，实际数据传输速度会因多项外在因素而有所影响。 
配置完成如[图4]所示。
图4  通知1配置举例

通知内容中的动态参数用户类型的参数值需要使用中文的别名进行替换。因此，该模板中通知语言选择中文。同时，使用[ADD PARAMALIAS]增加用户类型可能的参数值的中文别名。例如，运营商规划用户类型的参数值为301时表示金牌用户；用户类型的参数值为302时表示银牌用户。则对应命令分别为：
[ADD PARAMALIAS]:ID="USER_TYPE",VALUE="301",LANGUAGE="zh-cn",ALIAS="金牌用户";
[ADD PARAMALIAS]:ID="USER_TYPE",VALUE="302",LANGUAGE="zh-cn",ALIAS="银牌用户";
。
最终RCP将根据用户实际的用户类型的取值和该模板中的通知语言，查到对应的别名，对通知内容中的用户类型进行替换。
注意 :在执行操作步骤3之前和操作步骤6之后，必须刷新界面，用以保证界面显示为最新记录。 
动态参数在通知模板主题和内容中都可以使用，分别最多关联30个。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
[动作参数]
#### 策略元素配置 
功能说明 :本地策略的要素包含条件、动作参数、规则、场景。将这些要素组合，表达的含义是：在特定的场景下，满足不同的预置条件时，执行不同的策略动作。 
##### 概念介绍 
条件：匹配策略规则的依据。 
动作：在满足一组条件后，所进行的操作。 
规则：控制策略的集合，包含条件和动作。 
场景：确定一组策略规则的使用范围。 
##### 条件 
概述 :条件由策略变量、运算符、参照系组成。 
策略变量，也称为业务键，是能够描述一定业务特征的最小粒度。 
在定义条件时指定一个变量，通常是一个业务键，以此确定条件需要考察的对象。条件内容中使用的业务键称为条件业务键。 
在定义条件时指定条件参照系，通常是若干个常量，以此确定条件需要考察的范围或比较对象。条件参照系中的常量称为条件参考值。 
条件运算确定了条件业务键和条件参考值之间的关系。包括：数值比较、掩码运算、通配、子集归属等。称为条件运算符。 
通过与（AND）、或（OR）、非（NOT）可以将若干条件构成一个条件表达式，应用在策略规则中。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击条件，弹出条件页面，如[图2]所示。
图2  条件页面

单击按钮，弹出基本属性页面，如[图3]所示。
图3  基本属性页面

条件参数说明参见[表1]。
参数名称|参数解释
---|---
条件名称|用户自定义的该条件的名称。可修改。
选择策略变量|RCP网元将大量的业务键进行划分。可以通过互斥按钮选择条件业务键的大致分类。条件保存后不可修改。用量：条件内容中将要使用基本数据配置→基本用量或基本数据配置→表达式变量中定义的用量。金额：条件内容中将要使用基本数据配置→金额变量中定义的金额对象。其他：条件内容中将要使用除用量、金额以外的业务键。
策略变量类别|对上述的大类又划分出的子类别，以便快速确定条件的内容。用量策略变量的类别：1–总用量实际值：表示用户实际已使用的用量。2–总用量剩余值：表示用户所有可用的剩余用量。3–总用量百分比：表示用户实际已使用用量与用户所有用量的百分比值。4–基本用量实际值：表示用户实际已使用的签约用量。5–基本用量剩余值：表示用户可用的剩余签约用量。6–基本用量百分比：表示用户实际已使用的签约用量与用户签约用量的百分比值。7–返还实际值：表示用户实际已使用的返还用量。8–返还剩余值：表示用户可用的剩余返还用量。9–返还百分比：表示用户实际已使用的返还用量与用户返还用量的百分比值。举例：用户签约套餐1，套餐1的月签约用量值为150M。用户在本月已使用80M，其中上月的50M返还用量已经全部消耗。对应上述各类用量的取值为：总用量实际值：80M总用量剩余值：120M总用量百分比：40%基本用量实际值：30M基本用量剩余值：120M基本用量百分比：20%返还用量实际值：50M返还用量剩余值：0M返还用量百分比：100%金额策略变量的类别：金额实际值：所有已定义的金额变量均有此值。条件参考值类型可以选择值或策略变量。金额剩余值：金额签约值与金额实际值的差值。金额签约值在基本数据配置→金额变量中金额签约阀值进行配置。当金额签约阀值字段配置为0时，表示该金额变量无签约值。条件参考值类型可以选择值或策略变量。金额百分比：金额实际值与金额签约值的比值。条件参考值类型只能选择值。其他策略变量的类别：全选：可以下拉查看所有的策略变量，同时RCP网元支持编辑框模糊匹配查找策略变量。系统类：包含可以从RCP网元本身客观获取的业务键。例如，系统时间、系统状态。系统类策略变量可用于所有的策略类型。具体策略变量说明参见表2。流信息类：包含与AF会话中媒体子部件相关的业务键，RCP网元从AAR消息的Media-Component-Description中获取Media-Sub-Component。例如，上行流目的端口、流方向、流用途等。其中，流描述相关的IP、端口、协议类型、流方向等取自媒体子部件下的Flow-Description，流用途取自媒体子部件下的Flow-Usage，最大请求上行带宽取自媒体子部件下的Max-Requested-Bandwidth-UL，最大请求下行带宽取自媒体子部件下的Max-Requested-Bandwidth-DL。流信息类策略变量可用于Rx接口接纳策略、业务控制策略、业务级用量监控策略、N7业务控制策略。具体策略变量说明参见表3。AF信息类：包含与AF会话以及媒体部件相关的业务键。例如，媒体类型、AF应用标识。AF信息类策略变量可用于Rx接口接纳策略、会话控制策略、会话级用量监控策略、承载控制策略、黑白名单策略、业务预下发控制策略、业务控制策略、业务级用量监控策略、N7会话控制策略、N7业务控制策略、AMF接入移动策略、UE路由选择策略。具体策略变量说明参见表4。用户信息类：包含与用户签约相关的业务键。通过Sp接口从SPR获取。例如，用户类型、用户套餐。用户信息类策略变量可用于套餐动态优先级策略、会话控制策略、会话级用量监控策略、承载控制策略、黑白名单策略、业务预下发控制策略、业务控制策略、业务级用量监控策略、通知策略、套餐预定义策略、N7会话控制策略、N7业务控制策略、AMF接入移动策略、UE路由选择策略。具体策略变量说明参见表5。组信息类：包含与用户组相关的业务键。例如，用户组类型、用户组ID。组信息类策略变量可用于会话控制策略、会话级用量监控策略、承载控制策略、黑白名单策略、业务预下发控制策略、业务控制策略、业务级用量监控策略、N7会话控制策略、N7业务控制策略。具体策略变量说明参见表6。接入信息类：包含与终端接入位置相关的业务键。例如，RAT，ULI，SGSN IPv4地址。接入信息类策略变量可用于套餐动态优先级策略、会话控制策略、会话级用量监控策略、承载控制策略、黑白名单策略、业务预下发控制策略、业务控制策略、业务级用量监控策略、通知策略、套餐预定义策略、N7会话控制策略、N7业务控制策略、AMF接入移动策略、UE路由选择策略。具体策略变量说明参见表7。会话信息类：包含与IP-CAN会话相关的业务键。例如，APN、接入网计费IPv4地址。会话信息类策略变量可用于套餐动态优先级策略、会话控制策略、会话级用量监控策略、承载控制策略、黑白名单策略、业务预下发控制策略、业务控制策略、业务级用量监控策略、通知策略、套餐预定义策略、N7会话控制策略、N7业务控制策略、AMF接入移动策略、UE路由选择策略。具体策略变量说明参见表8。IP-CAN承载信息类：包含与IP-CAN承载相关的业务键。例如，承载用途、承载QCI。IP-CAN承载类策略变量可用于业务预下发控制策略、业务控制策略、业务级用量监控策略、N7业务控制策略和承载控制策略。由于协议演进的原因，本类策略变量基本不再使用。具体策略变量说明参见表9。映射策略变量类：通过配置ADD NUMABS和ADD IPABS，将若干同类型的号码或地址划分为一组，每组使用一个映射标识表示。可以将映射标识作为此类条件的条件参考值使用。用于表示用户的号码或接入地址是否在条件指定的映射标识范围内。映射策略变量可用于套餐动态优先级策略、会话控制策略、会话级用量监控策略、承载控制策略、黑白名单策略、业务预下发控制策略、业务控制策略、业务级用量监控策略、通知策略、套餐预定义策略、N7会话控制策略、N7业务控制策略、AMF接入移动策略、UE路由选择策略。具体策略变量说明参见表10。自定义策略变量：引用在基本数据配置→自定义变量中定义的策略变量。表达式策略变量：引用在基本数据配置→表达式变量中定义的虚拟组用量占比类的策略变量。
策略变量|在上述类别下选择具体的策略变量。根据策略变量类别的不同，该下拉列表中展示不同的策略变量。
操作符|即条件运算符。由于策略变量的数据类型各有不同，因此可使用的操作符也不相同。in：数值型、字符型、地址型策略变量都可使用。该运算符可以有至少1个，最多8个操作数。表示条件业务键值是否等于操作数中的一个。Subnet：仅地址型策略变量可使用。操作数包含子网IP地址及掩码。表示条件业务键值是否与子网IP地址位于同一子网。=：数值型、字符型、地址型策略变量都可使用。该运算符仅有1个操作数。表示条件业务键值是否等于操作数。<：数值型及用量策略变量都可使用。该运算符仅有1个操作数。表示条件业务键值是否小于操作数。<=：仅数值型策略变量可使用。该运算符仅有1个操作数。表示条件业务键值是否小于等于操作数。>：数值型及用量策略变量都可使用。该运算符仅有1个操作数。表示条件业务键值是否大于操作数。>=：仅数值型策略变量可使用。该运算符仅有1个操作数。表示条件业务键值是否大于等于操作数。()：仅数值型策略变量可使用。该运算符有2个操作数且第二操作数不能小于第一操作数。表示条件业务键值是否位于由2个操作数确定的开区间内。Substr：仅字符型策略变量可使用。该运算符有2个操作数，包含起始位置及字符串。表示条件业务键值从起始位置开始的子串是否与预置的字符串相同。Unset：数值型、字符型、地址型及用量策略变量都可使用。该运算符没有操作数。表示条件业务键值无法获取。InRange：仅数值型策略变量可使用。该运算符有至少1组，最多4组。每组由2个操作数构成一个闭区间。相邻组之间后一组起始值不小于前一组结束值。表示条件业务键值是否位于一组操作数闭区间内。TimeIn：仅时段策略变量可使用。条件参考值可关联一个在基本数据配置→时段中定义的时段名称。表示RCP网元的决策时间是否在此时段内。RegEx：数值型、字符型、地址型策略变量都可使用。正则表达式运算符，操作数格式需符合PCRE规范。SubstrIn：仅字符型策略变量可使用。该运算符有3个操作数，包含起始位置、起始字符串、结束字符串。要求起始字符串与结束字符串的长度相同且结束字符串大于起始字符串。表示条件业务键值从起始位置开始的子串是否在预置的字符串闭区间内。Ifhave：仅事件类策略变量可使用。这类条件业务键在同一时刻可能存在多个值，该运算符表示多个条件业务键值中是否存在条件参考值。Delta：用量策略变量可使用。增量运算符，仅有1个操作数即增量阀值。表示条件业务键值是否增量使用预置阀值。
值类型|条件参考值的类型。如果条件参考值为固定值，则选择值。如果条件参考值为其他类型的策略变量，则选择策略变量。
值|仅当值类型选择值时，才需要输入具体的参考值。
用量策略变量|仅当值类型选择策略变量时，才需要输入具体的策略变量。一般条件参考值中的策略变量都是用量签约值。
策略变量|说明
---|---
时间|该策略变量表示RCP网元的系统时间是否在指定的时段内。使用该策略变量定义条件时，条件参考值需要关联通过基本数据配置→时段配置的时段。
系统忙闲时属性|该策略变量表示RCP网元的系统时间是否处于RCP系统的忙时段或闲时段内。RCP系统的忙时段或闲时段通过基本数据配置→时段中的时段属性选择系统忙时或系统闲时配置。
系统状态|该策略变量表示RCP网元的系统状态。通过编号为1058的全局开关可以设置RCP网元的系统状态。当RCP网元为紧急状态时，可以拒绝普通用户上线。
策略变量|说明
---|---
流用途|该策略变量表示IP流的用途，包括传输 RTCP、AF信令协议或没有信息等。
上行流IPv4源地址|该策略变量表示上行IP流类型为IPv4时的源IP地址。
上行流IPv6源地址|该策略变量表示上行IP流类型为IPv6时的源IP地址。
上行流源端口|该策略变量表示上行IP流的源端口。
上行流IPv4目的地址|该策略变量表示上行IP流类型为IPv4时的目的IP地址。
上行流IPv6目的地址|该策略变量表示上行IP流类型为IPv6时的目的IP地址。
上行流目的端口|该策略变量表示上行IP流的目的端口。
流的协议类型|该策略变量表示IP流的协议类型。
流请求的上行带宽|该策略变量表示IP流的最大上行请求带宽。
流请求的下行带宽|该策略变量表示IP流的最大下行请求带宽。
下行流IPv4源地址|该策略变量表示下行IP流类型为IPv4时的源IP地址。
下行流IPv6源地址|该策略变量表示下行IP流类型为IPv6时的源IP地址。
下行流源端口|该策略变量表示下行IP流的源端口。
下行流IPv4目的地址|该策略变量表示下行IP流类型为IPv4时的目的IP地址。
下行流IPv6目的地址|该策略变量表示下行IP流类型为IPv6时的目的IP地址。
下行流目的端口|该策略变量表示下行IP流的目的端口。
流方向|该策略变量表示IP流的方向。如果流描述只有一条，那么通过流描述中的in或out判断该IP流是上行流或下行流。如果流描述有两条，那么该IP流是双向流。
策略变量|说明
---|---
AF计费标识|该策略变量表示AF计费标识，策略变量值取自AF会话的AF-Charging-Identifier。
Service URN|该策略变量表示AF会话携带紧急业务，策略变量值取自AF会话的Service-URN。
用户资源预留优先级|该策略变量表示用户所有的AF会话是否包含指定的资源预留优先级。
用户多媒体优先级服务标识|该策略变量表示用户所有的AF会话是否包含指定的媒体优先级服务标识。
会话资源预留优先级|该策略变量表示AF会话的资源预留优先级，策略变量值取自AF会话的Reservation-Priority。
会话多媒体优先级服务标识|该策略变量表示AF会话的媒体优先级服务标识，策略变量值取自AF会话的MPS-Identifier。
紧急Service-URN指示|该策略变量表示AF会话是否为紧急呼叫，通过ADD EMERGSVCURN配置紧急呼叫的Service-URN。
媒体类型|该策略变量表示AF会话中媒体部件的媒体类型，策略变量值取自媒体部件的Media-Type。
媒体资源预留优先级|该策略变量表示AF会话中媒体部件的媒体资源预留优先级。RCP网元优先从媒体部件描述的Reservation-priority取值。如果没有携带，那么通过ADD AFAPP取用默认配置。
媒体上行最大带宽|该策略变量表示A会话中媒体部件的上行最大带宽。RCP网元优先从媒体部件描述的Max-Requested-Bandwidth-UL取值。如果没有携带，那么通过ADD AFAPP取用默认配置。
媒体下行最大带宽|该策略变量表示A会话中媒体部件的下行最大带宽。RCP网元优先从媒体部件描述的Max-Requested-Bandwidth-DL取值。如果没有携带，那么通过ADD AFAPP取用默认配置。
AF应用标识|该策略变量表示AF应用标识。策略变量按如下顺序取值：从媒体部件中携带的AF-Application-Identifier取值。如果AF会话的媒体部件中没有携带AF应用标识，那么RCP取用AF会话级的AF应用标识。如果AF会话级和媒体级AF应用标识都没有携带，那么RCP取用通过ADD DEFAFAPP配置的默认AF应用标识。
策略变量|说明
---|---
用户类型|该策略变量表示用户签约的用户类型。RCP从SPR发送的用户签约UDA或PNR消息的User-Type 中取值。如果从SPR发送的消息中未获取到用户类型，那么RCP从通过ADD DEFSPRINFO配置的默认签约信息中获取用户类型。
卡类型|该策略变量表示用户签约的卡类型。RCP从SPR发送的用户签约UDA或PNR消息的Card-Type中取值。
付费类型|该策略变量表示用户签约的付费类型。RCP从SPR发送的用户签约UDA或PNR消息的Charging-Type中取值。
用户套餐|该策略变量表示用户在当前IPCAN会话中使用的套餐。通过ADD PKGINFO的套餐属性进行配置。举例：用户签约套餐1,2,3，套餐优先级分别为8,9,10。用户会话上线，那么RCP取优先级最高的套餐3作为当前会话的用户套餐。
业务套餐|该策略变量表示用户当前使用的受控业务所归属的套餐。举例：用户签约套餐1,2,3，套餐优先级分别为8,9,10。套餐1、2签约业务1，套餐3签约业务3。用户会话上线，如果用户使用业务1，那么RCP取业务1所属套餐（套餐1和套餐2）中优先级高的套餐2作为业务1的业务套餐。如果用户使用业务3，由于只有套餐3签约业务3，因此RCP取套餐3作为业务3的业务套餐。
在线调查|该策略变量表示用户是否接受在线调查。如果用户接受在线调查，那么运营商可以制定重定向策略。
开卡标识|该策略变量表示用户是否需要开卡重定向。如果用户需要开卡重定向，那么运营商可以制定重定向策略。
开用户套餐标识|该策略变量表示对于正准备使用的用户套餐是否需要重定向。如果该套餐需要开套餐重定向后才能使用，那么运营商可以制定重定向策略。
开业务套餐标识|该策略变量表示对于正准备使用的业务套餐是否需要重定向。如果该套餐需要开套餐重定向后才能使用，那么运营商可以制定重定向策略。
用户状态|该策略变量表示用户的配额状态。RCP从SPR发送的用户签约UDA或PNR消息的UserStatus或UserStatus-Amend-Record中取值。如果用户签约的UDA或PNR消息中携带UserStatus-Amend-Record，并且RCP系统时间在子AVP Valid-Time指定的时间段内，则该策略变量值取自子AVP UserStatus-Amend-Value。如果用户签约的UDA或PNR消息中没有携带UserStatus-Amend-Record，或者RCP系统时间不在Valid-Time指定的时间段内，则该策略变量值取自UserStatus。
用户性别|该策略变量表示用户的性别。RCP从SPR发送的用户签约UDA或PNR消息的UserInfo中取值。当UserInfo的子AVP UserInfo-Type取值为3时表示用户性别，该策略变量值取自UserInfo-Value。
用户品牌|该策略变量表示用户的品牌信息。RCP从SPR发送的用户签约UDA或PNR消息的Brand中取值。
用户语言|该策略变量表示用户的语言。RCP从SPR发送的用户签约UDA或PNR消息的UserInfo中取值。当UserInfo的子AVP UserInfo-Type取值为4时表示用户语言，该策略变量值取自UserInfo-Value。
用户生日状态标识|该策略变量表示当前日期是否是用户的生日。RCP从SPR发送的用户签约UDA或PNR消息中的UserInfo中获取用户生日。当UserInfo的子AVP UserInfo-Type取值为5时，子AVP UserInfo-Value表示用户的生日。RCP判断当前日期是否为用户的生日。
用户级HomeZone状态标识|该策略变量表示用户的接入位置是否在用户级HomeZone区域内。RCP从SPR发送的用户签约UDA或PNR消息的HomeZone-Info中获取用户级HomeZone区域。
用户套餐级HomeZone状态标识|该策略变量表示用户的接入位置是否在当前IPCAN会话的用户套餐的HomeZone区域内。RCP从SPR发送的用户签约UDA或PNR消息的Package-Profile-Info中的HomeZone-Info中获取套餐级HomeZone区域。如果套餐的签约信息下没有携带，那么RCP从ADD PKGINFO配置中获取。
业务套餐级HomeZone状态标识|该策略变量表示用户的接入位置是否在用户使用的受控业务的业务套餐的HomeZone区域内。RCP从SPR发送的用户签约UDA或PNR消息的Package-Profile-Info中的HomeZone-Info中获取套餐级HomeZone区域。如果套餐的签约信息下没有携带，那么RCP从ADD PKGINFO配置中获取。
用户计费方式|该策略变量表示用户的计费方式。RCP从SPR发送的用户签约UDA或PNR消息的User-Billing-Type中取值。
用户套餐级计费方式|该策略变量表示当前IPCAN会话的用户套餐的计费方式。RCP从SPR发送的用户签约UDA或PNR消息的Package-Profile-Info中的Service-Billing-Type取值。
业务计费方式|该策略变量表示用户使用的受控业务所属的业务套餐的计费方式。RCP从SPR发送的用户签约UDA或PNR消息的Package-Profile-Info中的Service-Billing-Type取值。
用户漫入属性|该策略变量表示用户是否为漫入用户。通过拜访地接入的用户被称为漫入用户。
签约和用量接口交互模式|该策略变量表示用户上线时RCP与SPR的交互方式。仅有用量交互：表示用户在SPR中只有用量，没有签约数据。RCP与SPR只有Sp’接口消息交互。如果运营商需要对漫入用户进行基于用量的策略管理，那么可考虑采用这种交互模式。签约和用量都有交互：表示用户在SPR中有签约和用量数据。RCP与SPR在Sp\Sp’接口上均有消息交互。对本地用户使用这种交互模式。无交互：表示用户在SPR中无数据。RCP与SPR无消息交互。对非PCC用户可考虑采用这种方式。
用户可用套餐|该策略变量表示套餐在当前会话内是否可用。
签约ARP有效标识|该策略变量表示用户签约的ARP（Alternative Roaming Provider，漫游合作运营商）信息是否有效。
用户订购的套餐类别|该策略变量表示用户订购的套餐类别。RCP从SPR发送的UDA或PNR消息的Extended-Attribute中取值。当Extended-Attribute的子AVP Extended-Attribute-Name为SubscribePackageType时，该策略变量值取自Extended-Attribute-Value。
CPE首次上线标识|该策略变量表示用户是否开通了CPE功能并且用户是否为首次上线。如果用户签约了CPE套餐，则表示用户开通了CPE功能。通过ADD PKGINFO中的是否为CPE套餐字段配置套餐的CPE属性。
归属CPE区域状态标识|该策略变量表示用户的接入位置是否在CPE优惠区域内。
业务等级|该策略变量表示受控业务对应的签约业务对应的等级。数值越大表示等级越高。RCP从SPR发送的UDA或PNR消息的Service-Class中取值。如果消息中未携带，那么RCP从ADD PKGINFO中的套餐内的默认的业务等级取值。
签约业务标识|该策略变量表示受控业务对应的签约业务标识。通过ADD APPSUBS配置受控业务与签约业务标识的映射关系。
MSISDN|该策略变量表示用户的MSISDN。从用户签约UDA或PNR消息中的MSISDN获取。当CCR消息中的Subscription-Id-Type为2时，从Subscription-Id-Data获取。
用户设备信息类型|该策略变量表示用户设备信息的类型，策略变量值取自CCR消息中的User-Equipment-Info-Type 。
用户设备信息值|该策略变量表示用户设备信息的值，策略变量值取自CCR消息中的User-Equipment-Info-Value。
IMEISV|该策略变量表示用户的IMEISV，当CCR消息中的User-Equipment-Info-Type为0时，策略变量值取自User-Equipment-Info-Value。
IMSI|该策略变量表示用户的IMSI，当CCR消息中的Subscription-Id-Type为1时，策略变量值取自Subscription-Id-Data。
CUI|该策略变量表示用户的CUI，当CCR消息中的Subscription-Id-Type为4时，策略变量值取自Subscription-Id-Data。
用户终端IPv4地址|该策略变量表示用户终端IPv4地址，策略变量值取自CCR消息中的Framed-IP-Address。
用户终端IPv6地址|该策略变量表示用户终端IPv6地址，策略变量值取自CCR消息中的Framed-IPv6-Prefix。
用户所有策略计数器状态(Sy)|该策略变量表示PCS在当前Sy会话内是否存在。
用户接入网络类型|该策略变量表示用户的接入网络类型，用于区分用户是否为5G接入。
获取用量信息状态|该策略变量表示RCP获取用量信息状态是否超时。
业务套餐业务配额状态|该策略变量表示当前生效的业务套餐的业务配额状态。
套餐属性1|该策略变量表示套餐的一种分类属性。这种分类属性由运营者自定义，一般用在套餐预定义策略规则中。
套餐属性2|该策略变量表示套餐的一种分类属性。这种分类属性由运营者自定义，一般用在套餐预定义策略规则中。
套餐属性3|该策略变量表示套餐的一种分类属性。这种分类属性由运营者自定义，一般用在套餐预定义策略规则中。
套餐属性4|该策略变量表示套餐的一种分类属性。这种分类属性由运营者自定义，一般用在套餐预定义策略规则中。
套餐属性5|该策略变量表示套餐的一种分类属性。这种分类属性由运营者自定义，一般用在套餐预定义策略规则中。
最后一个套餐已超出控制百分比|该策略变量表示最后一个用户套餐是否已经超出控制百分比。当最后一个用户套餐用量大于或等于套餐基本配置表中的用量控制阈值时，该策略变量取值为是。
最后一个业务套餐已超出控制百分比|该策略变量表示最后一个业务套餐是否已经超出控制百分比。当最后一个业务套餐用量大于或等于套餐基本配置表中的用量控制阈值时，该策略变量取值为是。
策略变量|说明
---|---
用户组ID|该策略变量表示当前会话中生效的用户组的ID。如果当前会话生效的用户套餐（见“用户套餐”）为用户所属的某个群组的组套餐，则组套餐所在的组为当前生效的用户组。
用户组成员类型|该策略变量表示组成员在用户组中的角色（主用户和从用户）。
业务组成员类型|该策略变量表示组成员在业务组中的角色（主用户和从用户）。
业务组ID|该策略变量表示当前会话中生效的业务组的ID。如果当前生效的业务套餐（见“业务套餐”）为用户所属的某个群组的组套餐，则组套餐所在的组为当前生效的业务组。
用户组类型|该策略变量表示用户组的类型。
业务组类型|该策略变量表示业务组的类型。
归属用户组HomeZone状态标识|该策略变量表示是否在生效的用户组的HomeZone区域内。说明：组HomeZone来源：组签约的组用户层HomeZone（从SPR发给RCP的查询组签约SP-UDA响应或SP-PNR组签约推送消息的HomeZone-Info中获取）
归属业务组HomeZone状态标识|该策略变量表示是否在生效的业务组的HomeZone区域内。说明：组HomeZone来源：组签约的组用户层HomeZone（从SPR发给RCP的查询组签约SP-UDA响应或SP-PNR组签约推送消息的HomeZone-Info中获取）
策略变量|说明
---|---
SGSN IPv4地址|该策略变量表示接入用户所在SGSN的Ipv4地址。策略变量值取自CCR消息中的3GPP-SGSN-Address。
SGSN IPv6地址|该策略变量表示接入用户所在SGSN的Ipv6地址。策略变量值取自CCR消息中的3GPP-SGSN-IPv6-Address。
SGSN MCC|该策略变量表示接入用户所在SGSN的MCC。策略变量值取自CCR消息中3GPP-SGSN-MCC-MNC中的MCC。
SGSN MNC|该策略变量表示接入用户所在SGSN的MNC。策略变量值取自CCR消息中3GPP-SGSN-MCC-MNC中的MNC。
RAI MCC|该策略变量表示接入用户所在RAI的MCC。策略变量值取自CCR消息中RAI中的MCC。
RAI MNC|该策略变量表示接入用户所在RAI的MNC。策略变量值取自CCR消息RAI中的MNC。
RAI LAC|该策略变量表示接入用户所在RAI的LAC。策略变量值取自CCR消息RAI中的LAC。
RAI RAC|该策略变量表示接入用户所在RAI的RAC。策略变量值取自CCR消息RAI中的RAC。
ULI MCC|该策略变量表示接入用户所在位置的MCC。策略变量值取自CCR消息3GPP-User-Location-Info中的MCC。
ULI MNC|该策略变量表示接入用户所在位置的MNC。策略变量值取自CCR消息3GPP-User-Location-Info中的MNC。
ULI LAC|该策略变量表示接入用户所在位置的LAC。策略变量值取自CCR消息3GPP-User-Location-Info中的LAC。
ULI RAC|该策略变量表示接入用户所在位置的RAC。策略变量值取自CCR消息3GPP-User-Location-Info中GL-Type=2(RAI)时RAC的值。
ULI CI|该策略变量表示接入用户所在位置的CI。策略变量值取自CCR消息3GPP-User-Location-Info中GL-Type=0(CGI)时CI的值。
ULI SAC|该策略变量表示接入用户所在位置的SAC。策略变量值取自CCR消息3GPP-User-Location-Info中GL-Type=1(SAI)时SAC的值。
ULI TAC|该策略变量表示接入用户所在位置的TAC。策略变量值取自CCR消息3GPP-User-Location-Info中GL-Type=128(TAI)时TAC的值。
ULI ECI|该策略变量表示接入用户所在位置的ECI。策略变量值取自CCR消息3GPP-User-Location-Info中GL-Type=129(ECGI)时ECI的值。
漫游标识|该策略变量表示用户是否处于漫游状态。RCP网元配置漫游地的步骤如下：通过ADD BEARABILITY中的漫游判断条件指定漫游条件。通过ADD SGSNIPACC、ADD MCCMNCACC、ADD BSIDACC、ADD ULIACC或ADD UELOCIPACC，将用户位置按照不同接入类型划分为不同的区域，每个区域使用一个接入属性表示。通过ADD ACCMAP，将已经配置的接入属性指定为本地或漫游地。
无线接入技术|该策略变量表示接入用户的无线接入技术。策略变量值取自CCR消息中的RAT-Type。
3GPP无线接入技术|该策略变量表示接入用户的无线接入技术。策略变量值取自CCR消息中的3GPP-RAT-Type。
BSID|该策略变量表示接入用户的基站标识。策略变量值取自CCR消息中的3GPP2-BSID。
AN GW IPv4地址|该策略变量表示用户所在的接入网关的Ipv4地址。策略变量值取自CCR消息AN-GW-Address为IPv4地址类型时的值。
AN GW IPv6地址|该策略变量表示用户所在的接入网关的Ipv6地址。策略变量值取自CCR消息AN-GW-Address为IPv6地址类型时的值。
BSID 类型|该策略变量表示用户是否从校内基站接入。通过ADD INTRABSID配置校内基站。
IP CAN类型|该策略变量表示接入用户的IP CAN类型。策略变量值取自CCR消息中的IP-CAN-Type。
业务PCEF编号|该条件业务键已废弃。
业务PCEF邻接局组编号|该条件业务键已废弃。
承载PCEF编号|该条件业务键已废弃。
承载PCEF邻接局组编号|该条件业务键已废弃。
接入类型|该策略变量表示用户的接入类型。策略变量取自N7SmPolicyContextData消息中的accessType。
ULI NCI|该策略变量表示NR小区编号。策略变量取自SmPolicyContextData消息中的userLocationInfo\nrLocation\ncgi下的nrCellId。
切片类型|该策略变量表示用户接入的网络切片类型。策略变量取自SmPolicyContextData消息中的sliceInfo的sst。
切片编号|该策略变量表示S-NSSAI的编号。策略变量取自SmPolicyContextData消息中的sliceInfo的sd。
PDU会话类型|该策略变量表示PDU会话的类型。策略变量取自SmPolicyContextData消息中的pduSessionType。
计费特性|该策略变量表示PDU会话的计费特性。策略变量取自SmPolicyContextData消息中的chargingCharacteristics。
IP域|该策略变量表示IPv4域标识。策略变量取自SmPolicyContextData消息中的ipDomain
RFSP索引|该策略变量表示RFSP的索引。RFSP索引是由PCF确定的AMF接入移动策略的一部分。
SGSN MCC MNC|该策略变量表示接入用户所在SGSN的MCC和MNC。策略变量值取自CCR消息中3GPP-SGSN-MCC-MNC中的MCC和MNC。
请求ARP优先级|该策略变量表示N7会话请求中的ARP优先级。
决策对象|该策略变量表示当前决策的是Gx会话还是N7会话。
AMF邻接主机编号|该策略变量表示当前接入的AMF的邻接主机编号。
SMF邻接主机编号|该策略变量表示当前接入的SMF的邻接主机编号。
AMF邻接主机组编号|该策略变量表示当前接入的AMF的邻接主机组编号。
SMF邻接主机组编号|该策略变量表示当前接入的SMF的邻接主机组编号。
AMF实例编号|该策略变量表示当前接入的AMF的实例号。
SMF实例编号|该策略变量表示当前接入的SMF的实例号。
策略变量|说明
---|---
接入网计费IPv4地址|该策略变量表示IPCAN会话的IPv4类型的接入网计费地址，策略变量值取自CCR消息中Access-Network-Charging-Address为IPv4地址类型时的值。
接入网计费IPv6地址|该策略变量表示IPCAN会话的IPv6类型的接入网计费地址，策略变量值取自CCR消息中的Access-Network-Charging-Address为IPv6地址类型时的值。
NAI|该策略变量表示IPCAN会话的用户NAI。当CCR消息Subscription-Id中的Subscription-Id-Type为3时，策略变量值取Subscription-Id-Data的值。
在线调查标记|该策略变量表示对接受在线调查的用户，RCP网元是否已经下发过调查。取自业务控制策略的输出。
用户设备绑定标识|该策略变量表示用户接入设备标识IMEISV与用户签约设备标识IMEISV的匹配结果。
用户设备TAC绑定标识|该策略变量表示用户接入设备标识IMEISV-与用户签约设备标识IMEISV中TAC部分的匹配结果。
用户设备TAC & SNR绑定标识|该策略变量表示表示用户接入设备标识IMEISV与用户签约设备标识IMEISV中TAC和SNR部分的匹配结果。
子网类型|该策略变量表示用户接入的子网类型。策略变量值取自CCR消息中扩展的CT_Extension中的Subnet_Identifier。是私有接口的策略变量。通过ADD SUBNET配置子网类型。
网元类型|该策略变量表示与RCP网元建立IPCAN会话的对端网元类型。
接入网授信标识|该策略变量表示用户的接入网是否被授信，策略变量值取自CCR消息中的AN_Trusted。
Gx应用标识|该策略变量表示用户当前使用的应用标识。通过ADD APPSUBS配置。一般在业务控制策略规则中做条件。
应用授权标识|该策略变量表示用户使用的受控业务是否被授权。如果受控业务与用户的签约业务有映射关系，那么表示该受控业务已授权。
Monitoring Key|该策略变量表示业务级用量监控的标识，取自PCC规则参数集或ADC规则参数集。一般在业务级用量监控策略规则中做条件。
APN|该策略变量表示用户当前接入的APN，策略变量值取自CCR消息中的Called-Station-ID。
紧急APN指示|该策略变量表示用户当前接入的APN是否为紧急APN。RCP网元通过ADD EMERGAPN配置紧急APN。若CCR消息中的Called-Station-ID未被配置，则表示不是紧急APN。
会话Init-Time|该策略变量表示当前IPCAN会话建立的时间，策略变量值为公元2000年到当前IPCAN会话建立时的秒数。
CCR类型|该策略变量表示当前IPCAN会话的类型，策略变量值取自CCR消息中的CCR_TYPE。
签约ARP状态变更事件|该策略变量表示用户签约的ARP有效状态是否发生变更。只有当用户的签约ARP-ID从未生效切换到生效状态时，才表示此事件发生。如果用户已签约ARP-ID、ARP-ID-Begin-Time。RCP网元通过比较ARP-ID-Begin-Time和RCP系统时间判断ARP-ID的有效性。如果ARP-ID-Begin-Time晚于当前时间则ARP-ID未生效，否则生效。如果用户只签约ARP-ID，未签约ARP-ID-Begin-Time，则RCP网元根据编号为1068的全局开关判断有效性。当开关打开时，表示ARP-ID生效，否则为未生效。
无线共享状态|该策略变量表示用户开启或停止无线共享上网。通过SET DEFPCEFEVENT或者ADD PCEFEVENT将无线共享启动和无线共享停止配置为上报，RCP网元可以向PCEF/SMF订阅该事件。PCEF/SMF检测到对应事件发生时，会主动通知RCP。当PCEF/SMF上报TETHERING_START（6001）事件时，表示用户开启无线共享；当PCEF/SMF上报TETHERING_STOP（6002）事件时，表示用户停止无线共享。
用户共享下挂数量|该策略变量表示用户开启了多少个设备共享无线上网，策略变量值取自CCR消息中的Tethering_Count。通过SET DEFPCEFEVENT或者ADD PCEFEVENT将用户共享下挂数量变更配置为上报，RCP网元可以向PCEF/SMF订阅该事件。当PCEF/SMF检测到对应事件发生时，会主动通知RCP。当PCEF/SMF上报TETHERING_COUNT_CHANGE（6003）事件时，同时上报Tethering_Count。
事件上报|该策略变量表示RCP网元的对端网元上报的所有事件，策略变量值取自CCR消息中的Event-Trigger。
用户上下线周期事件|该策略变量表示用户上下线周期事件。根据用户当前上下线时间与上一次上线时间比较判断。通常在通知策略规则中使用。
反射Qos指示|该策略变量表示用户的反射QoS状态。策略变量值取自SmPolicyContextData消息中的refQosIndication。
3GPP PS数据关闭状态|该策略变量表示用户的3GPP PS的数据是否处于关闭状态。策略变量值取自SmPolicyContextData消息中的3gppPsDataOffStatus。
PS数据黑白名单指示|该策略变量表示用户的3GPP PS是黑名单还是白名单。
重定向确认状态|该策略变量表示用户是否对重定向信息进行确认。
机卡分离标识|该策略变量表示用户是否机卡分离。
用户业务签约位置状态标识|该策略变量表示用户业务签约位置变化状态。
热点共享状态|该策略变量表示用户热点共享开启或停止。
APN汇聚最大上行带宽|该策略变量表示PCEF/SMF网元请求当前IPCAN会话的APN汇聚最大上行带宽。
APN汇聚最大下行带宽|该策略变量表示PCEF/SMF网元请求当前IPCAN会话的APN汇聚最大下行带宽。
策略变量|说明
---|---
承载标识|该策略变量表示IPCAN承载的标识，策略变量值取自CCR消息中的Bearer_Identifier。
承载用途|该策略变量表示IPCAN承载的用途，策略变量值取自CCR消息中的Bearer-Usage。
承载QCI|该策略变量表示IPCAN承载级QCI。
承载类型|该策略变量表示IPCAN承载的类型。
承载下应用标识|该策略变量表示当前IPCAN承载上关联的所有受控业务的应用标识。
业务属性最小值|该策略变量表示当前IPCAN承载上所有受控业务的最小属性值，每个受控业务的属性值由业务策略决策输出。
业务属性最大值|该策略变量表示当前IPCAN承载上所有受控业务的最大属性值，每个受控业务的属性值由业务策略决策输出。
策略变量|说明
---|---
SGSN_IPV4地址映射标识|该策略变量表示当前IPCAN会话的3GPP-SGSN-Address地址是否在映射标识所表示的地址段内。通过ADD IPABS进行配置，其中地址类型选择SGSN_IPV4。
SGSN_IPV6地址映射标识|该策略变量表示当前IPCAN会话的3GPP-SGSN-IPv6–Address地址是否在映射标识所表示的地址段内。通过ADD IPABS进行配置，其中地址类型选择SGSN_IPV6
SGSN MCC映射标识|该策略变量表示当前IPCAN会话的3GPP-SGSN-MCC–MNC中的MCC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择SGSN_MCC。
SGSN MNC映射标识|该策略变量表示当前IPCAN会话的3GPP-SGSN-MCC–MNC中的MNC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择SGSN_MNC。
RAI MCC映射标识|该策略变量表示当前IPCAN会话的RAI中的MCC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择RAI_MCC。
RAI MNC映射标识|该策略变量表示当前IPCAN会话的RAI中的MNC是否在映射标识所表示的号码段内。通过通过ADD NUMABS进行配置，其中号码类型选择RAI_MNC。
RAI LAC 映射标识|该策略变量表示当前IPCAN会话的RAI中的LAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择RAI_LAC。
RAI RAC 映射标识|该策略变量表示当前IPCAN会话的RAI中的RAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择RAI_RAC。
ULI MCC映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的MCC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_MCC。
ULI MNC映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的MNC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_MNC。
ULI LAC 映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的LAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_LAC。
ULI RAC 映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的RAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_RAC。
ULI CI 映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的CI是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_CI。
ULI SAC 映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的SAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_SAC。
ULI TAC映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的TAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_TAC。
ULI ECI映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的ECI是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_ECI。
BSID映射标识|该策略变量表示当前IPCAN会话的3GPP2-BSID是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择BSID。
MSISDN映射标识|该策略变量表示用户的MSISDN号码是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择MSISDN。
CUI映射标识|该策略变量表示用户的CUI号码是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择CUI。
IMEISV映射标识|该策略变量表示用户的IMEISV号码是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择IMEISV。
IMEISV TAC映射标识|该策略变量表示用户IMEISV号码中的TAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择IMEISV_TAC。
IMEISV SNR映射标识|该策略变量表示用户IMEISV号码中的SNR是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择IMEISV_SNR。
IMEISV TAC&SNR映射标识|该策略变量表示用户IMEISV号码中的TAC和SNR是否在映射标识所表示的号码段内。通过ADDNUMABS进行配置，其中号码类型选择IMEISV_TAC_SNR。
IMSI 映射标识|该策略变量表示用户的IMSI号码是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择IMSI。
ULI LAC CI映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的LAC和CI是否在映射标识所表示的号码段内。通过ADDNUMABS进行配置，其中号码类型选择ULI_LAC_CI。
ULI LAC SAC映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的LAC和SAC是否在映射标识所表示的号码段内。通过ADDNUMABS进行配置，其中号码类型选择ULI_LAC_SAC。
ULI LAC RAC映射标识|该策略变量表示当前IPCAN会话的3GPP-User-Location-Info中的LAC和RAC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_LAC_RAC。
ULI NCI映射标识|该策略变量表示当前N7会话的3GPP-User-Location-Info中的NCI是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择ULI_NCI。
AMF MCC映射标识|该策略变量表示当前N7会话的servNfId中plmn中的MCC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择AMF_MCC。
AMF MNC映射标识|该策略变量表示当前N7会话的servNfId中plmn中的MNC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择AMF_MNC。
AMF REGION映射标识|该策略变量表示当前N7会话的servNfId中amfId中的REGION是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择AMF_REGIONID。
AMF SETID映射标识|该策略变量表示当前N7会话的servNfId中amfId中的SETID是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择AMF_SETID。
AMF POINTER映射标识|该策略变量表示当前N7会话的servNfId中amfId中的POINTER是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择AMF_POINTER。
SGSN MCC MNC映射标识|该策略变量表示当前IPCAN会话的3GPP-SGSN-MCC-MNC中的MCC和MNC是否在映射标识所表示的号码段内。通过ADD NUMABS进行配置，其中号码类型选择SGSN_MCC_MNC。
配置完毕，单击按钮。
配置举例 :配置条件1：基本用量1总用量百分比 > 80% 
配置完成如[图4]所示。
图4  条件1配置举例

注意 :在执行操作步骤3之前和操作步骤4之后，必须刷新界面，用以保证界面显示为最新记录。 
条件保存后，条件内容中的业务键不能被修改。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
[规则]
##### 动作参数 
概述 :动作是指ZXUN RCP网元在满足一组条件后，所进行的操作。动作参数是ZXUN RCP网元在进行参数填充动作时需要提供给RCP或外部网元使用的具体参数。为外部网元提供的参数会通过网元间消息进行传递。
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击动作参数，弹出动作参数页面，如[图2]所示。
图2  动作参数页面

单击按钮，弹出基本属性页面，如[图3]所示。
图3  基本属性页面

动作参数说明参见[表1]。
参数名称|参数说明
---|---
动作参数名称|动作参数配置的名称，全局唯一。
参数类型|与策略类型对应，表明该动作参数可以被应用在哪种策略中。不可修改。套餐动态属性参数集：应用在套餐动态优先级策略中。此类参数可以对套餐指定优先级或将套餐置为无效，在RCP网元内部为用户进行套餐选择时使用。具体参数说明参见表2。预下发业务参数集：应用在业务预下发控制策略中。RCP网元要先获得受控业务列表，才能对列表中的受控业务进行策略决策。此类参数就是为RCP网元提供受控业务列表使用的。最多指定140个，也可以根据用户的签约下发列表。具体参数说明参见表3。承载参数集：应用在承载控制策略中。此类参数用于为承载指定QoS参数信息。具体参数说明参见表4。会话参数集：应用在会话控制策略中。此类参数用于为用户的当前会话指定QoS参数信息或计费参数信息。具体参数说明参见表5。通知参数集：应用在通知策略中。此类参数用于指定通知发送的参数信息。一个通知参数集只能应用在一个通知策略规则中。具体参数说明参见表6。PCC规则参数集：应用在业务控制策略中。此类参数用于通过Gx接口向PCEF/SMF网元为受控业务下发指定的QoS参数信息、重定向参数信息、计费信息、用量监控开关等。关联此类参数集的策略规则的条件表达式中需要包含指定受控业务的应用标识。具体参数说明参见表7。ADC规则参数集：应用在业务控制策略中。此类参数用于通过Sd接口向TDF网元为受控业务下发指定的QoS参数信息、重定向参数信息、计费信息、用量监控开关等。具体参数说明参见表8。外置业务PCC规则参数集：应用在业务控制策略中。此类参数用于通过Gx接口向S-PCEF网元为受控业务下发指定的QoS参数信息、重定向参数信息、计费信息等。此类参数使用很少。具体参数说明参见表9。PCC预定义规则组参数集：此类参数用于通过Gx接口向PCEF/SMF网元为受控业务下发指定的预定义规则组名称。ADC预定义规则组参数集：此类参数用于通过Sd接口向TDF网元为受控业务下发指定的预定义规则组名称。外置业务PCC预定义规则组参数集：此类参数用于通过Gx接口向S-PCEF网元为受控业务下发指定的预定义规则组名称。此类参数使用很少。以上四类中的参数完全相同，具体参数说明参见表10。业务用量监控参数集：应用在业务级用量监控策略中。此类参数用于为受控业务下发一组用量监控参数。当RCP网元需要根据用量消耗情况进行业务策略控制时，需要同时配置此类参数，使PCEF/SMF网元能够及时上报业务层用量给RCP网元进行用量统计。具体参数说明参见表11。会话用量监控参数集：应用在会话级用量监控策略中。此类参数用于为当前会话下发一组用量监控参数。当RCP网元需要根据用量消耗情况进行会话策略控制时，需要同时配置此类参数，使PCEF/SMF网元能够及时上报会话层用量给RCP网元进行用量统计。具体参数说明参见表12。黑白名单参数集：是私有接口参数集。应用在黑白名单策略中。在PCEF/SMF上预先配置一些策略集合，每个集合使用一个ID表示。此类参数仅通过Gx接口的扩展AVP给PCEF/SMF下发一个ID，PCEF/SMF网元根据ID执行对应集合中的预置策略。此类参数使用很少。具体参数说明参见表13。套餐预定义规则参数集：应用在套餐预定义策略中。此类参数可以对指定套餐直接下发规则，一般应用在物联网中。具体参数说明参见表14。接入移动策略参数集：应用在AMF接入移动策略中。此类参数仅用于N15流程中，指定RFSP索引及允许和限制区域。具体参数说明参见表15。N15限制服务区域参数集：该参数集ID可以被"接入移动策略参数集"中的"限制服务区域操作集ID"参数引用。此类参数用于指定限制服务区域参数。具体参数说明参见表16。UE路由选择策略参数集：应用在UE路由选择策略中。此类参数用于为N15会话下发一组UE路由选择参数。具体参数说明参见表17。URSP规则参数集：该参数集ID可以被"UE路由选择策略参数集"中的"URSP规则参数集ID"参数引用。此类参数用于下发URSP参数。具体参数说明参见表18。UE业务流描述参数集：该参数集ID可以被"URSP规则参数集"中的"业务流描述参数集ID"参数引用。此类参数用于下发业务流描述参数。具体参数说明参见表19。UE路由选择描述参数集：该参数集ID可以被"URSP规则参数集"中的"路由选择描述参数集ID"参数引用。此类参数用于下发UE路由选择参数。具体参数说明参见表20。N7会话参数集：应用在N7会话决策中。此类参数用于为用户的当前会话指定5QI参数信息或计费参数信息。具体参数说明参见表21。5QI参数集：如果该参数集中的"5QI"参数值与"Qos参数集"中的"5QI"参数值相等，表示"Qos参数集"引用该5QI参数集。如果该参数集中的"5QI"参数值与"N7会话参数集"中的"5QI"参数值相等，表示"N7会话参数集"引用该5QI参数集。具体参数说明参见表22。N7 PCC规则参数集：应用在N7业务决策中。此类参数用于通过N7接口向SMF网元为受控业务下发指定的QoS参数信息、重定向参数信息、计费信息、用量监控开关等。关联此类参数集的策略规则的条件表达式中需要包含指定受控业务的应用标识。具体参数说明参见表23。QoS参数集：该参数集ID可以被"N7业务参数集"中的"QoS控制策略ID"参数引用。此类参数用于为业务指定的QoS参数信息。具体参数说明参见表24。Charging参数集：该参数集ID可以被"N7业务参数集"中的"计费控制策略ID"参数引用。此类参数用于为业务指定的计费参数信息。具体参数说明参见表25。TC参数集：该参数集ID可以被"N7业务参数集"中的"流量控制策略ID"参数引用。此类参数用于为业务指定的重定向参数信息。具体参数说明参见表26。路由目的地参数集：该参数集ID可以被"TC参数集"中的"路由目的地"参数引用。此类参数用于为业务指定的路由参数信息。具体参数说明参见表27。
动作参数集|不同的参数类型下，可配置的参数也不相同。参数集中至少包含一个参数。根据动作参数的作用，有QoS参数、计费参数、重定向参数、用量监控参数、通知发送参数、内部参数等。
动作参数|参数说明
---|---
套餐动态优先级|当用户签约中没有携带套餐优先级时，RCP网元以该参数作为当前套餐的优先级。套餐优先级的取值顺序为：SPR携带的用户签约的套餐个性化优先级，从UDA或PNR消息的Package_Profile_Info的Priority获取。若a.没有获取到，那么RCP使用此参数指定的动态优先级。若a.和b.都没有获取到，那么RCP使用SHOW PKGINFO中配置的全局优先级。
套餐有效标识|该参数用于向RCP网元指示套餐是否无效。
动作参数|参数说明
---|---
根据签约来决策预下发业务|该参数用于指示RCP网元需要根据用户的签约业务下发受控业务列表。
应用标识|该参数用于指定需要RCP网元进行业务决策的受控业务，最多140个。
动作参数|参数说明
---|---
最大请求上行带宽（kbps）|该参数用于向PCEF/SMF网元指定承载的最大请求上行带宽。
最大请求下行带宽（kbps）|该参数用于向PCEF/SMF网元指定承载的最大请求下行带宽。
保障上行带宽（kbps）|该参数用于向PCEF/SMF网元指定承载的保障上行带宽。
保障下行带宽（kbps）|该参数用于向PCEF/SMF网元指定承载的保障下行带宽。
带宽决策方式|该参数用于向RCP网元指定承载带宽的决策方式，由RCP经过计算后下发给PCEF/SMF：业务带宽之和：表示RCP网元需要下发承载上关联的所有受控业务的带宽之和。业务带宽最小值：表示RCP网元需要下发承载上关联的所有受控业务的带宽最小值。业务带宽最大值：表示RCP网元需要下发承载上关联的所有受控业务的带宽最大值。CCR请求中的承载带宽：表示RCP网元需要下发CCR消息的Qos Information或Default_EPS_Bearer_QoS中的Max-Requested-Bandwidth-UL和Max-Requested-Bandwidth-DL。签约承载带宽：表示RCP网元需要下发通过SET DEFBEARQOS或ADD BEARQOS配置的承载带宽。所有带宽最小值：表示RCP网元需要从承载上关联的所有受控业务的带宽最小值、签约承载带宽、CCR请求中的承载带宽、本动作集中配置的带宽中选择最小值下发。所有带宽最大值：表示RCP网元需要从承载上关联的所有受控业务的带宽最大值、签约承载带宽、CCR请求中的承载带宽、本动作集中配置的带宽中选择最大值下发。如果该参数和本动作集中配置的带宽同时配置，那么RCP网元优先按照该参数指定的方式进行计算并下发。
QCI|该参数用于向PCEF/SMF网元指定承载的QCI。
QCI决策方式|该参数用于向RCP网元指定承载QCI的决策方式，由RCP经过计算后下发给PCEF/SMF：业务QCI最小值：表示RCP网元需要下发承载上关联的所有受控业务的QCI的最小值。业务QCI最大值：表示RCP网元需要下发承载上关联的所有受控业务的QCI的最大值。CCR请求中的QCI：表示RCP网元需要下发CCR消息中Qos Information或Default_EPS_Bearer_QoS中的QoS-Class-Identifier。签约承载QCI：表示RCP网元需要下发通过SET DEFBEARQOS或ADD BEARQOS配置的承载QCI。所有QCI最小值：表示RCP网元需要从承载上关联的所有受控业务的QCI最小值、签约承载QCI、CCR请求中的承载QCI、本动作集中配置的QCI中选择最小值下发。所有QCI最大值：表示RCP网元需要从承载上关联的所有受控业务的QCI最小值、签约承载QCI、CCR请求中的承载QCI、本动作集中配置的QCI中选择最大值下发。如果该参数和本动作集中配置的QCI同时配置，那么RCP网元优先按照该参数指定的方式进行计算并下发。
ARP优先级|该参数用于向PCEF/SMF网元指定承载的ARP优先级。
ARP优先级决策方式|该参数用于向RCP网元指定承载ARP优先级的决策方式，由RCP经过计算后下发给PCEF/SMF：CCR请求中的值：表示RCP网元需要下发CCR消息中Qos Information或Default_EPS_Bearer_QoS中的Allocation_Retention_Priority。所有最小值：表示RCP网元需要从CCR请求中的承载ARP优先级和本动作集中配置的ARP优先级中选择最小值下发。所有最大值：表示RCP网元需要从CCR请求中的承载ARP优先级和本动作集中配置的ARP优先级中选择最大值下发。如果该参数和本动作集中配置的ARP优先级同时配置，那么RCP网元优先按照该参数指定的方式进行计算并下发。
ARP抢占能力|该参数用于向PCEF/SMF网元指定承载是否开启ARP抢占能力。若选择开启，则表示在服务质量受限情况下，该承载具有抢占其他承载服务质量的能力。
ARP被抢占能力|该参数用于向PCEF/SMF网元指定承载是否开启ARP被抢占能力。若选择开启，则表示在服务质量受限情况下，该承载具有被其他承载抢占服务质量的能力。
动作参数|参数说明
---|---
APN汇聚最大上行带宽（kbps）|该参数向PCEF/SMF网元指定当前IPCAN会话的APN汇聚最大上行带宽。
APN汇聚最大下行带宽（kbps）|该参数向PCEF/SMF网元指定当前IPCAN会话的APN汇聚最大下行带宽。
APN汇聚带宽决策方式|该参数用于向RCP网元指定APN汇聚带宽的决策方式：业务MBR之和：表示RCP网元需要下发IPCAN会话上所有业务的MBR带宽之和；CCR请求中的APN带宽：表示RCP网元需要下发CCR消息中QoS-Information中的APN-Aggregate-Max-Bitrate-UL和APN-Aggregate-Max-Bitrate-DL；签约的APN带宽：表示RCP网元需要下发通过ADD DEFBW配置的默认签约APN带宽；最小APN带宽：表示RCP网元需要从CCR请求中的APN带宽、签约的APN带宽、本动作集中配置的APN带宽中选择最小值下发。如果该参数和本动作集中配置的APN带宽同时配置，那么RCP网元优先按照该参数指定的方式进行计算并下发。
计费方法决策方式|该参数用于向RCP网元指定计费方法的决策方式：CCR请求中的值：表示RCP网元需要下发CCR消息中Offline、Online。如果该参数和本动作集中配置的在线计费、离线计费同时配置，那么RCP网元优先按照该参数指定的方式进行下发。
在线计费|该参数用于指示PCEF/SMF是否开启会话级在线计费功能。
离线计费|该参数用于指示PCEF/SMF是否开启会话级离线计费功能。
在线计费地址决策方式|该参数用于向RCP网元指定在线计费地址的决策方式：签约PCF/SCF本地计费地址优先：若SPR通过Sp接口返回签约PCF-ID或SCF-ID，则根据PCF-ID（作为ARP-ID）或SCF-ID（作为ARP-ID）查找“计费中心配置”（命令SHOW CCCFG查看），PCF-ID查询到的“计费中URI地址”参数就作为首选在线计费地址，SCF-ID查询到的“计费中URI地址”参数就作为备选在线计费地址.签约ARP漫游计费地址优先：若SPR通过Sp接口返回用户签约ARP-ID，且ARP-ID已生效，则根据ARP-ID查找“计费中心配置”（命令SHOW CCCFG查看），“计费中心URI地址”参数就作为首选在线计费地址，备选无。若没有查询到，SPR还返回了PCF-ID或SCF-ID，则按照“签约PCF/SCF本地计费地址优先”决策方式，查找首选和备选在计费地址。
首选在线计费地址|该参数向PCEF/SMF网元指定当前IPCAN会话的首选在线计费地址。
备选在线计费地址|该参数向PCEF/SMF网元指定当前IPCAN会话的备选在线计费地址。
首选离线计费地址|该参数向PCEF/SMF网元指定当前IPCAN会话的首选离线计费地址。
备选离线计费地址|该参数向PCEF/SMF网元指定当前IPCAN会话的备选离线计费地址。
授权时长（秒）|该参数用于向PCEF/SMF网元指示IPCAN会话的授权时长。IPCAN会话授权时长取值为会话、承载、业务、业务用量监控四个层次的授权时长的最小值。
承载控制模式|该参数用于向PCEF/SMF网元指示承载是由UE侧建立还是由网络侧建立：UE-ONLY：表示承载由UE侧发起建立；UE-NW：表示承载由UE侧或网络侧发起建立。
动作参数|参数说明
---|---
全局通知编号|当一个通知规则被匹配且对应的通知内容已经发送过时，RCP不能再重复发送通知内容。RCP需要向SPR保存一个能够唯一标识这个通知规则的编号，来记录通知发送的条件。该编号在工程内必须保证唯一。
通知类型|该参数表示通知最终发送的具体方式。SMS/EMAIL：发送短信和邮件通知。由用户个性化签约决定。SOAP：当通知规则的发送条件中存在用量阀值穿越时，RCP可以发送SOAP通知给运营商的IT系统。使用这种方式发送通知时，可以不关联通知内容模板。SMS/EMAIL/SOAP：三种通知方式都发送。
发送标识|该参数表示对应的通知是否需要被发送。
私人短信通知内容|该参数表示发送给用户的短信内容。关联基本数据配置中的通知。
私人邮件通知内容|该参数表示发送给用户的邮件内容。关联基本数据配置中的通知。
公共短信通知内容|该参数表示发送给第三方或运维组的短信内容。关联基本数据配置中的通知。
公共邮件通知内容|该参数表示发送给第三方或运维组的邮件内容。关联基本数据配置中的通知。
通知重发时间间隔单位|时间单位。小时天月周一次会话
通知重发时间间隔值|与通知重发时间间隔单位共同描述一个时间段。表示在这个时间段内通知不能重发。即，通知需要被发送多次时，该时间段控制每次发送的时间间隔。
通知发送周期单位|日期单位。天月周
通知发送周期值|与通知发送周期单位共同描述一个时间段。该时间段与周期内通知最大发送次数参数共同实现周期内通知次数控制功能。
周期内通知最大发送次数|与通知发送周期单位、通知发送周期值共同实现周期内通知次数控制功能。即RCP可以控制在一个时间段内通知被发送的最大次数。
发送的短信中心类型|该参数与私人短信通知内容/公共短信通知内容配置项联合使用，表示私人短信通知内容/公共短信通知内容需要向哪种类型的短信中心发送，取值如下：0-短信网关1-POP-D平台2-短信网关&POP-D平台当未配置该配置项时，取值默认为0-短信网关。
动作参数|参数说明
---|---
业务规则类型|该参数取值为动态规则或预定义规则，是必选参数：动态规则：在RCP上定义规则名称和具体的规则内容。激活规则时，RCP下发规则名称和具体的规则内容给PCEF/SMF执行策略。预定义规则：在PCEF/SMF上定义规则名称和具体规则内容，在RCP上定义与PCEF/SMF上一致的规则名称。激活规则时，RCP只下发规则名称，PCEF/SMF根据规则名称匹配具体的规则内容并执行策略。说明：以下动作参数在动态规则中都支持配置输出；只在预定义规则中支持输出的参数会特别标明。
规则名前缀|该参数指RCP下发给PCEF/SMF执行的PCC规则名称的前缀。预定义规则类型时该参数为可选配置。
规则名|该参数指RCP下发给PCEF/SMF执行的PCC规则的名称，是必选参数。预定义规则类型时该参数需要配置。
规则名后缀|该参数指RCP下发给PCEF/SMF执行的PCC规则名称的后缀。预定义规则类型时该参数为可选配置。
应用标识|该参数指与签约业务有映射关系的受控业务的应用标识，是必选参数。通过ADD APPSUBS配置签约业务和受控业务的映射关系。预定义规则类型时该参数需要配置。
Monitoring Key|该参数是业务用量监控的关键字，通过该关键字关联相应业务的用量配额和用量消费额。预定义规则类型时，若RCP需要使用用量监控功能，那么需要配置该参数。
QoS等级标识|该参数表示业务级的授权QCI。
请求的上行流带宽(kbps)|该参数表示上行流允许的最大请求带宽。
请求的下行流带宽(kbps)|该参数表示下行流允许的最大请求带宽。
容忍的上行流带宽(kbps)|该参数表示上行流的最小保障带宽。
容忍的下行流带宽(kbps)|该参数表示下行流的最小保障带宽。
ARP优先级决策方式|该参数用于向RCP指示ARP优先级的决策方式。当选择“CCR请求中的值”时，RCP下发CCR请求中的ARP优先级。不选择该参数时，RCP按照本参数集中配置的ARP优先级下发。
ARP优先级|表示该业务标识的业务流服务质量保证的分配保持优先级（ARP）。
ARP抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP抢占能力。在服务质量受限情况下，本业务抢占其他业务服务质量的能力。
ARP被抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP被抢占能力。在服务质量受限情况下，被其他业务抢占本业务服务质量的能力。
优先级|该参数由运营商规划。当多个业务规则被下发到PCEF/SMF的同一承载上时，优先级高的业务规则优先匹配执行。
流状态|该参数表示允许业务流通行的状态：上行：PCEF/SMF只保障上行业务流的服务质量，拒绝下行业务流。下行：PCEF/SMF只保障下行业务流的服务质量，拒绝上行业务流。双向：PCEF/SMF需要保障上、下行业务流的服务质量。关闭：PCEF/SMF拒绝上、下行业务流。
业务标识|该参数是与PCEF/SMF约定好的受控业务标识。
重定向能力|该参数表示PCEF/SMF是否需要对业务流进行重定向。打开重定向：PCEF/SMF需要对业务流进行重定向，同时RCP向PCEF/SMF下发重定向地址类型和重定向地址。关闭重定向：PCEF/SMF不对业务流进行重定向，RCP不向PCEF/SMF下发重定向地址。当ADD BEARABILITY中的支持私有重定向字段选择标准接口时需要配置该参数、重定向地址类型和重定向地址。
重定向地址类型|该参数表示业务流重定向地址的类型，需要与重定向地址同时配置。
重定向地址|该参数表示业务流的重定向地址，需要与重定向地址类型同时配置。
重定向类型|该参数为私有接口参数，RCP只与ZTE PCEF/SMF对接时使用。当ADD BEARABILITY中的支持私有重定向字段选择私有接口时需要配置该参数、重定向地址类型和重定向地址。
重定向业务TDF应用标识|该参数表示重定向确认业务的标识。RCP向PCEF/SMF下发该标识，如果PCEF/SMF检测到重定向确认业务已发生，那么PCEF/SMF向RCP上报该业务发生事件。RCP获取到该事件后，不再向PCEF/SMF下发重定向地址。预定义规则类型时，若RCP需要监控重定向确认业务是否发生，那么需要配置该参数。
费率组|该参数表示业务归属的费率组，该参数和报告等级一起使用。若运营商设定在用户的费率发生切换时需要踢用户下线，并且设定RCP下发预定义规则时，那么需要配置该参数。
报告等级|该参数用来指示PCEF/SMF向计费系统上报的等级：业务标识等级：表示基于费率组和业务标识组合的等级。费率组等级：表示基于费率组的等级。赞助支付等级：表示基于费率组和赞助商标识、应用服务提供商标识组合的等级。
在线计费|该参数用于指示PCEF/SMF是否对业务开启在线计费功能。
离线计费|该参数用于指示PCEF/SMF是否对业务开启离线计费功能。
计费度量方式|该参数用于指示PCEF/SMF对业务计费的度量方法。
业务属性|该参数表示业务优先级。当一个承载关联多个业务时，承载优先级可取该承载所关联的所有业务的业务优先级的最大值或最小值。
AF计费标识|该参数表示AF计费标识。一般由RCP将AF会话中携带的ICID透传给PCEF/SMF，很少通过此参数配置.
带宽决策方式|该参数用于向RCP指示业务带宽的决策方式。不选择该参数时，RCP按照本参数集中配置的带宽下发。选择该参数时，RCP按照选择方式计算并下发：UBAS推荐带宽优先：在闭环控制功能中，RCP优先使用UBAS推荐的业务带宽下发。CCR请求中的值：RCP取CCR请求中的业务带宽下发。所有带宽最大值：RCP从UBAS推荐带宽、CCR请求中的业务带宽、本参数集中配置的带宽中取最大值下发。所有带宽最小值：RCP从UBAS推荐带宽、CCR请求中的业务带宽、本参数集中配置的带宽中取最小值下发。
在线调查标记|该参数为私有接口参数。
计费关联指示|该参数用于指示PCEF/SMF是否上报业务对应的GCID。
资源分配通知|该参数表示本业务规则所需的资源分配完成后，PCEF/SMF是否需要通知RCP网元。若RCP需要在预定义规则所需的资源分配完成后由PCEF/SMF通知RCP，那么需要配置该参数。
包过滤器用途|该参数用于表示RCP下发业务规则时，是否需要PCEF/SMF通知UE侧预留相关资源。
TDF应用标识输出|该参数填写为“输出”时，RCP网元会下发该业务关联的TDF应用标识给PCEF/SMF。预定义规则类型时，若RCP网元需要监控该TDF业务的发生、停止状态，那么需要配置该参数。
静默通知|该参数是指TDF应用标识输出对应的TDF业务发生或停止时，PCEF/SMF是否需要通知RCP网元。
PS切换CS会话保持|该参数设置为"VIDEO_PS2CS_CONT_CANDIDATE"时，表示当用户所在网络由4G向2/3G切换时，可以保持视频呼叫连续。
上行业务链策略标识|该参数用于表示对业务分流指定路径。PCEF网元对上行业务流进行分流时使用该参数。
下行业务链策略标识|该参数用于表示对业务分流指定路径。PCEF网元对下行业务流进行分流时使用该参数。
动作参数|参数说明
---|---
业务规则类型|该参数取值为动态规则或预定义规则，是必选参数：动态规则：在RCP上定义规则名称和具体的规则内容。激活规则时，RCP下发规则名称和具体的规则内容给TDF执行策略。预定义规则：在TDF上定义规则名称和具体规则内容，在RCP上定义与TDF上一致的规则名称。激活规则时，RCP只下发规则名称，TDF根据规则名称匹配具体的规则内容并执行策略。说明：以下动作参数在动态规则中都支持配置输出；只在预定义规则中支持输出的参数会特别标明。
规则名前缀|该参数指RCP下发给PCEF/SMF执行的PCC规则名称的前缀。预定义规则类型时该参数为可选配置。
规则名|该参数指RCP下发给TDF执行的ADC规则的名称，是必选参数。预定义规则类型时该参数需要配置。
规则名后缀|该参数指RCP下发给PCEF/SMF执行的PCC规则名称的后缀。预定义规则类型时该参数为可选配置。
应用标识|该参数指与签约业务有映射关系的受控业务的应用标识，是必选参数。通过ADD APPSUBS配置签约业务和受控业务的映射关系。预定义规则类型时该参数需要配置。
Monitoring Key|该参数是业务用量监控的关键字，通过该关键字关联相应业务的用量配额和用量消费额。预定义规则类型时，若RCP需要使用用量监控功能，那么需要配置该参数。
QoS等级标识|该参数表示业务级的授权QCI。
请求的上行流带宽(kbps)|该参数表示上行流允许的最大请求带宽。
请求的下行流带宽(kbps)|该参数表示下行流允许的最大请求带宽。
容忍的上行流带宽(kbps)|该参数表示上行流的最小保障带宽。
容忍的下行流带宽(kbps)|该参数表示下行流的最小保障带宽。
ARP优先级决策方式|该参数用于向RCP指示ARP优先级的决策方式。当选择“CCR请求中的值”时，RCP下发CCR请求中的ARP优先级。不选择该参数时，RCP按照本参数集中配置的ARP优先级下发。
ARP优先级|表示该业务标识的业务流服务质量保证的分配保持优先级（ARP）。
ARP抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP抢占能力。在服务质量受限情况下，本业务抢占其他业务服务质量的能力。
ARP被抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP被抢占能力。在服务质量受限情况下，被其他业务抢占本业务服务质量的能力。
优先级|该参数由运营商规划。当多个业务规则被下发到TDF的同一承载上时，优先级高的业务规则优先匹配执行。
流状态|该参数表示允许业务流通行的状态：上行：TDF只保障上行业务流的服务质量，拒绝下行业务流。下行：TDF只保障下行业务流的服务质量，拒绝上行业务流。双向：TDF需要保障上、下行业务流的服务质量。关闭：TDF拒绝上、下行业务流。
业务标识|该参数是与TDF约定好的受控业务标识。
重定向能力|该参数表示TDF是否需要对业务流进行重定向。打开重定向：TDF需要对业务流进行重定向，同时RCP向TDF下发重定向地址类型和重定向地址。关闭重定向：TDF不对业务流进行重定向，RCP不向TDF下发重定向地址。当ADD BEARABILITY中的支持私有重定向字段选择标准接口时需要配置该参数、重定向地址类型和重定向地址。
重定向地址类型|该参数表示业务流重定向地址的类型，需要与重定向地址同时配置。
重定向地址|该参数表示业务流的重定向地址，需要与重定向地址类型同时配置。
重定向业务TDF应用标识|该参数表示重定向确认业务的标识。RCP向TDF下发该标识，如果TDF检测到重定向确认业务已发生，那么TDF向RCP上报该业务发生事件。RCP获取到该事件后，不再向TDF下发重定向地址。预定义规则类型时，若RCP需要监控重定向确认业务是否发生，那么需要配置该参数。
费率组|该参数表示业务归属的费率组，该参数和报告等级一起使用。若运营商设定在用户的费率发生切换时需要踢用户下线，并且设定RCP下发预定义规则时，那么需要配置该参数。
报告等级|该参数用来指示TDF向计费系统上报的等级：业务标识等级：表示基于费率组和业务标识组合的等级。费率组等级：表示基于费率组的等级。赞助支付等级：表示基于费率组和赞助商标识、应用服务提供商标识组合的等级。
在线计费|该参数用于指示TDF是否对业务开启在线计费功能。
离线计费|该参数用于指示TDF是否对业务开启离线计费功能。
计费度量方式|该参数用于指示TDF对业务计费的度量方法。
业务属性|该参数表示业务优先级。当一个承载关联多个业务时，承载优先级可取该承载所关联的所有业务的业务优先级的最大值或最小值。
带宽决策方式|该参数用于向RCP指示业务带宽的决策方式。不选择该参数时，RCP按照本参数集中配置的带宽下发。选择该参数时，RCP按照选择方式计算并下发：UBAS推荐带宽优先：在闭环控制功能中，RCP优先使用UBAS推荐的业务带宽下发。CCR请求中的值：RCP取CCR请求中的业务带宽下发。所有带宽最大值：RCP从UBAS推荐带宽、CCR请求中的业务带宽、本参数集中配置的带宽中取最大值下发。所有带宽最小值：RCP从UBAS推荐带宽、CCR请求中的业务带宽、本参数集中配置的带宽中取最小值下发。
在线调查标记|该参数为私有接口参数。
TDF应用标识输出|该参数填写为“输出”时，RCP网元会下发该业务关联的TDF应用标识给TDF网元。预定义规则类型时，若RCP网元需要监控该TDF业务的发生、停止状态，那么需要配置该参数。
静默通知|该参数是指TDF应用标识输出对应的TDF业务发生或停止时，TDF网元是否需要通知RCP网元。
上行业务链策略标识|该参数用于表示对业务分流指定路径。PCEF网元对上行业务流进行分流时使用该参数。
下行业务链策略标识|该参数用于表示对业务分流指定路径。PCEF网元对下行业务流进行分流时使用该参数。
动作参数|参数说明
---|---
业务规则类型|该参数取值为动态规则或预定义规则，是必选参数：动态规则：在RCP上定义规则名称和具体的规则内容。激活规则时，RCP下发规则名称和具体的规则内容给S-PCEF执行策略。预定义规则：在S-PCEF上定义规则名称和具体规则内容，在RCP上定义与S-PCEF上一致的规则名称。激活规则时，RCP只下发规则名称，S-PCEF根据规则名称匹配具体的规则内容并执行策略。说明：以下动作参数在动态规则中都支持配置输出；只在预定义规则中支持输出的参数会特别标明。
规则名前缀|该参数指RCP下发给PCEF/SMF执行的PCC规则名称的前缀。预定义规则类型时该参数为可选配置。
规则名|该参数指RCP下发给S-PCEF执行的外置业务PCC规则的名称，是必选参数。预定义规则类型时该参数需要配置。
规则名后缀|该参数指RCP下发给PCEF/SMF执行的PCC规则名称的后缀。预定义规则类型时该参数为可选配置。
应用标识|该参数指与签约业务有映射关系的受控业务的应用标识，是必选参数。通过ADD APPSUBS配置签约业务和受控业务的映射关系。预定义规则类型时该参数需要配置。
QoS等级标识|该参数表示业务级的授权QCI。
请求的上行流带宽(kbps)|该参数表示上行流允许的最大请求带宽。
请求的下行流带宽(kbps)|该参数表示下行流允许的最大请求带宽。
容忍的上行流带宽(kbps)|该参数表示上行流的最小保障带宽。
容忍的下行流带宽(kbps)|该参数表示下行流的最小保障带宽。
ARP优先级决策方式|该参数用于向RCP指示ARP优先级的决策方式。当选择“CCR请求中的值”时，RCP下发CCR请求中的ARP优先级。不选择该参数时，RCP按照本参数集中配置的ARP优先级下发。
ARP优先级|表示该业务标识的业务流服务质量保证的分配保持优先级（ARP）。
ARP抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP抢占能力。在服务质量受限情况下，本业务抢占其他业务服务质量的能力。
ARP被抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP被抢占能力。在服务质量受限情况下，被其他业务抢占本业务服务质量的能力。
优先级|该参数由运营商规划。当多个业务规则被下发到S-PCEF的同一承载上时，优先级高的业务规则优先匹配执行。
流状态|该参数表示允许业务流通行的状态：上行：S-PCEF只保障上行业务流的服务质量，拒绝下行业务流。下行：S-PCEF只保障下行业务流的服务质量，拒绝上行业务流。双向：S-PCEF需要保障上、下行业务流的服务质量。关闭：S-PCEF拒绝上、下行业务流。
业务标识|该参数是与S-PCEF约定好的受控业务标识。
重定向能力|该参数表示S-PCEF是否需要对业务流进行重定向。打开重定向：S-PCEF需要对业务流进行重定向，同时RCP向S-PCEF下发重定向地址类型和重定向地址。关闭重定向：S-PCEF不对业务流进行重定向，RCP不向S-PCEF下发重定向地址。当ADD BEARABILITY中的支持私有重定向字段选择标准接口时需要配置该参数、重定向地址类型和重定向地址。
重定向地址类型|该参数表示业务流重定向地址的类型，需要与重定向地址同时配置。
重定向地址|该参数表示业务流的重定向地址，需要与重定向地址类型同时配置。
重定向类型|该参数为私有接口参数，RCP只与ZTE PCEF/SMF对接时使用。当ADD BEARABILITY中的支持私有重定向字段选择私有接口时需要配置该参数、重定向地址类型和重定向地址。
重定向业务TDF应用标识|该参数表示重定向确认业务的标识。RCP向PCEF/SMF下发该标识，如果PCEF/SMF检测到重定向确认业务已发生，那么PCEF/SMF向RCP上报该业务发生事件。RCP获取到该事件后，不再向PCEF/SMF下发重定向地址。预定义规则类型时，若RCP需要监控重定向确认业务是否发生，那么需要配置该参数。
费率组|该参数表示业务归属的费率组，该参数和报告等级一起使用。若运营商设定在用户的费率发生切换时需要踢用户下线，并且设定RCP下发预定义规则时，那么需要配置该参数。
报告等级|该参数用来指示S-PCEF向计费系统上报的等级：业务标识等级：表示基于费率组和业务标识组合的等级。费率组等级：表示基于费率组的等级。赞助支付等级：表示基于费率组和赞助商标识、应用服务提供商标识组合的等级。
在线计费|该参数用于指示S-PCEF是否对业务开启在线计费功能。
离线计费|该参数用于指示S-PCEF是否对业务开启离线计费功能。
计费度量方式|该参数用于指示S-PCEF对业务计费的度量方法。
业务属性|该参数表示业务优先级。当一个承载关联多个业务时，承载优先级可取该承载所关联的所有业务的业务优先级的最大值或最小值。
AF计费标识|该参数表示AF计费标识。一般由RCP将AF会话中携带的ICID透传给S-PCEF，很少通过此参数配置.
计费关联指示|该参数用于指示S-PCEF是否上报业务对应的GCID。预定义规则类型时，该参数也可以配置。
带宽决策方式|该参数用于向RCP指示业务带宽的决策方式。不选择该参数时，RCP按照本参数集中配置的带宽下发。选择该参数时，RCP按照选择方式计算并下发：UBAS推荐带宽优先：在闭环控制功能中，RCP优先使用UBAS推荐的业务带宽下发。CCR请求中的值：RCP取CCR请求中的业务带宽下发。所有带宽最大值：RCP从UBAS推荐带宽、CCR请求中的业务带宽、本参数集中配置的带宽中取最大值下发。所有带宽最小值：RCP从UBAS推荐带宽、CCR请求中的业务带宽、本参数集中配置的带宽中取最小值下发。
在线调查标记|该参数为私有接口参数。
资源分配通知|该参数表示本业务规则所需的资源分配完成后，S-PCEF是否需要通知RCP网元。若RCP需要在预定义规则所需的资源分配完成后由S-PCEF通知RCP，那么需要配置该参数。
TDF应用标识输出|该参数填写为“输出”时，RCP网元会下发该业务关联的TDF应用标识给S-PCEF。预定义规则类型时，若RCP网元需要监控该TDF业务的发生、停止状态，那么需要配置该参数。
静默通知|该参数是指TDF应用标识输出对应的TDF业务发生或停止时，S-PCEF是否需要通知RCP网元。
动作参数|参数说明
---|---
预定义业务规则|该参数表示PCC\ADC\QOS\外置业务PCC预定义类型的规则参数集的名称。
预定义规则组名前缀|该参数表示RCP网元下发给PCEF/SMF执行的规则组名称的前缀。
预定义规则组名称|该参数表示RCP网元下发给PCEF/SMF执行的规则组的名称。当RCP网元需要向PCEF/SMF下发预定义规则时，如果配置了预定义规则与预定义规则组名称的映射关系，那么RCP网元会使用对应的预定义规则组名称下发给PCEF/SMF。
预定义规则组名后缀|该参数表示RCP网元下发给PCEF/SMF执行的规则组名称的后缀。
动作参数|参数说明
---|---
流量门限控制方式|RCP下发门限值是用于指示PCEF/SMF当用户使用的相应业务流量达到下发的门限值时，需要上报给RCP。该参数用于向RCP网元指示流量类型的用量的门限值下发方式：固定值：RCP网元按照本参数集配置的流量门限值下发。余额：RCP网元从对应用量对象的可用剩余量和本参数集配置的流量门限值中取较小值下发。
总流量门限（KByte）|该参数指示PCEF/SMF当用户使用业务总流量达到本门限值时，需要向RCP上报业务级用量。
上行流量门限（KByte）|该参数指示PCEF/SMF当用户使用业务上行流量达到本门限值时，需要向RCP上报业务级用量。
下行流量门限（KByte）|该参数指示PCEF/SMF当用户使用业务下行流量达到本门限值时，需要向RCP上报业务级用量。
时长门限控制方式|RCP下发门限值是用于指示PCEF/SMF当用户使用的相应业务时长达到下发的门限值时，需要上报给RCP。该参数用于向RCP网元指示时长类型的用量的门限值下发方式：固定值：RCP网元按照本参数集配置的时长门限值下发。余额：RCP网元从对应用量对象的可用剩余时长和本参数集配置的时长门限值中取较小值下发。
时长门限（秒）|该参数指示PCEF/SMF当用户使用业务时长达到本门限值时，需要向RCP上报业务级用量。
业务访问次数门限控制方式|RCP下发门限值是用于指示PCEF/SMF当用户使用的相应业务访问次数达到下发的门限值时，需要上报给RCP。该参数用于向RCP网元指示业务访问次数类型的用量的门限值下发方式：固定值：RCP网元按照本参数集配置的访问次数门限值下发。余额：RCP网元从对应用量对象的可用剩余访问次数和本参数集配置的访问次数门限值中取较小值下发。
业务访问次数门限（次）|该参数指示PCEF/SMF当用户使用业务的访问次数达到本门限值时，需要向RCP上报业务级用量。
定时上报时间频度（秒）|该参数表示每经过本参数配置的时间（如果有多个业务，取最小值），需要RCP网元主动向PCEF/SMF查询当前业务的用量。
用量报告开关|该参数指示RCP网元需要主动向PCEF/SMF查询用户使用当前业务的用量。
用量监控开关|该参数指示RCP网元通知PCEF/SMF不再监控用户使用当前业务的用量。
监控配额启动时间|该参数指示ZXUN RCP网元通知SMF当前业务监控配额的启动时间。
监控配额切换时间|该参数指示PCF网元通知SMF当前业务监控配额的切换时间。
切换后总流量门限（KByte）|该参数指示当用户切换监控后的总流量达到本门限值时，SMF需要向PCF上报业务的用量。
切换后上行流量门限（KByte）|该参数指示当用户切换监控后的上行流量达到本门限值时，SMF需要向PCF上报业务的用量。
切换后下行流量门限（KByte）|该参数指示当用户切换监控后的下行流量达到本门限值时，SMF需要向PCF上报业务的用量。
切换后时长门限（秒）|该参数指示当用户切换监控后的时长达到本门限值时，SMF需要向PCF上报业务的用量。
停止监控时长（秒）|该参数指示SMF多长时间内没有流量上报，则PCF停止累计业务时长。
动作参数|参数说明
---|---
Monitoring Key|该参数是IPCAN会话期间进行用量监控的唯一标识。
流量门限控制方式|RCP下发门限值是用于指示PCEF/SMF当用户在会话期间使用的流量达到下发的门限值时，需要上报给RCP。该参数用于向RCP网元指示流量类型的用量的门限值下发方式：固定值：RCP网元按照本参数集配置的流量门限值下发。余额：RCP网元从当前会话的可用剩余量和本参数集配置的流量门限值中取较小值下发。
总流量门限（KByte）|该参数指示PCEF/SMF当用户在会话期间使用总流量达到本门限值时，需要向RCP上报会话级用量。
上行流量门限（KByte）|该参数指示PCEF/SMF当用户在会话期间使用上行流量达到本门限值时，需要向RCP上报会话级用量。
下行流量门限（KByte）|该参数指示PCEF/SMF当用户在会话期间使用下行流量达到本门限值时，需要向RCP上报会话级用量。
时长门限控制方式|RCP下发门限值是用于指示PCEF/SMF当用户在会话期间使用的时长达到下发的门限值时，需要上报给RCP。该参数用于向RCP网元指示时长类型的用量的门限值下发方式：固定值：RCP网元按照本参数集配置的时长门限值下发。余额：RCP网元从当前会话的可用剩余时长和本参数集配置的时长门限值中取较小值下发。
时长门限（秒）|该参数指示PCEF/SMF当用户在会话期间使用的时长达到本门限值时，需要向RCP上报会话级用量。
业务访问次数门限控制方式|RCP下发门限值是用于指示PCEF/SMF当用户在会话期间使用的业务访问次数达到下发的门限值时，需要上报给RCP。该参数用于向RCP网元指示业务访问次数类型的用量的门限值下发方式：固定值：RCP网元按照本参数集配置的访问次数门限值下发。余额：RCP网元从当前会话的可用剩余访问次数和本参数集配置的访问次数门限值中取较小值下发。
业务访问次数门限（次）|该参数指示PCEF/SMF当用户在会话期间使用的业务访问次数达到本门限值时，需要向RCP上报会话级用量。
定时上报时间频度（秒）|该参数表示每经过本参数配置的时间，需要RCP网元主动向PCEF/SMF查询当前会话的用量。
用量报告开关|该参数指示RCP网元需要主动向PCEF/SMF查询用户在当前会话期间使用的用量。
用量监控开关|该参数指示RCP网元通知PCEF/SMF不再监控用户在当前会话期间使用的用量。
被排除的PCC规则ID|该参数指示被排除的PCC规则ID，用于将相应的业务数据流排除在PDU会话级用量监控之外。本参数仅用于会话级用量监控。
监控配额启动时间|该参数指示PCF网元通知SMF当前会话监控配额的启动时间。
监控配额切换时间|该参数指示PCF网元通知SMF当前会话监控配额的切换时间。
切换后总流量门限(KByte)|该参数指示当用户切换监控后的总流量达到本门限值时，SMF需要向PCF上报会话级用量。
切换后上行流量门限(KByte)|该参数指示当用户切换监控后的上行流量达到本门限值时，SMF需要向PCF上报会话级用量。
切换后下行流量门限(KByte)|该参数指示当用户切换监控后的下行流量达到本门限值时，SMF需要向PCF上报会话级用量。
切换后时长门限（秒）|该参数指示当用户切换监控后的时长达到本门限值时，SMF需要向PCF上报会话级用量。
停止监控时长（秒）|该参数指示SMF多长时间内没有流量上报，则PCF停止累计会话时长。
动作参数|参数说明
---|---
黑白名单|该参数用于RCP网元向PCEF/SMF指示黑白名单ID。通过CCA或RAR消息中的私有AVP User_Id下发。
动作参数|参数说明
---|---
规则类型|该参数表示RCP网元对指定套餐下发的规则类型。
预定义规则组名前缀|该参数表示RCP网元下发给PCEF/SMF执行的规则组名称的前缀。
预定义规则组名|该参数表示RCP网元下发给PCEF/SMF执行的规则组的名称。
预定义规则组名后缀|该参数表示RCP网元下发给PCEF/SMF执行的规则组名称的后缀。
规则名前缀|该参数表示RCP网元下发给PCEF/SMF执行的规则名称的前缀。
规则名后缀|该参数表示RCP网元下发给PCEF/SMF执行的规则名称的后缀。
预定义规则名|该参数表示RCP网元下发给PCEF/SMF执行的规则的名称。
动作参数|参数说明
---|---
RFSP索引|该参数表示RCP下发给AMF的当前N15会话的RFSP索引。RFSP索引是本地接入网络管理UE信息的一个索引，可以用于应用指定的无线资源管理策略。
服务区域限制决策方式|该参数表示RCP对当前N15会话的服务区域限制的决策方式。当该参数选择“请求”或“不限制”时，不允许配置以下参数：服务区域限制类型、限制服务区域操作集ID、允许区域最大TA数、不允许区域最大TA数。
服务区域限制类型|该参数与限制服务区域操作集ID参数关联。表示限制服务区域操作集ID中指定的区域是允许区域还是限制区域。
限制服务区域操作集ID|该参数的取值为“N15限制服务区域参数集”类型的动作参数集的名称。表示RCP需要下发给AMF的区域集。
允许区域最大TA数|该参数用于RCP指示AMF在允许区域中的最大TA(Tracking Area)数量。
不允许区域最大TA数|该参数用于RCP指示AMF在不允许区域中的最大TA(Tracking Area)数量。
动作参数|参数说明
---|---
服务区域类型|该参数表示服务区域的表示方法。当该参数取值为“区域码”时，区域码参数必须填写；当该参数取值为“TAC”时，TAC参数必须填写。
区域码|该参数表示服务区域使用区域码表示。
TAC|该参数表示服务区域使用TAC表示，最多可以填写32个。
动作参数|参数说明
---|---
URSP规则参数集ID|该参数用于RCP向AMF下发多个UE路由选择策略，UE路由选择策略用于UE决定如何路由出局业务流。该参数的取值为“URSP规则参数集”类型的动作参数集的名称。该参数在本参数集中最多可以配置8个。
动作参数|参数说明
---|---
URSP规则名|该参数表示UE路由选择策略（UE Route Selection Policy）的规则名称。
UPSC|该参数表示UE策略分片码（UE Policy Section Code）。
优先级|该参数表示URSP规则的优先级。
业务流描述参数集ID|该参数表示URSP规则中携带的业务流描述器内容。该参数的取值为“UE业务流描述参数集”类型的动作参数集的名称。该参数在本参数集中最多可以配置4个。
路由选择描述参数集ID|该参数表示URSP规则中携带的路由选择描述器内容。该参数的取值为“UE路由选择描述参数集”类型的动作参数集的名称。该参数在本参数集中最多可以配置5个。
动作参数|参数说明
---|---
业务流类型|该参数表示业务流描述器适用的业务流类型。
业务流值|当“业务流类型”不选择“OSAPPID”、”IPV4ADDR“、“IPV6ADDR”、“PORTRANGE”、“TOS”、“CTAGPCPDEI”、“STAGPCPDEI”、“IP3TUPLE”时，该参数可以配置。
操作系统应用标识|当“业务流类型”选择“OSAPPID”时，该参数可以配置。该参数值关联AM数据配置→操作系统应用标识配配置的“NAME”字段。
IP地址|当“业务流类型”选择“IPV4ADDR”或“IPV6ADDR”时，该参数可以配置。该参数值关联AM数据配置→IP服务地址配置的“NAME”字段。
服务端口|当“业务流类型”选择“PORTRANGE”时，该参数可以配置。该参数值关联AM数据配置→服务端口配置的“NAME”字段。
服务类型|当“业务流类型”选择“TOS”时，该参数可以配置。该参数值关联AM数据配置→服务类型配置的“NAME”字段。
PCP DEI|当“业务流类型”选择"CTAGPCPDEI”或“STAGPCPDEI”时，该参数可以配置。该参数值关联AM数据配置→PCP DEI配置的“NAME”字段。
IP三元组|当“业务流类型”选择“IP3TUPLE”时，该参数可以配置。该参数值关联AM数据配置→IP三元组配置的“NAME”字段。
动作参数|参数说明
---|---
优先级|该参数表示路由选择描述器的优先级。
SSC Mode|该参数表示RCP指示终端设备创建PDU会话时使用的SSC模式。
PDU会话类型|该参数表示RCP指示终端设备创建PDU会话时使用的PDU会话类型。
优选接入类型|该参数表示RCP指示终端设备需要优选的接入类型（3GPP或非3GPP）。
非无缝非3GPP卸载指示|该参数表示RCP指示终端设备是否将业务流卸载到PDU会话外的非3GPP接入网络进行传输。
SNSSAI|该参数关联AM数据配置→单网络切片配置的“NAME”字段。该参数在本参数集中最多可以配置4个。
DNN|该参数表示RCP指示终端设备创建PDU会话时可以使用的DNN。该参数在本参数集中最多可以配置4个。
动作参数|参数说明
---|---
会话规则名称|该参数表示PCF下发给SMF执行的N7会话规则的名称，是必选参数。
会话汇聚带宽决策方式|该参数指RCP下发给SMF执行的N7会话的汇聚带宽的决策方式。
会话AMBR上行速率(kbps)|该参数指RCP下发给SMF执行的N7会话的AMBR上行速率。
会话AMBR下行速率(kbps)|该参数指RCP下发给SMF执行的N7会话的AMBR下行速率。
首选计费地址|该参数表示RCP向SMF网元指定当前N7会话的首选在线计费地址。
备选计费地址|该参数表示RCP向SMF网元指定当前N7会话的备选在线计费地址。
5QI决策方式|该参数指RCP下发给SMF执行的N7会话的5QI的决策方式。
5QI|该参数用于RCP向SMF网元指定当前N7会话的5QI。每个5QI对应一组QoS特征值。例如，优先级、平均窗口、最大数据突发量。
ARP优先级决策方式|该参数指RCP下发给SMF执行的N7会话的ARP优先级的决策方式。
ARP优先级|该参数用于RCP向SMF指定当前N7会话的ARP优先级。
ARP抢占能力|该参数用于RCP向SMF指定当前N7会话是否开启ARP抢占能力。若选择开启，则表示在服务质量受限情况下，该承载具有抢占其他承载服务质量的能力。
ARP被抢占能力|该参数用于RCP向SMF指定当前N7会话是否开启ARP被抢占能力。若选择开启，则表示在服务质量受限情况下，该承载具有被其他承载抢占服务质量的能力。
IPV4地址索引|该参数用于RCP向SMF指定当前N7会话的IPv4地址索引，用于标识IPv4地址分配方法的信息。
IPV6地址索引|该参数用于RCP向SMF指定当前N7会话的IPv6地址索引，用于标识IPv6地址分配方法的信息。
反射QOS时长（秒）|该参数用于RCP向SMF指定当前N7会话的反射QoS的生存周期，只用于Non-GBRQoS Flow。
授权时长（秒）|该参数用于RCP向SMF指示当前N7会话的授权时长。N7会话授权时长取值为会话、业务、业务用量监控三个层次的授权时长的最小值。
计费方法决策方式|该参数指RCP下发给SMF执行的N7会话的计费方法的决策方式。
离线计费|该参数用于RCP向SMF指示是否开启会话级离线计费功能。
在线计费|该参数用于RCP向SMF指示是否开启会话级在线计费功能。
用量监控ID|该参数用于RCP指示当前N7会话的Monitoring Key。
所有用量上报开关|该参数指示RCP通知SMF上报当前会话期间使用的用量。
优先级|该参数表示5QI的优先级。
平均窗口|该参数表示计算GBR和MBR的时长，只用于GBR/Delay-criticalGBR型QoS流。
最大数据突发量|该参数表示5G-AN PDB周期内需要传输的最大数据量，只用于Delay-criticalGBR类型QoS流。
动作参数|参数说明
---|---
5QI|该参数用于向SMF网元指定当前N7会话或业务的5QI，是必选参数。
资源类型|该参数表示无线资源的类型，包括GBR、Delay-critical GBR或Non-GBR。
优先级|该参数表示5QI的优先级。
包时延|该参数表示报文时延。
误包率|该参数表示报文错误率。
平均窗口|该参数表示计算GBR和MBR的时长，只用于GBR/Delay-criticalGBR型QoS流
最大数据突发量|该参数表示5G-AN PDB周期内需要传输的最大数据量，该参数表示最大数据突发量。只用于Delay-criticalGBR类型QoS流。
动作参数|参数说明
---|---
规则名前缀|该参数指RCP下发给SMF执行的N7PCC规则的名称前缀。
PCC规则名称|该参数指RCP下发给SMF执行的N7PCC规则的名称，是必选参数。
规则名后缀|该参数指RCP下发给SMF执行的N7PCC规则的名称后缀。
PCC规则类型|该参数取值为动态规则或预定义规则，是必选参数。动态规则：在PCF上定义规则名称和具体的规则内容。激活规则时，PCF下发规则名称和具体的规则内容给SMF执行策略。预定义规则：在PCF上定义规则名称和具体规则内容，在PCF上定义与SMF上一致的规则名称。激活规则时，PCF只下发规则名称，SMF根据规则名称匹配具体的规则内容并执行策略。
业务标识|该参数该参数RCP与SMF约定好的受控业务标识。
优先级|该参数表示PCC规则的优先级。当多个业务规则被下发到SMF的同一承载上时，优先级高的业务规则优先匹配执行。
QoS控制策略ID|该参数的取值为表24中动作参数集的名称。
流量控制策略ID|该参数的取值为表26中动作参数集的名称。
计费控制策略ID|该参数的取值为表25中动作参数集的名称。
需要应用探测|该参数填写为“是”时，RCP会下发该业务关联的TDF应用标识给SMF。
Monitoring Key|该参数是N7业务用量监控的关键字，通过该关键字关联相应业务的用量配额和用量消费额。
资源分配成功通知|该参数表示RCP是否需要SMF将PCC规则安装结果通知RCP。
包过滤器用途|该参数用于RCP指示相关网元是否允许进行包过滤。
计费关联指示|该参数用于RCP指示AF计费标识和N7计费标识是否需要计费关联。
动作参数|参数说明
---|---
QoS控制策略ID|该参数表示QoS控制策略ID，用于标识PDU会话中的QoS控制策略数据，全局唯一。
5QI|该参数表示业务级的授权5QI。
最大上行带宽(kbps)|该参数表示上行流允许的最大请求带宽。
最大上行带宽(kbps)|该参数表示下行流允许的最大请求带宽。
保障上行带宽(kbps)|该参数表示上行流的最小保障带宽。
保障下行带宽(kbps)|该参数表示下行流的最小保障带宽。
ARP优先级决策方式|该参数用于向RCP指示ARP优先级的决策方式。
ARP优先级|该参数表示该业务标识的业务流服务质量保证的分配保持优先级
ARP抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP抢占能力。在服务质量受限情况下，本业务抢占其他业务服务质量的能力。
ARP被抢占能力|该参数表示该业务标识的业务流服务质量保证的ARP被抢占能力。在服务质量受限情况下，被其他业务抢占本业务服务质量的能力。
QNC|该参数表示在QoS Flow的生命周期内，当不再保证（或再次保证）GFBR时，是否向3GPP NG-RAN请求通知。
上行共享标识|该参数表示通过本参数可以指示哪些PCC规则可以共享上行资源。
下行共享标识|该参数表示通过本参数可以指示哪些PCC规则可以共享下行资源。
最大下行允许丢包率|该参数表示业务数据流可以允许的最大下行丢包速率。
默认承载指示|该参数表示动态PCC规则是否始终与默认QoS规则关联的QoSFlow绑定。
反射QoS|该参数表示QoS信息是否对相应的业务数据流进行反射。
最大上行允许丢包率|该参数表示业务数据流可以允许的最大上行丢包速率。
优先级|该参数表示5QI的优先级。
平均窗口|该参数表示计算GBR和MBR的时长。
最大数据突发量|该参数表示5G-AN PDB周期内需要传输的最大数据量。
动作参数|参数说明
---|---
计费控制策略ID|该参数表示计费控制策略ID，用于标识PDU会话中的计费控制策略数据，全局唯一。
计费度量方式|该参数用于指示SMF对业务计费的度量方法。
离线计费|该参数用于指示SMF是否对业务开启在线计费功能。
在线计费|该参数用于指示SMF是否对业务开启在线计费功能。
费率组|该参数表示业务归属的费率组，该参数和报告等级一起使用。
计费上报等级|该参数用来指示SMF向计费系统上报的等级：业务标识等级：表示基于费率组和业务标识组合的等级。费率组等级：表示基于费率组的等级。赞助支付等级：表示基于费率组和赞助商标识、应用服务提供商标识组合的等级。
计费业务标识|该参数表示PCC规则中业务数据流涉及的业务或业务组件的标识。
赞助业务标识|该参数表示赞助业务的标识。
应用提供商标识|该参数表示应用服务商的标识。
AF计费标识|该参数表示AF计费标识。一般由PCF将AF会话中携带的ICID透传给SMF，很少通过此参数配置。
动作参数|参数说明
---|---
流量控制策略ID|该参数表示流量控制策略ID，用于标识PDU会话中的流量控制策略数据，全局唯一。
流状态|该参数表示允许业务流通行的状态：上行：SMF只保障上行业务流的服务质量，拒绝下行业务流。下行：SMF只保障下行业务流的服务质量，拒绝上行业务流。双向：SMF需要保障上、下行业务流的服务质量。关闭：SMF拒绝上、下行业务流。
重定向能力|该参数表示SMF是否需要对业务流进行重定向。
重定向地址类型|该参数表示业务流重定向地址的类型，需要与重定向地址同时配置。
重定向地址|该参数表示业务流的重定向地址，需要与重定向地址类型同时配置。
静默通知|该参数是指TDF应用标识输出对应的TDF业务发生或停止时，SMF是否需要通知RCP。
下行业务链策略编号|该参数标识参考SMF预先配置的下行流量转向策略。
上行业务链策略编号|该参数标识参考SMF预先配置的上行流量转向策略。
路由目的地|该参数的取值为表27中动作参数集的ID。
重定向类型|该参数为私有接口参数，PCF只与ZTE SMF对接时使用。
动作参数|参数说明
---|---
DNAI|该参数表示应用的位置。
路由配置标识|该参数表示路由配置标识。
IPV4地址|该参数表示该隧道端点在数据网络中的IPv4地址。
IPV6地址|该参数表示该隧道端点在数据网络中的IPv6地址。
端口|该参数表示该隧道端点的端口。
配置完毕，单击按钮。
配置举例 :配置会话动作1：会话上、下行带宽分别为1M、3M，并且开启在线计费。 
配置完成如[图4]所示。
图4  会话动作1配置举例

注意 :除通知参数集以外，一个动作参数可以被多个同类型的策略规则引用。 
一个通知类型的动作参数只能被一个通知类型规则引用。 
在执行操作步骤3之前和操作步骤4之后，必须刷新界面，用以保证界面显示为最新记录。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
[规则]
##### 规则 
概述 :一个策略规则包含一个条件表达式和一个动作参数集，并且策略规则具有优先级属性。当用户满足某种触发条件时，RCP网元执行其动作参数集中指定的动作参数。 
本节介绍如何配置策略规则。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击规则，弹出规则页面，如[图2]所示。
图2  规则页面

单击按钮，设置规则参数，如[图3]所示。
图3  规则参数配置页面

规则参数说明参见[表1]。
参数名称|参数说明
---|---
规则名称|唯一标识一个策略规则，名称可修改。
优先级|确定一个策略规则的优先级。在同一场景中存在多个同类型的策略规则时，使用优先级确定策略规则的执行顺序。数值高则优先级高。
策略类型|RCP网元将策略规则划分为不同的策略类型。不同策略类型的策略规则可以输出不同作用或不同应用范围的动作参数。该参数用于确定场景下需要关联的策略规则的类型。可多选。套餐动态优先级决策：可以动态调整套餐的优先级或使套餐失效。该类型的策略规则的条件表达式中应该包含套餐ID条件，表示这个规则是用于调整这个套餐的优先级。在RCP网元为用户进行套餐选择时使用。例如，用户签约多个套餐，每个套餐可以提供不同的QoS。运营者希望随时能为用户提供最高Qos的套餐。这时，RCP需要实时的根据每个套餐的用量消耗情况动态调整套餐的动态优先级，RCP需要配置这种策略类型的规则。套餐预定义策略：该类型的策略规则用于向指定套餐下发PCC规则。业务预下发控制策略：该类型的策略规则的输出动作决定了RCP网元需要对哪些受控业务下发PCC规则。目前RCP网元提供两种方式：一是根据用户的签约业务进行下发，二是根据指定的受控业务标识下发。AMF接入移动策略：该类型的策略规则用于RCP网元向AMF下发N15会话的策略参数。UE路由选择策略：该类型的策略规则用于RCP网元向AMF下发UE路由选择的策略参数。N7会话决策：该类型的策略规则可以向SMF下发N7会话的QoS参数和计费地址等参数。N7业务决策：改类型的策略规则可以向SMF下发对指定的受控业务下发N7 PCC规则参数。业务控制策略：该类型的策略规则可以对指定的受控业务下发PCC规则参数。目前RCP网元可以下发Gx、Sd接口上的业务规则参数。承载控制策略：该类型的策略规则可以下发承载的QoS参数。目前使用的比较少。会话控制策略：该类型的策略规则可以下发会话的QoS参数和计费地址等参数。通知策略：该类型的策略规则表示在满足特定条件时，RCP网元按照输出动作参数中的通知内容和通知方式向用户发送通知。同时RCP网元提供通知防骚扰功能，所需要的防骚扰参数也可以通过输出的动作参数确定。业务级用量监控策略：3GPP协议中规定PCEF/SMF可以上报两个级别的用量，分别是业务级和会话级。该类型的策略规则用于RCP网元向PCEF下发业务级的用量监控参数，使PCEF在检测到用量达到监控阀值时能够向RCP网元上报用量。会话级用量监控策略：该类型的策略规则用于RCP网元向PCEF下发会话级的用量监控参数，使PCEF在检测到用量达到监控阀值时能够向RCP网元上报用量。Rx接口接纳策略：该类型的策略规则用于RCP网元控制Rx接口的AF会话是否允许接入。在预置的条件下，RCP可以拒绝接入用户的AF会话。黑白名单策略：是私有接口上支持的策略类型。在ZTE PCEF上预先配置一些策略集合，每个集合使用一个ID表示。通过配置这种类型的策略规则，在满足特定条件时，RCP网元仅下发一个集合ID，ZTEPCEF可以使用ID对应的集合中的策略。
动作类型|一个策略规则确定了在满足特定条件时，需要执行的操作。这些操作即动作。可以分为以下几种类型：拒绝：RCP网元对承载或会话进行接纳控制时使用。使用此类型时，不需要关联策略元素配置→动作参数。参数填充：需要为RCP网元内部或外部网元提供策略参数时使用。使用此类型时，需要关联策略元素配置→动作参数。立即发送：仅通知策略类型的策略规则使用。使用此类型时，需要关联策略元素配置→动作参数。
日志开关|开启license控制项后，RCP网元提供日志功能。若需要在日志中记录该策略规则的匹配执行情况，则需要将此参数开启。
规则编号|默认为0，该参数仅在重定向确认功能中需要配置。
条件过滤|条件过滤下方的条件列表中包含了所有该策略规则中可以使用的条件。通过条件名称可以过滤条件，实现快速查找。
条件表达式编辑框|通过运算符可以将若干条件组成一个条件表达式应用在策略规则中。当条件表达式结果为真时，RCP网元需要执行策略规则的动作。通过以下步骤编辑条件表达式：在条件列表中双击选择一个条件，则此条件会被加入到条件表达式编辑框中。在条件表达式编辑框上方选择运算符。重复步骤3.a、3.b，直至完成条件表达式的配置。条件表达式为可选配置。不配置时表示无条件执行策略规则的输出动作。
动作过滤|动作过滤下方的动作参数列表中包含了所有该策略规则可使用的动作参数。通过动作参数名称进行过滤，实现快速查找。只有动作类型为参数填充、立即发送时才需要关联动作参数。一个策略规则中可以关联多个动作参数，但是各个动作参数的类型不能相同。
配置完毕，单击按钮。
配置举例 :规则1：用户日用量<1GB时，控制会话带宽为256M。配置完成结果如图4、图5所示。图4  规则1配置示例1图5  规则1配置示例2 
规则2：用户日用量>1GB时，控制会话带宽为128M。配置完成结果如图6、图7所示。图6  规则2配置示例1图7  规则2配置示例2 
规则3：用户日用量>1GB时，给用户发送短信通知，告知用户当前的使用量，注意使用。配置完成结果如图8、图9所示。图8  规则3配置示例1图9  规则3配置示例2 
注意 :在执行操作步骤3之前和操作步骤4之后，必须刷新界面，用以保证界面显示为最新记录。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
[场景]
##### 场景 
概述 :RCP网元根据策略决策输出动作的作用或输出动作的适用范围，将策略决策划分为不同的策略类型。场景通过场景的入口可以确定一系列策略规则的使用前提，这些策略规则可以属于不同的策略类型。这样就实现了在一个场景下可以输出不同作用或使用范围的动作。 
本节主要介绍如何配置场景。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击场景，弹出场景页面，如[图2]所示。
图2  场景页面

单击按钮，弹出场景参数页面，如[图3]所示。
图3  场景参数页面

场景参数说明参见[表1]。
参数名称|参数说明
---|---
场景名称|该参数用于唯一标识一个场景，场景名称可修改。
使能开关|该参数用于控制对应的场景配置是否生效。新增一个场景时，使能开关默认打开。将使能开关关闭后，对应的场景配置仍然保留，但不生效。若后续希望使用该场景，只需将使能开关打开并保存即可。
入口|通过入口可以确定场景下策略规则的使用前提。每个场景最多设置3个入口。多个场景的入口不能完全相同。
入口类型|表示入口条件中策略变量的类别。先确定入口类型，之后可以快速选择入口条件的策略变量。
已选入口|表示入口条件的策略变量。
取值|表示入口条件的参考值。
策略类型|RCP网元将策略规则划分为不同的策略类型。不同策略类型的策略规则可以输出不同作用或不同应用范围的动作参数。该参数用于确定场景下需要关联的策略规则的类型。可多选。套餐动态优先级决策：可以动态调整套餐的优先级或使套餐失效。该类型的策略规则的条件表达式中应该包含套餐ID条件，表示这个规则是用于调整这个套餐的优先级。在RCP网元为用户进行套餐选择时使用。例如，用户签约多个套餐，每个套餐可以提供不同的QoS。运营者希望随时能为用户提供最高Qos的套餐。这时，RCP需要实时的根据每个套餐的用量消耗情况动态调整套餐的动态优先级，RCP需要配置这种策略类型的规则。业务预下发控制策略：该类型的策略规则的输出动作决定了RCP网元需要对哪些受控业务下发PCC规则。目前RCP网元提供两种方式：一是根据用户的签约业务进行下发，二是根据指定的受控业务标识下发。AMF接入移动策略：该类型的策略规则可以下发N15接口的RFSP索引、允许和限制区域。N7会话控制决策：该类型的策略规则可以下发N7会话的QoS参数和计费地址等参数。N7业务控制决策：改类型的策略规则可以对指定的受控业务下发N7 PCC规则参数。Gx业务控制策略：该类型的策略规则可以对指定的受控业务下发PCC规则参数。目前RCP网元可以下发Gx、Sd接口上的业务规则参数。Gx承载控制策略：该类型的策略规则可以下发承载的QoS参数。目前使用的比较少。Gx会话控制策略：该类型的策略规则可以下发会话的QoS参数和计费地址等参数。通知策略：该类型的策略规则表示在满足特定条件时，RCP网元按照输出动作参数中的通知内容和通知方式向用户发送通知。同时RCP网元提供通知防骚扰功能，所需要的防骚扰参数也可以通过输出的动作参数确定。业务级用量监控策略：3GPP协议中规定PCEF/SMF可以上报两个级别的用量，分别是业务级和会话级。该类型的策略规则用于RCP网元向PCEF下发业务级的用量监控参数，使PCEF在检测到用量达到监控阀值时能够向RCP网元上报用量。会话级用量监控策略：该类型的策略规则用于RCP网元向PCEF下发会话级的用量监控参数，使PCEF在检测到用量达到监控阀值时能够向RCP网元上报用量。Rx接口接纳策略：该类型的策略规则用于RCP网元控制Rx接口的AF会话是否允许接入。在预置的条件下，RCP可以拒绝接入用户的AF会话。Gx黑白名单策略：是私有接口上支持的策略类型。在ZTE PCEF上预先配置一些策略集合，每个集合使用一个ID表示。通过配置这种类型的策略规则，在满足特定条件时，RCP网元仅下发一个集合ID，ZTEPCEF可以使用ID对应的集合中的策略。套餐预定义策略：该类型的策略规则用于向指定套餐下发PCC规则。UE路由选择策略：该类型的策略规则用于RCP网元向AMF下发UE路由选择的策略参数。选择一种策略类型，在场景查询页面下方会弹出相应的策略查询页面，如操作步骤4。
场景描述|可以对场景进行简单描述，方便查看。
在策略类型区域框中选择策略类型后，弹出策略查询页面。策略查询页面示例如[图4]所示。
图4  策略查询页面示例

在策略查询页面中勾选需要关联的规则名称。 
配置完毕，单击按钮。
配置举例 :场景1： 
仅对5G网络接入用户进行控制。 
用户日用量<1GB时，控制会话带宽为256M。 
用户日用量>1GB时，控制会话带宽为128M，并且给用户发送短信通知，告知用户当前的使用量，注意使用。 
根据上述要求，需要按照以下步骤进行配置： 
配置2个N7会话控制策略规则。分别表示用户日用量小于1GB和用户日用量大于1GB时的会话带宽控制规则。 
配置1个通知策略规则。表示用户日用量大于1GB时的通知规则。 
配置1个场景，表示5G用户的策略控制场景，并且关联上述规则。 
配置完成结果如[图5]、[图6]所示。
图5  场景1配置示例1

图6  场景1配置示例2

注意 :在执行操作步骤3之前和操作步骤6之后，必须刷新界面，用以保证界面显示为最新记录。 
界面说明 :带有（*）标识的参数为必选配置，其他为可选配置。 
无 
#### 策略数据查询 
#### 策略数据查询 


功能说明 :策略管理页面的每个配置项中提供了独立的查询功能。策略数据查询提供了综合性的查询功能，支持对已配置的策略数据进行查询，并且可以查询各个配置之间的关联关系。


##### 概念介绍 
策略数据查询包含以下查询功能：

 
场景查询：在当前策略数据中查询满足查询条件的场景。 

 
规则查询：在当前策略数据中查询满足查询条件的规则。 

 
关联数据查询：在当前策略数据中查询满足查询条件的被关联使用的数据。 

 
冗余数据查询：在当前策略数据中查询满足查询条件的没有被关联使用的数据。 

 


##### 场景查询 
概述 :本节介绍在当前所有的策略数据中查询满足查询条件的场景的方法。打开场景查询页面时或未输入查询条件时，场景查询中显示所有已配置的场景。
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击场景查询，弹出场景查询页面，如[图2]所示。场景查询页面参数说明参见[表1]。
图2  场景查询页面示例

参数名称|参数说明
---|---
入口策略变量|该参数用于指定已配置场景的入口策略变量，关联场景中配置的场景入口的名称。
入口取值|该参数用于指定已配置的场景入口的取值，关联场景中配置的场景入口的取值。
场景名称|该参数用于指定已配置的场景名称，关联场景中配置的场景名称。
使能开关|该参数用于指定已配置的场景是否生效，关联场景中配置的场景对应的使能开关。
策略类型|该参数用于指定场景包含的策略类型，关联场景中配置的场景对应的策略类型。
规则名称|该参数用于指定场景包含的规则名称，关联场景中配置场景包含的规则名称。
动作参数名称|该参数用于指定场景包含的动作参数名称，关联场景中配置场景包含的动作参数名称。
根据实际情况设置查询条件后，单击查询按钮。若需要重新查询，可单击重置按钮清空查询条件，再单击查询。场景列表区域框中显示所有满足查询条件的场景。
 说明： 
当设置多个查询条件时，表示查询结果必须满足所有查询条件。 
单击场景列表中的任一场景，场景信息区域框中将显示该场景的详细信息，包括使能开关，入口策略变量、该场景下包含的策略规则以及规则的具体信息。
在场景信息区域框中单击规则名称，关联信息区域框中将显示引用该规则的场景的名称。
在场景信息区域框中单击动作参数名称，关联信息区域框中将显示引用该动作参数的规则的名称。
（可选）单击导出所有按钮，可以将场景查询结果导出为html格式的文件。
##### 规则查询 
概述 :本节介绍在当前所有的策略数据中查询满足查询条件的规则的方法。打开规则查询页面时或未输入查询条件时，规则查询中显示所有已配置的规则。
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面

单击规则查询，弹出规则查询页面，如[图2]所示。规则查询页面参数说明参见[表1]。
图2  规则查询页面示例

参数名称|参数说明
---|---
策略类型|该参数用于指定规则所属的策略类型，关联规则中配置的策略类型。
规则名称|该参数用于指定规则的名称，关联规则中配置的规则名称。
动作参数名称|该参数用于指定规则关联的动作参数的名称，关联规则中配置规则关联的动作参数名称。
条件策略变量名称|该参数用于指定已配置规则的条件中的策略变量，关联规则中配置规则包含的条件中策略变量的名称。
根据实际情况设置查询条件后，单击查询按钮。若需要重新查询，可单击重置按钮清空查询条件，再单击查询。规则列表区域框中显示所有满足查询条件的规则。
 说明： 
当设置多个查询条件时，表示查询结果必须满足所有查询条件。 
单击规则列表中的任一规则，规则信息区域框中将显示该规则的详细信息，包括条件表达式、优先级、日志开关、动作类型、该规则关联的动作参数名称以及动作参数下参数的具体信息。
在规则信息区域框中单击规则名称，关联信息区域框中将显示引用该规则的场景的名称。
在规则信息区域框中单击动作参数名称，关联信息区域框中将显示引用该动作参数的规则的名称。
##### 关联数据查询 
##### 关联数据查询 


概述 :本节介绍在当前所有的策略数据中查询满足查询条件的被关联引用的配置数据的方法。打开关联数据查询页面时，关联数据查询中默认显示所有被引用到的规则类型的配置数据。


操作步骤 :

登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面






单击关联数据查询，弹出关联数据查询页面，如[图2]所示。关联数据查询页面参数说明参见[表1]。
图2  关联数据查询页面示例




参数名称|参数说明
---|---
配置数据|该参数用于指定配置数据的类型，关联RCP策略管理页面的基本数据配置和策略元素配置中每个节点的名称。
配置名称|该参数用于指定配置数据的名称，关联RCP策略管理页面的基本数据配置和策略元素配置中每个节点的配置页面中的名称。


根据实际情况设置查询条件后，单击查询按钮。若需要重新查询，可单击重置按钮清空查询条件，配置数据默认重置为规则。再单击查询。配置数据列表区域框中显示所有满足查询条件的配置数据。
 说明： 
当设置多个查询条件时，表示查询结果必须满足所有查询条件。 


单击配置数据列表中的任一数据，关联信息区域框中将显示该配置数据的名称，并显示引用该数据的配置数据的名称。




##### 冗余数据查询 
##### 冗余数据查询 


概述 :冗余数据是未被其他类型的配置数据关联引用的数据。本节介绍在当前所有的策略数据中查询满足查询条件的冗余数据的方法。打开冗余数据查询页面时，冗余数据查询中默认显示所有类型的冗余数据。


操作步骤 :

登录RCP策略管理页面，如[图1]所示。
图1  策略管理页面






单击冗余数据查询，弹出冗余数据查询页面，如[图2]所示。冗余数据查询页面参数说明参见[表1]。
图2  冗余数据查询页面示例




参数名称|参数说明
---|---
配置数据|该参数用于指定配置数据的类型，关联RCP策略管理页面的基本数据配置和策略元素配置中每个节点的名称。
配置名称|该参数用于指定配置数据的名称，关联RCP策略管理页面的基本数据配置和策略元素配置中每个节点的配置页面中的名称。


根据实际情况设置查询条件后，单击查询按钮。若需要重新查询，可单击重置按钮清空查询条件，再单击查询。冗余数据列表区域框中显示所有满足查询条件的冗余数据。
 说明： 
当设置多个查询条件时，表示查询结果必须满足所有查询条件。 




#### 日志报表查询 
功能说明 :系统支持对策略、用量及相关事件产生日志，并生成报表。全量报表可通过SFTP协议上传给分析平台。日志报表查询提供报表文件本地查询和展示页面，支持基于用户或套餐的查询功能。 
 说明： 
加载支持日志策略功能的License并且部署Npcf_LOG服务后，才能使用日志报表查询功能。
##### 概念介绍 
日志报表查询包含以下查询功能： 
用户通知历史信息查询：查询用户的规则和套餐通知事件的历史记录。 
策略生效统计信息查询：查询用户的策略生效及相关事件的发生记录。 
业务变更历史信息查询：查询用户基于套餐的业务变更事件的历史记录。 
策略签约趋势查询：查询套餐签约数随时间变化的详细情况。 
策略历史查询：查询基于套餐的策略事件发生情况的历史记录。 
##### 用户通知历史信息查询 
概述 :本节介绍查询ZXUN RCP向指定用户发送的通知事件的方法。
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  RCP策略管理页面

选择菜单日志报表查询→用户通知历史信息查询
，弹出用户通知历史信息查询页面，如[图2]所示。
图2  用户通知历史信息查询页面

用户通知历史信息查询参数说明参见[表1]。
参数名称|参数说明
---|---
MSISDN|该参数用于指定目标用户的MSISDN。每次查询操作只支持查询单个用户的通知历史。
查询时间|该参数用于指定历史通知发生的起止时间。起止时间最大支持30天时间跨度。
根据实际情况设置查询条件后，单击执行按钮。数据列表区域将显示通知发送的具体信息。同时在页末会显示查询任务的执行结果。
##### 策略生效统计信息查询 
概述 :本节介绍查询指定用户策略生效事件的方法。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  RCP策略管理页面

选择菜单日志报表查询→策略生效统计信息查询
，弹出策略生效统计信息查询页面，如[图2]所示。
图2  策略生效统计信息查询页面

策略生效统计信息查询参数说明参见[表1]。
参数名称|参数说明
---|---
MSISDN|该参数用于指定目标用户的MSISDN。每次查询操作只支持查询单个用户的策略生效事件。
查询时间|该参数用于指定策略生效事件发生的起止时间。起止时间最大支持30天时间跨度。
根据实际情况设置查询条件后，单击执行按钮。数据列表区域将显示策略生效事件的具体信息。同时在页末会显示查询任务的执行结果。
##### 业务变更历史信息查询 
概述 :本节介绍查询指定用户业务变更历史的方法。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  RCP策略管理页面

选择菜单日志报表查询→业务变更历史信息查询
，弹出业务变更历史信息查询页面，如[图2]所示。
图2  业务变更历史信息查询

业务变更历史信息查询参数说明参见[表1]。
参数名称|参数说明
---|---
MSISDN|该参数用于指定目标用户的MSISDN。每次查询操作只支持查询单个用户的业务变更历史。
查询时间|该参数用于指定用户业务变更发生的起止时间。起止时间最大支持30天时间跨度。
根据实际情况设置查询条件后，单击执行按钮。数据列表区域将显示该用户业务变更历史的具体信息。同时在页末会显示查询任务的执行结果。
##### 策略签约趋势查询 
概述 :本节介绍查询指定的套餐签约情况的方法。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  RCP策略管理页面

选择菜单日志报表查询→套餐签约趋势查询
，弹出套餐签约趋势查询页面，如[图2]所示。
图2  套餐签约趋势查询页面

套餐签约趋势查询参数说明参见[表1]。
参数名称|参数说明
---|---
套餐名称|该参数用于指定套餐的名称。套餐名称与签约参数保持一致。本查询结果可体现套餐在用户中的推广情况。
查询时间|该参数用于指定套餐签约情况发生的起止时间。起止时间最大支持30天时间跨度。
根据实际情况设置查询条件后，单击执行按钮。数据列表区域将显示该套餐在指定周期内的签约数量。同时在页末会显示查询任务的执行结果。
##### 策略历史查询 
概述 :本节介绍查询指定套餐的策略事件触发情况的方法。 
操作步骤 :登录RCP策略管理页面，如[图1]所示。
图1  RCP策略管理页面

选择菜单日志报表查询→策略历史查询
，弹出策略历史查询页面，如[图2]所示。
图2  策略历史查询页面

策略历史查询参数说明参见[表1]。
参数名称|参数说明
---|---
套餐名称|该参数用于指定套餐的名称。套餐名称与签约参数保持一致。本查询结果可体现套餐在用户中的使用情况。
查询时间|该参数用于指定套餐关联事件触发的起止时间。起止时间最大支持30天时间跨度。
根据实际情况设置查询条件后，单击执行按钮。数据列表区域将显示在指定周期内触发的与该套餐关联的策略事件的详情。同时在页末会显示查询任务的执行结果。
## 缩略语 
## 缩略语 
### 5QI 
5G QoS Indicator5G QoS指示
AF :Application Function应用功能
AMF :Access and Mobility Management Function接入和移动管理功能
APN :Access Point Name接入点名称
### ARP 
Allocation and Retention Priority分配保持优先级
### AVP 
Attribute Value Pair属性值对
BSF :Binding Support Function绑定支持功能
### BSID 
Base station identifier基站识别号
### CCR 
Credit Control Request信用控制请求
CHF :Charging Function计费功能
### CUI 
Chargeable User Identity用户计费标识
### DNAI 
DN Access Identifier数据网络接入标识符
EM :Element Management网元管理
### GBR 
Guaranteed Bit Rate保证比特率
### GFBR 
Guaranteed Flow Bit Rate保证流比特率
GPSI :Generic Public Subscription Identifier一般公共用户标识
HTTP :Hypertext Transfer Protocol超文本传输协议
IMEI :International Mobile Equipment Identity国际移动设备标识
### IMEISV 
International Mobile Equipment Identity and Software Version number国际移动设备识别码和软件版本号
IMS :IP Multimedia SubsystemIP多媒体子系统
IMSI :International Mobile Subscriber Identity国际移动用户标识
### IP-CAN 
IP Connectivity Access NetworkIP连通接入网
IP :Internet Protocol因特网协议
### MBR 
Maximum Bit Rate最大比特率
### MCC 
Mobile Country Code移动国家码
MSISDN :Mobile Station International Subscriber Directory Number移动台国际用户目录号
### NAI 
Network Access Identifier网络接入标识
NEF :Network Exposure Function网络开放功能
NRF :NF Repository Function网络仓储功能
PCC :Policy and Charging Control计费和策略控制
PCEF :Policy and Charging Enforcement Function计费和策略控制实施功能
PCF :Policy Control Function策略控制功能
PDU :Packet Data Unit分组数据单元
### QCI 
QoS Class IdentifierQoS类别标识
QoS :Quality of Service服务质量
RAT :Radio Access Technology无线接入技术
PCRF :Policy and Charging Rules Function策略和计费规则功能
RCP :Resource Control Platform资源控制平台
### RFSP 
RAT/Frequency Selection Priority无线/频率选择优先级
### RTCP 
Real-time Transport Control Protocol实时传输控制协议
### RTP 
Real-time Transport Protocol实时传输协议
S-NSSAI :Single Network Slice Selection Assistance Information单个网络切片选择辅助信息
SGSN :Serving GPRS Support Node服务GPRS支持节点
SMF :Service Management Function业务管理功能
Session Management Function会话管理功能
### SMSC 
Short Message Service Center短消息中心
### SOAP 
Simple Object Access Protocol简单对象访问协议
### SSC 
Session and Service Continuity会话与业务连续性
SUPI :Subscriber Permanent Identifier用户永久标识
### TAC 
Tracking Area Code跟踪区域码
### TDF 
Traffic Detection Function流量检测功能
### UBAS 
User Behavior Analysis System用户行为分析系统
UDM :Unified Data Management统一数据管理
UDR :Unified Data Repository统一数据存储
### ULI 
User Location Information用户位置信息
UPF :User Plane Function用户平面功能
### UPSC 
UE Policy Section CodeUE策略分片码
### URN 
Uniform Resource Name统一资源名
### URSP 
UE Route Selection PolicyUE路由选择策略
### VoLTE 
Voice over LTELTE语音
VoNR :Voice over New Radio新空口承载语音
## 安全加固 
### 加固说明 
#### 适用版本 
本文档适用于ZXUN RCP V7.23.xx及以上IAAS版本。
#### 五要素信息 
配置生效方式：无特殊说明的加固项为立即生效、其他在加固项中已经说明了加固生效方式，部分修改需要重启服务。 
用户生效方式：对在线用户和新接入用户都实时生效。 
业务影响范围：对部分网管服务增加了安全限制，对业务无影响。 
告警情况：正常操作无告警，操作异常可能产生网元断链告警，请严格按照指导书操作，不确认的地方及时联系中兴通讯技术支持。 
是否全网首次操作：除特殊场景为首次操作外，其他加固项2C局点已实施，2B局点为全网首次操作。 
注意事项 :部分加固项在虚机重启/重建等操作后会丢失，丢失后需要重新加固。涉及加固项参见下表： 
编号|加固项|场景|影响|处理策略
---|---|---|---|---
1|配置合规加固|虚机重启|无影响|不涉及
虚机重建|1|配置合规加固|所有加固配置全部丢失|重新执行加固。后续使用EMS 3.1工具加固可以解决。
操作系统补丁升级|1|配置合规加固|部分配置、22端口版本号加固丢失|重新执行加固。后续使用EMS 3.1工具加固可以解决。
### 数据备份 
#### 备份Rosng数据 
摘要 :Rosng配置必须执行write操作并等待存盘完成。如果没有执行write操作，设备重启后，配置数据会丢失。 
如果数据备份后对配置数据又进行了修改，则必须重新进行配置数据备份。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中展开PCF节点。
选择菜单CommonS_TMSP_0→Rosng配置管理→router配置
，进入Rosng配置界面。
执行[write]命令，保存当前配置数据。
执行[show running-config]命令，将返回结果拷贝出来保存备份。
#### 备份配置数据 
摘要 :如果数据备份后对配置数据又进行了修改，则必须重新进行配置数据备份。 
步骤 :在EM客户端，选择菜单配置→命令终端→命令处理
，在左侧导航树中选择待升级的网元节点。
执行备份命令：[BACKUP]:ID=1,NAME="default"。
在“操作记录”中确认数据备份成功。如果备份数据命令执行失败，参考“[CCMF的NFS进程检查和修复]”，进行进一步检查。
将备份的文件下载到本地保存。 
### 各账户初始密码加固 
 小心！ 
所有密码修改后务必保存，定期更换，如果遗忘无法恢复。 
#### 操作系统账户密码修改 
默认账户|默认密码|修改方法|备注
---|---|---|---
root|ZTE_ossdbg1|通过EM中的SET PASSWD命令设置|操作系统root账户密码支持字符：大写字母、小写字母、数字、下划线
admin|Admin_123|通过EM中的SET PASSWD命令设置|操作系统admin账户密码支持字符：大写字母、小写字母、数字、下划线
zte_v6pf_inner|ZTE_v6pwd|通过EM中的SET PASSWD命令设置|虚拟机内部经控制面下载版本的SFTP账户密码支持字符：大写字母、小写字母、数字、下划线
 说明： 
如果密码修改后需要恢复到原来的密码，使用[SET PASSWD]命令可以修改回原密码。
从V7.20.22及之前版本直接升级到此版本，无论在升级前版本是否修改过admin用户密码，升级到此版本后首次执行admin用户密码修改时，原密码入参必须是默认密码Admin_123。 
#### OAM超级账户密码修改 
默认账户|默认密码|修改方法|备注
---|---|---|---
admin|Z_tywg_2019|通过7788端口/OAM-WEB使用SET PASSWORD修改，或第一次登录时修改。|OAM超级账户密码支持字符：大写字母、小写字母、数字、下划线
 说明： 
如果密码修改后需要恢复到原来的密码，则需执行如下步骤： 
执行命令[SET ACCT RULE]:PWDREPEATPERIOD=0,PWDREUSES=1，改变密码策略。
执行命令[SET PASSWORD]，将密码修改为原密码。
执行命令[SET ACCT RULE]:PWDREPEATPERIOD=90,PWDREUSES=3，恢复密码策略。
#### OAM内控账户和SFTP账户密码修改 
默认账户|默认密码|修改方法|备注
---|---|---|---
postgres|oam_PG_7e3_0c_1c|通过7788端口/EM使用SET ACCOUNTPASSWD命令，将账号类型设置为ACCOUNT_DB，即数据文件账户。|Postgre数据库的默认用户密码支持字符：大写字母、小写字母、数字、下划线
ems|ZTE_oamdbg_1|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
ndf|ZTE_oamdbg_2|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
inner-ndf|U_tywg_2018|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
cn-5g-inner-oper|U_tywg_2018|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|OAM SFTP默认用户，对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
rule_import|ZTE_1234_rule|通过7788端口/EM使用SET SFTP PASSWORD命令设置。|中盈网管专用（中国电信物联），对应端口29029密码支持字符：大写字母、小写字母、数字、下划线
 说明： 
如果密码修改后需要恢复到原来的密码，使用[表3]中“修改方法”列的对应命令就可以修改回原密码。
### 合规扫描加固 
#### 安全加固需求 
根据CORE-v5.04的合规配置规范加固OMU操作系统。 
#### 安全加固实施方法 
针对不同运营商，执行对应的加固脚本。
中国移动：security_enhance_OMM_20230320_CM 
电信：security_enhance_OMM_20230320_CT 
联通：security_enhance_OMM_20230320_CU 
 说明： 
国际项目如有特殊安全加固需求，联系中兴通讯技术支持
。
以执行加固脚本security_enhance_OMM_20230320_CM为例，操作步骤如下。
拷贝文件到/home/admin目录下，并获取root权限。 
`[admin@localhost ~]$ su
Password: 
[root@localhost admin] ` 
给脚本添加可执行权限。 
`[root@localhost admin]chmod +x security_enhance_OMM_20230320_CM` 
执行脚本初始化。 
`[root@localhost admin] ./security_enhance_OMM_20230320_CM -i
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准
init security_enhance_config begin
init security_enhance_config end

//注意：若打印以下[WARN]回显，则说明之前已经初始化过，根据情况输入正确交互信息（建议输入no）：
[root@localhost admin] ./security_enhance_OMM_20230320_CM -i
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4
init security_enhance_config begin
[WARN]If you reinitialize the tool,the rollback function will not be available (yes/no)  
//yes：执行此次初始化，且此次初始化之前的加固操作无法回退，只能实现此次之后的加固操作回退。
//no（推荐）：不执行此次初始化，之前加固操作仍能回退。继续后续加固操作即可。
init security_enhance_config end` 
执行加固前检查是否有待加固项。 
`[root@localhost admin] ./security_enhance_OMM_20230320_CM -c
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准` 
…… 
如果以下项目全部满足，则不需要再执行加固。 
检查结果全部为ok。 
No.12项：hosts.allow已包含OMU自身所有网络平面（见回显的ifconfig打印）。 
No.13项：OpenSSH版本号已隐藏。 
若以上项目未全部满足，则继续执行后续加固。 
执行加固。 
执行默认加固项。 
`[root@localhost admin] ./security_enhance_OMM_20230320_CM -s
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准
security_enhance ENTIRE  begin
security_enhance_sshd begin
security_enhance_sshd end
security_enhance_vsftpd begin
mkdir: cannot create directory ‘/etc/vsftpd/’: File exists
sed: cannot stat /etc/vsftpd/user_list: No such file or directory
sed: cannot stat /etc/vsftpd/ftpusers: No such file or directory
security_enhance_vsftpd end
……（过程略）
Note: This output shows SysV services only and does not include native
      systemd services. SysV configuration data might be overridden by native
      systemd configuration.

      If you want to list systemd services use 'systemctl list-unit-files'.
      To see services enabled on particular target use
      'systemctl list-dependencies [target]'.
……（过程略）
security_enhance_whitelist begin
security_enhance_whitelist end
security_enhance_sshversion begin
length:11
ssh version length is normal!
security_enhance_sshversion end
security_enhance ENTIRE  end
//注：加固过程会出现“No such file or directory”、“File exists”、“Note:”等提示，无需处理。` 
执行手工加固项。 
`[root@localhost admin] ./security_enhance_OMM_20230320_CM -s manual
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准` 
执行加固后检查。 
`[root@localhost admin] ./security_enhance_OMM_20230320_CM -c
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4  //操作系统版本号，以实际为准` 
…… 
如果以下项目全部满足，则当前虚机加固结束。 
检查结果全部为ok。 
No.12项：hosts.allow已包含OMU自身所有网络平面（参见回显的ifconfig打印）。 
No.13项：OpenSSH版本号已隐藏（如上图所示）。 
若以上项目未全部满足，保存/home/admin/log目录，并联系中兴通讯技术支持
。
 说明： 
如果存在主备OMU虚机，则主备OMU虚机都需要执行上述加固操作。 
加固后若虚机重建，需要再次执行加固。 
安全加固后需要按照“HTTPLB-SO加载失败（HTTPLB虚机扩容、重启、升级、整局重启等操作）”对HTTPLB_SO加载进行检查。 
合规加固回退办法。
回退方法以security_enhance_OMM_20230320_CM为例。
脚本提供两种回退方式，根据实际情况选择其中一种方式进行回退。 
方式一：回退到最近一次加固前的状态。[root@localhost admin]# ./security_enhance_OMM_20230320_CM -r
Now your CGSL version is TAG_CGS_CORE_V5_04_F34B4
security_enhance_rollback_ENTIRE begin
security_enhance_rollback_ENTIRE end 
方式二：回退到指定时间戳前的状态。[root@localhost admin]# ./security_enhance_OMM_20230320_CM -r list
Now your CGSL version is TAG_CGS_CORE_V5_04_F25B5
security_enhance_rollback_ENTIRE begin
1.20220222144948  //加固时间戳，脚本每次执行-s加固时会记录一个时间戳
2.20220222145301
3.20220222145327
Please select[1-3]?1   //根据实际情况，输入时间戳编号，回退到指定时间戳前的状态
security_enhance_rollback_ENTIRE end 
回退后检查。 
`[root@localhost admin] ./security_enhance_OMM_20230320_CM -c
//回退后检查，配置应回退到加固前状态` 
#### 其他命令参考 
以security_enhance_OMM_20230320_CM脚本为例： 
命令帮助./security_enhance_OMM_20230320_CM -h  
单项检查（以whitelist项举例，其他单项可通过-h帮助查询）./security_enhance_OMM_20230320_CM -c whitelist 
单项加固（以whitelist项举例）./security_enhance_OMM_20230320_CM -s whitelist  
单项回退到最近一次加固前的状态（以whitelist项举例）./security_enhance_OMM_20230320_CM -r whitelist  
单项回退到指定时间戳前的状态（以whitelist项举例）./security_enhance_OMM_20230320_CM -r whitelist list 
打包加固时的备份文件（TrouShoot.tar.gz）./security_enhance_OMM_20230320_CM -ts  
查看加固标签（含版本、最近一次时间戳信息）cat /home/admin/security_enhance.conf 
### 操作系统加固 
操作系统补丁升级需按现网规划执行，联系中兴通讯技术支持
获取最新镜像补丁升级指导文档。
### 特殊场景加固 
本节中标注（可选）的加固内容为特殊场景使用，若没有明确要求，则不执行本节的加固内容。 
#### 开启非root功能（可选） 
概述 : 说明： 
该功能会影响性能，若运营商无明确需求，不建议开启。 
如果需要开启本功能，联系中兴通讯技术支持
。
##### 检查非root功能是否开启 
执行命令[SHOW RUNASROOT]，查询是否以root用户启动VRUs。
命令执行结果示例如下： 
`(No.1) : SHOW RUNASROOT:


操作维护       是否启用 
------------------------
修改           是       
------------------------
记录数：1` 
命令执行结果中的参数取值说明如下： 
是：以root用户启动VRUs。表示非root功能未开启。 
否：以非root用户启动VRUs。表示非root功能已开启。 
##### 开启非root功能 
执行命令[SET RUNASROOT]:ENABLE="NO"，弹出危险提示对话框，如下图所示。
图1  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图2  危险提示对话框

单击确定按钮。
##### 回退方法 
执行命令[SET RUNASROOT]:ENABLE="YES"，弹出危险提示对话框，如下图所示。
图3  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图4  危险提示对话框

单击确定按钮。
#### 开启SELinux功能（可选） 
概述 : 说明： 
该功能会影响性能，若运营商无明确需求，不建议开启。 
如果需要开启本功能，联系中兴通讯技术支持
。
当前镜像（或已打补丁）版本为CGS-Linux-CORE.V5.04.F16P9或P9以上。 
##### 检查SELinux功能是否开启 
执行命令[SHOW SELINUX]，查询是否已开启SELinux功能。
命令执行结果示例如下： 
`(No.1) : SHOW SELINUX:


操作维护       是否启用 
------------------------
修改           是       
------------------------
记录数：1` 
命令执行结果中的参数取值说明如下： 
是：容器在SELinux系统下运行。表示SELinux功能已开启。 
否：容器不在SELinux系统下运行。表示SELinux功能未开启。 
##### 开启SELinux功能 
执行命令[SET SELINUX]:ENABLE="YES"，弹出危险提示对话框，如下图所示。
图1  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图2  危险提示对话框

单击确定按钮。
##### 回退方法 
执行命令[SET SELINUX]:ENABLE="NO"，弹出危险提示对话框，如下图所示。
图3  危险提示对话框

单击确定按钮。
执行命令[RESET SYSTEM]，重启整个系统。弹出危险提示对话框，如下图所示。
图4  危险提示对话框

单击确定按钮。
#### 设置远程访问白名单-hosts文件方式（可选） 
概述 :/etc/hosts.allow和/etc/hosts.deny两个文件用于控制远程访问，可以允许或者拒绝某个IP或者IP段访问Linux的某项服务。
 说明： 
必须先配置hosts.allow，且hosts.allow已包含所有白名单IP后，才能配置hosts.deny。
必要网段白名单列表，参见[表1]。
类别|说明
---|---
OMU所有网络平面|OMU上ifconfig -a | grep inet命令查询到的的所有平面。包括OMU上管理面、业务面和OAM网络平面的IPv4和IPv6地址段。配置示例参考“hosts.allow配置示例（未包含外部IP）”。此项配置也可通过合规扫描加固中的脚本自动添加。
OMU回环地址和localhost|localhostIPv4的回环地址：127.0.0.1。IPv6的回环地址：[::1]。此项配置也可通过合规扫描加固中的脚本自动添加。
外部IP或网段|外部4A\MANO\EMS\客户端的IP或网段：需现场维护人员自行查询，务必和用户确认，保证其准确性。
操作步骤 :通过SSH登录主备OMU，切换为root用户。 
备份文件。 
`cp -a /etc/hosts.allow /etc/hosts.allow.bak
cp -a /etc/hosts.deny /etc/hosts.deny.bak` 
执行命令[vi /etc/hosts.allow]，修改/etc/hosts.allow。
将所有的白名单IP增加到文件/etc/hosts.allow中，格式如下： 
IPv4格式： 
`all:192.168.4.44:allow  放通单个IP
all:192.168.1.:allow  放通192.168.1整个网段，注意地址段后有一个英文字符“.”` 
IPv6格式： 
`all:[3ffe:505:2:1::44]:allow  放通单个IP
all:[3ffe:505:2:1::]/64:allow  放通3ffe:505:2:1::整个网段` 
修改后，执行命令[cat /etc/hosts.allow]，检查是否已包含上面的白名单IP网段。
现网需要根据实际白名单地址进行配置。 
执行命令[vi /etc/hosts.deny]，修改/etc/hosts.deny文件。
`文件最后添加一行
all:all` 
 说明： 
此项设置后立刻生效，务必在完成hosts.allow的白名单配置后再进行此项配置。此项生效后，将只允许hosts.allow配置的白名单IP网段访问。
修改后，执行命令[cat /etc/hosts.deny]，检查文件最后一行是否为：all:all。
##### 回退步骤 
 说明： 
必须先回退hosts.deny，再回退hosts.allow。
执行命令[cp -a /etc/hosts.deny.bak /etc/hosts.deny]，回退hosts.deny。
回退后，务必再执行命令[cat /etc/hosts.deny]检查一下，确保没有all:all字段。
执行命令[cp -a /etc/hosts.allow.bak /etc/hosts.allow]，回退hosts.allow。
#### 配置远程日志功能（可选） 
配置步骤 :执行命令[cp -a /etc/rsyslog.conf /etc/rsyslog.conf.bak]，备份文件。
通过命令[vi /etc/rsyslog.conf]，修改配置文件rsyslog.conf。
对于IPv4，增加如下一行。 
`*.*                    @@192.168.0.1:514` 
对于IPv6，增加如下一行。 
`*.*                    @@[2409:8086:8413:2c5e::80:10]:514` 
根据日志转存要求，可以将“*.*”替换为实际需要的日志信息。比如：kern.* ; mail.* 等。*.*为全部转存。 
这里的192.168.0.1以及2409:8086:8413:2c5e::80:10均为样例，需要填写实际的日志服务器地址。 
 说明： 
@@表示TCP传输，@表示UDP传输，根据服务端开启的传输方式决定。 
514为服务端开启的端口号，需要与服务端确认。 
执行命令[systemctl restart rsyslog.service]，重启rsyslog服务，使服务生效。
##### 回退步骤 
执行命令[cp -a /etc/rsyslog.conf.bak /etc/rsyslog.conf]，恢复文件。
执行命令[systemctl restart rsyslog.service]，重启rsyslog服务，使服务生效。
#### 手动处理绿盟等保合规问题 
概述 :如果外场不是使用绿盟等保进行合规或未报对应问题，则无需操作此步骤。 
如果外场使用绿盟等保进行合规扫描，反馈在“[合规扫描加固]”操作后遗留不合规项，则按照下文方法进行处理。
##### 检查系统内核参数配置 
检查配置项|描述
---|---
50|检查系统内核参数配置
加固脚本是包含此加固项的，但在CGSL P6和P8系统上，通过脚本加固后该配置项没有生效，需要再手工执行[sysctl -p]命令使加固生效。
##### 检查是否使用PAM认证模块禁止wheel组之外的用户su为root 
图1  检查是否使用PAM认证模块禁止wheel组之外的用户su为root

加固后即可实现“使用PAM认证模块禁止wheel组之外的用户su为root”，但绿盟的检查没有包含所做的配置，导致误报。 

##### 检查重要目录或文件权限配置 
图2  检查重要目录或文件权限配置

CGSL建议不加固，因为加固该配置项会导致系统出现异常。 
检查重要目录或文件权限设置
/tmp文件权限是否符合规范检查标准750。现在默认为777但tmp目录不能改为750，因为改为750会导致系统出现异常。 
/etc/xinetd.conf文件权限是否符合规范，CGSL P6系统中没有这个文件属于误报。 
##### 检查重要文件属性设置 
图3  检查重要文件属性设置

检查/etc/gshadow文件属性 
检查/etc/passwd文件属性 
检查/etc/group文件属性 
检查/etc/shadow文件属性 
修改上述这几个文件添加i参数，后面会导致无法创建用户，也无法修改密码的情况，出现密码到期，也无法修改密码。因此不建议修改上述几个文件的属性。 
##### 检查是否设置口令过期前警告天数 
图4  检查是否设置口令过期前警告天数

该项在加固脚本里已经加固，但天数不一致，可以直接修改为目标天数30，执行如下命令： 
[sed -i 's/PASS_WARN_AGE.*/PASS_WARN_AGE 30/g' /etc/login.defs]
再执行命令[cat /etc/login.defs |grep PASS_WARN_AGE]，检查配置是否正确。
### 加固后验证 
加固验证项目|加固验证步骤|验证结果
---|---|---
直连接口|检查使用SSH方式接入是否成功（22、7722、7788）。|通过
SFTP|检查使用SFTP方式上传下载是否成功。|通过
EM接入检查|检查EM分层接入是否成功。在EM的分层接入界面进行同步操作，同步成功则通过。|通过
配置|检查配置功能是否正常，比如执行一个MML命令，命令正常执行。|通过
告警|检查告警上报功能是否正常，检查加固前后有无新的告警出现，如果出现新告警需要确认是否由加固导致。|通过
信令跟踪|检查信令跟踪功能是否正常。|通过
性能统计|检查性能统计数据上报是否正常。|通过
基本业务检查|加固后，执行基本业务检查，基本业务是否接入正常，数据业务是否正常。|通过
EM的RCP策略管理|在EM客户端的配置→RCP策略管理或配置→核心网业务管理→RCP策略管理页面，选择加固后的网元，单击管理按钮，可以正常弹出策略管理界面。|通过
### 参考 
#### CCMF的NFS进程检查和修复 
登录OMU虚机1，使用su命令（不要使用su - root命令）切换到root用户。 
执行命令：[docker exec -it vru-oam-ccmf-0 sh]，进入主用CCMF容器。
执行命令：[hexdump /dev/shm/vru-oam-ccmf_VNFP_PLAT_STATE]，确认当前CCMF容器是否为主用。
上图中红色框中的0001即代表主用。如果当前容器不是主用，则登录到另外一个MPU虚机。
检查CCMF上NFS的注册信息。 
执行命令：[ps -ef|grep cmservice]
命令返回结果如下图所示，每个nfs_X对应一个服务，仔细核对nfs个数，应该和EM上配置命令树挂载的服务个数相同。如果存在缺失，则需要执行后续的步骤进行修复。 

修复CCMF的NFS进程。修改脚本为restoreCCMF.sh。
将脚本restoreCCMF.sh通过sftp分别上传到MPU虚机1和MPU虚机2的/home/admin目录下。
登录MPU虚机1，执行如下操作。 
执行命令[su]切到root用户下。
执行命令[cd /home/admin]。
执行命令[chmod 777 restoreCCMF.sh]，给脚本restoreCCMF.sh赋予权限。
执行命令[./restoreCCMF.sh]，执行修复脚本restoreCCMF.sh。
登录MPU虚机2，执行如下操作。 
执行命令[su]切到root用户下。
执行命令[cd /home/admin]。
执行命令[chmod 777 restoreCCMF.sh]，给脚本restoreCCMF.sh赋予权限。
执行命令[./restoreCCMF.sh]，执行修复脚本restoreCCMF.sh。
等待2~5分钟，脚本执行完毕后，再参考步骤2检查NFS进程是否启动完整。 
执行备份命令，例如： 
[BACKUP]:ID=1,NAME="default",FILEPATH="sftp://10.43.169.77/backup",USERNAME="root",PASSWORD="**********",FILENAME="cm_backup_1108"
如果数据备份成功，则表示CCMF的NFS进程启动完整，即修复成功。 
#### hosts.allow配置示例（未包含外部IP） 
OMU上 ifconfig -a | grep inet查到的IP网段|/etc/hosts.allow对应配置|说明
---|---|---
inet 172.17.0.1  netmask 255.255.0.0  broadcast 0.0.0.0|all:172.17.:allow|该地址掩码为255.255.0.0，增加的配置要与该掩码相匹配。
inet6 fe80::f816:3eff:fe72:8e2b  prefixlen 64  scopeid 0x20<link>inet6 fe80::f816:3eff:fe9c:9928  prefixlen 64  scopeid 0x20<link>inet6 fe80::f816:3eff:fe4c:68b9  prefixlen 64  scopeid 0x20<link>|all:[fe80::]/64:allow|该组地址网段相同，掩码都为64位，因此可只增加一条配置。
inet6 2409:8086:8618:2af9::1  prefixlen 64  scopeid 0x0<global>|all:[2409:8086:8618:2af9::]/64:allow|该地址掩码为64位，增加的配置要与该掩码相匹配。
inet6 2409:8086:8618:2afa::1  prefixlen 64  scopeid 0x0<global>|all:[2409:8086:8618:2afa::]/64:allow|该地址掩码为64位，增加的配置要与该掩码相匹配。
inet6 2409:805b:5a06:1608::111:101  prefixlen 124  scopeid 0x0<global>inet6 2409:805b:5a06:1608::111:102  prefixlen 124  scopeid 0x0<global>|all:[2409:805b:5a06:1608::]/64:allow|该组地址网段划分的比较细，掩码为124位，地址段比较小，增加的配置可适当放大一些到64位，避免后续再增加地址时的麻烦。
inet 10.242.225.26  netmask 255.255.255.248  broadcast 10.242.225.31inet 10.242.225.25  netmask 255.255.255.248  broadcast 10.242.225.31|all:10.242.225.:allow|该组地址网段划分的比较细，掩码为 255.255.255.248，地址段比较小，增加的配置可适当放大一些到255.255.255.0，避免后续再增加地址时的麻烦。
inet 127.0.0.1  netmask 255.0.0.0|all:127.0.0.1|增加IPv4回环地址的配置。
inet6 ::1  prefixlen 128  scopeid 0x10<host>|all:[::1]|增加IPv6回环地址的配置。
-|all:localhost|增加localhost配置。
#### HTTPLB-SO加载失败（HTTPLB虚机扩容、重启、升级、整局重启等操作） 
 小心！ 
联系中兴通讯技术支持
确认后才能实施以下操作。
将工具软件包zinspect20230508.zip上传到EM第三节点的/home/ubuntu目录下。
通过SSH方式登录CNIA第三节点，切换到root权限，执行解压命令（默认用户密码为ubuntu/UbuntU1!2@3#4$）。
执行以下命令增加可执行权限。 
`chmod +x zinspect
chmod +x zinspect.sh` 
执行以下命令检查HTTPLB_SO加载。 
 说明： 
将EM浮动地址与需要检查的网元名称替换到如下命令中，注意网元名称大小写敏感 
`sh zinspect.sh http://EM浮动地址:29999 网元名称` 
若步骤执行后未出现error或者reset打印，则表示检查通过。若出现error或者reset打印，参考以下方法进行处理。 
场景1：HTTPLB-SO加载缺失修复措施：执行命令重启SO加载异常的容器，修复后重新检查。命令：RESET SC:NFSNAME="CommonS_HTTP_LB_0",SCTYPE="sc-http-lb",SCGROUPNUM=1,SCINTRAGROUPNUM=0;图1  场景1示例 
场景2：EM端口填写错误处理措施：填写正确端口后再次执行脚本。图2  场景2示例 
场景3：EM第三节点IP填写错误处理措施：填写正确IP后再次执行脚本。图3  场景3示例 
场景4：网元名称填写错误处理措施：填写正确网元名称后再次执行脚本。图4  场景4示例 
场景5：网元与EM断链处理措施：联系中兴通讯技术支持。图5  场景5示例 
