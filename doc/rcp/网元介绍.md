# 网元介绍 
## 产品描述 
### 产品定位与特点 
#### 产品定位 
##### 在网络中的角色 
ZXUN RCP产品融合了5G核心网中的PCRF和PCF网元功能，是中兴通讯5G融合核心网中一个重要设备，主要为移动网络提供策略控制。
ZTE 5G核心网基于3GPP标准，面向增强型移动宽带业务（eMBB）、大规模的机器通信业务（mMTC）、超可靠低时延通信业务（URLLC）等应用场景，开发下一代全融合核心网产品，提供网络切片、移动边缘计算、按需重构的移动性、能力开放等代表性的服务能力。充分利用NFV、SDN、云计算、大数据等先进技术，创造架构领先、性能领先、成本领先的核心网产品。
##### 在2G/3G/4G网络中的位置 
在2G/3G/4G网络系统中，ZXUN RCP支持PCRF（策略和计费规则功能），在网络中的位置如[图1]所示。
图1  ZXUN RCP在2G/3G/4G网络中的位置

网元|功能
---|---
AF|应用功能。AF提供业务应用，向PCRF提供会话信息，请求PCRF对用户平面进行动态的策略/计费控制，并从PCRF获取承载事件报告。
HSS|归属用户服务器，用于存储用户签约信息和鉴权数据。
MME|移动管理实体，是3GPP协议LTE接入网络的关键控制节点，负责信令处理。
OCS|在线计费系统，OCS提供在线信贷控制功能。
PGW|分组数据网网关，负责UE接入PDN，分配用户IP地址，同时也是3GPP和非3GPP接入系统的移动性锚点。
PCRF|策略和计费规则功能，主要根据业务信息和用户签约信息以及运营商的配置信息产生控制用户数据传递的QoS规则以及计费规则。
SGSN|服务GPRS支持节点，负责分组域业务的控制、处理和转发。
SGW|信令网关，是一个用户面实体，负责用户面数据路由处理，终结处于空闲状态的UE下行数据。
SPR|用户签约数据库，PCRF依据从SPR获取的PCC信息，对用户进行策略控制。
TDF|流量检测功能，进行业务级别的策略控制。
##### 在5G网络中的位置 
在5G网络系统中，ZXUN RCP支持PCF（策略控制功能），在网络中的位置如[图2]所示。
图2  ZXUN RCP在5G网络中的位置

NF|功能
---|---
AF|应用功能。AF提供业务应用，向PCF提供会话信息，请求PCF对用户平面进行动态的策略/计费控制，并从PCF获取承载事件报告。
AMF|接入及移动性管理功能。完成用户的移动性管理，维护用户注册及连接状态、NAS SM信令路由、安全处理等。
AUSF|鉴权服务器功能。为其他NF提供用户鉴权功能。
BSF|绑定支持功能。维护PCF绑定信息，提供RCP绑定信息的注册、更新、注销、查询接口。
CHF|计费功能。PCF从CHF获取消费门限信息。
NRF|NF存储功能。维护已部署NF信息，对NF发现请求进行应答。
NSSF|网络切片选择功能。用于为用户选择为其提供网络服务的网络切片实例，如eMBB切片。
PCF|策略控制功能。支持统一策略控制框架，提供策略规则给其他NF，进行接入和移动性策略控制、会话策略控制，对AF资源请求进行授权。
SMF|会话管理功能。终结NAS SM信令，完成会话管理、UE IP地址分配及管理、UPF选择、会话策略控制等。
UDM|统一数据管理。管理和存储用户签约及鉴权数据。
UDR|统一数据存储功能。PCF从UDR获取策略签约数据，保存动态策略数据，或向UDR订阅涉及多PDU会话的AF影响业务路由请求。
UPF|用户面功能。完成PDU会话用户面数据转发、QoS及策略执行、用量上报、计费信息上报等功能。
#### 产品特点 
##### 良好的兼容和可扩展性 
服务化架构ZXUN RCP基于云原生架构，遵从3GPP R15引入的服务化体系架构。ZXUN RCP引入了服务化接口，并且继承了2G/3G/4G传统接口。 
无状态ZXUN RCP采用了无状态设计，将数据层和业务逻辑层分离。系统受益于无状态设计，使得弹缩、升级、恢复和扩容更为容易。 
网络切片网络切片是一个端到端的逻辑网络，目前由核心网子切片、IP承载网子切片和无线接入网子切片组成，未来可能会把更多的资源放进切片，例如终端、管理网元以及ISP服务站点等。从编排部署的角度看，切片的编排部署，就是每个子切片的编排部署以及子切片之间网络连接关系的部署。 
##### 融合部署 
ZXUN RCP融合了3GPP为2G/3G/4G网络定义的PCRF以及为5G网络定义的PCF。PCRF和PCF能够共享相同的平台和相同的管理系统。
ZXUN RCP支持2G/3G/4G/5G/WiFi接入下的统一策略和计费控制。
ZXUN RCP支持5G网络演进下的NSA架构和SA架构。
##### 全面的运维系统 
ZXUN RCP具有动态管理、定期维护、MML导航、跟踪工具（包括信令跟踪、故障诊断）、故障管理以及性能管理等功能。基于这些功能，系统提供多种操作和维护手段，优势在于精确、可靠、实用和便捷。
##### 电信级高可用性 
ZXUN RCP的架构确保系统没有单点故障。
 说明： 
单点故障是指系统中一个节点发生故障，会使整个系统无法运作的故障。 
ZXUN RCP的内部组件可支持1+1主备工作模式或N+M负荷分担工作模式。
ZXUN RCP支持地理容灾，包括主备、互备以及Pool模式的容灾备份。 
##### 丰富的策略管理 
ZXUN RCP能够提供丰富的策略控制规则，并且可以作出多种策略决策和控制措施。
ZXUN RCP能够基于如下多种条件定义策略规则：
用户订购信息（用户等级、允许的业务） 
用户标识（MSISDN/IMSI/SUPI/GPSI） 
业务类型 
APN/DNN 
网络切片 
网络接入类型（2G/3G/4G/5G） 
位置 
日期和时间 
用量（用户消耗的流量、时长、点击次数） 
ZXUN RCP可以作出如下多种策略决策和控制措施：
QoS控制 
通知 
门控 
计费控制 
IP地址分配策略 
UE路由选择策略 
无线接入类型/频率选择策略 
业务区限制策略 
接入网络发现和选择策略 
### 产品结构 
ZXUN RCP是中兴通讯5G核心网解决方案中的一个重要的NF，遵从ETSI NFV规范。ZXUN RCP系统架构如[图1]所示。
图1  系统架构

功能分类|功能实体|产品名称|功能描述
---|---|---|---
运营支撑|OSS/BSS|-|综合的业务运营和管理平台，由网络管理、系统管理、计费、营业、账务和客户服务等部分组成。
统一网元管理|EM|NetNumen U31或ElasticNet UME|提供对ZXUN RCP的日常管理和维护。
网络功能|RCP|ZXUN RCP|资源控制平台，ZXUN RCP支持PCRF和PCF功能。
MANO|NFVO|CloudStudio或ElasticNet UME R50s|负责全网的网络服务、虚拟资源以及物理资源的编排和管理功能。
VNFM|MANO|负责ZXUN RCP的生命周期管理。|CloudStudio或ElasticNet UME R50s
VIM|MANO|TECS OpenStack|NFVI的管理模块。VIM是虚拟化基础设施管理系统，负责基础设施层硬件资源、虚拟化资源的管理，监控和故障上报，面向上层应用提供虚拟化资源池。VIM为NFVO和VNFM提供VNF相关虚拟资源的操作接口。VIM作为云平台管理虚拟资源，常见的VIM包括：TECS、VMware、OpenStack。
NFVI|Hypervisor|TECS OpenStack|虚拟机监视器，提供软件管理虚拟机对底层硬件的访问。
Hardware|NFVI|ZXCLOUD E9000|提供上层所需的计算、存储、网络功能。
ZXUN RCP的架构如[图2]所示。
图2  ZXUN RCP架构

虚机|描述
---|---
OMU|对接CN-OAM（核心网集中网管），管理整局上电、版本加载、配置同步、网管命令执行、告警和性能统计汇总、各服务弹缩控制等功能。
IPU|IP接口虚拟机，收发IP承载的控制面信令和用户面报文。
GSU（HTTP LB）|HTTP负荷分担服务，实现HTTP协议消息分发。
GSU（SIG LB）|信令负荷分担服务，实现Diameter和SMS消息分发。
GSU（PolicyControl）|处理PCF和PCRF业务逻辑，提供AMPolicyControl、UEPolicyControl、SMPolicyControl和PolicyAuthorization服务。
GSU（GW）|UDSF统一接入网关。
LOG|策略日志单元，产生策略日志并存入硬盘，并可通过SFTP上传给外部服务器。
LSU|策略日志存储单元，用于策略日志分析。
CDU|UDSF数据存储单元。
### 操作维护系统 
ZXUN RCP提供完善的操作和维护功能，支持通过NFVO和EM实施维护和管理。
ZXUN RCP常用的操作维护功能参见[表1]。
功能|描述
---|---
配置管理|ZXUN RCP的配置管理功能为网络资源的配置和管理提供了用户友好的界面，提供ZXUN RCP的集中化配置和管理功能，以及数据传输、数据备份和恢复工具。
系统数据备份和恢复|ZXUN RCP的系统数据维护功能用于备份和恢复系统数据，支持备份和恢复单个模块的数据或整个系统的数据。此外，在日志中，将详细记录备份和恢复的过程。
故障管理|ZXUN RCP的故障管理功能由两个部分组成，包括当前告警实时显示和告警相关操作。当前告警实时显示功能可以显示多种告警，并且可以列出每一个告警的详细内容，具体包括：告警源、告警等级、告警发生时间、告警内容、告警原因、告警类型以及附加信息。告警相关操作包括告警处理和告警设置。针对故障管理，ZXUN RCP提供标准SNMP接口，并通过该接口对接NMS（上一级网管系统）。
性能管理|ZXUN RCP的性能管理功能负责搜集和评估性能参数以及系统流量数据，用以表征ZXUN RCP的性能。性能评估任务可以在操作维护终端上定义，每一个性能评估任务包括开始时间、结束时间、任务持续天数、评估对象设置以及间隔时间等。性能管理任务支持创建、修改、删除等操作。
软件管理|ZXUN RCP的软件管理功能为运行在系统每个组件上的软件提供上传管理，并可查询相关信息，包括每个组件的版本号和版本类型。
诊断测试|ZXUN RCP的诊断测试功能是故障管理的功能之一。诊断测试提供ZXUN RCP的常规测试和应急测试，以确保系统能够有效平稳运行。在常规测试中，设备以及通信连接可以得到维护。如果测试结果不正常，维护人员需要关注并采用有效措施避免故障发生。一旦故障发生，维护人员可以通过应急测试找到故障原因，并尽快定位解决。在故障解决之后，维护人员可以通过诊断测试验证设备已经恢复，系统运行正常。
安全管理|ZXUN RCP可以提供独立的用户管理系统，用于管理用户的权限。用户权限可以分为三层：超级用户权限、操作员权限和浏览用户权限。用户可以按照其被授予的权限进行创建和管理。
日志管理|ZXUN RCP的日志管理功能提供操作日志、安全日志和系统日志等信息，以供维护人员进行查询。操作日志：任何操作员的可能带来系统修改的动作都将被记录在操作日志中。操作日志不支持修改。每一条操作日志记录操作员用户名，操作时间和操作内容。系统支持对操作日志的查询功能。安全日志：操作员的安全相关的事件（如用户的登入/登出）将记录在安全日志中。系统日志：由系统自动生成的操作事件将记录在系统日志中以便回溯。
跟踪管理|ZXUN RCP的跟踪管理功能包括信令跟踪和失败观察。 ZXUN RCP的信令流可以实时跟踪和解析，显示解码后的信令流。
文件管理|在ZXUN RCP产品中，系统版本文件以及配置文件等可以通过FTP/SFTP客户端或者文件系统进行上传和下载。
### 功能 
#### 策略条件功能 
ZXUN RCP的策略条件功能参见[表1]。
业务功能|描述|详细介绍参考
---|---|---
基于默认签约的策略|默认签约包括默认用户类型、默认套餐。运维人员可以为不同号段的用户或特定用户类型的用户配置默认签约，并配置基于默认签约的控制策略。用户上线时，RCP根据默认签约信息为用户激活默认策略。此外，RCP还提供全局套餐的配置。全局套餐是对所有用户都生效的默认套餐。在某些异常情况下用户获取不到个性化签约，为了给这些用户提供基本的QoS保障，RCP提供默认签约的配置以及基于默认签约的策略控制，为用户提供默认策略。|ZUF-59-42-001 基于默认签约的策略
基于SPR签约的策略|RCP能根据SPR签约实施个性化的策略和计费控制。用户在SPR签约的信息包含用户的基本信息、套餐信息、业务信息、用户组信息、用量阈值信息。基本信息：包含用户标识、SMS接收号码、Email地址、用户类型、用户起账日等。套餐信息：一个用户可以同时签约多个套餐，套餐信息包含套餐标识、套餐有效期、套餐优先级、套餐Homezone等。当一个用户同时签约多个套餐时，RCP可以根据套餐优先级决定使用顺序。业务信息：一个套餐可以对多个业务实施PCC控制，业务信息包含业务标识、业务等级、业务优先级等。一个用户的不同套餐可以控制相同业务，RCP可根据套餐中业务优先级决定该业务从属于哪个套餐。用户组信息：一个用户可以加入多个用户组，每个用户组上可以签约多个群组套餐。用量阈值信息：包含各种维度累计用量的实际值。|ZUF-59-42-002 基于SPR签约的策略
基于漫游的策略控制|RCP允许运营商定义本地区域和多个不同的漫游区域，在不同区域内实施差异化的策略控制。参考3GPP标准，漫游分为Home Routed和Local Breakout两种模式。Home Routed模式：此模式下，用户PDU会话终结在HPLMN的SMF。Local Breakout模式：此模式下，用户PDU会话终结在VPLMN的SMF。|ZUF-59-42-005 基于漫游的策略控制
基于时段的策略|时段策略是指RCP能基于时段提供差异化的控制策略，从而更好地引导用户使用网络。RCP可以将某个时段设置为系统忙/闲时段，或者将某个时段设置为某个套餐的忙/闲时段。RCP支持的时段设置非常灵活，能满足运营商不同的时段需求。基于日期：可以设置时段的开始日期和终止日期，例如2010年1月1号~2029年1月1号。基于时间：可以设置时段的开始时间和结束时间，例如00:08:00~00:20:00。基于星期：在日期的基础上，可以勾选星期几时段生效，例如2010年1月1号~2029年1月1号的周六、周日。基于第几天：在日期的基础上，可以勾选第几天时段生效，例如要求每个月1号时段生效，那么可以勾选第一天。|ZUF-59-52-001 基于时段的策略
基于PRA的策略控制|PRA通过PRA元素列表表示区域范围，RCP可以向SMF/AMF订阅某个用户进入或离开某个PRA的事件通知。当用户离开或进入PRA时，SMF/AMF会向RCP上报最新的PRA状态，RCP基于SMF/AMF上报的PRA状态实施策略和计费控制。PRA分为动态PRA和预定义PRA。对于动态PRA，RCP在订阅PRA事件通知时需要向SMF/AMF提供PRA标识及PRA元素列表。对于预定义PRA，RCP只要提供PRA标识，对应PRA元素列表在SMF/AMF预先配置。|ZUF-59-53-008 基于PRA的策略控制
基于累计用量的策略|基于累计用量的策略指，PCEF或SMF基于RCP的用量监控策略上报用量给RCP，RCP累计用量，并基于累计用量实施限速、计费控制或向用户发送短信或Email提醒。由于运营商最初采用包月不限流量等方式来拓展市场，对用户使用的业务没有限制，但P2P业务（点对点下载业务）的广泛传播，打破了原有的网络流量模型，20%的用户占用了网络80%的流量，使得大部分用户由于网络拥塞而无法满足通信需求，新业务难以发展。运营商希望通过基于使用量的动态策略控制业务，在一个固定的时间周期内，对用户的使用用量（以下简称用量）等进行累积，当用量累积达到的不同阈值，能够给用户发送短信或Email提醒，并对用户网络使用进行策略控制或调整，如限制或提高用户接入带宽等。|-
基于忙时、闲时的控制|网络通常忙时负荷重，闲时负荷轻。运营商希望通过时段策略来调节忙闲时网络负荷，例如：忙时对P2P等低价值业务限速，防止网络拥塞；推出闲时优惠套餐，引导用户增加闲时上网，减少忙时上网。此外，运营商也可能推出Happy Hour流量免费等基于时段的促销活动，或者和OTT厂商合作在指定时段对OTT业务流量免费。ZXUN RCP支持基于时段的策略和计费控制，按以下多维度组合定义一个时段。起始日期和结束日期起始时刻和结束时刻。每周的哪几天。每月的哪几天。每年的哪几个月。ZXUN RCP可以在时段切换点调整策略，也可以通过CCA-Initial消息携带的Rule-Active-Time和Rule-Deactive-Time提前将未来时段的PCC/QoS/ADC规则下发给PCEF/TDF，避免忙闲切换时间点产生大量的信令。|-
基于位置的控制和计费|ZXUN RCP能够基于PCEF上报的用户位置实施差异化策略控制。PCEF能够上报的具体用户位置包括：CGISAIRAITAIECGI3GPP2-BSID典型的应用场景例如：限制用户在体育场馆等人口密集区使用P2P业务或视频业务的带宽，以保障大多数人的上网体验。当用户在特定位置时，向其发送欢迎或促销短信。|-
#### 策略动作功能 
ZXUN RCP的策略动作功能参见[表1]。
业务功能|描述|详细介绍参考
---|---|---
业务重定向控制|业务重定向控制特性，是指控制业务数据流的上行流是否应该重定向到一个特定地址。RCP能够基于各种条件实施重定向或取消重定向。RCP通过下发PCC规则给SMF来实施重定向。如果下发的是动态PCC规则，RCP需要在规则中指定重定向地址；如果下发的是预定义PCC规则，需要在SMF中预配置重定向地址。RCP可以指示SMF采用一次重定向或永久重定向。一次重定向：SMF在收到重定向PCC规则后，只对相应业务中的下一次HTTP请求实施重定向，后续HTTP请求在本次会话内不再重定向。永久重定向：SMF在收到重定向PCC规则后，对相应业务的所有HTTP请求实施重定向，对其它非HTTP报文丢弃，直至重定向PCC规则删除。RCP支持重定向确认功能：签约接口确认和事件订阅确认。签约接口确认由SPR通知RCP；事件订阅确认由SMF通知RCP。当RCP收到确认后，记录重定向确认规则，并通知SMF网元删除重定向规则。|ZUF-59-53-004 业务重定向控制
接入和移动性策略控制|接入和移动性策略控制指的是RCP向AMF提供用于接入和移动性管理的控制策略，简称AM（Access & Mobility）策略，包含RCP授权（批准或修改）的业务区域限制和RFSP Index。为了获取AM策略，在UE注册或切换到AMF时，AMF需要向RCP请求建立AM策略关联。请求消息中包含AMF从UDM获取的UE签约的业务区域限制和RFSP Index。RCP根据运营商策略（例如基于策略签约信息，或基于累计用量）批准或修改AMF提供的业务区域限制和RFSP Index，并在响应消息中下发给AMF。之后RCP可以因为内部事件（如时段切换）或外部事件（如UDR通知该用户的策略签约变更）触发而主动向AMF更新AM策略；或者，RCP可以在AMF上报接入和移动性相关事件时，在响应消息中更新AM策略。在UE去注册或从AMF切走时，AMF请求RCP终止该UE的AM策略关联；RCP也可能因为某些事件（如UDR通知该用户的策略签约删除）而主动要求AMF终止该UE的AM策略关联。|ZUF-59-53-051 接入和移动性策略控制
PDU会话策略控制|PDU会话策略控制是指RCP向SMF提供用于PDU会话管理的控制策略，简称SM策略。PDU会话策略控制包括：PDU会话QoS控制：RCP向SMF提供授权的会话聚合带宽和缺省QoS（通过SessionRule的authSessAmbr和authDefQoS参数提供）。PDU会话计费控制：RCP指示SMF对PDU会话实施在线计费或离线计费，并提供计费系统地址（通过smPolicyDecision下的online、offline和chargingInfo参数提供）。PDU会话业务控制：RCP向SMF提供业务PCC规则，指定SMF对业务实施QoS控制、计费控制、业务流向控制（通过pccRule及其关联的qosDesc、chgDesc、traffContDecs参数提供）。|ZUF-59-53-052 PDU会话策略控制
URSP策略控制|URSP可预配置在UE或通过RCP下发给UE，预配置策略只在RCP未下发相同类型的策略时生效。URSP策略控制为UE策略控制的一个重要组成部分，用于UE决定如何为出局的业务流选择路由，主要包含如下几个方面：SSC模式选择策略：用于UE关联匹配SSC模式的应用。网络切片选择策略：用于UE关联匹配S-NSSAI的应用。DNN选择策略：用于UE关联匹配DNN的应用。PDU会话类型策略：用于UE关联匹配PDU会话类型的应用。非无缝卸载策略：UE使用该策略来确定匹配的应用程序非无缝卸载到PDU会话之外的非3GPP接入网络。接入类型优先策略：用于UE需要为匹配的应用建立PDU会话，指示优选的接入类型是3GPP或非3GPP。|ZUF-59-53-053 URSP策略控制
SOAP通知|当用户使用流量超过控制阈值时，RCP能够通过SOAP接口向SOAP服务器发送通知消息。SOAP通知内容主要包括：用户号码、套餐编号、流量使用值、流量使用百分比、用量阈值事件发生的时间戳、用户类型等关键信息。某些运营商希望通过给用户开通“异常流量提醒”服务，使得用户短时流量突发时可以收到短信提醒。这类短信内容通常需要加工定制。运营商希望RCP能够提供特定的用户流量阈值事件，并通过SOAP接口发送给第三方IT系统（即SOAP服务器），由IT系统根据SOAP通知内容及频度加工出需发送给用户的短信。|-
短信通知|ZXUN RCP能够配置短信通知策略，在条件满足时，实时触发短信通知。通知的典型应用场景包括：用量阈值提醒：例如套餐用量达到50%、80%、100%时，发送通知提醒用户用量消耗情况。限速提醒：例如基础套餐用量达到100%时执行限速，同时发送通知给用户，告之用户限速原因。费率改变提醒：例如用户离开归属网络或离开HomeZone时，发送通知提醒用户费率改变。套餐过期提醒：套餐过期时，或过期前N分钟，发送通知提醒用户套餐过期或即将过期。广告促销：例如用户一个月内首次来到某个地点时，发送通知告诉用户周边的促销活动。为了防止用户频繁被相同通知骚扰，ZXUN RCP可以为每条通知规则设置通知发送周期、周期内通知最多发送次数及发送间隔。ZXUN RCP支持的SMS协议包括：SMPP：短消息点对点协议，分为3.3版本和3.4版本SMGP：中国电信短消息网关协议CMPP：中国移动短消息点对点协议SGIP：中国联通短消息网关接口协议短信可以发送给在SPR/UDR的用户签约信息中指定的SMS接收号码，当SPR/UDR用户签约中没有指定SMS接收号码时，短信可以发送给SPR/UDR签约用户标识所采用的MSISDN号码，或者采用GW上报的MSISDN号码。短信也可同时发送给运营商指定的管理号码。|-
Email通知|ZXUN RCP能够配置Email通知策略，在条件满足时，实时触发Email通知。Email通知的典型应用场景包括：用量阈值提醒：例如套餐用量达到50%、80%、100%时，发送通知提醒用户用量消耗情况。限速提醒：例如基础套餐用量达到100%时执行限速，同时发送通知给用户，告之用户限速原因。费率改变提醒：例如用户离开归属网络或离开HomeZone时，发送通知提醒用户费率改变。套餐过期提醒：套餐过期时，或过期前N分钟，发送通知提醒用户套餐过期或即将过期。广告促销：例如用户一个月内首次来到某个地点时，发送通知告诉用户周边的促销活动。为了防止用户频繁被相同通知骚扰，ZXUN RCP可以为每条通知规则设置通知发送周期、周期内通知最多发送次数以及发送间隔。Email通知内容模板可携带最多5个变参，变参类型包括：用量累计值、剩余值、签约值、百分比。用户MSISDN、IMSI、姓、名。用户位置的别名。根据累计用量换算的消费金额。ZXUN RCP支持的Email协议为SMTP，Email发送给SPR/UDR用户签约中指定的Email地址。|-
基于终端的接纳控制|ZXUN RCP能够基于终端类型（如终端IMEISV号段）实施差异化的策略和计费控制。例如检测到用户在使用旧款手机上网时，可以通过SMS/Email向用户推销运营商正在销售的新款手机及绑定套餐。ZXUN RCP还能够验证签约了机卡绑定套餐的用户是否更换手机卡。运营商可以将签约机卡绑定套餐的用户的IMEISV写入SPR/UDR用户签约中，并在RCP配置策略，用户上线时，RCP对比PCEF上报的IMEISV和SPR/UDR签约的IMEISV，若不一致，则拒绝用户接入。|-
基于业务QoS的控制|业务级QoS控制指的是ZXUN RCP根据本局的策略配置或者AF、SPR/UDR、PCEF等输入信息综合确定业务QoS参数，包括MBR、GBR、QCI、ARP。ZXUN RCP通过PCC规则/QoS规则/ADC规则将业务QoS参数传递给PCEF/TDF。典型应用场景如下：ZXUN RCP根据AF提供的业务信息决定VoLTE业务的QoS参数。根据AF提供的媒体信息中的Max-Request-Bandwidth和Min-Request-Bandwidth决定VoLTE媒体的MBR、GBR。根据AF提供的媒体信息中的媒体类型决定VoLTE业务的QCI。根据AF提供的MPS-Id和Reservation-Priority决定VoLTE业务的ARP。ZXUN RCP根据SPR/UDR中用户签约的套餐决定DPI业务的QoS参数。例如当用户仅签约基础套餐时，ZXUN RCP决策对IM类业务限速5 kbps。这样IM类业务仅能维持正常的文字交流，无法发起高质量的语音或视频通话。如果用户购买了专门的IM业务套餐，则ZXUN RCP决策不对IM业务限速。|-
基于计费策略的控制|ZXUN RCP能够各种条件组合决定PCC规则中的业务级计费参数，包括业务标识（Service-Identifer）、计费组（Rating-Group）、报告级别（Reporting-Level）、度量方法（Metering-Method）、在线计费是否开启标记（Online）、离线计费是否开启标记（Offline）。对于IMS业务，ZXUN RCP还能够将IMS提供的AF-Charging-Identifier通过PCC规则传递给PCEF，使得PCEF可以在IMS业务的话单中携带该参数。对于赞助业务，ZXUN RCP还能将AF提供的赞助商标识（Sponsor-Identifier）、业务提供商标识（Application-Service-Provider-Identifier）通过PCC规则传递给PCEF，使得PCEF可以在赞助业务的话单中携带这些参数。典型应用场景：当用户购买OTT业务套餐后，ZXUN RCP下发OTT业务PCC规则，其中包含OTT业务的业务标识和计费组，要求PCEF对OTT业务输出单独的话单。|-
#### 套餐业务功能 
ZXUN RCP的套餐业务功能参见[表1]。
业务功能|描述|详细介绍参考
---|---|---
CPE锁位置|CPE是一种将高速4G信号转换成平板电脑、智能手机、笔记本等移动终端通用的WiFi信号的设备。CPE锁位置，即用户只能在优惠区域内使用CPE上网，超出优惠区域使用CPE会限制用户的上网功能并提醒用户。该特性可以实现：识别用户，并判断用户位置。提醒用户。在以下两个场景中，RCP可以向用户发送提醒短信或邮件。由于短信的时效性较好，一般选择短信作为通知方式。两种场景分别是：用户首次使用CPE时进行提醒。用户使用CPE从非优惠区域接入时进行提醒。优惠区域重置。有时用户需要重新确定优惠区域，比如用户搬家时，用户使用CPE设备的常用地点发生变更。此时，用户需要通知运营商。运营商可以为用户清空原来的常用地点，用户在新的常用地点使用CPE设备时，RCP为用户重新确定优惠区域。|ZUF-59-55-011 CPE锁位置
VoNR|VoNR是5G网络的目标语音解决方案。RCP能够为VoNR呼叫提供QoS保障、为VoNR紧急呼叫提供优先接入、支持P-CSCF查询用户位置和订阅承载事件通知，支持计费关联、P-CSCF容灾增强相关流程，同时也支持EPS Fallback流程。5G NR语音方案设计，延续了4G LTE通过IP网络承载语音业务的方式，通过5G网络（无线网+核心网）和IMS系统承载语音业务，该种方式称为VoNR。同样地，考虑到5G不同阶段部署规模不同，而4G网络已经广泛部署并可能在未来长期存在，以及对语音业务连续性保证的需求，回落方案设计也是十分必要的。因此EPS Fallback（演进的分组系统回落）方案也是5G语音方案的一种。EPS Fallback指的是5G NR不提供语音业务，当支持EPS Fallback的终端发起呼叫或者接受呼叫需在NR上建立音视频承载时，触发终端的重定向或切换流程，回落至LTE网络，由LTE网络为终端提供音视频业务。|ZUF-59-55-051 VoNR
AF影响业务路由|AF影响业务路由功能用于5GC向AF开放业务路由选择能力，将用户业务流路由到本地数据网络，从而减少传输时延、提升用户体验。AF影响业务路由是5GC相比EPC的新增功能，是5GC能力开放和MEC的重要组成部分。未来5G网络数据流量密度和用户体验速率的急剧增长，除了对无线接入网带来极大挑战，核心网同样也经受着更大数据流量的冲击，因此需要启用AF业务本地分流，减轻核心网流量传输压力。5G提出的高可靠低时延应用场景（如车联网、工业控制）也需要启用AF业务本地分流，从而降低业务时延。AF种类和数量繁多，不同的AF业务有不同的本地分流要求，很难在5GC中预配置，因此需要向AF开放业务路由选择功能。|ZUF-59-55-052 AF影响业务路由
UE无感分流策略控制|无感分流策略控制功能提升双域专网漫游场景下的业务体验，满足用户无感知访问公网及内网的业务需求。RCP网元支持基于签约等信息，在N7接口传递指定的URL、APN/DNN和切片等无感分流策略信息给SMF/P-GW网元。RCP网元支持在用户激活流程、RCP网元发起的更新流程中下发无感分流策略信息给SMF/P-GW网元，下发方式均为全覆盖模式，不支持修改操作。RCP网元支持删除无感分流策略信息。针对N7接口，支持通过显性方式（在通知消息中将对应的无感分流策略信息置NULL）通知SMF网元。RCP网元支持基于签约管理、配置无感分流策略相关信息。|ZUF-59-55-053 UE无感分流策略控制
#### 高可用功能 
ZXUN RCP的高可用功能参见[表1]。
业务功能|描述|详细介绍参考
---|---|---
地理容灾|容灾系统是指在容灾RCP间，当一个RCP出现故障时，容灾系统中其他RCP能承接故障RCP的业务功能。容灾RCP间根据是否需要实时备份用户数据，分成两类容灾：冷备容灾：冷备容灾的多个RCP之间，没有同步链路，不进行用户会话数据的实时备份，即容灾的RCP上，不包含任何其他RCP的用户信息。因此当某个RCP故障时，在其他容灾RCP上可以处理新建会话，但是已有用户的后续流程会失败。热备容灾：热备容灾的RCP间通过建立同步链路，实时备份用户的所有数据。当某个RCP故障时，在其他容灾RCP上可以处理新建会话和已有会话。通信网络的特征要求电信设备具有高的可靠性。RCP是用户的策略决策生成网元。当电源故障、人为因素、火灾、雷击、爆炸、地震、水灾等导致RCP发生故障时，则会影响用户业务。因此，运营商通常对RCP进行容灾建设，使得RCP能够不中断地为用户提供服务。目前RCP支持冷备和热备两种容灾模式。|ZUF-59-56-002 地理容灾
#### 虚拟化功能 
ZXUN RCP的虚拟化功能参见[表1]。
业务功能|描述|详细介绍参考
---|---|---
VNF自动部署|VNF自动部署是指由运维人员发起，通过NFVO为VNF实例分配所需的NFVI资源、并实例化VNF网元的过程。传统的电信网络架构，很多业务应用都基于专有的硬件资源进行开发和部署。业务应用部署上线以后，如果业务需求发生变动，往往涉及硬件资源和网络结构的变更，重新修改相应网络设备（路由器、交换机、防火墙），重新采购、部署硬件资源是一件非常繁琐的事情，这就给信息提供者和网络通讯运营商对各种硬件资源和应用管理带来了极大的负担。由于应用软件与硬件资源的绑定，限制了应用部署和组网的灵活性。因此，网元的虚拟化成为越来越多运营商的需求，创建基于云的基础设施和平台，以提高其数字化能力，这将使其能够在竞争日益激烈的市场中更好地满足客户的需求。云化的网络和应用平台建立后，自动化部署也就有了可能，并且越来越成为必要。|ZUF-59-58-002 VNF自动部署
VNF自动弹性|自动弹性是指VNF将当前的VM或SC负载情况和与EM上或MANO中配置的弹缩/弹扩的门限值进行比较，当负载超过弹扩的门限值时，开始进行VM或SC的弹扩处理；当负载小于弹缩的门限值时，开始进行VM或SC的弹缩处理。对于VM弹性，ZXUN RCP只支持手工弹性的方式，不支持自动弹性的方式。所以对于自动弹性，仅表示SC自动弹性，本特性后文描述为SC自动弹性。从弹性的对象分区，弹性功能分为VM弹性和SC弹性。VM弹性VM弹性是指运营商可以按实际需求申请或释放VM所占用的虚拟资源，可提高整个系统对虚拟资源的利用率。SC弹性SC弹性是指运营商可以按实际需求申请或释放SC所占用的虚拟资源，可提高整个系统对虚拟资源的利用率。根据实际的操作方式，弹性功能分为两种方式。自动弹性自动弹性是指VNF将当前的VM或SC负载情况和与EM上或MANO中配置的弹缩/弹扩的门限值进行比较，当负载超过弹扩的门限值时，开始进行VM或SC的弹扩处理；当负载小于弹缩的门限值时，开始进行VM或SC的弹缩处理。手工弹性手工弹性是指操作员通过在MANO或EM上手工配置数据来人为的调整VM个数。这两种方式的区别在于：自动弹性是系统通过采集实时的VM或SC的负荷数据与本地配置的弹缩/弹扩的门限值进行比较，根据结果来自动调整VM或SC的个数；手工弹性则是指操作员通过MANO或EM手工配置数据来人为的调整VM个数。|ZUF-59-58-004 VNF自动弹性
VNF虚机自愈|在VNF虚机或其关键组件的运行过程中，由于硬件故障、VIM状态管理异常、虚机自身运行故障、人为误操作等原因，导致部分虚机有可能处于异常状态（包括被删除、挂起、休眠、错误等）。针对这种状态异常的虚机，云系统提供了VNF自动恢复的功能，称为虚机自愈。云计算和虚拟化背景，对系统的自我修复能力提出了更高的要求。虚机自愈就是这样一种自我修复的异常保护机制，自愈的目的是使本地虚机的状态和VIM上的虚机状态一致，且虚机上运行的容器状态正常，因此虚机自愈的过程中可能存在容器重建、虚机重建、虚机重启、虚机删除等操作。|ZUF-59-58-005 VNF虚机自愈
VNF手工弹性|手工弹性是指操作员通过在MANO或EM上手工配置数据来人为的调整VM个数或SC个数。从弹性的对象区分，弹性功能分为VM弹性和SC弹性。VM弹性VM弹性是指运营商可以按实际需求申请或释放VM所占用的虚拟资源，可提高整个系统对虚拟资源的利用率。SC弹性SC弹性是指运营商可以按实际需求申请或释放SC所占用的虚拟资源，可提高整个系统对虚拟资源的利用率。根据实际的操作方式，弹性功能分为两种方式。自动弹性自动弹性是指将当前的VM或SC负载情况与MANO或EM中配置的弹缩/弹扩的门限值进行比较，当负载超过弹扩的门限值时，开始进行VM或SC的弹扩处理；当负载小于弹缩的门限值时，开始进行VM或SC的弹缩处理。手工弹性手工弹性是指操作员通过在MANO或EM上手工配置数据来人为的调整VM个数。手工弹性包括VM手工弹性和SC手工弹性。自动弹性与手工弹性两种方式的区别在于：自动弹性是系统通过采集实际的VM或SC的负荷数据与本地配置的弹缩/弹扩的门限值进行比较，根据结果来自动调整VM或SC的个数；手工弹性是指操作员通过MANO或EM手工配置数据来人为的调整VM个数或SC个数。|ZUF-59-58-043 VNF手工弹性
VNF虚机管理|VNF虚机管理是指对实例化成功的VM进行管理，包括创建、查询、启动、停止、终止、删除、迁移等操作。云计算和虚拟化技术的发展，对运营商的运维提出了新的挑战，原来管理的固定、静止的物理设备，变成了虚拟的、可动态迁移的逻辑对象，从而对系统设备的运维提出了更高的要求。虚拟化ZXUN RCP支持手工操作虚机后，运营商可以对虚机实现更多个性化的操作，如创建、查询、启动、停止、终止、删除、迁移。这些操作在不影响业务的情况下，使得设备的运维更加高效便捷。|ZUF-59-58-044 VNF虚机管理
#### 操作维护功能 
ZXUN RCP的操作维护功能参见[表1]。
业务功能|描述|详细介绍参考
---|---|---
分权分域|分权分权指对操作员的操作权限进行授权，限定操作员只能配置和管理对特定业务区域生效的资源，以保证网管系统的操作安全。操作员通过菜单分域配置→模式切换来选定并进入待配置的域，并在相应的域中进行策略配置来实施对应业务域的配置。如果操作员只被授予单个域的管理权限，则系统自动为其切换至被授权的域，操作员无需执行模式切换操作。按域授权的配置数据包括规则配置和场景配置。分权是在分域条件下的权限控制行为。一般按业务功能类型或业务面向的服务区域设置操作者帐号。该账号被授予的操作权限只在所属区域有效，不能管理其他区域。特权账号可以管理多个或所有区域。分域分域是指业务特性可以按域配置，不同域的用户可享受不同的服务。业务支持对用户按号码段和按IMSI段分域。分域的目的，是为了对不同地域的用户提供不同的业务。|ZUF-59-57-002 分权分域
### 典型组网 
#### 5GC组网 
5G场景下，ZXUN RCP可以为运营商提供丰富、灵活的策略控制能力，满足不同用户、多种业务场景下的个性化需求，从而为运营商带来更高的收益。5GC典型组网如[图1]所示。
图1  5GC典型组网示意图

#### VoLTE组网 
VoLTE是3GPP标准定义的通过LTE网络作为业务接入、IMS网络实现业务控制的语音解决方案。通过IMS网络，移动运营商不仅可以无缝的继承传统的语音、短消息业务，还可以将语音通话与丰富的增强功能相整合，提供多样化的服务。
ZXUN RCP支持基于Diameter协议的Rx和Gx接口，通过Rx与AF（由P-CSCF实现）进行消息交互，通过Gx接口与PCEF（由xGW实现）进行消息交互，完成基于VoLTE应用的策略控制功能。VoLTE组网如[图1]所示。
图1  VoLTE组网示意图

#### VoNR组网 
5G NR语音解决方案延续了4G LTE通过IP网络承载语音业务的方式，通过5G网络（无线网+核心网）和IMS系统承载语音业务，该种方式称为VoNR。
5G不同阶段部署规模不同，而4G网络已经广泛部署并可能在未来长期存在，以及对语音业务连续性保证的需求，因此EPS Fallback（演进的分组系统回落）方案也是5G语音方案的一种。EPS Fallback指的是5G NR不提供语音业务，当EPS Fallback终端发起呼叫或者接受呼叫，需在5G NR上建立音视频承载时，触发终端的重定向或切换流程，回落至LTE网络，由LTE网络为终端提供音视频业务。
ZXUN RCP支持基于HTTP/2协议的N7和N15接口，以及基于Diameter协议的Rx接口。ZXUN RCP通过N7接口与SMF进行消息交互，通过N15接口与AMF进行消息交互，通过Rx接口与P-CSCF进行消息交互，完成基于VoNR应用的策略控制功能。VoNR组网示意图如[图1]所示。
图1  VoNR组网示意图

### 接口 
ZXUN RCP融合了PCF和PCRF功能，能够同时对外提供PCF和PCRF接口，接口组网图如[图1]所示。
图1  ZXUN RCP接口组网示意图

接口名称|RCP角色|对接网元|协议|描述
---|---|---|---|---
Gx|PCRF|PCEF|Diameter|Gx接口用于EPC中IP-CAN会话的策略控制。
Rx|PCRF|AF|Diameter|Rx接口用于EPC/5GC的VoLTE/VoNR或其他AF业务的QoS授权。
Sd|PCRF|TDF|Diameter|Sd接口用于外置DPI的策略控制。
Sp/Sp'|PCRF|SPR|Diameter|Sp接口用于PCRF从SPR获取策略签约信息。Sp'接口用于PCRF向SPR保存动态策略数据（如累计用量）。
Sy|PCRF|OCS|Diameter|Sy接口用于PCRF从OCS获取消费门限信息。
N5|PCF|AF|HTTP/2+JSON|N5接口用于AF向PCF请求业务QoS授权，或AF影响业务路由策略。
N7|PCF|SMF|HTTP/2+JSON|N7接口用于5GC中PDU会话的策略控制。
N15|PCF|AMF|HTTP/2+JSON|N15接口用于PCF向AMF提供AM策略和UE策略。
N28|PCF|CHF|HTTP/2+JSON|N28接口用于PCF从CHF获取消费门限信息。
N30|PCF|NEF|HTTP/2+JSON|N30接口用于第三方AF调用NEF的相关服务，触发NEF调用RCP的Npcf_PolicyAuthorization服务的相关操作。
N36|PCF|UDR|HTTP/2+JSON|N36接口用于UDR和PCF之间的消息交互。PCF可以通过N36接口向UDR请求策略签约信息或获取业务流量引导数据，订阅/去订阅相关策略签约或业务流量引导变更信息。
Nbsf|PCF|BSF|HTTP/2+JSON|Nbsf是BSF提供的服务化接口。PCF可以通过Nbsf接口调用Nbsf_Management服务的注册、更新注册或注销PCF绑定信息。
Nnrf|PCF|NRF|HTTP/2+JSON|Nnrf接口用于调用Nnrf_NFManagement服务的API注册、更新或去注册PCF相关的服务。
SMS|PCF|SMSC|SMPP/CMPP/SGIP/SMGP/CNGP|SMS接口用于PCF/PCRF发送策略控制相关的SMS通知。
Email|PCF|Email服务器|SMTP|Email接口用于PCF/PCRF发送策略控制相关的Email通知。
### 可靠性设计 
#### 软件可靠性 
##### 组件容灾备份 
为确保系统可靠性，同时为避免系统故障或因组件故障造成的系统容量不足，ZXUN RCP采用了组件容灾备份。当一个组件发生故障时，备份组件将自动接管故障组件的业务，这样ZXUN RCP就可以继续为外部网元提供服务。
##### 过负荷控制 
ZXUN RCP提供过负荷控制功能。当系统负荷超过正常值上限时，过负荷控制功能可以防止ZXUN RCP发生信令拥塞，避免造成所有业务的中断。
ZXUN RCP支持根据CPU利用率或者License在线用户容量占用率来配置不同的过负荷控制等级。目前有四个等级的过负荷控制：过负荷等级1、过负荷等级2、过负荷等级3以及正常等级。
当负荷超过等级1的阈值时，ZXUN RCP会发起一个过负荷严重告警，并执行等级1的过负荷控制，即拒绝来自其他网元的新会话建立/更新请求，但允许所有会话的终止请求以及紧急呼叫的所有请求。 
当负荷介于等级1与等级2的阈值之间时，ZXUN RCP会发起一个过负荷重大告警，但不会拒绝来自其他网元的请求。 
当负荷介于等级2与等级3的阈值之间时，ZXUN RCP会发起一个过负荷轻度告警，但不会拒绝来自其他网元的请求。 
##### Diameter多链路 
ZXUN RCP支持和同一个Diameter对端建立多条Diameter链路，这些链路可以工作于主备模式或负荷分担模式。这可以提升ZXUN RCP和Diameter对端间的Diameter信令吞吐量，也能提升Diameter连接的高可靠性。当在一个Diameter连接上收到Diameter请求时，ZXUN RCP能够在原路返回Diameter响应或发送主动请求。当一条Diameter连接中断时，ZXUN RCP可以尝试在其他备用Diameter连接上发生Diameter消息。
#### 数据安全 
##### 备份方案 
ZXUN RCP支持不同模块的备份，例如基本配置数据、IP协议栈配置数据、安全数据、日志数据、OAM数据库文件和NFS私有数据。支持手动或自动备份。对于自动备份，备份的间隔时间和内容是可以配置的。备份数据可以导出至FTP/SFTP服务器。
##### 恢复方案 
ZXUN RCP支持恢复所有的备份数据。
#### 可靠性指标 
ZXUN RCP的可靠性指标参见[表1]。
可靠性参数|指标
---|---
系统有效性|>99.99991%
故障平均间隔时间|134 年
故障平均修复时间|<60 分钟
系统年平均中断时间|<0.5 分钟
#### 地理容灾 
容灾系统是指在容灾RCP间，当一个RCP出现故障时，容灾系统中其他RCP能够正常处理故障RCP上用户会话的后续信令，并完成相应的业务功能。
根据是否需要实时备份用户数据和会话数据，分成以下两类容灾： 
冷备容灾 
热备容灾 
##### 冷备容灾 
描述 :冷备容灾的多个RCP之间，没有容灾链路，不进行用户会话数据的实时备份，即备用的RCP上，不包含任何业务信息。因此当主用RCP故障时，会短暂影响用户的上网业务。
冷备容灾常用于数据业务APN。 
 说明： 
冷备容灾时，内置UDSF不需要配置GSU(GW)虚机。
###### 1+1主备冷备容灾 
当主用RCP发生故障的时候，PGW/DRA/AF/SMF/AMF将消息切换至容灾RCP处理，容灾RCP能够继续为网络提供服务。
如[图1]所示，RCP1是主用RCP，RCP2是容灾RCP。
图1  1+1主备冷备容灾

正常情况下，RCP1为对端网元提供策略控制功能。所有对端设备都发送业务请求消息（通过直连链路或通过DRA链路）给RCP1，RCP2不处理任何业务。 
当RCP1不能正常工作或者发生故障时，RCP2将接管RCP1提供策略控制功能，即所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP2，而不再发消息给RCP1。 
 说明： 
RCP1和RCP2之间不需要同步用户数据。 
###### 1+1互备冷备容灾 
当其中一个RCP发生故障的时候，对端网元将消息切换至其他RCP处理，其他RCP能够继续为网络提供服务。 
此场景针对对端设备可以根据配置将同一用户的多个会话发送到同一个RCP处理，或者不需要RCP进行用量累计、短信通知的场景。 
如[图2]所示，RCP1和RCP2同时处于工作状态，互相是对方的容灾局。
图2  1+1互备冷备容灾

正常情况下，RCP1和RCP2均为对端网元提供策略控制功能。对端网元会根据配置的用户号段（运营商根据用户标识IMSI/MSISDN规划）来选择将消息发送（通过直连链路或通过DRA链路）给RCP1或RCP2。对于不同的PGW/DRA/AF/SMF/AMF，如果配置了同一个用户号段，则会将消息发给同一个RCP。
当RCP1不能正常工作或者发生故障时，RCP2将接管RCP1为其他网元提供策略控制功能，即所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP2，而不再发消息给RCP1。 
当RCP2不能正常工作或者发生故障时，RCP1将接管RCP2为其他网元提供策略控制功能，即所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP1，而不再发消息给RCP2。 
 说明： 
RCP1和RCP2之间不需要同步用户数据。 
##### 热备容灾 
描述 :热备容灾的RCP间通过建立同步链路，实时备份用户的所有数据。每当用户数据进入稳态时，RCP将执行备份操作，因此当主用RCP故障时，不会影响用户的上网业务。
热备容灾常用于VoLTE/VoNR APN。针对VoLTE/VoNR呼叫，使用冷备容灾时，当被叫侧RCP发生故障时，VoLTE/VoNR被叫不通，且被叫感知不到故障，除非被叫重启UE，否则永远不通，因此必须使用热备容灾。
两个热备容灾的RCP之间，通过建立容灾链路实现互通。通过容灾链路在RCP间对用户的动态数据进行实时备份。 
###### 1+1主备热备容灾 
当主用RCP发生故障的时候，PGW/DRA/AF/SMF/AMF将消息切换至容灾RCP处理，容灾RCP能够继续为网络提供服务。
如[图1]所示，RCP1是主用RCP，RCP2是容灾RCP。
图1  1+1主备热备容灾

正常情况下，RCP1为对端网元提供策略控制功能，所有对端设备都发送消息（通过直连链路或通过DRA链路）给RCP1，RCP2不处理任何业务。 
当RCP1不能正常工作或者发生故障时，RCP2将接管RCP1提供策略控制功能，即所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP2，而不再发消息给RCP1。 
当RCP1恢复之后，所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP1，而不再发消息给RCP2。 
 说明： 
RCP1和RCP2之间需要同步用户数据。 
###### 1+1互备热备容灾 
当其中一个RCP发生故障的时候，对端网元将消息切换至其他RCP处理，其他RCP能够继续为网络提供服务。 
如[图2]所示，RCP1和RCP2同时处于工作状态，互相是对方的容灾局。
图2  1+1互备热备容灾

正常情况下，RCP1和RCP2均为对端网元提供策略控制功能。对端设备会根据配置的用户号段（运营商根据用户标识IMSI/MSISDN规划）来选择将消息发送（通过直连链路或通过DRA链路）给RCP1或RCP2，对于不同的PGW/DRA/AF/SMF/AMF，如果配置了同一个用户号段，则会将消息发给同一个RCP。
当RCP1不能正常工作或者发生故障时，RCP2将接管RCP1为其他网元提供策略控制功能，即所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP2，而不再发消息给RCP1。 
当RCP1恢复之后，对端设备需要将归属RCP1的用户的消息发送给RCP1，而不再将这些用户的消息发送给RCP2。 
当RCP2故障以及恢复的处理和RCP1类似。 
 说明： 
RCP1和RCP2之间需要同步用户数据。 
###### 组Pool热备容灾 
当其中一个RCP发生故障的时候，对端网元将消息切换至其他RCP处理，其他RCP能够继续为网络提供服务。 
此场景针对对端设备无法根据配置将同一用户的多个会话发送到同一个RCP处理的场景。 
如[图3]所示，RCP1、RCP2、RCP3、RCP4同时处于工作状态，互相是对方的容灾局。
图3  组Pool热备容灾

正常情况下，RCP1、RCP2、RCP3、RCP4均为对端网元提供策略控制功能。对端设备无法根据用户号段（运营商根据用户标识IMSI/MSISDN规划）来选择将消息发送（通过直连链路或通过DRA链路）给同一个RCP。
同一个用户的不同会话消息，会被PGW/DRA/AF/SMF/AMF发送到不同的RCP。RCP会通过重定向功能通知对端网元，消息应该发送给哪个RCP。 
当RCP1不能正常工作或者发生故障时，RCP2、RCP3、RCP4将接管RCP1为其他网元提供策略控制功能，即所有对端设备都发送业务请求（通过直连链路或通过DRA链路）给RCP2、RCP3、RCP4，而不再发消息给RCP1。 
当RCP1故障之后，RCP2，RCP3，RCP4会按照用户分片来分别接管部分原先RCP1的会话。当某一个原来归属RCP1的会话发生更新之后，PGW/DRA/AF/SMF/AMF会随机发送消息给RCP2/RCP3/RCP4。当PGW/DRA/AF/SMF/AMF选择的RCP和主动接管用户会话的RCP不一致时，RCP会通过重定向功能通知对端网元，消息应该发送给哪个RCP。 
当其他RCP故障时，处理逻辑类似。 
 说明： 
RCP之间需要互相同步用户路由数据以及用户会话数据。 
### 遵循标准与要求 
#### 3GPP标准 
标准|描述
---|---
3GPP 23.203|Policy and Charging Control (PCC) architecture
3GPP 29.210|Charging rule provisioning over Gx interface
3GPP 29.212|Policy and Charging Control (PCC) over Gx reference point
3GPP 29.213|Policy and Charging Control (PCC) signalling flows and QoS parameter mapping
3GPP 29.214|Policy and Charging Control (PCC) over Rx reference point
3GPP 29.215|Policy and Charging Control (PCC) over S9 reference point
3GPP 29.219|Policy and Charging Control (PCC): Spending limit reporting over Sy reference point
3GPP 23.401|General Packet Radio Service (GPRS) enhancements for Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access
3GPP 23.402|Architecture enhancements for non-3GPP accesses
3GPP 23.501|System Architecture for the 5G System
3GPP 23.502|Procedures for the 5G System
3GPP 23.503|Policy and Charging Control Framework for the 5G System
3GPP 23.507|Access and Mobility Policy Control Service
3GPP 23.510|Network Function Repository Services
3GPP 23.512|Session Management Policy Control Service
3GPP 23.514|Policy Authorization Service
3GPP 23.525|UE Policy Control Service
3GPP 23.571|Common Data Types for Service Based Interfaces
3GPP 23.594|Spending Limit Control Service
3GPP2 X.S0062-0|PCC for CDMA2000 1x and HRPD Networks
3GPP2 X.S0057-0|E-UTRAN - eHRPD Connectivity and Interworking: Core Network Aspects
#### IETF RFC标准 
标准|描述
---|---
RFC 2960|Stream Control Transmission Protocol
RFC 3588|Diameter Base Protocol
RFC 4006|Lightweight Directory Access Protocol
RFC 6749|The OAuth 2.0 Authorization Framework
RFC 7540|Hypertext Transfer Protocol Version 2 (HTTP/2)
RFC 8259|The JavaScript Object Notation (JSON) Data Interchange Format
#### 其他技术标准 
标准|描述
---|---
CMPP|China Mobile Peer To Peer Protocol
MML|Man-Machine Language
SMPP|Short Message Peer to Peer
SMTP|Simple Mail Transfer Protocol
SOAP|Simple Object Access Protocol
## 缩略语 
## 缩略语 
### 3GPP2 
3rd Generation Partnership Project 23G协作组2
3GPP :3rd Generation Partnership Project第三代合作伙伴计划
### ADC 
Application Detection and Control应用检测控制
AF :Application Function应用功能
### AM 
Access and Mobility Management接入移动管理
AMF :Access and Mobility Management Function接入和移动管理功能
### AN 
Access Network接入网
### API 
Access Point Identifier接入点标识
APN :Access Point Name接入点名称
Access Point Network接入点网络
### ARP 
Allocation and Retention Priority分配保持优先级
### AS 
Application Server应用服务器
### ATCF 
Access Transfer Control Function接入转换控制功能
### ATGW 
Access Transfer Gateway接入转换网关
AUSF :Authentication Server Function鉴权服务器功能
### BGCF 
Breakout
Gateway Control Function出口网关控制功能
BSF :Binding Support Function绑定支持功能
### BSID 
Base station identifier基站识别号
### BSS 
Business Support System业务支撑系统
### CDN 
Contents Distribution Network内容分发网络
### CDU 
Cloud Database Unit云数据库单元
### CGI 
Cell Global Identification小区全球识别码
CHF :Charging Function计费功能
### CMPP 
China Mobile Peer to Peer中国移动点对点协议
### CN 
Core Network核心网
### CNGP 
China Netcom Short Message Gateway Protocol中国网通短消息网关协议
### DN 
Data Network数据网
### DNAI 
DN Access Identifier数据网络接入标识符
DNN :Data Network Name数据网名称
### DPI 
Deep Packet Inspection深度包检测
### DRA 
Diameter Routing AgentDiameter路由代理
E-UTRAN :Evolved Universal Terrestrial Radio Access Network演进的通用陆地无线接入网络
### ECGI 
E-UTRAN Cell Global IdentifierE-UTRAN小区全球标识
EM :Element Management网元管理
EPC :Evolved Packet Core演进的分组核心网
EPS :Evolved Packet System演进的分组系统
ETSI :European Telecommunications Standards Institute欧洲电信标准化协会
FTP :File Transfer Protocol文件传输协议
### FUP 
Fair Usage Policy公平使用策略
### GBR 
Guaranteed Bandwidth Requested最大保证带宽
GGSN :Gateway GPRS Support NodeGPRS网关支持节点
GPRS :General Packet Radio Service通用无线分组数据业务
GPSI :Generic Public Subscription Identifier一般公共用户标识
GSU :General Service Unit通用业务单元
### GW 
GateWay网关
### HPLMN 
Home Public Land Mobile Network归属公众陆地移动网
HSS :Home Subscriber Server归属用户服务器
HTTP :Hypertext Transfer Protocol超文本传输协议
### I-CSCF 
Interrogating-Call Session Control Function查询呼叫会话控制功能
### IM 
Instant Message即时消息
### IMEISV 
International Mobile Equipment Identity and Software Version number国际移动设备识别码和软件版本号
IMS :IP Multimedia SubsystemIP多媒体子系统
IMSI :International Mobile Subscriber Identity国际移动用户标识
### IP-CAN 
IP Connectivity Access NetworkIP连通接入网
IP :Internet Protocol因特网协议
### IPU 
Interface Process Unit接口处理单元
### IVR 
Interactive Voice Response交互式语音应答
### LB 
Load Balance负载均衡
### LSU 
Log Storage Unit日志存储单元
LTE :Long Term Evolution长期演进
MANO :Management and Orchestration管理和编排
### MBR 
Maximum Bandwidth Requested最大请求带宽
### MCC 
Mobile Country Code移动国家码
### MEC 
Mobile Edge Computing移动边缘计算
### MGCF 
Media Gateway Control Function媒体网关控制功能
MME :Mobility Management Entity移动管理实体
### MML 
Man Machine Language人机语言
### MMTel 
Multimedia Telephony多媒体电话
### MNC 
Mobile Network Code移动网络号
### MRFC 
Multimedia Resource Function Controller多媒体资源功能控制器
### MRFP 
Multimedia Resource Function Processor多媒体资源功能处理器
MSISDN :Mobile Station International Subscriber Directory Number移动台国际用户目录号
NAS :Non-Access Stratum非接入层
NEF :Network Exposure Function网络开放功能
NF :Network Function网络功能
NFV :Network Functions Virtualization网络功能虚拟化
### NFVI 
Network Functions Virtualization Infrastructure网络功能虚拟化基础设施
NFVO :Network Functions Virtualization Orchestrator网络功能虚拟化编排器
### NMS 
Network Management System网络管理系统
### NR 
New Radio新无线
NRF :NF Repository Function网络仓储功能
### NSA 
Non-Standalone5G非独立组网
NSSF :Network Slice Selection Function网络切片选择功能
OAM :Operation, Administration and Maintenance操作管理维护
### OCS 
Online Charging System在线计费系统
OMU :Operation & Management Unit操作管理单元
### OSS 
Operation Support System运营支撑系统
### OTT 
Over The Top通过互联网向用户提供各种应用服务
P-CSCF :Proxy-Call Session Control Function代理呼叫会话控制功能
PCC :Policy and Charging Control计费和策略控制
PCEF :Policy and Charging Enforcement Function计费和策略控制实施功能
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
PDN :Packet Data Network分组数据网
PDU :Packet Data Unit分组数据单元
PGW :PDN Gateway分组数据网网关
PLMN :Public Land Mobile Network公共陆地移动网
### QCI 
QoS Class IdentifierQoS类别标识
QoS :Quality of Service服务质量
### RAI 
Routing Area Identity路由区标识
RAN :Radio Access Network无线接入网
RAT :Radio Access Technology无线接入技术
RCP :Resource Control Platform资源控制平台
### RFSP 
RAT/Frequency Selection Priority无线/频率选择优先级
### S-CSCF 
Serving-Call Session Control Function服务呼叫会话控制功能
### SA 
Standalone5G独立组网
### SAE 
System Architecture Evolution系统架构演进
### SAI 
Service Area Identity业务区域标识
### SBA 
Service Based Architecture基于服务的架构
### SBC 
Session Border Controller会话边界控制器
### SCC 
Service Centralization and Continuity业务集中和连续
### SDN 
Software Defined Network软件定义网络
SFTP :Secure File Transfer Protocol安全文件传输协议
### SGIP 
Short Message Gateway Interface Protocol中国联合通信公司短消息网关系统接口协议
Short Message Gateway Interface Protocol中国联通短消息网关接口协议
SGSN :Serving GPRS Support Node服务GPRS支持节点
SGW :Signaling Gateway信令网关
SM :Session Management会话管理
SMF :Session Management Function会话管理功能
### SMGP 
Short Message Gateway Protocol中国电信短消息网关协议
### SMP 
Signal Main Processor信令主处理模块
### SMPP 
Short Message Peer to Peer Protocol短消息点对点协议
SMS :Short Message Service短消息业务
### SMSC 
Short Message Service Center短消息中心
### SMTP 
Simple Mail Transfer Protocol简单邮件传输协议
### SNMP 
Simple Network Management Protocol简单网络管理协议
### SOAP 
Simple Object Access Protocol简单对象访问协议
SPR :Subscription Profile Repository用户签约数据库
SUPI :Subscriber Permanent Identifier用户永久标识
### TAI 
Tracking Area Identity跟踪区标识
### TDF 
Traffic Detection Function流量检测功能
### TECS 
Tulip Elastic Cloud System郁金香弹性云系统
UDM :Unified Data Management统一数据管理
UDR :User Data Request用户数据（读取）请求
Unified Data Repository统一数据存储
UDSF :Unstructured Data Storage Function非结构化数据存储功能
UE :User Equipment用户设备
UPF :User Plane Function用户平面功能
### URLLC 
Ultra Reliable Low Latency Communication超高可靠超低时延通信
VIM :Virtualized Infrastructure Manager虚拟化基础设施管理系统
VNF :Virtualized Network Function虚拟化网络功能
VNFM :Virtualized Network Function Manager虚拟化网络功能管理器
### VPLMN 
Visited Public Land Mobile Network拜访公众陆地移动网
### VoLTE 
Voice over LTELTE语音
VoNR :Voice over New Radio新空口承载语音
### eMBB 
Enhanced Mobile Broadband增强移动宽带
eNodeB :Evolved NodeB演进的NodeB
### mMTC 
Massive Machine Type Communication海量机器类通信
## 系统原理 
系统架构 :ZXUN RCP系统架构统一遵循ETSI定义的NFV标准架构，提供从硬件COTS、虚拟化平台、容器平台到VNF的端到端能力，具备全云全栈能力。
ZXUN RCP是VNF的一个功能实体，提供PCF和PCRF网元功能。NF的业务功能通过若干服务来承载。ZXUN RCP的系统架构如[图1]所示。
图1  ZXUN RCP系统架构

NFV架构中部件组成及其功能参见[表1]。
部件类别|部件名称|部件功能简述
---|---|---
运营支撑部件|OSS/BSS|运营商的运营支撑和业务支撑系统。
应用管理部件|EMS|VNF网元运维管理系统，可根据实际情况部署一个或多个。
NFVO|应用管理部件|NS生命周期的管理模块，实现对整个NFV基础架构、软件资源、网络服务的编排和管理，同时负责协调NS、组成NS的VNFs以及承载各VNF的虚拟资源的控制和管理。
VNFM|应用管理部件|VNF管理模块，也就是应用管理单元，是VNF的生命周期管理部件，主要对VNF的生命周期实例化、配置、关闭、弹性、重建等进行控制。
业务网元|VNF|网络功能实体，在软件实现上通过各种NFS组合来承载。NFS是能够独立完成某个具体功能的软件实体。ZXUN RCP网络功能实体，实现PCF和PCRF网元，提供2/3/4/5G融合核心网的策略控制功能，包括5类NFS：信令业务类策略日志类数据存储类接口管理&转发类平台支撑&网管类
容器平台|CIM|（可选）容器管理平台，实现容器部署及容器资源管理。
部件|VIM|提供对虚拟化基础设施的管理，主要功能包括：资源的发现、虚拟资源的管理分配、故障处理等，为VNF运行提供资源支持。采集和上报基础设施性能指标和相关事件。
基础设施|CloudOS|提供虚拟化功能，将硬件物理资源虚拟成虚拟资源，供VNF使用。其中虚拟网络支持SR-IOV/DVS。
COTS|基础设施|通用COTS设备，包括服务器、存储、网络设备。
### 服务框架 
#### 服务组成 
##### 业务服务和服务组件说明 
为了适应5GC网络的灵活性、扩展性，ZXUN RCP采用服务化架构。服务化架构由一系列业务服务NFS和服务组件SC构成。
业务服务，是NF的具体功能，能够独立完成某个具体功能的软件实体。服务间采用松耦合，具有支持独立发布、部署、升级、运维等特征。多个业务服务组合可实现一定的业务功能。 
服务组件，是微服务架构下的最小单元，具备独立的负荷分担、集群管理、弹性等功能。多个服务组件组成一个业务服务。 
##### 业务服务模型和资源模型的映射关系 
业务服务模型和资源模型是解耦的。业务服务既可以运行在VM资源模型（[IaaS]形态）
。业务功能逻辑呈现一致，底层的部署方式不同。
服务组件的运行载体为在IaaS形态部署时呈现为容器实例。 
业务服务模型和资源模型的映射关系如[图1]所示。
图1  业务服务模型和资源模型的映射关系

##### 各业务服务和服务组件介绍 
ZXUN RCP的服务组成如[图2]所示。
图2  ZXUN RCP服务组成

各业务服务及其包含的服务组件介绍参见下表。 
服务分类|服务|说明|归属NF|服务组件|功能描述
---|---|---|---|---|---
平台支撑&网管类|Service Governance|微服务治理，又称CommonS_TMSP。|公共服务，服务于：SMF/AMF/PCF/UPF……|sc-tmsp-mgt|管理SC，服务部署资源的编排、升级、自愈。
sc-tmsp-smc|平台支撑&网管类|Service Governance|微服务治理，又称CommonS_TMSP。|公共服务，服务于：SMF/AMF/PCF/UPF……|管理SC，服务管理、服务注册、发现、升级。
sc-tmsp-mp|平台支撑&网管类|Service Governance|微服务治理，又称CommonS_TMSP。|公共服务，服务于：SMF/AMF/PCF/UPF……|本服务配置管理、性能统计管理等。
sc-tmsp-rosng|平台支撑&网管类|Service Governance|微服务治理，又称CommonS_TMSP。|公共服务，服务于：SMF/AMF/PCF/UPF……|路由协议栈SC。
sc-tmsp-amu|平台支撑&网管类|Service Governance|微服务治理，又称CommonS_TMSP。|公共服务，服务于：SMF/AMF/PCF/UPF……|仲裁SC，对其他SC提供主备仲裁。
Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|sc-oam-gateway|OAM接入网关，负责管理口HTTP/SSH等协议接入。
sc-oam-main|Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|OAM主控制单元，负责OAM配置、告警、性能、安全、日志等。
sc-oam-umf|Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|OAM统一消息上报单元，负责信令跟踪消息上报。
sc-oam-ccmf|Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|OAM配置管理单元，负责配置数据校验、存储、同步。
sc-oam-upgrade|Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|OAM升级管理单元，负责业务SC和OAM自身升级控制。
sc-oam-postgre|Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|OAM数据库，负责存储OAM配置、安全、接入等数据。
sc-oam-web|Operation and Maintenance|平台支撑&网管类|操作维护，又称CommonS_OAM。|公共服务，服务于：SMF/AMF/PCF/UPF……|提供本地网管web服务。
RCP Policy Management|平台支撑&网管类|RCP策略管理，又称Npcf_PolicyManagement。|PCF|sc-npcf-policymanagement|RCP策略管理单元，提供RCP策略配置功能。
RCP System Management|平台支撑&网管类|RCP系统管理，又称Npcf_SystemManagement。|PCF|sc-pcf-dap|RCP系统管理单元，负责Diameter连接管理及网元公共配置维护操作。
接口管理&转发类|Tunnel Encryption|隧道加密，又称CommonS_IPSec。|公共服务，服务于：SMF/AMF/PCF/UPF……|sc-ipsec-mp|本服务SC控制单元，负责升级控制、动态命令。
sc-ipsec|接口管理&转发类|Tunnel Encryption|隧道加密，又称CommonS_IPSec。|公共服务，服务于：SMF/AMF/PCF/UPF……|提供信令报文加密服务。
Interface Management|接口管理&转发类|接口处理，又称CommonS_IPS。|sc-ips-mp|公共服务，服务于：SMF/AMF/PCF/UPF……|本服务的SC控制单元，负责SC集群管理、弹性控制、升级控制、SC注册&发现、SC负荷分担。
sc-ips|Interface Management|接口管理&转发类|接口处理，又称CommonS_IPS。|转发接口服务，提供报文分发服务以及IP路由转发功能。|公共服务，服务于：SMF/AMF/PCF/UPF……
HTTP Service|接口管理&转发类|HTTP服务，又称CommonS_HTTP_LB。|公共服务，同时服务于：SMF/AMF/PCF/UPF……|sc-http-lb-mp|本服务的SC控制单元，负责SC集群管理、弹性控制、升级控制、SC注册&发现、SC负荷分担。
sc-http-lb|HTTP Service|接口管理&转发类|HTTP服务，又称CommonS_HTTP_LB。|公共服务，同时服务于：SMF/AMF/PCF/UPF……|HTTP协议处理，提供能力开发查询功能。
SIG Service|接口管理&转发类|信令服务，又称CommonS_SIG。|公共服务，同时服务于：AMF/PCF/UDM……|sc-sig-mp|本服务的SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-sig|SIG Service|接口管理&转发类|信令服务，又称CommonS_SIG。|公共服务，同时服务于：AMF/PCF/UDM……|SCTP协议处理和负载均衡。
RCP Signal Service|接口管理&转发类|RCP信令服务，又称Npcf_SIGLB。|PCF|sc-pcf-siglb-mp|本服务的SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-pcf-siglb|RCP Signal Service|接口管理&转发类|RCP信令服务，又称Npcf_SIGLB。|PCF|SMS协议处理和负载均衡。
信令业务类|RCP Policy Control|RCP策略控制，又称Npcf_PolicyControl。|PCF|sc-pcm-mp|本服务SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-pcm|信令业务类|RCP Policy Control|RCP策略控制，又称Npcf_PolicyControl。|PCF|策略和计费控制单元，负责2/3/4/5G策略和计费控制业务逻辑。
数据存储类|UDSF Management|非结构化数据管理，又称Nudsf_UnstructuredDataManagement。|公共服务，服务于：SMF/AMF/PCF……|sc-cudr-cdn-mp|本服务SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-cudr-cdn-l|数据存储类|UDSF Management|非结构化数据管理，又称Nudsf_UnstructuredDataManagement。|公共服务，服务于：SMF/AMF/PCF……|内存数据库（左域），提供数据存储、备份和同步。
sc-cudr-cdn-r|数据存储类|UDSF Management|非结构化数据管理，又称Nudsf_UnstructuredDataManagement。|公共服务，服务于：SMF/AMF/PCF……|内存数据库（右域），提供数据存储、备份和同步。
CUDR System Management|数据存储类|云数据系统管理，又称Ncudr_SystemManagement。|sc-cudr-sys-mp|公共服务，服务于：SMF/AMF/PCF……|数据存储控制中心，负责CDN组件的弹性策略控制。
CUDR Access|数据存储类|云数据接入管理，又称Ncudr_Access。|sc-cudr-access-mp|公共服务，服务于：SMF/AMF/PCF……|本服务SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-cudr-access|CUDR Access|数据存储类|云数据接入管理，又称Ncudr_Access。|数据存储接入单元，负责局间CDN访问和数据同步。|公共服务，服务于：SMF/AMF/PCF……
sc-tmsp-nff|CUDR Access|数据存储类|云数据接入管理，又称Ncudr_Access。|TMSP网络转发框架，提供高性能网络报文收发通道。|公共服务，服务于：SMF/AMF/PCF……
CUDR Access Management|数据存储类|云数据接入系统管理， 又称Ncudr_AccessManagement。|sc-cudr-accessmgt-mp|公共服务，服务于：SMF/AMF/PCF……|数据接入控制中心，负责数据接入组件的弹性策略控制。
策略日志类|RCP Policy Log File Management|RCP策略日志文件管理，又称Npcf_LOG。|PCF|sc-log-mp|本服务SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-log|策略日志类|RCP Policy Log File Management|RCP策略日志文件管理，又称Npcf_LOG。|PCF|策略日志单元，负责生成策略日志文件，并可将策略日志文件传递给RCP Policy Log Database或外部日志服务器。
RCP Policy Log Database|策略日志类|RCP策略日志数据库，又称Npcf_LogStoreUnit。|sc-lsu-mp|PCF|本服务SC控制单元，负责本服务SC集群管理、升级控制、SC注册&发现、动态命令等。
sc-lsu|RCP Policy Log Database|策略日志类|RCP策略日志数据库，又称Npcf_LogStoreUnit。|策略日志数据库，对RCP Policy Log File Management提供的策略日志文件进行分析和入库，生成策略报表。|PCF
#### 服务治理机制 
描述 :ZXUN RCP的业务服务组件众多，而且随着5G业务生态的不断壮大，业务服务组件可能会越来越多，必须有一套治理机制来保障服务间的交互、通信能够快速、安全、可靠地完成。
ZXUN RCP根据自身特点提供了服务治理服务-微服务治理（Service Governance）。该服务可以提供业务服务组件的注册、发现，以及服务间内部通信支撑。
##### 服务组件注册发现机制 
不同类型的SC间，通过[SCR]（Service Component Responsible，SC注册中心）来实现注册和发现。双方根据服务名称来发现对方的[SCCU]（Service Component Control Unit，服务组件控制单元）主用节点，从SCCU获取对方的节点列表、节点状态、转发策略。SCCU主用节点和使用本服务其他[SCI]（Service Component Instance，服务组件实例）间保持服务节点和转发策略的实时同步。
服务组件注册发现机制如[图1]所示。
图1  服务组件注册发现机制

##### 服务组件间内部通信机制 
ZXUN RCP提供了两个管理中心用于保证服务组件间的内部通信。
服务管理中心SCCU之间的服务管理中心。由Service Governance中的服务组件sc-tmsp-smc提供SCR功能，用于存储SC注册信息和提供订阅发现能力。通过服务组件注册发现机制，实现本端SC和对端SC的转发信息的同步。 
通信管理中心SCI之间的通信管理中心。由Service Governance中的服务组件sc-tmsp-mgt提供服务组件之间的可靠性通信和RAW通信能力，同时负责维护内部通道的链路健康状态检测。 
服务组件间内部通信机制如[图2]所示。
图2  服务组件间内部通信机制

服务组件间内部通信机制说明： 
服务间转发信息同步：依靠服务管理中心提供的服务注册发现机制，各服务相互同步各自的转发表信息到SCCU保存，SCCU再将转发信息同步给本服务内的SC，为各自SC间通信提供转发规则数据。 
通信节点管理：由通信管理中心提供对内部管理面、内部业务面两个通信平面的网络状态提供健康检测。 
服务组件间通信：依靠SCCU同步的转发表信息，完成和其他SC的点对点通信。 
### 业务原理 
5G用户经过5G NR无线网络接入，并通过5GC网络接入DN，进行各种数据业务。5G接入的系统架构图如[图1]所示。
图1  5GC组网架构

在业务流程中，ZXUN RCP与周边网元的交互都是通过服务间的交互来实现的。
本节以ZXUN RCP的典型业务流程为例，对支撑业务功能的微服务间相互配合的工作流进行描述，说明外部业务功能对应的产品内部实现。
#### SM策略关联建立流程 
图1  SM策略关联建立流程

步骤说明参见下表。 
顺序关系|说明
---|---
1->2->3|UE发起PDU Session建立，PCF收到SMF发出的Npcf_SMPolicyControl_Create_Request消息，经Interface Management完成负载均衡，并将消息转发到服务化接口管理服务HTTPService，最终到达RCP Policy Control服务进行处理。
4->5->6->7->8->9|RCP Policy Control收到消息后向SPR获取该UE相关的签约数据。
10->11->12|PCF根据签约和无线网接入等信息决策会话关联策略，发送Npcf_SMPolicyControl_Create_Response消息经由HTTP Service、Interface Management到达SMF。
#### AM策略关联建立流程 
图1  AM策略关联建立流程

步骤说明参见下表。 
顺序关系|说明
---|---
1->2->3|UE发起附着流程，PCF收到AMF发出的Npcf_AMPolicyControl_Create_Request消息，经Interface Management完成负载均衡，并将消息转发到服务化接口管理服务HTTP Service，最终到达RCP Policy Control服务进行处理。
4->5->6->7->8->9|RCP Policy Control收到消息后向SPR获取该UE相关的签约数据。
10->11->12|PCF根据签约和无线网接入等信息决策接入和移动性限制策略，发送Npcf_AMPolicyControl_Create_Response消息经由HTTP Service、Interface Management到达AMF。
#### UE策略关联建立流程 
图1  UE策略关联建立流程

步骤说明参见下表。 
顺序关系|说明
---|---
1->2->3|UE发起附着流程，PCF收到AMF发出的Npcf_UEPolicyControl_Create_Request消息，经Interface Management完成负载均衡，并将消息转发到服务化接口管理服务HTTP Service，最终到达RCP Policy Control服务进行处理。
4->5->6->7->8->9|RCP Policy Control收到消息后经由SIG Service、Interface Management向SPR获取该UE相关的签约数据。
10->11->12|PCF订阅UE策略关联的相关事件，发送Npcf_UEPolicyControl_Create_Response消息经由HTTP Service、Interface Management到达AMF。
13->14->15|PCF需要向UE订阅UE策略安装结果信息通知，发送Namf_Communication_N1N2MessageSubscribe_Request消息经由HTTP Service、Interface Management到达AMF，AMF将此消息经由RAN透传给UE。
16->17->18|AMF收到UE发送的订阅UE策略通知应答后，发送Namf_Communication_N1N2MessageSubscribe_Response消息经由Interface Management、HTTP Service到达PCF。
19->20->21->22->23->24|PCF根据签约和无线网接入等信息决策UE策略，发送Namf_Communication_N1N2MessageTransfer_Request消息经由HTTP Service、Interface Management到达AMF。AMF立即回复Namf_Communication_N1N2MessageTransfer_Response消息，经由InterfaceManagement、HTTP Service发送给PCF，同时也将Namf_Communication_N1N2MessageTransfer_Request消息经由RAN发送给UE。
25->26->27|AMF收到UE策略安装结果后，发送Namf_Communication_N1MessageNotify_Request消息经由Interface Management、HTTP Service到达PCF。
28->29->30->31->32->33|PCF收到AMF的Namf_Communication_N1MessageNotify_Request消息，指示UE策略安装结果为MANAGEUE POLICY COMPLETE，则PCF经由SIG Service、InterfaceManagement向SPR更新UE策略。PCF收到AMF的Namf_Communication_N1MessageNotify_Request消息，指示UE策略安装结果为MANAGE UE POLICY COMMAND REJECT，则PCF会将UE策略恢复为本次决策前的策略，不会保存本次决策的UE策略，并且不向SPR更新UE策略。
34->35->36|PCF回复Namf_Communication_N1MessageNotify_Response消息经由HTTPService、Interface Management给AMF，AMF将结果经由RAN透传给UE。
#### VoNR专载建立和位置上报流程 
图1  VoNR专载建立和位置上报流程

步骤说明参见下表。 
顺序关系|说明
---|---
1->2->3->4->5->6|UE发起PDU Session建立，PCF收到SMF发出的Npcf_SMPolicyControl_Create_Request消息，经Interface Management完成负载均衡，并将消息转发到服务化接口管理服务HTTPService，最终到达RCP Policy Control服务进行处理。PCF决策会话关联策略，发送Npcf_SMPolicyControl_Create_Response消息经由HTTP Service、Interface Management到达SMF。
7->8->9->10->11->12|PCF向BSF发送Nbsf_Management_Register_Request消息。BSF存储绑定信息，向PCF回复Nbsf_Management_Register_Response消息。
13->14->15->16->17->18->19->20->21->22|AF收到IMS用户注册请求或新的呼叫请求，构造Rx接口的AAR消息发送给DRA。DRA收到AAR消息，向BSF查询N7会话绑定信息，DRA向BSF发送Nbsf_Management_Discovery_Request。BSF查询到注册的N7会话绑定信息，使用Nbsf_Management_Discovery_Response向DRA提供该绑定信息。DRA从绑定信息中读取PCF的Diameter主机名和域名，将AAR请求发送到对应的PCF。PCF处理AAR消息，回复AAA消息。DRA转发AAA消息给AF。
23->24->25->26->27->28|PCF对VoNR业务进行决策，构造PCC规则，通过绑定N7会话的Npcf_SMPolicyControl_UpdateNotify_Request下发给SMF，触发专载建立和查询用户位置。SMF校验PCC规则信息通过，返回Npcf_SMPolicyControl_UpdateNotify_Response，并触发专有QoSFlow建立。
29->30->31->32->33->34|SMF获取到用户最新位置或时区信息后，通过Npcf_SMPolicyControl_Update_Request将最新位置或时区信息上报给PCF。PCF回复成功Npcf_SMPolicyControl_Update_Response，并更新用户位置或时区信息。
35->36->37->38->39->40->41->42|PCF通过Rx-RAR携带更新用户位置或时区信息发送给DRA，并经DRA转发给AF。AF获取到最新的用户位置或时区信息，返回成功Rx-RAA，通过DRA转发给PCF。
### 参考 
SC :全称 :Service Componen，服务组件 
解释 :ZTE定义的服务组件，多种SC组成NFS或Common Service微服务架构下的最小单元，具备独立的负荷分担、集群管理、弹性功能。
#### SCI 
全称 :Service Component Instance，服务组件实例 
解释 :SC集群内的业务处理节点，即服务节点，以进程为单位。
#### SCCU 
全称 :Service Component Control Unit，服务组件控制单元 
解释 :SCCU是SC的主控节点，管理SC的集群节点状态、负荷分担规则、弹性迁移控制、节点故障处理、服务注册和服务发现的源端点。
#### SCCU Agent 
全称 :SCCU Agent，服务组件控制单元的客户端 
解释 :SCCU Agent驻留在每个SC上，负责向SCCU进行注册，向SCCU获取本SC的实例号。
#### SCR 
全称 :Service Component Repository，SC注册中心 
解释 :SC仓库，内部SC间的注册发现，提供客户端LIB库和VNFM/EMS接口，完成业务视角监控管理。
#### SMC 
全称 :Service Manager Control，服务管理 
解释 :服务管理组件包括EMC、LTM、SCR等。
#### EMC 
全称 :Elasticity Manager Control，弹性管理中心 
解释 :弹扩控制中心，负责弹缩策略的处理，收集到SC的KPI上报后，决策出是否需要弹缩。
#### LTM 
全称 :Logical Topology Management，业务逻辑拓扑管理 
解释 :NF/NFS/SC的关系管理，作为业务逻辑的管理入口。例如对NF查询的动态管理命令。
#### VNM 
全称 :Virtual Node Manager，虚拟节点管理 
解释 :VNM和VNFM接口，共同完成VNF内VM的生命周期管理。
#### IaaS 
全称 :Infrastructure as a Service，基础设施即服务 
解释 :为用户提供计算、存储和网络等硬件资源的服务。基于此服务，用户能够部署和运行任意软件，包括操作系统和应用程序。 
## 缩略语 
## 缩略语 
5GC :5G Core Network5G核心网
AAA :Answer-Auth-Answer应答鉴权响应
### AAR 
Answer-Auth-Request应答鉴权请求
AF :Application Function应用功能
AMF :Access and Mobility Management Function接入和移动管理功能
### API 
Application Programming Interface应用编程接口
BSF :Binding Support Function绑定支持功能
### BSS 
Business Support System业务支撑系统
### CIM 
Container Infrastructure Manager容器基础设施管理器
### COTS 
Commercial Off The Shelf商用货架产品
### CP 
Content Provider内容提供商
### DN 
Data Network数据网
### DRA 
Diameter Routing AgentDiameter路由代理
### DVS 
Distributed Virtual Switch分布式虚拟交换机
### EMC 
Elastic Management Center弹性管理中心
EMS :Element Management System网元管理系统
ETSI :European Telecommunications Standards Institute欧洲电信标准化协会
HTTP :Hypertext Transfer Protocol超文本传输协议
IMS :IP Multimedia SubsystemIP多媒体子系统
### IaaS 
Infrastructure as a Service基础设施即服务
### KPI 
Key Performance Indicator关键性能指标
### LIB 
Label Information Base标签信息库
### LTM 
Logical Topology Management逻辑拓扑管理
NF :Network Function网络功能
NFS :Network Function Service网络功能服务
NFV :Network Functions Virtualization网络功能虚拟化
NFVO :Network Functions Virtualization Orchestrator网络功能虚拟化编排器
### NR 
New Radio新无线
### NS 
Network Service网络服务
OAM :Operation, Administration and Maintenance操作管理维护
### OSS 
Operation Support System运营支撑系统
PCC :Policy and Charging Control计费和策略控制
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
PDU :Packet Data Unit分组数据单元
### POD 
Point of Deployment部署单元
### PaaS 
Platform as a Service平台即服务
QoS :Quality of Service服务质量
### RAA 
Re-Auth-Answer重新鉴权响应
RAN :Radio Access Network无线接入网
### RAR 
Re-Auth-Request重新鉴权请求
RCP :Resource Control Platform资源控制平台
SC :Service Component服务组件
### SCCU 
Service Component Control Unit服务组件控制单元
### SCR 
Service Component Repository服务组件仓库
### SDK 
Software Development Kit软件开发工具
SMF :Session Management Function会话管理功能
SMS :Short Message Service短消息业务
### SP 
Service Provider服务提供商
SPR :Subscription Profile Repository用户签约数据库
### SR-IOV 
Single-Root I/O Virtualization单根I/O虚拟化
### SSH 
Secure Shell安全外壳协议
### SaaS 
Software as a Service软件即服务
UE :User Equipment用户设备
VIM :Virtualized Infrastructure Manager虚拟化基础设施管理系统
VM :Virtual Machine虚拟机
VNF :Virtualized Network Function虚拟化网络功能
VNFM :Virtualized Network Function Manager虚拟化网络功能管理器
### VRU 
Virtual Running Unit虚拟运行单元
VoNR :Voice over New Radio新空口承载语音
## 安全描述 
### 安全问题描述 
### 安全问题描述 
#### 安全风险 
ZXUN RCP产品符合ITU-T X.805电信安全体系框架。ITU-T X8.05中定义威胁模型如[图1]所示。
图1  威胁模型

ZXUN RCP的资产信息包括：
用户的签约数据 
系统运维数据 
为不同角色的操作员提供对系统进行管理的能力 
ZXUN RCP的资产面临的主要威胁参见[表1]。
安全威胁名称|安全威胁描述
---|---
用户非法访问风险|非授权用户接入或访问系统。通过猜测口令非法接入系统。
用户非法操作风险|恶意用户进行授权范围之外的操作。授权用户可能因为误操作等原因进行了非期望的操作。
安全审计风险|用户对自己的操作进行抵赖，或者试图绕过安全审计。
数据泄露风险|攻击者尝试非法获取系统的关键资产信息。
数据篡改风险|攻击者通过恶意手段，进行伪装，对数据进行截取，篡改，恶意删除。
欺诈风险|攻击者通过窃取信息，将自己伪装成系统的合法用户。
DoS攻击风险|带宽型DoS攻击：使用大量的流量占用可用的网络带宽。资源型DoS攻击：使用具有针对性的流量，每种流量都可以占用大量的资源，从而耗尽CPU、TCP连接等系统资源。崩溃型DoS攻击：利用应用或系统的bug，如通过畸形消息或者报文等对系统进行攻击。
RCP VNF的资产信息包括：
RCP提供服务的能力 
RCP中的用户数据 
在NFV架构下，为实现各层面的互操作性，APP、虚拟化平台、硬件、云管理必须具备开放性，同时新增加了网元、接口和中间件，出现了新的安全风险。 
在RCP虚拟化系统架构中，接口有三种：
VNF对外接口：继承物理机时代传统组网方式的对外接口。 
NFVI提供的访问接口：包括：提供给VIM的Nf-vi接口。供VNF调用的Vn-nf接口。 
MANO部分的访问接口：包括：客户端接入接口。网元之间通讯的接口，包括Os-Ma、Se-Ma、Ve-Vnfm、Nf-vi、Or-Vnfm、Vi-Vnfm、Or-Vi接口。 
与RCP VNF相关的接口是VNF对外接口和NFVI提供的访问接口。对于VNF对外接口，安全威胁也是继承物理机时代的传统威胁。NFVI提供的访问接口是虚拟化下的新增接口，引入的安全威胁主要包括：
资源共享带来的风险 
虚拟机生命周期中的风险 
#### RCP系统的安全目标 
ZXUN RCP的安全目标为保证CIA三元组原则：
C：Confidentiality，保密性，被保护的资产不能被非授权访问。 
I：Integrity，完整性，被保护的资产不能被非授权修改。 
A：Availability，可用性，确保在需要的时候允许和可以执行访问。 
#### RCP的安全层次 
RCP的安全分为以下两个层次：
基础设施层，包括：操作系统数据库：含内存库和文件存储IP组网隔离 
应用层：ITU-T X.805模型中对保护的对象划分为三个平面：管理面、控制面、用户面。系统的安全架构只涉及控制面和管理面，不涉及用户面。管理平面：OAM控制平面：GSU/LOG/LSU功能 
#### 安全总体策略 
中兴通讯基于多年ZXUN RCP设备开发经验和安全实践，确定如下总体策略：
安全规划：遵循国际和国内安全标准，将业界安全最佳实践和安全技术要求规划到安全基线中，不断提高产品安全水平。 
立体防护：通过在安全的纵向、横向两个维度采取立体安全措施保障产品安全。 
分权分域：提供分权分域的技术手段，在产品部署中，根据任务所需权限和资源的具体情况分配用户最小的权限和资源以减少潜在的安全威胁。 
审计跟踪：记录安全事件，事后进行追踪，改进产品安全措施。 
### 应用层安全 
### 应用层安全 
#### 权限管理 
OAM用户在EM上被分配。当使用OAM上的安全功能时，先要到EM上进行登录认证。 
##### 帐号安全策略 


OAM用户支持以下帐号安全策略：



 
支持设置帐号为临时用户。 

 
支持设置帐号为禁用。 

 
支持设置帐号自动禁用前最大未登录天数。 

 
支持设置帐号有效时间。 

 
支持设置帐号暂停时间。 

 
支持帐号锁定。 

 
同一户如果连续多次登录失败需要发出告警信息并记录安全日志。 

 
帐号信息加密保存。 

 


帐号锁定支持以下策略： 



 
帐号不锁定。 

 
帐号登录时连续输入密码出错超过设定次数后锁定帐号。 

 
帐号登录时连续输入密码出错超过设定次数后锁定帐号，从锁定开始经过设定时间后自动解锁。 

 
帐号过期前提示。 

 


##### 密码安全策略 
OAM用户支持以下密码安全策略：
用户下次登录前必须修改密码。 
用户不能修改密码。 
可设置用户密码的最长存留期。 
可设置用户密码的最短存留期。 
密码过期提示。 
可设置密码复杂度。 
可设置密码最小长度。 
可设置密码最大长度。 
可设置密码不能与最近旧密码重复。 
可设置密码不能与用户名重复，不能是用户名的二次重复，不能是用户名的逆序。 
密码信息加密保存。 
##### 内控管理安全策略 


内控管理是指通过对存储系统、FTP、Telnet等帐户的密码进行管理来保证系统数据访问的安全性。


内控管理支持以下安全策略： 



 
只有OAM系统管理员或者具有内控模块权限的帐户，才能操作管理内控功能。 

 
帐号密码加密存储，保证其安全性。 

 
密码支持策略控制，如密码长度、密码强弱等。 

 
密码支持过期设置和过期自动提醒功能。 

 
支持设置密码不能与最近旧密码重复。 

 
密码在网络上进行加密传输。 

 


##### 分权分域 
随着集成化程度不断提升，网元容量越来大。一个网元覆盖多个行政、地理区域的情况已是普遍现象。由于多方面原因，运营商对业务仍然采用分区域运营的方式。为了避免各区域的运维出现相互干扰，ZXUN RCP提供“对用户分级授权、对业务分区管理”的功能。 
分权指对用户的操作权限进行授权，控制用户只能执行哪些命令或操作集。限定用户只对一定区域的某些内容执行允许的操作，以保证网管系统的操作安全。 
分域是指业务特性可以按域配置，不同域的用户可享受不同的服务。 
对于网管配置数据，只对业务相关配置进行分域，业务相关的全局配置不分域，避免重复配置。 
对“策略数据”的规则配置和场景配置进行分域。原有命令树上的“策略数据配置”节点仍然保留，但节点内不再有规则配置和场景配置。 
对于规则配置和场景配置，业务程序先以业务域为索引查询相关配置。如果查询成功，则使用本次查询结果。如果查询无结果，则以0为索引再次查询获得结果。 
#### 接入控制 
#### 接入控制 
##### OAM用户登录控制 
OAM用户登录时，需对输入的用户名和密码进行鉴权。当用户登录成功后，对其执行的每一条命令进行鉴权，如果没有相应权限，将被禁止执行。 
OAM功能还支持客户端IP白名单过滤功能，支持为每个用户配置允许登录的IP地址范围。当用户不在配置的登录范围时，登录将被拒绝。
##### 5G服务访问授权 
5G中的PCF，支持服务化架构中的OAuth2.0特性。当网络功能服务消费者（如：AMF、SMF）在访问网络功能服务生产者（如：PCF）提供的服务时，要通过OAuth2.0协议定义的Client Credentials（客户端凭证）方式来实现服务访问授权。该特性是3GPP为网络功能服务访问而定义的一种安全机制。
#### 数据机密性安全 
#### 数据机密性安全 
##### 传输安全 
ZXUN RCP与外部系统传输的信息涉及到用户和运营商的敏感信息。ZXUN RCP使用多种加密方式来保证数据传输过程中的安全性，各子系统支持的加密方式如[图1]所示。
图1  ZXUN RCP子系统支持的加密方式

##### 敏感数据加密存储 


ZXUN RCP各个子系统中使用的帐户、密码、网管配置的鉴权密钥，以及文件系统中存储的用户鉴权等涉密信息，均采用业界常用的不可逆加密算法进行加密存储，以防止攻击者从文件系统或者备份文件中获取敏感数据。


#### 数据存储安全 
#### 数据存储安全 
##### 分布式地理容灾特性 
在出现火灾、地震、人为破坏等意外情况时，会导致业务中断、用户数据丢失等严重后果。为了提高设备的安全性，ZXUN RCP支持两种容灾方式：冷备容灾和热备容灾。 
容灾方式|容灾方式说明|应用场景|优点|缺点
---|---|---|---|---
冷备容灾|冷备容灾的多个RCP之间，没有容灾链路，不进行用户会话数据的实时备份，即备用的RCP上，不包含任何业务信息。因此当主用RCP故障时，会短暂影响用户的上网业务。|常用于数据业务APN。|投资成本低。|RCP之间无实时备份用户会话数据。RCP1故障时，用户接入RCP2，RCP2按照用户新接入处理。
热备容灾|热备容灾的RCP间通过建立同步链路，实时备份用户的所有数据。每当用户数据进入稳态时，RCP将执行备份操作，因此当主用RCP故障时，不会影响用户的上网业务。|常用于VoLTE APN。|RCP之间实时备份用户数据，主RCP故障时，PCEF/DRA/SMF/AMF检查到其中一个RCP故障，能够将业务信令指向容灾RCP，容灾RCP收到故障RCP的会话消息后，能正常处理。|由于需要预留容量来备份对端RCP的用户会话数据，系统容量下降一半，投资成本高。
##### OAM用户的数据备份和恢复 
备份恢复是指手动或自动将系统的数据保存在本地，当系统崩溃、用户误操作、系统升级失败等情况下，能够及时将系统恢复到可用状态，提高系统的稳固性和安全性。 
目前OAM支持的备份包括： 
基本配置数据 
IP协议栈配置数据 
安全数据 
日志数据 
OAM数据库文件 
备份输出文件路径，可以选择本地服务器磁盘，也可以选择远端的FTP/SFTP服务器路径。恢复数据时，同样可以选择本地服务器磁盘上的备份文件，也可以选择远端的FTP/SFTP服务器上的备份文件。
在EM中，通过执行恢复命令，输入备份文件名、备份路径，FTP/SFTP用户名及密码，恢复OAM的数据。 
#### 日志安全 
ZXUN RCP有着完善的OAM日志安全策略，便于系统管理员进行监督和检查。OAM日志包括操作日志、安全日志和系统日志。OAM日志信息的生成、查询、保存支持如下策略：
日志信息生成ZXUN RCP记录所有的关键性系统事件日志，包括：服务启动、关闭、中断和恢复登录时间帐号管理用户执行的所有操作系统时间的修改系统重要失败事件日志包含以下信息：事件的日期时间事件类型事件操作者事件结果 
日志信息查询OAM仅允许授权用户访问日志信息，向用户提供的日志信息具有唯一、明确的定义和方便阅读的格式，并可根据以下信息进行检索：事件的日期时间事件类型事件主体事件课题 
日志信息保护OAM的日志保存在OAM所在虚拟机的硬盘中，并定期进行自动备份。系统支持将操作日志导出并转储到外部服务器上。 
#### 应用安全 
应用层面临的风险主要来自两种类型的DoS攻击以及欺诈。
崩溃型DoS攻击：利用应用或系统的bug，如通过畸形消息或者报文等对系统进行攻击。 
资源型DoS攻击：使用有针对性的流量，每种流量都可以占用大量的资源，从而耗尽CPU、TCP连接等系统资源。 
欺诈风险：攻击者通过窃取信息，将自己伪装成系统的合法用户。 
针对崩溃型DoS攻击，ZXUN RCP在设计时就全面考虑各种畸形消息和异常场景，并且在产品测试中有效利用业界的安全测试工具进行测试和验证。而对于资源型的Dos攻击，ZXUN RCP系统具备完善的过负荷控制手段，有效的防止资源滥用。
#### 过负荷控制 
ZXUN RCP支持在业务处理层上进行灵活的过负荷控制。业务处理层上的过负荷控制机制包括：
系统资源过负荷控制机制根据系统CPU的利用率、内存资源占用率或License在线用户容量，配置不同的过负荷控制级别。通过不同的过负荷控制级别，实现告警或控制用户会话接入。根据请求消息的业务类型和消息类型，配置系统资源处于不同负荷等级下的消息通过率，使得较重要的业务请求可以被优先处理。 
流量过负荷控制通过配置系统能承受的全局或邻接局的流量阈值，实现基于局向和业务类型的流量过负荷控制及告警。 
### 虚拟化安全 
#### 操作系统安全 
RCP VNF使用CGSL/CGEL操作系统，CGSL/CGEL是由中兴通讯开发的电信级Linux OS。它不仅提供出色的服务器操作系统功能和定制化的服务，而且提供强大的安全机制。
系统定制为了降低服务器操作系统的安全风险，去除不必要的系统部件并关闭不必要的系统服务。ZTE的OS提供了高度定制的系统功能和服务：系统服务定制：根据产品要求，只安装和启动必要的系统服务，从而大大降低外部入侵风险。为系统目的定制：根据产品用途，操作员决定是否安装图形环境及其应用程序，是否安装一些大型系统部件等。系统部件的定制：根据产品要求，操作员以软件包为单位对系统进行定制。系统操作定制：根据产品要求，操作员设置支持正常产品功能的最小操作（命令）集合，再决定支持此集合的最小系统。 
系统补丁跟踪软件维护方发布的安全补丁，确认ZTE OS是否存在相关问题；验证安全补丁，形成内部安全补丁。同时，ZTE OS团队继续使用主流系统安全扫描工具进行相关测试和验证，给出安全问题的解决方案并形成内部安全补丁。在ZTE OS的安全补丁发布到产品后，产品团队再次进行验证，之后根据生产应用情况实施。 
系统访问控制ZTE OS的强制访问控制基于安全增强型Linux（SELinux），为每个独立的程序级别提供精确的访问控制。使用SELinux的每个环境都可以定义适用于实际情况的最适当的安全策略。在特定环境中，用于SELinux检查是否允许访问的规则集称为SELinux策略。SELinux内核保存将在SELinux策略文件中实施的所有规则。这些策略在系统引导期间加载到内核，作为访问控制决策的基础。 
系统日志提供全面的日志系统。日志类型包括通用日志、用户登录日志、用户操作日志、系统性能日志、系统审核日志等。系统日志守护进程从内核、应用程序和远程服务器接收日志消息。系统处理方法包括在本地日志文件中写入、在用户终端上显示、转发到远程服务器等。将日志转发到远程服务器的功能可用于规划集中式日志服务器，以便长期安全存储系统日志。 
#### 共享资源安全 
虚拟化需要隔离计算资源，确保每个虚机都能获得相对独立的物理资源。此外，还应确保虚机异常不会影响Hypervisor和其他虚机。Hypervisor隔离在同一物理机上运行的虚机，访问虚机的用户只能使用属于虚机自己的资源。 
vCPU隔离x86架构提供4个特权级别，范围从最特权的环0到最不特权的环3。操作系统内核在环0中运行。操作系统服务在环2中运行，用户应用程序在环3中运行。Hypervisor阻止虚机的Guest OS执行所有特权指令，并将操作系统与应用隔离。不同虚拟机之间的核隔离可分为两个级别：vCPU级别的虚机内部线程隔离和主机级别的vCPU隔离。 
虚拟内存隔离虚机使用内存虚拟化技术，将物理内存虚拟化并隔离虚拟内存。虚机上的操作系统将虚拟地址转换为物理地址，Hypervisor先将客户端的物理地址转换为计算机地址，再将计算机地址发送到物理服务器。不同虚拟机之间的内存相互隔离。在虚机创建过程中，为虚机分配的内存大小。记录每个计算节点的内存大小。当调用虚拟机时，系统会将每个节点上的剩余内存与虚拟机请求的内存进行比较，并在满足条件时进行部署。 说明：重点关注NFV安全标准中提到的IOMMU风险解决方案。 
内部网络隔离在传统网络中，通常将设备分成管理平面、控制平面和用户平面，这些平面在物理上分离，使得三种数据流相互不受影响，这种部署方法符合ITU-T X.805的三平面安全划分原则。在NFV架构下，虽然引入虚拟化后使得三种数据流存在合用硬件、接口的可能性，但为了保障业务的独立性，在物理层面以及虚拟化逻辑层面进行网络的隔离依然是NFV系统的重要安全手段之一。物理网络隔离：虚拟化后网络存在云管理、存储、VNF应用三类数据，将三类数据在物理层分成不同的平面，对于硬件设施，通过带外进行管理。逻辑网络隔离：对于NFV的网络，可以划分不同的安全域，例如EHD（Exposed Host Domain）、DMZ（Demilitarized Zone）、MZ（Militarized Zone）、SEC（Secure network）和Mgmt（management zone）等。对于VNF内的VNFC网络的隔离，在虚机内部通过VLAN或者VXLAN进行逻辑网络的划分，同时针对不同的业务流设置不同的vNIC。 
存储隔离存储隔离要求包含以下几个方面：建立主机和LUN的对应关系，防止主机对非对应LUN的访问。不同的主机群集使用不同的存储群集。租户对存储资源池访问隔离，设置主机、集群、存储资源池关联关系，在资源划分时，租户对应只能访问授权存储资源。 
SLA保障在资源隔离后，为了防止Dos对基础设施级别的攻击，需要一种机制来确保服务级别SLA。预留CPU、内存，并限制最大和最小配额，以保证计算资源随流量而变化，虚机动态调度资源。此外，为CPU、内存、存储设置优先级（高、中、低）。对于不同的优先级，虚机提供不同的SLA服务能力。Hypervisor将根据虚机的资源利用率向优先级较高的虚机调度资源，以确保优先级较高的虚机的正常运行。对于存储IO和网络IO，访问和读/写吞吐量能力可受到虚机优先级的限制，以确保具有较高优先级的虚机的稳定性。 
#### 虚拟机生命周期中的安全 
虚机在生命周期的创建、启动、迁移、弹性和停止过程中存在安全风险。 
启动风险：虚拟机镜像可能在传输或存储期间被篡改，导致虚拟机启动异常。 
迁移风险：某些物理主机可能存在安全隐藏问题，如果虚拟机迁移到这些不安全的物理服务器，将给虚拟机带来安全风险。 
在迁移、删除和再生过程中的数据重构风险：如果在虚机释放物理存储后未有效删除剩余数据，则新虚机在使用这些存储时可以分析和重构剩余数据。 
针对启动风险，虚机应提供安全的启动功能，包括： 
镜像完整性检查：这主要是为了防止文件在传输和存储过程中被恶意篡改，导致安装识别或服务操作异常。 
安全BOOT：为Linux物理主机提供TBoot引导安全加载功能（TPM）。可以对seaBIOS和Guest OS进行安全性检查。 
图1  Security BOOT

针对虚拟机数据重构中的风险，虚拟化平台应有效地删除和回收资源。 
VM资源回收可分为两种： 
VNFM检测VM异常并通知VIM对资源进行回收。 
VIM启动VM迁移，VIM自动运行VM资源回收。 
在资源回收过程中，VIM应考虑： 
有效释放CPU资源。 
有效移除和释放内存资源。 
重置网络资源，需要将VF网卡和VLAN的MAC地址重置为初始状态。 
有效地删除和释放存储资源，包括虚机物理存储上的所有数据，如镜像和快照文件。 
### 产品安全保障 
设置安全事件跟踪机制，一方面定期更新系统的补丁，另一方面当出现安全的突发事件时会快速响应，及时发布补丁更新和安全加固。 
RCP版本发布前，使用Nessus工具进行系统的漏洞扫描。 
### 遵循的标准 
中兴通讯产品安全要求总则 
中兴通讯产品安全基线技术要求 
中兴通讯 00114.29-2018  产品开发 产品安全规范 
Common Criteria for Information Technology Security Evaluation,
Version 3.1 Release 4, September 2012 Part 1: Introduction and general
model 
Common Criteria for Information Technology Security Evaluation,
Version 3.1 Release 4, September 2012 Part 2: Security functional
requirements 
GB/T 25069-2010 信息安全技术-术语 
中国电信〔2011〕555号关于印发操作系统等安全配置要求的通知 
中国移动网络云网络安全技术要求 
中国移动5G网络安全技术规范 
中国移动5G设备通用安全功能和配置要求 
## 缩略语 
## 缩略语 
### CPU 
Central Processing Unit中央处理器
### DoS 
Denial of Service拒绝服务
FTP :File Transfer Protocol文件传输协议
GSU :General Service Unit通用业务单元
### IOMMU 
Input/Output Memory Management UnitI/O内存管理单元
### ITU-T 
International Telecommunication Union - Telecommunication Standardization Sector国际电信联盟－电信标准部
### LSU 
Log Storage Unit日志存储单元
OAM :Operation, Administration and Maintenance操作管理维护
PCF :Packet Control Function分组控制功能
RCP :Resource Control Platform资源控制平台
SFTP :Secure File Transfer Protocol安全文件传输协议
TCP :Transmission Control Protocol传输控制协议
## 配置管理描述 
### 配置管理概述 


配置管理提供了对NF正常运行所需要数据进行管理的功能。


#### 配置数据的组成 


##### 数据配置的定义 
数据配置是指制作能够使通信设备正常运行的数据，并将这些数据设定到通信设备的一种操作。 
NF提供增加、删除、修改、查询、存储、备份、恢复等操作手段，可对NF运行的各种数据（如信令数据、号码分析数据）进行有效的管理和维护。


##### 配置数据的类别 
NF的配置数据包括基础数据、对接数据、业务数据。 

 
基础数据基础数据是NF配置数据的基础，主要用于定义全局性的NF数据。基础数据的配置使得NF具备软件逻辑，从而能作为网络实体提供通信服务。基础数据所定义的参数包括本局信令地址等，这些关键参数在后续的数据配置过程中将被多次引用。由于受到数据库存储过程的限制，一旦操作员通过数据配置命令创建这些关键参数，其在后续的数据配置过程中就不能随意地删除或修改这些关键参数。操作员应十分重视基础数据的规划，便于操作员对配置数据的管理与维护，也便于将来系统扩容或软件升级时操作员对配置数据库进行扩展。 

 
对接数据对接数据是NF配置数据的重要组成部分，用于定义本NF在与其它NF对接时信令、协议等密切相关的数据，如SCTP数据、M3UA数据、SCCP数据，根据本NF功能不同，对接的NF类型也不相同。配置对接数据是运营商通过NF开展各种业务的必要前提，但由于系统组网的复杂性，各种组网条件下的对接数据的配置过程也各不相同。为了降低数据配置的复杂度，建议操作员在配置对接数据之前，按照组网功能（或用途）将复杂的系统组网分解为多个相对独立的组网单元，再执行对接数据配置操作。 

 
业务数据配置业务数据是运营商通过NF开展各种业务、实现各种功能的最终体现，也是操作员在日常维护中需要经常操作的内容。 

 


#### 配置数据的应用场景 


NF数据配置的主要场景包括：



 
开局阶段的初始配置：配置数据为空，需要进行全局性的数据配置。在开局时，经过硬件安装、软件安装、初验、终验等一系列工程实施与交付流程之后，需要进行初始数据配置，从而激活系统业务。 

 
维护阶段的调整配置：由于网络参数改变（如新增NF、链路等），需要增加或修改局部数据。设备正式入网运行后，在日常维护过程中，当系统资源不足，链路数太少或者负荷、局向路由不均衡时，需要进行配置调整的操作。 

 


#### 配置数据的配置方式 
##### MML命令配置和脚本文件配置 
根据操作员在执行配置数据时的操作类型，NF的数据配置方式分为：
MML命令配置也称为逐条配置，此种方式是指在MML命令界面上依次对每一条命令进行配置。这是一种最通用的配置方式，所有的配置数据都可以通过这种方式完成。 
脚本文件配置也称为脚本配置，此种方式是将配置数据做成脚本文件，操作员只需执行这些脚本文件就可以完成数据配置。 
##### 在线配置和离线配置 
根据配置数据是否能即时生效，NF的数据配置方式分为： 
在线配置是指数据立即下发的配置方式。此种方式的配置过程是EM和NF实时交互的过程，配置数据即时生效。 
离线配置是指数据在EM下发到NF暂不生效，EM下发同步命令后批量生效的配置方式。通过此种方式配置的数据，需要将数据从NF-OAM数据库下发到NFS-OAM内存数据库后才能生效。 
#### 配置数据库简介 


定义 :NF采用关系型数据库对系统的各种数据进行管理，整个数据库由多张具有一定内在联系的数据表组成，每张数据表描述一组特定的数据，各数据表之间通过特定的关键字段进行索引和被索引。


##### 数据库类型 
按照存储位置的不同，NF的数据库分为NFS-OAM内存数据库与NF-OAM数据库两大部分。

 
NFS-OAM内存数据库NFS-OAM内存数据库是指在NF各NFS-OAM内存区的数据库，主要用于存储与业务处理密切相关的数据。操作员在EM的命令窗口执行配置命令增加、删除、修改数据后，NFS-OAM内存数据库中的数据文件会同时更新。 

 
NF-OAM数据库NF-OAM数据库是指在NF-OAM上的PostgreSQL数据库，基于中兴通讯公司的CGSL操作系统，主要用于存储支撑NF运行的相关数据信息。运行数据存放在PostgreSQL数据库中，如图1所示。图1  NF-OAM数据库

 

 


##### 数据库管理功能 
NF的数据配置和数据库管理功能包括： 

 
提供增加、删除、修改、查询、存储、备份、恢复等数据库操作手段。 

 
可对系统运行的各种数据（如硬件数据、信令数据、路由数据、号码分析数据、移动业务数据等）进行有效的管理和维护。 

 
支持离线和在线配置数据。 

 
支持近端配置和远程配置。 

 
支持数据在线升级功能。 

 
支持配置回退功能。 

 
支持数据校验功能。 

 


### 配置管理原理 


配置管理的具体过程是指系统接收EM客户端发起的配置请求，对其中包含的配置数据进行有效性检查，将正确的配置数据保存在NF的数据库（NF-OAM和NFS-OAM数据库）中，同时将执行的结果返回给EM客户端。


#### 软件结构 
##### OAM子系统简介 
OAM是操作、管理和维护子系统，是指运营商对一个已经投入运行的交换系统所需做的各种工作，其目的是为了保证系统能够正常运转，以便向用户提供良好的电信服务。
OAM子系统的主要功能包括提供配置管理接入功能、对配置数据进行解析。 
NF的配置管理功能由NF软件系统中OAM子系统的配置管理模块实现。
 说明： 
NF的软件系统包括OAM等多个子系统，有关OAM子系统的详细描述参见“[OAM子系统的软件结构]”。
##### OAM子系统的软件结构 
OAM系统作为唯一和EM有接口关系的子系统：
接收NF管理层的监控命令并进行处理。 
执行对单个NF的管理职能。 
在NF上电初始化阶段对虚拟机进行版本加载、配置处理。 
正常运行状态下负责监控整个NF的故障、性能状况，并提供必要的本地维护手段。 
OAM子系统的软件结构如[图1]所示，配置管理模块位于OAM子系统的服务层（即NF-OAM和NFS-OAM服务端）。
图1  OAM子系统的软件结构

OAM子系统分为CN-OAM（OAM接入适配层）、NF-OAM和NFS-OAM三层。EM通过OAM接入适配层与各个NF-OAM应用模块（例如配置管理模块）进行交互，再通过OAM应用模块与各NFS-OAM交互，以实现网管功能。
OAM子系统接收EM发来的控制命令，通过与其他软件子系统的接口完成所要求的动作，具体流程如下： 
EM通过管理接入通道将配置数据请求转发给OAM子系统。 
由CN-OAM对其进行解析和适配，将其转换为内部消息结构，并根据配置数据的类型和应用，转发给相关的应用（指各个NF-OAM）。 
NF-OAM进行相关的有效性检查后，将各配置数据写入NF-OAM数据库。 
成功写入数据库后，由数据库负责分发，并由数据库负责到NFS-OAM内存数据库的数据同步。 
##### OAM子系统的特点 
OAM子系统主要以下特点： 
提供了多种标准接口，如Telnet/SSH、REST、NETCONF，同时还提供中兴私有接口，即采用支持自解析的TLV格式，很大程度上减少了NF版本和网管版本的耦合性，同时方便了第三方网管的接入，提高了可扩展性。其中，配置管理接入功能支持以下三种接入方式：本地维护终端（即OAM客户端）接入OAM客户端作为TCP/IP协议中的客户端与CN-OAM相连，支持通过Telnet、MML命令，实现对NF的数据配置、日常操作和维护管理功能。EM接入ElasticNet UME是中兴通讯公司开发的统一网管系统，实现对移动网络不同NF的集中管理。EM与NF之间采用标准的REST/SNMP协议进行通信。第三方网管接入第三方网管通过中兴私有接口进入运营商内部网络，进行远程维护。 说明：中兴私有接口是中兴通讯公司自主开发的私有接口，现网中很少使用，后续不再介绍此种接口。 
对内部各子系统，提供了通用的各网管功能接入通道，优化内部结构，合理分工，降低了与各子系统应用的耦合性，增强兼容性。 
##### 配置管理流程 
配置管理通常使用REST和Telnet/SSH方式，如[图2]所示。
图2  配置管理流程

配置管理支持对配置数据在NF各节点间的同步、对NFS-OAM的分发、以及对配置数据的加载和存储，各模块分工如下： 
HTTP服务端主要负责接收EM网管的配置请求并将其转发给配置命令处理模块，以及对命令数据的加载和存储。 
TELNET/SSH服务端主要负责接收TELNET/SSH客户端的配置MML并将其转发给配置命令处理模块，以及对命令数据的加载和存储。 
配置命令处理模块负责对命令的有效性进行检查，并辅助命令数据的存储。 
配置分发同步模块负责数据到各NFS-OAM内存数据库的分发、同步。 
#### 数据存储机制 
##### 数据存储格式 
NF支持使用两种文件格式存储配置数据。
ZDB方式：ZTE私有数据库格式，文件名以.zdb为后缀。 
TXT方式：文本格式，文件名以.txt为后缀，通常用于保存协议栈的配置数据。 
不同的配置数据支持的存储方式不同，其中协议栈配置数据只能存储为.txt文件，其它配置数据一般保存为.zdb文件。
##### 数据存储分类 
NF既支持对全局数据进行存储，同时也支持对数据分模块进行存储，详细情况参见[表1]。
存储类型|支持方式|流程
---|---|---
全局存储|支持ZDB和TXT两种方式|若以ZDB方式进行存储，先对协议栈数据以TXT方式进行存储，再以ZDB方式对其它配置数据进行存储。若以TXT方式进行存储，则直接存储。
分NFS存储|只支持ZDB方式|非协议栈数据，以ZDB方式对配置数据进行存储。
#### 数据加载机制 
定义 :加载，是指从外部存储器向NFS的内存数据库加载软件与配置数据的过程。
##### 加载方式 
根据加载源文件存储位置的不同、加载的文件的不同，系统数据加载的方式，如[图1]所示。
图1  数据加载方式

根据加载源文件存储位置的不同，可将加载分为以下两种主要方式： 
从NF-OAM数据库向主机（虚拟机）的内存加载软件与数据，此时，加载所需要的源数据全部存储在NF-OAM数据库上。 
从各虚拟机自身的本地存储介质向其内存加载软件与数据，此时，加载所需要的源文件存储在主机各虚拟机自身的本地存储介质中。 
##### 加载数据类型 
加载的数据类型分为ZDB和TXT两种，不同的配置数据使用的文件类型不同：
协议栈的配置数据是从.txt文件中加载的。 
其它NFS的配置数据从.zdb文件中加载的。 
#### 数据同步机制 
##### 同步说明 
配置数据包括离线配置数据和在线配置数据： 
对于在线配置数据，无需同步，所配置的数据立即生效。 
对于离线配置数据，需要执行数据同步操作，数据才能生效。 
 说明： 
NF中有些数据只支持在线配置方式。
##### 离线数据生效流程 
离线数据生效的流程如下： 
NF-OAM层的配置Manager生成配置数据.xml文件。
NF-OAM将配置数据.xml文件上载在FTP服务器指定目录下。
NF-OAM层的配置Manager发送请求消息给“配置分发同步”模块，完成指定目录下文件的分发和加载工作，并触发存盘、分发、通知流程。
### 配置数据的管理机制 
#### 数据传送与回退 
##### 数据传送 
数据传送是指操作员将NF-OAM存储的相关配置数据下发到NFS-OAM的内存数据库中，保证操作员在NF-OAM上修改的配置数据能够在NFS生效。
在EM上进行数据配置时，无论是进行增加、修改还是删除操作，数据都以数据表的形式实时保存到NF-OAM数据库上，但NFS内存数据并没有做相应的修改，只有执行数据同步命令（[SYNA]）后，才会将配置的数据表传送到NFS-OAM的内存数据库中。
数据传送有两种方式： 
传送全部表一般在开局时，全部数据设置完后进行。以admin用户登录，执行数据同步命令SYNA，传送类型参数选择ALL，这时用户名不能输入，传送全部表。 
传送变化表一般在单步操作设置完成后进行。以admin用户登录，执行数据同步命令SYNA，传送类型参数选择CHG，如果没有输入用户名，则传送当前用户的变化表；输入用户名，则传送指定用户的变化表。 
##### 数据回退 
数据回退是指操作员将已经在NF-OAM配置，但还未执行数据传送命令时，可通过[UNDO DATA]命令将变化数据进行回退的操作。
配置回退功能保证了数据的安全性，防止人为操作失误，同时还提高了NF的可维护性。 
#### 数据备份与恢复 
##### 目的 
为了提高系统数据的可靠性和安全性，通常需要在系统完成首次配置后或进行重要配置变更前，对配置数据进行备份。 
若系统数据库发生意外损坏后，则采用备份数据进行恢复，若未对配置数据采取备份和恢复，可能导致数据丢失，对运营商的业务造成影响。 
##### 数据备份 
数据备份是指将NF-OAM的配置数据备份到磁盘中。 
NF使用备份管理机制如[图1]所示。
图1  备份管理机制

备份任务操作员通过EM可以定制备份任务。一个备份任务可以包含一个或多个备份对象。 
备份对象系统各功能模块需要备份的数据库表或文件。 
 说明： 
NF支持手工备份和自动备份两种机制，通常情况下，对配置数据一般使用自动备份；当修改重要的数据时可以进行手工备份。 
##### 数据恢复 
数据恢复是指当系统崩溃、用户误操作、系统升级失败等情况下，将配置数据从磁盘恢复到NF-OAM数据库中，能够及时将系统恢复到可用状态。 
 说明： 
NF只支持手工恢复。 
## 缩略语 
## 缩略语 
### CGSL 
Carrier Grade Server Linux电信级服务器Linux
### CN 
Core Network核心网
EM :Element Management网元管理
FTP :File Transfer Protocol文件传输协议
HTTP :Hypertext Transfer Protocol超文本传输协议
IP :Internet Protocol因特网协议
### M3UA 
MTP3-User Adaptation layer protocolMTP第三层的用户适配层协议
### MML 
Man Machine Language人机语言
NF :Network Function网络功能
NFS :Network Function Service网络功能服务
OAM :Operation, Administration and Maintenance操作管理维护
### REST 
Representational State Transfer表述性状态转移
### SCCP 
Signaling Connection Control Part信号连接控制部分
SCTP :Stream Control Transmission Protocol流控制传输协议
### SNMP 
Simple Network Management Protocol简单网络管理协议
### SSH 
Secure Shell安全外壳协议
TCP :Transmission Control Protocol传输控制协议
### TLV 
Tag, Length, Value标记、长度、取值
### ZDB 
ZIP Database压缩数据库
ZTE :Zhongxing Telecommunications Equipment中兴通讯
## 性能管理描述 
### 基本概念 
#### 概念关系 
性能管理的要点是性能统计任务和测量结果，性能管理可以为指定的测量对象创建测量任务，并得到测量结果，这是性能统计的基本过程。 
性能管理的基本概念包括测量对象类型、测量对象、测量类型、性能计数器、性能指标、采集粒度、查询粒度、性能测量任务、性能门限任务等概念。 
#### 测量对象类型 
测量对象类型是指具有相同属性的测量对象的类型，例如Diameter链路、路由区。 
#### 测量对象 
测量对象是指具体被测量的物理实体和逻辑实体，如某个NF、某条链路、某个跟踪区。
#### 测量类型 
测量类型可以实现对测量对象的某类指标的测量。一个测量对象类型下可以有多个不同的测量类型，例如路由区测量对象类型下的测量类型有：路由区附着测量、路由区更新测量等。 
#### 性能计数器 
性能计数器指测量类型中所包含的具体测量指标，是性能测量的基本单元。每一种测量类型中包含若干个计数器。一个计数器可以通过如下几个属性来描述。 
计数器ID：性能计数器的唯一标识。 
计数器描述：对性能计数器的解释。 
测量触发点：描述性能计数器的触发过程。 
采集方式：计数器采集数据所使用的方式，其取值参见表1。 
取值|名称|说明
---|---|---
CC|累计|累积计数器跟踪统计周期内某事件的累积变化量，且计数器值单向累加。在每个统计周期开始时，计数器将被重置为一个预先定义的值（通常为0）；在统计周期结束时计数器的值即为有效的采集结果。
MAX|最大值|最大值计数器用来对某事件进行最大值统计，且计数器中仅仅保存最大结果。该类型计数器上报的数据是统计周期内的最大值。
MIN|最小值|最小值计数器用来对某事件进行最小值统计，且计数器中仅仅保存最小结果。该类型计数器上报的数据是统计周期内的最小值。
AVG|平均值|平均值计数器采样连续变化事件的数据值，在统计周期结束时计算并上报平均值。
CUR|当前值|当前值计数器用每次上报事件数据替换计数器中的原有数据，在统计周期结束时上报的结果为最近一次上报事件数据。
#### 性能指标 
性能指标可以作为评价网络运行稳定性及安全性的依据。性能指标是维护人员基于性能计数器通过四则运算而定制的一种复合型计数器，包括用户自定义和系统定义两类。 
用户自定义指标：维护人员根据系统现有的计数器，自行定义四则运算公式，在EM客户端上创建。在创建自定义后，维护人员可以对其进行查看、修改、删除操作。 
系统预定义指标：系统自动定义的指标，维护人员可以在EM客户端上查看，但不允许修改和删除。 
#### 采集粒度 
采集粒度是指网管系统对性能数据进行采集的周期，系统支持的采集粒度有：5分钟、15分钟、1小时。 
#### 查询粒度 
查询粒度是指查询测量任务数据的统计周期。维护人员可以设置的查询粒度为5分钟、15分钟、30分钟、1小时、1天、1周、1月。 
 说明： 
查询粒度必须大于或等于对应测量任务中设置的采集粒度。 
#### 性能测量任务 
性能测量任务定义了性能数据的收集、存储和传输方式以及最终数据的展示结果和处理方法。 
一个性能测量任务规定了何时、对何种测量类型的具体指标、以何种周期采集性能数据。 
维护人员在EM客户端上创建性能测量任务，EM根据任务设定的运行周期自动采集指定的性能参数，得出网络性能的统计结果，使维护人员及时了解网络的运行状态。 
#### 性能门限任务 
性能管理提供的性能QoS任务通常称为性能门限任务，QoS是网络的一种安全机制，是用来解决网络延迟和阻塞等问题的一种技术。当网络过载或拥塞时，QoS能确保重要业务不受延迟或丢弃，以便保证网络的高效运行。
一个性能门限任务规定了何时、对何种测量类型的具体指标进行门限计算。如果计算结果超过了预设的门限值，将产生性能门限告警，并上报到告警管理系统，提醒维护人员关注网络运行的异常情况。 
实现原理 :性能管理涉及的系统主要是EM服务器（例如中兴通讯的ElasticNet UME）、EM客户端和NF，EM客户端采用B/S方式，使用浏览器即可登录到EM服务器。
EM服务器：接收EM客户端操作请求，向NF下发性能测量任务，接收和存储NF上报的性能测量数据，并通过EM客户端展示。EM服务器通过北向接口上报性能测量数据给NMS。 
EM客户端：提供Web页面访问EM服务器，提供性能管理操作界面和结果展示。 
NF：收集呼叫处理信息、信令信息及业务信息，并将这些信息汇总成性能测量任务的结果，上报给EM服务器。 
性能管理总体流程如[图1]所示。
图1  性能管理流程

性能管理总体流程包括测量任务的创建、性能数据入库、性能数据显示以及门限值检查等流程，详细说明如下： 
维护人员通过EM客户端创建性能测量任务，EM服务器将该任务下发到NF。 
NF会按性能测量任务中指定的粒度和其它条件上报性能数据给EM服务器。 
EM服务器保存NF上报的性能数据。 
维护人员通过EM客户端访问EM服务器并查询性能数据，NF的性能数据按照用户的定制查询条件展现在客户端上。 
如果维护人员设置了门限任务，对某个指标设置了门限。当NF上报性能数据时，EM服务器会启动门限判断。如果达到门限，则会上报相应的告警，展现在EM客户端。 
EM服务器通过北向接口，将NF的性能数据提供给上级网管NMS，供北向用户分析。 
### 性能管理功能 

### 性能管理功能 

#### 性能指标管理 
性能指标（PI）是基于测量对象的计数器统计，通过对一个或者多个测量对象的计数器进行加、减、乘、除运算得到用户需要的测量指标，可用于门限任务、监控和历史性能数据查询等，支持的数据类型有整型、长整型、浮点型、百分型以及逻辑布尔型。
系统预先定义的性能指标为预定义性能指标，预定义性能指标不支持修改和删除操作。维护人员可根据实际情况，自定义新的性能指标，自定义性能指标支持修改和删除操作。 
#### 测量任务管理 
EM服务器为了采集NF的性能数据，需要在性能管理系统中创建性能测量任务，以便及时获取系统运行时的性能数据。
测量任务管理提供了测量任务的创建、修改、删除、查询、任务同步以及任务运行状态监控等功能。 
测量任务状态具体说明参见[表1]。
测量任务状态|说明
---|---
激活|该测量任务正在运行，EM服务器将会采集指定位置上的指定测量对象在指定时间范围内的性能数据。激活状态的测量任务不可进行修改、删除等操作。
挂起|该测量任务暂时停止数据采集，可通过激活操作恢复数据采集。


#### 性能数据查询 




性能数据查询是日常维护和性能监测的重要操作，维护人员可根据查询的性能数据对系统进行调整和优化。 


维护人员在EM客户端中设置查询条件，EM服务器查询性能数据，并呈现给维护人员。


性能管理系统支持以下几种性能数据查询。 



 
自定义查询性能数据：维护人员通过自定义的条件查询NF性能数据。 

 
按任务查询性能数据：维护人员通过性能测量任务查询与该任务相关的NF性能数据。 

 
按模板查询性能数据：维护人员选择性能数据查询模板，按照模板中设定的条件查询NF性能数据。 

 




#### 性能数据导出 
性能管理功能支持性能查询结果的导出功能，包括手工导出性能测量数据和定时导出性能测量数据两种方式。 
手工导出性能测量数据：当维护人员通过各种方式查询到性能数据时，维护人员通过手工的方式将查询到的性能数据导出为CSV、XLSX、HTML、PDF文件。 
定时导出性能测量数据：系统支持通过模板创建定时导出任务，定时查询性能测量数据，并将结果自动导出为CSV、XLSX、HTML、PDF文件。 
#### 性能数据补采 
在异常情况下（如NF与EM服务器通信中断），EM服务器出现性能数据不完整的情况，EM系统的自动补采或者手动补采功能，可以重新对性能数据进行采集。性能数据补采流程如[图1]所示。
图1  性能数据补采流程

性能数据补采流程说明如下： 
EM服务器将性能测量任务下发到被管理的NF。 
当采集周期结束时，NF将测量任务中指定的性能数据上报给EM服务器。 
EM服务器对性能数据进行汇总、存储等操作。 
EM服务器自动判断性能数据是否存在缺失。维护人员也可以通过查询数据的完整性操作，手工检查是否存在数据缺失。 
对于缺失的性能数据，EM服务器自动向NF发起补采请求。维护人员也可以通过补采性能数据操作，手工补采缺失的性能数据。 
NF再次上报EM服务器缺失的性能数据。 
EM服务器按照用户的定制查询条件，将NF的性能数据展现在EM客户端上。 
#### 性能门限告警 
为了方便维护人员监控网络运行状况，及时发现不合理的性能测量指标数据，EM系统提供性能门限告警功能。
维护人员可以针对特定测量任务的具体测量指标设定门限。当该任务指标的测量结果高于或低于设定的门限时，性能管理系统自动向告警系统发送测量任务指标门限告警，以提醒维护人员及时关注该性能指标。维护人员可以根据指标门限告警信息，分析测量值异常的原因并消除此类异常情况。 
EM系统的性能门限告警产生和恢复的流程如[图2]所示。
图2  性能门限告警产生和恢复的流程

性能门限管理功能实现了对测量指标值的监控，如果维护人员设置了门限任务，对某个指标设置了门限，当NF数据上报时，EM服务器会启动门限判断。如果指标值符合触发告警的门限范围，则会上报相应的告警，展现在EM客户端上。如果指标值符合恢复告警的门限范围，则会恢复已经产生的告警。
性能门限告警产生和恢复的流程说明如下： 
采集周期结束时，NF将测量任务中指定的性能数据上报给EM服务器。 
EM服务器检查是否设置了该测量周期指标门限。 
如果设置了门限，EM服务器将NF上报的性能数据与设定的门限进行比对。 
EM服务器判断NF的性能指标值是否达到了告警触发/恢复条件。 
如果NF的性能指标值已经达到了告警触发/恢复条件，EM服务器继续检查当前的系统中是否已经存在该指标的门限告警。 
如果NF性能指标值已经达到了告警触发条件，且当前系统中不存在该指标的门限告警，则产生对应的门限告警；如果NF性能指标值已经达到了告警恢复条件，且当前系统中已存在该指标的门限告警，则产生一条该门限告警清除的消息。 
## 缩略语 
## 缩略语 
### B/S 
Browser/Server浏览器和服务器结构
EM :Element Management网元管理
NF :Network Function网络功能
### NMS 
Network Management System网络管理系统
### PI 
Performance Index性能指标
QoS :Quality of Service服务质量
## 故障管理描述 
### 告警管理概述 
告警管理系统对网络的运行情况进行监测和管理，并将告警信息呈现在网管客户端上，用于故障定位和故障修复。 
### 告警管理原理 
告警管理的系统原理如[图1]所示。
图1  告警管理的流程

告警上报和呈现的过程如下： 
当被管理的NF发生故障时，会产生告警事件，并实时上报给EM服务器（例如中兴通讯的ElasticNet UME）。
EM服务器对NF上报的告警进行处理，并储存在自身的数据库中。 
EM服务器将当前的告警信息集中呈现在EM客户端上。 
维护人员在EM客户端上实时监控告警。 
维护人员在EM客户端上查看当前告警和历史告警，并能处理各种告警。 
通过EM服务器的北向接口，NF的告警信息可以提供给上级NMS网管，供北向用户分析。
### 相关概念 
告警和通知 :##### 告警 
告警是对被管理对象以及EM系统本身在运行过程中发生的异常情况进行报告，提醒用户进行相应的告警处理。 
告警对应的问题或故障解决后，系统将自动返回告警恢复消息。 
当异常或故障出现时，告警管理系统将及时准确地显示相应的告警信息。 
告警信息一般会持续一段时间，在问题或故障消失后，告警信息才会消失，并返回相应的告警恢复消息。 
##### 通知 
通知是对管理对象以及EM系统在运行中的一些操作或异常信息提示，以便维护人员及时掌握各模块的运行状况。 
##### 告警和通知的区别 
告警：EM或被管对象发生了异常或故障，若不处理，会引起业务异常。告警可以被确认和清除。 
通知：EM或被管对象发生了某种变化，不一定会引起业务的异常。通知不能被确认和清除。 
##### 告警和通知的标识方法 
告警/通知的唯一标识方法：资源类型+告警码/通知码。 
资源类型：用来进行告警码的分类。 
告警码/通知码：是一个整型字段。用于唯一的标识一条告警/通知。 
告警属性 :##### 目的 
了解告警属性相关信息，有助于维护人员更好地了解和针对性地处理NF告警。
##### 告警码 
告警码是用于区分告警的标识，系统为每个告警定义了一个告警码。 
##### 告警名称 
告警名称用于简洁直观地反映故障原因、现象等内容。 
##### 告警级别 
按照对系统的影响程度，告警分为四种级别：严重、主要、次要和警告，详细说明参见[表1]。
告警级别|级别说明
---|---
严重|系统运行出现严重错误，可能导致系统陷于瘫痪的故障。表示正常业务受到严重影响，需要立即修复。
主要|系统功能出现重要错误，可能较大地影响系统运行和用户使用的故障。表示系统出现影响正常业务的重要故障，需要紧急修复。
次要|系统功能实现出现错误，导致某些功能不能正常使用的故障。表示系统存在影响正常业务的次要故障，应采取纠正措施，以免发生更严重的故障。
警告|系统的重要和基本功能不受影响，只对系统造成轻微影响。表示系统存在潜在的或即将影响正常业务的问题，应采取措施诊断纠正，以免其转变成更加严重的故障。
告警类型 :按告警触发条件以及对系统的影响，告警分为下面类型，详细说明参见[表2]。
告警类型|类型说明
---|---
通信告警|与信息传输过程相关的告警类型。
处理错误告警|与软件或进程故障相关的告警类型。
服务质量告警|与服务质量降级相关的告警类型。
设备告警|与设备故障相关的告警类型。
环境告警|与设备所处环境相关的告警类型。
网管告警|与网管系统相关的告警类型。
完整性告警|与数据的完整性相关的告警类型。
可用性告警|与系统可用性相关的告警类型。
物理攻击告警|与物理攻击相关的告警类型。
安全攻击告警|与安全攻击相关的告警类型。
时限告警|与处理时长相关的告警类型。
##### 附加信息 
告警和通知都有附加信息，在EM客户端上单击一条告警的详情按钮，就能查看到附加信息。
告警原因 :罗列出可能产生该告警的原因。给出告警原因的目的是希望通过了解告警的触发条件，及时获得排除故障的方法和预防措施，以使系统尽快恢复正常。 
处理建议 :系统提供排除故障默认的方法和建议。维护人员也可以结合自己的告警处理经验，编辑自定义告警处理建议。 
处理告警时需要注意的事项如下： 
操作维护人员记录告警和故障现象后，根据相关处理建议和方法，按步骤进行处理。 
每处理完一个步骤，如果故障排除（即告警恢复），则结束告警处理；如果故障没有排除，则继续进入下一步骤。 
如果告警无法处理或无法恢复，及时联系中兴通讯。 
#### 告警状态 
##### 告警状态分类 
告警共有如下几种状态： 
未确认未清除 
已确认未清除 
未确认已清除 
已确认已清除 
##### 告警状态转换 
告警状态转换关系如[图1]所示。
图1  告警状态转换

确认/反确认告警确认告警，表示维护人员正在处理该告警。告警被确认后，由未确认状态变成已确认状态。反确认告警，表示将已确认状态的告警重新变成未确认告警。 
清除告警当故障排除后，告警会由未清除状态变为已清除状态，该告警变为历史告警，被记录进告警数据库中。维护人员也可以通过手工清除的方式，将未清除的告警变为已清除状态。如果网元的故障依然存在，网元可能会再次上报该告警。 
##### 当前告警和历史告警 
未确认未清除和已确认未清除状态的告警被称为当前告警，存放当前告警的库叫当前告警库。 
未确认已清除和已确认已清除状态的告警被称为历史告警，存放历史告警的库叫历史告警库。 
### 告警管理功能 
告警管理的功能主要包括：告警监控、告警查询、告警统计、告警自动处理功能。 
#### 告警监控 
在客户端页面上实时监控告警信息和通知信息。 
#### 告警查询 
支持按条件查询历史告警和通知信息，条件包括：告警码、发生时间、告警类型、告警级别、告警状态等。 
#### 告警统计 
支持统计当前告警和历史告警，当前告警统计结果支持以表格形式显示在客户端上，历史告警统计结果既支持以表格或图形的形式显示在客户端上，还支持导出为多种格式的文件。 
#### 告警自动处理 
告警自动处理功能是指当告警或通知满足一定条件时，系统将自动触发的操作。EM系统通过告警规则来完成告警自动处理操作。维护人员可以设置告警条件及需要执行的动作。
EM系统可以创建的告警规则参见[表1]。
规则名称|应用说明
---|---
显示过滤规则|过滤符合指定条件的告警，被过滤的告警默认不会显示在客户端界面上，但可以通过告警查询功能查看。该规则不影响通过北向上报告警。
告警确认规则|当符合条件的告警上报时，告警确认规则将自动确认这些告警。该规则不影响通过北向上报告警。
告警清除规则|当符合条件的告警上报时，告警清除规则将自动清除这些告警。该规则不影响通过北向上报告警。
告警屏蔽规则|告警屏蔽规则将屏蔽条件下发到网元代理，网元代理不再向网管上报指定的告警数据。只能对网元代理和网元代理管理的设备设置屏蔽规则。网元代理断链或者停止时，只能新建已停止的屏蔽规则。该规则不影响通过北向上报告警。
闪断告警规则|告警位置、告警码均相同的告警在较短时间间隔内频繁上报（如1分钟内上报超过5条），则被称为闪断告警。闪断告警将合并产生一条新告警，不显示原始上报告警，目的是减少客户端界面显示的告警数量，方便用户关注重点告警，快速定位故障。用户可通过打开合并生成的告警的详细信息查看其相关的原始告警信息。该规则不影响通过北向上报告警。
通知过滤规则|过滤符合指定条件的通知。被过滤的通知会被直接丢弃，既不会显示在客户端界面上，也不会被存储。本规则仅对新上报的通知生效。该规则不影响通过北向上报告警。
告警前转规则|告警前转规则可以在符合条件的告警上报时，将其通过邮件或者短信发送给指定人员。该规则不影响通过北向上报告警。
上报过滤规则|过滤符合指定条件的告警。被过滤的告警会被直接丢弃，既不会显示在客户端界面上，也不会被存储。本规则仅对新上报的告警生效。该规则不影响通过北向上报告警。
告警延迟规则|告警延迟规则将符合条件的告警延迟一段时间后上报。该规则不影响通过北向上报告警。
告警计时规则|告警计时规则对符合条件的新上报告警的状态进行计时，如果持续时间达到指定的时间，则进行指定的操作。该规则不影响通过北向上报告警。
北向过滤规则|过滤符合指定条件的告警，被过滤的告警将不上报到北向上级网管（NMS）。该规则影响通过北向上报告警。可能会导致北向上级网管与EM网管告警不一致。
重复历史告警过滤规则|过滤距最近一条历史告警（包括已被过滤的）一定时间内上报的重复历史告警（发生位置和告警码相同）。被过滤的历史告警会被直接丢弃，查询历史告警可以看到历史告警上报的次数。本规则仅对新上报的历史告警生效。该规则不影响通过北向上报告警。
重复通知过滤规则|过滤距最近一条通知（包括已被过滤的）一定时间内上报的重复通知（发生位置和通知码相同）。被过滤的通知会被直接丢弃，查询通知可以看到通知上报的次数。本规则仅对新上报的通知生效。该规则不影响通过北向上报告警
告警归并规则|告警归并规则用于合并由相同故障引起的告警，并显示其中的一条告警来表示这些告警。该规则不影响北向上报告警。
### 消除告警的一般流程 
查看到告警信息后，需要采取适当的措施对系统进行维护，以消除告警。 
消除告警的一般流程如下： 
明确此告警的告警码、告警级别、描述以及涉及的告警源。 
判断此告警产生的原因以及系统影响。 
根据上述两点，作出消除此告警的处理方法。 
对处理结果进行判断，确认告警消除。 
## 缩略语 
## 缩略语 
EM :Element Management网元管理
NF :Network Function网络功能
### NMS 
Network Management System网络管理系统
## 系统默认账号 
### 操作系统默认账号及密码 
 说明： 
新建部署后，需立即修改账号默认密码。 
维护阶段，需定期修改账号密码，以降低账号泄露风险。 
用户名|用户组|默认密码|角色|状态|生命周期|描述|密码修改策略|密码修改方法
---|---|---|---|---|---|---|---|---
root|root|ZTE_ossdbg1|操作系统超级用户|保留|永久|操作系统root用户|维护阶段定期修改。|登录EM客户端。在命令终端中，在网元名称→NF节点→CommonS_TMSP_0服务下，执行SET PASSWD命令修改密码。
bin|bin|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
daemon|daemon|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
adm|adm|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
lp|lp|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
sync|root|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
shutdown|root|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
halt|root|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
mail|mail|非登录|操作系统|锁定|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
operator|root|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
games|users|非登录|操作系统|锁定|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
ftp|ftp|非登录|操作系统|锁定|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
nobody|nobody|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
systemd-network|systemd-network|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
dbus|dbus|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
sshd|sshd|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
chrony|chrony|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
zte_v6pf_inner|sftp admin|非登录|操作系统|保留|永久|操作系统用户|非登录用户，不涉及密码修改。|不涉及
admin|admin wheel|Admin_123|操作系统管理员|保留|永久|操作系统管理员用户|维护阶段定期修改。|登录EM客户端。在命令终端中，在网元名称→NF节点→CommonS_TMSP_0服务下，执行SET PASSWD命令修改密码。
## 网络通信端口表 
### 网络通信端口表 
ZXUN RCP的网络通信端口表如下：
[ZXUN RCP网络通信端口表.xlsx]
## 隐私保护声明 
概述 :为充分应对全球范围内日趋严格的个人数据保护合规立法和执法工作，中兴通讯高度重视个人数据保护合规工作，严格执行个人数据保护要求，全面防控数据保护合规风险。 
中兴通讯ZXUN Resouce Control Platform产品（以下简称“ZXUN RCP”）一贯坚持个人数据保护原则，在向您提供的功能中，部分功能会处理个人数据，比如手机号、邮箱等，以上功能在设计时也兼顾了个人数据保护。ZXUN RCP的个人数据处理功能完全向您开放，本声明将帮助您充分了解ZXUN RCP所涉及的个人数据处理功能和保护功能，更好地保护用户的个人数据，避免因误操作而产生意外风险。
本系统产品在设计伊始即考虑了对用户的个人数据进行处理的需求场景，通过隐私影响分析、隐私风险评估、处置方案制定落实等流程活动，遵循个人数据保护的7大原则（合法性合理性和透明性、目的限制、数据最小化、准确性、限期储存、数据完整性与保密性、可问责性），落实Privacy by Design and by Default的理念和方法，充分保障产品数据处理活动的合法合规，最终的目的是帮助您更好地保护个人数据。 
下文从产品的角色和责任、数据处理功能、数据主体权力实现、数据共享传输和披露、数据保护措施这几个方面，进一步说明是如何帮助您实现个人数据保护的。 
### 产品角色及责任 
ZXUN RCP向您提供完全本地化的数据处理功能，中兴通讯仅提供与产品功能说明书一致的产品功能。产品功能运行的过程中，除非获得您的授权，所有数据均不会传输到中兴通讯。
中兴通讯向您交付ZXUN RCP后，您对ZXUN RCP有完全的控制权，您有权决定通过ZXUN RCP以何种目的收集、处理您的用户的个人数据。我们将通过本声明向您详细阐述ZXUN RCP的个人数据处理功能逻辑及保护措施，您应保证数据处理过程中的合规性。
### 数据处理功能 
ZXUN RCP个人数据的业务处理服务包括：
传统网络中2G/3G/4G的PCRF等业务功能。 
5GC网络中PCF服务功能。 
以上功能使用的个人数据包括：IMSI、IMEI/PEI、MSISDN、PUI、APN、签约套餐数据等。
ZXUN RCP处理个人数据的操作与维护功能包括：
告警功能：需要使用用户标识、邮箱，及IMSI等信息。 
日志功能：需要使用日志内容中的IMSI、MSISDN、SUPI、GPSI、IMEI、PUI等信息。 
信令跟踪功能：需要使用SUPI、MSISDN、IMEI，以及消息内容中的IMSI、IMEI/PEI、MSISDN、PUI、APN等。 
失败观察功能：需要使用IMSI、MSISDN、SUPI、GPSI、IMEI、PUI。 
### 数据主体权利实现 
ZXUN RCP产品可以协助您落实数据主体权利，使用户能够控制他们的个人数据。
操作维护管理的普通用户可以在ZXUN RCP的用户管理页面查询、修改其账号信息，并删除非必填字段。
操作维护管理的管理员用户可以在ZXUN RCP的用户管理页面查询、修改其账号信息，删除管理员账号的非必填字段。也可以查询、修改、删除普通用户的账号信息。
操作维护管理的用户可以在信令跟踪、失败观察、告警、日志页面查看和导出已记录的信息，但不支持修改、删除。 
### 数据共享、传输、披露 
ZXUN RCP支持web页面、API接口，运营商可以通过上述方式获得需要的数据。运营商完全控制web页面、API接口的访问权限，可自行分配数据共享、传输、披露的对象，以及传输的目的地。运营商需要自行保证数据共享、传输、披露过程中的合规性。
### 数据保护措施 
ZXUN RCP在提供个人数据处理功能的同时，也采取了一系列数据保护措施。
数据保护措施|说明
---|---
数据收集|ZXUN RCP严格按照3GPP协议要求的字段以及运营商提供特色业务字段进行收集。操作维护用户填写个人数据时，ZXUN RCP提供了必填和选填选项，可以选择填写哪些个人数据字段。对于密码，ZXUN RCP在录入时就会进行哈希处理，再进行传输。
数据存储|用户的签约数据存储在ZXUN RCP的PUDR中。PUDR支持将签约信息异地存储在不同的节点。操作维护用户的密码和密钥等数据，ZXUN RCP会对其进行加密存储。ZXUN RCP支持本地存储和备份，可备份ZXUN RCP数据库的所有数据。不允许操作维护用户直接访问数据库中的数据。
数据使用|用户的签约数据只在业务流程中使用。ZXUN RCP支持操作维护账号权限管理，管理员可基于角色分配权限。用户需要通过用户名密码的方式完成身份认证，并支持开启双因素认证。ZXUN RCP支持记录操作日志、系统日志和安全日志，支持将日志信息发送到指定的日志服务器。
数据传输|ZXUN RCP在系统内通过HTTPS的方式或者内部接口方式传输数据，对外提供HTTPS/SFTP方式进行通信。
数据删除|ZXUN RCP的用户签约数据，在业务处理完成后，内存释放，数据自动清除。对于备份数据，操作维护人员可自定义数据的保留时长。ZXUN RCP支持操作维护用户删除账号里的非必填数据，支持管理员删除普通用户的账号信息。配置信息只有授权用户才能删除。日志数据会随存储空间或者预设时间期限自动删除。
### 个人数据保护特色功能 
登录横幅功能。操作维护用户可以通过登录横幅功能配置您所需要的隐私政策。再次登录网管时，在登录首页中将显示隐私政策。 
个人数据保护功能。在开启个人数据保护功能License之后，ZXUN RCP支持：在线展示脱敏。操作维护人员在线查看信令跟踪、失败观察、日志和告警时，默认查看到的数据为匿名化后的数据。在线导出脱敏。操作维护人员在线导出的信令跟踪、失败观察、日志和告警文件，默认为匿名化后的数据。离线脱敏工具。操作维护人员使用随版本提供的离线脱敏工具，对导出的原始信令跟踪、失败观察、日志和告警文件，进行匿名化处理。 
## 缩略语 
## 缩略语 
3GPP :3rd Generation Partnership Project第三代合作伙伴计划
### API 
Application Programming Interface应用编程接口
APN :Access Point Name接入点名称
GPSI :Generic Public Subscription Identifier一般公共用户标识
### HTTPS 
Hypertext Transfer Protocol Secure超文本传输安全协议
IMEI :International Mobile Equipment Identity国际移动设备标识
IMSI :International Mobile Subscriber Identity国际移动用户标识
MSISDN :Mobile Station International Subscriber Directory Number移动台国际用户目录号
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
### PEI 
Permanent Equipment Identifier永久设备标识
### PUDR 
Policy UDR统一的策略数据存储库
### PUI 
Public User Identity公开用户标识
SFTP :Secure File Transfer Protocol安全文件传输协议
## 系统可靠性 
### 可靠性原理 
#### 架构可靠性 
按照Cloud Native设计思想，微服务需采用无状态设计。APP的设计要基于无状态，任何状态信息或数据都需要被抽取出来，并通过后端服务的方式保存在Backing Service（数据库、缓存等）中。业务处理单元随时可以执行弹性、扩容、销毁、重生、迁移操作，在此过程中，由于状态数据通过后端数据库进行存储，可以保障业务处理不受影响，使系统实现和系统运行更富有可恢复性和敏捷的适应性。
5GC中，各个NF采用无状态的设计思路来实现，业务逻辑上实现计算与存储分离。无状态设计示意图如[图1]所示。
图1  无状态设计示意图

数据存储单元：负责存储状态信息和用户数据，实现计算与存储分离。 
业务处理单元：负责执行业务逻辑。当一个业务处理单元故障时，由其它业务处理单元接管业务，并从数据存储单元获取用户数据。 
负载均衡单元：负责对话务进行均衡分发。当业务处理单元在执行弹性伸缩、自愈及重生时，话务自动分发到正常的业务处理单元。 
详细系统原理，参见[架构可靠性]。
#### 部署可靠性 
5GC容灾解决方案支持网元分域部署、双DC部署、互斥部署，从而实现部署可靠性。
分域部署：通过管理域、业务域、转发域分离的方式进行网元部署。 
双DC部署：DC内的同种类型网元组POOL，DC间保证地域容灾的可靠性。 
互斥部署：将同质的虚机部署在不同的物理机上，从而保证当某个物理机出现异常时，多个同质虚机仍能够提供服务。 
图2  部署可靠性

详细系统原理，参见[部署可靠性]。
#### 资源可靠性 
5GC的资源包括以下两种： 
计算资源：如VM、容器、进程。 
通信资源：如Management通信平面、Service通信平面、TOR/EOR（Top of Rack/End of Row）。 
业务功能的正常运行，依赖以上资源的正常运行。而以上资源的可靠性，可通过链路检测、自愈、防脑裂等机制来保障。 
图3  资源可靠性

详细系统原理，参见[资源可靠性]。
#### 数据可靠性 
5GC的NF按无状态设计，在当前处理流程完成后，将用户及会话上下文状态数据保存在UDSF中，由UDSF对数据进行多副本保存。当NF故障时，NF SET内的其他NF在接管故障NF的业务时可以从UDSF读取上下文状态数据并继续话务处理。NF可以共享UDSF来存储各自的非结构化数据，或者可以各自拥有自己的UDSF。
图4  数据可靠性

详细系统原理，参见[数据可靠性]。
#### 网络可靠性 
网络层面，NF对外的所有逻辑网络接口，都需要支持至少2个不同的物理网络平面互为备份。当其中一个物理网络平面发生故障时，另一个物理网络平面依旧能够接管所有的网络流量，保证业务不中断。
图5  网络层面

业务层面，通过链路检测机制对周边NF进行主动探测，保证及时发现故障，自动触发容灾措施保障业务。 
图6  业务层面

详细系统原理，参见[网络可靠性]。
#### 业务可靠性 
信令风暴是指网络中的信令负荷超出了网络的设计能力，使网络崩溃或者不可用。 
引发信令风暴的原因有很多，比如周边网元异常、网元节假日话务模型变化、热点区域话务剧增、自然灾害等。信令风暴发生后将引发一系列问题，比如链路拥塞、网元过负荷，导致网络服务能力下降，甚至整个网络无法提供服务。 
网络侧通过采取如下措施，可以避免系统瘫痪，保障业务稳定运行。 
拥塞控制，向上游网元发送过载通知。 
过载控制，优先保障高优先级业务。 
扩充虚机数量，增加业务处理能力。 
图7  业务可靠性

详细系统原理，参见[业务可靠性]。
#### 可靠性指标 
ZXUN RCP的可靠性指标参见下表。
可靠性参数|指标
---|---
MTBF|≥385651.2小时
MTTR|≤1小时
可靠性|99.999%
可靠性＝MTBF / (MTBF + MTTR) × 100% = 385651.2 / (385651.2 + 1) × 100% = 99.99974% 
### 架构可靠性 
概述 :支持负荷分担、主备实例功能和无状态特性，从而实现架构可靠性。 
#### 负荷分担 
负荷分担是指运行实例采用负荷分担的工作方式，即所有运行实例共同分担处理业务。当部分运行实例异常宕机时，由其余运行正常的实例共同分担处理业务，从而保证业务正常运行。 
采用N+M冗余方式，即当N个实例可以满足系统容量的业务处理时，再提供M个实例用于冗余。 
采用N+M个实例共同分担处理业务，此时系统能够承受最多M个实例的异常宕机而不影响系统处理能力。 
采用负荷分担工作方式的运行实例，全部为主用（Active）工作状态。运行实例分别运行在不同的资源之上，如不同的虚机或容器、不同的硬件服务器，以及不同的资源分区（ZONE）。当部分（小于等于M个）运行实例出现故障宕机时，其业务由其他正常运行的实例继续处理，从而能够不间断提供服务。 
采用N+M冗余的负荷分担的系统架构如[图1]所示。
图1  负荷分担方式系统架构图

上图中N=3、M=1。当任何1个运行实例故障时，其他3个运行实例继续工作，从而保证系统容量及业务处理不受影响。 
#### 主备实例 
主备实例是指运行实例采用主用和备用的工作方式，即一个主用、一个备用。正常工作状态时，主用实例提供服务，备用实例对主用实例的数据进行备份。当主用实例异常宕机或执行主备倒换命令时，备用实例转换为主用实例提供服务，从而保证业务正常运行。引入主备实例特性的目的在于提高运行实例的可靠性，从而进一步提高NF的可靠性。  
主备实例的系统架构如[图2]所示。
图2  主备实例系统架构图

#### 无状态 
无状态是指微服务的无状态设计，任何状态信息或数据都需要被抽取出来，并通过后端服务的方式保存在数据库、缓存等。业务逻辑APP随时可以执行弹性、扩容、销毁、重生、迁移操作。在此过程中，由于状态数据通过后端数据库进行存储，可以保障业务处理不受影响，使系统实现和系统运行更富有可恢复性和敏捷的适应性。 

3GPP TS 23.501标准规范提出了计算和存储分离的概念，并定义了UDSF用于统一存储NF的状态数据（又称为非结构化数据），实现业务逻辑执行与状态数据分离。 
中兴通讯系列产品采用无状态的设计思路实现各个NF，业务处理逻辑实现了计算与存储分离。系统的负载均衡器（Stateless Load Balancer），也按无状态的方式负责对话务进行均衡分发，简化了业务处理，保障了业务逻辑在执行弹性伸缩、自愈及重生时，系统负荷分担可以敏捷均衡。 
NF的无状态设计如[图3]所示。
图3  无状态设计

### 部署可靠性 
概述 :支持网元分域部署、双DC部署、互斥部署，同时采用网卡Bond模式和网络双平面，从而实现部署可靠性。
#### 分域部署 
采用管理域、业务域、转发域分离的方式进行网元部署。 
#### 双DC部署 
网元部署在双DC内，DC内的同种类型网元组POOL，保证地域容灾的可靠性。
#### 互斥部署 
互斥部署也称为反亲和部署，指同质的虚机部署在不同的物理机上，从而保证当某个物理机出现异常时，多个同质虚机仍能够提供服务。当前支持的反亲和组方式有：
软反亲和：组内虚机软互斥，尽量实现每个虚机部署在不同的主机（计算节点）上。 
硬反亲和：组内虚机互斥，严格保证每个虚机部署在不同的主机（计算节点）上。 
不反亲和：不生成对应的亲和组。 
 说明： 
同质虚机是指虚机子类型相同的虚机，类型与规格都相同。
#### 网卡Bond模式 
网卡配置Bond（绑定）模式是指将两个或者多个物理网卡绑定成一个虚拟逻辑网卡，从而实现本地网卡的冗余、带宽扩容和负载均衡，保证网络的可靠性。 
#### 网络双平面 
网络双平面是指NF对内与对外的所有逻辑网络接口，都需要支持至少2个不同的物理网络平面互为备份。当其中一个物理网络平面发生故障时，另一个物理网络平面依旧能够接管所有的网络流量，保证业务不中断。
网络双平面支持NF的所有网络接口，包括：内部管理面、内部业务平面以及所有的对外接口。 
### 资源可靠性 
概述 :5GC的资源包括以下两种： 
计算资源：如VM、容器、进程。 
通信资源：如Management通信平面、Service通信平面、TOR/EOR（Top of Rack/End of Row）。 
业务功能的正常运行，依赖以上的资源正常运行。而以上资源的可靠性，可通过链路检测、自愈、防脑裂等机制来保障。 
#### 链路检测 
业务内部通信平面包括Management通信平面、Service通信平面。每个通信平面都有链路检测功能。业务节点会定时发送心跳保活报文给管理节点，管理节点检测出长时间未发心跳的节点，则判定为故障节点，从而触发业务迁移流程，把故障节点的业务迁移到其他正常节点，从而保证业务的可靠性。 
#### 自愈 
对于持续出现故障的业务处理节点，系统会进行节点的多级自愈。根据用户的自愈策略配置，系统依次采用重启容器、重建容器、重启虚机、重建虚机逐级上升的策略进行自愈，从而尽快恢复业务。
#### 防脑裂 
防脑裂指主控节点采用仲裁形式，防止主控节点脑裂的发生。当主备之间无法通信，需要决定主备状态时，引入仲裁节点，辅助主备决策。 
### 数据可靠性 
概述 :5GC的NF按无状态设计，在当前处理流程完成后，将用户及会话上下文状态数据保存在UDSF中，由UDSF对数据进行多副本保存。当NF故障时，NF
SET内的其他NF在接管故障NF的业务时可以从UDSF读取上下文状态数据并继续话务处理。NF可以共享UDSF来存储各自的非结构化数据，或者可以各自拥有自己的UDSF。
UDSF地理容灾方案是在多个地理位置部署数据节点，数据节点在不同的地理位置以站点为单位进行组织。多个站点之间相互协作，呈现为一个有机的完整的系统，对外提供稳定可靠的服务。UDSF支持的容灾方式有： 
1+1冗余存储在DC内，数据存储节点之间通过可靠的复制机制，实现用户数据的双副本存储。通过互斥组设置，用户数据的两个副本，可以存储在不同的物理机上，确保一个物理机的故障，不会影响用户数据的所有副本。 
1+1地理容灾在DC内1+1冗余存储的基础上，将用户数据存储在2个DC。每个DC的双副本存储，可以确保DC级故障不会影响数据的可靠性。 
应用场景 :冷备容灾场景
一个RCP Pool内的RCP间不共享UDSF，不通过UDSF备份用户会话，如[图1]所示。
图1  冷备容灾场景

此场景下，每个RCP内部的UDSF仍支持1+1冗余存储。如果一个RCP故障，相关用户会话丢失，但用户新会话可以选择Pool内其他RCP处理。 
1+1热备容灾场景
两个RCP间共享UDSF，通过UDSF备份用户会话，如[图2]所示。
图2  1+1热备容灾场景

此场景下，UDSF在一个站点为主用站点，另外一个站点为备用站点，数据访问集中在主用站点。备用站点作为热备份，当主用站点故障时接管数据访问。两个RCP的业务服务对外可以是主备模式，也可以是负荷分担模式。 
N+N热备容灾场景
在两个DC内各部署N个RCP（N≤4），每个DC中选择一个RCP内置UDSF，其他RCP访问这两个RCP的UDSF，如[图3]所示。
图3  N+N热备容灾场景

此场景下，UDSF在一个站点为主用站点，另外一个站点为备用站点，数据访问集中在主用站点。备用站点作为热备份，当主用站点故障时接管数据访问。Pool内RCP的业务服务对外采用负荷分担模式。这种采用热备方式的RCP Pool即构成一个NF Set。 
#### 相关特性 
特性名称|说明
---|---
ZUF-59-56-002 地理容灾|多个RCP跨DC组Pool，RCP间采用冷备容灾，或通过UDSF实时备份用户会话。无论采用冷备容灾或热备容灾方式，RCP单局内UDSF支持1+1冗余存储。采用热备容灾方式时，两个DC各选一个RCP内置UDSF，UDSF间备份用户会话。
### 网络可靠性 
概述 :各NF通过链路检测机制对周边NF进行主动探测，并在链路发生故障时，采取容灾措施保障业务，确保本NF与周边NF的网络可靠性，提高业务可靠性。 
#### 服务化接口之间的链路检测 
服务化接口之间的链路通过HTTP/2协议的PING帧进行检测，根据HTTP/2协议要求，接收方收到PING帧时，必须回送PING ACK帧。HTTP/2链接的两端都可以发起HTTP/2的PING探测。在TCP链路建立后，源NF根据配置周期性发送PING探测请求给探测的目的NF（默认30 s）。如果在下次检测请求发起之前仍未收到PING ACK，则认为本次检测失败；如果在下次检测请求发起之前收到PING ACK，则认为本次检测成功。如果当连续检测失败次数达到配置值时（默认3次），则将该链路状态设置为不可用状态。 
NF与NRF间通过PATCH心跳来进行保活。NF在NRF注册时，协商心跳定时器T1。注册成功后，NF使用PATCH方法向NRF发送消息Nnrf_NFManagement_NFUpdate_Request启动心跳探测。在心跳检测周期内，NRF返回Nnrf_NFManagement_NFUpdate_Response消息响应心跳请求，则表示NRF和NF状态都正常。如果NRF在连续多个心跳检测周期内（默认3个）未收到NF发送的心跳请求，NRF则将NF状态设置为Suspended故障态。 
#### 非服务化接口之间的链路检测 
探测方式|功能描述|探测网元
---|---|---
SCTP检测|通过SCTP偶联状态进行检测，SCTP协议通过HEARTBEAT/HEARTBEAT ACK消息机制检测对端状态及维护SCTP偶联状态。当按配置间隔发送HEARTBEAT消息而未收到ACK的次数达到最大配置次数后，则判定故障。|RCP与SPR之间RCP与OCS之间RCP与DRA/PGW/AF之间
Diameter看门狗检测|Diameter支持设备看门狗消息。DWR、DWA是在本端实体与某个对等端实体之间的SCTP连接或者TCP连接建立成功且完成能力交换后，在连接上传送的Diameter心跳消息。当本节点发送DWR消息时设置定时器（时长为心跳检测时长），如果在定时器超时前收到DWA消息，则本节点的链路状态检测为正常。Diameter链路建链成功后，按照Diameter链路配置中的“Tc定时器” 周期性发送DWR消息，如果连续未收到响应的次数达到Diameter链路配置中的“最大无响应DWR发送次数”，则发起断链，再尝试重建Diameter链路。|RCP与SPR之间RCP与OCS之间RCP与DRA/PGW/AF之间
### 业务可靠性 
#### 防控信令风暴机制 
概述 :信令风暴是指网络中的信令负荷超出了网络的设计能力，导致网络拥塞甚至雪崩效应，使网络崩溃或者不可用。通过网络侧采取一定的措施，减少网络侧要处理的信令，进行信令风暴抑制，可以避免网络拥塞，化解信令风暴。 
##### 引发信令风暴的原因 
引发信令风暴的原因有很多，主要包括以下几类： 
终端及应用原因智能终端信令能力相对于普通终端极大提升。智能终端行为模式复杂化，各种异常引发信令增加。海量APP应用导致信令剧增。APP永久在线导致保活信令剧增。海量物联网终端行为趋同，特定行为（如：定时抄表）触发信令冲击。异常终端因配置错误、中毒、欠费、服务器异常等异常，对网络持续反复重发各种连接建立请求。 
特殊事件原因节假日话务剧增引发的信令风暴。体育赛事演唱会等引发特定区域的信令风暴。地震海啸台风等灾害引发的信令风暴。其他群体事件引发的信令风暴。 
网络及运营原因网络部署时信令能力考虑不足、冗余不够导致信令风暴。部分网元故障导致连锁反应。部分链路故障导致信令风暴。网络升级或业务调整时引发的信令风暴。因网络配置等原因引起网络环路。运营商定义的定时网络行为造成的信令冲击，比如零点全网用户套餐清零等。 
##### 信令风暴引发的问题 
信令风暴发生后将引发一系列问题，包括但不限于： 
部分链路拥塞该链路上用户失败率上升。该链路业务质量下降。该链路可接入用户数下降。 
部分网元过负荷或失效该网元接入能力下降或者完全失效。该网元部分用户业务质量下降，失败率上升。该网元用户掉线或者转入其他容灾网元，可造成其他网元负荷上升。 
整个网络服务能力下降业务服务质量下降，时延增加。用户业务失败率剧增。网络整体可接入用户数下降。 
网络雪崩，完全无法提供服务所属区域内用户都无法接入。整个网络完全无法提供服务。 
##### 解决信令风暴的方法 
针对信令风暴，可采用以下几类方法，多管齐下，标本兼治。 
无效信令抑制，减少不必要的信令智能识别异常信令，对异常终端进行管控，并设置合理的退出机制保证用户权益。区分业务（DNN、切片等）的拥塞控制，对部分用户进行延时处理，降低当前网络负荷，平滑业务峰谷。 
自身过载控制，保证本网元正常运行设定过载指标（CPU、数据区等核心指标）。区分业务优先级，按比例进行应答拒绝，逐步降低本网元负荷。业务拒绝时携带合适原因和退避定时器，防止发生反复请求。向上游网元发送过载通知，减少来自上游的业务量。根据部署策略启用自动弹性扩容，扩充虚机数量，增加业务处理能力，降低单虚机负荷。 
周边网元过载保护，保护周边网元正常运行通过邻接网元过载控制保护，均衡整个网络负荷，保障整个网络的稳定性。 
##### 相关特性 
分类|特性名称|说明
---|---|---
保护本网元|ZUF-59-46-003 过负荷控制|以CPU/内存/数据区/License占有率为判断基础，通过限制接入请求的业务量，来降低本网元或者邻接网元的负荷，避免因负荷过高导致设备异常或崩溃。
保护周边网元|ZUF-59-52-001 基于时段的策略|对时段切换等场景引发的批量用户策略切换，通过限制RCP主动发送的策略变更消息速率，提前下发下一时段策略等方式避免或减轻对外信令冲击。
#### 周边网元故障的容灾方案 
概述 :周边网元故障触发的容灾是指链路、网元故障、网络运维导致的信令处理失败而造成用户从其他可用的网元快速接入，引发大量用户短时间内重新附着而导致的节点选择和可用数据空间的问题。因此，网元需要具有可靠的探测机制检测周边网元的状态，并提供相应的容灾方案。 
##### 周边网元故障的原因 
网元故障的原因有很多，主要包括以下几类： 
网络故障 
对端节点宕机或重启电源问题或网元软件异常。 
运营原因网络升级或业务调整时引发的网络闭塞。 
##### 周边网元检测的容灾方案 
源NF|故障NF|故障检测|故障影响|容灾方案
---|---|---|---|---
PCF|SMF|服务化接口有链路探测机制。NRF心跳检测，可将SMF的故障状态通知给PCF。|SMF无热备容灾时，N7会话在PCF挂死。|PCF定期清理挂死N7会话。如果SMF采用热备容灾方式，PCF主发请求选择备用SMF。
AMF|PCF|服务化接口有链路探测机制。NRF心跳检测，可将AMF的故障状态通知给PCF。|AMF无热备容灾时，AM/UE策略关联在PCF挂死。|PCF定期清理挂死AM/UE策略关联。如果AMF采用热备容灾方式，PCF主发请求选择备用AMF。
NRF|PCF|服务化接口有链路探测机制。|NRF一般采用主备热备容灾方式，单个NRF故障无影响。|主用NRF故障时，PCF和备用NRF通讯。
BSF|PCF|服务化接口有链路探测机制。NRF心跳检测，可将BSF的故障状态通知给PCF。|BSF一般是主备热备，单个BSF故障无影响。BSF全故障会导致语音呼叫失败。|主用BSF故障时，PCF和备用BSF通讯。BSF都故障时，PCF默认维持语音N7会话10+10分钟后释放，触发UE重建会话。
CHF|PCF|服务化接口有链路探测机制。NRF心跳检测，可将CHF的故障状态通知给PCF。|CHF一般是主备热备，单个CHF故障无影响。CHF都故障可能导致PCF策略控制不准确。|主用CHF故障时，PCF和备用CHF通讯。CHF都故障时，若PCF之前未从CHF获取到用户消费信息，PCF用缺省的用户消费信息做策略控制。
AF/NEF|PCF|服务化接口有链路探测机制。|AF/NEF一般无热备，故障会导致AF业务策略控制受影响。|无特别处理。
PCRF|PCEF/PGW|SCTP/Diameter链路检测|Gx会话在PCRF挂死。|PCRF定期清理挂死Gx会话。
SPR|PCRF|SCTP/Diameter链路检测|SPR一般是主备热备，单个SPR故障无影响。SPR都故障时，RCP对Gx会话建立默认回复失败。|主用SPR故障时，PCRF和备用SPR通讯。SPR都故障时，PGW向PCRF建立Gx会话失败，用本地策略维持会话30+5分钟后释放，触发UE重建会话。
OCS|PCRF|SCTP/Diameter链路检测|OCS一般是主备热备，单个OCS故障无影响。OCS都故障可能导致PCRF策略控制不准确。|主用OCS故障时，PCRF和备用OCS通讯。OCS都故障时，若PCRF之前未从OCS获取到用户消费信息，PCRF用缺省的用户消费信息进行策略控制。
AF|PCRF|SCTP/Diameter链路检测|AF一般无热备，故障会导致AF业务策略控制受影响。|无特别处理。
DRA|PCRF|SCTP/Diameter链路检测|DRA一般是主备热备，单个DRA故障无影响。|主用DRA故障时，PCRF和备用DRA通讯。
## 缩略语 
## 缩略语 
5GC :5G Core Network5G核心网
AF :Application Function应用功能
### AM 
Access and Mobility Management接入移动管理
AMF :Access and Mobility Management Function接入和移动管理功能
### APP 
Application应用
BSF :Binding Support Function绑定支持功能
CHF :Charging Function计费功能
### DC 
Data Center数据中心
### DRA 
Diameter Routing AgentDiameter路由代理
### DWA 
Device Watchdog Answer设备监控应答消息
### DWR 
Device Watchdog Request设备监控请求消息
### MTBF 
Mean Time Between Failures平均故障间隔时间
### MTTR 
Mean Time To Recovery平均恢复时间
NEF :Network Exposure Function网络开放功能
NF :Network Function网络功能
NRF :NF Repository Function网络仓储功能
### OCS 
Online Charging System在线计费系统
PCEF :Policy and Charging Enforcement Function计费和策略控制实施功能
PCF :Policy Control Function策略控制功能
PCRF :Policy and Charging Rules Function策略和计费规则功能
PGW :PDN Gateway分组数据网网关
SCTP :Stream Control Transmission Protocol流控制传输协议
SMF :Session Management Function会话管理功能
SPR :Subscription Profile Repository用户签约数据库
UDSF :Unstructured Data Storage Function非结构化数据存储功能
UE :User Equipment用户设备
VM :Virtual Machine虚拟机
