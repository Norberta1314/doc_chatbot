# 安装与调测 
## 软件安装 
### 部署流程 
EMSPlus的软件安装流程如[图1]所示。
图1  EMSPlus软件安装流程
EMSPlus部署流程参见[表1]。
步骤|说明|配置参考
---|---|---
1|安装准备，包括：版本文件准备网络及IP地址规划虚机资源规划|安装准备资源规划
2|在TECS或Redhat平台上：创建用户，添加项目，并选择角色和管理成员。添加网络平面和子网。添加主机集合。|TECS上配置操作在RedHat上配置操作
3.|在NFVO客户端上：新增资源池维度，包括资源池和租户。注册镜像包，导入虚机镜像文件并注册。注册版本包，导入版本包，上传openJDK，删除zte-cn-emsplus-image文件，并注册EMSPlus。实例化EMSPlus，导入Input文件并修改。|版本部署
4|在EMSPlus客户端上：更新EMSPlus的License文件。申请并更新NewStart HA双机管理软件的商业License文件。|License更新操作
5|在EMSPlus客户端上：配置MAN节点作为NTP客户端。配置MAN节点作为NTP服务端。|配置NTP同步
6|在调试机上：检查系统运行版本。检查系统时间。|EMSPlus安装后的检查项
7|在EMS客户端上：将EMSPlus接入EMS系统。配置EMSPlus与其它网元的对接数据。检查链路状态和日志。|接入EMS功能网元对接配置
### 安装准备 
#### 版本文件准备 
获取EMSPlus系统的版本文件，参见[表1]。
文件名称|说明
---|---
EMSPLUS_IMAGE_2022XXXX.zip|镜像包，版本号随发布版本。
EMSPlus_V5.22.10.XXX.csar|业务版本包，版本号随发布版本。版本包（标准TOSCA类型）包含以下目录和文件：AppSoftwares：存放业务软件版本的目录。Configfiles：存放VNF特有的配置文件，如业务数据配置文件。Definitions：VNFD定义文件及相关TOSCA类型定义文件的目录。json：VNFD的定义文件。Scripts：存放VNF插件脚本的目录，在VNFD文件中通过相对于csar包根目录的相对路径来引用。SoftwareImages：存放镜像文件的目录。TOSCA-Metadata：该目录当前只包含TOSCA.meta文件。checksum.lst：存放csar包中各个文件的校验和信息，用于文件完整性校验。csar.meta：文件类型为文本，用于描述整个csar文件的信息。
提供OpenJDK包（openJDK.zip），其中包括以下文件，参见[表2]。
文件名称|说明
---|---
zxjdk-8u272-linux-x64.zip|64位Linux版JDK文件
thirdpartlibs.zip|运行EMSPlus服务进程需要的第三方开源组件集
installJDK.sh|安装脚本
#### 默认密码信息 
TECS系统、GSO/NFVO和VNFM、以及EMSPlus系统相关的用户名和默认密码信息参见[表1]。
系统|用户名|默认密码
---|---|---
TECS系统客户端|V3.x：adminV6.x：SysAdmin|V3.x：keystoneV6.x：SysAdmin_123
TECS各节点操作系统|root|ossdbg1
GSO/NFVO客户端|admin|Zenap_123
GSO/NFVO操作系统|root|CloudStudio__123（此处为双下划线）
VNFM客户端|admin|Zenap_123
VNFM操作系统|root|CloudStudio__123（此处为双下划线）
镜像包中的操作系统|omc|Emsplusomc_123
EMSPlus客户端|admin|Z_tywg_2019
#### 虚拟化环境要求 

名称|说明
---|---
TECS版本|V02.16.11及以后版本
NFVO版本|V5.17.10.P2.B7b及以后版本
#### HA双机临时License准备 
NewStart HA双机管理软件的临时License文件（本地镜像双机），用于EMSPlus的实例化部署。
文件名称|文件说明
---|---
newstartha.keynewstartha.lic|EMSPlus双机的试用版License文件，以实际获取的文件名为准。选用的License必须为镜像双机的License。待EMSPlus正常启动并调试完成后，需要申请正式的商用License文件，并进行更新。
### 资源规划 
#### 系统组网 
网络平面与EMSPlus虚拟部署单元的关系如[图1]所示。
图1  EMSPlus系统组网
EMSPlus规划的网络平面参见[表1]。
平面类型|用途|说明
---|---|---
ZTE_EMS_NET|EMS网络平面，对接EMS、VNFM。|预创建，与MANO等网元共用，支持IPV4、IPV6
NORTH_NET|北向网络平面|对接第三方数据分析系统，支持IPV4
EMSPlus_CTRL_NET|内部控制面|实例化时自动创建，支持IPV4
EMSPlus_MEDIA_NET|内部媒体面|实例化时自动创建，支持IPV4
EMSPlus_HeartBeat1|双机心跳主用|HA集群场景时自动创建，支持IPV4
EMSPlus_HeartBeat2|双机心跳备用|HA集群场景时自动创建，支持IPV4
EMSPlus_VNF_FWNAT_NET|对接FIREWALL/CGNAT网元|现场部署时对接网元，则需要提前在VIM上创建，支持IPV4
EMSPlus_VNF_GI_NET|对接V5 xGW网元或者V7 UPF网元|现场部署时对接网元，则需要提前在VIM上创建，支持IPV4
EMSPlus_VNF_SIG_NET（即INFO文件中的BOSS网络平面）|对接AMF、SMF网元|现场部署时对接网元，则需要提前在VIM上创建，支持IPV4
EMSPlus_VNF_FTU_NET|当网元只有文件接口，没有消息接口时，EMSPlus通过FTU节点使用FTP文件接口方式对接该网元。网元的日志数据传送到FTU节点，FTU节点处理这些文件，并通过消息接口转发给MDS节点|现场部署时对接网元，则需要提前在VIM上创建，支持IPV4
#### 网络规划 
##### 规划 
 说明： 
除了ZTE_EMS_NET网络平面要配置网关，其它网络平面子网都选中禁用网关，即不需要配置网关，参见“[添加网络平面]”。
节点类型|节点说明|平面类型|平面名称|子网|说明
---|---|---|---|---|---
MDS|消息分发服务，MDS按照配置的不同分发策略，将数据源上报的数据分发到指定的数据清洗服务器。|EMSPlus_VNF_GI_NET|ZTE_EMSPlus_<局号>_VNF_GI_NET|ZTE_EMSPlus_<局号>_VNF_GI_EXT_NET|EMSPlus对接UPF网元。
EMSPlus_VNF_FWNAT_NET|MDS|消息分发服务，MDS按照配置的不同分发策略，将数据源上报的数据分发到指定的数据清洗服务器。|ZTE_EMSPlus_<局号>_VNF_FWNAT_NET|ZTE_EMSPlus_<局号>_VNF_FWNAT_EXT_NET|EMSPlus对接FIREWALL/CGNAT的ZTE_FW_<局号>_FWNAT_NET平面，获取日志数据。
EMSPlus_VNF_SIG_NET|MDS|消息分发服务，MDS按照配置的不同分发策略，将数据源上报的数据分发到指定的数据清洗服务器。|ZTE_EMSPlus_<局号>_VNF_SIG_NET|ZTE_EMSPlus_<局号>_VNF_SIG_EXT_NET|EMSPlus对接AMF/SMF网元。
EMSPlus_MEDIA_NET|MDS|消息分发服务，MDS按照配置的不同分发策略，将数据源上报的数据分发到指定的数据清洗服务器。|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|MDS向DCU转发数据。
EMSPlus_CTRL_NET|MDS|消息分发服务，MDS按照配置的不同分发策略，将数据源上报的数据分发到指定的数据清洗服务器。|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|接受MAN主控模块的管理控制以及配置消息。
MAN|EMSPlus的主控模块|ZTE_EMS_NET|运营商规划，如ZTE_EMS_<局号>_NET|运营商规划，如ZTE_EMS_<局号>_SUBNET|与其他网元共用，EMSPlus实例化前已创建。
EMSPlus_MEDIA_NET|MAN|EMSPlus的主控模块|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|与DCU和DPU交互，完成数据的二次聚集、入库。
EMSPlus_CTRL_NET|MAN|EMSPlus的主控模块|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|MAN管理EMSPlus系统的各个模块。
EMSPlus_HeartBeat1|MAN|EMSPlus的主控模块|ZTE_EMSplus_<局号>_HEART1_NET|ZTE_EMSplus_<局号>_HEART1_NET_SUBNET|双机心跳主用
EMSPlus_HeartBeat2|MAN|EMSPlus的主控模块|ZTE_EMSplus_<局号>_HEART2_NET|ZTE_EMSplus_<局号>_HEART2_NET_SUBNET|双机心跳备用
DCU|数据采集单元，实现对数据的接收、清洗、聚集、推送等。|EMSPlus_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|接收由MDS/ASC（Association Node，关联节点）转发来的CHR数据。
EMSPlus_CTRL_NET|DCU|数据采集单元，实现对数据的接收、清洗、聚集、推送等。|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|接受MAN主控模块的管理控制以及配置消息。
NORTH_NET|DCU|数据采集单元，实现对数据的接收、清洗、聚集、推送等。|-|-|对接北向。网段应与运营商协商，建议不要和网管平面共享，因为北向网络流量较大，可能会影响正常的网管业务。
DPU_C|数据库控制节点|EMSPlus_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|数据入库和查询。
EMSPlus_CTRL_NET|DPU_C|数据库控制节点|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|接受MAN主控模块的管理控制以及配置消息。
DPU_D|数据库数据节点|EMSPlus_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|数据入库和查询。
EMSPlus_CTRL_NET|DPU_D|数据库数据节点|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|接受MAN主控模块的管理控制以及配置消息。
ASC|数据关联节点。在5G C/U分离组网场景下，将控制数据和用户数据进行关联。|EMSPlus_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|接收由MDS转发来的CHR数据。
EMSPlus_CTRL_NET|ASC|数据关联节点。在5G C/U分离组网场景下，将控制数据和用户数据进行关联。|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|接受MAN主控模块的管理控制以及配置消息。
FTU|文件转换单元，将文件接口的日志转换为消息接口的消息，并发送给MDS。|EMSPlus_ MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA_NET|ZTE_EMSplus_<局号>_MEDIA _SUBNET|内部数据传输使用。
EMSPlus_CTRL_NET|FTU|文件转换单元，将文件接口的日志转换为消息接口的消息，并发送给MDS。|ZTE_EMSplus_<局号>_CTRL_NET|ZTE_EMSplus_<局号>_CTRL_NET_SUBNET|接受MAN主控模块的管理控制以及配置消息。
EMSPlus_HeartBeat1|FTU|文件转换单元，将文件接口的日志转换为消息接口的消息，并发送给MDS。|ZTE_EMSplus_<局号>_HEART1_NET|ZTE_EMSplus_<局号>_HEART1_NET_SUBNET|双机心跳主用
EMSPlus_HeartBeat2|FTU|文件转换单元，将文件接口的日志转换为消息接口的消息，并发送给MDS。|ZTE_EMSplus_<局号>_HEART2_NET|ZTE_EMSplus_<局号>_HEART2_NET_SUBNET|双机心跳备用
EMSPlus_VNF_FTU_NET|FTU|文件转换单元，将文件接口的日志转换为消息接口的消息，并发送给MDS。|ZTE_EMSPlus_<局号>_VNF_FTU_NET|ZTE_EMSPlus_<局号>_VNF_FTU_EXT_ NET|EMSPlus对接文件接口的网元，获取日志数据。
##### 示例 
按照运营商资源池规范命名规划网络平面，示例如下：LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NETLN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-HB1-NETLN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-HB2-NETLN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NETLN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NETLN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-SIG-NET 
无特殊要求时，建议采用局号（网元ID）240，示例如下：ZTE_EMSplus_240_HEART1_NETZTE_EMSplus_240_HEART2_NETZTE_EMSplus_240_MEDIA_NETZTE_EMSplus_240_CTRL_NETZTE_EMSPlus_240_VNF_FWNAT_ NETZTE_EMSPlus_240_VNF_GI_NETZTE_EMSPlus_240_VNF_SIG_NETZTE_EMSPlus_240_VNF_FTU_NET 
#### IP地址规划 
 说明： 
IP地址规划时，需要考虑后续扩容时的需要，预留足够的地址空间。 
当现场开局部署多个MDS节点时，需要预留一个ZTE_EMS_NET地址作为EMSPlus的业务地址。业务地址配置在SDN的路由表中，业务地址的下一跳是MDS的实地址。这样可实现网元发往业务地址的消息分发到多个MDS节点上。 
平面类型|平面名称|VLAN|IP段|虚机|地址
---|---|---|---|---|---
ZTE_EMS_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NET|485|17.20.11.208/28VRRP GW：17.20.11.222|MAN[IPV4]|MAN1|17.20.11.210
MAN2|ZTE_EMS_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NET|485|17.20.11.208/28VRRP GW：17.20.11.222|MAN[IPV4]|17.20.11.211
浮动地址|ZTE_EMS_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NET|485|17.20.11.208/28VRRP GW：17.20.11.222|MAN[IPV4]|17.20.11.209
2001:1000:2000::/64VRRP GW：2001:1000:2000::1|ZTE_EMS_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NET|485|MAN[IPV6]|MAN1|2001:2000:1000::101
MAN2|2001:1000:2000::/64VRRP GW：2001:1000:2000::1|ZTE_EMS_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NET|485|MAN[IPV6]|2001:2000:1000::102
浮动地址|2001:1000:2000::/64VRRP GW：2001:1000:2000::1|ZTE_EMS_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-EMS-NET|485|MAN[IPV6]|2001:2000:1000::100
EMSPlus_HeartBeat_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-HB1-NET|490|192.168.54.0/29|MAN|MAN1|192.168.54.1
MAN2|EMSPlus_HeartBeat_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-HB1-NET|490|192.168.54.0/29|MAN|192.168.54.2
LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-HB2-NET|EMSPlus_HeartBeat_NET|491|192.168.54.8/29|MAN1|MAN|192.168.54.9
MAN2|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-HB2-NET|EMSPlus_HeartBeat_NET|491|192.168.54.8/29|192.168.54.10|MAN
EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|DCU|DCU1|192.168.52.21
DCU2|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|DCU|192.168.52.22
DCU3|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|DCU|192.168.52.23
DCU4|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|DCU|192.168.52.24
DPU|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|DPU1|192.168.52.31
DPU2|DPU|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|192.168.52.32
DPU3|DPU|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|192.168.52.33
MAN|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|MAN1|192.168.52.2
MAN2|MAN|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|192.168.52.3
浮动地址|MAN|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|192.168.52.1
MDS|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|MDS1|192.168.52.11
MDS2|MDS|EMSPlus_MEDIA_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-MEDIA-NET|489|192.168.52.0/24|192.168.52.12
EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|DCU|DCU1|192.168.53.21
DCU2|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|DCU|192.168.53.22
DCU3|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|DCU|192.168.53.23
DCU4|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|DCU|192.168.53.24
DPU|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|DPU1|192.168.53.31
DPU2|DPU|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|192.168.53.32
DPU3|DPU|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|192.168.53.33
MAN|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|MAN1|192.168.53.2
MAN2|MAN|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|192.168.53.3
浮动地址|MAN|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|192.168.53.1
MDS|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|MDS1|192.168.53.11
MDS2|MDS|EMSPlus_CTRL_NET|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-CTRL-NET|488|192.168.53.0/24|192.168.53.12
EMSPlus_VNF_SIG_NET（VRF：SIG）（即BOSS网络平面）|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-SIG-NET|486|183.5.9.144/28|MDS|MDS1|183.5.9.147
MDS2|EMSPlus_VNF_SIG_NET（VRF：SIG）（即BOSS网络平面）|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-SIG-NET|486|183.5.9.144/28|MDS|183.5.9.148
业务地址|EMSPlus_VNF_SIG_NET（VRF：SIG）（即BOSS网络平面）|LN-DL-ZSL-RP0002B-A-MANO-ZE-EMSPLUS01-B-VNET-SIG-NET|486|183.5.9.144/28|MDS|183.5.11.32/32
#### 虚机资源 
EMSPlus虚拟机的M规格配置参见[表1]，说明如下：
当前版本中的虚拟机支持M、S和T规格。 
商用局规范要求所有存储必须使用云盘。特殊情况必须使用本地盘的话，则系统盘和数据盘的类型必须一致，不能系统盘是本地盘，数据盘是云盘。 
系统盘和数据盘RAID类型规划为RAID 10，数据库盘类型规划为RAID 5，具体配置遵循现场需求，具体操作参见磁阵的配置指导手册。 
节点类型|冗余策略|配置原则|虚机资源|说明
---|---|---|---|---
MAN|1+1主备|每1个VNF固定1对。|8 vCPU+24 GB内存+系统盘40 GB+数据盘300 GB|-
MDS|3+1负载均衡|每3个MDS配置1个冗余，至少2个。|8 vCPU+24 GB内存+系统盘40 GB+数据盘300 GB|-
ASC|7+1负载均衡|每7个ASC配置1个冗余，至少2个。|12 vCPU+80 GB内存+系统盘40 GB+数据盘300 GB|-
DCU（EMSPlus（Reporting））|7+1负载均衡|每7个DCU配置1个冗余，至少2个。|12 vCPU+80 GB内存+系统盘40 GB+数据盘300 GB|DCU_RP：EMSPlus（Reporting）的DCU
DCU（EMSPlus（Logging））|7+1负载均衡|每7个DCU配置1个冗余，至少2个。|12 vCPU+80 GB内存+系统盘40 GB+数据盘300 GB|DCU_MU：EMSPlus（Logging）的DCU
DPU_D|N+4负载均衡|DPU_C合并部署到DPU_D中。DPU_C最多部署64个节点，DPU_D最多部署300个节点。DPU_C节点按支持20个并发计算，最少配置3个管理节点。|12 vCPU+80 GB内存+系统盘40 GB+数据盘300 GB+数据库盘（按售前规划）|数据库盘大小根据现场要求，可在实例化时指定。
FTU|1+1主备|每6对FTU配置一对冗余。|12 vCPU+80 GB内存+系统盘40 GB+数据盘200 GB文件盘可配置（文件盘大小可参考HLD/LLD），支持使用本地盘。|-
节点类型|冗余策略|配置原则|虚机资源|说明
---|---|---|---|---
MAN|1+1主备|每1个VNF固定1对。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|-
MDS|3+1负载均衡|每3个MDS配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40   GB+数据盘300 GB|-
ASC|7+1负载均衡|每7个ASC配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|-
DCU（EMSPlus（ Reporting））|7+1负载均衡|每7个DCU配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|DCU_RP：EMSPlus（ Reporting）的DCU
DCU（EMSPlus（ Logging））|7+1负载均衡|每7个DCU配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|DCU_MU：EMSPlus（   Logging）的DCU
DPU_D|N+4负载均衡|DPU_C合并部署到DPU_D中。 DPU_C最多部署64个节点，DPU_D最多部署300个节点。 DPU_C节点按支持20个并发计算，最少配置3个管理节点。|6 vCPU+40 GB内存+系统盘40 GB+数据盘300   GB+数据库盘（按售前规划）|数据库盘大小 根据现场要求，   可在实例化时指定。
FTU|1+1主备|每6对FTU配置一对冗余。|6 vCPU+20 GB内存+系统盘40 GB+数据盘200 GB 文件盘可配置（文件盘大小可参考HLD/LLD），支持使用本地盘。|-
节点类型|冗余策略|配置原则|虚机资源|说明
---|---|---|---|---
MAN|1+1主备|每1个VNF固定1对。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|-
MDS|3+1负载均衡|每3个MDS配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40   GB+数据盘300 GB|-
ASC|7+1负载均衡|每7个ASC配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|-
DCU（EMSPlus（ Reporting））|7+1负载均衡|每7个DCU配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|DCU_RP：EMSPlus（ Reporting）的DCU
DCU（EMSPlus（ Logging））|7+1负载均衡|每7个DCU配置1个冗余，至少2个。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300 GB|DCU_MU：EMSPlus（   Logging）的DCU
DPU_D|N+4负载均衡|DPU_C合并部署到DPU_D中。 DPU_C最多部署64个节点，DPU_D最多部署300个节点。 DPU_C节点按支持20个并发计算，最少配置3个管理节点。|4 vCPU+8 GB内存+系统盘40 GB+数据盘300   GB+数据库盘（按售前规划）|数据库盘大小 根据现场要求，   可在实例化时指定。
FTU|1+1主备|每6对FTU配置一对冗余。|4 vCPU+8 GB内存+系统盘40 GB+数据盘200 GB 文件盘可配置（文件盘大小可参考HLD/LLD），支持使用本地盘。|-
### VIM配置 
根据VIM运行环境，登录TECS或者RedHat客户端进行配置。
#### TECS上配置操作 
##### 登录TECS客户端 

摘要 : 
在TECS客户端使用浏览器（Google Chrome或者Firefox）登录到TECS系统，以便后续为实例化VNF操作配置相关数据。
相关信息 : 
TECS系统以OpenStack开源云管理平台为基础，融合NFV架构。通过统一的接口，对虚拟化基础设施进行集中调度和管理，从而降低业务的运行成本，保证TECS系统安全性和可靠性。
步骤 : 
在客户端浏览器的地址栏中输入https://<TECS OpenStack的IP地址>/ngportal/login
。
地址填写说明参见[表1]。
项目|说明
---|---
TECS OpenStack的IP地址|TECS控制节点的IP地址，客户端通过此地址使用浏览器访问TECS系统。
按回车键，打开TECS系统用户登录对话框，如[图1]所示。
图1  TECS系统用户登录对话框
输入用户名和密码，单击登录按钮，打开TECS客户端窗口，如[图2]所示。
默认管理员用户和密码参见“[默认密码信息]”
。
图2  TECS系统客户端窗口
##### 创建用户 

摘要 : 
用户即TECS系统客户端窗口操作的使用者，本节描述如何创建一个EMSPlus用户。
步骤 : 
在TECS系统客户端窗口，选择菜单系统管理→身份→用户
，打开用户管理页面，如[图1]所示。
图1  用户管理
单击创建用户按钮，打开创建用户页面，如[图2]所示。
图2  创建用户
用户基本信息参数说明参见[表1]。
参数名称|参数说明
---|---
域|新建用户归属的域。
用户名|新建用户的名称，不可与已存在的用户名称重复，例如EMSPlus_User。EMSPlus的安装需要通过此用户登录到TECS系统。
密码确认密码|用户登录时使用的密码，密码应需满足安全策略的要求。密码和确认密码保持一致。
邮箱|该用户的电子邮箱地址。
下次登录修改密码|新建用户下次登录时是否要修改密码。
项目|新建用户归属的项目。如果已创建EMSPlus项目，可以选择该项目，并选择该用户拥有的角色。可以选择菜单系统管理→身份→角色，查看各角色具有的操作权限。
描述|对该用户的描述信息，用于识别创建的用户。
设置用户的基本信息。 
（可选）单击显示高级设置，设置启用非活跃策略和IP限制参数。
选中阅读并接受，单击创建按钮，新建用户显示在用户列表中。
相关任务 : 
用户可以在用户管理页面（如[图1]所示），单击一个用户的详情下拉列表框，编辑、删除、禁用用户，重置用户的密码，编辑用户所在的项目以及拥有的角色。
##### 添加项目 

摘要 : 
本文以创建ZTE_EMSPlus_PROJ项目为例。TECS系统支持项目的添加和删除，以及编辑项目成员和修改项目配额。
每个虚拟化的网元（例如EMSPlus网元）都应该运行在各自的项目（即租户）中，TECS系统通过不同的项目来实现各种虚拟资源的隔离。
步骤 : 
在TECS客户端窗口，选择菜单系统管理→身份→项目
，打开项目列表页面，如[图1]所示。
图1  项目列表
单击添加项目按钮，弹出添加项目对话框，如[图2]所示。
图2  创建项目1
图3  创建项目2
 说明： 
配额的参数值“-1”表示无限制。
项目参数说明参见[表1]。
参数名称|参数说明
---|---
名称|根据规划填写EMSPlus项目的名称，例如ZTE_EMSPlus_PROJ。
域|项目归属的域，默认为Default。
描述|项目名称的补充说明信息。
实例|项目支持的最大虚拟主机数量。
VCPU|项目支持的最大虚拟内核数量。
内存|项目支持的最大虚拟内存大小。
云硬盘|项目支持的最大虚拟硬盘个数。
云硬盘快照|项目支持的最大云硬盘快照个数。
存储|项目支持的最大云硬盘和快照总大小。
元数据条目|项目支持的最大元数据条目数。
密钥对|项目支持的最大密钥对个数。
可注入文件|项目支持的最大注入文件数。
注入文件路径最大长度|项目支持的注入文件路径的最大长度。
可注入文件大小|项目支持的最大文件内容大小。
浮动IP|项目支持的最大浮动IP个数。
网络|项目支持的最大逻辑网络个数。
端口|项目支持的最大虚拟端口个数。
路由|项目支持的最大路由个数。
子网|项目支持的最大子网个数。
防火墙|项目支持的最大防火墙个数。
防火墙策略|项目支持的最大防火墙策略个数。
防火墙规则|项目支持的最大防火墙规则个数。
负载均衡|项目支持的最大负载均衡个数。
安全组|项目支持的最大安全组个数。
安全组规则|项目支持的最大安全组规则个数。
虚机组|项目支持的最大虚机组个数。
虚机组成员|项目支持的最大虚机组成员个数。
RBAC策略|项目支持的最大RBAC策略个数。RBAC是基于角色的访问控制。
子网池|项目支持的最大子网池数目。
根据规划配置项目名称、域信息、项目配额。 
切换到管理成员页面，如[图4]所示。
图4  编辑项目成员
单击可选用户区域框中用户后的按钮，将需要加入项目的以下用户添加到项目成员区域框中，如[图5]所示。
 
EMSPlus用户（例如在创建用户”中创建的EMSPlus_User用户） 
 
TECS系统管理员用户（SysAdmin或admin用户） 
 
NFVO和VNFM接入TECS时使用的用户（例如mano用户，可在NFVO/VNFM客户端的系统→接入管理→VIM菜单，查看VIM用户的名称。） 
 
图5  添加项目成员
在项目角色的下拉列表框，选择项目成员具有的角色。
可以选择菜单系统管理→身份→角色
，查看各角色具有的操作权限。
单击添加按钮，新增的项目显示在项目列表中。
相关任务 : 
用户可以在项目页面（如[图1]所示），单击一个项目右侧的操作栏中的下拉菜单，选择修改配额快捷菜单，修改项目的当前配额参数；选择管理成员快捷菜单，修改项目成员和项目角色
##### 添加网络平面 
摘要 : 
EMSPlus实例化前应该已在TECS创建了EMS网络平面及其子网（运营商规划，例如ZTE_EMS_NET），EMSPlus与MANO等其他网元共用该网络平面。
当现场部署需要对接哪个网元时，则在TECS上添加对应的网络平面。 
相关信息 : 
网络平面是指TECS中的各个虚拟机（VM）通讯时所采用的逻辑网络，其目的是为了实现通信隔离，各个VM只能与处于同一个网络平面中的其它VM进行通信，这样可以提升数据的安全性。
步骤 : 
添加网络平面
在TECS客户端，选择菜单云管理→网络
→网络
，页面显示TECS系统已添加的网络平面，如[图1]所示。
图1  网络平面
单击添加网络，打开添加网络页面，如[图2]所示。
图2  添加网络
参数名称|参数说明
---|---
项目|在下拉列表框中选择对应的项目名称，给已有的项目添加一个网络。选择“添加项目”中创建的EMSPlus项目名称。
名称|输入需添加的网络平面名称，例如ZTE_EMSPlus_205_VNF_GI_NET。
网络类型|选择vlan，才显示物理网络、VLAN透传参数。
物理网络|根据现场环境情况配置。
VLAN透传|不选中。该网络可以透传上层业务带VLAN的报文，从而支持VLAN trunk功能。
段ID|根据交换机上的配置，输入该网络平面对应的VLAN ID。
MTU|保持默认值1500。MTU值设定TCP/IP协议传输数据报时的最大传输单元。
网络QoS|从下拉列表中选择网络QoS，实现对网络流量、带宽等控制。
管理状态|选择开启状态。该参数表示网络的管理状态：关闭：网络不再转发IP包。开启：正常发包。
共享|不选中。选中共享网络：所有项目都可用。不选中共享网络：本项目可用。
外部网络|不选中。
配置网络平面参数，单击添加按钮。
重复步骤[2]~[3]，直至所有网络均已被添加。
添加子网
单击需要添加子网的网络平面的操作列，选择快捷菜单添加子网，如[图3]所示。
图3  选择添加子网
配置子网平面参数，如[图4]所示。
图4  添加子网
参数名称|参数说明
---|---
名称|输入需添加的子网名称，例如ZTE_EMSPlus_205_VNF_GI_EXT_NET。
CIDR|CIDR格式的网络地址，如10.255.1.0/28，“/”符号后为子网掩码的位数。
项目|默认该子网的网络平面添加时选择的项目。
激活DHCP|不选中，即禁用DHCP。选中激活DHCP：会给虚机分配IP地址。不选中激活DHCP：不给虚机分配IP地址。
禁用网关|ZTE_EMS_NET网络平面不选中禁用网关。与对接网元的网络平面选中禁用网关，例如EMSPlus_VNF_GI_NET、EMSPlus_VNF_GTP_NET、EMSPlus_VNF_BOSS_NET、EMSPlus_VNF_FWNAT_NET。
网关IP|不需要设置。网关IP地址，缺省值是网络地址的第一个IP。
地址池|不需要设置。该参数为IP地址分配池，每条记录是“开始IP，结束IP（例如100.168.1.100,100.168.1.120）”，每行一条记录。
域名服务器|不需要设置。该参数表示当前子网的DNS服务器IP地址列表，每行一个。
主机路由|不需要设置。该参数表示主机增加额外的路由，每条记录是“目的CIDR，下一跳（例如100.168.200.0/24,101.56.1.254）”，每行一个记录。
单击添加按钮，完成子网的添加。
重复步骤[5]~[7]，直至所有网络平面的子网均已被添加。
在网络页面单击网络列表中的网络名称，可以查看到网络信息，示意如[图5]所示。
图5  网络信息
##### 添加主机集合 
摘要 : 
在TECS上创建主机集合，并输入指定的元数据。
 说明： 
对于TECS 6.x环境，TECS维护人员需要关闭AggregateInstanceExtraSpecsFilter过滤器，也可以按照本节操作，避免EMSPlus实例化的失败。
步骤 : 
在TECS系统客户端窗口，选择菜单云管理→计算→主机集合
，打开主机集合列表页面，如[图1]所示。
图1  主机集合
单击添加主机集合，打开主机集合添加页面。配置主机集合的基本信息，示例如[图2]所示。
图2  主机集合基本信息
参数名称|参数说明
---|---
名称|自定义主机集合的名称，不可与已有的主机集合名称重名。
可用域|该参数和INPUT文件中的虚机可用域参数保持一致，参见“INPUTS参数说明”。可用域是指具有相同属性的主机集。TECS OpenStack安装完成后，系统默认生成internal和nova可用域。可以使用默认的可用域。也可以自定义可用域，并向可用域中加入主机后，自定义的可用域会显示在可用域的列表中。
元数据|配置元数据为sriov = false。元数据用于定义主机集合的附加属性。
单击主机管理，在打开的页面中单击按钮，将需要加入集合的主机添加到选中的主机列表，如[图3]所示。
图3  管理主机
单击添加按钮。
##### 添加虚机规格（可选） 
摘要 : 
 说明： 
对于mano用户在TECS为非admin权限时，需要提前创建虚机规格。
在TECS上创建虚机规格，并指定元数据。
本文以TECS OpenStack V06.10.10.10版本举例，具体以实际版本为准。 
步骤 : 
在TECS系统客户端窗口，选择菜单云管理→计算→虚机规格
，打开虚机规格列表页面，如[图1]所示。
图1  虚机规格列表
单击添加虚机规格，打开虚机规格添加页面。配置虚机规格的基本信息和元数据，示例如[图2]所示。
图2  添加虚机规格
参数名称|参数说明
---|---
基本信息|名称|虚机规格的名称，根据规划填写。
VCPU|基本信息|节点虚机的vCPU核数和内存大小。MAN节点：8+24 GBDCU_RPT节点：12+80 GBDCU_LOG节点：12+80 GBMDS节点：8+24 GBASC节点：12+80 GBFTU节点：12+80 GBDPU节点：12+80 GB
内存|基本信息|节点虚机的vCPU核数和内存大小。MAN节点：8+24 GBDCU_RPT节点：12+80 GBDCU_LOG节点：12+80 GBMDS节点：8+24 GBASC节点：12+80 GBFTU节点：12+80 GBDPU节点：12+80 GB
根磁盘|基本信息|根据规划填写。
临时磁盘|基本信息|根据规划填写。
Swap磁盘|基本信息|根据规划填写。
资源上限|基本信息|不选资源上限，用该规格创建的虚机无法动态调整CPU和内存的大小。
元数据|CPU绑核策略|启用CPU绑核策略。
内存页大小|元数据|内存页大小设置为1G。
看门狗|元数据|启用虚机看门狗。
光驱设备|元数据|默认不选择。
网卡多队列|元数据|默认不选择。
CPU类型|元数据|默认不选择。
元数据|元数据|添加以下元数据：单NUMA节点运行：hw.numa_nodes=1看门狗重启：hw.watchdog_action=reset
单击添加按钮。
#### 在RedHat上配置操作 
##### 登录RedHat客户端 

摘要 : 
在客户端使用浏览器（Google Chrome或者Firefox）登录到RedHat系统，以便后续为实例化VNF操作配置相关数据。
步骤 : 
在客户端浏览器的地址栏中输入http://<RedHat_OpenStack_Platform_IP>/dashboard
（例如http://10.43.37.232/dashboard）。
按回车键，打开RedHat系统的用户登录对话框，如[图1]所示。
图1  RedHat系统用户登录
输入用户名和密码，单击连接按钮，打开RedHat系统客户端窗口，默认显示为项目页面，如[图2]所示。
图2  RedHat系统客户端窗口
##### 创建用户 

摘要 : 
本节以创建EMSPlus_User用户为例描述如何创建一个RedHat用户。
步骤 : 
在RedHat系统客户端窗口，单击身份管理，切换到用户页面，页面显示用户列表，如[图1]所示。
图1  用户管理
单击创建用户按钮，弹出创建用户对话框，如[图2]所示。
图2  创建用户
用户信息参数说明参见[表1]。
参数名称|参数说明
---|---
域ID|新建用户归属的域，使用默认值。
域名|新建用户归属的域，使用默认值。
用户名|新建用户的名称，不可与已存在的用户名称重复，例如EMSPlus_User。
描述|对该用户的描述信息，用于识别创建的用户。
邮箱|该用户的电子邮箱地址。
密码|用户登录时使用的密码，密码应需满足安全策略的要求。密码和确认密码保持一致。
确认密码|用户登录时使用的密码，密码应需满足安全策略的要求。密码和确认密码保持一致。
主项目|与用户关联的项目，用户登录系统后可以访问项目信息。
角色|设置用户的角色，一般设置为_member_或者admin。
设置用户信息，示例如[图3]所示。
图3  创建用户示例
单击创建用户按钮，新建用户显示在用户列表中，如[图4]所示。
图4  用户列表
##### 创建项目 

摘要 : 
本文以创建EMSPlus_PROJ项目为例。RedHat系统支持项目的添加和删除，以及编辑项目成员和修改项目配额。
每个虚拟化的网元（例如EMSPlus网元）都应该运行在各自的项目（即租户）中，RedHat系统通过不同的项目来实现各种虚拟资源的隔离。
步骤 : 
在RedHat系统客户端窗口，单击身份管理，默认显示项目页面，页面显示RedHat系统已有的项目，如[图1]所示。
图1  项目管理
单击创建项目按钮，弹出创建项目对话框，如[图2]所示。
图2  创建项目
项目信息参数说明参见[表1]。
参数名称|参数说明
---|---
域ID|新建项目归属的域，使用默认值。
域名|新建项目归属的域，使用默认值。
名称|根据规划，填写EMSPlus网元项目的名称，例如EMSPlus_PROJ。
描述|项目名称的补充说明信息。
设置项目的名称、描述信息。 
切换到项目成员页面，如[图3]所示。
图3  项目成员
单击全部用户区域框中用户的按钮，将需要加入项目的以下用户添加到项目成员区域框中，如[图4]所示。
 
EMSPlus用户（例如在创建用户”中创建的EMSPlus_User用户） 
 
RedHat系统管理员用户（admin用户） 
 
NFVO和VNFM接入RedHat时使用的用户（例如MANO用户） 
 
图4  编辑项目成员
在项目成员的下拉列表框，选择项目成员具有的角色。
切换到项目组页面，配置项目组，如[图5]所示。
图5  项目组
切换到配额页面，如[图6]所示。
图6  项目配额
项目配额参数说明参见[表2]。
参数名称|参数说明
---|---
元数据条目|为该项目分配的元数据（即描述信息资源或数据等对象的数据）条目。
VCPU数量|为该项目分配的vCPU（虚拟内核）个数，该项目中启动的虚机的内核数总和不得超过该参数值。
云主机|为该项目分配的虚拟主机数量，该项目中启动的虚机的个数总和不得超过该参数值。
注入的文件|该项目可以包含的注入文件数量。
已注入文件的内容(Bytes)|添加的注入文件最大量。
密钥对|项目支持的最大密钥对个数。
注入文件路径最大长度|项目支持的注入文件路径的最大长度。
卷|为该项目分配的虚机硬盘数量。
卷快照|为该项目分配的云硬盘快照数量。硬盘快照保存硬盘的状态，不保存硬盘内容。创建快照后，可以把硬盘恢复到创建快照时的状态。
卷及快照总大小(GB)|为该项目分配的云硬盘总空间，该项目中云硬盘快照的总和不得超过该参数值。
内存(GB)|为该项目分配的虚拟内存大小，该项目中启动的虚机的内存大小总和不得超过该参数值。
安全组|该项目中允许创建的安全组数。
安全组规则|该项目中允许创建的安全组规则数。
浮动IP|该项目可用的浮动IP地址数量。
网络|该项目中允许创建的网络数。
端口|该项目中允许创建的端口数。
路由|该项目中允许添加的路由数。
子网|该项目中允许创建的子网数。
项目配额可以直接扩大到默认值的10倍。 
 说明： 
如果不能满足EMSPlus的资源要求，可现场按规划修改项目配额。
单击创建项目按钮，新建项目显示在项目列表中，如[图7]所示。
图7  项目列表
相关任务 : 
用户可以在项目页面（如[图1]所示），选择一个项目的动作列的下拉菜单修改配额，修改项目的当前配额参数。
##### 创建网络平面 
摘要 : 
EMSPlus实例化前应该已在RedHat创建了EMS网络平面及其子网（运营商规划，例如ZTE_EMS_NET），EMSPlus与MANO等其他网元共用该网络平面。
当现场部署需要对接哪个网元时，则在RedHat上创建对应的网络平面。 
相关信息 : 
网络平面是指RedHat中各个虚拟机（VM）通讯时所采用的逻辑网络，其目的是为了实现通信隔离，各个VM只能与处于同一个网络平面中的其它VM进行通信，这样可以提升数据的安全性。
步骤 : 
在RedHat系统客户端窗口，单击管理员，默认显示概述页面，如[图1]所示。
图1  概述
选择菜单网络
→网络
，页面显示RedHat系统已创建的网络平面，如[图2]所示。
图2  网络管理
单击创建网络按钮，打开创建网络对话框，如[图3]所示。
图3  创建网络
参数名称|参数说明
---|---
名称|输入需创建的网络平面名称，例如ZTE_EMSPlus_164_VNF_GI_NET。
项目|在下拉列表框中选择对应的项目名称，给已有的项目创建一个网络。选择“创建项目”中创建的EMSPlus项目名称。
供应商网络类型|为虚拟网络指定一个物理网络类型。
物理网络|物理网络名称，根据现场环境情况配置。
段ID|根据交换机上的配置，输入该网络平面对应的VLAN ID。
启用管理员状态|选中，该参数表示网络的管理状态。
共享的|不选中。选中：所有项目都可用。不选中：本项目可用。
外部网络|不选中。
创建子网|如果需要同时创建该网络平面的子网，则选中该选项，子网和子网详情页签才可见。
可用域提示|默认是nova，保持默认值。
配置网络平面参数，示例如[图4]所示。
图4  创建网络示例
切换到子网页面，如[图5]所示。
图5  创建子网
参数名称|参数说明
---|---
子网名称|输入需创建的子网名称，例如ZTE_EMSPlus_164_VNF_GI_EXT_NET。
网络地址|CIDR格式的网络地址，如10.255.1.0/28，“/”符号后为子网掩码的位数。
IP版本|从下拉列表框中选择IPv4。
网关IP|不需要设置。网关IP地址，缺省值是网络地址的第一个IP。
禁用网关|ZTE_EMS_NET网络平面不选中禁用网关。与对接网元的网络平面选中禁用网关，例如EMSPlus_VNF_GI_NET、EMSPlus_VNF_GTP_NET、EMSPlus_VNF_BOSS_NET、EMSPlus_VNF_FWNAT_NET
根据规划，输入该子网的IP地址段及其它相关参数，示例如[图6]所示。
图6  子网创建示例
切换到子网详情页面，设置子网的扩展属性，如[图7]所示。
图7  子网详情
参数名称|参数说明
---|---
激活DHCP|不选中，即禁用DHCP。选中激活DHCP：会给虚机分配IP地址。不选中激活DHCP：不给虚机分配IP地址。
分配地址池|不需要设置。该参数为IP地址分配池，每条记录是“开始IP，结束IP（例如100.168.1.100,100.168.1.120）”，每行一条记录。
DNS服务器|不需要设置。该参数表示当前子网的DNS服务器IP地址列表，每行一个。
主机路由|不需要设置。该参数表示主机增加额外的路由，每条记录是“目的CIDR，下一跳（例如100.168.200.0/24,101.56.1.254）”，每行一个记录。
单击创建按钮，完成网络平面以及子网的创建。
重复步骤[3]~步骤[8]，创建所有的网络平面以及子网。
##### 创建虚机规格（可选） 
摘要 : 
 说明： 
对于mano用户在RedHat上为非admin权限时，需要提前创建虚机规格。 
本文以RedHat 7.9版本为例，介绍在RedHat上创建虚机规格，具体以实际版本为准。 
步骤 : 
SSH方式登录到RedHat的foreman vm虚机。
执行创建虚机规格的命令。例如“openstack flavor create MANFlavorttt --property
hw:mem_page_size='1048576'    --property hw:cpu_policy=dedicated 
 --ram 8192 --disk 0 --vcpus 4  --public”，创建MAN节点的虚机规格，虚机规格名字为MANFlavorttt ，如[图1]所示。
图1  创建虚机规格
参数名称|参数说明
---|---
hw:mem_page_size='1048576'|内存页大小设置为1G。
hw:cpu_policy=dedicated|启用CPU绑核策略，默认为dedicated。
ram 8192|节点虚机的内存大小，设置为8G（此处以8G举例，具体大小以LLD为准）。
disk 0|本地盘大小设置，使用云盘，则设置为0（具体大小以LLD为准）。
vcpus 4|节点虚机的vCPU核数，设置为4核（此处以4核举例，具体大小以LLD为准）。
public|设置为公用属性。
### 版本部署 
#### 登录NFVO客户端 

摘要 : 
登录NFVO客户端后，用户可以在NFVO服务器上完成EMSPlus的VNF部署操作。
步骤 : 
在客户端打开Google Chrome浏览器，在地址栏输入NFVO客户端的URL地址，按回车键，弹出登录对话框，如[图1]所示。
 
对于CloudStudio(NFVO) V5.18.10.B6及以前版本，登录方式为https://NFVO服务端IP:10080/nfvo-mano-portal。 
 
对于CloudStudio(NFVO) V5.18.10.P3.B6及以后版本，登录方式为https://NFVO服务端IP:28808/nfvo-mano-portal。 
 
图1  登录对话框
输入用户名和密码，默认管理员用户和密码参见“[默认密码信息]”
。
单击登录按钮，打开NFVO客户端窗口，如[图2]所示。
图2  NFVO客户端窗口
#### 新增资源池维度 
摘要 : 
资源池维度包括资源池和租户。 
 说明： 
租户名称要与TECS上租户名称一致，参见“添加项目”。 
资源池标识要与TECS的VIM ID一致（在TECS客户端，选择菜单系统管理→云配置→基本参数，在打开的VIM参数页面查看）。 
步骤 : 
在NFVO客户端，选择菜单系统→安全→域维度管理
，单击左侧的域维度导航树，查看每个域维度的数据，如[图1]所示。
图1  域维度管理
在左侧域导航树中选择资源池
→资源池
，打开资源池管理页面。单击新建按钮，新增VIM资源池维度，示例如[图2]所示。
图2  新增资源池维度
单击确定，新建的资源池维度示例如[图3]所示。
图3  资源池维度
在左侧域导航树中选择资源池→租户
，打开租户管理页面。单击新建按钮，新增租户维度，示例如[图4]所示。
图4  新增租户维度
 说明： 
某些场景下，没有主备状态参数。
单击确定，新建的租户维度示例如[图5]所示。
图5  租户维度
#### 注册镜像包 
摘要 : 
NFVO从指定的路径下载镜像包，注册镜像包时，NFVO再将镜像包上传到VIM。
前提 : 
已获取镜像包文件（后缀为.zip，参见“[版本文件准备]”
）。
相关信息 : 
VNF镜像用于创建VNF主机、存储和网络等资源，通常包括操作系统和应用软件。
VIM也称为云管理平台（例如TECS系统）。在VIM系统中，同一个VNF内的主机、网络等资源归属到同一项目，VIM以项目的方式实现各个虚拟网元之间虚拟资源的隔离。NFVO、VNFM通过VIM来获取云管理平台上资源信息。
步骤 : 
上传镜像包
如果采用FTP/SFTP方式导入镜像包文件，则将文件存放到对应FTP/SFTP服务器路径。
在NFVO客户端，选择菜单编排→设计→软件仓库
，默认打开VNF页签，如[图1]所示。
图1  软件仓库
切换到虚机镜像页签，显示已上传的镜像包列表，如[图2]所示。
图2  镜像包列表
单击导入按钮，弹出导入对话框，如[图3]所示。
图3  导入对话框
参数名称|参数说明
---|---
导入方式|本地文件或者FTP/SFTP导入方式。如果采用本地文件方式导入镜像包文件，则将镜像包文件存放到本地，选择文件后单击上传即可，如图4所示。
传输协议|无需配置，根据导入方式选择ftp或者sftp结果显示。
IP和端口|存放镜像包的FTP/SFTP服务器的IP和服务端口。FTP服务默认端口21，SFTP默认服务端口22。
用户名|存放镜像包的FTP/SFTP服务器的访问用户名。
密码|存放镜像包的FTP/SFTP服务器的访问密码。
文件路径|包含文件名的镜像包存放目录绝对路径。
验签|是否需要校验镜像包的数字签名。
图4  本地文件方式导入镜像包
根据实际规划填写镜像包的存储路径，单击提交按钮，进度为100%，镜像包上传完毕。
此时镜像包是否注册为否，如[图5]所示。
图5  上传镜像包
注册镜像包
单击上传镜像包操作列的注册按钮，打开注册对话框。
镜像类型选择公有，应用资源区选择需要注册的VIM，单击注册按钮，如[图6]所示。
图6  注册对话框
待进度为100%，镜像包注册完毕，关闭对话框。 
此时镜像包是否注册变成是，如[图7]所示。
图7  注册镜像包
#### 注册版本包 

摘要 : 
注册版本包，将版本包上传到NFVO服务器。
前提 : 
已获取版本包文件（后缀为.csar，参见“[版本文件准备]”
）。
步骤 : 
上传版本包
如果采用FTP/SFTP方式导入版本包文件，则将文件存放到对应FTP/SFTP服务器路径。
在NFVO客户端，选择菜单编排→设计→蓝图中心
，默认打开VNF列表，如[图1]所示。
图1  蓝图中心
单击导入按钮，弹出导入VNF蓝图对话框，如[图2]所示。
图2  导入VNF蓝图对话框
参数名称|参数说明
---|---
导入方式|本地文件或者FTP/SFTP导入方式。
传输协议|无需配置，根据导入方式选择ftp或者sftp结果显示。
IP和端口|存放版本包的FTP/SFTP服务器的IP和服务端口。FTP服务默认端口21，SFTP默认服务端口22。
用户名|存放版本包的FTP/SFTP服务器的访问用户名。
密码|存放版本包的FTP/SFTP服务器的访问密码。
文件路径|包含文件名的版本包存放目录绝对路径。
输入版本包的存放路径（本地或者FTP/SFTP服务器地址），单击提交按钮。
NFVO开始从指定的本地路径或者FTP/SFTP服务器下载版本包文件，版本包导入进度为100%，版本包上传完毕。 
此时版本包的状态为草稿，如[图3]所示。
图3  上传版本包
openJDK文件加载到版本包
单击上传版本包（EMSPlus）图标，打开EMSPlus编排页面，如[图4]所示。
图4  EMSPlus编排
单击参数按钮，打开参数设置页面，如[图5]所示。
图5  参数信息
 说明： 
单击，可以打开服务组和附件页面。
切换到附件页面，如[图6]所示。
图6  附件信息
如果部署环境为CloudStudio（GSO），则删除zte-cn-emsplus-img文件。如果部署环境为CloudStudio（NFVO），则不需要删除zte-cn-emsplus-img文件。
单击添加按钮，打开附件对话框，如[图7]所示。
图7  添加附件
预定义目录下拉列表框选择AppSoftwares，单击选择文件按钮，在弹出的对话框中选择openJDK包（openJDK.zip），如[图8]所示。
图8  上传openJDK文件
单击上传按钮，待文件上传成功，如[图9]所示，关闭对话框。
图9  openJDK文件上传成功
注册版本包
在EMSPlus编排页面（如[图4]所示），单击保存，单击发布。
选择菜单编排→设计→软件仓库
，右侧显示VNF列表，如[图10]所示。
图10  VNF列表
单击上传版本包操作列的注册按钮，打开注册对话框。
镜像类型选择公有，应用资源区选择需要注册的VIM，单击注册按钮，如[图11]所示。
图11  注册对话框
待进度为100%，版本包注册完毕，关闭对话框。 
此时版本包的状态为启用，是否被使用为否，如[图12]所示。
图12  注册版本包
#### 部署VNF 
摘要 : 
本节介绍如何实例化EMSPlus的VNF。在实例化过程中，NFVO完成VNF所需虚拟资源的创建和业务软件的自动部署。
步骤 : 
在NFVO客户端，选择菜单编排→设计→蓝图中心
，页面显示已注册的版本包列表，如[图1]所示。
图1  注册的版本包列表
单击EMSPlus版本包（如EMSPlus）中的部署按钮，打开部署VNF页面，如[图2]所示。
图2  部署VNF
VNF实例通用信息的参数说明参见[表1]。
参数名称|参数说明
---|---
实例名称|VNF实例的名称。
VNFDID|注册版本包时生成的VNF版本包标识，自动生成，不能修改。
VIM|VNF所属的VIM。可在系统→接入管理→VIM节点下，查看已有VIM信息。
租户|选择VIM上对应的项目（即租户）。
VNFM|VNF所归属的VNFM实例。可在系统→接入管理→VNFM节点下，查看已有VNFM实例。
规格|虚机的规格，选择default。
输入VNF实例的名称，选择VNFM实例以及项目。 
填写INPUTS参数，或者单击导入按钮，导入INPUTS参数配置文件（文件格式为.json）。
也可以单击后面的下拉列表框，分类（包括公共配置、网元配置、虚机配置、网络配置、高级配置）过滤INPUTS参数。
根据现场规划配置INPUTS参数，参数说明参见“[INPUTS参数说明]”
。
图3  INPUTS参数
单击下一步，单击直接部署，如[图4]所示。NFVO开始实例化VNF，并显示VNF实例化的进度。
图4  沙箱测试
选择菜单编排→应用→VNF
，查看VNF实例化状态，如[图5]所示。
图5  VNF实例化
#### 检查网络状态 
通过在EMSPlus接口地址所在网口增加静态路由的方法使ping功能可用，从而有利于判断业务网元和EMSPlus接口地址间链路的通断情况。 
详细操作参见支持业务网元PING功能
。
### License更新操作 
#### 更新EMSPlus的License 
摘要 : 
License是经过授权的许可证，在本产品中用来限制系统所支持的一些特性。License文件是一个后缀为.lic或者.LCS的文件。
前提 : 
已根据开局商务合同信息申请了License文件。 
步骤 : 
在客户端PC的浏览器地址栏中输入https://<MAN节点EMS网络平面的双机浮动IP地址>:端口号/emsplus_<局号>/client，打开EMSPlus客户端的登录对话框，如[图1]所示。
其中：端口号=32000+局号 
图1  登录对话框
输入Username、Password，单击Login按钮，登录到EMSPlus客户端。
首次登录EMSPlus客户端会提示强制修改密码，如[图2]所示。密码修改参数说明参见[表1]。
图2  强制修改密码对话框
参数名称|参数说明
---|---
Original Password|默认管理员用户和密码，参见默认密码信息。可以使用已被赋予权限的其他用户名登录。
Password|新密码。
Confirm Password|再输入一次新密码。
选择页面右上角...→System Information
，在弹出的系统信息窗口，单击Import Licesne，如[图3]所示。
图3  系统信息窗口
在弹出的导入License文件对话框中，单击选择文件，选择根据现场需要做好的*.lic或者*.LCS文件，如[图4]所示。
图4  导入license文件对话框
单击确定。
#### 更新NewStart HA双机License 
NewStart HA Cluster软件已放在镜像文件中。在部署EMSPlus的过程中，会自动部署HA双机管理软件。
##### 配置HA客户端 
摘要 : 
双机组网环境下，EMSPlus采用NewStart
HA Cluster软件（以下简称HA软件）来管理双机资源。为了保证HA客户端能够正常登录，需要在HA客户端进行相关设置。
HA客户端采用基于HTTP协议的WEB技术访问HA双机管理界面时，需要先在IE浏览器中导入HA双机安全证书。本节介绍如何导入HA双机安全证书。
该操作在双机组网环境中才需要执行，运营商可以使用一台PC机同时充当EMSPlus客户端和HA客户端。
前提 : 
操作系统只支持Windows 7及其以上版本，IE浏览器必须为8.0或以上版本（不支持9.0），或者使用Google Chrome浏览器。
相关信息 : 
客户端采用HTTP协议与服务器端的Tomcat服务器通信，通信的内容采用明文传输。一旦报文被非法截获，则集团、群组、用户等敏感信息可能被窃取，用于非法用途，造成用户的损失，甚至危害系统本身的安全。为了保证数据的安全性，因此客户端和服务端的通信内容需要通过SSL加密的方式传输。
安全证书是一种以数字签名的方式通过第三方权威认证机构有效地进行网上身份认证，以帮助各个实体识别对方身份及表明自身身份的证书，具有防抵赖功能及真实、安全、保密和防篡改的特性。 
客户端和服务端之间通信时，有以下特点。 
传输的数据经过加密。 
采用身份认证机制，确保通信双方可以验证对方的真实身份。 
通过安全证书来表明WEB客户端和WEB服务端的身份。当WEB客户端与WEB服务器通信时，双方可以通过安全证书来验证对方的合法性。 
步骤 : 
获取证书文件server.crt和mykey.p12
登录EMSPlus主机或备机，进入/opt/NewStartHA/web/nginx/conf（旧版本在/tomcat/conf），也可通过SSH方式登录到MAN节点，执行find / -name mykey.p12命令查找证书所在位置，如[图1]所示。
图1  获取证书文件
将mykey.p12和server.crt证书文件复制到HA客户端的本地硬盘中。 
导入mykey.p12和server.crt证书文件
以谷歌浏览器为例，选择设置
，在设置页面选择高级→管理证书
（或隐私和安全性→管理证书
），进入证书页面，如[图2]所示。
图2  选择管理证书
在证书页面，选择个人页签，单击导入按钮，如[图3]所示。
图3  证书页面
在弹出的证书导入向导对话框，单击下一步，如[图4]所示。
图4  证书导入向导
打开指定要导入的文件对话框，如[图5]所示。
图5  指定要导入的文件
单击浏览按钮，弹出的打开对话框，在下拉列表中选择mykey.p12证书文件，如[图6]所示。
图6  选择证书mykey.p12
单击打开，完成证书选择。单击下一步按钮，打开密码对话框，如[图7]所示。
图7  密码对话框
输入密码HA@NewStart123_，单击下一步按钮，打开设置证书存储区对话框，如[图8]所示。
图8  打开设置证书存储区对话框
选择根据证书类型，自动选择证书存储，如[图9]所示。
图9  设置证书存储方式
单击下一步按钮，打开正在完成证书导入向导对话框，如[图10]所示。
图10  正在完成证书导入向导对话框
单击完成按钮，弹出证书导入成功提示框。
单击确定按钮，安全证书安装完成，返回证书页面，显示证书导入成功，如[图11]所示。
图11  mykey.p12证书导入成功
重复以上步骤，导入server.crt文件，如[图12]所示。
图12  导入server.crt文件
##### 登录HA客户端 
摘要 : 
本节介绍如何登录NewStart HA客户端。 
前提 : 
已在浏览器导入HA双机安全证书，参见“[配置HA客户端]”。
步骤 : 
在浏览器地址栏，输入https://<MAN节点浮动IP>:10003，按回车键，打开NewStart HA管理软件登录页面，如[图1]所示。
图1  NewStart HA管理登录页面
输入用户名和密码，单击登录按钮，打开NewStart HA管理客户端页面，如[图2]所示。
登录用户名为SuperAdmin，默认密码为HA@newstart123_。
图2  NewStart HA管理客户端页面
##### 查询HA License有效期 
摘要HA双机软件安装时，打印信息中包含License有效期。也可以在HA双机软件安装完成后，执行以下操作查询到License有效期。 
前提 : 
HA双机已部署成功。 
步骤 : 
通过XShell或SecureCRT工具登录到EMSPlus的MAN节点的主用地址，备用地址，或者浮动地址。
执行[cli]命令，查询HA的License有效期，如下方红色字体。
[root@ZTE_emsplus_2_01~]# 
 [cli]
`NewStart High Available System. Version Cluster_4.0.3.06, release 20170930
    Copyright 2008–2017 Guangdong NewStart Technology Service Ltd.
You are using a trial license, and 82 days remain. Please register.
Product: Type = Mirror, SN = 65L948–q93dn1–32cr1m-10035A` 
##### 申请并部署HA商用License 
摘要 : 
在EMSPlus服务器上获取NewStart
HA双机管理软件的key文件，以及导入注册后的License文件。
前提 : 
已获取现场NewStart HA双机管理软件的商用SN（例如：从NewStart HA的安装光盘上获得）。 
EMSPlus服务器双机已正常运行。 
步骤 : 
查看HA双机类型和SN
通过XShell或SecureCRT工具登录到EMSPlus的MAN节点的主机地址、备机地址，或者浮动地址。
运行[cli]命令，查看现场HA双机的类型和SN，如下方红色字体。
 说明： 
确认当前运行的HA双机软件的版本号和类型与申请的商用License一致，否则会导致激活失败。 
[root@ZTE_emsplus_2_01~]# 
 [cli -v]
`NewStart High Available System. Version Cluster_4.0.3.06, release 20170930
    Copyright 2008–2017 Guangdong NewStart Technology Service Ltd.
You are using a trial license, and 82 days remain. Please register.
Product: Type = Mirror, SN = 65L948–q93dn1–32cr1m-10035A` 
制作key文件
通过商用SN制作key，双机上均需执行。 
 说明： 
该操作需要分别在主备机上执行，获得两个key文件。 
[root@ZTE_emsplus_2_01~]# 
 [/usr/lib64/newstartha/makekey]
`please enter the SN: 00TB24-FC0TCF-629A1H-B00D46  //此处输入现场使用的商用SN，主备双机使用同一个SN。
Make /etc/ha.d/lic/newstartha.key succeeded.` 
在主备机上生成key后，将主备机的/etc/ha.d/lic/newstartha.key文件分别重命名为newstartha001.key和newstartha002.key。
例如：在主机上执行： 
# 
 [cd /etc/ha.d/lic/]
# 
 [mv newstartha.key newstartha001.key]
在备机上执行： 
# 
 [cd /etc/ha.d/lic/]
# 
 [mv newstartha.key
newstartha002.key]
申请商用License文件
使用IE、谷歌或Firefox浏览器登录新支点公司官网（[http://www.gd-linux.com]），主窗口如[图1]所示。
图1  新支点公司官网
在主窗口的最下方，选择菜单技术帮助→在线注册
，如[图2]所示。
图2  在线注册
打开用户登录页面，如[图3]所示。
图3  用户登录页面
用户第一次登录，单击点击注册按钮，打开注册信息页面，如[图4]所示。
图4  注册信息页面
设置用户名、邮箱和手机号码，单击注册按钮。
 说明： 
系统会自动发送初始密码到设置的邮箱中，在对应邮箱中获取初始密码。 
单击注册信息页面的返回按钮，返回到用户登录页面。
初次登录时，使用邮箱中获取的初始密码登录，进入序列号管理页面，如[图5]所示。
登录后可进行密码修改操作。 
图5  序列号管理页面
在注册序列号区域框中的序列号文本框中，输入步骤[3]中的SN许可号，系统会自动显示相关信息，包括产品名称、产品版本和产品描述，如[图6]所示。
图6  注册序列号区域框
注册序列号区域框中，单击待受权文件1和待受权文件2的选择文件按钮，分别上传步骤[4]中获取到的2个key文件：newstartha001.key和newstartha002.key。
在申请者信息区域框中，根据实际情况进行设置，单击注册按钮。
系统会自动转到下载页面，根据提示信息下载License文件：newstartha001.lic和newstartha002.lic（License文件名称会根据系统主机名及其他信息自动生成）。
 说明： 
如果因为网络问题或其它原因未及时下载License文件，后续可以通过序列号管理→序列号列表
菜单，进入序列号列表页面，单击下载license，下载该账户之前注册的License文件。
部署商用License
将下载的License文件（newstartha001.lic、newstartha002.lic）分别上传至主备机的/etc/ha.d/lic/目录中。分别将newstartha001.lic和newstartha002.lic改名为newstartha.lic，将newstartha001.key和newstartha002.key改名为newstartha.key。
 小心！ 
每个节点的newstartha.lic文件不同，注意不要搞混，否则HA无法启动。
在命令终端下运行[cli]命令，检查License是否有效。
[root@ZTE_emsplus_2_01~]# 
 [cli]
如果License有效，则会输出类似如下提示：NewStart High Available System. Version Cluster_4.0.3.06, release 20170930
    Copyright 2008–2017 Guangdong NewStart Technology Service Ltd. Product SN = 
71DD97-W92EE7-55FA1H-D00B5C 
如果License无效，则会输出类似如下提示：NewStart High Available System. Version Cluster_4.0.3.06, release 20170930
    Copyright 2008–2017 Guangdong NewStart Technology Service Ltd.
License files(/etc/ha.d/lic/newstartha.key:/etc/ha.d/lic/newstartha.lic) invalid.
Can not find cluster configuration file.
Please run cluster-init to initialize Cluster Configuration.
Can not find services configuration file.
Please run service-init to initialize Services Configuration. 
### 配置NTP同步 
摘要 : 
NTP同步功能可以确保EMSPlus与网络中其他网元之间，以及MAN为主节点，DCU、MDS、DPU、MU、ASC、FTU为次节点之间时间同步。
步骤 : 
配置MAN节点作为NTP客户端，EMSPlus的MAN节点与上级时钟源的NTP同步。
配置MAN节点作为NTP服务端，EMSPlus的其他次节点与时钟源MAN节点的NTP同步。
在EMSPlus客户端的Terminal窗口，执行相关命令，配置NTP同步，详细操作参见NTP功能
。
### EMSPlus安装后的检查项 
#### 检查系统运行版本 
摘要 : 
检查EMSPlus系统运行的版本号与开局申请的版本号保持一致。
步骤 : 
在客户端PC的浏览器地址栏中输入https://<MAN节点EMS网络平面的双机浮动IP地址>:端口号/emsplus_<局号>/client，打开EMSPlus客户端的登录对话框，如[图1]所示。
其中：端口号=32000+局号 
图1  登录对话框
输入Username、Password，单击Login按钮，登录到EMSPlus客户端。
首次登录EMSPlus客户端会提示强制修改密码，如[图2]所示。
图2  强制修改密码对话框
选择菜单System→Version Management→Version Operation
，查看模块运行的版本号，如[图3]所示。
图3  查看模块版本号
选择菜单...→System Information
，在弹出的系统信息窗口，查看MAN节点的版本号，如[图4]所示。
图4  查看MAN节点版本号
#### 检查系统时间 
##### 检查操作系统的时间时区和夏令时 
摘要 : 
检查MAN节点操作系统的时间、时区、夏令时和当地情况相符。 
步骤 : 
登录MAN节点虚机，执行命令[date]和[timedatectl]，检查MAN节点操作系统的时间和时区，如[图1]所示。
图1  检查MAN节点的时间和时区
检查操作系统的夏令时和当地的夏令时情况相符，否则联系操作系统制作夏令时文件并更新。 
##### 检查GBASE节点的时间和时区 
摘要 : 
检查GBASE节点操作系统的时间和时区和当地情况相符。
步骤 : 
登录MAN节点虚机，执行命令[cat /ubas/clustershell/groups]，查看DPU节点的IP地址，如[图1]所示。
图1  查看DPU节点的IP地址
登录DPU节点，执行[date]，检查DPU虚机的系统时间；执行[vim /opt/gnode/config/gbase_8a_gbase.cnf]，检查DPU虚机的时区，如[图2]所示。
图2  检查DPU节点的时间和时区
检查/opt/gnode/config/gbase_8a_gbase.cnf文件的default-time-zone参数是否和当地情况一致，如[图3]所示。
图3  检查DPU节点的时区
检查/opt/gcluster/config/gbase_8a_gcluster.cnf文件的default-time-zone参数是否和当地情况一致，如[图4]所示。
图4  检查DPU节点的时区
### INPUTS参数说明 
#### INPUTS参数说明 
##### 公共配置 
参数名称|参数说明
---|---
云平台扩展类型|云平台的类型。可选参数，默认值，不需要配置。|云平台扩展类型
系统语言|虚机系统使用的语言，默认为en_US。|系统语言
虚机可用域|虚机使用的域，默认nova域，如果需要可以提前在VIM创建其他域。一般选择运维管理域。|虚机可用域
服务地址占用网口|业务IP（即浮动IP）是否生成一个网口。选择是，在VIM上能看到创建的一个虚机网口。双机使用浮动IP作为服务地址，主备切换时，用户不会感知该变化。使用默认值否。|服务地址占用网口
时区|系统时区。|时区
镜像名称|使用的镜像名称。|镜像名称
云盘命名规则|云盘命名规则支持对云盘名称进行自定义，它由非关键字和关键字组合而成。非关键字部分：定义云盘命名规则固定字符，仅能由大写英文字母、小写英文字母、中划线、下划线、数字5种字符组成。关键字部分：定义云盘命名规则可变字符，必须仅包含一组云盘类型和云盘实例号的组合，至多包含一组虚机类型和虚机实例号的组合。关键字定义如下：%VOL.T1：云盘类型字符大写，包括系统盘SYS、数据盘DATA、数据库盘DBSTORAGE和文件盘FILE。%VOL.t1：云盘类型字符小写，包括系统盘sys、数据盘data、数据库盘dbstorage和文件盘file。%VOL.S1：云盘实例号，按照同类型云盘的维度进行排序的实例号（）1,2,3,...9,10,11,...99,100,...），最低字符长度1。%VOL.S2：云盘实例号，按照同类型云盘的维度进行排序的实例号（01,02,03,...,99,100,...），最低字符长度2，缺位用0补齐。S3，S4依次类推，最多支持S9。%VM.T1：虚机类型字符大写，包括DPU、FTU、ASC、MDS、MAN和DCU。%VM.t1：虚机类型字符小写，包括dpu、ftu、asc、mds、man和dcu。%VM.S1：虚机实例号，同类型虚机的实例号(1,2,3,...9,10,11,...99,100)，最低字符长度1。%VM.S2：虚机实例号，同类型虚机的实例号(01,02,03,99,100,...)，最低字符长度2，缺位用0补齐。S3，S4依次类推，最多支持S9。云盘命名规则支持和虚机命名规则混合使用。当混合使用时，同类型云盘的云盘实例号按照同虚机名的维度进行排序。示例1：如果希望第100块数据库盘名称为：EMSplus_LOG_29_DBSTORAGE_100，则需要填写云盘命名规则为：EMSplus_LOG_29_%VOL.T1_%VOL.S1。示例2：如果希望DPU2的第4块数据库盘名称为： nfv-r-hdnjih-01a-zx-01-vol-dpu02dbstorage01，则需要填写云盘命名规则为：nfv-r-hdnjih-01a-zx-01-vol-%VM.t1%VM.S2%VOL.t1%VOL.S2。|云盘命名规则
数据盘|大小（GB）|数据盘占用的空间。
总读写IOPS|数据盘|在有存储QoS要求的场景下需要配置。
总读写速率（Byte/s）|数据盘|在有存储QoS要求的场景下需要配置。
硬盘类型|数据盘|表示数据盘的位置，可以选择为local或volume，建议使用volume。
云硬盘类型|数据盘|没有特殊要求不需要配置。可以指定多个云硬盘类型，多个云硬盘类型之间用逗号隔开。云硬盘类型需要提前在VIM平台创建。
云硬盘可用域|数据盘|仅在硬盘类型选择volume时生效。云硬盘使用的域，默认nova域，如果需要可以提前在VIM平台创建其他域。
是否格式化|数据盘|使用数据盘实例化扩容时，需要格式化该云盘，推荐开启。
数据库盘|大小（GB）|数据库盘占用的空间。
总读写IOPS|数据库盘|在有存储QoS要求的场景下需要配置。
总读写速率（Byte/s）|数据库盘|在有存储QoS要求的场景下需要配置。
硬盘类型|数据库盘|表示数据库盘的位置，支持local和volume。
云硬盘类型|数据库盘|没有特殊要求不需要配置。可以指定多个云硬盘类型，多个云硬盘类型之间用逗号隔开。云硬盘类型需要提前在VIM平台创建。
云硬盘可用域|数据库盘|仅在硬盘类型选择volume时生效。云硬盘使用的域，默认nova域，如果需要可以提前在VIM平台创建其他域。
每虚机数据库盘数量|数据库盘|单个DPU节点数据库盘的数量，可根据DPU节点规划计算数据库盘的数量。
是否格式化|数据库盘|使用数据库盘实例化扩容时，需要格式化该云盘，推荐开启。
文件盘|大小（GB）|文件盘占用的空间。
总读写IOPS|文件盘|在有存储QoS要求的场景下需要配置。
总读写速率（Byte/s）|文件盘|在有存储QoS要求的场景下需要配置。
硬盘类型|文件盘|表示文件盘的位置，支持local和volume。
云硬盘类型|文件盘|没有特殊要求不需要配置。可以指定多个云硬盘类型，多个云硬盘类型之间用逗号隔开。云硬盘类型需要提前在VIM平台创建。
云硬盘可用域|文件盘|仅在硬盘类型选择volume时生效。云硬盘使用的域，默认nova域，如果需要可以提前在VIM平台创建其他域。
每虚机文件盘数量|文件盘|单个FTU节点文件盘的数量，可根据FTU节点规划计算文件盘的数量。
是否格式化|文件盘|使用文件盘实例化扩容时，需要格式化该云盘，推荐开启。
亲和互斥组|DCU亲和互斥组|亲和：虚机分配在相同的主机上。反亲和：虚机分配在不同的主机上。软亲和：如果物理资源条件许可，虚机分配在相同的主机上。软反亲和：如果物理资源条件许可，虚机分配在不同的主机上。ha-soft-anti-affinity：如果物理资源条件许可，虚机分配在不同的HA上（在配置此功能前，需要在虚拟化环境中手动设置主机归属的HA，以及HA归属的AZ）。
DPU亲和互斥组|亲和互斥组|亲和：虚机分配在相同的主机上。反亲和：虚机分配在不同的主机上。软亲和：如果物理资源条件许可，虚机分配在相同的主机上。软反亲和：如果物理资源条件许可，虚机分配在不同的主机上。ha-soft-anti-affinity：如果物理资源条件许可，虚机分配在不同的HA上（在配置此功能前，需要在虚拟化环境中手动设置主机归属的HA，以及HA归属的AZ）。
MAN亲和互斥组|亲和互斥组|亲和：虚机分配在相同的主机上。反亲和：虚机分配在不同的主机上。软亲和：如果物理资源条件许可，虚机分配在相同的主机上。软反亲和：如果物理资源条件许可，虚机分配在不同的主机上。ha-soft-anti-affinity：如果物理资源条件许可，虚机分配在不同的HA上（在配置此功能前，需要在虚拟化环境中手动设置主机归属的HA，以及HA归属的AZ）。
MDS亲和互斥组|亲和互斥组|亲和：虚机分配在相同的主机上。反亲和：虚机分配在不同的主机上。软亲和：如果物理资源条件许可，虚机分配在相同的主机上。软反亲和：如果物理资源条件许可，虚机分配在不同的主机上。ha-soft-anti-affinity：如果物理资源条件许可，虚机分配在不同的HA上（在配置此功能前，需要在虚拟化环境中手动设置主机归属的HA，以及HA归属的AZ）。
ASC亲和互斥组|亲和互斥组|亲和：虚机分配在相同的主机上。反亲和：虚机分配在不同的主机上。软亲和：如果物理资源条件许可，虚机分配在相同的主机上。软反亲和：如果物理资源条件许可，虚机分配在不同的主机上。ha-soft-anti-affinity：如果物理资源条件许可，虚机分配在不同的HA上（在配置此功能前，需要在虚拟化环境中手动设置主机归属的HA，以及HA归属的AZ）。
FTU亲和互斥组|亲和互斥组|亲和：虚机分配在相同的主机上。反亲和：虚机分配在不同的主机上。软亲和：如果物理资源条件许可，虚机分配在相同的主机上。软反亲和：如果物理资源条件许可，虚机分配在不同的主机上。ha-soft-anti-affinity：如果物理资源条件许可，虚机分配在不同的HA上（在配置此功能前，需要在虚拟化环境中手动设置主机归属的HA，以及HA归属的AZ）。
亲和互斥组命名规则|亲和互斥组|亲和互斥组命名规则支持对亲和互斥组名称自定义，它由非关键字和关键字组合而成：非关键字部分：定义亲和互斥组命名规则固定字符，仅能由大写英文字母、小写英文字母、中划线、下划线、数字 5种字符组成。关键字部分：定义亲和互斥组命名规则可变字符，必须仅包含1组亲和互斥组类型的关键字。关键字定义如下：%VMG.T1：亲和互斥组类型字符大写，包括：DPU、FTU、MAN、ASC、MDS和DCU。%VMG.t1：亲和互斥组类型字符小写，包括：dpu、ftu、man、asc、mds和dcu。示例：如果希望FTU亲和互斥组名称为：NFV-R-HDNJIH-01A-ZX-01-VMG-FTU，则需要填写亲和互斥组命名规则为：NFV-R-HDNJIH-01A-ZX-01-VMG-%VMG.T1。
##### 网元配置 
参数名称|参数说明
---|---
网元类型|网元所在局点类型：EMSPlus（Reporting）局点选择EMSplus_RPT。EMSPlus（Logging）局点选择EMSplus_LOG。RCP（即PCRF）开局选择EMSplus_RCP。
网元ID|网元的标识，取值范围：1~255之间的整数。建议从240开始。
网元别名|可不填写。
网元节点号|全局网元的ID号，需要事先做好全网规划。取值范围：100000~999999之间的整数。建议使用资源池所在的区号+网元ID，例如532240。
传输协议类型|保持为默认值。传输协议类型包括FTP和SFTP。
网元位置|网元所在的位置，可不填写。
网元物理位置|网元的地理信息，可不填写。
制造商|网元的制造商信息，默认ZTE。
个人保护数据|在需要实施欧盟GDPR条例的局点启用。启用后，一些涉及用户的敏感信息会被保护。
主机前缀名|虚机前缀名。在TECS上可查看每个虚机的名称，该选项会在虚机名前添加一个前缀名。主机前缀名和主机命名规则不可同时配置。如果一个虚机同时配置了主机前缀名，则最终的名称为：主机前缀名.主机名。例如：主机名前缀为AAAA，那么实例化后虚机名称为AAAA_{网元类型}_{局号}_{虚机类型}-{虚机序号}网元类型：RPT、LOG、RCP局号：网元ID虚机类型：MAN、MDS、DCU、DPU_C虚机序号：1
主机命名规则|主机命名规则支持对主机名称自定义，它由非关键字和关键字组合而成。非关键字部分：定义主机命名规则固定字符，仅能由大写英文字母、小写英文字母、中划线、下划线、数字 5种字符组成。关键字部分：定义亲主机命名规则可变字符，必须仅包含1组虚机类型和虚机实例号的关键字。主机前缀名和主机命名规则不可同时配置。关键字定义如下：%VM.T1 虚机类型字符大写，包括DPU、FTU、ASC、MDS、MAN和DCU。%VM.t1 虚机类型字符小写，包括dpu、ftu、asc、mds、man和dcu。%VM.S1 虚机实例号，同类型虚机的实例号（1,2,3,...9,10,11,...99,100,...），最低字符长度1。%VM.S2 虚机实例号，同类型虚机的实例号（01,02,03,...,99,100,...），最低字符长度2，缺位用0补齐。S3，S4依次类推，最多支持S9。示例1：如果希望FTU备机名称为：NFV-R-HDNJIH-01A-ZX-01-FTU02，则需要填写主机命名规则为：NFV-R-HDNJIH-01A-ZX-01-%VM.T1%VM.S2。示例2：如果希望FTU备机名称为：NFV-R-HDNJIH-01A-ZX-01_FTU-2，则需要填写主机命名规则为：NFV-R-HDNJIH-01A-ZX-01_%VM.T1-%VM.S1。
##### 虚机配置 
参数名称|参数说明
---|---
规格模型|支持S、M、T规格模型，参见“虚机资源”。|规格模型|规格模型
虚机个数|MDS|各节点虚机的个数。FTU是主备模式时，FTU虚机个数为所填值的2倍，1个FTU代表一台主机一台备机。|MDS
DPU|虚机个数|DPU|各节点虚机的个数。FTU是主备模式时，FTU虚机个数为所填值的2倍，1个FTU代表一台主机一台备机。
ASC|虚机个数|ASC|各节点虚机的个数。FTU是主备模式时，FTU虚机个数为所填值的2倍，1个FTU代表一台主机一台备机。
DCU_LOG|虚机个数|DCU_LOG|各节点虚机的个数。FTU是主备模式时，FTU虚机个数为所填值的2倍，1个FTU代表一台主机一台备机。
DCU_RPT|虚机个数|DCU_RPT|各节点虚机的个数。FTU是主备模式时，FTU虚机个数为所填值的2倍，1个FTU代表一台主机一台备机。
FTU|虚机个数|FTU|各节点虚机的个数。FTU是主备模式时，FTU虚机个数为所填值的2倍，1个FTU代表一台主机一台备机。
MAN节点配置|是否双机|MAN节点是否是HA双机。双机选择ha。单机选择single。|是否双机
HA key|MAN节点配置|HA key|填写HA双机的key文件（newstartha.key）内容。
HA License|MAN节点配置|HA License|填写HA双机的License文件（newstartha.lic）内容。
MU节点配置|是否启用|本段配置总开关。部署Logging局时选择YES，以下配置参数生效。部署Reporting局时选择NO，以下配置参数不生效。|是否启用
分发模式|MU节点配置|分发模式|MU通过MDS分发，或者MU直连，目前一般都是MDS。
合并模式|MU节点配置|合并模式|收到的不同网元消息合并方式，包括不关联、Radius模式、XGW Chr模式。只在Logging局点才配置该参数。
日志留存模式|MU节点配置|日志留存模式|对收到的日志进行存储配置，只保留配置的日志数据。包括：CGNat会话创建日志CGNat会话释放日志FW会话释放日志FW安全日志FW系统日志FW会话创建日志A10FW会话创建日志A10FW会话释放日志IPDR日志
CGNAT查询模式|MU节点配置|CGNAT查询模式|CGNAT数据查询是否使用IPDR数据库，即从IPDR数据库中查询CGNAT的数据。
Firewall查询模式|MU节点配置|Firewall查询模式|Firewall数据查询是否使用IPDR数据库。
NAT模式|MU节点配置|NAT模式|NAT模式决定IPDR用哪种KEY进行NAT和CHR合并。端口无关映射（EIM）：NAT映射的KEY是源IP+源PORT+协议。地址相关映射（ADM）：NAT映射的KEY是源IP+源PORT+目的IP+协议。地址和端口相关映射（APDM）：NAT映射的KEY是源IP+源PORT+目的IP+目的PORT+协议。
监听端口|MU节点配置|监听端口|MU监听MDS发送消息的端口。
主机集合配置|SRIOV|网卡的一个属性，表示是否支持快速转发。云上有很多物理主机，有的物理主机上支持该属性。如果配置了该参数，则VNF实例化时就将虚机部署到支持SRIOV属性的物理主机上。可通过查看可用域中主机集合的元数据，确定SRIOV是否启用。|SRIOV
MAN节点配置|主机集合配置|自定义KEY/VALUE|自定义参数，MANO使用。虚机部署在指定物理集群时，需要配置主机集合的自定义KEY/VALUE、Server Zone、类型。严格按照主机集合中的元数据进行配置。
Server Zone|MAN节点配置|主机集合配置|服务器域名称，注意不是可用域。
类型|MAN节点配置|主机集合配置|服务器域类型。严格按照主机集合中的元数据进行配置。
DCU节点配置|主机集合配置|自定义KEY/VALUE|自定义参数，MANO使用。严格按照主机集合中的元数据进行配置。
Server Zone|DCU节点配置|主机集合配置|服务器域名称，注意不是可用域。
类型|DCU节点配置|主机集合配置|服务器域类型。严格按照主机集合中的元数据进行配置。
DPU节点配置|主机集合配置|自定义KEY/VALUE|自定义参数，MANO使用。严格按照主机集合中的元数据进行配置。
Server Zone|DPU节点配置|主机集合配置|服务器域名称，注意不是可用域。
类型|DPU节点配置|主机集合配置|服务器域类型。严格按照主机集合中的元数据进行配置。
MDS节点配置|主机集合配置|自定义KEY/VALUE|自定义参数，MANO使用。严格按照主机集合中的元数据进行配置。
Server Zone|MDS节点配置|主机集合配置|服务器域名称，注意不是可用域。
类型|MDS节点配置|主机集合配置|服务器域类型。严格按照主机集合中的元数据进行配置。
ASC节点配置|主机集合配置|自定义KEY/VALUE|自定义参数，MANO使用。严格按照主机集合中的元数据进行配置。
Server Zone|ASC节点配置|主机集合配置|服务器域名称，注意不是可用域。
类型|ASC节点配置|主机集合配置|服务器域类型。严格按照主机集合中的元数据进行配置。
FTU节点配置|主机集合配置|自定义KEY/VALUE|自定义参数，MANO使用。严格按照主机集合中的元数据进行配置。
Server Zone|FTU节点配置|主机集合配置|服务器域名称，注意不是可用域。
类型|FTU节点配置|主机集合配置|服务器域类型。严格按照主机集合中的元数据进行配置。
DPU配置|配置库名称|default：不使用分库。配置信息与数据信息都存储在一个数据库（数据库名为emsplus）中。auto：使用分库。配置信息存储在配置信息库（CM数据库）中，数据库名由系统自动生成，名称格式为emsplus_cm_网元ID；数据信息存储在数据信息库（DATA数据库）中，数据库名为emsplus。|配置库名称
Flavor配置|Flavor命名规则|Flavor命名规则支持对虚机规格名称自定义，它由非关键字和关键字组合而成。非关键字部分：定义Flavor命名规则固定字符，仅能由大写英文字母、小写英文字母、中划线、下划线、数字 5种字符组成。关键字部分：定义Flavor命名规则可变字符，必须仅包含一类Flavor类型和至多一个Flavor类型实例号。关键字定义如下：%FLA.T1：Flavor类型字符大写，例如：C4M80D40E50S0表示CPU4核+内存8G+根磁盘40G+临时盘50G+SWAP盘0G。%FLA.t1：Flavor类型字符小写，例如：c4m80d40e50s0表示CPU4核+内存8G+根磁盘40G+临时盘50G+SWAP盘0G。%FLA.S1：Flavor类型实例号，CPU+内存+根磁盘+临时盘+SWAP盘相同，但extra参数不同，同类型Flavor的实例号（1,2,3,...9,10,11,...99,100,...）， 最低字符长度1。%FLA.S2：Flavor类型实例号，同类型Flavor的实例号（01,02,03,...,99,100,...），最低字符长度2，缺位用0补齐。S3，S4依次类推，最多支持S9。%FLA.T2：Flavor类型，包括DPU、FTU、MAN、ASC、MDS和DCU。%FLA.t2：Flavor类型，包括dpu、ftu、man、asc、mds和dcu。示例1：如果希望虚机Flavor为：NFV-R-HDNJIH-01A-ZX-01-FLA-C4R80D40E50S0001，则需要填写 Flavor命名规则为：NFV-R-HDNJIH-01A-ZX-01-FLA-%FLA.T1%FLA.S3。示例2：如果希望DPU虚机Flavor为：NFV-R-HDNJIH-01A-ZX-01-FLA-DPU，则需要填写 Flavor命名规则为：NFV-R-HDNJIH-01A-ZX-01-FLA-%FLA.T2。|Flavor命名规则
MAN节点Flavor|Flavor配置|MAN节点Flavor|各节点的虚机规格的名字，该参数可选，用于mano用户在TESC为非admin权限时使用（参见“添加项目”）。需要开局人员提前规划，在VIM上配置对应的虚机规格。在TECS上添加虚机规格的设置参见“添加虚机规格（可选）”，在RedHat上创建虚机规格的设置参见“创建虚机规格（可选）”。
MDS节点Flavor|Flavor配置|MDS节点Flavor|各节点的虚机规格的名字，该参数可选，用于mano用户在TESC为非admin权限时使用（参见“添加项目”）。需要开局人员提前规划，在VIM上配置对应的虚机规格。在TECS上添加虚机规格的设置参见“添加虚机规格（可选）”，在RedHat上创建虚机规格的设置参见“创建虚机规格（可选）”。
ASC节点Flavor|Flavor配置|ASC节点Flavor|各节点的虚机规格的名字，该参数可选，用于mano用户在TESC为非admin权限时使用（参见“添加项目”）。需要开局人员提前规划，在VIM上配置对应的虚机规格。在TECS上添加虚机规格的设置参见“添加虚机规格（可选）”，在RedHat上创建虚机规格的设置参见“创建虚机规格（可选）”。
FTU节点Flavor|Flavor配置|FTU节点Flavor|各节点的虚机规格的名字，该参数可选，用于mano用户在TESC为非admin权限时使用（参见“添加项目”）。需要开局人员提前规划，在VIM上配置对应的虚机规格。在TECS上添加虚机规格的设置参见“添加虚机规格（可选）”，在RedHat上创建虚机规格的设置参见“创建虚机规格（可选）”。
DPU节点Flavor|Flavor配置|DPU节点Flavor|各节点的虚机规格的名字，该参数可选，用于mano用户在TESC为非admin权限时使用（参见“添加项目”）。需要开局人员提前规划，在VIM上配置对应的虚机规格。在TECS上添加虚机规格的设置参见“添加虚机规格（可选）”，在RedHat上创建虚机规格的设置参见“创建虚机规格（可选）”。
DCU节点Flavor|Flavor配置|DCU节点Flavor|各节点的虚机规格的名字，该参数可选，用于mano用户在TESC为非admin权限时使用（参见“添加项目”）。需要开局人员提前规划，在VIM上配置对应的虚机规格。在TECS上添加虚机规格的设置参见“添加虚机规格（可选）”，在RedHat上创建虚机规格的设置参见“创建虚机规格（可选）”。
##### 网络配置 
参数名称|参数说明
---|---
网络平面类型|根据底层平台选择vlan或者vxlan。如果选择auto，则自检底层网络，选择网络平面类型。|网络平面类型
内部网口开启安全组|EMSPlus内部的控制网络平面和媒体网络平面是否开启安全组。开启：内部网口开启安全组。关闭：内部网口关闭安全组。不设置：内部网口不设置安全组，vnfd_model.json中不填对应的json串。与TECS上安全组设置保持一致，默认关闭。|内部网口开启安全组
外部网口开启安全组|EMSPlus外部的网络平面是否开启安全组。开启：内部网口开启安全组。关闭：内部网口关闭安全组。不设置：内部网口不设置安全组，vnfd_model.json中不填对应的json串。与TECS上安全组设置保持一致，默认关闭。|外部网口开启安全组
安全组|配置安全组的名称。安全组是指一组网络平面或是网口，在这个组内互相之间是可以互通的，不在安全组内就不能互通。|安全组
端口命名规则|端口命名规则支持对端口名称自定义，它由非关键字和关键字组合而成：非关键字部分：定义端口命名规则固定字符，仅能由大写英文字母、小写英文字母、中划线、下划线、数字 5种字符组成。关键字部分：定义端口命名规则可变字符，只能是以下2种组合其中之一。第一种：一组虚机类型+虚机实例号+一个端口类型。第二种：一组端口类型+端口实例号。关键字定义如下：%VPRT.T1：端口类型字符大写，包括EMS、CTRL、MEDIA、NORTHOUTPUT、GI、FWNET、SIG、MANRES、HEART1、HEART2和FTU。%VPRT.t1：端口类型字符小写，包括ems、ctrl、media、northoutput、gi、fwnet、sig、manres、heart1、heart2和ftu。%VPRT.S1：端口实例号，按照同类型端口的维度进行排序的实例号（1,2,3,...9,10,11,...99,100）， 最低字符长度1。%VPRT.S2：端口实例号,按照同类型端口的维度进行排序的实例号（01,02,03,...,99,100），最低字符长度2，缺位用0补齐。S3，S4依次类推，最多支持S9。可以和VM命名规则混合使用，当混合使用时不需要填写端口实例号。示例1：如果希望端口名为：NFV-R-HDNJIH-01A-ZX-01-VPRT-MDS01-FWNET，则需要填写端口命名规则为：NFV-R-HDNJIH-01A-ZX-01-VPRT-%VM.T1%VM.S2-%VPRT.T1。示例2：如果希望端口名为：cp_emsplus_28_3_fwnet，则需要填写端口命名规则为：cp_emsplus_28_%VPRT.S1_%VPRT.t1。|端口命名规则
EMS网络平面配置|名称|EMS网络平面及其子网由开局人员规划，例如ZTE_EMS_NET和ZTE_EMS_SUBNET，EMSPlus与MANO等其他网元共用该网络平面，在VIM上已创建该网络平面。
子网名称|EMS网络平面配置|EMS网络平面及其子网由开局人员规划，例如ZTE_EMS_NET和ZTE_EMS_SUBNET，EMSPlus与MANO等其他网元共用该网络平面，在VIM上已创建该网络平面。
浮动IP|EMS网络平面配置|MAN节点的IP地址及网关地址（接口地址）。使用浮动IP/主机IP地址登录到EMSPlus客户端。
主机IP|EMS网络平面配置|MAN节点的IP地址及网关地址（接口地址）。使用浮动IP/主机IP地址登录到EMSPlus客户端。
备机IP|EMS网络平面配置|MAN节点的IP地址及网关地址（接口地址）。使用浮动IP/主机IP地址登录到EMSPlus客户端。
MASK/CIDR|EMS网络平面配置|MAN节点的IP地址及网关地址（接口地址）。使用浮动IP/主机IP地址登录到EMSPlus客户端。
网关|EMS网络平面配置|MAN节点的IP地址及网关地址（接口地址）。使用浮动IP/主机IP地址登录到EMSPlus客户端。
GI网络平面配置|是否启用|选择是否启用该网络平面：YES：MDS节点对接xGW网元时启用此平面，需提前在VIM上创建EMSPlus_VNF_GI_NET平面。NO：不使用该网络平面，后续的IP地址等设置无效。
名称|GI网络平面配置|GI网络平面及其子网名称。
子网名称|GI网络平面配置|GI网络平面及其子网名称。
MASK/CIDR|GI网络平面配置|该平面CIDR地址（255.255.255.0）。
MDS GI IP列表|GI网络平面配置|接口地址，有几个MDS节点就需要填写几个IP地址，多个IP用逗号隔开。
FTU主机GI IP列表|GI网络平面配置|接口地址，用于配置FTU节点的GI面的IP地址，有几个FTU节点就需要填写几个IP地址，多个IP用逗号隔开。
FTU备机GI IP列表|GI网络平面配置|接口地址，用于配置FTU节点的GI面的IP地址，有几个FTU节点就需要填写几个IP地址，多个IP用逗号隔开。
FTU浮动GI IP列表|GI网络平面配置|接口地址，用于配置FTU节点的GI面的IP地址，有几个FTU节点就需要填写几个IP地址，多个IP用逗号隔开。
Firewall网络平面配置|是否启用|选择是否启用该网络平面：YES：MDS节点对接FIREWALL/CGNAT网元时启用此平面，需提前在VIM创建EMSPlus_VNF_FWNAT_NET平面。NO：不使用该网络平面，后续的IP地址等设置无效。
名称|Firewall网络平面配置|Firewall网络平面及其子网名称。
子网名称|Firewall网络平面配置|Firewall网络平面及其子网名称。
MASK/CIDR|Firewall网络平面配置|该平面CIDR地址（255.255.255.0）
Firewall IP列表|Firewall网络平面配置|接口地址，有几个MDS节点就需要填写几个IP地址，多个IP用逗号隔开。
SIG网络平面|是否启用|选择是否启用该网络平面：YES：MDS节点对接PCRF网元时启用此平面，需提前在VIM创建EMSPlus_VNF_SIG_NET平面。（对接5GC网元）NO：不使用该网络平面，后续的IP地址等设置无效。
名称|SIG网络平面|BOSS网络平面及其子网名称。
子网名称|SIG网络平面|BOSS网络平面及其子网名称。
MASK/CIDR|SIG网络平面|该平面CIDR地址（255.255.255.0）
BOSS IP列表|SIG网络平面|接口地址，有几个MDS节点就需要填写几个IP地址，多个IP用逗号隔开。
北向网络平面配置|是否启用|选择是否启用该网络平面：YES：有北向数据传输需求时，需要启用该网络平面。NO：不使用该网络平面，后续的IP地址等设置无效。
名称|北向网络平面配置|开局人员规划。
子网名称|北向网络平面配置|开局人员规划。
MASK/CIDR|北向网络平面配置|开局人员规划。
北向输出IP列表|北向网络平面配置|北向数据传输到的所有IP地址，多个IP用逗号隔开。
与POP-D交互网络平面|是否启用|部署RCP的情况启用该网络平面。
名称|与POP-D交互网络平面|开局人员规划。
浮动IP|与POP-D交互网络平面|开局人员规划。
网络子网名称|与POP-D交互网络平面|开局人员规划。
主机IP|与POP-D交互网络平面|开局人员规划。
备机IP|与POP-D交互网络平面|开局人员规划。
MASK/CIDR|与POP-D交互网络平面|开局人员规划。
内部控制面网络配置|已创建网络|选择是否使用已创建的网络平面。YES：直接使用VIM上已预定义好的网络平面。需要确认后续的网络平面名称与VIM上预定义的网络平面名称一致。NO：在EMSPlus实例化时由系统自动创建该网络平面。
名称|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
子网名称|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
MASK/CIDR|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
MAN浮动IP|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
MAN主机IP|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
MAN备机IP|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
MAN SNMP IP|内部控制面网络配置|开局人员规划。MAN SNMP IP为双机环境下，供HA使用的IP地址。实例化后系统自动分配该地址。
ASC IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
DCU_LOG IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
DCU_RPT IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
DPU IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
MDS IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
FTU浮动IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
FTU主机IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
FTU备机IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
FTU SNMP IP列表|内部控制面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。FTU SNMP IP列表为双机环境下，供HA使用的IP地址。
内部媒体面网络配置|已创建网络|选择是否使用已创建的网络平面。YES：直接使用VIM上已预定义好的网络平面。需要确认后续的网络平面名称与VIM上预定义的网络平面名称一致。NO：在EMSPlus实例化时由系统自动创建该网络平面。
名称|内部媒体面网络配置|开局人员规划。
子网名称|内部媒体面网络配置|开局人员规划。
MASK/CIDR|内部媒体面网络配置|开局人员规划。
MAN浮动IP|内部媒体面网络配置|开局人员规划。
MAN主机IP|内部媒体面网络配置|开局人员规划。
MAN备机IP|内部媒体面网络配置|开局人员规划。
ASC IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
DCU_LOG IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
DCU_RPT IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
DPU IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
MDS IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
FTU浮动IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
FTU主机IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
FTU备机IP列表|内部媒体面网络配置|各节点的IP地址，与虚机的个数相同，多个IP用逗号隔开。
HA心跳网络平面1|已创建网络|选择是否使用已创建的网络平面。YES：直接使用VIM上已预定义好的网络平面。需要确认后续的网络平面名称与VIM上预定义的网络平面名称一致。NO：在EMSPlus实例化时由系统自动创建该网络平面。
名称|HA心跳网络平面1|开局人员规划。
子网名称|HA心跳网络平面1|开局人员规划。
MASK/CIDR|HA心跳网络平面1|开局人员规划。
MAN主机的IP|HA心跳网络平面1|开局人员规划。
MAN备机的IP|HA心跳网络平面1|开局人员规划。
FTU主机IP列表|HA心跳网络平面1|开局人员规划。
FTU备机IP列表|HA心跳网络平面1|开局人员规划。
HA心跳网络平面2|已创建网络|选择是否使用已创建的网络平面。YES：直接使用VIM上已预定义好的网络平面。需要确认后续的网络平面名称与VIM上预定义的网络平面名称一致。NO：在EMSPlus实例化时由系统自动创建该网络平面。
名称|HA心跳网络平面2|开局人员规划。
子网名称|HA心跳网络平面2|开局人员规划。
MASK/CIDR|HA心跳网络平面2|开局人员规划。
MAN主机的IP|HA心跳网络平面2|开局人员规划。
MAN备机的IP|HA心跳网络平面2|开局人员规划。
FTU主机IP列表|HA心跳网络平面2|开局人员规划。
FTU备机IP列表|HA心跳网络平面2|开局人员规划。
FTU网络平面|是否启用|选择是否启用该网络平面：YES：启用该网络平面。NO：不使用该网络平面，后续的IP地址等设置无效。
名称|FTU网络平面|开局人员规划。
子网名称|FTU网络平面|开局人员规划。
MASK/CIDR|FTU网络平面|开局人员规划。
网关|FTU网络平面|开局人员规划。
FTU浮动IP列表|FTU网络平面|开局人员规划。
FTU主机IP列表|FTU网络平面|开局人员规划。
FTU备机IP列表|FTU网络平面|开局人员规划。
##### 高级配置 
参数名称|参数说明
---|---
看门狗|是否启用|保持为默认值否，与资源池内其他网元虚机配置保持一致。启用看门狗功能，如果虚拟内核异常导致无法喂狗，心跳时间超时时，则虚机自动重启；其他情况下，虚机均不会重启。
超时时间（分钟）|看门狗|保持为默认值7分钟。
心跳检测周期（秒）|看门狗|保持为默认值180秒。
喂狗周期（秒）|看门狗|保持为默认值30秒。
NUMA|是否绑核|需要绑核，绑核是将虚拟CPU落在具体的物理CPU上。
绑核策略|NUMA|保持为默认值dedicated。
CPU规格|NUMA|物理CPU规格，可以不配置。
NUMA节点数|NUMA|保持为默认值1个。
巨页大小|NUMA|保持为默认值large。
VNFM Token|Token|与VNFM交互的令牌。一般是关闭的，是否开启取决于运营商需求。
Token用户|VNFM Token|与VNFM交互的令牌。一般是关闭的，是否开启取决于运营商需求。
Token密码|VNFM Token|与VNFM交互的令牌。一般是关闭的，是否开启取决于运营商需求。
数据库|数据加密|是否启用数据库加密：关闭：（默认值）关闭数据库加密。开启：开启数据库加密。
#### 5GC局点INPUTS参数示例 
##### 公共配置 
图1  公共配置
图2  数据盘配置
图3  数据库盘配置
图4  文件盘配置
图5  亲和互斥组配置
##### 网元配置 
图6  网元配置
##### 虚机配置 
图7  规格模型配置
图8  虚机个数配置
图9  虚机节点配置
图10  主机集合配置
图11  Flavor配置
##### 网络配置 
图12  网络配置
图13  EMS网络平面配置
图14  GI网络平面配置
图15  BOSS网络平面配置
图16  北向网络平面配置
图17  Firewall网络平面配置
图18  FTU网络平面配置
图19  与POP-D交互网络平面配置
图20  内部控制面网络配置
图21  内部媒体面网络配置
图22  HA心跳网络平面1配置
图23  HA心跳网络平面2配置
##### 高级配置 
图24  高级配置
## 缩略语 
## 缩略语 
AMF : 
Access and Mobility Management Function接入和移动管理功能
### AZ 
Availability Zone可用性区域
### BOSS 
Business and Operation Support System运营和运维支撑系统
### CGNAT 
Carrier Grade Network Address Translation运营商级网络地址转换
CHR : 
Call History Record呼叫历史记录
### CIDR 
Classless Inter-Domain Routing无类别域间路由
### CM 
Configuration Management配置管理
### CPU 
Central Processing Unit中央处理器
DCU : 
Data Collection Unit数据采集单元
### DHCP 
Dynamic Host Configuration Protocol动态主机配置协议
DNS : 
Domain Name System域名系统
DPU : 
Data Processing Unit数据处理单元
EMS : 
Element Management System网元管理系统
FTP : 
File Transfer Protocol文件传输协议
### GDPR 
General Data Protection Regulation通用数据保护条例
### GSO 
Global Service Orchestrator全局业务编排器
### GW 
GateWay网关
### HA 
High Availability高可用性
### HLD 
High Level Design高层次设计
HTTP : 
Hypertext Transfer Protocol超文本传输协议
### IE 
Internet Explorer因特网浏览器
IP : 
Internet Protocol因特网协议
### IPDR 
Internet Protocol Detail Record互联网协议详细记录
### LLD 
Low Level Design详细设计
MAN : 
Manager Node管理节点
MANO : 
Management and Orchestration管理和编排
MDS : 
Message Dispatch Service消息分发服务
MU : 
Merging Unit合并单元
NFV : 
Network Functions Virtualization网络功能虚拟化
NFVO : 
Network Functions Virtualization Orchestrator网络功能虚拟化编排器
### NTP 
Network Time Protocol网络时间协议
### NUMA 
Non-Uniform Memory Access Architecture非统一内存访问架构
### PC 
Personal Computer个人电脑
PCRF : 
Policy and Charging Rules Function策略和计费规则功能
QoS : 
Quality of Service服务质量
### RAID 
Redundant Array of Independent Disks独立冗余磁盘阵列
RCP : 
Resource Control Platform资源控制平台
SFTP : 
Secure File Transfer Protocol安全文件传输协议
SMF : 
Session Management Function会话管理功能
### SN 
Serial Number序列号
### SSH 
Secure Shell安全外壳
### SSL 
Secure Sockets Layer安全套接字层
TCP : 
Transmission Control Protocol传输控制协议
### TECS 
Tulip Elastic Cloud System郁金香弹性云系统
### TOSCA 
Topology and Orchestration Specification for Cloud
Applications云应用的拓扑和编排规范
UPF : 
User Plane Function用户平面功能
### URL 
Uniform Resource Locator统一资源定位符
VIM : 
Virtualized Infrastructure Manager虚拟化基础设施管理系统
### VLAN 
Virtual Local Area Network虚拟局域网
VM : 
Virtual Machine虚拟机
VNF : 
Virtualized Network Function虚拟化网络功能
### VNFD 
Virtualized Network Function Descriptor虚拟化网络功能描述符
VNFM : 
Virtualized Network Function Manager虚拟化网络功能管理器
### VRRP 
Virtual Router Redundancy Protocol虚拟路由器冗余协议
### xGW 
Extendable Gateway综合接入网关
## 网元对接配置 
### 网元对接配置说明 
EMSPlus的网络平面分为内部网络平面和与网元交互的网络平面，网络平面以及地址规划参见“软件安装
”
。
EMSPlus可以对接多个网元，在建链时EMSPlus不单独对xGW进行端口检测，只进行地址检测。 
网元侧xGW链路状态显示，只是说明EMSPlus侧主机工作状态是否正常，是否可以用于接收数据上报。 
在网元对接配置时，在MDS节点配置的外部网元IP和Port需同发送端一致。若网元侧配置的客户端端口和EMSPlus侧配置的网元端口不匹配，但服务端地址和端口都正确，此时链路状态显示正常，xGW进行数据上报，但在MDS节点会将数据丢弃。 
### 导入维度表 
导入运营商或者ZTE提供的维度表文件，详细说明和操作参见“维度导入导出功能
”
。
### EMSPlus（CHR）局点 
EMSPlus（CHR）提供5GC网元故障日志分析。
#### 配置FTU节点（可选） 
FTU节点使用FTP文件接口接收网元日志数据，数据文件经过处理后通过消息接口转发给MDS节点。 
FTU节点的详细配置参见“[配置FTU参数]”。
#### 配置MDS节点的外部网元 
摘要 : 
MDS节点的数据源主要来自于外部接入的5GC网元（例如SMF、AMF、UPF）。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTERNALNE]命令，配置MDS节点的外部接入网元，如[图1]所示。
图1  ADD MDSEXTERNALNE命令
参数名称|参数说明
---|---
IP|外接网元对接EMSPlus的业务地址。外接网元与EMSPLus（CHR）局对接，上报业务数据。当MDS节点接收FTU的数据源时，配置为FTU使用的承载消息的网络平面的地址，通常为FTU在GI面的地址。
Start Port|外接网元向EMSPLus（CHR）局发送信息的起始端口。接入IP为FTU节点的地址时，填写为1。
End Port|外接网元向EMSPLus（CHR）局发送信息的结束端口。如果仅需要配置一个端口，则Start Port和End Port配置一致。接入IP为FTU节点的地址时，填写为65535。
NE Type|MDS节点接入的网元类型。例如：MDS节点接收SMF数据源，选择SMF  (SMF)。MDS节点接收FTU的数据源时，选择FTU处理的相应网元类型。
 说明： 
在各网元IP地址不重复的情况下，配置Start Port为1、End Port为65535。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTERNALNE]:IP=<外接网元对接EMSPlus的业务地址>,STARTPORT=<外接网元发送信息的起始端口>,ENDPORT=<外接网元发送信息的结束端口>,NETYPE=<MDS节点接入的网元类型>
#### 配置外部网元数据分发 
摘要 : 
MDS节点按照配置的不同分发策略，将数据源上报的数据分发到指定数据清洗服务器。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTNEDATADSP]命令，配置MDS节点的外部网元数据分发，如[图1]所示。
图1  ADD MDSEXTNEDATADSP命令
参数名称|参数说明
---|---
NE Type|MDS节点接入的网元类型。例如：MDS节点接收SMF数据源，选择SMF (SMF)。MDS节点分发FTU的数据源时，选择FTU处理的相应网元类型。
Group ID|同一目标类型的多个IP地址可以设置为一个组，MDS对同一组的多个IP地址（IP地址设置参见ADDMDSDSPIP命令）进行负载均衡数据分发。通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。不同网络平面网元数据的目标类型配置为不同组号。
Target|数据分发目标的类型。对于EMSPlus（CHR）网元，选择Send to DCU(SEND_TO_DCU)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTNEDATADSP]:NETYPE=<MDS节点接入的网元类型>,GROUPID=<组号>,DESTINATION=<数据分发目标的类型>
#### 过滤业务类型分发（可选） 
摘要 : 
开局人员根据需求配置业务报文中消息的事件号，MDS可以将不需要的消息过滤掉。
例如，在EMSPlus上配置SMF消息号，MDS可以将其消息直接丢弃。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSSVRTYPEDSP]命令，配置MDS节点的业务类型分发，如[图1]所示。
图1  ADD MDSSVRTYPEDSP命令
参数名称|参数说明
---|---
Start Message ID|需要丢弃的消息的起始事件ID。
End Message ID|需要丢弃的消息的结束事件ID。如果仅需要配置一个ID，则Start Message ID和End Message ID配置一致。
Target|发送该节点目标的消息将被丢弃。例如，如果需要MDS直接丢弃发给DCU节点的消息，则选择skip for dcu(SKIP_FOR_DCU)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSSVRTYPEDSP]:STARTMSGID=<消息的起始事件号>,ENDMSGID=<消息的结束事件号>,DESTINATION=<用于过滤的目标模块类型>
#### 配置BFD（可选） 
当现场有MDS节点自动容灾需求时，开局人员需要根据现场的组网环境，开启双臂BFD或者单臂BFD。
BFD节点的详细配置参见[配置BFD参数]。
#### 传送配置数据 
摘要 : 
MDS传送配置数据，使配置生效。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[SYNC MDS]命令，传送配置数据。
配置实例 : 
场景说明 : 
已经实例化好一个EMSPLus（CHR）局，有新的SMF业务网元需要和该EMSPLus（CHR）局对接上报业务数据。 
数据规划 : 
名称|数据|说明
---|---|---
SMF业务网元地址|183.22.4.221183.22.36.221183.22.4.199183.22.36.199|确定其网络平面和MDS在同一网络平面EMSPlus_VNF_SIG_NET
SMF业务网元发送信息的端口|15000|SMF网元向EMSPLus（CHR）局发送信息时使用的端口
组号Group ID|1|EMSPLus（CHR）局内部使用，SMF网元规划统一划分为组1
配置步骤 : 
步骤|操作|说明
---|---|---
1|ADD MDSEXTERNALNE: IP=183.22.4.221, STARTPORT=15000, ENDPORT=15000, NETYPE=SMFADD MDSEXTERNALNE: IP=183.22.36.221, STARTPORT=15000, ENDPORT=15000, NETYPE=SMFADD MDSEXTERNALNE: IP=183.22.4.199, STARTPORT=15000, ENDPORT=15000, NETYPE=SMFADD MDSEXTERNALNE: IP=183.22.36.199, STARTPORT=15000, ENDPORT=15000, NETYPE=SMF|配置MDS节点对接的外部网元
2|ADD MDSEXTNEDATADSP: NETYPE=SMF, GROUPID=1, DESTINATION=SEND_TO_DCU|配置外部网元数据分发
3|SYNC MDS|MDS传送配置数据，使配置生效
### EMSPlus（Reporting）局点 
EMSPlus（Reporting）提供流量统计报表查询。 
#### 配置FTU节点（可选） 
FTU节点使用FTP文件接口接收网元日志数据，数据文件经过处理后通过消息接口转发给MDS节点。 
FTU节点的详细配置参见“[配置FTU参数]”。
#### 配置CU合并（可选） 
摘要 : 
对于CU合并场景，需要配置ASC节点，将SMF消息与UPF消息合并。
ASC节点从SMF消息中取出部分字段填充到UPF消息中，并将UPF消息发送到DCU或MU。当报文经过ASC节点后，就没有SMF消息了。 
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD ASCDSPIP]命令，配置ASC节点数据分发的IP地址（DCU或者MU的IP地址），如[图1]所示。
图1  ADD ASCDSPIP命令
参数名称|参数说明
---|---
Group ID|ASC对同一组的多个IP地址进行负载均衡数据分发，可通过SHOW ASCDSPIP命令查询组号对应的模块类型和数据分发IP地址。
Model Type|对于EMSPlus（Reporting）局，选择DCU_RP Moduel (DCU_RP)。可通过SHOW MODULE命令查询Module type。
IP|接收ASC分发数据的目的地址。对于EMSPlus（Reporting）局，设置DCU的IP地址。可使用SHOW COMMCFG命令查询DCU/MU相关IP地址。
执行[ADD ASCEXTNEDATADSP]命令，配置UPF消息发送到DCU还是MU，如[图2]所示。
图2  ADD ASCEXTNEDATADSP命令
参数名称|参数说明
---|---
Net Type|ASC节点接入的网元类型，选择UPF (UPF)。
Group ID|通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。
Target|数据分发目标的类型。对于EMSPlus（Reporting）局，选择Sendto DCU (SEND_TO_DCU)。
执行[SYNC ASC]命令，传送配置数据到ASC，如[图3]所示。
图3  SYNC ASC命令
#### 配置MDS节点的外部网元 
摘要 : 
MDS节点的数据源主要来自于外部接入的V5 xGW网元、5GC网元（例如SMF、UPF）。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTERNALNE]命令，配置MDS节点的外部接入网元，如[图1]所示。
图1  ADD MDSEXTERNALNE命令
参数名称|参数说明
---|---
IP|外接网元对接EMSPlus的业务地址。外接网元与EMSPLus（Reporting）局对接，上报业务数据。当MDS节点接收FTU的数据源时，配置为FTU使用的承载消息的网络平面的地址，通常为FTU在GI面的地址。
Start Port|外接网元向EMSPLus（Reporting）局发送信息的起始端口。接入IP为FTU节点的地址时，填写为1。
End Port|外接网元向EMSPLus（Reporting）局发送信息的结束端口。如果仅需要配置一个端口，则Start Port和End Port配置一致。接入IP为FTU节点的地址时，填写为65535。
NE Type|MDS节点接入的网元类型。例如：MDS节点接收xGW数据源，选择XGW (XGW)。MDS节点接收FTU的数据源时，选择FTU处理的相应网元类型。
 说明： 
在各网元IP地址不重复的情况下，配置Start Port为1、End Port为65535。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTERNALNE]:IP=<外接网元对接EMSPlus的业务地址>,STARTPORT=<外接网元发送信息的起始端口>,ENDPORT=<外接网元发送信息的结束端口>,NETYPE=<MDS节点接入的网元类型>
#### 配置分发IP地址 
摘要 : 
配置MDS节点的数据分发的模块号和IP地址。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSDSPIP]命令，配置MDS节点的数据分发IP地址，如[图1]所示。
图1  ADD MDSDSPIP命令
参数名称|参数说明
---|---
Group ID|MDS对同一组的多个IP地址进行负载均衡数据分发，可通过SHOW MDSDSPIP命令查询组号对应的数据分发IP地址。
Model Type|模块类型选择DCU_RP Module (DCU_RP)或者ASC Module (ASC)。ADD MODULE命令中配置的模块类型，可通过SHOW MODULE命令查询Moduletype。
IP|MDS分发数据到DCU/ASC（Association Node，关联节点），则该地址是DCU/ASC的Local IP For Upload Data地址。可使用SHOW COMMCFG命令查询DCU/ASC相关IP地址。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSDSPIP]:GROUPID=<组号>,MODULETYPE=<数据分发的模块类型>,IPADDR=<DCU/ASC的Local
IP For Upload Data地址>
#### 配置外部网元数据分发 
摘要 : 
MDS节点按照配置的不同分发策略，将数据源上报的数据分发到指定数据清洗服务器。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTNEDATADSP]命令，配置MDS节点的外部网元数据分发，如[图1]所示。
图1  ADD MDSEXTNEDATADSP命令
参数名称|参数说明
---|---
NE Type|MDS节点接入的网元类型。例如：MDS节点接收xGW数据源，选择XGW (XGW)。MDS节点分发FTU的数据源时，选择FTU处理的相应网元类型。
Group ID|同一目标类型的多个IP地址可以设置为一个组，MDS对同一组的多个IP地址（IP地址设置参见ADDMDSDSPIP命令）进行负载均衡数据分发。通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。不同网络平面网元数据的目标类型配置为不同组号。
Target|数据分发目标的类型。对于EMSPlus（Reporting）网元，选择Send_to_DCU(SEND_TO_DCU)或者Send_to_ASC (SEND_TO_ASC)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTNEDATADSP]:NETYPE=<MDS节点接入的网元类型>,GROUPID=<组号>,DESTINATION=<数据分发目标的类型>
#### 过滤业务类型分发（可选） 
摘要 : 
开局人员根据需求配置业务报文中消息的事件号，MDS可以将不需要的消息过滤掉。
例如，在EMSPlus上配置SMF消息号，MDS可以将其消息直接丢弃，避免转发到ASC节点做垃圾报文。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSSVRTYPEDSP]命令，配置MDS节点的业务类型分发，如[图1]所示。
图1  ADD MDSSVRTYPEDSP命令
参数名称|参数说明
---|---
Start Message ID|需要丢弃的消息的起始事件ID。
End Message ID|需要丢弃的消息的结束事件ID。如果仅需要配置一个ID，则Start Message ID和End Message ID配置一致。
Target|发送该节点目标的消息将被丢弃。例如，如果需要MDS直接丢弃发给ASC节点的SMF消息，则选择skip for asc(SKIP_FOR_ASC)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSSVRTYPEDSP]:STARTMSGID=<消息的起始事件号>,ENDMSGID=<消息的结束事件号>,DESTINATION=<用于过滤的目标模块类型>
#### 配置BFD（可选） 
当现场有MDS节点自动容灾需求时，开局人员需要根据现场的组网环境，开启双臂BFD或者单臂BFD。
BFD节点的详细配置参见[配置BFD参数]。
#### 传送配置数据 
摘要 : 
MDS传送配置数据，使配置生效。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[SYNC MDS]命令，传送配置数据。
配置实例 : 
场景说明 : 
已经实例化好一个EMSPLus（Reporting）局，有新的SMF和UPF业务网元需要和该EMSPLus（Reporting）局对接上报业务数据。
数据规划 : 
名称|数据|说明
---|---|---
SMF业务网元地址|10.1.1.221|确定其网络平面和MDS可以通信
SMF业务网元发送信息的端口|1~65535|SMF网元向EMSPLus（Reporting）局发送信息时使用的端口
UPF业务地址|10.1.1.222|确定其网络平面和MDS可以通信
UPF业务网元发送信息的端口|1~65535|UPF网元向EMSPlus（Reporting）局发送信息时使用的端口
组号Group   ID|1|EMSPLus（Reporting）局内部使用，处理方式相同的网元需要规划统一划分为相同的组
DCU的Local IP For Upload Data地址|182.168.215.5|使用SHOW   COMMCFG命令可以查询DCU相关地址
ASC的Local IP For Upload Data地址|182.168.215.7|使用SHOW COMMCFG命令可以查询ASC相关地址
配置步骤 : 
步骤|操作|说明
---|---|---
1|ADD MDSEXTERNALNE: IP=10.1.1.221, STARTPORT=1, ENDPORT=65535, NETYPE=SMFADD MDSEXTERNALNE: IP=10.1.1.222, STARTPORT=1, ENDPORT=65535, NETYPE=UPF|配置MDS节点对接的外部网元
2|ADD MDSDSPIP: GROUPID=1, MODULETYPE=ASC, IPADDR=182.168.215.7|CU合并场景，配置MDS分发的ASC的IP地址
3|ADD MDSEXTNEDATADSP: NETYPE=SMF, GROUPID=1, DESTINATION=SEND_TO_ASCADD MDSEXTNEDATADSP: NETYPE=UPF, GROUPID=1, DESTINATION=SEND_TO_ASC|配置MDS节点上外部网元数据分发
4|SYNC MDS|MDS传送配置数据，使配置生效
5|ADD ASCDSPIP:GROUPID=1,MODULETYPE=DCU_RP,IPADDR=182.168.215.5|配置ASC节点分发的DCU的IP地址
6|ADD ASCEXTNEDATADSP:NETYPE=UPF,GROUPID=1,DESTINATION=SEND_TO_DCU|配置ASC节点上UPF网元数据分发
7|SYNC ASC|ASC传送配置数据，使配置生效
### EMSPlus（Logging）局点 
EMSPlus（Logging）提供网元日志关联存储查询。 
#### Logging场景配置 
##### 配置FTU节点（可选） 
FTU节点使用FTP文件接口接收网元日志数据，数据文件经过处理后通过消息接口转发给MDS节点。 
FTU节点的详细配置参见“[配置FTU参数]”。
##### 配置MDS节点的外部网元 
摘要 : 
MDS节点的数据源主要来自于Firewall、CGNAT。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTERNALNE]命令，配置MDS节点的外部接入网元，如[图1]所示。
图1  ADD MDSEXTERNALNE命令
参数名称|参数说明
---|---
IP|业务网元对接EMSPlus的地址。业务网元与EMSPLus（Logging）局对接，上报业务数据。当MDS节点接收FTU的数据源时，配置为FTU使用的承载消息的网络平面的地址，通常为FTU在GI面的地址。
Start Port|业务网元向EMSPLus（Logging）局发送信息的起始端口。接入IP为FTU节点的地址时，填写为1。
End Port|业务网元向EMSPLus（Logging）局发送信息的结束端口。如果仅需要配置一个端口，则Start Port和End Port配置一致。接入IP为FTU节点的地址时，填写为65535。
NE Type|MDS节点接入的网元类型。MDS节点接收Firewall数据源时，选择FW (FIREWALL)。MDS节点接收CGNAT数据源时，选择CGNat (CGNAT)。MDS节点接收Fortinet数据源时，选择Fortinet (FORTINET)。MDS节点接收FTU的数据源时，选择FTU处理的相应网元类型。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTERNALNE]:IP=<业务网元对接EMSPlus的地址>,STARTPORT=<业务网元发送信息的起始端口>,ENDPORT=<业务网元发送信息的结束端口>,NETYPE=<MDS节点接入的网元类型>
##### 配置分发IP地址 
摘要 : 
配置MDS节点的数据分发的模块号和IP地址。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSDSPIP]命令，配置MDS节点的数据分发IP地址，如[图1]所示。
图1  ADD MDSDSPIP命令
参数名称|参数说明
---|---
Group ID|MDS对同一组的多个IP地址进行负载均衡数据分发，可通过SHOW MDSDSPIP命令查询组号对应的数据分发IP地址。
Model Type|模块类型选择DCU_MU Module (DCU_MU)。ADD MODULE命令中配置的模块类型，可通过SHOW MODULE命令查询Module type。
IP|MDS分发数据到DCU，则该地址是DCU的Local IP For Upload Data地址。可使用SHOW COMMCFG命令查询DCU相关IP地址。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSDSPIP]:GROUPID=<组号>,MODULETYPE=<数据分发的模块类型>,IPADDR=<DCU的Local
IP For Upload Data地址>
##### 配置外部网元数据分发 
摘要 : 
MDS节点按照配置的不同分发策略，将数据源上报的数据分发到指定数据清洗服务器。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTNEDATADSP]命令，配置MDS节点的外部网元数据分发，如[图1]所示。
图1  ADD MDSEXTNEDATADSP命令
参数名称|参数说明
---|---
NE Type|MDS节点接入的网元类型。MDS节点分发Firewall数据时，选择FW (FIREWALL)。MDS节点分发CGNAT数据时，选择CGNat (CGNAT)。MDS节点分发FTU的数据源时，选择FTU处理的相应网元类型。
Group ID|同一目标类型的多个IP地址可以设置为一个组，MDS对同一组的多个IP地址（IP地址设置参见ADDMDSDSPIP命令）进行负载均衡数据分发。通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。不同网络平面网元数据的目标类型配置为不同组号。
Target|数据分发目标的类型。对于EMSPlus（Logging）网元，选择Send_to_MU(SEND_TO_MU)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTNEDATADSP]:NETYPE=<MDS节点接入的网元类型>,GROUPID=<组号>,DESTINATION=<数据分发目标的类型>
##### 过滤业务类型分发（可选） 
摘要 : 
开局人员根据需求配置业务报文中消息的事件号，MDS可以将不需要的消息过滤掉。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSSVRTYPEDSP]命令，配置MDS节点的业务类型分发，如[图1]所示。
图1  ADD MDSSVRTYPEDSP命令
参数名称|参数说明
---|---
Start Message ID|需要丢弃的消息的起始事件ID。
End Message ID|需要丢弃的消息的结束事件ID。如果仅需要配置一个ID，则Start Message ID和End Message ID配置一致。
Target|发送该节点目标的消息将被丢弃。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSSVRTYPEDSP]:STARTMSGID=<消息的起始事件号>,ENDMSGID=<消息的结束事件号>,DESTINATION=<用于过滤的目标模块类型>
##### 配置BFD（可选） 
当现场有MDS节点自动容灾需求时，开局人员需要根据现场的组网环境，开启双臂BFD或者单臂BFD。
BFD节点的详细配置参见[配置BFD参数]。
##### 传送配置数据 
摘要 : 
MDS传送配置数据，使配置生效。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[SYNC MDS]命令，传送配置数据。
配置实例 : 
场景说明 : 
已经实例化好一个EMSPLus（Logging）局，有新的CGNAT和Firewall业务网元需要和该EMSPLus（Logging）局对接上报业务数据。 
数据规划 : 
名称|数据|说明
---|---|---
CGNAT业务网元地址|20.1.1.222|确定其网络平面和MDS在同一网络平面EMSPlus_VNF_FWNAT_NET
CGNAT业务网元发送信息的端口|1025~1054|CGNAT网元向EMSPLus（Logging）局发送信息时使用的端口
组号Group ID|1|EMSPLus（Logging）局内部使用，CGNAT网元规划统一划分为组1
DCU的Local IP For Upload Data地址|182.168.215.5|使用SHOW COMMCFG命令可以查询DCU相关地址
防火墙业务网元地址|30.1.1.223|确定其网络平面和MDS在同一网络平面EMSPlus_VNF_FWNAT_NET
防火墙业务网元发送信息的端口|201|防火墙网元向EMSPLus（Logging）局发送信息时使用的端口
组号Group ID|2|EMSPLus（Logging）局内部使用，防火墙网元规划统一划分为组2
配置步骤 : 
步骤|操作|说明
---|---|---
1|ADD MDSEXTERNALNE: IP=20.1.1.222, STARTPORT=1025, ENDPORT=1054, NETYPE=CGNATADD MDSEXTERNALNE: IP=30.1.1.223, STARTPORT=201, ENDPORT=201, NETYPE=FIREWALL_LOG|配置MDS节点对接的外部网元
2|ADD MDSDSPIP: GROUPID=1, MODULETYPE=DCU_MU,IPADDR=182.168.215.5ADD MDSDSPIP: GROUPID=2, MODULETYPE=DCU_MU, IPADDR=182.168.215.5|配置MDS分发的IP地址
3|ADD MDSEXTNEDATADSP: NETYPE=CGNAT, GROUPID=1, DESTINATION=SEND_TO_MUADD MDSEXTNEDATADSP: NETYPE=FIREWALL_LOG,GROUPID=2, DESTINATION=SEND_TO_MU|配置外部网元数据分发
4|SYNC MDS|MDS传送配置数据，使配置生效
#### IPDR场景配置 
##### 配置FTU节点（可选） 
FTU节点使用FTP文件接口接收网元日志数据，数据文件经过处理后通过消息接口转发给MDS节点。 
FTU节点的详细配置参见“[配置FTU参数]”。
##### 配置CU合并（可选） 
摘要 : 
对于CU合并场景，需要配置ASC节点，将SMF消息与UPF消息合并。
ASC节点从SMF消息中取出部分字段填充到UPF消息中，并将UPF消息发送到DCU或MU。当报文经过ASC节点后，就没有SMF消息了。 
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD ASCDSPIP]命令，配置ASC节点数据分发的IP地址（DCU或者MU的IP地址），如[图1]所示。
图1  ADD ASCDSPIP命令
参数名称|参数说明
---|---
Group ID|ASC对同一组的多个IP地址进行负载均衡数据分发，可通过SHOW ASCDSPIP命令查询组号对应的模块类型和数据分发IP地址。
Model Type|对于EMSPLus（Logging）局，选择DCU_MU Moduel (DCU_MU)。可通过SHOW MODULE命令查询Module type。
IP|接收ASC分发数据的目的地址。对于EMSPLus（Logging）局，设置MU的IP地址。可使用SHOW COMMCFG命令查询DCU/MU相关IP地址。
执行[ADD ASCEXTNEDATADSP]命令，配置UPF消息发送到DCU还是MU，如[图2]所示。
图2  ADD ASCEXTNEDATADSP命令
参数名称|参数说明
---|---
Net Type|ASC节点接入的网元类型，选择UPF (UPF)。
Group ID|通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。
Target|数据分发目标的类型。对于EMSPLus（Logging）局，选择Send toCU (SEND_TO_CU)。
执行[SYNC ASC]命令，传送配置数据到ASC，如[图3]所示。
图3  SYNC ASC命令
##### 配置MDS节点的外部网元 
摘要 : 
MDS节点的数据源主要来自于xGW、CGNAT、Firewall、Fortinet、5GC网元（例如SMF、UPF）。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTERNALNE]命令，配置MDS节点的外部接入网元，如[图1]所示。
图1  ADD MDSEXTERNALNE命令
参数名称|参数说明
---|---
IP|业务网元对接EMSPlus的业务地址。业务网元与EMSPLus（Logging）局对接，上报业务数据。当MDS节点接收FTU的数据源时，配置为FTU使用的承载消息的网络平面的地址，通常为FTU在GI面的地址。
Start Port|业务网元向EMSPLus（Logging）局发送信息的起始端口。接入IP为FTU节点的地址时，填写为1。
End Port|业务网元向EMSPLus（Logging）局发送信息的结束端口。如果仅需要配置一个端口，则Start Port和End Port配置一致。接入IP为FTU节点的地址时，填写为65535。
NE Type|MDS节点接入的网元类型，例如：MDS节点接收xGW数据源时，选择XGW (XGW)。MDS节点接收CGNAT数据源时，选择CGNat (CGNAT)。MDS节点接收Fortinet数据源时，选择Fortinet (FORTINET)。MDS节点接收FTU的数据源时，选择FTU处理的相应网元类型。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTERNALNE]:IP=<业务网元对接EMSPlus的业务地址>,STARTPORT=<业务网元发送信息的起始端口>,ENDPORT=<业务网元发送信息的结束端口>,NETYPE=<MDS节点接入的网元类型>
##### 配置分发IP地址 
摘要 : 
配置MDS节点的数据分发的模块号和IP地址。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSDSPIP]命令，配置MDS节点的数据分发IP地址，如[图1]所示。
图1  ADD MDSDSPIP命令
参数名称|参数说明
---|---
Group ID|MDS对同一组的多个IP地址进行负载均衡数据分发，可通过SHOW MDSDSPIP命令查询组号对应的数据分发IP地址。
Model Type|模块类型选择DCU_MU Module (DCU_MU)。ADD MODULE命令中配置的模块类型，可通过SHOW MODULE命令查询Moduletype。
IP|MDS分发数据到DCU，则该地址是DCU的Local IP For Upload Data地址。可使用SHOW COMMCFG命令查询DCU相关IP地址。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSDSPIP]:GROUPID=<组号>,MODULETYPE=<数据分发的模块类型>,IPADDR=<DCU的Local
IP For Upload Data地址>
##### 配置外部网元数据分发 
摘要 : 
MDS节点按照配置的不同分发策略，将数据源上报的数据分发到指定数据清洗服务器。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTNEDATADSP]命令，配置MDS节点的外部网元数据分发，如[图1]所示。
图1  ADD MDSEXTNEDATADSP命令
参数名称|参数说明
---|---
NE Type|MDS节点接入的网元类型，例如：MDS节点分发xGW数据时，选择XGW (XGW)。MDS节点分发CGNAT数据时，选择CGNat (CGNAT)。MDS节点接收Fortinet数据源时，选择Fortinet (FORTINET)。MDS节点分发FTU的数据源时，选择FTU处理的相应网元类型。
Group ID|同一目标类型的多个IP地址可以设置为一个组，MDS对同一组的多个IP地址（IP地址设置参见ADDMDSDSPIP命令）进行负载均衡数据分发。通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。不同网络平面网元数据的目标类型配置为不同组号。
Target|数据分发目标的类型。对于EMSPlusLog网元，选择Send_TO_MU(SEND_to_MU)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSEXTNEDATADSP]:NETYPE=<MDS节点接入的网元类型>,GROUPID=<组号>,DESTINATION=<数据分发目标的类型>
##### 过滤业务类型分发（可选） 
摘要 : 
开局人员根据需求配置业务报文中消息的事件号，MDS可以将不需要的消息过滤掉。
例如，在EMSPlus上配置SMF消息号，MDS可以将其消息直接丢弃，避免转发到ASC节点做垃圾报文。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSSVRTYPEDSP]命令，配置MDS节点的业务类型分发，如[图1]所示。
图1  ADD MDSSVRTYPEDSP命令
参数名称|参数说明
---|---
Start Message ID|需要丢弃的消息的起始事件ID。
End Message ID|需要丢弃的消息的结束事件ID。如果仅需要配置一个ID，则Start Message ID和End Message ID配置一致。
Target|发送该节点目标的消息将被丢弃。例如，如果需要MDS直接丢弃发给ASC节点的SMF消息，则选择skip for asc(SKIP_FOR_ASC)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSSVRTYPEDSP]:STARTMSGID=<消息的起始事件号>,ENDMSGID=<消息的结束事件号>,DESTINATION=<用于过滤的目标模块类型>
##### 配置BFD（可选） 
当现场有MDS节点自动容灾需求时，开局人员需要根据现场的组网环境，开启双臂BFD或者单臂BFD。
BFD节点的详细配置参见[配置BFD参数]。
##### 传送配置数据 
摘要 : 
MDS传送配置数据，使配置生效。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[SYNC MDS]命令，传送配置数据。
配置实例 : 
场景说明 : 
已经实例化好一个EMSPLus（Logging）局，有新的CGNAT、SMF和UPF业务网元需要和该EMSPLus（Logging）局对接上报业务数据。
数据规划 : 
名称|数据|说明
---|---|---
SMF业务网元地址|10.1.1.221|确定其网络平面和MDS可以通信
SMF业务网元发送信息的端口|1~65535|SMF网元向EMSPLus（Reporting）局发送信息时使用的端口
UPF业务地址|10.1.1.222|确定其网络平面和MDS可以通信
UPF业务网元发送信息的端口|1~65535|UPF网元项EMSPlus（Reporting）局发送信息时使用的端口
组号Group   ID|1|EMSPLus（Reporting）局内部使用，处理方式相同的网元需要规划统一划分为相同的组
CGNAT业务地址|20.1.1.222|确定其网络平面和MDS可以通信
CGNAT业务网元发送信息的端口|1~65535|CGNAT网元向EMSPLus（Logging）局发送信息时使用的端口
组号Group ID|2|EMSPLus（Reporting）局内部使用，处理方式相同的网元需要规划统一划分为相同的组。
DCU的Local IP For Upload Data地址|182.168.215.5|使用SHOW   COMMCFG命令可以查询DCU相关地址
ASC的Local IP For Upload Data地址|182.168.215.7|使用SHOW COMMCFG命令可以查询ASC相关地址
配置步骤 : 
步骤|操作|说明
---|---|---
1|ADD MDSEXTERNALNE: IP=20.1.1.222, STARTPORT=1, ENDPORT=65535, NETYPE=CGNAT ADD MDSEXTERNALNE: IP=10.1.1.221, STARTPORT=1, ENDPORT=65535, NETYPE=SMF ADD MDSEXTERNALNE: IP=10.1.1.222, STARTPORT=1, ENDPORT=65535, NETYPE=UPF|配置MDS节点对接的外部网元
2|ADD MDSDSPIP: GROUPID=1, MODULETYPE=DCU_MU, IPADDR=182.168.215.5ADD MDSDSPIP: GROUPID=2,   MODULETYPE=ASC,IPADDR=182.168.215.7|配置MDS分发的IP地址
3|ADD MDSEXTNEDATADSP: NETYPE=CGNAT, GROUPID=1, DESTINATION=SEND_TO_MU ADD MDSEXTNEDATADSP: NETYPE=SMF, GROUPID=2, DESTINATION=ASC ADD MDSEXTNEDATADSP: NETYPE=SMF, GROUPID=2, DESTINATION=ASC|配置外部网元数据分发
4|SYNC MDS|MDS传送配置数据，使配置生效
5|ADD   ASCDSPIP:GROUPID=1,MODULETYPE=DCU_MU,IPADDR=182.168.215.5|配置ASC节点分发的MU的IP地址
6|ADD   ASCEXTNEDATADSP:NETYPE=UPF,GROUPID=1,DESTINATION=SEND_TO_MU|配置ASC节点上UPF网元数据分发
7|SYNC ASC|ASC传送配置数据，使配置生效
### MDS级联场景配置 
#### MDS级联 
MDS在对接网元时，可能会面临多种组网场景，其中一种就是网元消息只会发送给一个局的MDS，而EMSPlus（Reporting）/EMSPlus（Logging）功能是单独的一套设备，所以需要第一个局的MDS将数据复制转发一份给第二个局点的MDS。
对于一个局点同时部署EMSPlus（Reporting）和EMSPlus（Logging）时，数据源只有一个，只有一个EMSPlus网元的MDS与数据源交互。因此需要支持EMSPlus（Reporting）和EMSPlus（Logging）两网元间的MDS级联，xGW网元的MDS级联的组网结构如[图1]所示。
图1  MDS级联
MDS级联说明如下： 
MDS向MU转发消息，通过EMSPlus的内部数据面。 
EMSPlus网元间MDS级联消息的转发，通过与数据源交互的网络。 
MDS级联场景下，以EMSPlus（Logging）的MDS为主，由它向EMSPlus（Reporting）的MDS转发。EMSPlus（Logging）会接收xGW/Firewall/CGNAT/5GC等消息，由它再将其中xGW的CHR消息转发给EMSPlus（Reporting）。 
#### 配置MDS节点的外部网元 
摘要 : 
MDS节点的数据源主要来自于xGW、防火墙、CGNAT、5GC业务网元，同时EMSPlus支持MDS的级联，参见“[MDS级联]”
。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTERNALNE]命令，配置MDS节点的外部接入网元，如[图1]所示。
图1  ADD MDSEXTERNALNE命令
参数名称|参数说明
---|---
IP|业务网元对接EMSPlus的地址。配置MDS级联时，使用源MDS的业务IP地址。
Start Port|业务网元发送信息的起始端口。配置MDS级联时，无分片的端口号固定为9527，有分片的端口号固定为14000。
End Port|业务网元发送信息的结束端口。如果仅需要配置一个端口，则Start Port和End Port配置一致。
NE Type|MDS节点接入的网元类型，例如：MDS节点接收xGW数据源时，选择XGW (XGW)。MDS节点接收Firewall数据源时，选择FW (FIREWALL)。MDS节点接收CGNAT数据源时，选择CGNat (CGNAT)。配置MDS级联时，选择MDS (MDS)。
根据产品具体需求，执行对应的命令操作。 
MDS接收外部网元数据：ADD MDSEXTERNALNE:IP=<业务网元对接EMSPlus的地址>,STARTPORT=<业务网元发送信息的起始端口>,ENDPORT=<业务网元发送信息的结束端口>,NETYPE=<MDS节点接入的网元类型> 
MDS级联接收外部网元数据：ADD MDSEXTERNALNE:IP=<MDS级联的源MDS的业务IP地址>,STARTPORT=9527,ENDPORT=9527,NETYPE=MDS 
#### 配置分发IP地址 
摘要 : 
配置MDS节点的数据分发的模块号和IP地址。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSDSPIP]命令，配置MDS节点的数据分发IP地址，如[图1]所示。
图1  ADD MDSDSPIP命令
参数名称|参数说明
---|---
Group ID|MDS对同一组的多个IP地址进行负载均衡数据分发，可通过SHOW MDSDSPIP命令查询组号对应的数据分发IP地址。
Model Type|ADD MODULE命令中配置的模块类型，可通过SHOWMODULE命令查询Module type。当模块类型选择DCU_RP Module (DCU_RP)、DCU_MU Module (DCU_MU)或者ASC Module (ASC)时，表示MDS分发数据到同一网元的模块。当模块类型选择MDS Module (MDS)时，表示MDS分发数据到另一个网元中的MDS（即MDS级联中的目的MDS）。
IP|MDS分发数据到DCU/ASC，则该地址是DCU/ASC的Local IP For UploadData地址。可使用SHOW COMMCFG命令查询DCU/ASC相关IP地址。MDS级联，即MDS分发数据到另一个MDS，则该地址是目的MDS节点的实IP地址，MDS级联的组网结构示例参见“MDS级联”。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSDSPIP]:GROUPID=<组号>,MODULETYPE=<数据分发的模块类型>,IPADDR=<DCU/ASC的Local
IP For Upload Data地址>
[ADD MDSDSPIP]:GROUPID=<组号>,MODULETYPE=MDS,IPADDR=<目的MDS节点的实IP地址>
#### 配置外部网元数据分发 
摘要 : 
MDS节点按照配置的不同分发策略，将数据源上报的数据分发到指定数据清洗服务器。
MDS级联时，MDS将收到的消息根据业务数据类型有选择分发给另外一个MDS，参见“[MDS级联]”
。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSEXTNEDATADSP]命令，配置MDS节点的外部网元数据分发，如[图1]所示。
图1  ADD MDSEXTNEDATADSP命令
参数名称|参数说明
---|---
NE Type|MDS节点接入的网元类型，例如：MDS节点分发xGW数据时，选择XGW (XGW)。MDS节点分发Firewall数据时，选择FW (FIREWALL)。MDS节点分发CGNAT数据时，选择CGNat (CGNAT)。
Group ID|同一目标类型的多个IP地址可以设置为一个组，MDS对同一组的多个IP地址（IP地址设置参见ADDMDSDSPIP命令）进行负载均衡数据分发。通过SHOW MDSDSPIP命令查询组号对应的模块类型和数据分发IP地址。不同网络平面网元数据的目标类型配置为不同组号。
Target|数据分发目标的类型：对于EMSPlus（Reporting）网元，选择Send_to_DCU (SEND_TO_DCU)或者Send_to_ASC (SEND_TO_ASC)。对于EMSPlus（Logging）网元，选择Send_to_MU (SEND_TO_MU)或者Send_to_ASC (SEND_TO_ASC)。MDS级联时，选择Send_TO_MDS (SEND_to_MDS)。
根据产品具体需求，执行对应的命令操作。 
MDS分发网元数据：ADD MDSEXTNEDATADSP:NETYPE=XGW,GROUPID=<组号>,DESTINATION=SEND_TO_DCUADD MDSEXTNEDATADSP:NETYPE=XGW,GROUPID=<组号>,DESTINATION=SEND_TO_MUADD MDSEXTNEDATADSP:NETYPE=CGNAT,GROUPID=<组号>,DESTINATION=SEND_TO_MUADD MDSEXTNEDATADSP:NETYPE=FIREWALL_LOG,GROUPID=<组号>,DESTINATION=SEND_TO_MU 
MDS级联分发网元数据：ADD MDSEXTNEDATADSP:NETYPE=XGW,GROUPID=<组号>,DESTINATION=SEND_TO_MDS 
#### 过滤业务类型分发（可选） 
摘要 : 
开局人员根据需求配置业务报文中消息的事件号，MDS可以将不需要的消息过滤掉。
例如，在EMSPlus上配置SMF消息号，MDS可以将其消息直接丢弃，避免转发到ASC节点做垃圾报文。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD MDSSVRTYPEDSP]命令，配置MDS节点的业务类型分发，如[图1]所示。
图1  ADD MDSSVRTYPEDSP命令
参数名称|参数说明
---|---
Start Message ID|需要丢弃的消息的起始事件ID。
End Message ID|需要丢弃的消息的结束事件ID。如果仅需要配置一个ID，则Start Message ID和End Message ID配置一致。
Target|发送该节点目标的消息将被丢弃。例如，如果需要MDS直接丢弃发给ASC节点的SMF消息，则选择skip for asc(SKIP_FOR_ASC)。
根据产品具体需求，执行对应的命令操作。 
[ADD MDSSVRTYPEDSP]:STARTMSGID=<消息的起始事件号>,ENDMSGID=<消息的结束事件号>,DESTINATION=<用于过滤的目标模块类型>
#### 配置BFD（可选） 
当现场有MDS节点自动容灾需求时，开局人员需要根据现场的组网环境，开启双臂BFD或者单臂BFD。
BFD节点的详细配置参见[配置BFD参数]。
#### 传送配置数据 
摘要 : 
MDS传送配置数据，使配置生效。
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[SYNC MDS]命令，传送配置数据。
配置实例 : 
场景说明 : 
已经实例化好一个EMSPLus（Reporting）和EMSPlus（Logging）局，有新的xGW业务网元需要和两个局对接上报业务数据。数据源只有一个需要上报EMSPLus（Reporting）局和EMSPlus（Logging）局，因此需要使用MDS级联场景，具体组网参见“[MDS级联]”
。
数据规划 : 
名称|数据|说明
---|---|---
EMSPlusLog局号|205|-
EMSPlusRpt局号|206|-
xGW业务网元地址|10.1.1.221|确定其网络平面和EMSPlus（Logging）局的MDS在同一网络平面EMSPlus_VNF_GI_NET
xGW业务网元发送信息的端口|200~203|xGW网元向EMSPLus（Logging）局发送信息时使用的端口
组号Group ID|1|EMSPLus（Logging）和EMSPLus（Reporting）局内部使用，xGW网元规划统一划分为组1
EMSPLusLog局的DCU的Local IP For Upload Data地址|182.168.205.5|使用SHOW COMMCFG命令可以查询DCU相关地址
EMSPLusLog局的MDS的业务IP地址|10.255.205.20|ZTE_EMSPLus_205_VNF_GI_NET网络平面对应的业务IP地址
EMSPLusRpt局的DCU的Local IP For Upload Data地址|182.168.206.5|使用SHOW COMMCFG命令可以查询DCU相关地址
EMSPLusRpt局的MDS的实IP地址|10.255.206.1810.255.206.19|ZTE_EMSPLus_206_VNF_GI_NET网络平面对应的实IP地址
配置步骤 : 
步骤|操作|说明
---|---|---
1|ADD MDSEXTERNALNE: IP=10.1.1.221, STARTPORT=200, ENDPORT=203, NETYPE=XGW|在EMSPlus（Logging）局上，配置MDS节点的外部网元
2|ADD MDSDSPIP: GROUPID=1, MODULETYPE=DCU_MU,IPADDR=182.168.205.5ADD MDSDSPIP: GROUPID=2, MODULETYPE=MDS, IPADDR=10.255.206.18ADD MDSDSPIP: GROUPID=2, MODULETYPE=MDS,IPADDR=10.255.206.19|在EMSPlus（Logging）局上，配置MDS分发IP地址
3|ADD MDSEXTNEDATADSP: NETYPE=XGW, GROUPID=1, DESTINATION=SEND_TO_MUADD MDSEXTNEDATADSP: NETYPE=XGW, GROUPID=2, DESTINATION=SEND_TO_MDS|在EMSPlus（Logging）局上，配置外部网元数据分发
4|SYNC MDS|在EMSPlus（Logging）局上，MDS传送配置数据，使配置生效
5|ADD MDSEXTERNALNE: IP=10.255.205.20,STARTPORT=9527, ENDPORT=9527, NETYPE=MDS|在EMSPlus（Reporting）局上，配置MDS节点的外部网元
6|ADD MDSDSPIP: GROUPID=1, MODULETYPE=DCU_RP,IPADDR=182.168.206.5|在EMSPlus（Reporting）局上，配置MDS分发IP地址
7|ADD MDSEXTNEDATADSP: NETYPE=XGW, GROUPID=1, DESTINATION=SEND_TO_DCU|在EMSPlus（Reporting）局上，配置外部网元数据分发
8|SYNC MDS|在EMSPlus（Reporting）局上，MDS传送配置数据，使配置生效
### 对接后检查 
#### 检查数据库表的保留天数 
摘要 : 
检查数据库表的保留天数与用户需求保持一致。 
步骤 : 
登录MAN节点的虚机，执行命令[cat /ubas/clustershell/groups]，查看DPU节点的IP地址，如[图1]所示。
图1  查看DPU节点的IP
登录DPU首节点，执行[su gbase]，切换gbase用户，执行[gccli -uroot]，进入GBase数据库，如[图2]所示。
图2  打开GBase数据库
执行[use emsplus]，切换到emsplus数据库。执行[select tablesetid,tablename,delflag from tb_datamanager_tableset_detail]，查看数据库表的tablesetid，如[图3]所示。
图3  检查数据库表的tablesetid
以fact_ipdr_log表为例，执行[select tablesetid,tablesetname,savetime from tb_datamanager_tableset where tablesetid=8]，查看fact_ipdr_log表的保留天数savetime，如[图4]所示。
图4  检查数据库表的保留天数
### 参考 
#### 配置FTU参数 
当网元只有文件接口，没有消息接口时，EMSPlus通过FTU节点使用FTP文件接口方式对接该网元。网元的日志数据传送到FTU节点，FTU节点处理这些文件，并通过消息接口转发给MDS节点。
##### 导入FTU任务模板 
摘要 : 
FTU任务模板中的内容用于支持FTU的任务配置，使FTU节点正常工作。 
前提 : 
已获取中兴通讯提供的FTU任务模板文件。 
步骤 : 
在EMSPlus客户端，选择菜单System→Export/Import
，切换到FTU页面，如[图1]所示。
图1  导入FTU任务模板
单击Select File按钮，在弹出的对话框中选择FTU任务模板文件。
##### 配置FTU分发 
摘要 : 
FTU节点按照配置的不同分发策略，将日志数据分发到指定MDS节点。 
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[ADD FTUDSPCFG]命令，配置FTU节点的数据分发地址，如[图1]所示。
图1  ADD FTUDSPCFG命令
参数名称|参数说明
---|---
Group ID|FTU分发组号。FTU对同一组中的多个IP地址按照策略进行业务日志的分发。
IP|MDS接口地址。该IP地址是MDS节点接收业务日志的IP地址。
根据产品具体需求，执行对应的命令操作。 
[ADD FTUDSPCFG]:GROUPID=<FTU分发组号>,IP=<MDS接口地址>
##### 配置FTU任务 
摘要 : 
FTU节点根据任务名配置不同分发策略，将接收到的日志分发到目标。 
步骤 : 
在EMSPlus客户端的 MML Terminal窗口，执行[SHOW FTUTASK]命令，查看FTU任务名称的配置ADD FTU。
执行[ADD FTUTASKCFG]命令，增加FTU任务配置，如[图1]所示。
图1  ADD FTUTASKCFG命令
参数名称|参数说明
---|---
Module No.|FTU的模块号。
Task Name|FTU任务名称，即FTU日志分发任务名称。该名称的任务由Module No.参数指定的FTU模块处理。
Thread Num|日志分发线程个数。在Task Name指定的任务下，FTU进行日志分发时使用的线程个数，最多可以配置8个线程进行日志分发。
Send IP|日志发送者的IP地址。FTU模块使用该IP作为发送日志时的源IP。
Group ID|FTU分发组号。FTU向该分发组中的MDS发送日志。
根据产品具体需求，执行对应的命令操作。 
[ADD FTUTASKCFG]:MODULE=<FTU的模块号>,TASKNAME=<FTU任务名称>,THREADNUM=<日志分发线程个数>,SENDIP=<日志发送者IP>,GROUPID=<FTU分发组号>
##### 同步FTU配置 
摘要 : 
FTU配置参数在配置完成后需要同步到FTU模块才能生效。 
步骤 : 
在EMSPlus客户端的MML Terminal窗口，执行[SYNC FTUCFG]命令，传送配置数据，如[图1]所示。
图1  SYNC FTUCFG命令
#### 配置BFD参数 
摘要 : 
当现场有MDS节点自动容灾需求时，开局人员需要根据现场的组网环境，开启双臂或者单臂BFD，同时在VRF设备上配置静态路由和BFD会话。每条静态路由绑定一个BFD会话，从而检测VRF与MDS节点之间链路是否可达。如果VRF与MDS间链路异常，或者某个MDS节点服务不可用，则BFD会话将处于DOWN状态，VRF会判定会话对应的静态路由不可用。网元日志数据会通过可用静态路由转发到其他可用的MDS上，实现自动容灾切换。
步骤 : 
打开BFD会话模式
在EMSPlus客户端MML Terminal窗口，执行SET BFD SWITCH:STATUS=OPEN命令，如[图1]所示。
图1  执行SET BFD SWITCH命令
配置单臂BFD
在VRF上创建下一跳为MDS节点的静态路由，并开启BFD会话。对于目标地址相同的静态路由，静态路由上所有的MDS节点会共同分担所有的网元日志数据。 
 说明： 
BFD开关开启后，MDS具备返回单臂BFD回声功能，因此只需要在VRF上创建单臂BFD会话即可，EMS+不需要其他配置。 
配置双臂BFD
在VRF上配置静态路由，所有需要分担负荷的MDS节点都要配置成静态路由的下一跳地址。如果已经配置静态路由，则需要为静态路由配置BFD会话。 
在EMSPlus客户端MML Terminal窗口，执行ADD BFD SESSION命令，在EMSPlus侧配置BFD会话、两端IP，其他保持默认值，如[图2]所示。
图2  执行ADD BFD SESSION命令
参数名称|参数说明
---|---
Session ID|会话编号，不同的会话配置不同的编号。
Local IP|本端地址，MDS节点与网元对接的实际地址。
Remote IP|远端地址，VRF配置的静态路由上的网关地址。
Desired Min Tx Interval|最小发送间隔，单位是毫秒。
Desired Min Rx Interval|最小接受间隔，单位是毫秒。
Detect Mult|检测超时倍数。
Min Echo Rx Interval|最小ECHO报文接收间隔
Role|角色属性，可选。被动者：主动向VRF发起BFD会话。主动者：由VRF主动发起会话。默认选择被动者。
## 缩略语 
## 缩略语 
5GC : 
5G Core Network5G核心网
AMF : 
Access and Mobility Management Function接入和移动管理功能
### BFD 
Bidirectional Forwarding Detection双向转发检测
### CGNAT 
Carrier Grade Network Address Translation运营商级网络地址转换
CHR : 
Call History Record呼叫历史记录
### CU 
Control Plane and User Plane控制面和用户面
DCU : 
Data Collection Unit数据采集单元
DPU : 
Data Processing Unit数据处理单元
FTP : 
File Transfer Protocol文件传输协议
IP : 
Internet Protocol因特网协议
MAN : 
Manager Node管理节点
MDS : 
Message Dispatch Service消息分发服务
MU : 
Merging Unit合并单元
SMF : 
Session Management Function会话管理功能
UPF : 
User Plane Function用户平面功能
### VRF 
Virtual Route Forwarding虚拟路由转发
### xGW 
Extendable Gateway综合接入网关
ZTE : 
Zhongxing Telecommunications Equipment中兴通讯
